!function(){var hasInit=!1,entryInit=function(){!function(e){function t(t){for(var o,r,s=t[0],l=t[1],d=t[2],u=0,p=[];u<s.length;u++)r=s[u],i[r]&&p.push(i[r][0]),i[r]=0;for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(e[o]=l[o]);for(c&&c(t);p.length;)p.shift()();return a.push.apply(a,d||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],o=!0,s=1;s<n.length;s++){var l=n[s];0!==i[l]&&(o=!1)}o&&(a.splice(t--,1),e=r(r.s=n[0]))}return e}var o={},i={"core-sheet-pc":0},a=[];function r(t){if(o[t])return o[t].exports;var n=o[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,r),n.l=!0,n.exports}r.e=function(e){var t=[],n=i[e];if(0!==n)if(n)t.push(n[2]);else{var o=new Promise(function(t,o){n=i[e]=[t,o]});t.push(n[2]=o);var a,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+"static/js/"+({bundle_alloy_finger:"bundle_alloy_finger",bundle_exif:"bundle_exif",bundle_lazy_css:"bundle_lazy_css","bundle_lottie.min":"bundle_lottie.min"}[e]||e)+"-"+{bundle_alloy_finger:"720c6c17d4",bundle_exif:"7fdd334363",bundle_lazy_css:"f82bd63e01","bundle_lottie.min":"63e81bab0c"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),a=function(t){s.onerror=s.onload=null,clearTimeout(l);var n=i[e];if(0!==n){if(n){var o=t&&("load"===t.type?"missing":t.type),a=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+o+": "+a+")");r.type=o,r.request=a,n[1](r)}i[e]=void 0}};var l=setTimeout(function(){a({type:"timeout",target:s})},12e4);s.onerror=s.onload=a,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=o,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="//s2.url.cn/tim/docs/sheets/",r.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var d=0;d<s.length;d++)t(s[d]);var c=l;a.push(["./js/index.js","vendors~core-sheet-pc"]),n()}({"../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/lib/index.js?!../node_modules/less-loader/dist/cjs.js!./css/index-common.less":function(e,t,n){(t=e.exports=n("../node_modules/css-loader/dist/runtime/api.js")(!1)).i(n("../node_modules/css-loader/dist/cjs.js!./css/sprites/toolbar_sprite.css"),"");var o=n("../node_modules/css-loader/dist/runtime/url-escape.js"),i=o(n("./css/img/images/pointer_format.cur")),a=o(n("./css/img/images/pointer_format.png")),r=o(n("./css/img/images/sheet-dropdown.svg")),s=o(n("./css/img/images/sheet-dropdown.png")),l=o(n("./css/img/images/pixel.gif")),d=o(n("./css/img/images/close.png")),c=o(n("./css/img/images/sheet-add.png")),u=o(n("./css/img/images/clear36.png")),p=o(n("./css/img/images/clear36_press.png"));t.push([e.i,'/* Redesign */\n/* Re-redesign. */\n/* 2px off for borders */\n/* 2px off for borders */\n/* 2px off for borders */\n.user-select-none {\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n* {\n  margin: 0;\n  padding: 0;\n}\nhtml {\n  overflow: hidden;\n}\n/* h1, h2, h3, h4, h5, h6 { font-size: 100%; font-weight: normal; font-style: normal;\n  text-decoration: none; margin: 0; padding: 0; } */\nol,\nul {\n  list-style: none;\n}\n:focus {\n  outline: none;\n}\nbody {\n  width: 100%;\n  color: #2b2b2b;\n  background-color: #e6eae7;\n}\ntemplate {\n  display: none;\n}\nbody,\ntextarea {\n  font-family: "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n}\na img {\n  border: none;\n}\na,\na:hover,\na:link,\na:visited {\n  border-bottom: 0;\n  text-decoration: none;\n  /* color: @color_actionable;*/\n  transition: color 0.2s ease-in;\n}\na.attrlink,\na:hover.attrlink {\n  text-decoration: underline;\n}\nbody .hidden {\n  display: none;\n}\n.clear {\n  clear: both;\n}\n/* html5 placeholder support */\ninput::-webkit-input-placeholder,\ntextarea::-webkit-input-placeholder {\n  color: #999;\n}\ninput::-moz-placeholder,\ntextarea::-moz-placeholder {\n  color: #999;\n}\ntextarea {\n  /* Safari/Chrome, other WebKit */\n  /* Firefox, other Gecko */\n  box-sizing: border-box;\n}\n::-webkit-scrollbar {\n  width: 8px;\n  border-radius: 4px;\n}\n::-webkit-scrollbar-thumb {\n  border-radius: 4px;\n  background-color: rgba(0, 0, 0, 0.12);\n}\n::-webkit-scrollbar-thumb:hover {\n  background-color: rgba(0, 0, 0, 0.2);\n}\n::-webkit-scrollbar-thumb:active {\n  background-color: rgba(0, 0, 0, 0.2);\n}\n.aria-hide {\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 1px;\n  height: 1px;\n  overflow: hidden;\n}\n.clear {\n  clear: both;\n}\nbody {\n  -webkit-print-color-adjust: exact;\n}\nbody.embed {\n  background: transparent;\n  overflow: hidden;\n  height: 100%;\n  -webkit-overflow-scrolling: touch;\n  background: #fcfcfc;\n}\nbody.embed > header {\n  position: fixed;\n  height: auto;\n  box-shadow: inherit;\n  min-width: 0;\n  width: 100%;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  cursor: default;\n  top: 0;\n  left: 0;\n  right: 0;\n  text-align: center;\n  white-space: nowrap;\n}\nbody.embed header.tim-web {\n  height: 102px;\n  padding: 0px 0px 0px 0px;\n  width: 100%;\n  position: relative;\n  min-width: 450px;\n  z-index: auto;\n  background-color: #f8f8f8;\n  -webkit-tap-highlight-color: transparent;\n}\nbody.embed #share-tip {\n  position: absolute;\n  right: 39px;\n  top: 50px;\n  z-index: 99999;\n  padding: 8px 12px 8px 12px;\n  line-height: 18px;\n  border-radius: 2px;\n  box-shadow: 0 2px 3px #ccc;\n  background-color: rgba(0, 0, 0, 0.8);\n  font-size: 12px;\n  word-wrap: break-word;\n  word-break: break-all;\n  color: #fff;\n  font-family: "Microsoft YaHei", "\u5fae\u8f6f\u96c5\u9ed1", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  border: 0;\n  text-align: left;\n  letter-spacing: 1px;\n  max-width: 300px;\n  display: none;\n}\nbody.embed #share-tip:after {\n  content: "";\n  position: absolute;\n  width: 0;\n  height: 0;\n  top: -9px;\n  margin-left: -5px;\n  right: 10%;\n  border: 5px solid transparent;\n  border-bottom-color: rgba(0, 0, 0, 0.8);\n  border-bottom-width: 4px;\n}\nbody.embed #page-login-box {\n  top: 0px;\n}\nbody.embed #padpage {\n  padding-top: 0;\n  min-height: 0;\n  margin: 0 auto;\n  width: 100%;\n  transition: opacity 0.5s ease-in-out;\n  position: relative;\n}\nbody.embed #padeditor {\n  width: 100% !important;\n  margin-left: 0 !important;\n  margin-right: 0 !important;\n  padding-bottom: 0 !important;\n  max-width: none !important;\n  position: relative;\n  margin: 0 auto;\n  min-height: 500px;\n  padding-bottom: 0% !important;\n  transition: all 200ms cubic-bezier(0.2, 0.3, 0.25, 0.9);\n  background: transparent;\n  zoom: 1;\n  z-index: 500;\n}\nbody.embed.side-panel-show #padeditor {\n  width: calc(100% - 271px) !important;\n}\nbody.embed .sheet-wrapper {\n  width: 100%;\n  overflow: hidden;\n}\nbody.embed .sheet-left-border {\n  box-shadow: 5px 0 3px #dadbda inset;\n}\nbody.embed .sheet-right-border {\n  box-shadow: -5px 0 3px #dadbda inset;\n}\nbody.embed body.mobile-web > header > :not(.header-container) {\n  display: none !important;\n}\nbody.embed body.mobile-web #loadingProgress {\n  top: 0 !important;\n  background-color: #1dca5f !important;\n  height: 2px !important;\n}\nbody.embed body.mobile-web #loadingLine {\n  display: none !important;\n}\n@media only screen and (min-device-width: 375px) and (max-device-width: 812px) and (-webkit-min-device-pixel-ratio: 3) and (orientation: landscape) {\n  body.embed body.mobile-web .sheet-style-landscape {\n    width: auto;\n    border-left: 31px solid #fff;\n  }\n}\n.docs-ui-unprintable {\n  display: none;\n}\n.format-now,\n.format-now td,\n.format-now th {\n  cursor: url('+i+"), default !important;\n  cursor: url("+a+") 0 0, default !important;\n}\n#auth-container {\n  position: fixed;\n  top: 103px;\n  right: 0px;\n  z-index: 655;\n  display: none;\n  width: 270px;\n  height: calc(100% - 139px);\n  cursor: default;\n}\n.auth-container-slide-animation {\n  transition: all 0.3s ease-in;\n  -webkit-transition: all 0.3s ease-in;\n  -moz-transition: all 0.3s ease-in;\n}\n.auth-container-show {\n  right: 0px !important;\n}\n.auth-container-hide {\n  right: -270px !important;\n}\n#transfer-auth-container {\n  position: absolute;\n  top: 0;\n  left: 0;\n  z-index: 1000;\n  display: none;\n  width: 100%;\n  height: 100%;\n  background-color: rgba(255, 255, 255, 0.65);\n}\n#notification-container {\n  position: fixed;\n  z-index: 666;\n  top: 103px;\n  width: 324px;\n  right: 0px;\n  height: calc(100% - 148px);\n  background: #FFF;\n  cursor: default;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  border-left: 1px solid rgba(0, 0, 0, 0.06);\n}\n.notification-container-slide-animation {\n  transition: all 0.3s ease;\n}\n.notification-container-show {\n  display: block;\n  right: 0px !important;\n}\n.notification-container-hide {\n  display: block;\n  right: -392px !important;\n}\n#read-record-container {\n  position: absolute;\n  width: 270px;\n  top: 103px;\n  height: calc(100% - 139px);\n  background: none;\n  z-index: 666;\n  right: 0px;\n  transition: all 0.3s ease-in;\n}\n.read-record-container-show {\n  -webkit-transform: translateX(0px) translateZ(0);\n          transform: translateX(0px) translateZ(0);\n}\n.read-record-container-hide {\n  -webkit-transform: translateX(270px) translateZ(0);\n          transform: translateX(270px) translateZ(0);\n}\n#supportFrame-container {\n  position: absolute;\n  width: 381px;\n  height: 331px;\n  background: none;\n  z-index: 9007;\n  margin: auto;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  background-color: white;\n}\n#supportFrame {\n  position: relative;\n  width: 100%;\n  height: 100%;\n  border: none;\n}\n.iphoneXCheckDiv {\n  height: 0px;\n  width: 0px;\n  width: constant(safe-area-inset-bottom);\n  /* \u517c\u5bb9 iOS < 11.2 */\n  width: env(safe-area-inset-bottom);\n  /* \u517c\u5bb9 iOS >= 11.2 */\n}\n#Template-Panel {\n  position: absolute;\n  top: 1px;\n  height: calc(100% + 30px);\n  background: none;\n  z-index: 500;\n  right: 0px;\n  transition: all 0.3s ease-in;\n  -webkit-transform: translateX(100%) translateZ(0);\n          transform: translateX(100%) translateZ(0);\n  box-sizing: border-box;\n  padding-bottom: 30px;\n}\n.ipad #Template-Panel {\n  top: 55px;\n  height: calc(100% - 90px);\n  z-index: 501;\n}\n#Template-Panel.Template-Panel-show {\n  -webkit-transform: translateX(0px) translateZ(0);\n          transform: translateX(0px) translateZ(0);\n}\n/**\n * \u8fd9\u91cc\u4e34\u65f6\u65b9\u6848\uff0c\u4e3a\u4e86\u52a0\u8f7dspread-sheet\u7528\u5230\u56fe\u7247\uff0c\u540e\u7eed\u8fd9\u4e9b\u90fd\u5f97\u8fc1\u79fb\u5230spread-sheet\u81ea\u5df1\u63a7\u5236\n * \u800c\u4e0d\u662f\u4ea4\u7ed9core-sheet\u53bb\u6253\u5305 \n */\n.spread-sheet-images-all {\n  background: url("+r+");\n  background: url("+s+");\n  background: url("+l+");\n  background: url("+d+");\n  background: url("+c+");\n  background: url("+u+");\n  background: url("+p+");\n}\n",""])},"../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/lib/index.js?!../node_modules/less-loader/dist/cjs.js!./css/index-pc.less":function(e,t,n){t=e.exports=n("../node_modules/css-loader/dist/runtime/api.js")(!1);var o=n("../node_modules/css-loader/dist/runtime/url-escape.js"),i=o(n("./css/img/images/brandlogo/logo-sprites-new.png")),a=o(n("./css/img/images/auth_tips_icon_1.svg")),r=o(n("./css/img/images/close.png")),s=o(n("./css/img/images/pc-preview-tip-icon.png")),l=o(n("./css/img/images/newpic/dropdown-triangle.png")),d=o(n("./css/img/images/newpic/separator.png"));t.push([e.i,"/* Redesign */\n/* Re-redesign. */\n.brand_title {\n  display: inline-block;\n  position: relative;\n}\n.brand_logo {\n  left: 20px;\n  position: absolute;\n  top: 16px;\n}\n.brand_back_icon {\n  width: 100%;\n  height: 100%;\n  cursor: pointer;\n}\n.tim-web .brand_back {\n  position: absolute;\n  width: 17px;\n  height: 17px;\n  top: 13px;\n  left: 0px;\n  background: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 17 17'%3E%3Cpath fill='none' stroke='%23000' stroke-width='2' d='M10.82 12.87L6.45 8.5l4.37-4.37' opacity='.4'/%3E%3C/svg%3E\");\n  background-size: 17px 17px;\n  /* // &:hover {\n    //     background: url(\"~img/newpic/pad_head_brand_back_hover.png\") no-repeat;\n    //     background-size: 17px 17px;\n    // }\n    // &.hover {\n    //     background: url(\"~img/newpic/pad_head_brand_back_hover.png\") no-repeat;\n    //     background-size: 17px 17px;\n    // } */\n}\n.tim-web .brand_text {\n  display: none;\n}\n.brand-container {\n  position: absolute;\n  left: 11px;\n  top: 6px;\n  width: 40px;\n  height: 35px;\n}\n.brand-container:hover .brand_logo_new {\n  -webkit-animation-name: keyframes-logo;\n          animation-name: keyframes-logo;\n  -webkit-animation-duration: 0.96s;\n          animation-duration: 0.96s;\n  -webkit-animation-delay: 0s;\n          animation-delay: 0s;\n  -webkit-animation-iteration-count: infinite;\n          animation-iteration-count: infinite;\n  -webkit-animation-fill-mode: forwards;\n          animation-fill-mode: forwards;\n  -webkit-animation-timing-function: steps(1);\n          animation-timing-function: steps(1);\n}\n.brand-container:hover .brand_back {\n  background: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 17 17'%3E%3Cpath fill='none' stroke='%230188fb' stroke-width='2' d='M10.82 12.87L6.45 8.5l4.37-4.37'/%3E%3C/svg%3E\");\n  background-size: 17px 17px;\n}\n.brand_logo_new {\n  background-image: url("+i+");\n  background-size: 1440px 60px;\n  background-position: 0px 0px;\n  background-repeat: no-repeat;\n  width: 60px;\n  height: 60px;\n  cursor: pointer;\n  top: -9px;\n  left: 2px;\n  vertical-align: middle;\n  position: absolute;\n  -webkit-transform: scale(0.5);\n          transform: scale(0.5);\n}\n@-webkit-keyframes keyframes-logo {\n  0% {\n    width: 60px;\n    height: 60px;\n    background-position: 0px 0px;\n  }\n  4.17% {\n    background-position: -60px 0px;\n  }\n  8.33% {\n    background-position: -120px 0px;\n  }\n  12.50% {\n    background-position: -180px 0px;\n  }\n  16.67% {\n    background-position: -240px 0px;\n  }\n  20.83% {\n    background-position: -300px 0px;\n  }\n  25.00% {\n    background-position: -360px 0px;\n  }\n  29.17% {\n    background-position: -420px 0px;\n  }\n  33.33% {\n    background-position: -480px 0px;\n  }\n  37.50% {\n    background-position: -540px 0px;\n  }\n  41.67% {\n    background-position: -600px 0px;\n  }\n  45.83% {\n    background-position: -660px 0px;\n  }\n  50.00% {\n    background-position: -720px 0px;\n  }\n  54.17% {\n    background-position: -780px 0px;\n  }\n  58.33% {\n    background-position: -840px 0px;\n  }\n  62.50% {\n    background-position: -900px 0px;\n  }\n  66.67% {\n    background-position: -960px 0px;\n  }\n  70.83% {\n    background-position: -1020px 0px;\n  }\n  75.00% {\n    background-position: -1080px 0px;\n  }\n  79.17% {\n    background-position: -1140px 0px;\n  }\n  83.33% {\n    background-position: -1200px 0px;\n  }\n  87.50% {\n    background-position: -1260px 0px;\n  }\n  91.67% {\n    background-position: -1320px 0px;\n  }\n  95.83%,\n  100% {\n    background-position: -1380px 0px;\n  }\n}\n@keyframes keyframes-logo {\n  0% {\n    width: 60px;\n    height: 60px;\n    background-position: 0px 0px;\n  }\n  4.17% {\n    background-position: -60px 0px;\n  }\n  8.33% {\n    background-position: -120px 0px;\n  }\n  12.50% {\n    background-position: -180px 0px;\n  }\n  16.67% {\n    background-position: -240px 0px;\n  }\n  20.83% {\n    background-position: -300px 0px;\n  }\n  25.00% {\n    background-position: -360px 0px;\n  }\n  29.17% {\n    background-position: -420px 0px;\n  }\n  33.33% {\n    background-position: -480px 0px;\n  }\n  37.50% {\n    background-position: -540px 0px;\n  }\n  41.67% {\n    background-position: -600px 0px;\n  }\n  45.83% {\n    background-position: -660px 0px;\n  }\n  50.00% {\n    background-position: -720px 0px;\n  }\n  54.17% {\n    background-position: -780px 0px;\n  }\n  58.33% {\n    background-position: -840px 0px;\n  }\n  62.50% {\n    background-position: -900px 0px;\n  }\n  66.67% {\n    background-position: -960px 0px;\n  }\n  70.83% {\n    background-position: -1020px 0px;\n  }\n  75.00% {\n    background-position: -1080px 0px;\n  }\n  79.17% {\n    background-position: -1140px 0px;\n  }\n  83.33% {\n    background-position: -1200px 0px;\n  }\n  87.50% {\n    background-position: -1260px 0px;\n  }\n  91.67% {\n    background-position: -1320px 0px;\n  }\n  95.83%,\n  100% {\n    background-position: -1380px 0px;\n  }\n}\n#web_header_top_split {\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  height: 60px;\n  text-align: left;\n  background-color: #fff;\n  box-shadow: 0 2px 4px rgba(20, 20, 20, 0.1);\n  z-index: 999;\n}\n#web_header_top_split #title_split {\n  position: absolute;\n  font-size: 21px;\n  vertical-align: middle;\n  line-height: 60px;\n  margin-left: 20px;\n}\n#web_header_top_split #editor_split {\n  position: relative;\n  vertical-align: middle;\n  line-height: 60px;\n  font-size: 14px;\n  text-align: left;\n  color: #777;\n  margin-left: 10px;\n}\n.web_header_top.scroll {\n  box-shadow: 0 1px 0 rgba(20, 20, 20, 0.15);\n}\n.web_header_bottom.scroll {\n  box-shadow: 0 2px 4px rgba(20, 20, 20, 0.15);\n}\n#web_header_extra_container {\n  position: relative;\n  right: 78px;\n  z-index: 3;\n  display: none;\n  float: right;\n  width: auto;\n  height: 40px;\n  text-align: right;\n  margin-left: 16px;\n  padding-top: 13px;\n}\n#web_header_extra_container:before {\n  display: inline-block;\n  content: \"\";\n  position: absolute;\n  width: 1px;\n  height: 18px;\n  opacity: 0.08;\n  background-color: #000;\n  top: 18px;\n  left: -21px;\n}\n#web_header_extra_container:after {\n  display: inline-block;\n  content: \"\";\n  position: absolute;\n  width: 1px;\n  height: 18px;\n  opacity: 0.08;\n  background-color: #000;\n  top: 18px;\n  right: -14px;\n}\n#web_header_tool_tabs_container {\n  position: relative;\n  top: -1px;\n  right: 86px;\n  z-index: 2;\n  display: none;\n  float: right;\n  width: auto;\n  text-align: right;\n  padding-top: 10px;\n  margin-top: 3px;\n  font-size: 0;\n  margin-left: 20px;\n}\n#web_header_tool_tabs_container #moremenu {\n  display: none;\n}\n#web_header_tool_tabs_container.hp-ui-button-group > * {\n  margin-right: 0;\n}\n#web_header_tool_tabs_container .toolbar-inline-block {\n  display: inline-block;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper {\n  display: inline-block;\n  height: 28px;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper:hover {\n  background-color: rgba(0, 0, 0, 0.04);\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper:active {\n  background-color: rgba(0, 0, 0, 0.08);\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper.pressed {\n  background-color: rgba(0, 0, 0, 0.08) !important;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper .toolbar-menu-button-dropdown {\n  display: none;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper .toolbar-menu-button-inner-container {\n  height: 28px;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-wrapper .toolbar-menu-button-inner-container .toolbar-menu-button-icon {\n  line-height: 28px;\n  height: 28px;\n  padding: 0 13px;\n  font-size: 14px;\n  color: rgba(0, 0, 0, 0.8);\n}\n#web_header_tool_tabs_container .toolbar-button-wrapper-checked {\n  background-color: rgba(0, 0, 0, 0.08) !important;\n}\n#web_header_tool_tabs_container .toolbar-menu-button-outer-container {\n  padding-right: 0;\n}\n#web_header_tool_tabs_container .dropdown-wrapper .li-dropdown {\n  color: rgba(0, 0, 0, 0.88);\n  height: 32px;\n}\n#web_header_tool_tabs_container .dropdown-wrapper .dropdown-ic-img {\n  width: 12px;\n}\n#web_header_tool_tabs_container .dropdown-wrapper .dropdown-separator-wrapper {\n  padding: 8px 1px;\n}\n#web_header_tool_tabs_container .dropdown-wrapper .dropdown-separator-wrapper .dropdown-separator {\n  background-color: rgba(0, 0, 0, 0.04);\n}\n#web_header_tool_tabs_container .dropdown-wrapper .dropdown-tip-wrapper {\n  color: rgba(0, 0, 0, 0.48);\n}\n.tim-web .toolbar-auth-btn,\n.toolbar-create-btn {\n  position: relative;\n  width: 70px;\n  height: 28px;\n  font-family: \"\u5fae\u8f6f\u96c5\u9ed1\", Verdana, sans-serif;\n  font-size: 14px;\n  cursor: pointer;\n  overflow: visible;\n  text-align: center;\n  vertical-align: middle;\n  color: rgba(0, 0, 0, 0.8);\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  border-radius: 2px;\n  background-color: rgba(255, 255, 255, 0.64);\n  margin-right: 20px;\n}\n.tim-web .toolbar-auth-btn:hover,\n.toolbar-create-btn:hover {\n  background-color: rgba(0, 0, 0, 0.02);\n}\n.tim-web .toolbar-auth-btn:active,\n.toolbar-create-btn:active {\n  background-color: rgba(0, 0, 0, 0.06);\n}\n.toolbar-auth-btn .toolbar-auth-btn-text {\n  display: inline-block;\n  vertical-align: middle;\n  position: relative;\n  left: -2px;\n  line-height: 14px;\n  color: rgba(0, 0, 0, 0.64);\n}\n.toolbar-auth-btn .toolbar-auth-btn-text.private {\n  left: -4px;\n  top: 1px;\n  padding-bottom: 0px;\n}\n.toolbar-auth-btn-image {\n  -webkit-transform: translateX(1px);\n          transform: translateX(1px);\n}\n.toolbar-auth-btn-text {\n  -webkit-transform: translateX(0.5px);\n          transform: translateX(0.5px);\n}\n.toolbar-auth-btn-disabled,\n.toolbar-auth-btn-disabled:hover,\n.toolbar-auth-btn-disabled:active,\n.toolbar-create-btn-disabled,\n.toolbar-create-btn-disabled:hover,\n.toolbar-create-btn-disabled:active {\n  opacity: 0.2;\n}\n.toolbar-auth-btn-image {\n  display: inline-block;\n  vertical-align: middle;\n  margin-left: 2px;\n}\n.toolbar-auth-btn-image.private {\n  margin-left: 8px;\n}\n.auth-tip {\n  position: absolute;\n  left: 0;\n  top: 38px;\n  z-index: 999;\n  padding: 6px 10px 6px 26px;\n  line-height: 14px;\n  border-radius: 2px;\n  box-shadow: 0px 2px 6px 0px rgba(0, 0, 0, 0.1);\n  background-color: #fff;\n  font-size: 14px;\n  word-wrap: break-word;\n  word-break: break-all;\n  color: rgba(0, 0, 0, 0.8);\n  font-family: \"Microsoft YaHei\", \"\u5fae\u8f6f\u96c5\u9ed1\", \"\u9ed1\u4f53\", \"\u5b8b\u4f53\", sans-serif;\n  border: 1px solid #e0e0e0;\n  text-align: left;\n  letter-spacing: 1px;\n  max-width: 300px;\n  display: none;\n}\n.auth-tip:before {\n  content: '';\n  width: 28px;\n  height: 10px;\n  position: absolute;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 28 10'%3E%3Cpath d='M18.84 10l-3.41-3.41a2 2 0 0 0-2.83 0L9.19 10H7.77l4.12-4.12a3 3 0 0 1 4.24 0L20.26 10z' fill='%23e0e0e0'/%3E%3Cpath d='M9.19 10l3.41-3.41a2 2 0 0 1 2.83 0L18.84 10z' fill='%23fff'/%3E%3C/svg%3E\");\n  background-size: 28px 10px;\n  top: -10px;\n  margin-left: -14px;\n  left: 50%;\n}\n.auth-tip-icon {\n  position: absolute;\n  left: 5px;\n  top: 4px;\n  display: inline-block;\n}\n.import-auth-guide {\n  position: absolute;\n  right: 95px;\n  top: 63px;\n  z-index: 999;\n  padding: 10px 12px;\n  line-height: 1.14;\n  border-radius: 5px;\n  box-shadow: 0 4px 10px 0 rgba(0, 0, 0, 0.1), 0 0 10px 0 rgba(0, 0, 0, 0.06);\n  background-color: #fff;\n  font-size: 14px;\n  word-wrap: break-word;\n  word-break: break-all;\n  color: rgba(0, 0, 0, 0.88);\n  font-family: \"PingFang SC\", \"Microsoft YaHei\", \"\u9ed1\u4f53\", \"\u5b8b\u4f53\", sans-serif;\n  border: 1px solid #e0e0e0;\n  text-align: left;\n}\n.import-auth-guide:before {\n  content: '';\n  width: 28px;\n  height: 10px;\n  position: absolute;\n  background-image: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 28 10'%3E%3Cpath d='M18.84 10l-3.41-3.41a2 2 0 0 0-2.83 0L9.19 10H7.77l4.12-4.12a3 3 0 0 1 4.24 0L20.26 10z' fill='%23e0e0e0'/%3E%3Cpath d='M9.19 10l3.41-3.41a2 2 0 0 1 2.83 0L18.84 10z' fill='%23fff'/%3E%3C/svg%3E\");\n  background-size: 28px 10px;\n  top: -10px;\n  margin-left: -14px;\n  right: 20px;\n}\n.import-auth-guide .invite-guest-member {\n  color: #018ffb;\n  cursor: pointer;\n  margin-left: 20px;\n}\n.new-auth-guide {\n  position: absolute;\n  right: -18px;\n  height: 80px;\n  width: 288px;\n  top: 50px;\n  z-index: 999;\n  font-size: 16px;\n  font-style: normal;\n  font-stretch: normal;\n  line-height: 16px;\n  letter-spacing: normal;\n  text-align: left;\n  border-radius: 2px;\n  letter-spacing: 0px;\n  box-shadow: 0 2px 3px #ccc;\n  background-color: #0687FC;\n  word-wrap: break-word;\n  word-break: break-all;\n  color: #fff;\n  border: 0;\n  display: none;\n}\n.new-auth-guide:after {\n  content: \"\";\n  position: absolute;\n  width: 0;\n  height: 0;\n  top: -15px;\n  margin-left: -15px;\n  left: 50%;\n  border: 10px solid transparent;\n  border-bottom-color: #0687FC;\n  border-bottom-width: 7px;\n}\n.new-auth-guide-warpper {\n  display: flex;\n}\n.new-auth-guide-icon {\n  width: 81px;\n  height: 96px;\n  margin-top: -9px;\n  margin-left: 13.5px;\n  background: url("+a+") no-repeat;\n}\n.new-auth-guide-tip-warpper {\n  margin-left: 91.5px;\n  margin-top: 28px;\n}\n.new-auth-guide-tip {\n  margin-top: 9px;\n}\n.new-auth-guide-close-icon {\n  position: absolute;\n  right: 0;\n  top: 0;\n  margin-right: 12px;\n  margin-top: 12px;\n  width: 12px;\n  height: 12px;\n  background: url("+r+") no-repeat;\n  background-size: 12px 12px;\n}\n.new-auth-guide-close-button {\n  position: absolute;\n  width: 30px;\n  height: 30px;\n  right: 0;\n  top: 0;\n  background: transparent;\n  border: 0;\n  cursor: pointer;\n}\n.sharebutton {\n  display: none;\n  position: relative;\n  width: 68px;\n  height: 28px;\n  font-family: \"\u5fae\u8f6f\u96c5\u9ed1\", Verdana, sans-serif;\n  font-size: 14px;\n  line-height: 100%;\n  vertical-align: middle;\n  cursor: pointer;\n  text-align: center;\n  color: white;\n  border: 0;\n  border-radius: 1px;\n}\n.sharebutton.header-function-btn-blue-normal {\n  background-color: #0188FB;\n}\n.sharebutton.header-function-btn-blue-hover {\n  background-color: #47ABFF;\n}\n.sharebutton.header-function-btn-blue-selected {\n  background-color: #0188FB;\n}\n.sharebutton.white {\n  border: 1px solid #e1e3e5;\n  color: #333333;\n  background: #fff !important;\n  height: 30px;\n}\n.sharebutton.sharebutton-disabled {\n  cursor: default;\n  opacity: 0.2;\n}\n.toolbar-auth-btn {\n  display: none;\n}\n.web_header_readonly_tip_container {\n  position: relative;\n  top: 16px;\n  margin-left: 2px;\n  margin-right: 8px;\n  display: none;\n  width: 67px;\n  height: 21px;\n  font-family: \"Microsoft YaHei\", \"\u5fae\u8f6f\u96c5\u9ed1\", Verdana, \"\u9ed1\u4f53\", \"\u5b8b\u4f53\", sans-serif;\n  line-height: 21px;\n  float: left;\n}\n.web_header_readonly_tip {\n  display: inline-block;\n  width: 67px;\n  height: 21px;\n  border-radius: 2px;\n  border: 0;\n  cursor: pointer;\n  text-align: left;\n  line-height: 21px;\n}\n.readonly_tip_text {\n  display: inline-block;\n  font-size: 12px;\n  line-height: 21px;\n  color: #fff;\n  vertical-align: top;\n  padding-left: 5px;\n}\n.readonly_tip_right_arrow {\n  display: inline-block;\n  margin-left: 4px;\n  vertical-align: top;\n  margin-top: 9px;\n}\n.readonly_tip_text {\n  display: inline-block;\n  font-size: 12px;\n  line-height: 21px;\n  color: #fff;\n  vertical-align: top;\n  padding-left: 5px;\n}\n.readonly_tip_right_arrow {\n  display: inline-block;\n  margin-left: 4px;\n  vertical-align: top;\n  margin-top: 9px;\n}\n.form-preview-tip-text {\n  background-color: rgba(0, 0, 0, 0.33);\n  padding-left: 3px;\n  box-sizing: border-box;\n}\n.readonly_tip_popup {\n  position: absolute;\n  top: 30px;\n  z-index: 100;\n  display: none;\n  width: 242px;\n  height: 96px;\n  overflow: hidden;\n  font-size: 14px;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n  white-space: pre-wrap;\n  word-break: break-word;\n  color: #333;\n  background: white;\n}\n.toolbar-only-read-tip-main-content {\n  color: #333;\n  font-size: 14px;\n  line-height: 21px;\n  padding: 11px 16px 0px 16px;\n}\n.toolbar-only-read-tip-sec-content {\n  float: right;\n  color: #008fff;\n  font-size: 14px;\n  margin-top: 12px;\n  margin-right: 16px;\n  cursor: pointer;\n}\n.toolbar-only-read-tip-sec-content:hover {\n  color: #1ea8ff;\n}\n.toolbar-only-read-tip-sec-content:active {\n  color: #007eea;\n}\n.readonly_tip_popup .apply-button {\n  color: #018ffb;\n  cursor: pointer;\n}\n.readonly_tip_popup .apply-button:hover {\n  color: #49affd;\n}\n.readonly_tip_popup .apply-button:active {\n  color: #017ddb;\n}\n.readonly_tip_popup .blankline {\n  height: 6px;\n}\n.editor-last-changed-web {\n  position: relative;\n  z-index: 9999;\n  font-size: 14px;\n  cursor: default;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  background-color: #777;\n  float: left;\n  text-align: left;\n  top: 19px;\n  width: 16px;\n  height: 16px;\n  border-radius: 16px;\n  display: none;\n  margin-left: 5px;\n  opacity: 0.48;\n}\n.editor-last-changed-web #editor-last-state-icon-container {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n}\n.editor-last-changed-web #editor-last-state-text-container {\n  font-size: 12px;\n  color: #000;\n  margin-left: 4px;\n  vertical-align: top;\n}\n.auto-save-icon {\n  background: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:none;stroke:%237d7d7d;stroke-miterlimit:10%7D%3C/style%3E%3C/defs%3E%3Ccircle class='cls-1' cx='8.02' cy='8.02' r='6.5'/%3E%3Cpath class='cls-1' d='M11.82 5.71L7.33 10.2 4.66 7.53'/%3E%3C/svg%3E\");\n}\n.save-offline-icon {\n  background: url(\"data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 16 16'%3E%3Cdefs%3E%3Cstyle%3E.cls-1%7Bfill:%23fe6c6c%7D%3C/style%3E%3C/defs%3E%3Cpath class='cls-1' d='M0 5.31A11.22 11.22 0 0 1 6.49 2.1v1A10.2 10.2 0 0 0 .74 6zM16 5.31l-.74.69a10.2 10.2 0 0 0-5.75-2.9v-1A11.22 11.22 0 0 1 16 5.31zM2.45 7.73a7.76 7.76 0 0 1 4-2.15v1a6.76 6.76 0 0 0-3.29 1.86zM13.55 7.73l-.71.71a6.76 6.76 0 0 0-3.33-1.83v-1a7.76 7.76 0 0 1 4.04 2.12zM4.88 10.15a4.29 4.29 0 0 1 1.61-1v1.1a3.3 3.3 0 0 0-.91.63zM11.12 10.15l-.7.71a3.3 3.3 0 0 0-.91-.63v-1.1a4.29 4.29 0 0 1 1.61 1.02zM7.5 1.72h1v8.82h-1z'/%3E%3Ccircle class='cls-1' cx='8' cy='13.04' r='.98' transform='rotate(-45 8.003 13.045)'/%3E%3C/svg%3E\");\n  height: 16px;\n}\n#tooltip.editor-state-tip {\n  white-space: pre-wrap;\n}\n#padAloneTitle {\n  display: inline-block;\n  visibility: hidden;\n  text-shadow: rgba(0, 0, 0, 0) 0 0 0;\n}\n#padAloneTitle.tim-web {\n  visibility: visible;\n  border: 1px solid transparent;\n  background: transparent;\n  cursor: auto;\n  width: 229px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  font-family: \"Microsoft YaHei\", Verdana, sans-serif;\n  margin-left: 65px;\n  font-size: 18px;\n  position: relative;\n  display: inline-block;\n  padding: 1px 4px;\n  max-width: 370px;\n  box-sizing: border-box;\n  color: #000000;\n  margin-top: 13px;\n  float: left;\n  min-width: 15px;\n}\n#padAloneTitle.tim-web:hover {\n  border: 1px solid #e5e5e5;\n}\n#padAloneTitle.tim-web:focus {\n  border: 1px solid #4d90fe;\n  -webkit-appearance: none;\n  color: #333333 !important;\n}\n#padAloneTitle.tim-web-unlogin {\n  border: 0 !important;\n}\n#padAloneTitle.tim-web-unlogin:hover {\n  border: 0 !important;\n}\n#padAloneTitle.tim-web-unlogin:focus {\n  border: 0 !important;\n}\n.editor-last-state-web {\n  text-align: left;\n  font-size: 14px;\n  display: inline-block;\n  z-index: 9999;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  cursor: default;\n  position: relative;\n  float: left;\n  top: 19px;\n  height: 16px;\n  border-radius: 16px;\n  display: none;\n  margin-left: 5px;\n  opacity: 0.48;\n}\n.editor-last-state-web .save-offline-icon {\n  opacity: 1;\n}\n.editor-last-state-web #editor-last-state-icon-container {\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n}\n.editor-last-state-web #editor-last-state-text-container {\n  font-size: 12px;\n  color: #000;\n  margin-left: 4px;\n  vertical-align: top;\n}\n#grid-preview {\n  top: 0px;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  z-index: 666;\n  overflow: hidden;\n}\n.web_header_preview_icon_pos {\n  position: relative;\n  display: inline-block;\n  top: 32px;\n  left: 74px;\n  width: 64px;\n  height: 19px;\n  background-image: url("+s+');\n}\n.preview-bottom-collect-btn {\n  color: black;\n  background-color: white;\n  display: none;\n}\n.preview-bottom-edit-btn {\n  color: white;\n  background-color: #0188fb;\n  display: none;\n}\n.preview-qrcode-pc {\n  position: absolute;\n  top: 22px;\n  right: 68px;\n  padding: 0px 8px 0px 0px;\n  border-radius: 2px;\n  z-index: 999;\n}\n.preview-qrcode-pc-icon {\n  display: inline-block;\n  vertical-align: middle;\n}\n.preview-qrcode-pc-text {\n  display: inline-block;\n  vertical-align: middle;\n  margin-left: 2px;\n  height: 28px;\n  line-height: 28px;\n  color: #333333;\n  font-size: 14px;\n}\n.unlogin-container {\n  position: absolute;\n  width: auto;\n  font-size: 14px;\n  font-family: "Microsoft YaHei", Verdana, sans-serif;\n  line-height: 22px;\n  top: 13px;\n  right: 34px;\n}\n.login-container,\n.login-container-placeholder {\n  position: absolute;\n  width: 28px;\n  height: 28px;\n  top: 13px;\n  right: 18px;\n  z-index: 10000;\n}\n.blankpage-login-container .unlogin-container,\n.blankpage-login-container .login-container {\n  position: absolute;\n  width: auto;\n  font-size: 14px;\n  font-family: "Microsoft YaHei", Verdana, sans-serif;\n  line-height: 22px;\n  top: 50%;\n  -webkit-transform: translateY(-50%);\n          transform: translateY(-50%);\n  right: 18px;\n}\n.unlogin-hint {\n  color: #333333;\n  font-size: 14px;\n}\n.login-button {\n  display: inline-block;\n  width: 110px;\n  height: 32px;\n  border-radius: 2px;\n  text-align: center;\n  line-height: 32px;\n  color: white;\n  font-size: 14px;\n  cursor: pointer;\n}\n.login-frame-container {\n  position: fixed;\n  padding: 0;\n  left: 50%;\n  top: 50%;\n  transform: translate(-50%, -50%);\n  -ms-transform: translate(-50%, -50%);\n  -webkit-transform: translate(-50%, -50%);\n  z-index: 1000;\n}\n.login-container .user-info-container {\n  width: 28px;\n  height: 28px;\n  border: 2px solid rgba(0, 0, 0, 0.06);\n  border-radius: 100%;\n  box-sizing: border-box;\n}\n.login-container-placeholder .user-info-container-placeholder {\n  width: 28px;\n  height: 28px;\n  padding: 2px;\n  border-radius: 50%;\n}\n.login-container .user-info-container.header-function-btn-hover {\n  background: rgba(0, 0, 0, 0.1);\n}\n.login-container .user-info-container.header-function-btn-selected {\n  background: rgba(0, 0, 0, 0.2);\n}\n.login-container .user-info-container .redpoint {\n  height: 16px;\n  border-radius: 16px;\n  background: #fb2c19;\n  position: absolute;\n  top: -7px;\n  line-height: 16px;\n  text-align: center;\n  font-size: 12px;\n  color: #fff;\n  border: 1px solid #fff;\n  display: none;\n}\n.login-container .user-info-container .redpoint.one {\n  width: 16px;\n  left: 17px;\n  display: block;\n}\n.login-container .user-info-container .redpoint.two {\n  width: 23px;\n  left: 17px;\n  display: block;\n}\n.login-container .user-info-container .redpoint.three {\n  width: 30px;\n  left: 15px;\n  display: block;\n}\n.user-info-avatar,\n.user-info-avatar-placeholder {\n  width: 24px;\n  height: 24px;\n}\n.user-info-avatar .user-info-img {\n  width: 24px;\n  height: 24px;\n  position: relative;\n  top: 0;\n  left: 0;\n}\n.login-dropdown {\n  display: none;\n  position: absolute;\n  background-color: white;\n  right: 0px;\n  border: 0;\n  width: 204px;\n  height: 183px;\n  top: 45px;\n  padding: 24px 24px 8px 24px;\n  box-sizing: content-box;\n}\n.login-info-container {\n  display: inline-block;\n  height: 20px;\n  width: auto;\n}\n.user-info-img {\n  height: 56px;\n  width: 56px;\n  left: 24px;\n  top: 20px;\n  position: absolute;\n  border-radius: 28px;\n}\n.login-dropdown-nick {\n  position: absolute;\n  left: 92px;\n  top: 24px;\n  font-size: 20px;\n  max-width: 121px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  color: #333333;\n}\n.login-dropdown-uin {\n  position: absolute;\n  left: 94px;\n  top: 51px;\n  font-size: 14px;\n  color: #777777;\n  max-width: 115px;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n.separator-line {\n  height: 1px;\n  background: #f2f2f2;\n}\n.separator-line.first-margin {\n  margin-top: 39px;\n}\n.login-dropdown-line {\n  padding: 9px 24px;\n  font-size: 14px;\n  position: relative;\n  width: 204px;\n  left: -24px;\n  cursor: pointer;\n  height: 24px;\n  line-height: 24px;\n}\n.login-dropdown-line:hover {\n  background: #f5f5f5;\n}\n.login-dropdown-line:active {\n  background: #e6e6e6;\n}\n.login-dropdown-line .redpoint {\n  position: absolute;\n  width: 18px;\n  height: 18px;\n  background: #EF4E2F;\n  border-radius: 50%;\n  right: 24px;\n  top: 12px;\n  color: #fff;\n  text-align: center;\n  line-height: 18px;\n  display: none;\n}\n.switch-account-button,\n.logout-button,\n.notification-line {\n  font-size: 14px;\n  cursor: pointer;\n  font-family: "\u5fae\u8f6f\u96c5\u9ed1", Verdana, sans-serif;\n  color: #333333;\n}\n.logout-button {\n  right: 20px;\n  top: 92px;\n}\n.switch-account-button {\n  left: 20px;\n  top: 92px;\n}\n.feedback-button:hover {\n  border-bottom: 1px solid #777777;\n}\n.user-info-nick {\n  height: 18px;\n  vertical-align: middle;\n  font-size: 12px;\n  color: #333333;\n  margin-left: 5px;\n  margin-top: -11px;\n  font-family: "Microsoft YaHei", Verdana, sans-serif;\n  line-height: 20px;\n  display: inline-block;\n}\n.user-info-container {\n  cursor: pointer;\n}\n.user-info-nick-triangle {\n  background: url('+l+");\n  margin: -9px 5px 0 0px;\n  padding: 0;\n  vertical-align: middle;\n  width: 7px;\n  height: 4px;\n}\n.user-info-nick-triangle:hover {\n  opacity: 0.5;\n}\n.userline-separator {\n  width: 1px;\n  vertical-align: middle;\n  margin-left: 9px;\n  background-image: url("+d+");\n  height: 26px;\n}\n",""])},"../node_modules/css-loader/dist/cjs.js!./css/sprites/toolbar_sprite.css":function(e,t,n){t=e.exports=n("../node_modules/css-loader/dist/runtime/api.js")(!1);var o=n("../node_modules/css-loader/dist/runtime/url-escape.js"),i=o(n("./css/img/images/toolbar_sprite.png")),a=o(n("./css/img/images/toolbar_sprite@2x.png"));t.push([e.i,'/*\nIcon classes can be used entirely standalone. They are named after their original file names.\n\nExample usage in HTML:\n\n`display: block` sprite:\n<div class="icon-home"></div>\n\nTo change `display` (e.g. `display: inline-block;`), we suggest using a common CSS class:\n\n// CSS\n.icon {\n  display: inline-block;\n}\n\n// HTML\n<i class="icon icon-home"></i>\n*/\n.auth-tip-cooperation {\n  background-image: url('+i+");\n  background-position: -98px -232px;\n  width: 20px;\n  height: 20px;\n}\n.auth-tip-edit {\n  background-image: url("+i+");\n  background-position: -58px -232px;\n  width: 20px;\n  height: 20px;\n}\n.auth-tip-eye {\n  background-image: url("+i+");\n  background-position: -118px -232px;\n  width: 20px;\n  height: 20px;\n}\n.auth-tip-lock-add {\n  background-image: url("+i+");\n  background-position: -138px -232px;\n  width: 20px;\n  height: 20px;\n}\n.auth-tip-lock {\n  background-image: url("+i+");\n  background-position: -78px -232px;\n  width: 20px;\n  height: 20px;\n}\n.banner-left-corner {\n  background-image: url("+i+");\n  background-position: -80px -190px;\n  width: 32px;\n  height: 32px;\n}\n.banner-right-corner {\n  background-image: url("+i+");\n  background-position: 0px -232px;\n  width: 32px;\n  height: 43px;\n}\n.check-blue-62_46dp {\n  background-image: url("+i+");\n  background-position: -352px -132px;\n  width: 62px;\n  height: 46px;\n}\n.close-click_20dp {\n  background-image: url("+i+");\n  background-position: -158px -232px;\n  width: 20px;\n  height: 20px;\n}\n.close-hover_20dp {\n  background-image: url("+i+");\n  background-position: -178px -232px;\n  width: 20px;\n  height: 20px;\n}\n.close-normal_20dp {\n  background-image: url("+i+");\n  background-position: -198px -232px;\n  width: 20px;\n  height: 20px;\n}\n.common-close-bt-hover {\n  background-image: url("+i+");\n  background-position: -164px -190px;\n  width: 16px;\n  height: 16px;\n}\n.common-close-bt-normal {\n  background-image: url("+i+");\n  background-position: -148px -190px;\n  width: 16px;\n  height: 16px;\n}\n.common-dialog-banner-close {\n  background-image: url("+i+");\n  background-position: -42px -190px;\n  width: 38px;\n  height: 38px;\n}\n.common-dialog-banner-header {\n  background-image: url("+i+");\n  background-position: -296px 0px;\n  width: 132px;\n  height: 132px;\n}\n.dialog-new-user-guide-header {\n  background-image: url("+i+");\n  background-position: 0px 0px;\n  width: 296px;\n  height: 190px;\n}\n.readonly_tip_arrow {\n  background-image: url("+i+");\n  background-position: -414px -132px;\n  width: 5px;\n  height: 3px;\n}\n.title-readonly-icon-normal {\n  background-image: url("+i+");\n  background-position: -112px -190px;\n  width: 36px;\n  height: 19px;\n}\n.toolbar-colorPicker-picker-paint-brush {\n  background-image: url("+i+");\n  background-position: -32px -232px;\n  width: 26px;\n  height: 26px;\n}\n.txdoc-logo_42dp {\n  background-image: url("+i+");\n  background-position: 0px -190px;\n  width: 42px;\n  height: 42px;\n}\n.txdoc-logo_56dp {\n  background-image: url("+i+");\n  background-position: -296px -132px;\n  width: 56px;\n  height: 56px;\n}\n\n@media (-webkit-min-device-pixel-ratio: 2),\n       (min-resolution: 192dpi) {\n  .auth-tip-cooperation {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .auth-tip-edit {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .auth-tip-eye {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .auth-tip-lock-add {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .auth-tip-lock {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .banner-left-corner {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .banner-right-corner {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .check-blue-62_46dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .close-click_20dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .close-hover_20dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .close-normal_20dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .common-close-bt-hover {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .common-close-bt-normal {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .common-dialog-banner-close {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .common-dialog-banner-header {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .dialog-new-user-guide-header {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .readonly_tip_arrow {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .title-readonly-icon-normal {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .toolbar-colorPicker-picker-paint-brush {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .txdoc-logo_42dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n  .txdoc-logo_56dp {\n    background-image: url("+a+");\n    background-size: 428px 275px;\n  }\n}\n",""])},"../spread-sheet/src/base/config/report.ts":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TDW_REPORT_ACTION=t.SPEED_REPORT_LOG=t.CSS_LOAD_FILE_MAP=t.JS_LOAD_FILE_MAP=t.REG_CSS_LOAD_FILE=t.REG_JS_LOAD_FILE=t.SPEED_REPORT_POINTS=t.EDIT_SPEED_REPORT_POINTS=t.SPEED_MARK_POINTS=t.TDW_VER5_VALUE=t.TDW_ACTION=t.TDW_MODULE=t.getTdwObj3Value=t.SENTRY_ERROR_TYPE=t.MONITOR_POINTS=t.CONFIG=t.reportTDWFlag=t.reportMonitorFlag=t.reportSpeedFlag=t.reportFlag=void 0;var o,i,a,r,s,l=n("../node_modules/babel-runtime/helpers/defineProperty.js"),d=(o=l)&&o.__esModule?o:{default:o};var c;!function(e){e[e.HISTORY=-1]="HISTORY",e[e.LOCAL=0]="LOCAL",e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO",e[e.COLLAB=3]="COLLAB"}(c||(c={}));var u,p,h,f,m,g,w={SHEET_ROW_COUNT_EXCEED:33977078,SHEET_COL_COUNT_EXCEED:33977079,SHEET_CELL_COUNT_EXCEED:33977080,CHECK_MUTATION_ERROR:33624582,CHECK_MUTATION_FAIL_MAP:(i={},(0,d.default)(i,c.HISTORY,33692346),(0,d.default)(i,c.LOCAL,33692347),(0,d.default)(i,c.UNDO,33692348),(0,d.default)(i,c.REDO,33692349),(0,d.default)(i,c.COLLAB,33692350),i),RUN_MUTATION_ERROR_MAP:(a={},(0,d.default)(a,c.HISTORY,33692646),(0,d.default)(a,c.LOCAL,33692647),(0,d.default)(a,c.UNDO,33692648),(0,d.default)(a,c.REDO,33692649),(0,d.default)(a,c.COLLAB,33692650),a),SERIALIZE_MUTATION_ERROR:33611128,DESERIALIZE_MUTATION_ERROR:33611915,DESERIALIZE_MUTATION_FAIL:33693655,MUTATION_VER_LOWER_THAN_SUPPORT:33910951,CONVERT_MUTATION_ERROR:33910952,MERGE_GRID_RANGE_ERROR:33659770,MERGE_ALREADY_EXIST:33659722,MERGE_POSITION_CENTER_KEY_NOT_EXIST:33659723};!function(e){e.CHECK_MUTATION_ERROR="CheckMutationError",e.RUN_MUTATION_ERROR="RunMutationError",e.SERIALIZE_MUTATION_ERROR="SerializeMutationError",e.DESERIALIZE_MUTATION_ERROR="DeserializeMutationError"}(u||(t.SENTRY_ERROR_TYPE=u={})),function(e){e.MUTATION="mutation"}(p||(t.TDW_MODULE=p={})),function(e){e.CHECK_MUTATION="checkMutation",e.RUN_MUTATION="runMutation",e.SERIALIZE_MUTATION="serializeMutation",e.DESERIALIZE_MUTATION="deserializeMutation",e.GENERATE_MUTATION="generateMutation"}(h||(t.TDW_ACTION=h={})),function(e){e.CHECK_MUTATION_ERROR="1",e.CHECK_MUTATION_FAIL="2",e.RUN_MUTATION_ERROR="1",e.SERIALIZE_MUTATION_ERROR="1",e.DESERIALIZE_MUTATION_ERROR="1",e.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_OPTION="1",e.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_EXPANSION="2",e.GENERATE_MUTATION_PASTE_SETRANGE_ERROR_NO_GRIDRANGE="3"}(f||(t.TDW_VER5_VALUE=f={})),function(e){e[e.SWITCH_SHEET_TIME_START=0]="SWITCH_SHEET_TIME_START",e[e.SWITCH_SHEET_TIME_END=1]="SWITCH_SHEET_TIME_END",e[e.CANVAS_TRANSFROM_START=2]="CANVAS_TRANSFROM_START",e[e.CANVAS_TRANSFROM_END=3]="CANVAS_TRANSFROM_END",e[e.CANVAS_RENDER_START=4]="CANVAS_RENDER_START",e[e.CANVAS_RENDER_END=5]="CANVAS_RENDER_END",e[e.PASTE_START=6]="PASTE_START",e[e.PASTE_END=7]="PASTE_END",e[e.TIME_COPY_START=8]="TIME_COPY_START",e[e.TIME_COPY_END=9]="TIME_COPY_END",e[e.MUTATIONS_RUN_START=10]="MUTATIONS_RUN_START",e[e.MUTATIONS_RUN_END=11]="MUTATIONS_RUN_END"}(m||(t.SPEED_MARK_POINTS=m={})),function(e){e[e.NAVIGATION_TO_FETCH=1]="NAVIGATION_TO_FETCH",e[e.FETCH_TO_REQUEST=2]="FETCH_TO_REQUEST",e[e.HTML_TO_REQUEST=3]="HTML_TO_REQUEST",e[e.CORE_TO_REQUEST=4]="CORE_TO_REQUEST",e[e.BOOT_START=5]="BOOT_START",e[e.BOOT_END=6]="BOOT_END",e[e.SPREAD_TO_REQUEST=7]="SPREAD_TO_REQUEST",e[e.SPREAD_INIT_START=8]="SPREAD_INIT_START",e[e.SPREAD_INIT_DATA_START=9]="SPREAD_INIT_DATA_START",e[e.SPREAD_INIT_END=10]="SPREAD_INIT_END",e[e.DATA_START=11]="DATA_START",e[e.DATA_END=12]="DATA_END",e[e.VIEW_START=13]="VIEW_START",e[e.VIEW_NEW_START=14]="VIEW_NEW_START",e[e.VIEW_NEW_END=15]="VIEW_NEW_END",e[e.VIEW_END=16]="VIEW_END",e[e.SPREAD_INIT_DATA_END=17]="SPREAD_INIT_DATA_END",e[e.SPREAD_INIT_FINISHED=18]="SPREAD_INIT_FINISHED",e[e.DNS=28]="DNS",e[e.CONNECT=29]="CONNECT",e[e.HTML_TTFB=30]="HTML_TTFB",e[e.HTML_LOAD=31]="HTML_LOAD",e[e.WHITE_SCREEN=32]="WHITE_SCREEN",e[e.SYNC_JS_RUN=33]="SYNC_JS_RUN",e[e.TOTAL_JS_RUN=34]="TOTAL_JS_RUN",e[e.DOM_CONTENT_LOAD=35]="DOM_CONTENT_LOAD",e[e.WINDOW_LOAD=36]="WINDOW_LOAD",e[e.KEYFRAME_MUTATIONS_LOAD=37]="KEYFRAME_MUTATIONS_LOAD",e[e.KEYFRAME_TRANSFORM=117]="KEYFRAME_TRANSFORM",e[e.KEYFRAME_V0_DESERIALIZATION=132]="KEYFRAME_V0_DESERIALIZATION",e[e.KEYFRAME_DESERIALIZATION=38]="KEYFRAME_DESERIALIZATION",e[e.AFTER_KEYFRAME_RUN=118]="AFTER_KEYFRAME_RUN",e[e.MUTATIONS_DESERIALIZATION_AND_RUN=121]="MUTATIONS_DESERIALIZATION_AND_RUN",e[e.MUTATIONS_DESERIALIZATION=39]="MUTATIONS_DESERIALIZATION",e[e.MUTATIONS_RUN=119]="MUTATIONS_RUN",e[e.AFTER_MUTATIONS_RUN=120]="AFTER_MUTATIONS_RUN",e[e.DATA_HANDLE=40]="DATA_HANDLE",e[e.RENDER=41]="RENDER",e[e.FIRST_SCREEN=42]="FIRST_SCREEN",e[e.INTERACTABLE=43]="INTERACTABLE",e[e.FORMULA_DEPENDENCY_GRAPH=44]="FORMULA_DEPENDENCY_GRAPH",e[e.FORMULA_TOTAL_CALCULATION=45]="FORMULA_TOTAL_CALCULATION",e[e.JS_LOAD_PUBLIC_JQUERY=49]="JS_LOAD_PUBLIC_JQUERY",e[e.JS_LOAD_PUBLIC_JQUERY_UI=50]="JS_LOAD_PUBLIC_JQUERY_UI",e[e.JS_LOAD_PUBLIC_QQAPI=51]="JS_LOAD_PUBLIC_QQAPI",e[e.JS_LOAD_PUBLIC_RAVEN=52]="JS_LOAD_PUBLIC_RAVEN",e[e.JS_LOAD_PUBLIC_SOCKET=53]="JS_LOAD_PUBLIC_SOCKET",e[e.JS_LOAD_PUBLIC_WEBLOG=54]="JS_LOAD_PUBLIC_WEBLOG",e[e.JS_LOAD_CORE_SHEET_PC=55]="JS_LOAD_CORE_SHEET_PC",e[e.JS_LOAD_SPREAD_SHEET_PC=56]="JS_LOAD_SPREAD_SHEET_PC",e[e.JS_LOAD_CORE_SHEET_MOBILE=57]="JS_LOAD_CORE_SHEET_MOBILE",e[e.JS_LOAD_SPREAD_SHEET_MOBILE=58]="JS_LOAD_SPREAD_SHEET_MOBILE",e[e.JS_LOAD_CORE_SHEET_PAD=59]="JS_LOAD_CORE_SHEET_PAD",e[e.JS_LOAD_SPREAD_SHEET_PAD=60]="JS_LOAD_SPREAD_SHEET_PAD",e[e.TOTAL_JS_LOAD=61]="TOTAL_JS_LOAD",e[e.CSS_LOAD_CORE_SHEET_PC=62]="CSS_LOAD_CORE_SHEET_PC",e[e.CSS_LOAD_SPREAD_SHEET_PC=63]="CSS_LOAD_SPREAD_SHEET_PC",e[e.CSS_LOAD_CORE_SHEET_MOBILE=64]="CSS_LOAD_CORE_SHEET_MOBILE",e[e.CSS_LOAD_SPREAD_SHEET_MOBILE=65]="CSS_LOAD_SPREAD_SHEET_MOBILE",e[e.CSS_LOAD_CORE_SHEET_PAD=66]="CSS_LOAD_CORE_SHEET_PAD",e[e.CSS_LOAD_SPREAD_SHEET_PAD=67]="CSS_LOAD_SPREAD_SHEET_PAD",e[e.TOTAL_CSS_LOAD=68]="TOTAL_CSS_LOAD",e[e.SWITCH_SHEET=69]="SWITCH_SHEET",e[e.FIRST_SCREEN_LESS_10=83]="FIRST_SCREEN_LESS_10",e[e.FIRST_SCREEN_MORE_10=84]="FIRST_SCREEN_MORE_10",e[e.RENDER_TRANSFORM=85]="RENDER_TRANSFORM",e[e.RENDER_CANVAS=86]="RENDER_CANVAS",e[e.RENDER_DATA=87]="RENDER_DATA",e[e.RENDER_SEGMENTATION=88]="RENDER_SEGMENTATION",e[e.RENDER_META=89]="RENDER_META",e[e.INTERACTABLE_WORKER=97]="INTERACTABLE_WORKER",e[e.DOM_CONTENT_LOAD_WORKER=98]="DOM_CONTENT_LOAD_WORKER",e[e.WINDOW_LOAD_WORKER=99]="WINDOW_LOAD_WORKER",e[e.RENDER_INIT_UI=100]="RENDER_INIT_UI",e[e.RENDER_CHECK_ROW_HEIGHT=101]="RENDER_CHECK_ROW_HEIGHT",e[e.RENDER_TABLE_BODY=102]="RENDER_TABLE_BODY",e[e.RENDER_CACHE_IMG=125]="RENDER_CACHE_IMG",e[e.WHITE_SCREEN_NO_EXECUTE=126]="WHITE_SCREEN_NO_EXECUTE",e[e.SPREAD_RUN=127]="SPREAD_RUN",e[e.QUICKLOOK=128]="QUICKLOOK",e[e.LOAD_CGI_DATA_TIME=130]="LOAD_CGI_DATA_TIME",e[e.RUN_STARTER_JS_TIME=131]="RUN_STARTER_JS_TIME",e[e.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME=133]="LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME",e[e.TIME_PASTE_FROM_OUTER=134]="TIME_PASTE_FROM_OUTER",e[e.TIME_PASTE_FROM_INNTER=135]="TIME_PASTE_FROM_INNTER",e[e.TIME_COPY=136]="TIME_COPY",e[e.RENDER_OVER=140]="RENDER_OVER",e[e.FRONT_DOWNLOAD=141]="FRONT_DOWNLOAD"}(g||(t.SPEED_REPORT_POINTS=g={}));var v,b={"jquery-1":g.JS_LOAD_PUBLIC_JQUERY,"jquery-ui":g.JS_LOAD_PUBLIC_JQUERY_UI,qqapi:g.JS_LOAD_PUBLIC_QQAPI,"raven:":g.JS_LOAD_PUBLIC_RAVEN,socket:g.JS_LOAD_PUBLIC_SOCKET,"wl.v3":g.JS_LOAD_PUBLIC_WEBLOG,"core-sheet-pc":g.JS_LOAD_CORE_SHEET_PC,"spread-sheet-pc":g.JS_LOAD_SPREAD_SHEET_PC,"core-sheet-mobile":g.JS_LOAD_CORE_SHEET_MOBILE,"spread-sheet-mobile":g.JS_LOAD_SPREAD_SHEET_MOBILE,"core-sheet-pad":g.JS_LOAD_CORE_SHEET_PAD,"spread-sheet-pad":g.JS_LOAD_SPREAD_SHEET_PAD},_={"core-sheet-pc":g.CSS_LOAD_CORE_SHEET_PC,"spread-sheet-pc":g.CSS_LOAD_SPREAD_SHEET_PC,"core-sheet-mobile":g.CSS_LOAD_CORE_SHEET_MOBILE,"spread-sheet-mobile":g.CSS_LOAD_SPREAD_SHEET_MOBILE,"core-sheet-pad":g.CSS_LOAD_CORE_SHEET_PAD,"spread-sheet-pad":g.CSS_LOAD_SPREAD_SHEET_PAD};!function(e){e[e.FORMULA_CALCULATION_WITH_MUTATION=46]="FORMULA_CALCULATION_WITH_MUTATION",e[e.FORMULA_SINGLE_BATCH_CALCULATION=47]="FORMULA_SINGLE_BATCH_CALCULATION",e[e.FORMULA_CALCULATE_SINGLE_CELL_FORMULA=48]="FORMULA_CALCULATE_SINGLE_CELL_FORMULA",e[e.SWITCH_SHEET=69]="SWITCH_SHEET",e[e.APPLY_FILTER=70]="APPLY_FILTER",e[e.APPLY_COPY_PASTE=71]="APPLY_COPY_PASTE",e[e.APPLY_REORDER=72]="APPLY_REORDER"}(v||(t.EDIT_SPEED_REPORT_POINTS=v={}));var y=(r={},(0,d.default)(r,g.DNS,"[\u6253\u5f00]DNS\u67e5\u8be2"),(0,d.default)(r,g.CONNECT,"[\u6253\u5f00]\u5efa\u7acb\u8fde\u63a5"),(0,d.default)(r,g.HTML_TTFB,"[\u6253\u5f00]html\u7684ttfb\u8017\u65f6"),(0,d.default)(r,g.HTML_LOAD,"[\u6253\u5f00]html\u52a0\u8f7d\u8017\u65f6"),(0,d.default)(r,g.WHITE_SCREEN,"[\u6253\u5f00]\u767d\u5c4f\u65f6\u95f4"),(0,d.default)(r,g.SPREAD_RUN,"[\u6253\u5f00]spread\u4ecenavi\u5230\u5f00\u59cb\u6267\u884c\u65f6\u95f4"),(0,d.default)(r,g.SYNC_JS_RUN,"[\u6253\u5f00]\u540c\u6b65js\u6267\u884c\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.TOTAL_JS_RUN,"[\u6253\u5f00]\u6240\u6709js\u6267\u884c\u8017\u65f6+\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.DOM_CONTENT_LOAD,"[\u6253\u5f00]\u6574\u4f53\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.WINDOW_LOAD,"[\u6253\u5f00]\u6574\u4f53\u8017\u65f6\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.KEYFRAME_MUTATIONS_LOAD,"[\u6253\u5f00]keyframe+mutations\u62c9\u53d6\u8017\u65f6"),(0,d.default)(r,g.KEYFRAME_TRANSFORM,"[\u6253\u5f00]keyframe\u89e3\u6790\u8017\u65f6"),(0,d.default)(r,g.KEYFRAME_DESERIALIZATION,"[\u6253\u5f00]keyframe\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,d.default)(r,g.KEYFRAME_V0_DESERIALIZATION,"[\u6253\u5f00]\u5bfc\u5165\u7684keyframeV0\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,d.default)(r,g.AFTER_KEYFRAME_RUN,"[\u6253\u5f00]afterKeyframeRun\u8017\u65f6"),(0,d.default)(r,g.MUTATIONS_DESERIALIZATION_AND_RUN,"[\u6253\u5f00]mutations\u53cd\u5e8f\u5217\u5316\u4e0e\u6267\u884c\u8017\u65f6"),(0,d.default)(r,g.MUTATIONS_DESERIALIZATION,"[\u6253\u5f00]mutations\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,d.default)(r,g.MUTATIONS_RUN,"[\u6253\u5f00]mutations\u6267\u884c\u8017\u65f6"),(0,d.default)(r,g.AFTER_MUTATIONS_RUN,"[\u6253\u5f00]afterMutationsRun\u8017\u65f6"),(0,d.default)(r,g.DATA_HANDLE,"[\u6253\u5f00]\u6570\u636e\u5c42\u6574\u4f53\u89e3\u6790\u8017\u65f6"),(0,d.default)(r,g.RENDER,"[\u6253\u5f00]alloyExcel\u6e32\u67d3\u8017\u65f6"),(0,d.default)(r,g.RENDER_TRANSFORM,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u6570\u636e\u5c42\u8f6c\u6362\u6570\u636e\u4e3a\u6e32\u67d3\u5c42"),(0,d.default)(r,g.RENDER_CANVAS,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u6e32\u67d3\u5c42\u771f\u6b63\u8017\u65f6"),(0,d.default)(r,g.RENDER_DATA,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u5904\u7406\u6570\u636e"),(0,d.default)(r,g.RENDER_INIT_UI,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1ainit ui\u603b\u6267\u884c\u65f6\u95f4"),(0,d.default)(r,g.RENDER_CHECK_ROW_HEIGHT,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1acheckRowHeight"),(0,d.default)(r,g.RENDER_TABLE_BODY,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1atable body(\u5305\u542b\u5355\u5143\u683c\u5206\u6bb5\uff0c\u8986\u76d6\u6027\u548c\u8fb9\u6846\u7ebf\u521d\u59cb\u5316)\u6267\u884c\u65f6\u95f4"),(0,d.default)(r,g.RENDER_META,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u5904\u7406\u5176\u4ed6\u4fe1\u606f\uff08\u7b5b\u9009\u3001\u51bb\u7ed3\u7b49\uff09"),(0,d.default)(r,g.FIRST_SCREEN,"[\u6253\u5f00]\u9996\u5c4f"),(0,d.default)(r,g.INTERACTABLE,"[\u6253\u5f00]\u53ef\u4ea4\u4e92"),(0,d.default)(r,g.FORMULA_DEPENDENCY_GRAPH,"[\u6253\u5f00]\u51fd\u6570\u4f9d\u8d56\u56fe"),(0,d.default)(r,g.FORMULA_TOTAL_CALCULATION,"[\u6253\u5f00]\u51fd\u6570\u8ba1\u7b97\u603b\u8017\u65f6"),(0,d.default)(r,g.TOTAL_JS_LOAD,"[\u6253\u5f00]js\u603b\u52a0\u8f7d\u8017\u65f6"),(0,d.default)(r,g.TOTAL_CSS_LOAD,"[\u6253\u5f00]css\u603b\u52a0\u8f7d\u8017\u65f6"),(0,d.default)(r,v.FORMULA_CALCULATION_WITH_MUTATION,"[\u7f16\u8f91]mutation\u89e6\u53d1\u51fd\u6570\u8ba1\u7b97\u603b\u8017\u65f6"),(0,d.default)(r,v.FORMULA_SINGLE_BATCH_CALCULATION,"[\u7f16\u8f91]\u5355\u6279\u6b21\u51fd\u6570\u6301\u7eed\u8017\u65f6"),(0,d.default)(r,v.FORMULA_CALCULATE_SINGLE_CELL_FORMULA,"[\u7f16\u8f91]\u5173\u952e\u51fd\u6570calculateSingleCellFormula\u8017\u65f6"),(0,d.default)(r,v.SWITCH_SHEET,"[\u7f16\u8f91]\u5207sheet\u8017\u65f6"),(0,d.default)(r,g.INTERACTABLE_WORKER,"[\u6253\u5f00][worker]\u53ef\u4ea4\u4e92"),(0,d.default)(r,g.DOM_CONTENT_LOAD_WORKER,"[\u6253\u5f00][worker]\u6574\u4f53\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.WINDOW_LOAD_WORKER,"[\u6253\u5f00][worker]\u6574\u4f53\u8017\u65f6\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,d.default)(r,g.RENDER_CACHE_IMG,"[\u79d2\u770b]\u903b\u8f91\u8017\u65f6"),(0,d.default)(r,g.QUICKLOOK,"[\u79d2\u770b]\u79d2\u770b\u9996\u5c4f"),(0,d.default)(r,g.LOAD_CGI_DATA_TIME,"CGI\u6570\u636e\u52a0\u8f7d\u65f6\u95f4"),(0,d.default)(r,g.RUN_STARTER_JS_TIME,"\u524d\u7f6e\u903b\u8f91\u6267\u884c\u65f6\u95f4"),(0,d.default)(r,g.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME,"CGI\u6570\u636e\u52a0\u8f7d\u65f6\u95f4\u51cf\u53bb\u524d\u7f6e\u903b\u8f91\u6267\u884c\u65f6\u95f4"),(0,d.default)(r,g.RENDER_OVER,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u7ed3\u675f\u6e32\u67d3"),(0,d.default)(r,g.FRONT_DOWNLOAD,"\u524d\u7aef\u4e0b\u8f7d\u8017\u65f6"),r),T=(s={},(0,d.default)(s,g.NAVIGATION_TO_FETCH,"navigation_to_fetch"),(0,d.default)(s,g.FETCH_TO_REQUEST,"fetch_to_request"),(0,d.default)(s,g.HTML_TO_REQUEST,"html_to_request"),(0,d.default)(s,g.CORE_TO_REQUEST,"core_to_request"),(0,d.default)(s,g.BOOT_START,"boot_start"),(0,d.default)(s,g.BOOT_END,"boot_end"),(0,d.default)(s,g.SPREAD_TO_REQUEST,"spread_to_request"),(0,d.default)(s,g.SPREAD_INIT_START,"spread_init_start"),(0,d.default)(s,g.SPREAD_INIT_DATA_START,"spread_init_data_start"),(0,d.default)(s,g.SPREAD_INIT_END,"spread_init_end"),(0,d.default)(s,g.DATA_START,"data_start"),(0,d.default)(s,g.DATA_END,"data_end"),(0,d.default)(s,g.VIEW_START,"view_start"),(0,d.default)(s,g.VIEW_END,"view_end"),(0,d.default)(s,g.VIEW_NEW_START,"view_new_start"),(0,d.default)(s,g.VIEW_NEW_END,"view_new_end"),(0,d.default)(s,g.SPREAD_INIT_DATA_END,"spread_init_data_end"),(0,d.default)(s,g.SPREAD_INIT_FINISHED,"spread_init_finished"),(0,d.default)(s,g.DNS,"dns"),(0,d.default)(s,g.CONNECT,"connect"),(0,d.default)(s,g.HTML_TTFB,"html_ttfb"),(0,d.default)(s,g.HTML_LOAD,"html_load"),(0,d.default)(s,g.WHITE_SCREEN,"white_screen"),(0,d.default)(s,g.SYNC_JS_RUN,"sync_js_run"),(0,d.default)(s,g.TOTAL_JS_RUN,"total_js_run"),(0,d.default)(s,g.KEYFRAME_MUTATIONS_LOAD,"keyframe_mutations_load"),(0,d.default)(s,g.KEYFRAME_TRANSFORM,"keyframe_transform"),(0,d.default)(s,g.KEYFRAME_V0_DESERIALIZATION,"keyframe_v0_deserialization"),(0,d.default)(s,g.KEYFRAME_DESERIALIZATION,"keyframe_deserialization"),(0,d.default)(s,g.AFTER_KEYFRAME_RUN,"after_keyframe_run"),(0,d.default)(s,g.MUTATIONS_DESERIALIZATION_AND_RUN,"mutations_deserialization_and_run"),(0,d.default)(s,g.MUTATIONS_DESERIALIZATION,"mutations_deserialization"),(0,d.default)(s,g.MUTATIONS_RUN,"mutations_run"),(0,d.default)(s,g.AFTER_MUTATIONS_RUN,"after_mutations_run"),(0,d.default)(s,g.DATA_HANDLE,"data_handle"),(0,d.default)(s,g.RENDER,"render"),(0,d.default)(s,g.FIRST_SCREEN,"first_screen"),(0,d.default)(s,g.INTERACTABLE,"interactable"),(0,d.default)(s,g.FORMULA_DEPENDENCY_GRAPH,"formula_dependency_graph"),(0,d.default)(s,g.FORMULA_TOTAL_CALCULATION,"formula_total_calculation"),(0,d.default)(s,g.TOTAL_JS_LOAD,"total_js_load"),(0,d.default)(s,g.TOTAL_CSS_LOAD,"total_css_load"),(0,d.default)(s,g.FIRST_SCREEN_LESS_10,"first_screen_less_10"),(0,d.default)(s,g.FIRST_SCREEN_MORE_10,"first_screen_more_10"),(0,d.default)(s,g.RENDER_TRANSFORM,"render_transform"),(0,d.default)(s,g.RENDER_CANVAS,"render_canvas"),(0,d.default)(s,g.RENDER_DATA,"render_data"),(0,d.default)(s,g.RENDER_SEGMENTATION,"render_segmentation"),(0,d.default)(s,g.RENDER_META,"render_meta"),(0,d.default)(s,g.DOM_CONTENT_LOAD,"dom_content_load"),(0,d.default)(s,g.WINDOW_LOAD,"window_load"),(0,d.default)(s,g.RENDER_CACHE_IMG,"quick_look_img"),(0,d.default)(s,g.QUICKLOOK,"quick_look"),(0,d.default)(s,g.LOAD_CGI_DATA_TIME,"load_cgi_data_time"),(0,d.default)(s,g.RUN_STARTER_JS_TIME,"run_starter_js_time"),(0,d.default)(s,g.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME,"load_cgi_data_minus_run_starter_js_time"),(0,d.default)(s,v.SWITCH_SHEET,"switch_sheet_cost"),(0,d.default)(s,g.RENDER_OVER,"render_over"),(0,d.default)(s,g.FRONT_DOWNLOAD,"front_download"),s);t.reportFlag=!0,t.reportSpeedFlag=!0,t.reportMonitorFlag=!0,t.reportTDWFlag=!0,t.CONFIG={CHECK_MUTATION_ERROR:"CHECK_MUTATION_ERROR",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",CHECK_MUTATION_RESULT_ERROR:"CHECK_MUTATION_RESULT_ERROR",AFTER_MUTATION_RUN_CATCH_ERROR:"AFTER_MUTATION_RUN_CATCH_ERROR",COMMIT_EMPTY_MUTATION:"COMMIT_EMPTY_MUTATION",DO_BEHAVIOR_AFTER_SHUTDOWN:"DO_BEHAVIOR_AFTER_SHUTDOWN",COMMIT_MUTATION_CATCH_ERROR:"COMMIT_MUTATION_CATCH_ERROR",COMMIT_MUTATION:"COMMIT_MUTATION",CACHE_DATA_FLOW_COMMIT_MUTATION:"CACHE_DATA_FLOW_COMMIT_MUTATION",PAGE_LOAD:"PAGE_LOAD",DUPLICATE_SHEET_ID:"DUPLICATE_SHEET_ID",SERIALIZE_MUTATION:"SERIALIZE_MUTATION",DESERIALIZE_MUTATION:"DESERIALIZE_MUTATION",GET_COLLAB_MUTATIONS:"GET_COLLAB_MUTATIONS",CREATE_ZIPKETFRAME:"CREATE_ZIPKETFRAME",APPLY_NEW_CHANGES_ERROR:"APPLY_NEW_CHANGES_ERROR",LOAD_REQUEST:"LOAD_REQUEST",APPLY_BEHAVIOR_ERROR:"APPLY_BEHAVIOR_ERROR",APPLY_BEHAVIOR_NOT_LOADED:"APPLY_BEHAVIOR_NOT_LOADED",APPLY_BEHAVIOR_LEVEL_INFO:"APPLY_BEHAVIOR_LEVEL_INFO",APPLY_BEHAVIOR_LEVEL_IMPORTANT:"APPLY_BEHAVIOR_LEVEL_IMPORTANT",APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:"APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR",REQUEST_SIZE_OVER_LIMIT:"REQUEST_SIZE_OVER_LIMIT",FOLLOW_REQUEST_MUTATIONS:"FOLLOW_REQUEST_MUTATIONS",SERIALIZE_MUTATION_CACHE_ERROR:"SERIALIZE_MUTATION_CACHE_ERROR",DESERIALIZE_MUTATION_CACHE_ERROR:"DESERIALIZE_MUTATION_CACHE_ERROR",GENERATE_MUTATION_1:"GENERATE_MUTATION_1",GENERATE_MUTATION_2:"GENERATE_MUTATION_2",GENERATE_MUTATION_3:"GENERATE_MUTATION_3",DO_KEYFRAME_CATCH_ERROR_1:"DO_KEYFRAME_CATCH_ERROR_1",DO_KEYFRAME_CATCH_ERROR_2:"DO_KEYFRAME_CATCH_ERROR_2",DO_KEYFRAME_CATCH_ERROR_3:"DO_KEYFRAME_CATCH_ERROR_3",DO_KEYFRAME:"DO_KEYFRAME",DO_MUTATIONS:"DO_MUTATIONS",ZIP_KEYFRAME:"ZIP_KEYFRAME",ZIP_KEYFRAME_CATCH_ERROR:"ZIP_KEYFRAME_CATCH_ERROR",COPY_PASTE:"COPY_PASTE",CHOOSE_FORMAT_ERROR:"CHOOSE_FORMAT_ERROR",PARSE_FORMAT_ERROR:"PARSE_FORMAT_ERROR",RETRY_SENDMESSAGE:"RETRY_SENDMESSAGE",MOVE_MESSAGEINFO_COMMITING_QUEUE:"MOVE_MESSAGEINFO_COMMITING_QUEUE",RETRY_COMMIT:"RETRY_COMMIT",SEND_USERCHANGE:"SEND_USERCHANGE",SEND_USERCHANGE_1:"SEND_USERCHANGE_1",HANDLE_COMMIT_ONSENDERROR:"HANDLE_COMMIT_ONSENDERROR",ACCEPT_COMMIT:"ACCEPT_COMMIT",HANDLE_COMMIT_ERROR:"HANDLE_COMMIT_ERROR",HANDLE_TASK_DUPLICATE:"HANDLE_TASK_DUPLICATE",HANDLE_ROOM_ERRORCODE:"HANDLE_ROOM_ERRORCODE",HANDLE_NEW_CHANGES:"HANDLE_NEW_CHANGES",APPLY_NEWCHANGES_VERROR:"APPLY_NEWCHANGES_VERROR",DUPLICATE_MESSAGE:"DUPLICATE_MESSAGE",APPLY_NEWCHANGES_CATCH_ERROR:"APPLY_NEWCHANGES_CATCH_ERROR",APPLY_NEWCHANGES:"APPLY_NEWCHANGES",CHECK_AND_APPLYNEWCHANGES:"CHECK_AND_APPLYNEWCHANGES",APPLY_NEWCHANGES_VERROR2:"APPLY_NEWCHANGES_VERROR2",SWITCH_CHANEL_STATUS:"SWITCH_CHANEL_STATUS",HANDLE_FETCH_RESULT:"HANDLE_FETCH_RESULT",FETCH_USERCHANGES_ERROR:"FETCH_USERCHANGES_ERROR",FETCH_AND_APPLY_MISSCHANGES:"FETCH_AND_APPLY_MISSCHANGES",EMPTY_KEYFRAME_BY_AUTOEXPAND:"EMPTY_KEYFRAME_BY_AUTOEXPAND",ADD_USER_CHANGE:"ADD_USER_CHANGE",UPDATE_BASEVERSION:"UPDATE_BASEVERSION",UPDATE_BASEVERSION_ERROR:"UPDATE_BASEVERSION_ERROR",ACCEPT_COMMIT_2:"ACCEPT_COMMIT_2",FETCH_USERCHANGE_ARGUMENT:"FETCH_USERCHANGE_ARGUMENT",FETCH_USERCHANGES:"FETCH_USERCHANGES",FETCH_USERCHANGES_3:"FETCH_USERCHANGES_3",INIT_DATA_ERROR:"INIT_DATA_ERROR",STORE_DATA_ERROR:"STORE_DATA_ERROR",NOT_SUPPORT_INDEXEDDB:"NOT_SUPPORT_INDEXEDDB",OPEN_INDEXED_DB:"OPEN_INDEXED_DB",NOT_SUPPORT_INDEXEDDB_2:"NOT_SUPPORT_INDEXEDDB_2",NOT_SUPPORT_INDEXEDDB_3:"NOT_SUPPORT_INDEXEDDB_3",UPDATE_INDEXED_DB:"UPDATE_INDEXED_DB",STORE_UNVALIABLE_WHEN_SET:"STORE_UNVALIABLE_WHEN_SET",INDEXDB_SET_VALUE:"INDEXDB_SET_VALUE",INDEXDB_SET_VALUE_ONERROR:"INDEXDB_SET_VALUE_ONERROR",CHANGE_DATAKEY:"CHANGE_DATAKEY",STORE_UNVALIABLE_WHEN_UPDATE:"STORE_UNVALIABLE_WHEN_UPDATE",INDEXEDDB_UPDATE_VALUE:"INDEXEDDB_UPDATE_VALUE",INDEXEDDB_UPDATE_VALUE_2:"INDEXEDDB_UPDATE_VALUE_2",INDEXEDDB_UPDATE_VALUE_3:"INDEXEDDB_UPDATE_VALUE_3",INDEXEDDB_UPDATE_VALUE_4:"INDEXEDDB_UPDATE_VALUE_4",DELETE_DATA_ERROR:"DELETE_DATA_ERROR",DELETE_VALUE:"DELETE_VALUE",DELETE_VALUE_2:"DELETE_VALUE_2",CLEAR_DATA_ERROR:"CLEAR_DATA_ERROR",CLEAR_DATA:"CLEAR_DATA",CLEAR_DATA_2:"CLEAR_DATA_2",GET_DATA_ERROR:"GET_DATA_ERROR",GET_DATA:"GET_DATA",GET_DATA_ERROR_2:"GET_DATA_ERROR_2",GET_DATA_SUCC:"GET_DATA_SUCC",NETWORK_ERROR:"NETWORK_ERROR",ACCEPT_MESSAGE:"ACCEPT_MESSAGE",ROOM_STATE_CHANGE:"ROOM_STATE_CHANGE",HANDLE_SHUTDOWN:"HANDLE_SHUTDOWN",SWITCH_SHEET_IN_PREVIEW:"SWITCH_SHEET_IN_PREVIEW",PREVIEW_SERVER_SHEET_DATA:"PREVIEW_SERVER_SHEET_DATA",PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:"PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE",SWITCH_SHEET_ON_SUCCESS:"SWITCH_SHEET_ON_SUCCESS",SWITCH_SHEET_ON_FAIL:"SWITCH_SHEET_ON_FAIL",DUPLICATE_SHEET_ID_2:"DUPLICATE_SHEET_ID_2",DUPLICATE_SHEET_ID_3:"DUPLICATE_SHEET_ID_3",FETCH_DATA_ERROR:"FETCH_DATA_ERROR",FETCH_DATA_ERROR_2:"FETCH_DATA_ERROR_2",K2S_CONVERTER:"K2S_CONVERTER",RELOAD_TIP:"RELOAD_TIP",RELOAD_TIP_DEBUG:"RELOAD_TIP_DEBUG",INIT_OFFLINE_STORE_ERROR:"INIT_OFFLINE_STORE_ERROR",GET_OFFLINE_DATA:"GET_OFFLINE_DATA",GET_OFFLINE_DATA_WAITING_QUEUE:"GET_OFFLINE_DATA_WAITING_QUEUE",CHANGEDATAKEY_CATCH_ERROR:"CHANGEDATAKEY_CATCH_ERROR",SETDATA_CATCH_ERROR:"SETDATA_CATCH_ERROR",UPDATEDATA_CATCH_ERROR:"UPDATEDATA_CATCH_ERROR",DELETEDATA_CATCH_ERROR:"DELETEDATA_CATCH_ERROR",CLEARDATA_CATCH_ERROR:"CLEARDATA_CATCH_ERROR",GETDATA_CATCH_ERROR:"GETDATA_CATCH_ERROR",SWITCH_SHEET_SERVER_FAIL:"SWITCH_SHEET_SERVER_FAIL",SWITCH_SHEET_FRONT_FAIL:"SWITCH_SHEET_FRONT_FAIL",PARSE_KEYFRAME_ERROR:"PARSE_KEYFRAME_ERROR",UNZIP_KEYFRAME_ERROR:"UNZIP_KEYFRAME_ERROR",PARSE_KEYFRAME_ERROR_2:"PARSE_KEYFRAME_ERROR_2",UNZIP_KEYFRAME:"UNZIP_KEYFRAME",MESSAGECENTER_DATA_ERROR_TIP:"MESSAGECENTER_DATA_ERROR_TIP",NET_OFFLINE_ERROR_TIP:"NET_OFFLINE_ERROR_TIP",MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:"MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT",APPLY_BEHAVIOR_UNDO:"APPLY_BEHAVIOR_UNDO",APPLY_BEHAVIOR_REDO:"APPLY_BEHAVIOR_REDO",APPLY_BEHAVIOR_LOCAL:"APPLY_BEHAVIOR_LOCAL",CREATE_WORKER_ERROR:"CREATE_WORKER_ERROR",UPDATE_SMART_SELECTION_ERROR:"UPDATE_SMART_SELECTION_ERROR",INVER_MUTATION_ERROR:"INVER_MUTATION_ERROR",FILL_DRAG:"FILL_DRAG",FILL_SERIES:"FILL_SERIES",FILL_COPY:"FILL_COPY",FILL_OPTION:"FILL_OPTION",FILL_OPTION_COPY:"FILL_OPTION_COPY",FILL_OPTION_SERIES:"FILL_OPTION_SERIES",FILL_FORMAT:"FILL_FORMAT",FILL_WITHOUT_FORMAT:"FILL_WITHOUT_FORMAT",MOBILE_FILL_SERIES:"MOBILE_FILL_SERIES",MOBILE_FILL_COP:"MOBILE_FILL_COP",CLK_FILL_SUCCESS:"CLK_FILL_SUCCESS",LOAD_DATA_SUCC:"LOAD_DATA_SUCC",SWITCH_SHEET_SUCC:"SWITCH_SHEET_SUCC",REPORT_FILES_TIMES:"REPORT_FILES_TIMES",REPORT_FOR_QUICK_LOOK:"REPORT_FOR_QUICK_LOOK",SHEET_STATUS_REPORT:"SHEET_STATUS_REPORT",SWITCH_SHEET_SPEED:"SWITCH_SHEET_SPEED",RENDER_TRANSFORM_SPEED:"RENDER_TRANSFORM_SPEED",RENDER_CANVAS_SPEED:"RENDER_CANVAS_SPEED",TIME_PASTE_FROM_OUTER_SPEED:"TIME_PASTE_FROM_OUTER_SPEED",TIME_COPY_SPEED:"TIME_COPY_SPEED",HANDDATA_SETSHEETDATA:"HANDDATA_SETSHEETDATA",REPORT_FOR_QL_PV:"REPORT_FOR_QL_PV",REPORT_FOR_PV:"REPORT_FOR_PV",RESET_DEFAULT_TDW_DATA:"RESET_DEFAULT_TDW_DATA"},t.MONITOR_POINTS=w,t.SENTRY_ERROR_TYPE=u,t.getTdwObj3Value=function(e,t){var n="";switch(e){case p.MUTATION:n=[t.getAffectedSheetId(),t.parentRequestId,t.id,t.operationType].join("-")}return n},t.TDW_MODULE=p,t.TDW_ACTION=h,t.TDW_VER5_VALUE=f,t.SPEED_MARK_POINTS=m,t.EDIT_SPEED_REPORT_POINTS=v,t.SPEED_REPORT_POINTS=g,t.REG_JS_LOAD_FILE=/jquery-1|jquery-ui|qqapi|raven|socket|wl\.v3|core-sheet-pc|spread-sheet-pc|core-sheet-mobile|spread-sheet-mobilet|core-sheet-pad|spread-sheet-pad/,t.REG_CSS_LOAD_FILE=/core-sheet-pc|spread-sheet-pc|core-sheet-mobile|spread-sheet-mobile|core-sheet-pad|spread-sheet-pad/,t.JS_LOAD_FILE_MAP=b,t.CSS_LOAD_FILE_MAP=_,t.SPEED_REPORT_LOG=y,t.TDW_REPORT_ACTION=T},"./css/img/images/auth_tips_icon_1.svg":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/auth_tips_icon_1-9d375ac0ac.svg"},"./css/img/images/brandlogo/logo-sprites-new.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/brandlogo/logo-sprites-new-5f4e9b27a0.png"},"./css/img/images/clear36.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/clear36-0448bee7f3.png"},"./css/img/images/clear36_press.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/clear36_press-cd0681198b.png"},"./css/img/images/close.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/close-ac511faa73.png"},"./css/img/images/newpic/dropdown-triangle.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/newpic/dropdown-triangle-e1280562ab.png"},"./css/img/images/newpic/separator.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/newpic/separator-aa3971338f.png"},"./css/img/images/nophoto2.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/nophoto2-e501425b65.png"},"./css/img/images/pc-preview-tip-icon.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/pc-preview-tip-icon-1f3bf63b66.png"},"./css/img/images/pixel.gif":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/pixel-df3e567d6f.gif"},"./css/img/images/pointer_format.cur":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/pointer_format-b5ca59cacc.cur"},"./css/img/images/pointer_format.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/pointer_format-9e5790da52.png"},"./css/img/images/sheet-add.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/sheet-add-18fdd6285a.png"},"./css/img/images/sheet-dropdown.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/sheet-dropdown-e1280562ab.png"},"./css/img/images/sheet-dropdown.svg":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/sheet-dropdown-07bdca7a7f.svg"},"./css/img/images/toolbar_sprite.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/toolbar_sprite-d216c77905.png"},"./css/img/images/toolbar_sprite@2x.png":function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/toolbar_sprite@2x-e32f81ef3e.png"},"./css/index-common.less":function(e,t,n){var o=n("../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/lib/index.js?!../node_modules/less-loader/dist/cjs.js!./css/index-common.less");"string"===typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("../node_modules/style-loader/lib/addStyles.js")(o,i);o.locals&&(e.exports=o.locals)},"./css/index-pc.less":function(e,t,n){var o=n("../node_modules/css-loader/dist/cjs.js!../node_modules/postcss-loader/lib/index.js?!../node_modules/less-loader/dist/cjs.js!./css/index-pc.less");"string"===typeof o&&(o=[[e.i,o,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n("../node_modules/style-loader/lib/addStyles.js")(o,i);o.locals&&(e.exports=o.locals)},"./js/app/app-guide/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/script-loader/index.js"),a=n("./js/utils/user-agent.js"),r=n("./js/config/sheet.js"),s=n("./js/event/event-center.js");var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.BuoyButtonModule=null,this.buoyButtonExpand=!1,this.initGuideSaveToMydoc=this.initGuideSaveToMydoc.bind(this),this.saveMydocScrollHandler=this.saveMydocScrollHandler.bind(this)}return o(e,[{key:"init",value:function(){!a.isMobile&&!a.isPad||a.isTencentDocApp||this.initGuideSaveToMydoc()}},{key:"initGuideSaveToMydoc",value:function(){var e=this;localStorage.getItem("ENTRANCE_FROM_DESKTOPM")?localStorage.removeItem("ENTRANCE_FROM_DESKTOPM"):window.SLR&&window.SLR.listen("GET_DOCINFO_SUCCESS",function(){var t=(0,r.getSheetDocInfo)();if(!window.clientVars.isOwner&&t&&!t.isAddedMy){var n=(0,a.checkIsIphoneX)(),o=function(){(0,i.loadModule)("BuoyButtonMobile",function(t){e.BuoyButtonModule=t,t.showBuoyButton({buttonType:"ADD_TO_MYDOC",clientVars:window.clientVars,preferredBottom:n?85:null}),e.buoyButtonExpand=!0,s.event.default.listen("tableMove",e.saveMydocScrollHandler)})};window.SLR.assetLoaded?o():window.SLR.listen("SL-INIT",o)}})}},{key:"saveMydocScrollHandler",value:function(){var e=window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel,t=e&&e.areaData.row.flow.maxOffsetY>e.areaData.row.flow.maxAutoMove&&Math.abs(e.areaData.row.flow.maxOffsetY-e.areaData.row.flow._offsetY)<100;if(this.buoyButtonExpand!==t){var n=(0,a.checkIsIphoneX)();this.BuoyButtonModule&&this.BuoyButtonModule.showBuoyButton({buttonType:"ADD_TO_MYDOC",noText:!t,clientVars:window.clientVars,preferredBottom:n?85:null}),this.buoyButtonExpand=t}}}]),e}();t.default=new l},"./js/app/aria/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hadGet=!1,this.time=0,this.nowIndex=0}return o(e,[{key:"getHelpInfo",value:function(e){var t=this,n="Ctrl",o="Alt";i.isMac&&(n="Cmd",o="Opt");var a="\n            \u6b22\u8fce\u4f7f\u7528\u817e\u8baf\u6587\u6863\n            \u4f60\u53ef\u4ee5\u4f7f\u7528"+n+"+"+o+"+SHIFT+h\u91cd\u65b0\u542c\u53d6\u5e2e\u52a9\u3002\n            "+n+"+"+o+"+SHIFT+1 \u5207\u6362\u5230\u8868\u683c\u5185\u5bb9\u533a\n            "+n+"+"+o+"+SHIFT+2 \u5207\u6362\u5230\u8868\u683c\u5de5\u5177\u680f\n            "+n+"+"+o+"+SHIFT+3 \u5207\u6362\u5230\u9876\u90e8\u83dc\u5355\u680f\n            "+n+"+"+o+"+SHIFT+4 \u5207\u6362\u5230\u5e95\u90e8\u5de5\u5177\u680f\n            "+n+"+"+o+"+SHIFT+5 \u5207\u6362\u5230\u4fee\u6539\u8868\u683c\u6807\u9898\n            \u6309F2\u8fdb\u5165\u8868\u683c\u7f16\u8f91\u3002\n        ";return e?!this.hadGet&&(setTimeout(function(){t.hadGet=!0},200),a+="\n                     \u5f53\u524d\u6240\u5728\u5355\u5143\u683c "+e+"\n                "):a}},{key:"init",value:function(){var e=this.getHelpInfo();document.getElementById("ariaQuickTips").innerText=e}},{key:"doAction",value:function(e,t,n,o,i){if(e||t||n||113!==o){if(e&&t&&n&&72===o)this.toHelp();else if(e&&n&&t)switch(o){case 49:this.toEdit();break;case 50:this.toTools(i);break;case 51:this.toMenu(i);break;case 52:this.toFoot(i);break;case 53:this.toTitle()}}else this.toEdit()}},{key:"checkInputStatus",value:function(){}},{key:"toHelp",value:function(){document.getElementById("excelAriaHelp").focus()}},{key:"toEdit",value:function(){var e=document.getElementById("alloy-rich-text-editor");e&&(this.checkInputStatus(),e.focus())}},{key:"toTools",value:function(){var e=document.querySelector(".toolbar-box .aria-hide");e&&(this.checkInputStatus(),e.focus())}},{key:"toMenu",value:function(){var e=document.querySelector("#web_header_tool_tabs_container .aria-hide");e&&(this.checkInputStatus(),e.focus())}},{key:"toFoot",value:function(){var e=document.querySelector("#sheet-bottom-wrapper .aria-hide");e&&(this.checkInputStatus(),e.focus())}},{key:"toTitle",value:function(){var e=document.querySelector("#padAloneTitle");e&&(this.checkInputStatus(),e.focus())}}]),e}();t.default=new a},"./js/app/auth/advanced.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js"),a=n("./js/utils/browser.js"),r=n("./js/app/header/util.js"),s=c(n("./js/app/header/mobile/cooperation.js")),l=c(n("./js/app/header/mobile/mobile-share-model.js")),d=n("./js/component/toast/index.js");function c(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.initted=!1,this.gettedAdvPermissions=!1,this.initted=!1,this.gettedAdvPermissions=!1}return o(e,[{key:"init",value:function(){if(!this.initted)if(clientVars.isLogin)if(clientVars.preview)console.log("adv: init. preview mode no this feature");else{var e=this;$.ajax({type:"get",url:"/cgi-bin/online_docs/auth_exp/get",data:{domainId:clientVars.domainId,localPadId:clientVars.localPadId},success:function(t){0==t.retcode?(e.authSettime=t.settime,e.authRemaintime=t.remaintime,e.gettedAdvPermissions=!0,console.log("adv: init getted exptimeifno:exptime="+t.exptime+"; remaintime="+t.remaintime+"; settime:"+t.settime+"; starttime:"+t.starttime),e.setAuthExpHandleLogic(t,!0)):(console.log("adv: init getted exptimeifno errcode="+t.retcode),(0,d.showToast)("\u52a0\u8f7d\u6587\u6863\u6709\u6548\u671f\u51fa\u9519\u3002",{zIndex:99999},{toastType:"typeWarnning",toolToastCloseTime:3e3}))},error:function(e){console.log("adv: init getted exptimeifno err"+e),(0,d.showToast)("\u7f51\u7edc\u9519\u8bef\uff0c\u52a0\u8f7d\u6587\u6863\u6709\u6548\u671f\u5931\u8d25\u3002",{zIndex:99999},{toastType:"typeWarnning",toolToastCloseTime:3e3})}}),this.initted=!0}else console.log("adv: init. is no login")}},{key:"checkIsQQClient",value:function(){return!!navigator.userAgent.match(/QQ/i)}},{key:"setAuthExpHandleLogic",value:function(e,t){var n=this;if(e.settime&&0!=e.settime){if(0==e.remaintime)return console.log("adv: is invaild"),void(clientVars.isCreator?(!0===t&&clientVars.isMobile&&clientVars.isTim?(console.log("adv: needshowExpTipsForOwnerOnloaded mobile tim"),this.needshowExpTipsForOwnerOnloaded=!0):this.isAndSetAuthExpReaded(clientVars.localPadId)||this.showExptimeTipsForOwner(),clientVars.isMobile&&(i.isQQ?(0,i.MQQLargerOrEqual)("7.7.0")&&(0,l.default)().setAuthInfoToClient(2):(0,l.default)().setAuthInfoToClient(2))):(console.log(e),this.showWillExptimeTips(3)));var o=0;o=e.remaintime,!clientVars.isCreator&&o>5&&(o-=3),o*=1e3,clientVars.isCreator?this.expireTimeId=setTimeout(function(){n.expireTimeId=null,console.log("adv: expire from timer, creator"),n.isAndSetAuthExpReaded(clientVars.localPadId)||n.confirmExpire()},o):this.expireTimeId=setTimeout(function(){n.expireTimeId=null,console.log("adv: expire from timer, and to get exptimeifno agin"),n.confirmExpire()},o),console.log("adv: settimeout, timeoutInterval:"+o)}else console.log("adv: is vaild forever")}},{key:"confirmExpire",value:function(){var e=this;console.log("adv: confirmExpire creator="+clientVars.isCreator),$.ajax({type:"get",url:"/cgi-bin/online_docs/auth_exp/get",data:{domainId:clientVars.domainId,localPadId:clientVars.localPadId},success:function(t){0==t.retcode?(e.authSettime=t.settime,e.authRemaintime=t.remaintime,e.gettedAdvPermissions=!0,0==t.remaintime?(console.log("adv: confirm is real expire"),clientVars.isCreator?(e.showExptimeTipsForOwner(),clientVars.isMobile&&(i.isQQ?(0,i.MQQLargerOrEqual)("7.7.0")&&(0,l.default)().setAuthInfoToClient(2):(0,l.default)().setAuthInfoToClient(2))):e.showWillExptimeTips(5)):(console.log("adv: confirm is updated"),setTimeout(function(){e.onUpdateAuthExpInfo(t)},100))):console.log("adv: confirm get exptimeifno errcode="+t.retcode+", creator")},error:function(e){console.log("adv: confirm get exptimeifno err"+e+", creator")}})}},{key:"isAndSetAuthExpReaded",value:function(e){if(!e||!localStorage)return!1;var t="exptime-readed-set",n=localStorage.getItem(t);if(n){if(-1==n.indexOf(e+";")){if(n.split(";").length-1>20){var o=n.indexOf(";");n=n.substring(o+1,n.length)}return n=n+e+";",localStorage.setItem(t,n),!1}return!0}return n=e,localStorage.setItem(t,n+";"),!1}},{key:"showExptimeTipsForOwner",value:function(){var e=this;console.log("adv:showExptimeTipsForOwner"),window.SLR&&window.SLR.dispatch("ADVPER_AUTH_EXPIRED"),i.isMiniProgram||i.isMobile?(0,d.showToast)("\u8bbf\u95ee\u94fe\u63a5\u5df2\u8fc7\u671f\uff0c\u5bf9\u65b9\u65e0\u6cd5\u8bbf\u95ee\u3002\u66f4\u6539\u6709\u6548\u671f",{zIndex:999999},{toastType:"typeNotice",linkTitle:"\u66f4\u6539\u6709\u6548\u671f",toolToastCloseTime:1e4,linkCallback:function(){e.forceRotatePortrait();var t=500;padutils.isPortrait()&&(t=800),setTimeout(function(){i.isMiniProgram?s.default.openAdvPermissionsInMiniProgram():s.default.loadCooperationMobile(!1,!0)},t);try{T_SHEET.Report.tdwReport({opername:"doc_access",module:"page",action:"change"})}catch(n){}}}):(0,d.showToast)("\u8bbf\u95ee\u94fe\u63a5\u5df2\u8fc7\u671f\uff0c\u5bf9\u65b9\u65e0\u6cd5\u8bbf\u95ee\u3002\u66f4\u6539\u6709\u6548\u671f",{zIndex:999999},{toastType:"typeNotice",linkTitle:"\u66f4\u6539\u6709\u6548\u671f",toolToastCloseTime:1e4,linkCallback:function(){(0,r.showAuth)(!0);try{T_SHEET.Report.tdwReport({opername:"doc_access",module:"page",action:"change"})}catch(e){}}})}},{key:"showWillExptimeTips",value:function(e){console.log("adv:showWillExptimeTips");var t=this,n={title:"\u6587\u6863\u5df2\u5230\u671f\uff0c\u4f60\u5c06\u65e0\u6cd5\u7ee7\u7eed\u8bbf\u95ee\u3002\u8bf7\u5237\u65b0",linkStr:"\u8bf7\u5237\u65b0",isModalNotCancellable:!0,callback:function(){t.refreshPage();try{T_SHEET.Report.tdwReport({opername:"doc_access",module:"page",action:"refresh"})}catch(e){}}};CommonTips().showInfo(n)}},{key:"refreshPage",value:function(){i.isMiniProgram?window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent((0,a.updateUrl)(window.location.href,"rtime"))}):window.location.href=(0,a.updateUrl)(window.location.href,"rtime")}},{key:"onUpdateAuthExpInfo",value:function(e){e&&(clientVars.preview?console.log("adv: update authexp info. preview mode no this feature"):(console.log("adv: onUpdateAuthExpInfo:remaintime="+e.remaintime+"; settime:"+e.settime),this.expireTimeId&&null!=this.expireTimeId&&(console.log("adv: clear expireTimeId"),clearTimeout(this.expireTimeId)),this.authSettime=e.settime,this.authRemaintime=e.remaintime,this.gettedAdvPermissions=!0,this.setAuthExpHandleLogic(e,!1)))}},{key:"isAuthExpExpire",value:function(){if(1==this.gettedAdvPermissions){if(!this.authSettime)return!1;if(0!=this.authSettime&&0==this.authRemaintime)return!0}return!1}},{key:"setAuthInfo",value:function(e){this.authInfo=e}},{key:"getAuthInfo",value:function(){return this.authInfo}},{key:"forceRotatePortrait",value:function(){window.mqq&&mqq.ui&&mqq.ui.setWebViewBehavior&&mqq.ui.setWebViewBehavior({orientation:0})}},{key:"onWindowLoaded",value:function(){var e=this;!0===this.needshowExpTipsForOwnerOnloaded&&(this.needshowExpTipsForOwnerOnloaded=!1,setTimeout(function(){e.isAndSetAuthExpReaded(clientVars.localPadId)||e.showExptimeTipsForOwner()},500))}}]),e}();t.default=new u},"./js/app/auth/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/config/index.js"),r=(o=a)&&o.__esModule?o:{default:o},s=n("./js/script-loader/index.js"),l=n("./js/utils/browser.js"),d=n("./js/utils/user-agent.js"),c=n("./js/utils/type.js"),u=n("./js/component/toast/index.js");var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.applyAuthStatus=null,this.lastClickTime=null,this.lastShowTime=null,this.applyToastShowTimes=0,this.applicationUnreadNumber=0}return i(e,[{key:"_handleClick",value:function(){var e=this;if(!r.default.isPreview){var t=this;if(0==(2&clientVars.rightFlag))if(d.isMobile||d.isPad)window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.header&&SpreadsheetApp.view.header.component&&SpreadsheetApp.view.header.component.showApplyGuide();else{var n=Date.now();if(0!=this.lastClickTime&&n-this.lastClickTime<500&&n-this.lastShowTime>1e3){(0,u.hideToast)();var o=this.getReadOnlyTip(!0),i={toolToastCloseTime:3e3,supportMobile:!0};if(!(o.isNeedApplyAuth&&this.applyToastShowTimes<1))return void(this.lastClickTime=n);this.applyToastShowTimes+=1,o.isNeedApplyAuth&&(i.isNeedBtn=!0,i.btnText="\u7533\u8bf7\u7f16\u8f91\u6743\u9650",d.isMobile&&(i.standardToastType="default"),i.btnCallBack=function(){e.doAuthApply(function(){d.isMobile?t.applyAuthStatus={apply:!0}:t.authApplyCallBack()}),(0,u.hideToast)(),T_SHEET.Report.tdwReport({opername:"doc_author",module:"edit",action:"clk_apply_toast"})}),d.isMobile?(0,u.showToast)(o.tip,{},i):(0,u.showToast)(o.tip,{top:top},i),this.lastShowTime=n,T_SHEET.Report.tdwReport({opername:"doc_author",module:"edit",action:"exp_toast"})}this.lastClickTime=n}else{if($("#toolToastWrap").length)return;(0,u.showToast)("\u5f53\u524d\u6587\u6863\u67e5\u770b\u4eba\u6570\u8fc7\u591a\uff0c\u6682\u65f6\u4ec5\u80fd\u67e5\u770b\uff0c\u5982\u9700\u7f16\u8f91\u8bf7\u7a0d\u540e\u5237\u65b0\u3002",{},{supportMobile:!0,toolToastCloseTime:2e3,isNeedClose:!0})}}}},{key:"bindClickEvent",value:function(){var e=this;if(!r.default.gEditable&&!r.default.isFormPreview&&($("#padpage").on("click",function(){e._handleClick()}),d.isMobile||d.isPad)){var t=$("#canvasContainer");t.length>0&&t.on("touchend",function(){e._handleClick()})}}},{key:"listenNotificationMessage",value:function(){var e=this;$(window).on("notification_message",function(t,n){console.log("\u7f16\u8f91\u9875\u7684\u7ea2\u70b9 coming",n),1==(n=JSON.parse(n)).msgType&&(n.clearRedDot&&0!==n.clearRedDot?e.delUnreadNotificationNumber(n.clearRedDot):n.redDot&&e.addUnreadNotificationNumber(n.redDot)),r.default.gEditable||r.default.isPreview||e.checkIsApplyIn24H(function(t){if(e.applyAuthStatus=t,!d.isMobile){var n=e.getReadOnlyTip(),o=$(".web_header_readonly_tip");o.length>0&&o.attr("data-tooltip",n.hoverTip)}})}),document.addEventListener("resetOuterUnreadNumberNoti",function(t){console.log("resetOuterUnreadNumberNoti",t.detail),e.setUnreadNotificationNumber(t.detail.number)})}},{key:"authApplyCallBack",value:function(){this.applyAuthStatus={apply:!0};var e=$(".readonly_tip_popup"),t=$("#readonlyTipContent"),n=$("#readonlyTipApplyAuth");if(t.html("\u6743\u9650\u7533\u8bf7\u5df2\u63d0\u4ea4\uff0c\u8bf7\u7b49\u5f85\u521b\u5efa\u8005\u5ba1\u6838\u3002"),n.remove(),e.css("white-space","nowrap"),t.css("padding-top","16px"),t.css("padding-bottom","16px"),e.css("height","auto"),e.css("width","auto"),!d.isMobile&&!r.default.isPreview){var o=this.getReadOnlyTip(),i=$(".web_header_readonly_tip");i.length>0&&i.attr("data-tooltip",o.hoverTip)}}},{key:"getReadOnlyTip",value:function(e){var t="\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c",n=this.applyAuthStatus,o=!1,i="\u5f53\u524d\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c\n\u70b9\u51fb\u7533\u8bf7\u7f16\u8f91\u6743\u9650\u3002";return r.default.isLogin?n&&n.apply&&!n.noPass&&!n.pass?i=t="\u6743\u9650\u7533\u8bf7\u5df2\u63d0\u4ea4\uff0c\u8bf7\u7b49\u5f85\u521b\u5efa\u8005\u5ba1\u6838\u3002":n&&n.apply&&n.noPass?i=t="\u6743\u9650\u7533\u8bf7\u672a\u901a\u8fc7\uff0c\u201c\u53ea\u80fd\u67e5\u770b\u201d\u6587\u6863\u3002":(t=e?"\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\u3002":"\u4f60\u53ea\u80fd\u67e5\u770b\u6b64\u6587\u6863\uff0c\u8981\u66f4\u6539\u6743\u9650\uff0c\n\u8bf7\u5411\u6587\u6863\u521b\u5efa\u8005\u53d1\u8d77\u7533\u8bf7\u3002",o=!0,i="\u5f53\u524d\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c\n\u70b9\u51fb\u7533\u8bf7\u7f16\u8f91\u6743\u9650\u3002"):(t="\u767b\u5f55\u540e\u83b7\u5f97\u66f4\u591a\u64cd\u4f5c\u6743\u9650",i="\u5f53\u524d\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c\n\u767b\u5f55\u540e\u83b7\u5f97\u66f4\u591a\u64cd\u4f5c\u6743\u9650\u3002"),{tip:t,isNeedApplyAuth:o,hoverTip:i}}},{key:"doAuthApply",value:function(e){(0,s.loadModule)("PermitApply",function(t,n){t.permitApply(clientVars.padType,null,e),T_SHEET.Report.tdwReport({opername:"doc_author",module:"edit",action:"clk_apply"})})}},{key:"checkIsApplyIn24H",value:function(e){var t=this;$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/auth_apply/check",xhrFields:{withCredentials:!0},data:{bkn:(0,l.getBkn)(),domainId:clientVars.domainId,localPadId:clientVars.localPadId,xsrf:(0,l.getXsrf)()},success:function(n){var o={apply:!1};!n||10003!==n.retcode&&10004!==n.retcode||(o="0"==n.pass?{apply:!0,noPass:!0}:"1"==n.pass?{apply:!0,pass:!0}:{apply:10003!==n.retcode}),e(o),t.applyAuthStatus=o},error:function(){e({apply:!1})}})}},{key:"getUnreadNumber",value:function(){return this.applicationUnreadNumber}},{key:"checkHasRedpoint",value:function(e){var t=this;$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/notify_getnum",xhrFields:{withCredentials:!0},data:{bkn:(0,l.getBkn)()},success:function(e){e&&0===e.retcode&&((0,c.isUndefined)(e.unread_sum_count)?t.clearUnreadNotificationNumber():t.setUnreadNotificationNumber(e.unread_sum_count))},error:function(){e&&e(!1)}})}},{key:"removeOutSideRedPointToServer",value:function(e){$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/user_flag/setRedDot",xhrFields:{withCredentials:!0},data:{bkn:(0,l.getBkn)(),type:8,flag:0},type:"post",success:function(t){t&&10003===t.retcode?e&&e(!0):e&&e(!1)},error:function(){e&&e(!1)}})}},{key:"setUnreadNotificationNumber",value:function(e){this.applicationUnreadNumber=0,this.addUnreadNotificationNumber(e)}},{key:"addUnreadNotificationNumber",value:function(e){e=e||0,this.applicationUnreadNumber+=e,this.setOutSideRedPoint(!0);var t=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:this.applicationUnreadNumber}});document.dispatchEvent(t)}},{key:"delUnreadNotificationNumber",value:function(e){e=e||0,this.applicationUnreadNumber-=e,this.applicationUnreadNumber<0&&(this.applicationUnreadNumber=0),this.setOutSideRedPoint();var t=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:this.applicationUnreadNumber}});document.dispatchEvent(t)}},{key:"clearUnreadNotificationNumber",value:function(){this.applicationUnreadNumber=0,this.setOutSideRedPoint(!0);var e=new CustomEvent("setUnreadNotificationNumberNoti",{detail:{number:0}});document.dispatchEvent(e)}},{key:"setOutSideRedPoint",value:function(e){var t=this.applicationUnreadNumber;window.SLR.load("AccountAvatar",function(e){e.updateRedPoint(t)}),t?T_SHEET.Report.tdwReport({opername:"doc_author",module:"notice",action:"exp_red_notice"}):!e&&this.removeOutSideRedPointToServer()}}]),e}();t.default=new p},"./js/app/beginner-guide/beginner-guide.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default=new function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init=function(e,n,o){var i=t;if(i.isMobile=!1,n&&(i.isMobile=n),e||(e=$("body")),i.closeCallback=o,$("#beginne-guide-wrapper").length){if($("#beginne-guide-wrapper").parent().length){var a=$("#beginne-guide-wrapper").detach();e.append(a),a=$("#beginne-guide-shadow-mask").detach(),e.append(a)}}else $("<div id='beginne-guide-shadow-mask' onselectstart='return false;' style='-moz-user-select:none;'/>").prependTo(e),$("<div id='beginne-guide-wrapper' onselectstart='return false;' style='-moz-user-select:none;'> <div class='beginne-guide-wrapper-close'/> <div class='beginne-guide-wrapper-button'>\u7acb\u5373\u4f53\u9a8c</div></div>").prependTo(e),n&&$("#beginne-guide-wrapper").addClass("mobile-beginne-guide"),$("#beginne-guide-shadow-mask").on("click",function(e){return e.preventDefault(),e.stopPropagation(),!1}),i.isMobile&&document.addEventListener("touchmove",function(e){if($("#beginne-guide-wrapper").is(":visible"))return e.preventDefault(),e.stopPropagation(),!1},!1),$(".beginne-guide-wrapper-button").hover(function(){$(this).removeClass("beginne-guide-wrapper-button-down"),$(this).addClass("beginne-guide-wrapper-button-hover")},function(){$(this).removeClass("beginne-guide-wrapper-button-hover"),$(this).removeClass("beginne-guide-wrapper-button-down")}),$(".beginne-guide-wrapper-button").on("mousedown",function(){$(this).removeClass("beginne-guide-wrapper-button-hover"),$(this).addClass("beginne-guide-wrapper-button-down")}).on("mouseup",function(){$(this).removeClass("beginne-guide-wrapper-button-down"),$(this).addClass("beginne-guide-wrapper-button-hover")}),$("#beginne-guide-wrapper div").on("click",function(){i.close()}),$(window).on("resize",function(){i.fitPosition(e)});i.fitPosition(e),i.show()},this.fitPosition=function(e){$("#beginne-guide-wrapper").css("left",Math.floor((Math.min(e.width(),$(window).width())-$("#beginne-guide-wrapper").outerWidth())/2)),$("#beginne-guide-wrapper").css("top",Math.floor(.4*(Math.min(e.height(),$(window).height())-$("#beginne-guide-wrapper").outerHeight())))},this.close=function(){var e=t;e.hide(),$.ajax({type:"get",url:"/ep/api/settipflag",data:{type:2,flag:1},success:function(e){}}),e.closeCallback instanceof Function&&e.closeCallback()},this.show=function(){$("#beginne-guide-wrapper").hide().fadeIn(200),$("#beginne-guide-shadow-mask").hide().fadeIn()},this.hide=function(){$("#beginne-guide-wrapper").show().fadeOut(200),$("#beginne-guide-shadow-mask").show().fadeOut(200)}}},"./js/app/beginner-guide/create-logo-guide.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./js/utils/browser.js"),i=n("./js/utils/ui/tooltip.js");t.default=function(){if(window.logoGuide)return window.logoGuide;var e=(0,o.getCookie)("p_uin");e=e.replace("o0","").replace("o","");var t=(0,o.getQuery)("frombtn"),n="";"fav"===t?n="-fav":"edit"===t&&(n="-edit");var a=JSON.parse((0,o.getCookie)("isBrandGuideShow"+n)||"{}"),r={fromBtn:t,showLogoGuide:function(e){},initLogo:function(){$(".brand_logo_new").on("mouseenter",function(){r.closeTip()}),$(".brand_logo_new").on("mouseenter",function(){r.close(),r.setFlag()})},animateLogo:function(e){$(".brand_logo_new").show().css({left:"-61px",opacity:"0.2"}).addClass("new-logo-animation").animate({opacity:1,left:"0px"},300,function(){e&&e()}),$("#padAloneTitle").animate({opacity:1},700),setTimeout(function(){$(".brand_logo_new").removeClass("active"),e&&e()},800)},show:function(){if(!$("#logo-guide-wrapper").length&&$(".brand_logo_new").length){var e=!!window.navigator.userAgent.match(/(TencentDocs)/i);!this.checkFlag()||"fav"!==t&&"edit"!==t?this.checkFlag()||"fav"!==t?this.checkFlag()&&!t?$(".brand_logo_new").show():((0,i.tooltip)(".brand_logo_new",{beforeLeft:"44.5px"}),$(".brand_logo_new").show()):((0,i.tooltip)(".brand_logo_new",{beforeLeft:"24.5px"}),r.animateLogo(function(){r.initLogo()})):($(".brand_logo_new").show(),e||"fav"===t&&r.showLogoGuide("\u6587\u6863\u5df2\u6536\u85cf\u5230\u8fd9\u91cc"))}},showStaticLogo:function(){$(".brand_logo_new").show()},showTip:function(e){$('<div id="tooltip-static" style="top: 82px; left: 10px; z-index: 100000; max-width: 300px; padding-left: 9px; text-align: center; display: block;"><div id="tooltip-before" style="left: 24.5px;"></div>'+e+"</div>").prependTo($("body")),setTimeout(function(){$("#tooltip-static").remove()},5e3)},closeTip:function(){$("#tooltip-static").remove()},close:function(){$("#logo-guide-wrapper").hide().fadeOut(200),setTimeout(function(){$("#logo-guide-wrapper").remove()},250)},checkFlag:function(){var n=!a.hasOwnProperty(e);return!clientVars.preview&&n&&"edit"!==t&&window.gEditable},checkSaveFlag:function(){var n=!a.hasOwnProperty(e);return!clientVars.preview&&n&&("edit"===t||!t)},setFlag:function(){a[e]=!0,(0,o.setCookie)("isBrandGuideShow"+n,JSON.stringify(a),"docs.qq.com","/",8760)}};return window.logoGuide=r,r}},"./js/app/beginner-guide/user-flag-utils.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setTipFlag=void 0;var o=n("./js/utils/user-agent.js"),i=n("./js/utils/browser.js"),a=n("./js/utils/ui/dom.js"),r=b(n("./js/network/login.js")),s=b(n("./js/config/index.js")),l=b(n("./js/app/beginner-guide/create-logo-guide.js")),d=b(n("./js/app/beginner-guide/beginner-guide.js")),c=(b(n("./js/app/tips/new-user-guide.js")),n("./js/component/toast/index.js")),u=b(n("./js/app/quick-save/quick-save.js")),p=b(n("./js/component/dialog/common-dialog-banner.js")),h=b(n("./js/component/banner/common-banner-pc.js")),f=b(n("./js/component/banner/common-banner-mo.js")),m=b(n("./js/component/common/online-dialog/online-dialog.js")),g=n("./js/event/event-center.js"),w=n("./js/config/sheet.js"),v=n("../node_modules/@tencent/tencent_doc_open_url/index.js");function b(e){return e&&e.__esModule?e:{default:e}}function _(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var y=157,T=168,E=!1,C=t.setTipFlag=function(e,t){$.ajax({type:"get",url:"/ep/api/settipflag",data:e,success:function(e){t&&t(e)}})},x=function(e){return!!(e&&e.login_time&&e.login_time+86400>Date.now()/1e3)},S=function e(){var t=this;_(this,e),this.handleUserInfoSuccess=function(e){var n=t;t.userInfo=e,o.isMobile||function(e){window.clientVars.userInfo=e,window.clientVars.userType=(0,i.getCookie)("utype"),window.clientVars.uidKey=(0,i.getCookie)("uid_key")}(e),!s.default.isPreview&&!x(t.userInfo)&&n.reqBannerInfo(),n.showBeginnerGuide(),o.isMobile?(console.log("diff = "+((new Date).getTime()/1e3-t.userInfo.login_time)),t.userInfo.login_time&&(new Date).getTime()/1e3-t.userInfo.login_time<=60&&(!0,n.reqBannerNewUserGuide()),n.reqBannerShortcut4m(),n.reqBannerDownloadApp()):(o.userAgent.ie?(n.reqBannerBookmark(),n.reqDownloadPcApp(),n.reqBannerShortcut()):(console.log("~_~ not ie reqBannerShortcut"),n.reqDownloadPcApp(),n.reqBannerShortcut()),n.reqBannerShortcut()),window.clientVars&&!window.clientVars.isLogin&&(window.log&&log.error("ClientVars.isLoginFalseException",{module:"core-sheet",isMobile:clientVars.isMobile,hascookie:r.default.hasLoginCookie(),utype:(0,i.getCookie)("utype"),pttype:r.default.ptLoginType()}),r.default.loginReport({errCode:0,cgi:r.default.hasLoginCookie()?"ClientVars.isLoginFalseException":"ClientVars.isLoginFalseNoCookie",loginType:"login_exception_report"}))},this.handleUserInfoFailed=function(e){if(window.clientVars&&window.clientVars.isLogin){var t=e.hasOwnProperty("retcode")&&e.retcode||e.hasOwnProperty("errCode")&&e.errCode||-306;window.log&&log.error("ClientVars.isLoginTrueException",{module:"core-sheet",isMobile:clientVars.isMobile,hascookie:r.default.hasLoginCookie(),utype:(0,i.getCookie)("utype"),pttype:r.default.ptLoginType(),errCode:t}),r.default.loginReport({errCode:t,cgi:r.default.hasLoginCookie()?"ClientVars.isLoginTrueException":"ClientVars.isLoginTrueNoCookie",loginType:"login_exception_report"})}},this.handleGuideTip=function(e){var n=(0,l.default)();if((e.newUserTip||(o.isMobile||-1==navigator.appVersion.indexOf("Win"))&&!window.isTimApp)&&(0!=e.templateTip||o.isMobile)?window.isTimOnline&&!o.isMobile&&n.show():n.showStaticLogo(),e.importTipNew){for(var a=Number(e.importTipNew).toString(2),r=a.length,s="",d=["\u6570\u636e\u9a8c\u8bc1","\u6761\u4ef6\u683c\u5f0f","\u5f62\u72b6\u6216\u56fe\u8868","\u8de8\u8868\u8c03\u7528"],u=[],p=r-1;p>=0;p--)"1"===a.charAt(p)&&u.push(d[r-p-1]);return s=u.length>2?"\u683c\u5f0f\u590d\u6742\u7684\u6587\u6863\u8f6c\u6362\u540e\u53ef\u80fd\u5b58\u5728\u5185\u5bb9\u4e0d\u5b8c\u6574\u3002":"\u8868\u683c\u5185\u5305\u542b"+u.join("\u548c")+"\u7b49\u590d\u6742\u683c\u5f0f\uff0c\u8f6c\u6362\u540e\u53ef\u80fd\u5b58\u5728\u5185\u5bb9\u4e0d\u5b8c\u6574\u3002",void(a>0&&((0,c.showToast)(s,{top:5,"max-width":500},{toolToastCloseTime:3e3,isNeedReflush:!0,toolToastRemoveCallBack:function(){C({type:35,flag:0,globalPadId:clientVars.globalPadId})}}),$("body").on("connetStatueChangeEvent",function(e,t){"RECONNECTING"!=t&&"DISCONNECTED"!=t||(0,c.hideToast)()})))}if(e.beforeUpdateTip&&0==e.beforeUpdateTip.flag){var h=e.beforeUpdateTip.content_beforeupdate,f={top:(0,w.getOffTop)(),"z-index":501};(0,c.showToast)(h,f,{isNeedClose:!0,isNeedReflush:!0},null)}else x(t.userInfo)||!e.afterUpdateTip||0!=e.afterUpdateTip.flag||$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/user_info",data:{xsrf:(0,i.getXsrf)()},success:function(t){if(t&&t.login_time&&t.login_time+86400>Date.now()/1e3){var n={top:(0,w.getOffTop)(),"z-index":501,"max-width":800};(0,c.showToast)("\u5df2\u66f4\u65b0\u5230\u6700\u65b0\u7248\u672c\uff0c\u5728\u7ebf\u6587\u6863\u652f\u6301\u5168\u5c40\u67e5\u627e\u548c\u66ff\u6362\uff0c\u4f18\u5316\u6279\u91cf\u4fee\u6539\u5728\u7ebf\u8868\u683c\u884c\u9ad8\u4f53\u9a8c\uff0c<span class='view_announcement tendoc-blue-text'>\u70b9\u51fb\u67e5\u770b\u66f4\u65b0\u516c\u544a</span>\u3002",n,{isNeedClose:!0,isNeedReflush:!0},null),$(".view_announcement").off("click").on("click",function(){(0,c.hideToast)(),m.default.createDialog(e.afterUpdateTip.content_afterupdate,null,function(){})})}}})},this.reqDownloadPcApp=function(){var e=this;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:T},success:function(t){0==t.retcode?e.reqUserFlag(1048576,function(n){0==n.typeFlag?e.handleBannerShortCutAndBookmark(t):console.log("~_~ reqUserFlag user has pc client")}):console.log("~_~ retcode != 0")}})},this.reqBannerShortcut=function(){var e=t;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:y},success:function(t){t&&0==t.retcode&&e.handleBannerShortCutAndBookmark(t)}})},this.reqBannerShortcut4m=function(){var e=t;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:161},success:function(t){0==t.retcode&&e.handleBannerShortCutAndBookmark(t)}})},this.reqBannerBookmark=function(){var e=t;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:158},success:function(t){0==t.retcode&&e.handleBannerShortCutAndBookmark(t)}})},this.reqBannerDownloadApp=function(){var e=t;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:160},success:function(t){0==t.retcode&&e.handleBannerShortCutAndBookmark(t)}})},this.reqBannerNewUserGuide=function(){var e=this;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:164},success:function(t){console.log("new user rsp = "+JSON.stringify(t)),0==t.retcode&&e.handleBannerShortCutAndBookmark(t,!0)}})},this.reqNotifications=function(){var e=this;console.log("new user: start req notifications"),$.ajax({url:"/cgi-bin/online_docs/notify_list",type:"GET",data:{xsrf:(0,i.getXsrf)(),start:0},xhrFields:{withCredentials:!0},success:function(t){console.log("notifications rsp = "+JSON.stringify(t)),t.list&&t.list.length&&t.list.forEach(function(t){if(t&&14===t.type&&(console.log("diff = "+((new Date).getTime()/1e3-t.send_date)),t.send_date&&(new Date).getTime()/1e3-t.send_date<=60))return!0,void e.reqBannerNewUserGuide()})},error:function(e){console.log("cgi notify_list failed: "+e)},complete:function(){}})},this.reqRotateSupportTip=function(){var e=t,n=(0,o.getClientVersion)();(n.tim_version>"2.2.5"||n.qq_version>"7.6.8"||n.app_version>"1.2.0")&&e.reqUserFlag(64,e.handleRotateTip)},this.reqBannerInfo=function(){var e=t;$.ajax({type:"post",url:"/cgi-bin/banner/banner_get",data:{page_id:5,xsrf:(0,i.getXsrf)()},success:function(t){0==t.retcode&&e.handleBannerInfo(t)}})},this.reqUserFlag=function(e,t){$.ajax({type:"post",url:"/cgi-bin/online_docs/user_flag",data:{type:e},success:function(e){0==e.retcode&&t&&t(e)}})},this.handleBannerInfo=function(e){var n=t,i=e.infos;if(i){var a=null;if($.each(i,function(e,t){(6==t.act_id||!o.isMobile&&1&t.pc_enable)&&(!a||a.weight<t.weight)&&(a=t)}),a)6==a.act_id?n.handleBanner_6(a):n.handleCommonBanner(a)}},this.exposeBanner=function(e,t){$.ajax({type:"post",url:"/cgi-bin/banner/banner_expose",data:{page_id:5,xsrf:(0,i.getXsrf)(),act_id:e},success:function(e){t&&t(e)}})},this.clickBanner=function(e,t){$.ajax({type:"post",url:"/cgi-bin/banner/banner_click",data:{page_id:5,xsrf:(0,i.getXsrf)(),act_id:e},success:function(e){t&&t(e)}})},this.exposeBannerTo9999=function(e,t){$.ajax({type:"post",url:"/cgi-bin/banner/banner_expose",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:e},success:function(e){t&&t(e)}})},this.clickBannerTo9999=function(e,t){$.ajax({type:"post",url:"/cgi-bin/banner/banner_click",data:{page_id:9999,xsrf:(0,i.getXsrf)(),act_id:e},success:function(e){t&&t(e)}})},this.handleCommonBanner=function(e){var n=t;if(null!=e&&1===e.is_open&&clientVars.isLogin&&o.isMobile){n.exposeBanner(e.act_id),T_SHEET.Report.tdwReport({opername:"doc_oper",module:"tip_pc",action:"exp"});var i=e.pc_title,a=e.text,r=e.time_hide,s=e.pc_url||e.url;s&&(s.match(/^(https?:)?\/\//i)||(s="//"+s)),(0,h.default)().showCommon(i,a.substring(0,60),s?"\u7acb\u5373\u67e5\u770b":"\u6211\u77e5\u9053\u4e86",function(t){n.clickBanner(e.act_id),T_SHEET.Report.tdwReport({opername:"doc_oper",module:"tip_pc",action:t?"clk":"close"}),t&&s&&(0,v.tencentDocOpenUrl)(s)},r)}},this.getNowFormatDate=function(){var e=new Date,t=e.getFullYear(),n=e.getMonth()+1,o=e.getDate();return n>=1&&n<=9&&(n="0"+n),o>=0&&o<=9&&(o="0"+o),t+"-"+n+"-"+o},this.markLastTime2localStorage=function(e){e&&localStorage.setItem(e,self.getNowFormatDate())},this.getkLastTime2LocalStorage=function(e){if(e)return localStorage.getItem(e)},this.handleBannerShortCutAndBookmark=function(e){var n=t,i=e.infos;if(i){var a=i[0];null!=a&&clientVars.isLogin?E||(E=!0,o.isMobile?n.handleBanner_ShortCutAndBookmark(a):setTimeout(function(){n.handleBanner_ShortCutAndBookmark(a)},1e4)):console.log("~_~ info == null")}else console.log("~_~ infos == null")},this.handleBanner_ShortCutAndBookmark=function(e){var n=t,r=JSON.parse(e.frontend_data);if(r){var s=r.custom_json;if(s){var l=i.getQuery.tdsourcetag;if(s.tdsourcetag&&s.tdsourcetag.length&&s.tdsourcetag.length>0){for(var d=!1,c=0;c<s.tdsourcetag.length;c++)if(s.tdsourcetag[c]===l){d=!0;break}if(!d)return void console.log("~_~ tdsourcetag\u4e0d\u5339\u914d")}else if(o.isMobile||"s_pcqq_file_edit"!==l){if(!o.isMobile||"s_qq_aiomsg"!==l)return void console.log("~_~ tdsourcetag\u4e0d\u5339\u914d")}else;var f,m=n.getNowFormatDate();if(e.act_id===y||161===e.act_id?f=n.getkLastTime2LocalStorage("last-shortcut-guide-time"):158===e.act_id?f=n.getkLastTime2LocalStorage("last-bookmark-guide-time"):160===e.act_id&&(f=n.getkLastTime2LocalStorage("last-download-guide-time")),m!==f){var g=e.act_id;if(o.isMobile){if(161!=g&&160!=g)return;n.getkLastTime2LocalStorage("last-newuser-guide-time");if(window.screen.width>window.screen.height)return;if(!window.mqq||"0"===mqq.QQVersion||164!=g&&o.isTim)return;if(mqq.android&&161===g){var w=navigator.userAgent.toLowerCase();if(-1!=w.indexOf("android 8")||-1!=w.indexOf("android 9"))return}if(164===g&&!s.show)return void console.log("new user guide dialog closed");var v=localStorage.getItem("tdsourcetag");(mqq.android&&(161===g||160===g)||mqq.iOS&&160===g||164===g)&&window.mqq.ui.setTitleButtons({left:{title:"\u8fd4\u56de",callback:function(){tdwReport({opername:"doc_excel_editor",module:"excel_topbar",action:"top-bar-back-list"}),console.info((mqq.iOS?"ios":"android")+" : "+g),function(){164!=g?(n.exposeBannerTo9999(g),n.markLastTime2localStorage(161===g?"last-shortcut-guide-time":"last-download-guide-time")):n.markLastTime2localStorage("last-newuser-guide-time");var e=(0,p.default)(),t=(s.mobileTitle,s.mobileSubTitle),o=s.mobileButtonTitle,i=161===g?"mobile_shortcut":"mobile_download",a="popups",r=161===g?"clk_create":"clk_download",l=164===g?"clk_quit":"clk_cancel";164===g&&(i="doc_guide",a="new_users",r="clk_known"),e.show(164===g,t,o,function(e){e&&(164!=g&&n.clickBannerTo9999(g),161===g&&mqq.android?mqq.ui.addShortcut({action:"web",title:"\u817e\u8baf\u6587\u6863",icon:"http://sqimg.qq.com/QQHDs/poster/teamwork_docs_icon.png",url:"https://docs.qq.com/desktop/m/index.html?tdsourcetag=s_mqq_andr_shortcut",callback:function(e){"0"===e.result&&T_SHEET.Report.tdwReport({opername:i,module:"result",action:"suc_create",source3:v||""})}}):160===g&&(mqq.iOS?window.mqq.ui.openUrl({url:"https://itunes.apple.com/cn/app/%E8%85%BE%E8%AE%AF%E6%96%87%E6%A1%A3/id1370780836?mt=8",target:2}):mqq.android&&window.mqq.ui.openUrl({url:"http://sqdd.myapp.com/myapp/qqteam/docsAPP/TencentDocs_1.4.0.33_17478-QQfileeditRelease-cid4321-20181114193355.apk",target:0}))),T_SHEET.Report.tdwReport({opername:i,module:a,action:e?r:l,source3:v||""}),window.mqq.ui.setTitleButtons({left:{title:"\u8fd4\u56de",callback:function(){tdwReport({opername:"doc_excel_editor",module:"excel_topbar",action:"top-bar-back-list"}),window.mqq.ui.popBack()}}}),e&&164===g&&window.mqq.ui.popBack()}),T_SHEET.Report.tdwReport({opername:i,module:a,action:"expo_popup",source3:v||""})}()}}})}else if(!o.isMobile){var b=s.title,_=s.subTitle,E=s.buttonTitle;v=localStorage.getItem("tdsourcetag");if(g==y||g==T){g==y?n.markLastTime2localStorage("last-shortcut-guide-time"):g==T&&n.markLastTime2localStorage("last-download-guide-time"),function(e,t,o){var i,r,s,l,d=!1;function c(){i.hide()}return{show:function(){d||(o?(i=$('<div id="common-banner-pc" class="common-banner-pcbottom-shortcut user-select-none"><div class="docx-icon-common banner-pcbottom-close-btn-shortcut close-normal_20dp"></div><div class="banner-pcbottom-tip-shortcut"></div><div class="banner-pcbottom-tip-img-shortcut"></div><div class="banner-pcbottom-btn-shortcut header-function-btn-blue-normal">\u521b\u5efa</div></div>'),l=i.find(".banner-pcbottom-tip-shortcut")):(i=$('<div id="common-banner-pc" class="common-banner-pcbottom-shortcut user-select-none"><div class="docx-icon-common banner-pcbottom-close-btn-shortcut close-normal_20dp"></div><div class="banner-pcbottom-tip-download"></div><div class="banner-pcbottom-tip-img-download"></div><div class="banner-pcbottom-btn-shortcut header-function-btn-blue-normal">\u521b\u5efa</div></div>'),l=i.find(".banner-pcbottom-tip-download")),i.appendTo(document.body),s=i.find(".banner-pcbottom-close-btn-shortcut"),r=i.find(".banner-pcbottom-btn-shortcut"),(0,a.btnState)(i.find(".banner-pcbottom-btn-shortcut"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,a.btnState)(i.find(".banner-pcbottom-close-btn-shortcut"),"close-normal_20dp","close-hover_20dp","close-click_20dp"),s.click(function(){g==y?T_SHEET.Report.tdwReport({opername:"pc_shortcut",module:"popups",action:"clk_cancel",source3:v||""}):g==T&&T_SHEET.Report.tdwReport({opername:"client_download",module:"popups",action:"clk_cancel",source3:v||""}),c()}),r.click(function(){if(n.clickBannerTo9999(g),g==y)window.location.href=u.default.creatShortcutToDesktop(),T_SHEET.Report.tdwReport({opername:"pc_shortcut",module:"popups",action:"clk_create",source3:v||""});else if(g==T){var e=$("<form>");e.attr("style","display:none"),e.attr("method","get"),e.attr("action","http://sqdd.myapp.com/myapp/qqteam/docsAPP/PCQQfileedit.exe"),$("body").append(e),e.submit(),T_SHEET.Report.tdwReport({opername:"client_download",module:"popups",action:"clk_download",source3:v||""})}c()}),d=!0),r.text(e||""),l.text(t||""),i.show(),g==y?T_SHEET.Report.tdwReport({opername:"pc_shortcut",module:"popups",action:"expo_popup",source3:v||""}):g==T&&T_SHEET.Report.tdwReport({opername:"client_download",module:"popups",action:"expo_popup",source3:v||""}),n.exposeBannerTo9999(g)},hide:c}}(E,_,g==y).show()}else if(158==g){n.markLastTime2localStorage("last-bookmark-guide-time"),s.bannerType,n.exposeBannerTo9999(g),(0,h.default)().showBottom(b,_,E,function(e){e?(n.clickBannerTo9999(g),n.addToBookMark(),e&&T_SHEET.Report.tdwReport({opername:"pc_bookmark",module:"popups",action:"clk_add",source3:v||""})):T_SHEET.Report.tdwReport({opername:"pc_bookmark",module:"popups",action:"clk_cancel",source3:v||""})},{title:{type:"text"},iconType:"bookmark"}),T_SHEET.Report.tdwReport({opername:"pc_bookmark",module:"popups",action:"expo_popup",source3:v||""})}}}else console.log("~_~ \u540c\u4e00\u5929\u5c31\u5f39\u4e00\u6b21")}else console.log("~_~ docsData == null")}else console.log("~_~ frontData == null")},this.addToBookMark=function(e,t){if(e||((e=window.location.href).match("tdsourcetag")?e=(0,i.updateQueryStringParameter)(e,{tdsourcetag:"s_browser_bookmark"}):e+="&tdsourcetag=s_browser_bookmark"),t||(t=document.title),o.userAgent.isIE())try{external.AddToFavoritesBar(e,t)}catch(n){try{window.external.addFavorite(e,t)}catch(n){try{window.sidebar.addPanel(t,e)}catch(n){alert("\u52a0\u5165\u6536\u85cf\u5931\u8d25\uff0c\u8bf7\u4f7f\u7528Ctrl+D\u8fdb\u884c\u6dfb\u52a0")}}}},this.handleBanner_6=function(e){var n=t;if(null!=e&&1===e.is_open&&clientVars.isLogin){var a=JSON.parse(e.frontend_data);if(a&&a.docs_data){var r=a.docs_data;if(o.isMobile){var s=function(){n.exposeBanner(6),(0,f.default)().showBottom(l,d,"\u7acb\u5373\u4f53\u9a8c",function(e){o.isMiniProgram&&e?g.event.notificationCenter.trigger("navigateToListOfDocs"):e&&(0,v.tencentDocOpenUrl)("https://docs.qq.com/desktop/m/index.html"),g.event.notificationCenter.trigger("cancelForbidEntryForListOfDocs"),e&&T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"non_guide_mob",action:"guide_clk"})}),g.event.notificationCenter.trigger("forbidEntryForListOfDocs"),T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"non_guide_mob",action:"guide_banner_exp"})};if(o.isTim||"1"===(0,i.getQuery)("_from"))return;var l=r.mobileTitle,d=r.mobileSubTitle;0==r.docs_user?s():n.reqUserFlag(16,function(e){0==e.typeFlag&&s()})}else if(!o.isMobile){var c=function(e){n.exposeBanner(6);var t=(0,h.default)();0===e&&(t.showBottom(l,d,"\u4e86\u89e3\u66f4\u591a",function(e){e&&(0,v.tencentDocOpenUrl)("https://docs.qq.com"),e&&T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"non_guide_pc",action:"top_r_box_clk"})},{title:{type:"img",style:{"background-image":"url(//sqimg.qq.com/qq_product_operations/tencent-doc/tencent-doc-banner-logo.png)",width:"96px",height:"26px","-webkit-transform":"translate(-1px,6px)",transform:"translate(-1px,6px)","margin-bottom":"8px"}}}),T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"non_guide_pc",action:"top_r_box_exp"}),T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"non_guide_pc",action:"top_ad_exp"}))};l=e.text,d=r.subTitle;1==r.docs_user?n.reqUserFlag(16,function(e){0==e.typeFlag&&c(r.bannerType)}):c(r.bannerType)}}}},this.handleRotateTip=function(e){o.isMobile&&(e.typeFlag||window.orientation)},this.reqUserInfo=function(){var e=t;$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/user_info",data:{xsrf:(0,i.getXsrf)()},success:function(t){t.hasOwnProperty("retcode")&&0==t.retcode?e.handleUserInfoSuccess(t):e.handleUserInfoFailed(t)},error:function(t){e.handleUserInfoFailed(t)}})},this.showBeginnerGuide=function(e){var n=t;if(!1===x(e))return n.showUserGuide();n.reqUserFlag(2048,function(e){var t=!o.isMobile&&-1!=navigator.appVersion.indexOf("Win")||window.isTimApp;e&&0===e.typeFlag&&t?d.default.init($("body"),o.isMobile,n.closeBeginnerGuide.bind(n)):n.showUserGuide()})},this.showUserGuide=function(){var e=t;$.ajax({type:"get",url:"/ep/api/getalltipflag",data:{globalPadId:clientVars.globalPadId,xsrf:(0,i.getXsrf)()},success:function(t){100==t.retcode&&e.handleGuideTip(t)}})},this.closeBeginnerGuide=function(){var e,n,o=t;$.ajax({type:"post",url:"/cgi-bin/online_docs/user_flag/save",data:{type:2048,flag:1},success:function(t){t&&0===t.retcode?e instanceof Function&&e(t):n instanceof Function&&n(t)},error:function(e){n instanceof Function&&n(e)}}),o.showUserGuide()},this.userInfo={}};t.default=new function e(){var t=this;_(this,e),this.reqGuideTip=function(){!1===t.isRequesting&&(t.isRequesting=!0,t.userFlagTool.reqUserInfo())},this.userFlagTool=new S,this.isRequesting=!1}},"./js/app/bootStrap.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();n("./js/report/weblog-config.js"),n("./js/report/raven-config.js");var i=n("./js/report/whitescreen.js"),a=n("./js/config/index.js"),r=N(a),s=n("./js/config/sheet.js"),l=n("./js/network/ajax.js"),d=N(n("./js/network/login.js")),c=n("./js/network/pskey-error.js"),u=N(n("./js/network/client.js")),p=N(n("./js/report/flowlog.js")),h=n("./js/script-loader/index.js"),f=n("./js/event/keyborad.js"),m=n("./js/event/event-center.js"),g=N(n("./js/event/web-interface-extra.js")),w=n("./js/utils/user-agent.js"),v=n("./js/utils/ui/tooltip.js"),b=n("./js/utils/env.js"),_=n("./js/utils/browser.js"),y=(n("./js/utils/ui/index.js"),N(n("./js/app/tips/over-con-number.js"))),T=N(n("./js/app/auth/index.js")),E=N(n("./js/app/auth/advanced.js")),C=N(n("./js/app/header/pc/pc-header.js")),x=N(n("./js/app/init/pc-init.js")),S=N(n("./js/app/beginner-guide/user-flag-utils.js")),k=N(n("./js/app/keyboard/index.js")),A=N(n("./js/app/aria/index.js")),I=(N(n("./js/app/web-socket-ui/ui-center.js")),n("./js/component/toast/index.js")),R=N(n("./js/network/login.js")),O=N(n("./js/app/template-info/index.js")),D=N(n("./js/app/app-guide/index.js")),j=n("../spread-sheet/src/base/config/report.ts"),M=n("./js/report/pv.js");function N(e){return e&&e.__esModule?e:{default:e}}var P=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"start",value:function(){i.coreSheetChecker.start(),this.initClientVars();try{T_SHEET.Report.run(j.CONFIG.RESET_DEFAULT_TDW_DATA)}catch(e){}R.default.wxworkLogin(),(0,l.manualInitAjax)(),(0,f.manualInitKeyboard)(),x.default.immInit(),C.default.immInit(),this.bindEvent(),this.initSpreadSheet(),k.default.init(),A.default.init()}},{key:"initClientVars",value:function(){(0,a.initConfig)(),(0,s.setMyUserInfo)(),u.default.initConfig(clientVars.collab_client_vars,(0,s.getMyUserInfo)(),{colorPalette:clientVars.colorPalette})}},{key:"initCanvasDomPc",value:function(){if(!w.isMobile){var e=document.getElementById("padeditor"),t=document.createElement("div");t.id="canvasContainer",t.innerHTML="",e.appendChild(t);var n=window.innerHeight-e.getBoundingClientRect().top-25;t.style.height=n+"px",t.style.width="100%",t.style.display="block",t.style.zIndex=500,w.isPad||$("#inputboxwithpc").show(),w.userAgent.mozilla&&(document.documentElement.style.position="fixed")}}},{key:"loadLazyCss",value:function(){n.e("bundle_lazy_css").then(n.t.bind(null,"./css/index-lazy-pc.less",7)).then(function(e){return e.default})}},{key:"initSpreadSheet",value:function(){this.loadLazyCss(),this.initCanvasDomPc(),p.default.info("listen spreadLoadSuccess"),i.coreSheetChecker.end(),m.event.default.listen("spreadLoadSuccess",function(e){i.whiteScreenChecker.start(),console.log("start init spread");try{SpreadsheetApp.init(),i.whiteScreenChecker.end()}catch(t){throw i.whiteScreenChecker.endWithError(t),t}})}},{key:"bindToolTip",value:function(){m.event.keyboard.listen("resize",function(){$("#tooltip").remove()}),m.event.keyboard.listen("keydown",function(){$("#tooltip").remove()}),!w.isMobile&&r.default.gEditable&&(0,v.tooltip)("#toolbar [data-tooltip]")}},{key:"bindEvent",value:function(){var e=this;m.event.default.listen("spreadInitFinished",function(){window.performanceData&&(window.performanceData.spreadInitFinished=Number(new Date)),p.default.info("spreadInitFinished"),console.log("======== spreadInitFinished ========"),(0,a.initExternalConfig)(),S.default.reqGuideTip(),e.initAfterCanvas(),(0,h.manualInitScriptLoader)(),(0,M.reportForPV)(),(0,M.reportForQLPV)(),x.default.initAfterCanvas(),(0,s.setMyUserInfo)(),C.default.initAfterCanvas(),y.default.init(),e.bindToolTip(),(0,c.manualInitPskeyErrorHandler)(),T.default.bindClickEvent(),T.default.listenNotificationMessage(),E.default.init(),(0,a.manulInitConfigurations)(),(0,b.createEnvAlert)(),u.default.listenEvent(),(0,s.setHasAllLoad)(!0)})}},{key:"onbeforeunload",value:function(){if(window.SpreadsheetApp&&SpreadsheetApp.messageCenter&&SpreadsheetApp.messageCenter.hasUncommittedChanges())return SpreadsheetApp.plugin.context.push({type:"beforeUnload_hasUnCommittedChanges"}),SpreadsheetApp.plugin.context.send(),"\u6587\u6863\u5b58\u5728\u672a\u4fdd\u5b58\u4fee\u6539\uff0c\u5982\u679c\u5173\u95ed\uff0c\u4fee\u6539\u5c06\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u3002\u60a8\u662f\u5426\u786e\u5b9a\u5173\u95ed\uff1f"}},{key:"initAfterCanvas",value:function(){setTimeout(function(){window.loadingProgress&&window.loadingProgress.startTwo()},50),$(document.body).addClass("is-sheet"),$(document.body).addClass(r.default.gEditable?"is-editable":"is-readonly"),$("#padeditor").addClass("loaded"),$(".cell-input").css("pointerEvents","none"),$("#inputboxwithpc .cell-input").css("pointerEvents","auto");var e=(0,_.getCookie)("loginTime");if(r.default.isLogin&&!e){localStorage.removeItem("renewalTime");var t=(new Date).getTime();document.cookie="loginTime="+t+";path=/;domain=.docs.qq.com",d.default.loginReport({errCode:0,loginType:"loginSuc"})}if(null!=clientVars.tid&&0!=clientVars.tid&&10001!=clientVars.tid&&20001!=clientVars.tid&&clientVars.newPad&&!w.isMobile&&!w.isPad){$("#padAloneTitle").focus();(0,I.showToast)("\u5df2\u4ece\u6a21\u677f\u521b\u5efa\u4e86\u65b0\u8868\u683c, \u7acb\u5373\u7f16\u8f91\u4f53\u9a8c\u5427\u3002",{top:"125px"},{toolToastCloseTime:2e3})}if(clientVars.newPad){if("clone"===clientVars.newPadType){$("#padAloneTitle").focus(),(0,I.showToast)("\u751f\u6210\u526f\u672c\u6210\u529f",{top:"125px"},{toolToastCloseTime:2e3});try{var n=document.location.href.split("?")[0]+(0,_.removeURLParameter)((0,_.removeURLParameter)(window.location.search,"newPad"),"newPadType")+window.location.hash;history.replaceState(null,null,n)}catch(i){}}(w.isMobile||w.isPad)&&(g.default.ExecuteClient("setDismissWhenBack",{shouldDismiss:1}),g.default.ExecuteClient("setCreateNewPadAndLoaded",{createdAndLoaded:!0}))}if(w.isMobile||w.isPad||(0,_.getQuery)("previewtip")&&(0,I.showToast)("\u5df2\u751f\u6210\u817e\u8baf\u6587\u6863\uff0c\u4efb\u4f55\u4fee\u6539\u5728\u4e91\u7aef\u4fdd\u5b58\uff0c\u4e0d\u4f1a\u6539\u53d8\u539f\u6587\u4ef6\u3002",{top:"5px"},{isNeedClose:!0}),w.isMobile||w.isPad){var o=(0,_.getQuery)(window.location.search);document.referrer&&document.referrer.indexOf("//docs.qq.com/desktop/m/index.html");if(w.isMiniProgram||window.mqq&&"0"!==mqq.QQVersion||w.isWeWork){"1"===o.disableReturnList;n=document.location.href;n=(0,_.removeURLParameter)(n,"disableReturnList"),history.replaceState(null,null,n)}}m.event.notificationCenter.listen("localChangeContent",function(){if(!window.___hasReportUserEdit){var e=localStorage.getItem("tdsourcetag");T_SHEET.Report.tdwReport({opername:"doc_core",module:"edit",action:"edit_text",source3:e||""});try{T_SHEET.Report.monitor(33635052),T_SHEET.Report.monitor(33635110)}catch(i){}window.___hasReportUserEdit=!0}}),"1"===(0,_.getQuery)("qrpr")&&T_SHEET.Report.tdwReport({opername:"doc_pcview"+(localStorage&&localStorage.previewOpenFrom||"fromunknown"),module:"oper",action:"pre_ptlog_suc"}),O.default.init(),D.default.init()}}]),e}();t.default=P},"./js/app/collaborator/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/config/sheet.js"),r=n("./js/network/client.js"),s=(o=r)&&o.__esModule?o:{default:o};var l={},d={all:function(){return l},update:function(e){l[e.id]=e},remove:function(e){delete l[e]},exist:function(e){return l[e]}},c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.authorInfos={}}return i(e,[{key:"setAuthorInfo",value:function(e,t){t?this.authorInfos[e]=t:delete this.authorInfos[e]}},{key:"getUserInfo",value:function(e){var t=this.authorInfos;if(t&&t[e]){var n=t[e];return{id:e,name:n.name,bgcolor:n.bgcolor}}return null}},{key:"isValidUser",value:function(e){var t=this.authorInfos,n=window.clientVars.userId;return e&&0===e.indexOf("p.")&&e!==n&&!!t[e]}},{key:"isGuest",value:function(e){return 0===e.indexOf("g.")}},{key:"_removeCaret",value:function(e,t){this.isValidUser(e)&&(t||d.remove(e),window.SpreadsheetApp.view.canvas.plugins.collabCursor&&window.SpreadsheetApp.view.canvas.plugins.collabCursor.removeCollaborator(e))}},{key:"removeUserCaret",value:function(e){try{this._removeCaret(e.userId||e)}catch(t){console.error(t)}}},{key:"updateUserCaret",value:function(e,t){for(var n=this,o=this.authorInfos[e.changedBy],i=0;i<clientVars.invitedUserInfos.length;i++){if(clientVars.invitedUserInfos[i].userId==e.changedBy){var r=clientVars.invitedUserInfos[i].name;r=r||"",o.name=r;break}}if(this.isValidUser(e.changedBy)&&(!e.sheet||!e.sheet.targetUserId||e.sheet.targetUserId===window.clientVars.userId)){var s=d.exist(e.changedBy),l=(e.sheet.isNew,(0,a.getCurrSubId)());if(l!==e.sheet.tabId)s?s.tabId===l&&this._removeCaret(e.changedBy,!0):window.setTimeout(function(){n.notifyMyPosition({userId:e.changedBy})},0);else{var c=s?"changeCollaborator":"addCollaborator",u={id:e.changedBy,name:o.name,color:o.bgcolor,input:!!e.sheet.isEditing};e.sheet.coords?(u.x=e.sheet.coords[1],u.y=e.sheet.coords[0]):u.shapeId=e.sheet.shapeId,window.SpreadsheetApp.view.canvas.plugins.collabCursor&&window.SpreadsheetApp.view.canvas.plugins.collabCursor[c](u)}d.update({id:e.changedBy,name:o.name,bgcolor:o.bgcolor,userLink:o.userLink,coords:e.sheet.coords,shapeId:e.sheet.shapeId,tabId:e.sheet.tabId,isEditing:e.sheet.isEditing})}}},{key:"notifyMyPosition",value:function(e,t){if(!this.isGuest(clientVars.userId))try{var n,o,i;if(!(o=window.SpreadsheetApp.view.canvas.excel.tableData.pickShape)){var a=window.SpreadsheetApp.view.canvas.excel.selectData.active.xIndex,r=window.SpreadsheetApp.view.canvas.excel.selectData.active.yIndex;-1!==a&&-1!==r&&(n=[r,a,r,a]),i=window.SpreadsheetApp.view.canvas.isEditing}if(!o&&(!n||n.length<=0))return;var l={coords:n,shapeId:o,isEditing:i,targetUserId:(e=e||{}).userId};t&&(l.isNew=!0),s.default.notifyUserCaretUpdate(l)}catch(d){console.error(d)}}}]),e}();t.default=new c},"./js/app/export/utils.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.exportSheetData=function(e,t){if(window.swReportStop&&window.swReportStop(),!1===top.exportFlag)return;top.exportFlag=!1;e||(e=window.clientVars.padId);if(i.isMobile){try{T_SHEET.Report.monitor(34063991)}catch(o){console.warn("report fail")}window.mqq&&window.mqq.invoke("docx","txDocsStartExport",{fileName:(0,a.getTitle)()+".xlsx",padId:e},function(){})}else(0,r.showToast)("\u6b63\u5728\u4e0b\u8f7d\uff0c\u8bf7\u7a0d\u5019...0%",{top:"5px"});console.time("exportTime");if(window.__exportStartTime=new Date,SpreadsheetApp){var n=SpreadsheetApp.handleData.header.length;window._export_util={currentRate:0,baseRate:Number(100/n).toFixed(2),formulasAmount:0,formulasCount:0},window.actionExporting=!0;setTimeout(function(){SpreadsheetApp.file.export({headers:p(SpreadsheetApp.handleData.header),id:e,type:"excel",onSuccess:function(t,n,o){window.actionExporting=!1,window.exportFlag=!0;var i=window.parent.clientVars.collab_client_vars.ver;d(t,n,o,e,i,!0),window.swReportRestart&&window.swReportRestart()},onFail:function(){window.actionExporting=!1,c(),window.swReportRestart&&window.swReportRestart()},onChange:function(e){var t=e.rate;i.isMobile||(0,r.changeToastText)("\u6b63\u5728\u4e0b\u8f7d\uff0c\u8bf7\u7a0d\u5019..."+t+"%")}})},10)}},t.postExportSheetInfo=d,t.exportFailure=c,t.exportSuccess=u,t.deepClone=p;var i=n("./js/utils/user-agent.js"),a=n("./js/config/sheet.js"),r=n("./js/component/toast/index.js"),s=n("./js/app/header/util.js"),l=n("./js/component/dialog/custom-dialog.js");function d(e,t,n,o,s,l){console.timeEnd("exportTime"),delete top._export_util;var d={content:e,v:2,version:s,sheetId:o,comments:JSON.stringify(t)},p=window.performance&&window.performance.memory?window.performance.memory.totalJSHeapSize:"no chrome",f=(e+"").length;try{T_SHEET.Report.monitor(3244869)}catch(g){console.warn("report fail")}var m="/ep/pad/exportsheet/"+o;$.ajax({url:m,type:"POST",data:d,timeout:i.isMobile&&window.mqq?3e4:2e6,success:function(e,t,s){window.actionExporting=!1;var d=e?e.retcode:"";if("success"===t&&e.s){i.isMobile||(0,r.changeToastText)("\u6b63\u5728\u4e0b\u8f7d\uff0c\u8bf7\u7a0d\u5019...100%");var m="/ep/pad/exportfile/"+o+"?s="+e.s;if(i.isMobile)window.mqq&&window.mqq.invoke("docx","openExportedFile",{success:!0,url:"https://docs.qq.com"+m,fileName:(0,a.getTitle)()+".xlsx",refer_url:window.location.href},function(){}),T_SHEET.Report.tdwReport({opername:"doc_export",module:"mobile_export",action:"suc_export"});else if(i.userAgent.chrome&&i.isWindowPlatform&&!i.isWxWork&&!i.isWeChat)window.open(m,"_blank")||h(m);else h(m);$(window).trigger("afterExport",l),u();try{T_SHEET.Report.tdwReport({opername:"doc_export",module:"export_fail",action:"count",obj2:location.href,obj3:1,ver1:window.__exportStartTime?Math.abs(new Date-window.top.__exportStartTime):"0",ver2:p,ver3:s.getResponseHeader("server")||"",ver4:d,ver5:n,ver6:f})}catch(g){}}else{i.isMobile&&window.mqq&&window.mqq.invoke("docx","openExportedFile",{success:!1},function(){}),c();try{T_SHEET.Report.monitor(3244870),T_SHEET.Report.tdwReport({opername:"doc_export",module:"export_fail",action:"count",obj2:location.href,obj3:2,ver1:window.__exportStartTime?Math.abs(new Date-window.__exportStartTime):"0",ver2:p,ver3:s.getResponseHeader("server")||"",ver4:d,ver5:n,ver6:f})}catch(g){console.error(g)}}},error:function(e,t,o){window.actionExporting=!1,c();try{T_SHEET.Report.monitor(3244870),e&&503===e.status&&T_SHEET.Report.monitor(3244871),T_SHEET.Report.tdwReport({opername:"doc_export",module:"export_fail",action:"count",obj2:location.href,obj3:2,ver1:window.__exportStartTime?Math.abs(new Date-window.__exportStartTime):"0",ver2:p,ver3:e.getResponseHeader("server")||"",ver4:e.status?e.status:"500",ver5:n,ver6:f})}catch(g){console.error(g)}}})}function c(){i.isMobile&&window.mqq&&window.mqq.invoke("docx","openExportedFile",{success:!1},function(){}),(0,r.hideToast)(),$("#export_grid").remove(),i.isMobile||(0,l.Custom_Dialog)("\u5bfc\u51fa\u4e0d\u6210\u529f\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",{type:"question",title:"\u63d0\u793a",overlay_close:!1,buttons:[{caption:"\u6211\u8981\u53cd\u9988",callback:function(){return(0,s.showSupportPage)(),!0}},{caption:"\u786e\u5b9a",callback:function(){return!0}}]}),$(window).trigger("afterExport",!1)}function u(){(0,r.hideToast)(),$("#export_grid").remove()}function p(e){return"object"===("undefined"===typeof e?"undefined":o(e))?JSON.parse(JSON.stringify(e)):e}function h(e){var t="exportIframe";top.$("#"+t).remove(),top.$('<iframe id="exportIframe" src="" style="display:none;"></iframe>').appendTo(top.document.body).attr("src",e)}},"./js/app/header-fold/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js"),a=n("./js/utils/ui/tooltip.js"),r=l(n("./js/app/history/record-change.js")),s=n("./js/event/event-center.js");l(n("./js/config/index.js"));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this._testAccelKey=function(e){return navigator.platform.match(/(ipod touch)|(ipad)|(iphone)|(MacIntel)|(mac)/i)?e.metaKey&&!e.altKey:e.ctrlKey&&!e.altKey},this.handleKeyEvent=function(e){if(e){var n=e.type,o=e.keyCode;i.userAgent.isIE||i.userAgent.safari||i.userAgent.mozilla;return 112===o&&t._testAccelKey(e)?(setTimeout(function(){t.isShow?t.bannerHide():t.bannerShow()},1),e&&e.preventDefault&&e.preventDefault(),window.event&&(window.event.returnValue=!1),!1):void 0}},this.ctrl=i.isMac?"Cmd+":"Ctrl+",this.isShow=!0}return o(e,[{key:"init",value:function(){$("#web_header_bottom").append(this.createFoldBtn()),this.addFoldBtnEvt(),s.event.keyboard.listen("keydown",this.handleKeyEvent)}},{key:"createFoldBtn",value:function(){var e=$('<div id="foldBtn">').css({position:"absolute",width:"22px",height:"22px",right:"19px",top:"19px",zIndex:99,background:"transparent",opacity:0});return $('<div id="foldIcon" data-tooltip="\u6536\u8d77\uff08'+this.ctrl+'F1\uff09" >').css({width:"22px",height:"22px",position:"absolute",right:"0px",top:"-6px"}).appendTo(e),$("#web_header_bottom").css({position:"relative"}),i.isPad||$("#padpage").css({transition:"transform 0.2s",top:0}),$("html").css({"background-color":"#f5f6f7"}),setTimeout(function(){(0,a.tooltip)("#foldIcon"),$("#foldBtn").css({opacity:1})},2e3),e}},{key:"bannerHide",value:function(){if(console.log("hide"),!r.default.isShow){this.isShow=!1;var e=$("#canvasContainer").height(),t=$("#web_header_top").outerHeight(),n=$("#web_header_bottom").outerHeight(),o=$("#inputboxwithpc").height();$("#inputboxwithpc").offset().top;$("header,#padpage").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:"-"+t+"px"}),$(".login-container").clone(!0,!0).appendTo("#foldBtn").css({opacity:0}),$("#foldIcon").removeClass("icon-unfold").addClass("icon-fold"),$("#foldIcon").addClass("hidefold"),$("#foldBtn .login-container").css({top:"11px",right:"34px","margin-top":"-21px"});var i=setTimeout(function(){$("#foldBtn .login-container").css({opacity:1}),clearTimeout(i)},0);$("#moreToolsView").css({display:"none"}),$("#logo-guide-wrapper").css({display:"none"}),$("#foldIcon").attr("data-tooltip","\u5c55\u5f00\uff08"+this.ctrl+"F1\uff09"),$("#canvasContainer").length&&$("#canvasContainer").height(e+t);var s=$("#web_header_top").outerHeight()+$("#web_header_bottom").outerHeight(),l=-t+parseInt($("#web_header_bottom").css("top"));$("#notification-container").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:s+l+1+"px",height:"calc(100% - "+(s+l+45+1)+"px)"}),$("#read-record-container").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:s+l+1+"px",height:"calc(100% - "+(s+l+45+1)+"px)"}),window.SpreadsheetApp&&(SpreadsheetApp.view.canvas.excel.resize(),SpreadsheetApp.view.canvas.excel.setDistanceY(n+o)),(0,a.tooltip)("#foldIcon")}}},{key:"bannerShow",value:function(){if(console.log("show"),r.default.isShow)console.log("in recordechange is show");else{this.isShow=!0;var e=$("#canvasContainer").height(),t=$("#web_header_top").outerHeight(),n=$("#web_header_bottom").outerHeight(),o=$("#inputboxwithpc").height();$("#inputboxwithpc").offset().top;$("header,#padpage").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:"0px"}),$("#foldBtn .login-container").remove(),$("#foldIcon").removeClass("hidefold"),$("#foldIcon").removeClass("icon-fold").addClass("icon-unfold"),$("#moreToolsView").css({display:"none"}),$("#foldIcon").attr("data-tooltip","\u6536\u8d77\uff08"+this.ctrl+"F1\uff09"),$("#canvasContainer").length&&$("#canvasContainer").height(e-t);var i=$("#web_header_top").outerHeight()+$("#web_header_bottom").outerHeight(),s=parseInt($("#web_header_bottom").css("top"));$("#notification-container").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:i+s+"px",height:"calc(100% - "+(i+s+45+1)+"px)"}),$("#read-record-container").css({transition:"all 0.2s ease-in","-webkit-transition":"all 0.2s ease-in","-moz-transition":"all 0.2s ease-in",top:i+s+"px",height:"calc(100% - "+(i+s+45+1)+"px)"}),window.SpreadsheetApp&&(SpreadsheetApp.view.canvas.excel.resize(),SpreadsheetApp.view.canvas.excel.setDistanceY(t+n+o)),(0,a.tooltip)("#foldIcon")}}},{key:"addFoldBtnEvt",value:function(){var e=this;$("#foldIcon").click(function(){e.isShow?(e.bannerHide(),s.event.default.trigger("header-fold-toggle",!1,49),T_SHEET.Report.tdwReport({opername:"doc_excel_editor",module:"excel_view",action:"view_fold"})):(e.bannerShow(),s.event.default.trigger("header-fold-toggle",!0,103),T_SHEET.Report.tdwReport({opername:"doc_excel_editor",module:"excel_view",action:"view_unfold"}))})}}]),e}();t.default=new d},"./js/app/header/common/save-status.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/utils/date.js"),r=n("./js/utils/user-agent.js"),s=n("./js/utils/ui/tooltip.js"),l=n("./js/event/event-center.js"),d=n("./js/config/index.js"),c=(o=d)&&o.__esModule?o:{default:o},u=n("./js/config/sheet.js"),p=n("./js/utils/util.js");var h=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init=function(){t.bindEvent()},this.bindEvent=function(){l.event.default.listen("UserLineInitFinished",function(){r.isMobile||r.isPad||t.showSaveTips("text",0,"\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u5185\u5bb9","\u81ea\u52a8\u4fdd\u5b58\u6240\u6709\u5185\u5bb9")});var e=l.event.network;e.listen("online",function(){t.showSavedText()}),e.listen("offline",function(){t.showSaveTips("offline",null,"\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91","\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91"),(0,p.debounce)(function(){t.showSaveTips("offline",3e3,"\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f","\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f")},1e3)()}),e.listen("commitSuccess",function(){t.showSaveTips("saving",3e3,null,"\u5df2\u81ea\u52a8\u4fdd\u5b58")}),SpreadsheetApp.event.spreadsheetEvent.listen(T_SHEET.Base.EVENT_NAME.TITLE_CHANGE_LOCAL,function(){t.showSaveTips("saving",3e3,null,"\u5df2\u81ea\u52a8\u4fdd\u5b58")})},this.initDom=function(){t.hasInitDom||((r.isMobile||r.isPad)&&$('<span id="editor-last-state"></span>').appendTo(document.body),t.saveStatusContainer=$("#editor-last-state"),t.saveStatusContainer.text(""),t.hasInitDom=!0,t.saveStatusContainer.append($('<span id="editor-last-state-icon-container"></span><span id="editor-last-state-text-container"></span>')),t.saveStatusIconContainer=$("#editor-last-state-icon-container"),t.saveStatusTextContainer=$("#editor-last-state-text-container"),r.isMobile||r.isPad?($("body.embed #editor-last-state").addClass("editor-last-state"),(0,r.checkIsIphoneX)()&&$("body.embed #editor-last-state").css("margin-bottom","34px")):$("body.embed #editor-last-state").addClass("editor-last-state-web"))},this.checkHasUserLine=function(){return r.isPad||"none"!==$(".tim-userline-wrapper").css("display")},this.getLoadingInstance=function(e){t._loadingInstance?e&&e(t._loadingInstance):n.e("bundle_lottie.min").then(n.t.bind(null,"./js/app/lib/lottie.min.js",7)).then(function(n){var o=n.default;t._loadingInstance=o.loadAnimation({container:document.getElementById("editor-last-state-icon-container"),autoplay:!1,renderer:"svg",loop:!1,animationData:t.loadingAnimateJson}),e&&e(t._loadingInstance)})},this.showSaveTips=function(e,n,o,i){if(c.default.isLogin&&!t.isLoading){if(t.isLoading=!0,t.initDom(),r.isMobile||r.isPad)return(o=o||"\u5df2\u81ea\u52a8\u4fdd\u5b58").length>8?void(t.isLoading=!1):window.SpreadsheetApp.view.canvas.excel.inputCenter.showing?void(t.isLoading=!1):(t.hasMovedPlaceInMobile||(t.saveStatusContainer.css("z-index","9999"),t.saveStatusContainer.css("background","rgba(0,0,0,0.6)"),t.hasMovedPlaceInMobile=!0),t.saveStatusContainer.removeClass("fade-out fade-in"),t.saveStatusContainer.addClass("fade-in"),t.saveStatusTimeID&&clearTimeout(t.saveStatusTimeID),t.saveStatusContainer.text(o),n&&(t.saveStatusTimeID=setTimeout(function(){t.saveStatusContainer.one("animationend",function(){t.saveStatusContainer.removeClass("fade-in fade-out")}),t.saveStatusContainer.addClass("fade-out"),t.saveStatusTimeID=null},n)),void(t.isLoading=!1));switch(t.saveStatusContainer.show(),clearTimeout(t.lastTimer),clearTimeout(t.updateTimer),e){case"text":t.saveStatusIconContainer.removeClass("save-offline-icon"),t.playLoadingAnimate(!0,function(){t.setSaveText(i),t.isLoading=!1,t.firstTimeShowTips&&(t.firstTimeShowTips=!1,l.event.default.trigger("pc-header-refresh"))});break;case"saving":n&&(t.saveStatusIconContainer.removeClass("save-offline-icon"),t.setSaveText("\u5df2\u81ea\u52a8\u4fdd\u5b58"),t.lastSaveTime=(0,a.dateFormat)(new Date),t.playLoadingAnimate(!1,function(){t.lastTimer=setTimeout(function(){t.showSavedText()},n),o||(o=t.getSavedDateHoverTips(t.lastSaveTime));var e=window.SpreadsheetApp&&SpreadsheetApp.plugins&&SpreadsheetApp.plugins.rmap;e&&e.isOpenDialog()&&e.updateSelectedData(),t.isLoading=!1}));break;case"saved":t.saveStatusIconContainer.removeClass("save-offline-icon"),t.playLoadingAnimate(!0,function(){t.setSaveText(i),t.updateTimer=setTimeout(function(){t.showSavedText()},t.updateTimeDuration),t.isLoading=!1});break;case"offline":t.getLoadingInstance(function(e){e.hide(),t.saveStatusIconContainer.addClass("save-offline-icon"),t.setSaveText(i),t.isLoading=!1})}o?(t.saveStatusIconContainer.data("tooltip",o),(0,s.tooltip)("#editor-last-state-icon-container",{tooltipClass:"editor-state-tip"})):(t.saveStatusIconContainer.removeData("tooltip"),(0,s.removeTooltip)("#editor-last-state-icon-container")),l.event.default.trigger("pc-header-refresh")}},this.playLoadingAnimate=function(e,n){t.getLoadingInstance(function(t){t.show(),e?t.goToAndStop(t.totalFrames,!0):(t.goToAndStop(1,!0),t.play()),n&&n()})},this.setSaveText=function(e){!t.checkHasUserLine()&&e&&(t.saveStatusTextContainer.text(e),t.saveStatusTextWidth=t.saveStatusTextContainer.width())},this.showSavedText=function(){t.lastSaveTime&&(0,u.isFullyConnected)()&&t.showSaveTips("saved",0,t.getSavedDateHoverTips(t.lastSaveTime),t.getSavedDateText(t.lastSaveTime))},this.getSavedDateHoverTips=function(e){if("string"==typeof e){var t=e.replace(/\s+/,"").split(/[^0-9]/);e=t.length>=5?e?new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5]||0):new Date:e?new Date(e):new Date}return"\u6700\u8fd1\u4fdd\u5b58\uff1a"+(0,a.dateFormat)(e)},this.getSavedDateText=function(e){return"string"==typeof e?"\u6700\u8fd1\u4fdd\u5b58 "+(0,a.prettyDate)(e):"\u6700\u8fd1\u4fdd\u5b58 \u521a\u521a"},this.userJoinForSaveTips=function(){t.saveStatusTextContainer&&t.saveStatusTextContainer.text("")},this.fixWidth=function(e){return e>0?t.saveStatusTextContainer&&e>t.saveStatusTextWidth?(t.saveStatusTextContainer.show(),t.saveStatusTextWidth):0:t.saveStatusTextContainer?"none"==t.saveStatusTextContainer.css("display")?0:(t.saveStatusTextContainer.hide(),-t.saveStatusTextWidth):0},this.loadingAnimateJson={v:"4.11.1",fr:24,ip:0,op:32,w:16,h:16,nm:"1120 save",ddd:0,assets:[],layers:[{ddd:0,ind:1,ty:4,nm:"save - 2",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[8.239,7.954,0],ix:2},a:{a:0,k:[6.077,4.744,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,0],[0,0],[0,0]],o:[[0,0],[0,0],[0,0]],v:[[3.577,-2.244],[-.911,2.244],[-3.577,-.423]],c:!1},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.246999987434,.246999987434,.246999987434,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:1,ix:5},lc:1,lj:1,ml:10,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[6.077,4.744],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Group 1",np:2,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.712],y:[1]},o:{x:[1],y:[0]},n:["0p712_1_1_0"],t:12,s:[100],e:[0]},{t:21}],ix:1},e:{a:0,k:100,ix:2},o:{a:0,k:0,ix:3},m:1,ix:2,nm:"Trim Paths 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:48,st:0,bm:0},{ddd:0,ind:2,ty:4,nm:"save - 1",sr:1,ks:{o:{a:0,k:100,ix:11},r:{a:0,k:0,ix:10},p:{a:0,k:[8.016,8.016,0],ix:2},a:{a:0,k:[9,9,0],ix:1},s:{a:0,k:[100,100,100],ix:6}},ao:0,shapes:[{ty:"gr",it:[{ind:0,ty:"sh",ix:1,ks:{a:0,k:{i:[[0,-3.59],[3.59,0],[0,3.59],[-3.59,0]],o:[[0,3.59],[-3.59,0],[0,-3.59],[3.59,0]],v:[[6.5,0],[0,6.5],[-6.5,0],[0,-6.5]],c:!0},ix:2},nm:"Path 1",mn:"ADBE Vector Shape - Group",hd:!1},{ty:"st",c:{a:0,k:[.246999987434,.246999987434,.246999987434,1],ix:3},o:{a:0,k:100,ix:4},w:{a:0,k:1,ix:5},lc:1,lj:1,ml:10,nm:"Stroke 1",mn:"ADBE Vector Graphic - Stroke",hd:!1},{ty:"tr",p:{a:0,k:[9,9],ix:2},a:{a:0,k:[0,0],ix:1},s:{a:0,k:[100,100],ix:3},r:{a:0,k:0,ix:6},o:{a:0,k:100,ix:7},sk:{a:0,k:0,ix:4},sa:{a:0,k:0,ix:5},nm:"Transform"}],nm:"Group 1",np:2,cix:2,ix:1,mn:"ADBE Vector Group",hd:!1},{ty:"tm",s:{a:1,k:[{i:{x:[.245],y:[1]},o:{x:[.333],y:[0]},n:["0p245_1_0p333_0"],t:4,s:[100],e:[0]},{t:11}],ix:1},e:{a:0,k:100,ix:2},o:{a:0,k:-90,ix:3},m:1,ix:2,nm:"Trim Paths 1",mn:"ADBE Vector Filter - Trim",hd:!1}],ip:0,op:48,st:0,bm:0}]},this.lastSaveTime=null,this.lastTimer=null,this.updateTimer=null,this.updateTimeDuration=6e4,this.hasMovedPlaceInMobile=!1,this.saveStatusIconContainer=null,this.saveStatusTextContainer=null,this._loadingInstance=null,this.hasInitDom=!1,this.saveStatusTextWidth=0,this.saveStatusTimeID=null,this.isLoading=!1,this.firstTimeShowTips=!0}return i(e,[{key:"updateLastSaveTime",value:function(e){this.lastSaveTime=e,this.showSavedText()}},{key:"getLastSaveTime",value:function(){return this.lastSaveTime}}]),e}();t.default=new h},"./js/app/header/common/title.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js"),a=n("./js/utils/ui/tooltip.js"),r=g(n("./js/network/login.js")),s=n("./js/component/toast/index.js"),l=g(n("./js/config/index.js")),d=n("./js/config/sheet.js"),c=g(n("./js/utils/ui/measure.js")),u=n("../node_modules/@tencent/tencent_doc_open_url/index.js"),p=n("./js/app/spread-sheet/index.js"),h=n("./js/event/event-center.js"),f=n("./js/app/spread-sheet/index.js"),m=n("./js/app/template/index.js");function g(e){return e&&e.__esModule?e:{default:e}}var w=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.indexClick=0,this.isTouchmove=!1,this.isFocus=!1,this.isDefaultTitle=!1,this.title=null,this.titleStr="",this.originTitle="",this.titleWidth=0,this.titleShowWidth=0,this.isRenameTipsShow=!1,this.titleMaxWidth=370,this.lastToastSpecialChars=0,this.lastToastOverflow=0,i.isMobile||h.event.default.listen("spreadInitFinished",function(){this.permission=(0,f.getPermission)(),this.permission&&this.listenPermissionsStatusChange()}.bind(this))}return o(e,[{key:"listenPermissionsStatusChange",value:function(){this.permission.listenEditChange(this.setEditable.bind(this))}},{key:"isLegalTitle",value:function(e){return!(0===e.length||e.length>64)&&!/(:|\uff1a|\*|\\|\/|<|>|"|\?|\|)/gi.test(e)}},{key:"onTitleFocus",value:function(e){var t=this;r.default.checkIfAccountSwitched("titleFocus")&&window.SLR?window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"titleFocus"}):(e.style.display="block",this.defTitleState(this.title.val()),this.title.data("tooltip",""),$("#tooltip").remove(),this.title.attr("readonly")||(this.title.css("color","#333333"),this.isRenameTipsShow&&(this.isRenameTipsShow=!1,this.isFocus||setTimeout(function(){i.isIOS?t.title[0].setSelectionRange(0,t.title[0].value.length):t.title.select()},50)),this.isFocus=!0,this.cleanUntitled()))}},{key:"onTitleBlur",value:function(e){if(!this.title.attr("readonly")){this.isFocus=!1,this.indexClick=0,this.title.toggleClass("force-redraw"),this.checkTitle();var t=this.title.val();if(e.style.display="none",clientVars.padTitle==this.getRealTitle(t))return this.setTitle(this.titleStr),this.defTitleState(this.titleStr),this.runColseTitle(),!0;this.setTitle(this.title.val()),this.defTitleState(this.title.val()),this.runColseTitle(),(0,p.setTitle)(t)}}},{key:"checkTitle",value:function(){var e=this.title.val();/[\\\/:*?"<>|]/g.test(e)&&(Date.now()-this.lastToastSpecialChars>5e3&&(this.lastToastSpecialChars=Date.now(),(0,s.showToast)('\u6587\u6863\u540d\u4e0d\u80fd\u5305\u542b\u4e0b\u5217\u4efb\u4f55\u5b57\u7b26\uff1a<br/>\\ / : * ? " < > |',void 0,{toolToastCloseTime:5e3,supportMobile:!0})),this.title.val(this.title.val().replace(/[\\\/:*?"<>|]/g,""))),this.title.val().length>128&&(Date.now()-this.lastToastOverflow>5e3&&(this.lastToastOverflow=Date.now(),(0,s.showToast)("\u6587\u6863\u540d\u4e0d\u80fd\u8d85\u8fc7128\u4e2a\u5b57\u3002",void 0,{toolToastCloseTime:5e3,supportMobile:!0})),this.title.val(this.title.val().slice(0,128)))}},{key:"registerListeners",value:function(){var e=this;if(!i.isMobile&&!i.isPad){var t=document.createElement("div");t.className="set-title-layer",document.body.appendChild(t),this.title.focus(function(){e.onTitleFocus(t)}),this.title.blur(function(){e.onTitleBlur(t)}),this.title.keydown(function(t){27==t.keyCode&&(e.setTitle((0,d.getTitle)()),e.titleBlur())}),this.title.on("input",this.checkTitle.bind(this)),this.title.on("paste",function(t){setTimeout(e.checkTitle.bind(e),0)});var n=0,o=0;this.title.on("touchstart",function(t){n=e.title[0].scrollLeft,o=window.event&&window.event.changedTouches&&window.event.changedTouches[0].pageX,e.isTouchmove=!1}),this.title.on("touchmove",function(t){if(e.title.is(":focus")){if(e.isTouchmove=!0,n==e.title[0].scrollLeft){var i=o-window.event&&window.event.changedTouches&&window.event.changedTouches[0].pageX||0;e.title[0].scrollLeft+i<0?e.title[0].scrollLeft=0:e.title[0].scrollLeft+i>e.title[0].scrollWidth?e.title[0].scrollLeft=e.title[0].scrollWidth:e.title[0].scrollLeft=e.title[0].scrollLeft+i,n=e.title[0].scrollLeft,o=window.event.changedTouches[0].pageX,e.title.toggleClass("force-redraw")}t.preventDefault()}else t.preventDefault()}),this.title.on("touchend",function(){1!=e.indexClick||e.isTouchmove||e.title.click()}),$(window).keypress(function(t){e.title[0]==t.target&&(13===(t.which||t.keyCode)&&e.title.blur())}),$(window).bind("padTitleBlur",function(){e.isFocus&&e.title.blur()}),$(window).bind("saveOfflineTitle",function(){var t=e.getTitleFromStore();"string"===typeof t&&t.length>0&&(e.title.val(t),e.title.blur())}),h.event.default.listen("title-update-pc",function(t){e.setTitle(t.title),!t.isServer&&(0,m.editForTemplate)()})}}},{key:"setEditable",value:function(e){e?(this.title.removeAttr("readonly"),this.title.removeClass("tim-web-unlogin")):(this.title.attr({readonly:!0}),this.title.addClass("tim-web-unlogin"))}},{key:"initDom",value:function(){this.title=$("#padAloneTitle"),this.title.css({visibility:"visible"})}},{key:"init",value:function(){i.isMobile||i.isPad||(this.title.removeAttr("disabled"),this.defTitleState(clientVars.padTitle),this.setTitle(clientVars.padTitle),this.title.attr("maxlength","129"),this.setEditable(l.default.gEditable),this.isDefaultTitle?this.title.css("color","#aeaeae"):this.title.css("color","#000"))}},{key:"firstFrameRenderFinish",value:function(){!l.default.preview&&l.default.gEditable&&(this.setToolTip("\u91cd\u547d\u540d"),this.isRenameTipsShow=!0),(0,a.tooltip)("#padAloneTitle"),i.isMobile||i.isPad||(this.initHeaderBackIcon(),this.registerTitleWidthChangeListaner()),this.registerListeners(),window.firstFrameFinish=!0}},{key:"removePlaceholder",value:function(){try{var e=document.querySelector(".menu-bg-pc-left");e&&e.remove()}catch(t){}}},{key:"initHeaderBackIcon",value:function(){var e=this;i.isPcApp&&$(".brand_logo_new").css("cursor","default"),$(".brand_logo_new").show(),setTimeout(function(){e.removePlaceholder()},500),$(".brand-container").on("click",function(e){l.default.preview&&T_SHEET.Report.tdwReport({opername:"doc_pcview"+(localStorage&&localStorage.previewOpenFrom||"fromunknown"),module:"oper",action:"pre_right_back"});var t="//docs.qq.com/desktop/?_from=1";(e.ctrlKey||e.metaKey)&&!e.altKey?(0,u.tencentDocOpenUrl)(t):window.location.href=t,window.event?window.event.returnValue=!1:e.preventDefault()})}},{key:"hideBackIconForTDIPadApp",value:function(){$(".brand_back").remove()}},{key:"defTitleState",value:function(e){this.isDefaultTitle="\u65e0\u6807\u9898\u8868\u683c"==e}},{key:"setTitle",value:function(e){this.originTitle=e,e=this.getRealTitle(e),this.titleStr=e,i.isMobile||i.isPad||(this.titleWidth=this.getTitleWidth(e),this.title.width(this.titleWidth)),this.title.val(e)}},{key:"getTitleWidth",value:function(e){return Math.ceil(c.default.getTextWidth("font-size:18px;font-family:'Microsoft YaHei',Verdana,sans-serif",e))+12}},{key:"runColseTitle",value:function(){this.isDefaultTitle?this.title.css("color","#aeaeae"):this.title.css("color","#333333")}},{key:"getRealTitle",value:function(e){return e||(e="\u65e0\u6807\u9898\u8868\u683c"),e}},{key:"cleanUntitled",value:function(){this.originTitle||this.title.val("")}},{key:"setToolTip",value:function(e){$("#padAloneTitle").data("tooltip",e)}},{key:"titleBlur",value:function(){this.title.blur()}},{key:"registerTitleWidthChangeListaner",value:function(){var e=this;this.title.on("input propertychange change",function(){e.titleWidth=e.getTitleWidth(e.title.val()),e.title.width(e.titleWidth)})}},{key:"fixWidth",value:function(e){if(e>0){var t=this.titleShowWidth||Math.min(this.titleWidth,this.titleMaxWidth);if(this.titleWidth>t){var n=Math.min(t+e,this.titleMaxWidth);return this.title.css("max-width",n+"px"),this.titleShowWidth=Math.min(n,this.titleWidth),this.titleShowWidth-t}return this.title.css("max-width",Math.min(this.titleWidth+e,this.titleMaxWidth)+"px"),0}if(70>(t=this.titleShowWidth||Math.min(this.titleWidth,this.titleMaxWidth)))return 0;var o=t-70;return-e>o?(this.title.css("max-width","70px"),this.titleShowWidth=70,-o):(this.titleShowWidth=t+e,this.title.css("max-width",this.titleShowWidth+"px"),e)}},{key:"getTitleFromStore",value:function(){if("undefined"!==typeof window.Storage)return localStorage.getItem("offline_title_"+(0,d.getPadId)())}}]),e}();t.default=new w},"./js/app/header/common/userline-new.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n("react")),r=n("react-dom"),s=(o=r)&&o.__esModule?o:{default:o};n("./css/img/images/nophoto2.png");var l=n("./js/event/event-center.js"),d=n("../node_modules/@tencent/docs-scenario-components/dist/index.js");var c=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.init=function(){var e=document.getElementById("otherusersComponent");e&&(n.container=e,n.render())},n.fixWidth=function(e){return n.collabListInterfaces&&n.collabListInterfaces.fixWidth(e)},n.getCollabListInterfaces=function(e){n.collabListInterfaces=e,n.containerShow(),n.bindEvent()},n.render=function(){var e=n.container;e&&s.default.render(a.createElement(d.PcCollaboratorList,{getClientVars:function(){return window.clientVars},getInterfaces:n.getCollabListInterfaces,eventNotice:n.eventNotice}),e)},n.props=e,n.collabList=null,n.container,n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,a.Component),i(t,[{key:"containerShow",value:function(){this.container&&(this.container.style.display="inline-block",this.container.style.marginLeft="9px")}},{key:"bindEvent",value:function(){var e=this;window.addEventListener("SheetMouseDown",function(t){e.collabListInterfaces&&e.collabListInterfaces.hideMore()}),window.addEventListener("SheetScroll",function(t){e.collabListInterfaces&&e.collabListInterfaces.hideMore()}),window.addEventListener("setKeyboardHeight",function(t){e.collabListInterfaces&&e.collabListInterfaces.hideMore()}),window.addEventListener("resize",function(t){e.collabListInterfaces&&e.collabListInterfaces.hideMore()})}},{key:"eventNotice",value:function(){l.event.default.trigger("UserLineInitFinished")}}]),t}();window.userLine=new c,t.default=window.userLine},"./js/app/header/mobile/cooperation.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/config/index.js"),a=n("./js/utils/browser.js"),r=n("./js/utils/user-agent.js"),s=n("./js/script-loader/index.js"),l=h(n("./js/app/header/share.js")),d=h(n("./js/app/auth/advanced.js")),c=h(n("./js/app/header/mobile/mobile-share-model.js")),u=n("./js/component/toast/index.js"),p=n("./js/config/sheet.js");function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"initConfig",value:function(){c.default.initShareObject(),this.shortLink=null,this.globalPadId=window.clientVars.globalPadId,this.idx=this.globalPadId.indexOf("$"),this.domainId=this.globalPadId.slice(0,this.idx),this.moreOpActionSheet=null,this.stopClickCooperation=!1,this.permissionType=clientVars.policy,this._setShortLink()}},{key:"disableClickCooperation",value:function(){this.stopClickCooperation=!0}},{key:"init",value:function(){var e=this;if((0,i.getConfig)().isOwner){1==(0,a.getQuery)("openCooper")&&this.loadCooperationMobile(!1,!1),$(window).on("permissionChanged",function(){e.authUpdated()}),SLR.listen("TX-AUTH-UPDATED",function(){e.authUpdated()});var t=$("<div id='share-tip'></div>").addClass("share-tip");$("body").append(t),r.isMobile&&(r.isQQ||r.isTim||r.isTencentDocApp)&&window.mqq&&mqq.addEventListener("didFinishShare",function(t){console.log("did finish sharepolicy:"+t.policy+"result:"+t.result),$("header")[0].style.transform="translateY(0px)",e.updateShareTips(t.policy,t.prePolicy,t.shareSource)})}$("body").append("<div id='cooperationcontainer' style='position: absolute;               top: 0;               left: 0;               z-index: 10003;'></div>"),window.openCooperationMobile=function(){try{e.moreOpActionSheet&&e.moreOpActionSheet.remove()}catch(t){console.error(t)}e.loadCooperationMobile(!0,!1)},c.default.setShareObjectToClient(),window.openAdvPermissionsMobile=function(){try{e.moreOpActionSheet&&e.moreOpActionSheet.remove()}catch(t){console.error(t)}e.loadCooperationMobile(!0,!0)}}},{key:"authUpdated",value:function(){var e=this;(0,s.loadModule)("CooperationMobileV2",function(t){t.getPermissionInfo({creatorDomain:window.clientVars.creatorDomain,padId:window.clientVars.padId,success:function(t){t=t.res,e.permissionType=t.policy,c.default.getInstance().policy=e.permissionType,c.default.setAuthInfoToShareObject(t),c.default.setAuthInfoToClient(1)},error:function(e){console.log(e)}})})}},{key:"openAdvPermissionsInMiniProgram",value:function(){r.isMiniProgram?window.wx&&window.wx.miniProgram&&window.wx.miniProgram.navigateTo?window.wx.miniProgram.navigateTo({url:"/pages/changedAdvAuth/changed_adv_auth?padId="+clientVars.padId+"&domainId="+this.domainId+"&creatorDomain="+clientVars.creatorDomain+"&shareLink="+encodeURIComponent(this.shortLink)+"&title="+encodeURIComponent(clientVars.padTitle)+"&padType="+clientVars.padType+"&ownername="+encodeURIComponent(clientVars.userName)+"&uid="+clientVars.uin+"&avatar="+encodeURIComponent(clientVars.userPic)}):(0,u.showToast)("\u52a0\u8f7d\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u8868\u683c",{},{standardToastType:"default"},null):console.error("call openAdvPermissionsInMiniProgram no miniprogram")}},{key:"loadCooperationMobile",value:function(e,t){r.isMiniProgram?window.wx&&window.wx.miniProgram&&window.wx.miniProgram.navigateTo?window.wx.miniProgram.navigateTo({url:"/pages/changedAuth/changed_auth?padId="+clientVars.padId+"&domainId="+this.domainId+"&padType="+clientVars.padType+"&creatorDomain="+clientVars.creatorDomain+"&shareLink="+encodeURIComponent(this.shortLink)+"&title="+encodeURIComponent(clientVars.padTitle)+"&nick="+encodeURIComponent(clientVars.userName)+"&uid="+clientVars.uin+"&avatar="+encodeURIComponent(clientVars.userPic)}):(0,u.showToast)("\u52a0\u8f7d\u51fa\u9519\uff0c\u8bf7\u91cd\u65b0\u6253\u5f00\u8868\u683c",{},{standardToastType:"default"},null):this.showCooperationMobile(e,t)}},{key:"showCooperationMobile",value:function(e,t){var n=this;(0,s.loadModule)("CooperationMobileV2",function(o){var i=document.getElementById("cooperationcontainer");o.show(i,{padId:clientVars.padId,domainId:n.domainId,creatorDomain:clientVars.creatorDomain,shareLink:n.shortLink,shareTitle:(0,p.getTitle)(),shareDocType:clientVars.padType,title:clientVars.padTitle,padType:clientVars.padType,owner:{avatar:clientVars.userPic,name:clientVars.userName,uid:clientVars.uin},isCalledByMobileNativeSharePanel:e,onClose:function(e){void 0!=e&&e&&(l.default.setShareInfo(),window.mqq&&mqq.ui.showShareMenu())},showAdvPermissionsCmp:t,onAuthExpTimeUpdated:function(e){d.default.onUpdateAuthExpInfo(e),r.isQQ?(0,r.MQQLargerOrEqual)("7.7.0")&&c.default.setAuthInfoToClient(1):c.default.setAuthInfoToClient(1)},onAuthUpdated:function(e){void 0!=e.sendData&&(l.default.setShareInfo(),c.default.getInstance().policy=e.sendData.policy,c.default.getInstance().isCreator=clientVars.isCreator,c.default.setAuthInfoToShareObject(e.sendData),c.default.setAuthInfoToClient(1))}})})}},{key:"setPermissionType",value:function(e){var t=this;(0,s.loadModule)("CooperationMobileV2",function(e){e.setPermissionType({creatorDomain:window.clientVars.creatorDomain,padId:window.clientVars.padId,permissionType:t.permissionType,success:function(e){t.updateCooperationIcon(t.permissionType)}})})}},{key:"isSelfPermission",value:function(){return 0===this.permissionType}},{key:"_setShortLink",value:function(){var e=clientVars.shortLink||window.location.href.split("#")[0];if(-1==e.indexOf("?"))this.shortLink=e;else{var t=e.split("?")[1],n=e.split("?")[0];this.shortLink=t?n:e}}},{key:"updateShareTips",value:function(e,t,n){if(!window.isCooperationMobileOpen){var o="\u5df2\u5206\u4eab\uff0c\u597d\u53cb\u5df2\u52a0\u5165\u534f\u4f5c\u5217\u8868\u3002";0===t&&(1===e&&(o="\u5df2\u5206\u4eab\uff0c\u79c1\u5bc6\u6587\u6863\u5df2\u53d8\u4e3a\u6307\u5b9a\u6210\u5458\u4e00\u8d77\u534f\u4f5c\u3002"),2===e&&(o="\u79c1\u5bc6\u6587\u6863\u53d8\u4e3a\u4efb\u4f55\u4eba\u53ef\u67e5\u770b\u3002"),3===e&&(o="\u79c1\u5bc6\u6587\u6863\u53d8\u4e3a\u4efb\u4f55\u4eba\u53ef\u7f16\u8f91\u3002")),1===e&&1===t&&(o="\u5df2\u5206\u4eab\uff0c\u597d\u53cb\u5df2\u52a0\u5165\u534f\u4f5c\u5217\u8868\u3002"),n&&1===n&&0!==t&&0!==e&&(o="\u5df2\u9080\u8bf7\u5fae\u4fe1\u597d\u53cb\uff0c\u7b49\u5f85\u5bf9\u65b9\u67e5\u770b\u3002"),$("#share-tip").html(o),$("#share-tip").css("display","inline-block"),setTimeout(function(){$("#share-tip").css("display","none")},5e3)}}}]),e}();t.default=new f},"./js/app/header/mobile/mobile-share-model.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=l(n("./js/app/auth/advanced.js")),a=n("./js/utils/browser.js"),r=n("./js/utils/user-agent.js"),s=l(n("./js/app/header/share.js"));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"initShareObject",value:function(){this.shareObject={},this.shareObject.authFirstLineInfo="",this.shareObject.authSecondLineInfo="",this.shareObject.policy=clientVars.policy,this.shareObject.isCreator=clientVars.isCreator,this.shareObject.docName=clientVars.padTitle,this.shareObject.docType="sheet"===clientVars.padType?2:"form"===clientVars.padType?3:1,this.shareObject.docIconUrl="",this.shareObject.taskType=1,this.shareObject.share_url=s.default.getShareUrl()||window.location.href.split("#")[0],this.shareObject.memLength=0,this.shareObject.memListPrefix="",this.shareObject.descriptionSuffix="",this.shareObject.padId=clientVars.padId,this.shareObject.padTitle=clientVars.padTitle,this.shareObject.creatorDomain=clientVars.creatorDomain,this.shareObject.domainId=clientVars.domainId,this.shareObject.xsrf=(0,a.getXsrf)()}},{key:"checkIfExpired",value:function(){return!1}},{key:"setShareObjectToClient",value:function(){var e=this,t=1;switch(!this.checkIfExpired&&clientVars.isCreator&&(t=1),t){case 1:var n=(0,a.getUidParam)("//docs.qq.com/cgi-bin/redirect/"+window.clientVars.creatorDomain+"/ep/api/getpadinfo?localPadId="+clientVars.padId+"&type=1&ver=2&xsrf="+(0,a.getXsrf)());$.ajax({type:"get",url:n,xhrFields:{withCredentials:!0},success:function(n){0===n.retcode&&(i.default.setAuthInfo(n),e.setAuthInfoToShareObject(n),e.setAuthInfoToClient(t))},error:function(){}})}}},{key:"setAuthInfoToShareObject",value:function(e){if(e){switch(i.default.setAuthInfo(e),e.policy){case 0:this.shareObject.authFirstLineInfo="\u4ec5\u81ea\u5df1\u53ef\u67e5\u770b/\u7f16\u8f91\u6587\u6863",this.shareObject.policyIconUrl="";break;case 1:this.shareObject.authFirstLineInfo="\u4ec5\u6307\u5b9a\u7684\u4eba\u53ef\u67e5\u770b/\u7f16\u8f91\u6587\u6863";break;case 2:this.shareObject.authFirstLineInfo="\u83b7\u5f97\u94fe\u63a5\u7684\u4efb\u4f55\u4eba\u53ef\u67e5\u770b\u6587\u6863";break;case 3:this.shareObject.authFirstLineInfo="\u83b7\u5f97\u94fe\u63a5\u7684\u4efb\u4f55\u4eba\u53ef\u7f16\u8f91\u6587\u6863\u8f91"}e.memlist=e.memlist||[];var t=e.memlist.filter(function(e){return 2===e.info});if(0!=e.policy&&3!=e.policy)if(t.length>0){var n="";this.shareObject.memLength=t.length;for(var o=0;o<Math.min(t.length,10);o++)""!==n||0!==o?n+="\u3001"+t[o].nick:n=t[o].nick;this.shareObject.memListPrefix=n,this.shareObject.descriptionSuffix="\u5176\u4e2d"+this.shareObject.memLength+"\u4f4d\u6210\u5458\u53ef\u7f16\u8f91: "}else this.shareObject.memLength=0,this.shareObject.memListPrefix="",this.shareObject.descriptionSuffix="";else this.shareObject.memLength=0,this.shareObject.memListPrefix="",this.shareObject.descriptionSuffix=""}}},{key:"setAuthInfoToClient",value:function(e){if(Number.isInteger(e)){var t=!0;r.isQQ&&((0,r.MQQLargerOrEqual)("7.7.0")||(t=!1));var n=e;if(!0===t){var o=i.default.isAuthExpExpire();clientVars.isCreator&&o?(n=2,this.shareObject.authFirstLineInfo="\u6587\u6863\u8bbf\u95ee\u94fe\u63a5\u5df2\u5931\u6548",this.shareObject.authSecondLineInfo="\u4ed6\u4eba\u5c06\u65e0\u6cd5\u8bbf\u95ee\u8be5\u6587\u6863\u3002",this.shareObject.memLength=0,this.shareObject.memListPrefix="",this.shareObject.descriptionSuffix=""):this.setAuthInfoToShareObject(i.default.getAuthInfo())}this.shareObject.taskType=n,window.mqq&&mqq.invoke("docx","setAuthForSharePad",this.shareObject,function(){})}}},{key:"getInstance",value:function(){return this.shareObject}}]),e}();t.default=new d},"./js/app/header/pc/auth-btn.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=(m(n("./js/config/index.js")),n("./js/script-loader/index.js")),a=n("./js/utils/browser.js"),r=n("./js/utils/user-agent.js"),s=n("./js/component/toast/index.js"),l=m(n("./js/app/auth/advanced.js")),d=m(n("./js/app/header/share.js")),c=m(n("./js/network/login.js")),u=n("./js/app/header/util.js"),p=n("./js/config/sheet.js"),h=n("./js/event/event-center.js"),f=n("./js/app/spread-sheet/index.js");function m(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"init",value:function(){var e=this;if(4&clientVars.rightFlag){var t=$(".toolbar-auth-btn");t.css("display","inline-block");var n=$("<div></div>").addClass("auth-tip");t.append(n);var o=$("<div></div>").addClass("new-auth-guide");t.parent().append(o),this.initHoverAuthTip.bind(this)(n,t,o),this.initNewAuthGuide(o);var i=(0,a.getQuery)("chatType"),r=(0,a.getQuery)("chatId"),s=(0,a.getQuery)("fileMD5");if(this.importGuideInfo=null,i&&r&&s&&(this.cooperMemlist=null,this.$importAuthGuide=o,this.initImportAuthGuide(parseInt(i),r,s)),$("#auth-container").show(),$("#auth-container").removeClass("auth-container-show"),$("#auth-container").addClass("auth-container-hide"),$("#auth-container").addClass("auth-container-slide-animation"),(0,a.getQuery)("qbShowAuth")){var l=document.location.href;l=(0,a.removeURLParameter)(l,"qbShowAuth"),history.replaceState(null,null,l),setTimeout(function(){e._doShowAuth()},1e3)}this.bindEvent(),T_SHEET.Report.tdwReport({opername:"doc_access",module:"entry",action:"exp_pc"}),this.permission=(0,f.getPermission)(),this.permission&&this.listenPermissionsStatusChange()}}},{key:"bindEvent",value:function(){var e=this;h.event.default.listen("discussShow",function(t){t&&e.hideAuth()}),SLR.listen("TX-AUTH-UPDATED",function(){e.refreshPolicyTips()}),$(".toolbar-auth-btn").click(function(){window.swReportStop&&window.swReportStop(),T_SHEET.Report.jank.log({moduleValue:"permission",actionValue:"click"}),$(".new-auth-guide").hide(),e._doShowAuth(),T_SHEET.Report.tdwReport({opername:"doc_access",module:"page",action:"clk_btn"})}),window.addEventListener("changePermission",function(){(0,i.loadModule)("Share",function(t){t.hide(),e.showAuth(!1,"Share",function(){(0,u.showShare)(!1)})})}),window.addEventListener("changeAdvPermission",function(){(0,i.loadModule)("Share",function(t){t.hide(),e.showAuth(!1,"Share",function(){(0,u.showShare)(!1)})})}),$(window).on("networkOnline",function(){$(".toolbar-auth-btn").removeClass("toolbar-auth-btn-disabled")}),$(window).on("networkOffline",function(){$(".toolbar-auth-btn").addClass("toolbar-auth-btn-disabled"),e.hideAuthContainerAnim()})}},{key:"listenPermissionsStatusChange",value:function(){this.permission.listenEditChange(function(e){return e?this.switchToEditable():this.switchToReadonly()}.bind(this))}},{key:"switchToReadonly",value:function(){$(".toolbar-auth-btn").css("display","none")}},{key:"switchToEditable",value:function(){$(".toolbar-auth-btn").css("display","inline-block")}},{key:"initHoverAuthTip",value:function(e,t,n){var o=this;r.isPad||(e.css("padding","6px 10px 6px 10px"),$.ajax({type:"get",url:(0,a.getUidParam)("//docs.qq.com/cgi-bin/redirect/"+window.clientVars.creatorDomain+"/ep/api/getpadinfo?localPadId="+clientVars.padId+"&type=1&ver=2&xsrf="+(0,a.getXsrf)()),xhrFields:{withCredentials:!0},success:function(e){0===e.retcode?(o.updatePolicyTips(e),o.cooperMemlist=e.memlist,o.$importAuthGuide&&o.importGuideInfo&&o.findCooperMember(o.cooperMemlist,o.importGuideInfo.guest_user_info)&&o.$importAuthGuide.hide()):1025!==e.retcode&&(0,s.showToast)("\u62c9\u53d6\u534f\u4f5c\u8005\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",{top:"125px"},{toolToastCloseTime:2e3})},error:function(){(0,s.showToast)("\u62c9\u53d6\u534f\u4f5c\u8005\u5217\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5",{top:"125px"},{toolToastCloseTime:2e3})}}),t.on("mouseover",function(){e.html()&&(e.show().css("left",-(e[0].offsetWidth/2-t.width()/2)+"px"),n.hide())}).on("mouseleave",function(){e.hide()}))}},{key:"findCooperMember",value:function(e,t){return e&&e.some(function(e){return e.uidSource===t.uidSource&&parseInt(e.uid)===parseInt(t.uid)})}},{key:"getPolicyToolTipWithMemList",value:function(e){var t="\u53ef\u9080\u8bf7\u6210\u5458\u4e00\u8d77\u534f\u4f5c";if(e&&e.length){var n=e.slice(),o=e;e.length>2&&(o=e.splice(0,2));var i=o.map(function(e){var t=e.nick||"";return t.length>4&&(t=t.substr(0,3)),t});i=i.filter(function(e){return""!==e}).join("\u3001"),t=n.length>2?"\u4ec5\u548c"+i+"\u2026\u7b49"+n.length+"\u4f4d\u6210\u5458\u4e00\u8d77\u534f\u4f5c":"\u4ec5\u548c"+i+n.length+"\u4f4d\u6210\u5458\u4e00\u8d77\u534f\u4f5c"}return t}},{key:"getPolicyToolTip",value:function(e){if(r.isPad)return"";var t='"font-family:Microsoft YaHei,\u5fae\u8f6f\u96c5\u9ed1,\u9ed1\u4f53,\u5b8b\u4f53,sans-serif"';switch(e.policy){case 0:return"<p style="+t+">\u9080\u8bf7\u4ed6\u4eba\u4e00\u8d77\u534f\u4f5c</p>";case 1:return"<p style="+t+">"+this.getSummary(e.memlist)+"</p>";case 2:return"<p style="+t+">\u83b7\u5f97\u94fe\u63a5\u7684\u4eba\u53ef\u67e5\u770b</p>";case 3:return"<p style="+t+">\u83b7\u5f97\u94fe\u63a5\u7684\u4eba\u53ef\u7f16\u8f91</p>";default:return""}}},{key:"getSummary",value:function(e){var t="\u6682\u672a\u9080\u8bf7\u4ed6\u4eba\u4e00\u8d77\u534f\u4f5c";try{if(e&&e.length>0){var n=e[0].nick||"";n.length>8&&(n=n.substr(0,8),n+="..."),t="\u4e0e"+n+(e.length>1?"\u7b49"+e.length+"\u4eba":"")+"\u4e00\u8d77\u534f\u4f5c"}}catch(o){console.error("getSummary",o)}finally{return t}}},{key:"getPolicyIconClass",value:function(e){return"auth-tip-"+["lock","cooperation","eye","edit"][e]}},{key:"refreshPolicyTips",value:function(){var e=this;$.ajax({type:"get",url:(0,a.getUidParam)("//docs.qq.com/cgi-bin/redirect/"+window.clientVars.creatorDomain+"/ep/api/getpadinfo?localPadId="+clientVars.padId+"&type=1&ver=2&xsrf="+(0,a.getXsrf)()),xhrFields:{withCredentials:!0},success:function(t){0===t.retcode&&e.updatePolicyTips(t)},error:function(){}})}},{key:"updatePolicyTips",value:function(e){r.isPad||(console.log("----------",e),$(".auth-tip").html(this.getPolicyToolTip(e)),$(".toolbar-auth-btn .toolbar-auth-btn-image").removeClass("auth-tip-lock auth-tip-cooperation auth-tip-eye auth-tip-edit").addClass(this.getPolicyIconClass(e.policy)),0==e.policy?($(".toolbar-auth-btn .toolbar-auth-btn-image").addClass("private"),$(".toolbar-auth-btn .toolbar-auth-btn-text").addClass("docx-icon-common auth-tip-lock-add private").html("")):($(".toolbar-auth-btn .toolbar-auth-btn-image").removeClass("private"),$(".toolbar-auth-btn .toolbar-auth-btn-text").removeClass("docx-icon-common auth-tip-lock-add private").html("\u534f\u4f5c")),this.updateWhenOnlyMeReadWrite(e))}},{key:"updateWhenOnlyMeReadWrite",value:function(e){var t=navigator.userAgent.toLowerCase();if(t&&/(qqbrowser)/.test(t)&&/(windows)/.test(t)&&/(chrome)/.test(t)){var n=$(".toolbar-auth-btn-image");n&&n.css("padding-bottom","1px")}}},{key:"showAuthContainerAnim",value:function(){$("#auth-container").removeClass("auth-container-hide"),$("#auth-container").addClass("auth-container-show")}},{key:"hideAuthContainerAnim",value:function(){$("#auth-container").removeClass("auth-container-show"),$("#auth-container").addClass("auth-container-hide")}},{key:"initNewAuthGuide",value:function(e){var t=this;$.ajax({type:"post",url:"//docs.qq.com/cgi-bin/online_docs/user_flag",data:{type:524288},success:function(n){n&&0===n.retcode&&(1===n.typeFlag||t.showNewAuthGuide(e))},error:function(){}})}},{key:"initImportAuthGuide",value:function(e,t,n){var o=this;$.ajax({type:"post",url:"/cgi-bin/online_docs/qq_import/getTips",data:{guest_uid_type:e,guest_uid:t,file_md5:n,xsrf:(0,a.getXsrf)()},success:function(i){i&&0===i.retcode&&(0===i.tips_showed_flag&&o.$importAuthGuide&&(o.importGuideInfo={guest_uid_type:e,guest_uid:t,file_md5:n,guest_user_info:i.guest_user_info},o.findCooperMember(o.cooperMemlist,o.importGuideInfo.guest_user_info)||o.showImportAuthGuide(e)))},error:function(){}})}},{key:"showNewAuthGuide",value:function(e){e.append("<div class='new-auth-guide-warpper'><div class='new-auth-guide-icon' ><div/><div class='new-auth-guide-tip-warpper'><p class='new-auth-guide-tip'>\u9080\u8bf7\u6210\u5458\u4e00\u8d77\u534f\u4f5c\uff0c</p><p class='new-auth-guide-tip'>\u8ba9\u521b\u4f5c\u66f4\u8f7b\u677e\u3002</p></div><div class='new-auth-guide-close-icon' ><div/><button class='new-auth-guide-close-button'/><div>"),e.show(),$.ajax({type:"post",url:"//docs.qq.com/cgi-bin/online_docs/user_flag/save",data:{type:524288,flag:1},success:function(e){},error:function(){}}),$(".new-auth-guide-close-button").click(function(){e.hide()}),setTimeout(function(){e.hide()},3e3)}},{key:"showImportAuthGuide",value:function(e){var t=this;this.$importAuthGuide.removeClass("new-auth-guide").addClass("import-auth-guide");var n="<div class='import-auth-guide-warpper'><p class='import-auth-guide-tip'>\u817e\u8baf\u6587\u6863\u53ef\u4ee5\u9080\u8bf7\u4ed6\u4eba\u4e00\u8d77\u7f16\u8f91  <a class='invite-guest-member'>\u9080\u8bf7"+(1===e?"\u597d\u53cb":"\u7fa4\u6210\u5458")+"<a/></p></div>";this.$importAuthGuide.append(n),this.$importAuthGuide.show(),$(".invite-guest-member").click(function(){t.$importAuthGuide.hide(),t._doShowAuth()}),setTimeout(function(){t.$importAuthGuide.hide()},1e4)}},{key:"_doShowAuth",value:function(){$(".toolbar-auth-btn").hasClass("toolbar-auth-btn-disabled")||(c.default.checkIfAccountSwitched("Auth")&&window.SLR?window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"Auth"}):this.showAuth(!1))}},{key:"hideAuth",value:function(){h.event.toolBar.trigger("authSharePanelHide"),$("#auth-container").hasClass("auth-container-show")&&(this.hideAuthContainerAnim(),(0,i.loadModule)("CooperationV2",function(e,t){t||e.hide(!0)}))}},{key:"showAuth",value:function(e,t,n){var o=this;if(h.event.toolBar.trigger("authSharePanelShow"),t=t||"Root",$("#auth-container").hasClass("auth-container-show"))this.hideAuthContainerAnim();else{$("#doc-sharebox-container").is(":visible")&&$("#doc-sharebox-container").hide(),h.event.default.trigger("enableAll"),h.event.default.trigger("record-hide-side"),(0,u.hideReadRecord)(),(0,u.hideNotification)(),this.showAuthContainerAnim();var a=window.clientVars.globalPadId,r=a.indexOf("$"),s=a.slice(0,r);(0,i.loadModule)("CooperationV2",function(i,a){a?i.init(document.getElementById("auth-container"),{invokeFrom:t,padId:(0,p.getPadId)(),owner:{name:window.clientVars.userName,avatar:window.clientVars.userPic,type:"owner",uin:window.clientVars.uin},domainId:s,creatorDomain:window.clientVars.creatorDomain,shareLink:d.default.getShareUrl(),importGuideInfo:o.importGuideInfo,shareTitle:function(){return(0,p.getTitle)()},shareDocType:window.clientVars.padType,onAuthUpdated:function(e){o.updatePolicyTips(e)},onShare:function(){(0,u.showShare)()},onClose:function(e){o.hideAuthContainerAnim(),n&&n(),e&&o.updatePolicyTips(e),h.event.default.trigger("CooperationV2Show",!1)},showAdvPermissionsCmp:e,onAuthExpTimeUpdated:function(e){l.default.onUpdateAuthExpInfo(e)}}):i.show({onAuthUpdated:function(e){o.updatePolicyTips(e)},invokeFrom:t,onClose:function(e){n&&n(),o.hideAuthContainerAnim(),e&&o.updatePolicyTips(e),h.event.default.trigger("CooperationV2Show",!1)},showAdvPermissionsCmp:e,onAuthExpTimeUpdated:function(e){l.default.onUpdateAuthExpInfo(e)}}),h.event.default.trigger("CooperationV2Show",!0)})}}}]),e}();t.default=new g},"./js/app/header/pc/header-html.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateHeaderHtml=function(){return'\n        <div id="web_header_top" class="web_header_top">\n            <div class="brand-container"><div class="brand_back"></div><a class="brand_logo_new" href="https://docs.qq.com/desktop/?_from=1" style=""></a></div>\n            '+(i?'<div class="menu-bg-pc-right" id="menu-bg-pc-right-mac" style="display:block"></div>':'<div class="menu-bg-pc-right" id="menu-bg-pc-right-pc" style="display:block"></div>')+'\n            <input id="padAloneTitle" class="tim-web" value="" disabled />\n            <div class="web_header_readonly_tip_container">\n                <div class="web_header_readonly_tip docx-icon-common title-readonly-icon-normal"></div>\n                <div class="readonly_tip_popup common-web-popup-boxshadow"></div>\n            </div>\n            <span id="editor-last-state"></span>\n            <div id="web_header_extra_container">\n                <button class="sharebutton header-function-btn-blue-normal">\u5206\u4eab</button>\n\n                <button class="toolbar-auth-btn">\n                    <div class="docx-icon-common toolbar-auth-btn-image auth-tip-eye"></div>\n                    <span class="toolbar-auth-btn-text">\u534f\u4f5c</span>\n                </button>\n            </div>\n            <div class="tim-userline-wrapper tim-web" id="otherusersComponent">\n                <div id="otherusers" class="otherusers">\n                    <div id="otherusersline-wrapper" class="otherusersline-wrapper">\n                        <div id="otherusersline" class="otherusersline"></div>\n                        <div id="more-wrapper" class="more-wrapper" style="display: none;">\n                            <div id="more" class="more"></div>\n                        </div>\n                    </div>\n                    <div id="otheruserstable-wrapper">\n                        <div id="otheruserstable-bg"></div>\n                        <div id="otheruserstable-title-wrapper"><span id="otheruserstable-title"></span></div>\n                        <ul id="otheruserstable" class="popup-scrollable"></ul>\n                    </div>\n                </div>\n                <span class="userline-separator"></span>\n            </div>            \n        </div>\n\n        <div id="web_header_bottom" class="web_header_bottom">\n            '+(i?'<div class="toolbar-preview-pc" id="toolbar-preview-mac" style="display: block"></div>':'<div class="toolbar-preview-pc" id="toolbar-preview-pc" style="display: block"></div>')+"\n        </div>\n    "};var o=navigator.userAgent.toLowerCase(),i=-1!=o.indexOf("macintosh")||-1!=o.indexOf("mac os x")},"./js/app/header/pc/pc-header.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=C(n("./js/config/index.js")),a=n("./js/config/sheet.js"),r=n("./js/utils/user-agent.js"),s=n("./js/event/event-center.js"),l=n("./js/utils/browser.js"),d=C(n("./js/network/login.js")),c=C(n("./js/app/auth/index.js")),u=n("./js/app/spread-sheet/index.js"),p=n("./js/app/header/util.js"),h=n("./js/component/toast/index.js"),f=n("./js/utils/ui/tooltip.js"),m=n("./js/utils/ui/dom.js"),g=n("./js/utils/date.js"),w=C(n("./js/app/header/common/title.js")),v=C(n("./js/app/header/common/save-status.js")),b=C(n("./js/app/header/pc/right-menu/index.js")),_=C(n("./js/app/header/common/userline-new.js")),y=C(n("./js/app/header/pc/auth-btn.js")),T=n("./js/script-loader/index.js"),E=n("./js/app/header/pc/header-html.js");function C(e){return e&&e.__esModule?e:{default:e}}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.HeaderElemType={begin:0,title:4,usersList:2,readOnlyTip:3,lastState:1,headerMenu:5,unloginTip:6,end:7},this.space=10,this.$padHeader=null,this.headerElemInfo={},this.permission=null,s.event.default.listen("spreadInitFinished",function(){this.permission=(0,u.getPermission)(),this.permission&&this.listenPermissionsStatusChange()}.bind(this))}return o(e,[{key:"immInit",value:function(){try{s.event.default.listen("alloyExcelFirstRender",function(){w.default.init()})}catch(e){console.error("error in title.js",e)}this.initHTML(),this.generateElemInfos(),w.default.initDom()}},{key:"initAfterCanvas",value:function(){if(w.default.firstFrameRenderFinish(),i.default.isPreview)this.initPreview();else{this.initReadOnlyDom(),v.default.init(),b.default.init(),y.default.init(),this.initShareBtn(),_.default.init(),this.init();try{var e=window.SpreadsheetApp,t=e&&e.plugins&&e.plugins.rmap;t&&t.handle("change_header")}catch(n){}}}},{key:"listenPermissionsStatusChange",value:function(){var e=this;this.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){$(".toolbar-auth-btn").css("display","none")}},{key:"switchToEditable",value:function(){$(".toolbar-auth-btn").css("display","inline-block")}},{key:"init",value:function(){var e=this;this.permission=(0,u.getPermission)(),this.permission&&this.listenPermissionsStatusChange(),i.default.isLogin&&(r.isPcApp||($(".brand-container").data("tooltip","\u8fd4\u56de\u817e\u8baf\u6587\u6863\u5217\u8868\u9996\u9875"),(0,f.tooltip)(".brand-container")),(0,f.tooltip)(".sharebutton"),i.default.isFormPreview?($("#web_header_extra_container").css("display","none"),$(".user-info-container").css("display","none")):($("#web_header_extra_container").css("display","inline-block"),$("#web_header_tool_tabs_container").css("display","inline-block")),(0,m.btnState)($(".sharebutton"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,m.btnState)($(".user-info-container"),null,"header-function-btn-hover","header-function-btn-selected"),(0,m.btnState)($(".toolbar-auth-btn"),"header-function-btn-normal","header-function-btn-hover","header-function-btn-selected")),window.SLR&&SLR.listen("SL-INIT",function(){e.initAccount(),e.initHelpCenter()}),this.initAccount(),this.initHelpCenter(),this.initChat(),d.default.init($("#web_header_top"),!i.default.isLogin),this.initLoginAction(),c.default.checkIsApplyIn24H(function(t){e.initReadOnlyTip(t)}),c.default.checkHasRedpoint(),this.initNotification(),this.initSaveGroupBtn(),this.initForPad(),this.bindEvent(),this.handleAppSplitMode(),this.innerRefreshLayout()}},{key:"initForPad",value:function(){r.isPcApp&&w.default.hideBackIconForTDIPadApp(),r.isTencentDocApp&&window.mqq&&mqq.addEventListener("sendFileData",function(e){for(var t=JSON.parse(JSON.stringify(e)),n=t.params.fileString,o=t.params.fileName,i=(t.params.filePath,"application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,.xlsx,.xls,.doc,.docx,.csv,.txt"),a=atob(n),r=[],s=0;s<a.length;s+=512){for(var l=a.slice(s,s+512),d=new Array(l.length),c=0;c<l.length;c++)d[c]=l.charCodeAt(c);var u=new Uint8Array(d);r.push(u)}var h=new Blob(r,{type:i}),f=new File([h],o,{type:i,lastModified:Date.now()});(0,p.getFile)(f)})}},{key:"initHTML",value:function(){var e=$("header");e[0]?e[0].innerHTML=(0,E.generateHeaderHtml)():console.warn("header element not exist!")}},{key:"bindEvent",value:function(){var e=this;s.event.keyboard.listen("resize",function(){e.onResize()}),s.event.default.listen("pc-header-enable",function(){b.default.enableAll()}),s.event.default.listen("pc-header-refresh",function(){e.refreshLayout()}),window.SLR&&SLR.listen("SHOW_TOAST",function(e){(0,h.showToast)(e.detail.title,{top:"5px"},{toolToastCloseTime:e.detail.time})}),$("body").on("click",function(t){var n=$(t.target);n.is(".user-info-container")||n.parents(".user-info-container").length||e.hideLoginDropdown(),n.is(".web_header_readonly_tip")||n.parents(".web_header_readonly_tip").length||$(".readonly_tip_popup").hide()}),window.addEventListener("SheetMouseDown",function(t){e.hideLoginDropdown(),$(".readonly_tip_popup").hide()}),window.addEventListener("SheetScroll",function(t){e.hideLoginDropdown(),$(".readonly_tip_popup").hide()}),$(window).resize(function(){e.hideLoginDropdown(),$(".readonly_tip_popup").hide()}),i.default.isLogin}},{key:"initReadOnlyDom",value:function(){var e=$(".web_header_readonly_tip");e.removeClass("docx-icon-common title-readonly-icon-normal"),i.default.isFormPreview?(e.addClass("form-preview-tip-text"),e.append($('<div class="readonly_tip_text">\u6b63\u5728\u9884\u89c8</div>'))):(e.addClass("header-function-btn-blue-normal"),e.append($('<div class="readonly_tip_text">\u53ea\u80fd\u67e5\u770b</div><div class="readonly_tip_right_arrow docx-icon-common readonly_tip_arrow"></div> ')))}},{key:"bindingApplyAuth",value:function(e){setTimeout(function(){$(e).click(function(){c.default.doAuthApply(c.default.authApplyCallBack.bind(c.default))})},0)}},{key:"initReadOnlyTip",value:function(e){var t=this;if(this.headerElemInfo.readOnlyTip&&!i.default.isPreview||!i.default.isLogin){if(i.default.gEditable||i.default.isFormPreview)return;var n=null,o=$(".readonly_tip_popup"),a=$(".web_header_readonly_tip"),r=null,s=!1;if(a.attr("id","web_header_readonly_tip"),i.default.isLogin)a.attr("data-tooltip","\u5f53\u524d\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c\n\u70b9\u51fb\u7533\u8bf7\u7f16\u8f91\u6743\u9650\u3002");else a.attr("data-tooltip","\u5f53\u524d\u6587\u6863\u6743\u9650\u4e3a\u201c\u53ea\u80fd\u67e5\u770b\u201d\uff0c\n\u767b\u5f55\u540e\u83b7\u5f97\u66f4\u591a\u64cd\u4f5c\u6743\u9650\u3002");(0,f.tooltip)(".web_header_readonly_tip",{textAlign:"left",afterShow:function(e){a.attr("data-tooltip").indexOf("\n")>0&&e.css({paddingLeft:"9px",paddingTop:"8px",paddingBottom:"8px",paddingRight:"4px"})}});var l=$('<div id="readonlyTipContent" class="toolbar-only-read-tip-main-content">\u4f60\u53ea\u80fd\u67e5\u770b\u6b64\u6587\u6863\uff0c\u8981\u66f4\u6539\u6743\u9650\uff0c\n\u8bf7\u5411\u6587\u6863\u521b\u5efa\u8005\u53d1\u8d77\u7533\u8bf7\u3002</div>');o.append(l);var u=function(){0==o.has("#readonlyTipApplyAuth").length&&(o.append($('<div id="readonlyTipApplyAuth" class="toolbar-only-read-tip-sec-content">\u7533\u8bf7\u7f16\u8f91\u6743\u9650</div>')),t.bindingApplyAuth("#readonlyTipApplyAuth")),o.css("height","96px"),o.css("width","242px"),l.css("padding-bottom","0px"),l.css("padding-top","11px"),o.css("white-space","pre-wrap")},p=function(){o.has("#readonlyTipApplyAuth").length>0&&$("#readonlyTipApplyAuth").remove(),o.css("white-space","nowrap"),l.css("padding-bottom","16px"),l.css("padding-top","16px"),o.css("height","auto"),o.css("width","auto")};if(i.default.isLogin)if(!e.apply||e.noPass||e.pass){if(e.apply&&e.noPass)n="\u6743\u9650\u7533\u8bf7\u672a\u901a\u8fc7\uff0c\u201c\u53ea\u80fd\u67e5\u770b\u201d\u6587\u6863\u3002",a.attr("data-tooltip",n);else if(!i.default.isLogin)return}else n="\u6743\u9650\u7533\u8bf7\u5df2\u63d0\u4ea4\uff0c\u8bf7\u7b49\u5f85\u521b\u5efa\u8005\u5ba1\u6838\u3002",a.attr("data-tooltip",n);else n="\u767b\u5f55\u540e\u83b7\u5f97\u66f4\u591a\u64cd\u4f5c\u6743\u9650";l.html(n),p(),a.css("cursor","pointer"),a.click(function(e){if(d.default.checkIfAccountSwitched("ReadOnlyTip")&&window.SLR)window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"ReadOnlyTip"});else{"block"!==$(".readonly_tip_popup")[0].style.display&&(T_SHEET.Report.tdwReport({opername:"doc_author",module:"edit",action:"exp_tip"}),T_SHEET.Report.tdwReport({opername:"doc_author",module:"edit",action:"exp"})),(0,f.hideTooltip)();var t=c.default.getReadOnlyTip(!1);l.html(t.tip),t.isNeedApplyAuth?u():p(),s||(s=!0,r&&(clearTimeout(r),r=null)),o.toggle()}}),(0,m.btnState)($(".web_header_readonly_tip"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),this.headerElemInfo.readOnlyTip.show(),this.innerRefreshLayout()}}},{key:"_doShowShare",value:function(){$(".sharebutton").hasClass("sharebutton-disabled")||(d.default.checkIfAccountSwitched("Share")&&window.SLR?window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"Share"}):(0,p.showShare)())}},{key:"initShareBtn",value:function(){var e=this;if($(".sharebutton").remove(),$(".toolbar-auth-btn").after($('<button class="sharebutton header-function-btn-blue-normal" style="display: inline-block;">\u5206\u4eab</button>')),$(".sharebutton").css("display","inline-block"),(0,l.getQuery)("qbShowShare")){var t=document.location.href;t=(0,l.removeURLParameter)(t,"qbShowShare"),history.replaceState(null,null,t),setTimeout(function(){e._doShowShare()},1e3)}$(".sharebutton").click(function(){window.swReportStop&&window.swReportStop(),T_SHEET.Report.jank.log({moduleValue:"share",actionValue:"click"}),e._doShowShare()}),$(window).on("networkOnline",function(){$(".sharebutton").removeClass("sharebutton-disabled")}),$(window).on("networkOffline",function(){$(".sharebutton").addClass("sharebutton-disabled"),$("#sharebox2-container").hide()}),T_SHEET.Report.tdwReport({opername:"doc_share",module:"entry_pc",action:"exp"})}},{key:"initNotification",value:function(){$(".toolbar-notification-btn").attr("data-tooltip","\u901a\u77e5\u5217\u8868"),(0,f.tooltip)(".toolbar-notification-btn"),$(document).on("click","#notification-dropdown-line",function(){if(!$(".toolbar-notification-btn").hasClass("toolbar-notification-btn-disabled")){if((0,p.isNotificationShow)()?(0,p.hideNotification)():(0,p.showNotification)(),$("#notification-dropdown-line").find(".redpoint").length>0){var e={};window.clientVars.isCreator&&(e={detail:{localPadID:window.clientVars.localPadId,domainID:window.clientVars.domainId}});var t=new CustomEvent("notification-update-list",e);document.dispatchEvent(t)}window.clientVars.isCreator||c.default.clearUnreadNotificationNumber()}}),$(window).on("networkOnline",function(){var e=new CustomEvent("notification-list-online");document.dispatchEvent(e)}),$(window).on("networkOffline",function(){var e=new CustomEvent("notification-list-offline");document.dispatchEvent(e)})}},{key:"hideLoginDropdown",value:function(){$(".login-dropdown").css({zIndex:"504"}).hide()}},{key:"initAccount",value:function(){(0,T.loadModule)("Account",function(e){try{var t=document.getElementById("accountContainer"),n=!$("#foldIcon").hasClass("hidefold"),o=(0,u.getFormulaEditor)(),i=o&&o.isShow(),a=n?54:43,r=(!n&&i?o&&o.getWidth():0)+20;e.show(t,{top:a,right:r,logoutRefresh:!1,padId:"",domainId:"",userInfo:{}})}catch(s){console.error(s)}})}},{key:"initHelpCenter",value:function(){(0,T.loadModule)("HelpCenter",function(e){try{var t=document.createElement("div");document.body.appendChild(t),e.show(t,{from:"excel",clientVars:window.clientVars})}catch(n){console.error(n)}})}},{key:"initChat",value:function(){setTimeout(function(){(0,T.loadModule)("Chat",function(e){try{var t=document.createElement("div");document.body.appendChild(t),e.show(t,{from:"excel",clientVars:window.clientVars})}catch(n){console.error(n)}})},2e3)}},{key:"initLoginAction",value:function(){var e=this,t=!1;i.default.isLogin&&($(window).on("networkOnline",function(){$(".user-info-container").removeClass("dropdown-container-disabled"),t=!1}),$(window).on("networkOffline",function(){$(".user-info-container").addClass("dropdown-container-disabled"),t=!0}),$(".user-info-container").click(function(n){t||(d.default.checkIfAccountSwitched("Account")&&window.SLR?window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"Account"}):(e.initAccount(),SLR.dispatch("TXDOC-ACCOUNT-SHOW",{})))}),$(".login-dropdown").on("mousedown",function(e){e.preventDefault()}))}},{key:"initPreview",value:function(){$("#preview-bottom-edit-btn").data("tooltip","\u968f\u65f6\u968f\u5730\u4e91\u7aef\u7f16\u8f91\u4fdd\u5b58\uff0c\u8fd8\u53ef\u9080\u8bf7\u591a\u4eba\u534f\u4f5c\u3002"),$("#preview-bottom-collect-btn").data("tooltip","\u6536\u85cf\u540e\u53ef\u591a\u7aef\u968f\u65f6\u67e5\u770b\u548c\u7f16\u8f91\u6587\u6863\u3002"),r.isPcApp||window.clientVars.ownerAppid||$(".brand_logo_new").data("tooltip","\u8fd4\u56de\u817e\u8baf\u6587\u6863\u5217\u8868\u9996\u9875"),r.isPcApp&&$(".brand_logo_new").css("cursor","default"),(0,f.tooltip)("#preview-bottom-edit-btn",{maxWidth:"400px",tooltipArrowClass:"tooltip-after"}),(0,f.tooltip)("#preview-bottom-collect-btn",{tooltipArrowClass:"tooltip-after"}),1==window.clientVars.previewFromBrowser?$("#preview-bottom-collect-btn").remove():$("#preview-bottom-collect-btn").css("display","inline-block"),$(".brand_logo_new").show(),(0,m.btnState)($("#preview-bottom-edit-btn"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,m.btnState)($("#preview-bottom-collect-btn"),"header-function-btn-normal","header-function-btn-hover","header-function-btn-selected")}},{key:"handleAppSplitMode",value:function(){if(r.isTencentDocApp){var e='<div id="web_header_top_split"><div id="title_split">'+(0,a.getTitle)()+('<span id="editor_split">'+("\u6700\u8fd1\u4fdd\u5b58 "+(0,g.prettyDate)(v.default.getLastSaveTime()))+"</span>")+"</div></div>";$("header").prepend(e),$("#web_header_top_split").hide(),$(document).ready(function(){1!=localStorage.getItem("splitMode")&&"true"!=localStorage.getItem("splitMode")||($("#web_header_top").css("position","absolute"),$("#web_header_top").hide(),$("#web_header_top_split").show())}),window.mqq&&mqq.addEventListener("screenModeChange",function(e){var t="split"===JSON.parse(JSON.stringify(e)).mode;t?$("#foldBtn").hide():$("#foldBtn").show(),t?($("#web_header_top").css("position","absolute"),$("#web_header_top").hide(),$("#web_header_top_split").show()):($("#web_header_top").css("position","relative"),$("#web_header_top").show(),$("#web_header_top_split").hide())})}}},{key:"initSaveGroupBtn",value:function(){(0,l.getQuery)("addToGroup")&&(0,h.showToast)("\u6dfb\u52a0\u6210\u529f\uff0c\u5df2\u4e3a\u7fa4\u6210\u5458\u5f00\u901a\u7f16\u8f91\u6743\u9650\uff0c\u53ef\u624b\u52a8\u66f4\u6539\u3002",{top:"125px"},{isNeedClose:!0,toolToastRemoveCallBack:function(){var e=document.location.href;(e=e.replace("?addToGroup=1","")).indexOf("&")>=0&&(e=e.replace("&","?")),history.replaceState(null,null,e)}})}},{key:"generateElemInfos",value:function(){this.$padHeader=$("header"),this.headerElemInfo.readOnlyTip=$(".web_header_readonly_tip_container"),this.headerElemInfo.lastState=$("#editor-last-state"),this.headerElemInfo.title=$("#padAloneTitle"),i.default.isLogin||(this.headerElemInfo.unloginTip=$(".unlogin-container")),i.default.gEditable||r.isMobile||($(".tim-userline-wrapper").css("display","none"),console.warn("------ hide userline -----")),this.headerElemInfo.usersList=$(".tim-userline-wrapper")}},{key:"curExistWidth",value:function(){var e=this.headerElemInfo.title.offset().left+this.headerElemInfo.title.outerWidth();"none"!=this.headerElemInfo.readOnlyTip.css("display")&&(e+=this.headerElemInfo.readOnlyTip.outerWidth()),"none"!=this.headerElemInfo.lastState.css("display")&&(e+=this.headerElemInfo.lastState.outerWidth()+parseInt(this.headerElemInfo.lastState.css("margin-left"))),"none"!=this.headerElemInfo.usersList.css("display")&&(e+=this.headerElemInfo.usersList.outerWidth()+parseInt(this.headerElemInfo.usersList.css("margin-left")));var t=$("#web_header_extra_container");"none"!=t.css("display")&&(e+=t.outerWidth(),e+=parseInt(t.css("margin-right")),e+=parseInt(t.css("margin-left")),e+=parseInt(t.css("right")));var n=$("#web_header_tool_tabs_container");return"none"!=n.css("display")&&(e+=n.outerWidth(),e+=parseInt(n.css("margin-left"))),this.headerElemInfo.unloginTip&&"none"!=this.headerElemInfo.unloginTip.css("display")&&(e+=this.headerElemInfo.unloginTip.outerWidth(),e+=parseInt(this.headerElemInfo.unloginTip.css("right"))),e}},{key:"checkReadOnlyTip",value:function(e){var t="none"!=this.headerElemInfo.readOnlyTip.css("display");if(i.default.gEditable)return 0;if(i.default.isPreview)return 0;if(0!=(2&clientVars.rightFlag))return 0;if(e>0){if(t)return 0;var n=this.headerElemInfo.readOnlyTip.outerWidth()+this.space;return e>=n?(this.headerElemInfo.readOnlyTip.css("display","inline-block"),n):65535}return 0}},{key:"checkUnloginTip",value:function(e){if(null==this.headerElemInfo.unloginTip)return 0;var t="none"!=this.headerElemInfo.unloginTip.css("display");if(e>0){if(t)return 0;var n=this.headerElemInfo.unloginTip.outerWidth()+this.space+parseInt(this.headerElemInfo.unloginTip.css("right"));return e>=n?(this.headerElemInfo.unloginTip.show(),n):65535}return t&&"none"!=this.headerElemInfo.unloginTip.css("display")?(this.headerElemInfo.unloginTip.hide(),-this.headerElemInfo.unloginTip.outerWidth()-this.space-parseInt(this.headerElemInfo.unloginTip.css("right"))):0}},{key:"showElem",value:function(e){for(var t=e,n=this.HeaderElemType.end-1;n>this.HeaderElemType.begin;n--){if(n==this.HeaderElemType.title)t-=o=w.default.fixWidth(t);else if(n==this.HeaderElemType.lastState){if(65535==(o=v.default.fixWidth(t)))break;0!=o&&(t-=o)}else if(n==this.HeaderElemType.readOnlyTip){if(65535==(o=this.checkReadOnlyTip(t)))break;0!=o&&(t-=o)}else if(n==this.HeaderElemType.usersList){if(65535==(o=_.default.fixWidth(t)))break;0!=o&&(t-=o)}else if(n==this.HeaderElemType.unloginTip){if(65535==(o=this.checkUnloginTip(t)))break;0!=o&&(t-=o)}else if(n==this.HeaderElemType.headerMenu){var o;if(65535==(o=b.default.getMenuDisplayController().fixWidth(t)))break;0!=o&&(t-=o)}if(t<=0)break}}},{key:"hideElem",value:function(e){for(var t=e,n=this.HeaderElemType.begin+1;n<this.HeaderElemType.end;n++){if(n==this.HeaderElemType.title){var o=w.default.fixWidth(t);console.log("title release: ",o),t-=o}else if(n==this.HeaderElemType.lastState){t-=o=v.default.fixWidth(t),o<0&&(t+=this.space)}else if(n==this.HeaderElemType.readOnlyTip){t-=o=this.checkReadOnlyTip(t),o<0&&(t+=this.space)}else if(n==this.HeaderElemType.usersList){t-=o=_.default.fixWidth(t)||0}else if(n==this.HeaderElemType.unloginTip){t-=o=this.checkUnloginTip(t),o<0&&(t+=this.space)}else if(n==this.HeaderElemType.headerMenu){var i=b.default&&b.default.getMenuDisplayController();t-=o=i?i.fixWidth(t):0}if(t>=0)break}return t}},{key:"onResize",value:function(){this.innerRefreshLayout()}},{key:"innerRefreshLayout",value:function(){var e=this.$padHeader.width(),t=r.isPad?20:40,n=e-(this.curExistWidth()+t);n>0?this.showElem(n):this.hideElem(n)}},{key:"refreshLayout",value:function(){this.innerRefreshLayout()}}]),e}();t.default=new x},"./js/app/header/pc/right-menu/MenuDisplayController.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/app/header/pc/right-menu/index.js");(o=a)&&o.__esModule;var r=function(){function e(){if(function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.mainDropdowns={},this.subDropdowns={},this.MenuActivated=!1,this.menuPriority={filemenu:0,editmenu:1,insertmenu:2,stylemenu:3,datamenu:4,smartmenu:5,formmenu:6,end:7},this.isShowForm=!1,clientVars&&clientVars.isCreator){var t=window.SpreadsheetApp,n=t&&t.plugins&&t.plugins.rmap;this.isShowForm=n&&n.getRelatedNumber()>0}this.collapsedAt=this.isShowForm?7:6,this.menuWidth=parseInt($("#toolbar-file-dropdown-group").css("width"))+1,this.toolmenuWidth=parseInt($("#toolbar-smart-dropdown-group").css("width"))+1}return i(e,[{key:"fixWidth",value:function(e){return e>0?this.showMenu(e):this.hideMenu(e)}},{key:"showMenu",value:function(e){this.menuWidth<2&&(this.menuWidth=parseInt($("#toolbar-file-dropdown-group").css("width"))+1,this.toolmenuWidth=parseInt($("#toolbar-smart-dropdown-group").css("width"))+1);var t=e,n=0,o=$("#web_header_tool_tabs_container"),i=o.find("#moremenu");if(7===this.collapsedAt)return 0;for(var a=0;a<this.menuPriority.end;a++){if(a===this.menuPriority.formmenu&&6===this.collapsedAt){if(!this.isShowForm)continue;if(t<=this.toolmenuWidth)return 65535;var r=o.find("#formmenu");if("none"===r.css("display")){this.collapsedAt=7,i.css("display","none"),r.css("display","inline-block");var s=r.width();n+=s,t-=s}}else if(a===this.menuPriority.smartmenu&&5===this.collapsedAt){if(t<=this.toolmenuWidth)return 65535;var l=o.find("#smartmenu");if("none"===l.css("display")){this.isShowForm?this.collapsedAt=6:(i.css("display","none"),this.collapsedAt=7),l.css("display","inline-block");var d=l.width();n+=d,t-=d}}else if(a===this.menuPriority.datamenu&&4===this.collapsedAt){if(t<=this.menuWidth)return 65535;var c=o.find("#datamenu");if("none"===c.css("display")){this.collapsedAt=5,c.css("display","inline-block");var u=c.width();n+=u,t-=u}}else if(a===this.menuPriority.stylemenu&&3===this.collapsedAt){if(t<=this.menuWidth)return 65535;var p=o.find("#stylemenu");if("none"===p.css("display")){this.collapsedAt=4,p.css("display","inline-block");var h=p.width();n+=h,t-=h}}else if(a===this.menuPriority.insertmenu&&2===this.collapsedAt){if(t<=this.menuWidth)return 65535;var f=o.find("#insertmenu");if("none"===f.css("display")){this.collapsedAt=3,f.css("display","inline-block");var m=f.width();n+=m,t-=m}}else if(a===this.menuPriority.editmenu&&1===this.collapsedAt){if(t<=this.menuWidth)return 65535;var g=o.find("#editmenu");if("none"===g.css("display")){this.collapsedAt=2,g.css("display","inline-block");var w=g.width();n+=w,t-=w}}else if(a===this.menuPriority.filemenu&&0===this.collapsedAt){if(t<=this.menuWidth)return 65535;var v=o.find("#filemenu");if("none"===v.css("display")){this.collapsedAt=1,v.css("display","inline-block");var b=v.width();n+=b,t-=b}}if(t<0)break}return n}},{key:"hideMenu",value:function(e){this.menuWidth<2&&(this.menuWidth=parseInt($("#toolbar-file-dropdown-group").css("width"))+1,this.toolmenuWidth=parseInt($("#toolbar-smart-dropdown-group").css("width"))+1);var t=e,n=0,o=$("#web_header_tool_tabs_container");if(0===this.collapsedAt)return 0;for(var i=this.menuPriority.end;i>=0;i--){if(i===this.menuPriority.formmenu){if(!this.isShowForm){this.collapsedAt=5;continue}var a=o.find("#formmenu"),r=o.find("#moremenu");if("none"!==a.css("display")){this.collapsedAt=6;var s=a.width();r.css("display","inline-block"),a.css("display","none"),n-=s,t+=s}}else if(i===this.menuPriority.smartmenu){var l=o.find("#smartmenu"),d=o.find("#moremenu");if("none"!==l.css("display")){this.collapsedAt=5;var c=l.width();this.isShowForm||d.css("display","inline-block"),l.css("display","none"),n-=c,t+=c}}else if(i===this.menuPriority.datamenu){var u=o.find("#datamenu");if("none"!==u.css("display")){this.collapsedAt=4;var p=u.width();u.css("display","none"),n-=p,t+=p}}else if(i===this.menuPriority.stylemenu){var h=o.find("#stylemenu");if("none"!==h.css("display")){this.collapsedAt=3;var f=h.width();h.css("display","none"),n-=f,t+=f}}else if(i===this.menuPriority.insertmenu){var m=o.find("#insertmenu");if("none"!==m.css("display")){this.collapsedAt=2;var g=m.width();m.css("display","none"),n-=g,t+=g}}else if(i===this.menuPriority.editmenu){var w=o.find("#editmenu");if("none"!==w.css("display")){this.collapsedAt=1;var v=w.width();w.css("display","none"),n-=v,t+=v}}else if(i===this.menuPriority.filemenu){var b=o.find("#filemenu");if("none"!==b.css("display")){this.collapsedAt=0;var _=b.width();b.css("display","none"),n-=_,t+=_}}if(t>=0)break}return console.log("hide right menu, ",e," - ",this.collapsedAt),n}},{key:"hideAll",value:function(){for(var e=Object.keys(this.mainDropdowns),t=0;t<e.length;t++){var n=this.mainDropdowns[e[t]];$("#"+e[t]).removeClass("menu-activated"),n&&n.hide(window.event)}this.MenuActivated=!1}}]),e}();t.default=r},"./js/app/header/pc/right-menu/ToolbarButton.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.toolbarbutton=null,this.icon=null,this.initToolBarButton(t)}return o(e,[{key:"_initStatus",value:function(){var e=this;this.toolbarbutton&&this.toolbarbutton.on("mousedown",function(){e.toolbarbutton.addClass("pressed").one("mouseup",function(){e.toolbarbutton.removeClass("pressed")}),e.toolbarbutton.one("mouseleave",function(){e.toolbarbutton.removeClass("pressed")});var t=$("#tooltip"),n=t&&t.data("target-dom");n&&e.toolbarbutton.find(n)&&t.remove()})}},{key:"isEnable",value:function(){return!this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")}},{key:"isChecked",value:function(){return!!this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")}},{key:"isHidden",value:function(){return!this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")}},{key:"toggleCheck",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")?this.toolbarbutton.removeClass("toolbar-button-wrapper-checked"):this.toolbarbutton.addClass("toolbar-button-wrapper-checked")}},{key:"check",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")||this.toolbarbutton.addClass("toolbar-button-wrapper-checked")}},{key:"uncheck",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-checked")&&this.toolbarbutton.removeClass("toolbar-button-wrapper-checked")}},{key:"disable",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")||this.toolbarbutton.addClass("toolbar-button-wrapper-disabled")}},{key:"enable",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-disabled")&&this.toolbarbutton.removeClass("toolbar-button-wrapper-disabled")}},{key:"hide",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")||this.toolbarbutton.addClass("toolbar-button-wrapper-hidden")}},{key:"show",value:function(){this.toolbarbutton.hasClass("toolbar-button-wrapper-hidden")&&this.toolbarbutton.removeClass("toolbar-button-wrapper-hidden")}},{key:"removeIconClassName",value:function(e){this.icon.removeClass(e)}},{key:"addIconClassName",value:function(e){this.icon.addClass(e)}},{key:"resetIconClassName",value:function(){this.icon.attr("class",""),this.icon.addClass("docx-icon-container docx-icon-img-container")}},{key:"initToolBarButton",value:function(e){e&&e.find&&(this.toolbarbutton=$(e),this.icon=$(this.toolbarbutton.find(".docx-icon-container")[0]),this._initStatus())}}]),e}();t.default=i},"./js/app/header/pc/right-menu/ToolbarFileMenuButton.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=s(n("./js/app/header/pc/right-menu/ToolbarMenuButton.js")),a=s(n("./js/app/header/pc/right-menu/dropdown.js")),r=n("./js/event/event-center.js");function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,o,i,a,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,null,a));return s.pid=r,s.subDropdowns=o,s.subDropdownMap={},s.lastInsertLine=null,s.savedLineStyle={color:"#000000",type:"normal"},s.container=i,s.disableItemMap={},s}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),o(t,[{key:"prepareDropDownData",value:function(e){for(var t=[],n=e.getDropdownContent(),o=0;o<n.length;o++){var i=n[o],a={iconClsName:i.rowIconClsName,image:i.image,content:i.content,fontFamily:i.fontFamily,hover:i.hover,template:i.template,clickcallback:this.dropdownClickHandler(i),contentClsName:i.contentClsName,identity:i.identity,extendClickCallback:i.extendClickCallback,preventHideDropdown:i.preventHideDropdown,mouseenterCallback:this.dropdownEnterHandler(i),tipContent:i.tipContent,afterItemShow:i.afterItemShow,hasSubMenu:!!i.extendShow};t.push(a)}return t}},{key:"dropdownCreated",value:function(e){}},{key:"disableItem",value:function(e){var t=this.dropdown?this.dropdown.getDOMIdByIdentity(e):"",n=t?document.getElementById(t.replace(/^#/,"")):null;n&&(n.classList.add("li-dropdown-disabled"),this.disableItemMap[e]=!0)}},{key:"enableItem",value:function(e){var t=this.dropdown?this.dropdown.getDOMIdByIdentity(e):"",n=t?document.getElementById(t.replace(/^#/,"")):null;n&&(n.classList.remove("li-dropdown-disabled"),this.disableItemMap[e]=!1)}},{key:"dropdownEnterHandler",value:function(e){var t=this;return function(n){console.log("enter");var o=!t.disableItemMap[e.identity];t.mainData.getDropdownContent().forEach(function(i){t.dropdown.isDisable(i.identity)||(i.identity!==e.identity&&i.extendHide instanceof Function?i.extendHide(n):o&&i.identity===e.identity&&i.extendShow instanceof Function&&(i.extendShow(n),n.isAria&&setTimeout(function(){$(".aria-tips-"+e.identity).focus()},50)))})}}},{key:"dropdownClickHandler",value:function(e){var t=this;return function(n){t.disableItemMap[e.identity]||t.dropdown.isDisable(e.identity)||(t.dropdown&&!e.preventHideDropdown&&(r.event.notificationCenter.trigger("closedropdownForMore"),t.dropdown.hide()),"function"===typeof e.rowclickcallback?e.rowclickcallback(n):"function"===typeof e.clickcallback&&e.clickcallback(n))}}},{key:"isInitSubdropdown",value:function(e){return void 0!==this.subDropdownMap[e]}},{key:"initSubDropdown",value:function(e){var t=this,n=this.subDropdowns[e];if(n&&void 0!==n){var o=document.getElementById(this.container.attr("id")),i=o.querySelector('li[data-row-indentity="'+e+'"] .dropdown-extend'),r=n.getDropdownContent(this),s=new a.default(r,$(o),$(i),!1,e,this.pid);this.subDropdownMap[e]={dropdown:s},n.created instanceof Function&&n.created(this),s.setBeforeHideCallback(function(e){return(!e||"click"!==e.type)&&(n.beforeHide instanceof Function&&n.beforeHide(e,t),!0)},this),n.afterHide instanceof Function&&s.setAfterHideCallback(function(e){return n.afterHide(e,t)},this)}}},{key:"hideSubDropdown",value:function(e,t){var n=this;if(void 0!==this.subDropdownMap[t]&&void 0!==this.subDropdowns[t]){var o=this.subDropdownMap[t].dropdown;if(o.isOpen()){var i=document.querySelector('li[data-row-indentity="'+t+'"]');i&&i.classList.remove("li-dropdown-expanded");var a=!0,r=this.subDropdowns[t];r.getDropdownContent().forEach(function(t){n.hideSubDropdown(e,t.identity)}),r.beforeHide instanceof Function&&(a=r.beforeHide(e,this)),!1!==a&&o.hide(),r.afterHide instanceof Function&&r.afterHide(e,this)}}}},{key:"showSubDropdown",value:function(e,t){if(this.isInitSubdropdown(t)||this.initSubDropdown(t),void 0!==this.subDropdownMap[t]&&void 0!==this.subDropdowns[t]){var n=this.subDropdownMap[t].dropdown,o=this.subDropdowns[t],i=document.querySelector('li[data-row-indentity="'+t+'"]');i.classList.add("li-dropdown-expanded");var a=i.getBoundingClientRect(),r=$(".tsSheetbox"),s=r&&r.outerHeight()||0;o.beforeShow instanceof Function&&o.beforeShow(this,n),n.show({position:"fixed","z-index":1e3,top:a.top-5,left:a.right+182>window.innerWidth?a.left-182:a.right,"max-height":window.innerHeight-a.top-s-5+"px"}),o.afterShow instanceof Function&&o.afterShow(e,this,n)}}},{key:"afterDropdownHide",value:function(){this.mainData.getDropdownContent().forEach(function(e){e.extendHide instanceof Function&&e.extendHide()}),this.toolbarbutton.removeClass("toolbar-button-wrapper-checked")}},{key:"doSubClick",value:function(){this.mainData.getDropdownContent().forEach(function(e){e.extendHide instanceof Function&&e.extendHide()}),this.dropdown.hide(),r.event.notificationCenter.trigger("closedropdownForMore")}}]),t}();t.default=l},"./js/app/header/pc/right-menu/ToolbarMenuButton.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=s(n("./js/app/header/pc/right-menu/ToolbarButton.js")),a=s(n("./js/app/header/pc/right-menu/dropdown.js")),r=n("./js/app/spread-sheet/index.js");function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var s=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return s.mainData=null,s.dropdown=null,s.container=null,s.isSeparation=!1,s.needCheck=!1,s.toolBarMenuButton=null,s.preventHideDropdown=!1,s.initToolBarMenuButton(e,n,o,i,a),s.permission=(0,r.getPermission)(),s.permission&&s.listenPermissionsStatusChange(),s}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i["default"]),o(t,[{key:"listenPermissionsStatusChange",value:function(){var e=this;this.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){this.dropdown&&this.dropdown.hide()}},{key:"switchToEditable",value:function(){this.dropdown&&this.dropdown.hide()}},{key:"initToolBarMenuButton",value:function(e,t,n,o,i){this.mainData=t,this.container=n,this.toolBarMenuButton=e,this.compatibility=o,this.needCheck=i,this.initToolBarButton(e)}},{key:"toggleIcon",value:function(e){}},{key:"isOpen",value:function(){return!(!this||!this.dropdown)&&this.dropdown.isOpen()}},{key:"dropdownClickHandler",value:function(e){var t=this;return function(n){t.toggleIcon(e),!e.clickSetNoIdentity&&t.toolbarbutton.attr("identity",e.identity),t.dropdown&&!t.preventHideDropdown&&t.dropdown.hide(),"function"===typeof e.rowclickcallback?e.rowclickcallback(n):"function"===typeof e.clickcallback&&e.clickcallback(n)}}},{key:"prepareDropDownData",value:function(e){}},{key:"dropdownCreated",value:function(e){}},{key:"_initDropDown",value:function(e,t,n,o){var i=this;this.dropdown=new a.default(e,t,n,o),this.dropdown.setAlignRight(!0),this.dropdown.setBeforeHideCallback(this.beforeDropdownHide,this),this.dropdown.setAfterHideCallback(this.afterDropdownHide,this),$(window).bind("SheetMouseDown",function(e){i.dropdown.hide()}),$(window).bind("SheetScroll",function(e){i.dropdown.hide()}),$(window).bind("mousedown",function(e){3===e.which&&i.dropdown.hide()}),$(window).bind("AfterSelectionState",function(e){i.dropdown.refreshSelItem()}),this.dropdownCreated(this.dropdown)}},{key:"initDropdown",value:function(){if(!this.dropdown){var e=this.prepareDropDownData(this.mainData);this._initDropDown(e,this.container,this.toolBarMenuButton,this.needCheck)}}},{key:"beforeDropdownHide",value:function(e){return!0}},{key:"handle",value:function(e){var t=this;if(!this.isSeparation||!$(e.target).parents(".toolbar-menu-button-icon").length&&e.target!==this.toolbarbutton.find(".toolbar-menu-button-icon")[0]&&(e.target!==this.toolbarbutton[0]||e.target===this.toolbarbutton[0]&&e.offsetX>22)){if($("#tooltip").remove(),!this.dropdown){var n=this.prepareDropDownData(this.mainData);this._initDropDown(n,this.container,this.toolBarMenuButton,this.needCheck)}!this.dropdown.isOpen()&&this.mainData.beforeShow instanceof Function&&(setTimeout(function(){t.mainData.beforeShow(t,t.dropdown)}),this.toolbarbutton.addClass("toolbar-button-wrapper-checked")),this.dropdown.toggleDropDown()}}},{key:"check",value:function(e){for(var t=null,n=0;n<this.data.length;n++){if(t=this.data[n],"string"===typeof e&&"string"===typeof t.identity?e.toLowerCase()===t.identity.toLowerCase():e===t.identity)return this.toggleIcon(t),this.toolbarbutton.attr("identity",t.identity),t;t=null}return this.compatibility&&null!==(t=this.compatibility(e))?(this.toggleIcon(t),this.toolbarbutton.attr("identity",t.identity),t):(this.resetIconClassName(),"toolbar-lineheight-group"!==this.container.attr("id")&&this.resetIconClassName(),this.toolbarbutton.attr("identity",""),null)}}]),t}();t.default=l},"./js/app/header/pc/right-menu/ToolbarMenuMoreButton.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=(s(n("./js/app/header/pc/pc-header.js")),s(n("./js/app/header/pc/right-menu/index.js"))),a=n("./js/event/event-center.js"),r=s(n("./js/app/header/pc/right-menu/ToolbarMenuButton.js"));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e,n,o,i,a){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n,i,null,a));return r.subDropdowns=o,r.subDropdownMap={},r.lastInsertLine=null,r.disableItemMap={},r.init=!1,r}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r["default"]),o(t,[{key:"prepareDropDownData",value:function(e){for(var t=[],n=e.getDropdownContent(),o=0;o<n.length;o++){var i=n[o],a={iconClsName:i.rowIconClsName,image:i.image,content:i.content,fontFamily:i.fontFamily,hover:i.hover,template:i.template,clickcallback:this.dropdownClickHandler(i),contentClsName:i.contentClsName,identity:i.identity,extendClickCallback:i.extendClickCallback,preventHideDropdown:i.preventHideDropdown,mouseenterCallback:this.dropdownEnterHandler(i),tipContent:i.tipContent,afterItemShow:i.afterItemShow};t.push(a)}return t}},{key:"dropdownCreated",value:function(e){var t=this;e.setAlignRight(!0),a.event.notificationCenter.listen("closedropdownForMore",function(){t.dropdown.hide()})}},{key:"disableItem",value:function(e){var t=this.dropdown?this.dropdown.getDOMIdByIdentity(e):"",n=t?document.getElementById(t.replace(/^#/,"")):null;n&&(n.classList.add("li-dropdown-disabled"),this.disableItemMap[e]=!0)}},{key:"enableItem",value:function(e){var t=this.dropdown?this.dropdown.getDOMIdByIdentity(e):"",n=t?document.getElementById(t.replace(/^#/,"")):null;n&&(n.classList.remove("li-dropdown-disabled"),this.disableItemMap[e]=!1)}},{key:"dropdownEnterHandler",value:function(e){var t=this;return function(n){var o=!t.disableItemMap[e.identity];t.mainData.getDropdownContent().forEach(function(t){t.identity!==e.identity&&t.extendHide instanceof Function?t.extendHide(n):o&&t.identity===e.identity&&t.extendShow instanceof Function&&t.extendShow(n)})}}},{key:"dropdownClickHandler",value:function(e){var t=this;return function(n){t.disableItemMap[e.identity]||(t.dropdown&&!e.preventHideDropdown&&t.dropdown.hide(),"function"===typeof e.rowclickcallback?e.rowclickcallback(n):"function"===typeof e.clickcallback&&e.clickcallback(n))}}},{key:"isInitSubdropdown",value:function(e){return void 0!==this.subDropdownMap[e]}},{key:"initSubDropdown",value:function(e){var t=this;if(!this.init){this.init=!0;var n=this.subDropdowns[e];if(n&&void 0!==n){var o=document.getElementById("toolbar-file-dropdown-group"),i=o.querySelector('li[data-row-indentity="'+e+'"] .dropdown-extend'),a=new DropDown(n.getDropdownContent(this),$(o),$(i));this.subDropdownMap[e]={dropdown:a},n.created instanceof Function&&n.created(this),a.setBeforeHideCallback(function(e){return"click"!==e.type&&(n.beforeHide instanceof Function&&n.beforeHide(e,t),!0)},this),n.afterHide instanceof Function&&a.setAfterHideCallback(function(e){return n.afterHide(e,t)},this)}}}},{key:"toggleSubDropdown",value:function(e,t){this.subDropdownMap[t]&&(this.subDropdownMap[t].dropdown.isOpen()?this.hideSubDropdown(e,t):this.showSubDropdown(e,t))}},{key:"hideSubDropdown",value:function(e,t){var n=document.querySelector('li[data-row-indentity="'+t+'"]');n&&n.classList.remove("li-dropdown-expanded");var o=null;"filemenu"===t&&0===i.default.getMenuDisplayController().collapsedAt?(i.default.getRightToolButton().file.initDropdown(),o=i.default.getRightToolButton().file.dropdown,i.default.getRightToolButton().file.beforeShow):"editmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=1?(i.default.getRightToolButton().edit.initDropdown(),o=i.default.getRightToolButton().edit.dropdown,i.default.getRightToolButton().edit.beforeShow):"stylemenu"===t&&i.default.getMenuDisplayController().collapsedAt<=3?(i.default.getRightToolButton().style.initDropdown(),o=i.default.getRightToolButton().style.dropdown,i.default.getRightToolButton().style.beforeShow):"datamenu"===t&&i.default.getMenuDisplayController().collapsedAt<=4?(i.default.getRightToolButton().data.initDropdown(),o=i.default.getRightToolButton().data.dropdown,i.default.getRightToolButton().data.beforeShow):"smartmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=5?(i.default.getRightToolButton().smart.initDropdown(),o=i.default.getRightToolButton().smart.dropdown,i.default.getRightToolButton().smart.beforeShow):"insertmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=2?(i.default.getRightToolButton().insert.initDropdown(),o=i.default.getRightToolButton().insert.dropdown,i.default.getRightToolButton().insert.beforeShow):"formmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=6&&(i.default.getRightToolButton().form.initDropdown(),o=i.default.getRightToolButton().form.dropdown,i.default.getRightToolButton().form.beforeShow),o&&o.hide()}},{key:"showSubDropdown",value:function(e,t){var n=null,o=null;if("filemenu"===t&&0===i.default.getMenuDisplayController().collapsedAt?(i.default.getRightToolButton().file.initDropdown(),n=i.default.getRightToolButton().file.dropdown,o=i.default.getRightToolButton().file.mainData.beforeShow):"editmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=1?(i.default.getRightToolButton().edit.initDropdown(),n=i.default.getRightToolButton().edit.dropdown,o=i.default.getRightToolButton().edit.mainData.beforeShow):"stylemenu"===t&&i.default.getMenuDisplayController().collapsedAt<=3?(i.default.getRightToolButton().style.initDropdown(),n=i.default.getRightToolButton().style.dropdown,o=i.default.getRightToolButton().style.mainData.beforeShow):"datamenu"===t&&i.default.getMenuDisplayController().collapsedAt<=4?(i.default.getRightToolButton().data.initDropdown(),n=i.default.getRightToolButton().data.dropdown,o=i.default.getRightToolButton().data.mainData.beforeShow):"smartmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=5?(i.default.getRightToolButton().smart.initDropdown(),n=i.default.getRightToolButton().smart.dropdown,o=i.default.getRightToolButton().smart.mainData.beforeShow):"insertmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=2?(i.default.getRightToolButton().insert.initDropdown(),n=i.default.getRightToolButton().insert.dropdown,o=i.default.getRightToolButton().insert.mainData.beforeShow):"formmenu"===t&&i.default.getMenuDisplayController().collapsedAt<=6&&(i.default.getRightToolButton().form.initDropdown(),n=i.default.getRightToolButton().form.dropdown,o=i.default.getRightToolButton().form.mainData.beforeShow),n){var a=document.querySelector('li[data-row-indentity="'+t+'"]');a.classList.add("li-dropdown-expanded");var r=a.getBoundingClientRect(),s=r.right+182<window.innerWidth;n.show({position:"fixed","z-index":1e3,top:r.top-5,left:s?r.right:r.left-182}),o&&o instanceof Function&&o(null,n)}}},{key:"afterDropdownHide",value:function(){this.mainData.getDropdownContent().forEach(function(e){e.extendHide instanceof Function&&e.extendHide()}),this.toolbarbutton.removeClass("toolbar-button-wrapper-checked")}},{key:"doOnClick",value:function(e){this.mainData.getDropdownContent().forEach(function(e){e.extendHide instanceof Function&&e.extendHide()})}},{key:"doOnMouseEnter",value:function(e,t,n){var o=this;this.subDropdowns[e];Object.keys(this.subDropdowns).forEach(function(e){o.subDropdowns[e].menuItemLevel&&o.subDropdowns[e].menuItemLevel>t&&o.hideSubDropdown(n||window.event,e)}),this.isInitSubdropdown(e)||this.initSubDropdown(e),this.showSubDropdown(n||window.event,e)}}]),t}();t.default=l},"./js/app/header/pc/right-menu/dropdown.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("./js/utils/ui/tooltip.js"),i=n("./js/utils/ui/dom.js"),a=n("./js/utils/user-agent.js"),r=n("./js/event/event-center.js"),s=0;t.default=function(e,t,n,l,d,c){var u=0,p=0,h=null,f=null,m=null,g={},w=null,v=e,b=null,_=null,y=!1,T=function(){t.find("li[data-row-indentity="+d+"]").focus();var e=(window.CoreSheet&&window.CoreSheet.header.rightMenu.buttonList)[c];e&&e.hideSubDropdown({},d)},E={getMyId:function(e){return e+"-"+u},updateDropdownOffet:function(e,t){$(h).offset({top:t,left:e})},setMyRowId:function(e,t){var n="li-dropdown-"+u+"-"+p++;e.attr("id",n),t&&(e.attr("data-row-indentity",t),g[t]="#"+n)},setAria:function(e,t){var n=t.content,o=n;t.hasSubMenu?o+="\u6309\u53f3\u7bad\u5934\u8fdb\u5165\u5b50\u83dc\u5355":d&&(o+=" \u6309\u5de6\u7bad\u5934\u56de\u5230\u7236\u83dc\u5355"),n&&(e.attr("role",t.hasSubMenu?"menu":"menuitem"),e.attr("aria-label",o),e.attr("init-label",o),e.attr("tabindex",3),e.attr("data-content",n))},changeAria:function(e,t){var n=e.attr("init-label");t?(e.attr("aria-label",n),e.attr("tabindex",3)):(e.removeAttr("aria-label"),e.removeAttr("tabindex"))},initMyId:function(){u=s++,h.attr("id",E.getMyId("dropdown-wrapper"))},isNormalImageContentTemplate:function(e){return"template-dropdown-image-content-row"==e||"template-dropdown-image-row"==e||"template-dropdown-content-row"==e},getNormalImageContentRowHtml:function(e,t){if(E.isNormalImageContentTemplate(t)){var n=$($("#"+t).html()),a=e.image,s=e.content,l=e.fontFamily,c=e.clickcallback,u=e.hover,p=e.disable,h=e.unclickable,f=e.textColor,m=e.iconClsName,g=e.contentClsName,w=e.mouseenterCallback,v=e.mouseleaveCallback,b=e.tipContent;if(!a&&!s&&!c)return;if(e.drawviewcallback)e.drawviewcallback(n,e);else{var _=$(n).find(".dropdown-img"),y=$(n).find(".dropdown-content");a?_.css("background-image","url("+a+")"):$(n).find(".dropdown-img img").hide(),s?y.append(s):y.hide(),g&&y.addClass(g),l&&y.css("font-family",l),f&&y.css("color",f),p&&y.css("opacity",.3),e.noVerticalPadding&&y.css({"padding-top":0,"padding-bottom":0}),b&&n.append('<div class="dropdown-tip-wrapper">'+b+"</div>"),u&&($(n).first("li.li-dropdown").attr("data-tooltip",u),(0,o.horizontalTooltip)($(n).first("li.li-dropdown"),{"min-width":66,left:10})),m&&_.addClass(m)}return!p&&c&&"function"==typeof c&&$(n).on("click",function(e){c(e)}),!p&&v&&"function"===typeof v&&$(n).bind("mouseleave",function(e){v(e)}),!p&&w&&"function"===typeof w&&$(n).bind("mouseenter",function(e){w(r.event)}),p||$(n).bind("keydown",function(e){13===e.keyCode?c&&"function"==typeof c&&c(e):39===e.keyCode?(e.isAria=!0,w&&"function"===typeof w&&w(e)):d&&37===e.keyCode&&T()}),h||(0,i.btnState)($(n),"","li-dropdown-hover","li-dropdown-clicked"),E.setMyRowId($(n),e.identity),E.setAria($(n),e),n}return null},updateText:function(e,t,n,o){var i=g[e];if(i){var a=f.find(i);a&&n&&$(a).attr(n,o),a&&$(a).find(".dropdown-c-content").text(t),a&&$(a).find(".dropdown-ic-content").text(t)}},showTipContent:function(e){var t=g[e];if(t){var n=f.find(t),o=n&&$(n).find(".dropdown-tip-wrapper");o&&$(o).css("display","block")}},hideTipContent:function(e){var t=g[e];if(t){var n=f.find(t),o=n&&$(n).find(".dropdown-tip-wrapper");o&&$(o).css("display","none")}},updateIdentityCSS:function(e,t,n){console.log("updateIdentityCSS");var o=g[e];if(o){var i=f.find(o);i&&t&&$(i).css(t,n)}},isCelltypeTemplate:function(e){return"template-dropdown-celltype-row"===e||"template-dropdown-separator-row"===e},getCelltypeRowHtml:function(e,t){if("template-dropdown-celltype-row"===t){var n=$($("#"+t).html()),a=e.title,r=e.detail,s=e.clickcallback,l=e.hover;if(!a||!s)return;return e.drawviewcallback?e.drawviewcallback(n,e):($(n).find(".dropdown-celltype-title").append(a),r?$(n).find(".dropdown-celltype-detail").append(r):$(n).find(".dropdown-celltype-detail").addClass("hidden"),l&&($(n).first("li.li-dropdown").attr("data-tooltip",l),(0,o.horizontalTooltip)($(n).first("li.li-dropdown"),{"min-width":66,left:-15}))),s&&"function"==typeof s&&$(n).on("click",function(e){s(e)}),(0,i.btnState)($(n),"","li-dropdown-hover","li-dropdown-clicked"),E.setMyRowId($(n),e.identity),E.setAria($(n),e),n}return"template-dropdown-separator-row"===t?(n=$($("#"+t).html()),e.noHorizontalPadding&&n.css({"padding-left":0,"padding-right":0}),n):null},isExtendableTemplate:function(e){return"template-dropdown-expendable-row"===e},getExtendableRowHtml:function(e,t){if("template-dropdown-expendable-row"!==t||!e)return null;var n=E.getNormalImageContentRowHtml(e,"template-dropdown-image-content-row");if(null===n)return n;var o=document.createDocumentFragment(),i=document.createElement("div");i.classList.add("dropdown-extend-wrapper");var a=document.createElement("div");if(a.classList.add("dropdown-extend"),a.classList.add(e.extendClsName||"toolbar-menu-button-dropdown"),e.extendClickCallback instanceof Function){i.classList.add("dropdown-extend-wrapper-clickable"),n.addClass("li-dropdown-extendable"),i.addEventListener("click",function(t){t.preventDefault(),t.stopPropagation(),e.extendClickCallback(t)},!0),n.append('<div class="dropdown-img-content-wrapper"></div>');var r=n.find(".dropdown-img-content-wrapper");n.find(".dropdown-img-wrapper")&&r.append(n.find(".dropdown-img-wrapper")),n.find(".dropdown-content-wrapper")&&r.append(n.find(".dropdown-content-wrapper"))}return i.appendChild(a),o.appendChild(i),n[0].appendChild(o),n},getRowTemplate:function(e){return e.template||(e.image||e.iconClsName)&&e.content&&"template-dropdown-image-content-row"||(e.image||e.iconClsName)&&!e.content&&"template-dropdown-image-row"||!(e.image||e.iconClsName)&&e.content&&"template-dropdown-content-row"||"template-dropdown-image-content-row"},getRowHtml:function(e){var t=E.getRowTemplate(e),n=null;return E.isCelltypeTemplate(t)?n=E.getCelltypeRowHtml(e,t):E.isNormalImageContentTemplate(t)?n=E.getNormalImageContentRowHtml(e,t):E.isExtendableTemplate(t)&&(n=E.getExtendableRowHtml(e,t)),n},disable:function(e){if(console.log("-----",e),e&&e instanceof Array)for(var t=0;t<e.length;t++){var n=e[t];g[n]&&($(g[n]).hasClass("disabled")||($(g[n]).addClass("disabled"),E.changeAria($(g[n]),!1)))}else e&&g[e]&&($(g[e]).hasClass("disabled")||($(g[e]).addClass("disabled"),E.changeAria($(g[e]),!1)))},isDisable:function(e){return!!g[e]&&$(g[e]).hasClass("disabled")},enable:function(e){if(e&&e instanceof Array)for(var t=0;t<e.length;t++){var n=e[t];g[n]&&$(g[n]).hasClass("disabled")&&($(g[n]).removeClass("disabled"),E.changeAria($(g[n]),!0))}else e&&g[e]&&($(g[e]).hasClass("disabled")||($(g[e]).addClass("disabled"),E.changeAria($(g[e]),!0)))},getLastStatus:function(){return w},setLastStatus:function(e){w=e},updateToolTip:function(e){if(e)for(var t in e)g[t]&&$(g[t]).attr("data-tooltip",e[t])},setAlignRight:function(e){y=e},hide:function(){E.isOpen()&&(h[0].removeAttribute("style"),h.removeClass("open"),_&&_())},show:function(o){if(E.isEnableOpenDropDown()){if(h.addClass("open"),E.setMaxHeight(),t){y?h.css("left",-f.outerWidth(!0)+t.outerWidth(!1)-1):t.children().first().offset().left+h.outerWidth(!0)<$(document.body).width()||t.children().first().outerWidth(!0)>=h.outerWidth(!0)||h.css("left",t.children().first().outerWidth(!0)-h.outerWidth(!0));var i=t.children().first().text().trim();i||((i=t.children().first().attr("identity"))&&-1!=i.indexOf("left")?i="\u5de6\u5bf9\u9f50":i&&-1!=i.indexOf("right")?i="\u53f3\u5bf9\u9f50":i&&-1!=i.indexOf("center")&&(i="\u5c45\u4e2d\u5bf9\u9f50"));var a=h.find("li.li-dropdown-selected");if(a&&a.removeClass("li-dropdown-selected"),i){var r=$(n).attr("identity");if(l&&r){var s=g[r];(u=h.find(s))&&0===u.find(".dropdown-no-selected").length&&(u.addClass("li-dropdown-selected"),E._scrollIfNeeded(u[0],h.find("div.dropdown-wrapper-box")[0]))}}for(var d in v)if(Object.hasOwnProperty.call(e,d)){var c=e[d];if("function"==typeof c.checkedcallback){s=g[c.identity];var u=h.find(s);c.checkedcallback(u)}"function"==typeof c.afterItemShow&&(s=g[c.identity],u=h.find(s),c.afterItemShow(u))}E.refreshSelItem(!0)}o&&h.css(o)}},setMaxHeight:function(){if(f){var e=$("header").height(),t=$(window).height()-e-75-m.height();f.css("max-height",t+"px")}},toggleDropDown:function(){h.hasClass("open")?E.hide():E.show()},isOpen:function(){return h.hasClass("open")},bodyclickhandler:function(e,t){$(e.target).parents("#web_header_tool_tabs_container").length>0||b&&!b(e)||E.hide()},registerEventListeners:function(){$("body").on("click",function(e){E.bodyclickhandler(e,t)}),$(window).on("resize",function(e){E.bodyclickhandler(e,t)}),h.on("touchstart",function(){a.isPad&&$("#padeditor").css("overflow","hidden")}),h.on("touchend",function(){a.isPad&&$("#padeditor").css("overflow","auto")}),window.addEventListener("closedropdown",function(e){E.bodyclickhandler(e,t)}),r.event.notificationCenter.listen("closedropdown",function(){b&&!b(document.createEvent("Event").initEvent("dropdown",!0,!0))||E.hide()}),h.on("mousedown",function(e){e.preventDefault()})},disableOpenDropDown:function(){$(t).addClass("dropdown-container-disabled"),E.hide()},enableOpenDropDown:function(){$(t).removeClass("dropdown-container-disabled")},isEnableOpenDropDown:function(){return!$(t).hasClass("dropdown-container-disabled")},init:function(e,t){if(h=$($("#template-dropdown-wrapper").html()),E.initMyId(),(f=$("<div></div>")).addClass("dropdown-wrapper-box"),h.append(f),d){var n=t.find("li[data-row-indentity="+d+"]").attr("data-content"),o=$('<div class="aria-hide aria-tips-'+d+'" role="alert" aria-lebal="\u5df2\u8fdb\u5165'+n+'\u5b50\u83dc\u5355" tabindex="3"></div>');o.on("keydown",function(e){37===e.keyCode&&T()}),h.prepend(o)}for(var i in(m=$("<div></div>")).addClass("dropdown-wrapper-menu"),h.append(m),t.append(h),e)if(Object.hasOwnProperty.call(e,i)){var a=e[i],r=E.getRowHtml(a);a.contentMenu?m.append($(r)):f.append($(r))}0==m.children().length&&m.css("display","none"),E.registerEventListeners(),$(window).on("resize",E.setMaxHeight)},_scrollIfNeeded:function(e,t){if(e&&t)if(e.offsetTop<t.scrollTop)t.scrollTop=e.offsetTop;else{var n=e.offsetTop+e.offsetHeight;n>t.scrollTop+t.offsetHeight&&(t.scrollTop=n-t.offsetHeight/2)}},refreshSelItem:function(e){if(t&&h.hasClass("open")&&E.isEnableOpenDropDown()){var o=t.children().first().text().trim();o||((o=t.children().first().attr("identity"))&&-1!=o.indexOf("left")?o="\u5de6\u5bf9\u9f50":o&&-1!=o.indexOf("right")?o="\u53f3\u5bf9\u9f50":o&&-1!=o.indexOf("center")&&(o="\u5c45\u4e2d\u5bf9\u9f50"));var i=$(n).attr("identity"),a=g[i],r=h.find(a);if(e||!r||!r.hasClass("li-dropdown-selected")){var s=h.find("li.li-dropdown-selected");s&&s.removeClass("li-dropdown-selected"),o&&l&&i&&r&&0===r.find(".dropdown-no-selected").length&&(h.find(a).addClass("li-dropdown-selected"),E._scrollIfNeeded(h.find(a)[0],h.find("div.dropdown-wrapper-box")[0]))}}},getWrapper:function(){return h},setBeforeHideCallback:function(e,t){b=e.bind(t)},setAfterHideCallback:function(e,t){_=e.bind(t)},getAfetrHideCallback:function(){return _},getDOMIdByIdentity:function(e){return g[e]}};return E.init(e,t),E}},"./js/app/header/pc/right-menu/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/ui/toolbar-html.js"),a=(n("./js/utils/util.js"),n("./js/utils/user-agent.js")),r=(p(n("./js/config/index.js")),n("./js/utils/ui/tooltip.js"),p(n("./js/app/header/pc/right-menu/right-menu-config.js"))),s=p(n("./js/app/header/pc/right-menu/ToolbarFileMenuButton.js")),l=p(n("./js/app/header/pc/right-menu/ToolbarMenuMoreButton.js")),d=p(n("./js/app/header/pc/right-menu/MenuDisplayController.js")),c=n("./js/app/spread-sheet/index.js"),u=n("./js/event/event-center.js");function p(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.showButton=["file","edit","style","insert","data","smart","form","more"],this.buttonList={}}return o(e,[{key:"removePlaceholder",value:function(){try{var e=document.querySelector(".menu-bg-pc-right");e&&e.remove()}catch(t){}}},{key:"init",value:function(){var e=this;$("#web_header_bottom").append((0,i.getDropdown)()),this.removePlaceholder(),$(".web_header_top").append(this.getHTML()),this.menuDisplayController=new d.default,this.showButton.forEach(function(t){e.buttonList[t]="more"===t?new l.default($("#"+e.getDomID(t)),e.getDropdownContent(t,"Main"),e.getDropdownContent(t,"Sub"),$("#toolbar-"+t+"-dropdown-group"),!1,t):new s.default($("#"+e.getDomID(t)),e.getDropdownContent(t,"Main"),e.getDropdownContent(t,"Sub"),$("#toolbar-"+t+"-dropdown-group"),!1,t)});for(var t=0;t<this.showButton.length;t++){var n=this.showButton[t],o=this.buttonList[n];this.bindMouseDown(n,o),this.bindMouseEnter(n,o),this.bindKeyDown(n,o)}this.enableAll(),$(window).on("networkOnline",function(){e.enableAll()}),$(window).on("networkOffline",function(){e.disableAll()}),u.event.default.listen("right-menu-enableAll",function(){e.enableAll()}),u.event.default.listen("right-menu-disableAll",function(){e.disableAll()})}},{key:"getHTML",value:function(){return"<span id='web_header_tool_tabs_container' class='hp-ui-button-group' data-type='insert'>\n            <span class=\"aria-hide\" aria-label=\"\u5df2\u5207\u6362\u5230\u83dc\u5355\u680f\" tabindex=\"3\"></span>\n            <span id='toolbar-file-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"filemenu",identity:"doc-file",iconContent:"\u6587\u4ef6",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-edit-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"editmenu",identity:"doc-edit",iconContent:"\u7f16\u8f91",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-insert-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"insertmenu",identity:"doc-insert",iconContent:"\u63d2\u5165",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-style-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"stylemenu",identity:"doc-style",iconContent:"\u683c\u5f0f",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-data-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"datamenu",identity:"doc-data",iconContent:"\u6570\u636e",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-smart-dropdown-group' class='toolbar-inline-block'}>\n            "+(0,i.getToolbarContentMenuButton)({id:"smartmenu",identity:"doc-smart",iconContent:"\u667a\u80fd\u5de5\u5177",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n            <span id='toolbar-form-dropdown-group' style=\"display:none;\" class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"formmenu",identity:"doc-form",iconContent:"\u6536\u96c6\u8868",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"</span>\n\n            <span id='toolbar-more-dropdown-group' class='toolbar-inline-block'>\n            "+(0,i.getToolbarContentMenuButton)({id:"moremenu",identity:"doc-more",iconContent:"\u66f4\u591a",stateClassName:"toolbar-button-wrapper-disabled",iconClassName:"toolbar-menu-button-content-insert"})+"\n            </span>\n        </span>"}},{key:"getRightToolButton",value:function(){return this.buttonList}},{key:"getMenuDisplayController",value:function(){return this.menuDisplayController}},{key:"firstUpperCase",value:function(e){return e.toLowerCase().replace(/^\S/g,function(e){return e.toUpperCase()})}},{key:"getDomID",value:function(e){return e+"menu"}},{key:"getDropdownContent",value:function(e,t,n){n=n||e,t=t||"Main";var o="get"+this.firstUpperCase(e)+"MenuItems"+t;return r.default[o]?r.default[o](n):null}},{key:"hasRightButtonDropdownShow",value:function(e){for(var t=Object.getOwnPropertyNames(this.buttonList),n=0;n<t.length;n++){var o=this.buttonList[t[n]];if(e!=o&&o&&o.isOpen()&&"none"!==$("#"+t[n]+"menu").css("display"))return o}return!1}},{key:"bindKeyDown",value:function(e,t){var n=this;$("#"+this.getDomID(e)).keydown(function(t){13!==t.keyCode&&40!==t.keyCode||$("#"+n.getDomID(e)).mousedown()})}},{key:"bindMouseDown",value:function(e,t){var n=this;$("#"+this.getDomID(e)).mousedown(function(e){if(t.isEnable()){var o=window.SpreadsheetApp.view.canvas.excel;3===o.tableData.tableStatus&&o.hideInput(),(0,c.hideCanvasCard)(),e.preventDefault?e.preventDefault():e.returnValue=!1;var i=n.hasRightButtonDropdownShow(t);i&&i.dropdown&&i.dropdown.hide();var a=document.createEvent("CustomEvent");a.initCustomEvent("closedropdown",!0,!0,{}),e.target.dispatchEvent(a),t.handle(e),$(".toolbar-new-feature-tip-new-big").remove()}})}},{key:"bindMouseEnter",value:function(e,t){var n=this;a.isPad||$("#"+this.getDomID(e)).on("mouseenter",function(e){if(t.isEnable()){var o=n.hasRightButtonDropdownShow(t);o&&(o.dropdown&&o.dropdown.hide(),o.afterDropdownHide(),t.handle(e))}})}},{key:"_operateAllBtn",value:function(e){for(var t in this.buttonList)if(this.buttonList.hasOwnProperty(t)){var n=this.buttonList[t];n&&n[e]&&"function"==typeof n[e]&&n[e]()}}},{key:"disableAll",value:function(){this._operateAllBtn("disable")}},{key:"enableAll",value:function(){this._operateAllBtn("enable")}}]),e}();t.default=new h},"./js/app/header/pc/right-menu/right-menu-config.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=g(n("./js/config/index.js")),a=n("./js/utils/user-agent.js"),r=n("./js/utils/browser.js"),s=g(n("./js/app/header/pc/right-menu/index.js")),l=g(n("./js/app/header/save-as-template.js")),d=n("./js/app/spread-sheet/index.js"),c=g(n("./js/app/quick-save/quick-save.js")),u=n("./js/app/header/util.js"),p=n("./js/app/export/utils.js"),h=g(n("./js/app/history/record-change.js")),f=n("./js/app/spread-sheet/index.js"),m=n("../node_modules/@tencent/tencent_doc_open_url/index.js");function g(e){return e&&e.__esModule?e:{default:e}}function w(e){T_SHEET.Report.tdwReport({opername:"doc_excel_editor",module:"excel_drop-menu",action:e})}window.recordChange=h.default;var v={create:"create",level_2_create:{create_doc:"create-doc",create_excel:"create-excel",create_ppt:"create-ppt",create_collect_table:"create-collect-table",import:"import",create_folder:"create-folder"},saveas_filemodel:"filemodel",export_as:"menu-export-as",level2_export_as:{exportas_local:"xlsx"},produce_backup:"menu-produce-backup",saveas_shortcut:"shortcut",rename:"rename",edit_history:"menu-show-edit-history",view_history:"menu-show-view-history",transfer:"transfer",impeach:"impeach",help:"help",feedback:"feedback",about:"about",doKeyframe:"doKeyframe",checkKeyframe:"checkKeyframe"},b={undo:"undo",redo:"redo",cut:"cut",copy:"copy",paste:"paste",select_all:"select_all",option_paste:"option_paste",level2_option_paste:{keep_origin_format:"keep_origin_format",merge_format:"merge_formate",paste_value:"paste_value",translate_row_coloumn:"translate_row_coloumn"},search_replace:"search_replace",del_row:"del_row",del_coloumn:"del_coloumn",empty_style:"empty_style",empty_data:"empty_data"},_={data_format:"data_format",format_painter:"format_painter",text_bold:"text_bold",text_italic:"text_italic",text_underline:"text_underline",text_strike:"text_strike",gridlines:"gridlines",merge:"merge",freeze:"freeze",level2_freeze:{freeze_first_row:"freeze_first_row",freeze_first_column:"freeze_first_line",freeze_window:"freeze_window",freeze_cancel:"freeze_cancel"},row_col_setting:"row_col_setting",level2_row_col_setting:{set_row_height:"set_row_height",autofit_row_height:"autofit_row_height",set_col_width:"set_col_width",default_col_width:"default_col_width",autofit_col_width:"autofit_col_width",autofit_rowcol:"autofit_rowcol"},conditional_formatting:"conditional_formatting"},y={insert_above:"insert_above",insert_bottom:"insert_bottom",insert_left:"insert_left",insert_right:"insert_right",insert_formula:"insert_formula",insert_image:"insert_image",insert_link:"insert_link"},T={data_filter:"data_filter",data_sort:"data_sort",level2_data_sort:{ascbyrange:"ascbyrange",desbyrange:"desbyrange",definerange:"definerange"},data_validation:"data_validation"},E={smart_form:"smart_form",smart_split:"smart_split",level2_smart:{smart_new_form:"smart_new_form",smart_convert_form:"smart_convert_form"}},C={form_check:"form_check",form_share:"form_share",form_result:"form_result",form_cancel:"form_cancel"},x={more_level1_form:"formmenu",more_level1_smart:"smartmenu",more_level1_data:"datamenu",more_level1_style:"stylemenu",more_level1_insert:"insertmenu",more_level1_edit:"editmenu",more_level1_file:"filemenu"},S=1,k=1,A=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"getFileMenuItemsMain",value:function(e){var t=[];return t.push({content:"\u65b0\u5efa",identity:e+v.create,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+v.create)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+v.create)}}),t.push({content:"\u4fdd\u5b58\u4e3a\u6211\u7684\u6a21\u677f",identity:e+v.saveas_filemodel,rowIconClsName:"toolbar-save-as-filemodel",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){l.default.show(),w("file_save")}}),t.push({content:"\u5bfc\u51fa\u4e3a",identity:e+v.export_as,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-export-as",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+v.export_as)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+v.export_as)}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u751f\u6210\u526f\u672c",identity:e+v.produce_backup,rowIconClsName:"toolbar-produce-backup",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,u.produce_backup)(),w("export_copy")}}),t.push({content:"\u751f\u6210\u672c\u5730\u5feb\u6377\u65b9\u5f0f",identity:e+v.saveas_shortcut,rowIconClsName:"toolbar-save-as-shortcut",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.location.href=c.default.createShortcut(),w("export_shortcut")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u67e5\u770b\u4fee\u8ba2\u8bb0\u5f55",identity:e+v.edit_history,rowIconClsName:"toolbar-show-edit-history",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.swReportStop&&window.swReportStop(),(0,d.getFormulaEditor)()&&(0,d.getFormulaEditor)().hide(),s.default.disableAll(),h.default.showRecordChange(),(0,u.hideReadRecord)(),(0,u.hideNotification)(),(0,u.hideAuth)(),(0,u.hideTemplate)(),w("clk_history")}}),(0,d.getPermission)().gEditable&&i.default.isOwner&&t.push({content:"\u67e5\u770b\u6d4f\u89c8\u8bb0\u5f55",identity:e+v.view_history,rowIconClsName:"toolbar-show-view-history",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,d.getFormulaEditor)()&&(0,d.getFormulaEditor)().hide(),(0,u.showReadRecord)(),h.default.hideRecordSide(),(0,u.hideNotification)(),(0,u.hideAuth)(),w("clk_revision_record")}}),t.push({content:"\u8f6c\u8ba9\u6587\u6863\u6240\u6709\u6743",identity:e+v.transfer,rowIconClsName:"toolbar-file-transfer",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,u.showTransferAuth)(),w("clk_transfer")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u91cd\u547d\u540d",identity:e+v.rename,rowIconClsName:"toolbar-file-rename",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){$("#padAloneTitle").focus(),w("clk_Renamed")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u5410\u4e2a\u69fd",identity:e+v.feedback,rowIconClsName:"toolbar-help-feedback",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,u.showSupportPage)(),w("clk_Renamed")}}),t.push({content:"\u5e2e\u52a9\u4e2d\u5fc3",identity:e+v.help,rowIconClsName:"toolbar-help-help",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){w("clk_help"),(0,m.tencentDocOpenUrl)("https://kf.qq.com/product/txwd.html")}}),t.push({content:"\u5173\u4e8e\u817e\u8baf\u6587\u6863",identity:e+v.about,rowIconClsName:"toolbar-help-about",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){w("clk_about"),(0,m.tencentDocOpenUrl)("https://docs.qq.com/doc/BqI21X2yZIht1Wa5TS2EGjbB05QQLU3t4SFA0D4QyU1D8UAQ0IQmKC2Cjyb92Epx2w1QB96n17FEoB312GIY0")}}),t.push({content:"\u4e3e\u62a5",identity:e+v.impeach,rowIconClsName:"toolbar-help-impeach",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,u.showUserReport)(),w("clk_report")}}),((0,r.getQuery)("showKey")||!1)&&(t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u68c0\u67e5\u5173\u952e\u5e27",identity:e+v.checkKeyframe,rowIconClsName:"toolbar-help-checkKeyframe",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){if(window.getInitialTableData&&"function"===typeof getInitialTableData){var e=window.getInitialTableData();(e?e.length:0)>1?alert("\u521d\u59cb\u6570\u636e\u5305\u542bactions\uff0c\u8868\u683c\u4e0d\u662f\u7eaf\u5173\u952e\u5e27\uff01\uff01\uff01"):alert("\u8868\u683c\u4e3a\u7eaf\u5173\u952e\u5e27\u8868\uff01")}else alert("\u8868\u683c\u52a0\u8f7d\u4e2d\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5!")}}),t.push({content:"\u5408\u6210\u5173\u952e\u5e27",identity:e+v.doKeyframe,rowIconClsName:"toolbar-help-doKeyframe",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.tools.dispatchKeyframe2Sheet(),setTimeout(function(){location.reload()},1e3)}})),{getDropdownContent:function(){return t},beforeShow:function(t,n){(0,d.getPermission)().gEditable?n.enable([e+v.export_as,e+v.produce_backup,e+v.rename,e+v.edit_history,e+v.view_history]):n.disable([e+v.export_as,e+v.produce_backup,e+v.rename,e+v.edit_history,e+v.view_history]),clientVars.isOwner||n.disable([e+v.transfer]),(0,d.getPermission)().gCopyable&&n.enable([e+v.export_as]),(a.isTencentDocApp||a.isPad)&&n.disable([e+v.export_as])}}}},{key:"getFileMenuItemsSub",value:function(e){var t={};return t[e+v.create]={getDropdownContent:function(t){var n=[];return n.push({content:"\u5728\u7ebf\u6587\u6863",identity:e+v.level_2_create.create_doc,hover:"",rowIconClsName:"toolbar-create-doc",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.openTemplateList)("doc"),w("new_doc")}}),n.push({content:"\u5728\u7ebf\u8868\u683c",identity:e+v.level_2_create.create_excel,hover:"",rowIconClsName:"toolbar-create-excel",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.openTemplateList)("sheet"),w("new_sheet")}}),n.push({content:"\u5728\u7ebf\u5e7b\u706f\u7247",identity:e+v.level_2_create.create_ppt,hover:"",rowIconClsName:"toolbar-create-ppt",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.openTemplateList)("slide"),w("new_sheet")}}),n.push({content:"\u5728\u7ebf\u6536\u96c6\u8868",identity:e+v.level_2_create.create_collect_table,hover:"",rowIconClsName:"toolbar-create-collect-table",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.openTemplateList)("form"),w("new_form")}}),n.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),n.push({content:"\u5bfc\u5165\u672c\u5730\u6587\u4ef6",identity:e+v.level_2_create.import,hover:"",rowIconClsName:"toolbar-import",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.import_local_file)(),w("new_inport")}}),n.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),n.push({content:"\u65b0\u5efa\u6587\u4ef6\u5939",identity:e+v.level_2_create.create_folder,hover:"",rowIconClsName:"",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,u.showNewFolder)(),w("new_folder")}}),n},created:function(e){},beforeHide:function(e,t){},beforeShow:function(e,t){},afterHide:function(e,t){},menuItemLevel:2},a.isTencentDocApp||a.isPad||(t[e+v.export_as]={getDropdownContent:function(t){var n=[];return n.push({content:"\u672c\u5730excel\u8868\u683c(.xlsx)",identity:e+v.level2_export_as.exportas_local,rowIconClsName:"toolbar-export-local",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),(0,p.exportSheetData)(),w("export_xlsx")}}),n},menuItemLevel:2}),t}},{key:"getEditMenuItemsMain",value:function(e){var t=[];return t.push({content:"\u64a4\u9500",identity:e+b.undo,tipContent:a.isMac?"Cmd+Z":"Ctrl+Z",rowIconClsName:"toolbar-undo",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.undo(),w("edit_undo")}}),t.push({content:"\u91cd\u505a",identity:e+b.redo,tipContent:a.isMac?"Cmd+Y":"Ctrl+Y",rowIconClsName:"toolbar-redo",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.redo(),w("edit_redo")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u526a\u5207",identity:e+b.cut,tipContent:a.isMac?"Cmd+X":"Ctrl+X",rowIconClsName:"toolbar-cut",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.plugins.copyPaste&&SpreadsheetApp.plugins.copyPaste.doCopy({copyType:1}),w("edit_cut")}}),t.push({content:"\u590d\u5236",identity:e+b.copy,tipContent:a.isMac?"Cmd+C":"Ctrl+C",rowIconClsName:"toolbar-copy",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.plugins.copyPaste&&SpreadsheetApp.plugins.copyPaste.doCopy({copyType:0}),w("edit_copy")}}),t.push({content:"\u7c98\u8d34",identity:e+b.paste,tipContent:a.isMac?"Cmd+V":"Ctrl+V",rowIconClsName:"toolbar-paste",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.doPaste(SpreadsheetApp),w("edit_paste")}}),t.push({content:"\u5168\u9009",identity:e+b.select_all,tipContent:a.isMac?"Cmd+A":"Ctrl+A",rowIconClsName:"toolbar-select-all",contentClsName:"toolbar-common-dropdown-select-all",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.view.canvas.excel.selectAll(),w("edit_select_all")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u67e5\u627e\u548c\u66ff\u6362",identity:e+b.search_replace,tipContent:a.isMac?"Cmd+F":"Ctrl+F",rowIconClsName:"toolbar-search-replace",contentClsName:"toolbar-common-dropdown-search-replace",clickcallback:function(){window.SpreadsheetApp&&window.SpreadsheetApp.view.plugins.searchReplacePanel&&window.SpreadsheetApp.view.plugins.searchReplacePanel.create(),w("edit_find&replace")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u5220\u9664\u6240\u5728\u884c",identity:e+b.del_row,rowIconClsName:"toolbar-del-row,",contentClsName:"toolbar-common-dropdown-del-row",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.deleteRows(),w("edit_delete_row")}}),t.push({content:"\u5220\u9664\u6240\u5728\u5217",identity:e+b.del_coloumn,rowIconClsName:"toolbar-del-coloumn",contentClsName:"toolbar-common-dropdown-del-coloumn",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.deleteColumns(),w("edit_delete_column")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u6e05\u9664\u683c\u5f0f",identity:e+b.empty_style,rowIconClsName:"toolbar-empty-style",contentClsName:"toolbar-common-dropdown-empty-style",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.clearFormat(),w("edit_clear_format")}}),t.push({content:"\u6e05\u9664\u5185\u5bb9",identity:e+b.empty_data,rowIconClsName:"toolbar-empty-data",contentClsName:"toolbar-common-dropdown-empty-data",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.clearContent(),window.SpreadsheetApp&&SpreadsheetApp.event.view.trigger("input_end"),w("edit_clear_content")}}),{getDropdownContent:function(){return t},beforeShow:function(n,o){if((0,f.hasSelect)()){if((0,d.getPermission)().gEditable){t.forEach(function(e){o.enable([e.identity])}),window.SpreadsheetApp&&SpreadsheetApp.behavior&&SpreadsheetApp.behavior.undoredoStack&&SpreadsheetApp.behavior.undoredoStack.undoStack.length>0||o.disable([e+b.undo]),window.SpreadsheetApp&&SpreadsheetApp.behavior&&SpreadsheetApp.behavior.undoredoStack&&SpreadsheetApp.behavior.undoredoStack.redoStack.length>0||o.disable([e+b.redo]);var i=SpreadsheetApp.plugins.copyPaste.copyPasteCache.getCacheState().valid,r=!!SpreadsheetApp.view.canvas.excel.selectData.pickShape;(a.isPad&&r||!i)&&o.disable([e+b.paste])}else t.forEach(function(e){o.disable([e.identity])}),o.enable([e+b.search_replace]);(0,d.getPermission)().gCopyable&&o.enable([e+b.copy])}else t.forEach(function(e){o.disable([e.identity])})}}}},{key:"getStyleMenuItemsMain",value:function(e){var t=window.SpreadsheetApp&&window.SpreadsheetApp.view,n=t&&t.canvas&&t.canvas.excel,o=t&&t.inputBox,i=[];return i.push({content:"\u6570\u636e\u683c\u5f0f",identity:e+_.data_format,rowIconClsName:"toolbar-data-format",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.view.plugins.customFormatPanel&&SpreadsheetApp.view.plugins.customFormatPanel.show(),w("format_data_format")}}),i.push({content:"\u683c\u5f0f\u5237",identity:e+_.format_painter,rowIconClsName:"toolbar-format-painter",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(e){window.SpreadsheetApp&&SpreadsheetApp.plugins.formatPainter&&("none"===SpreadsheetApp.plugins.formatPainter.getMode()?SpreadsheetApp.plugins.formatPainter.enter("single"):SpreadsheetApp.plugins.formatPainter.exit(),e&&e.stopPropagation());w("format_brush")}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u7c97\u4f53",identity:e+_.text_bold,rowIconClsName:"toolbar-text-bold",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=n&&n.tableData.inputStatus;if(1===e||2===e)n.tableInputBoardFormat("bold");else if(3===e){var t=o.getRange();n.toolbarInputFormat(t,"bold")}else{var i=SpreadsheetApp.utils.cell.cellIsBold(SpreadsheetApp);window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.fontBold&&SpreadsheetApp.behaviorApi.fontBold(!i),w("format_bold")}}}),i.push({content:"\u659c\u4f53",identity:e+_.text_italic,rowIconClsName:"toolbar-text-italic",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=n&&n.tableData.inputStatus;if(1===e||2===e)n.tableInputBoardFormat("italic");else if(3===e){var t=o.getRange();n.toolbarInputFormat(t,"italic")}else{var i=SpreadsheetApp.utils.cell.cellIsItalic(SpreadsheetApp);window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.fontItalics&&SpreadsheetApp.behaviorApi.fontItalics(!i),w("format_Italic")}}}),i.push({content:"\u4e0b\u5212\u7ebf",identity:e+_.text_underline,rowIconClsName:"toolbar-text-underline",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=n&&n.tableData.inputStatus;if(1===e||2===e)n.tableInputBoardFormat("underline");else if(3===e){var t=o.getRange();n.toolbarInputFormat(t,"underline")}else{var i=SpreadsheetApp.Model.Cell.Format.UNDERLINE_TYPE.SINGLE_LINE;window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.fontItalics&&SpreadsheetApp.behaviorApi.fontUnderLine(i),w("format_Underlined")}}}),i.push({content:"\u5220\u9664\u7ebf",identity:e+_.text_strike,rowIconClsName:"toolbar-text-strike",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=n&&n.tableData.inputStatus;if(1===e||2===e)n.tableInputBoardFormat("strikeThrough");else if(3===e){var t=o.getRange();n.toolbarInputFormat(t,"strikeThrough")}else{var i=SpreadsheetApp.utils.cell.cellIsStrikethrough(SpreadsheetApp);window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.fontStrike(!i),w("format_Delete_line")}}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u9690\u85cf\u7f51\u683c\u7ebf",identity:e+_.gridlines,rowIconClsName:"toolbar-gridlines",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=void 0;if(window.SpreadsheetApp&&SpreadsheetApp.spreadsheet&&SpreadsheetApp.spreadsheet.activeSheet&&(e=!SpreadsheetApp.spreadsheet.activeSheet.getHideGridlines()),void 0!==e){var t=window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel;t.hookFunc.setHideGridlines&&t.hookFunc.setHideGridlines(e),T_SHEET.Report.tdwReport({module:"doc_excel_editor",opername:"excel_style",action:e?"hide_grid_line":"unhide_grid_line"})}}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u5408\u5e76\u5355\u5143\u683c",identity:e+_.merge,rowIconClsName:"toolbar-merge",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&(SpreadsheetApp.utils.selection.hasMergeCell(SpreadsheetApp)?SpreadsheetApp.behaviorApi.unmergeCells():SpreadsheetApp.behaviorApi.mergeCells()),w("format_Merge_cell")}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u51bb\u7ed3",template:"template-dropdown-expendable-row",identity:e+_.freeze,rowIconClsName:"toolbar-view-freeze",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+_.freeze),w("Freeze_panel")},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+_.freeze)}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u884c\u9ad8\u5217\u5bbd",template:"template-dropdown-expendable-row",identity:e+_.row_col_setting,rowIconClsName:"toolbar-view-row_height_setting",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+_.row_col_setting)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+_.row_col_setting)}}),i.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),i.push({content:"\u6761\u4ef6\u683c\u5f0f",identity:e+_.conditional_formatting,rowIconClsName:"toolbar-conditional-format",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp.view.plugins.conditionalFormatPanel&&window.SpreadsheetApp.view.plugins.conditionalFormatPanel.show(),w("conditional_format")}}),{getDropdownContent:function(){return i},beforeShow:function(t,n){if((0,f.hasSelect)()){var o=window.SpreadsheetApp&&(!SpreadsheetApp.utils.selection.isMergeCell(SpreadsheetApp)&&SpreadsheetApp.utils.selection.singleRange(SpreadsheetApp)||SpreadsheetApp.utils.selection.isSelectedAll(SpreadsheetApp));SpreadsheetApp.utils.selection.hasMergeCell(SpreadsheetApp)?n.updateText(e+_.merge,"\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c"):n.updateText(e+_.merge,"\u5408\u5e76\u5355\u5143\u683c"),window.SpreadsheetApp&&SpreadsheetApp.spreadsheet&&SpreadsheetApp.spreadsheet.activeSheet&&(SpreadsheetApp.spreadsheet.activeSheet.getHideGridlines()?n.updateText(e+_.gridlines,"\u53d6\u6d88\u9690\u85cf\u7f51\u683c\u7ebf"):n.updateText(e+_.gridlines,"\u9690\u85cf\u7f51\u683c\u7ebf")),(0,d.getPermission)().gEditable?(i.forEach(function(e){n.enable([e.identity])}),o&&n.disable([e+_.merge])):i.forEach(function(t){n.disable([t.identity]),s.default.getRightToolButton()[e].hideSubDropdown(null,e+_.freeze)})}else i.forEach(function(e){n.disable([e.identity])})}}}},{key:"getStyleMenuItemsSub",value:function(e){var t={};return t[e+_.freeze]={getDropdownContent:function(){var t=[];return t.push({content:"\u51bb\u7ed3\u9996\u884c",identity:e+_.level2_freeze.freeze_first_row,hover:"",rowIconClsName:"toolbar-style-freeze-first-row",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.doFreeze(SpreadsheetApp,"firstRow"),w("format_Freeze_first_row")},mouseenterCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.firstRowFreezePreview(SpreadsheetApp)},mouseleaveCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.cancelFreezePreview(SpreadsheetApp)}}),t.push({content:"\u51bb\u7ed3\u9996\u5217",identity:e+_.level2_freeze.freeze_first_column,hover:"",rowIconClsName:"toolbar-style-freeze-first-column",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.doFreeze(SpreadsheetApp,"firstColumn"),w("format_Freeze_first_column")},mouseenterCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.firstColumnFreezePreview(SpreadsheetApp)},mouseleaveCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.cancelFreezePreview(SpreadsheetApp)}}),t.push({content:"\u51bb\u7ed3\u7a97\u683c",identity:e+_.level2_freeze.freeze_window,hover:"",rowIconClsName:"toolbar-style-freeze-window",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.doFreeze(SpreadsheetApp,"currentCell"),w("format_Freeze_pane")},mouseenterCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.freezePreview(SpreadsheetApp)},mouseleaveCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.cancelFreezePreview(SpreadsheetApp)}}),t.push({content:"\u53d6\u6d88\u51bb\u7ed3",identity:e+_.level2_freeze.freeze_cancel,hover:"",rowIconClsName:"toolbar-style-freeze-cancel",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.doFreeze(SpreadsheetApp,"cancelFreeze"),w("format_Unfreeze")}}),t},beforeShow:function(t,n){var o=window.SpreadsheetApp&&SpreadsheetApp.spreadsheet.activeSheet,i=o?o.getFrozenColCount():0,a=o?o.getFrozenRowCount():0;i="undefined"===typeof i?0:i;(a="undefined"===typeof a?0:a)<=0&&i<=0?n.disable([e+_.level2_freeze.freeze_cancel]):n.enable([e+_.level2_freeze.freeze_cancel]);var r=window.SpreadsheetApp&&SpreadsheetApp.utils.freeze.generateFreezeBtnText(SpreadsheetApp);n.updateText(e+_.level2_freeze.freeze_window,r)}},t[e+_.row_col_setting]={getDropdownContent:function(){var t=[];return t.push({content:"\u8bbe\u7f6e\u884c\u9ad8",identity:e+_.level2_row_col_setting.set_row_height,hover:"",rowIconClsName:"toolbar-style-set_row_height",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).showDialogForRowsColumnsSetting("ROW"),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_row_size"})}}),t.push({content:"\u81ea\u52a8\u8c03\u6574\u884c\u9ad8",identity:e+_.level2_row_col_setting.autofit_row_height,hover:"",rowIconClsName:"toolbar-style-autofit_row_height",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).setRowHeightColWidthAutoFit("ROW"),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_row_autosize"})}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u8bbe\u7f6e\u5217\u5bbd",identity:e+_.level2_row_col_setting.set_col_width,hover:"",rowIconClsName:"toolbar-style-set_row_height",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).showDialogForRowsColumnsSetting("COL"),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_size"})}}),t.push({content:"\u6062\u590d\u9ed8\u8ba4\u5217\u5bbd",identity:e+_.level2_row_col_setting.default_col_width,hover:"",rowIconClsName:"toolbar-style-set_row_height",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).setColWidthToDefault(),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_resize"})}}),t.push({content:"\u81ea\u52a8\u8c03\u6574\u5217\u5bbd",identity:e+_.level2_row_col_setting.autofit_col_width,hover:"",rowIconClsName:"toolbar-style-autofit_row_height",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).setRowHeightColWidthAutoFit("COL"),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_col_autosize"})}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u81ea\u52a8\u8c03\u6574\u884c\u9ad8\u5217\u5bbd",identity:e+_.level2_row_col_setting.autofit_rowcol,hover:"",rowIconClsName:"toolbar-style-autofit_rowcol",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(window.SpreadsheetApp&&window.SpreadsheetApp.view.canvas.excel).setRowHeightColWidthAutoFit("AUTO"),T_SHEET.Report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:"clk_menu_cr_autosize"})}}),t}},t}},{key:"getInsertMenuItemsMain",value:function(e){var t=[];return t.push({content:"\u5728\u4e0a\u65b9\u63d2\u51651\u884c",identity:e+y.insert_above,rowIconClsName:"toolbar-insert-above",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.view.canvas.excel.selectData.select.yRange[0];window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.insertRows([{index:e,amount:S}]),w("Insert_a1row")}}),t.push({content:"\u5728\u4e0b\u65b9\u63d2\u51651\u884c",identity:e+y.insert_bottom,rowIconClsName:"toolbar-insert-bottom",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.view.canvas.excel.selectData.select.yRange[0];window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.insertRows([{index:e+S,amount:S}]),w("Insert_b1row"),e+S>=SpreadsheetApp.view.canvas.excel.tableData.row.length-S&&SpreadsheetApp.view.canvas.excel.tableScroll({areaY:window.AlloyExcel.constant.TABLE_AREA.FLOW,diffY:SpreadsheetApp.view.canvas.excel.areaData.row.flow.offsetY-SpreadsheetApp.view.canvas.excel.areaData.row.flow.maxOffsetY})}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u5728\u5de6\u4fa7\u63d2\u51651\u5217",identity:e+y.insert_left,rowIconClsName:"toolbar-insert-left",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.view.canvas.excel.selectData.select.xRange[0];window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.insertColumns([{index:e,amount:k}]),w("Insert_l1column ")}}),t.push({content:"\u5728\u53f3\u4fa7\u63d2\u51651\u5217",identity:e+y.insert_right,rowIconClsName:"toolbar-insert-right",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.view.canvas.excel.selectData.select.xRange[0];window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.insertColumns([{index:e+k,amount:k}]),w("Insert_r1column "),e+k>=SpreadsheetApp.view.canvas.excel.tableData.col.length-k&&SpreadsheetApp.view.canvas.excel.tableScroll({areaX:window.AlloyExcel.constant.TABLE_AREA.FLOW,diffX:SpreadsheetApp.view.canvas.excel.areaData.col.flow.offsetX-SpreadsheetApp.view.canvas.excel.areaData.col.flow.maxOffsetX})}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u51fd\u6570",identity:e+y.insert_formula,rowIconClsName:"toolbar-insert-formula",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){(0,d.getFormulaEditor)()&&(0,d.getFormulaEditor)().show(),w("Insert_function")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u56fe\u7247",identity:e+y.insert_image,rowIconClsName:"toolbar-insert-link",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){SpreadsheetApp.behaviorApi.insertImage(),w("Insert_picture")}}),t.push({content:"\u94fe\u63a5",identity:e+y.insert_link,rowIconClsName:"toolbar-insert-link",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.behaviorApi.insertLink(),w("Insert_url")}}),a.isPad||t.push({content:"\u6279\u6ce8",identity:e+y.insert_comment,rowIconClsName:"toolbar-insert-comment",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){try{if(!window.SpreadsheetApp)return console.error("SpreadsheetApp undefined");var e=SpreadsheetApp.view.canvas.plugins.cardCenter;e&&(e.addComment(),T_SHEET.Report.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"meno_add"}))}catch(t){console.error(t)}}}),{getDropdownContent:function(){return t},beforeShow:function(n,o){if((0,f.hasSelect)()){var i=SpreadsheetApp.view.canvas.excel.selectData.select;i&&(S=i.yRange[1]-i.yRange[0]+1,k=i.xRange[1]-i.xRange[0]+1,o.updateText(e+y.insert_above,"\u5728\u4e0a\u65b9\u63d2\u5165"+S+"\u884c"),o.updateText(e+y.insert_bottom,"\u5728\u4e0b\u65b9\u63d2\u5165"+S+"\u884c"),o.updateText(e+y.insert_left,"\u5728\u5de6\u4fa7\u63d2\u5165"+k+"\u5217"),o.updateText(e+y.insert_right,"\u5728\u53f3\u4fa7\u63d2\u5165"+k+"\u5217"),o.enable([e+y.insert_above,e+y.insert_bottom,e+y.insert_left,e+y.insert_right])),(0,d.getPermission)().gEditable?(t.forEach(function(e){o.enable([e.identity])}),i&&(i.selectCol&&o.disable([e+y.insert_above,e+y.insert_bottom]),i.selectRow&&o.disable([e+y.insert_left,e+y.insert_right])),(0,f.isSelectSingleCell)()?o.enable([e+y.insert_comment]):o.disable([e+y.insert_comment])):t.forEach(function(e){o.disable([e.identity])})}else t.forEach(function(e){o.disable([e.identity])})}}}},{key:"getDataMenuItemsMain",value:function(e){var t=[];return t.push({content:"\u7b5b\u9009",identity:e+T.data_filter,rowIconClsName:"toolbar-data-filter",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&SpreadsheetApp.utils.cell.hasBasicFilter(SpreadsheetApp)?window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.clearBasicFilter():window.SpreadsheetApp&&SpreadsheetApp.behaviorApi&&SpreadsheetApp.behaviorApi.setBasicFilter(),w("data_filter")}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u6392\u5e8f",identity:e+T.data_sort,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-data-sort",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+T.data_sort),w("data_sort")},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+T.data_sort)}}),t.push({template:"template-dropdown-separator-row",identity:"template-dropdown-separator-row"}),t.push({content:"\u6570\u636e\u9a8c\u8bc1",tipContent:"\u5df2\u5f00\u542f",identity:e+T.data_validation,rowIconClsName:"toolbar-data-validation",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){window.SpreadsheetApp&&window.SpreadsheetApp.view.plugins.dataValidationPanel&&window.SpreadsheetApp.view.plugins.dataValidationPanel.create()}}),{getDropdownContent:function(){return t},beforeShow:function(n,o){window.SpreadsheetApp&&window.SpreadsheetApp.tools&&window.SpreadsheetApp.tools.isActiveCellContainDV()?o.showTipContent(e+T.data_validation):o.hideTipContent(e+T.data_validation),(0,f.hasSelect)()&&(0,d.getPermission)().gEditable&&(0,f.hasSelect)()?(t.forEach(function(e){o.enable([e.identity])}),window.SpreadsheetApp&&SpreadsheetApp.utils.cell.hasBasicFilter(SpreadsheetApp)?o.updateText(e+T.data_filter,"\u53d6\u6d88\u7b5b\u9009"):o.updateText(e+T.data_filter,"\u7b5b\u9009")):t.forEach(function(e){o.disable([e.identity])})}}}},{key:"getDataMenuItemsSub",value:function(e){var t={};return t[e+T.data_sort]={getDropdownContent:function(t){var n=[];return n.push({content:"\u5347\u5e8f",identity:e+T.level2_data_sort.ascbyrange,hover:"",rowIconClsName:"toolbar-data-sort-ascbyrange",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.sort.doSort(SpreadsheetApp,"ascbyrange"),w("sort_ascending_range")},mouseenterCallback:function(){var e=window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.excel,t=e.selectData.select,n=e.selectData.active,o=[n.xIndex,n.xIndex],i=[t.yRange[0],t.yRange[1]];e.showSortAreaOverlay(o,i)},mouseleaveCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.excel&&SpreadsheetApp.view.canvas.excel.hideSortAreaOverlay()}}),n.push({content:"\u964d\u5e8f",identity:e+T.level2_data_sort.desbyrange,hover:"",rowIconClsName:"toolbar-data-sort-desbyrange",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.sort.doSort(SpreadsheetApp,"desbyrange"),w("sort_descending_range")},mouseenterCallback:function(){var e=window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.excel,t=e.selectData.select,n=e.selectData.active,o=[n.xIndex,n.xIndex],i=[t.yRange[0],t.yRange[1]];e.showSortAreaOverlay(o,i)},mouseleaveCallback:function(){window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.excel&&SpreadsheetApp.view.canvas.excel.hideSortAreaOverlay()}}),n.push({content:"\u81ea\u5b9a\u4e49\u6392\u5e8f",identity:e+T.level2_data_sort.definerange,hover:"",rowIconClsName:"toolbar-data-sort-desbyrange",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.utils.sort.doSort(SpreadsheetApp,"definerange"),w("custom_range")}}),n},menuItemLevel:2},t}},{key:"getSmartMenuItemsMain",value:function(e){var t=[];return clientVars.isCreator&&t.push({content:"\u521b\u5efa\u6536\u96c6\u8868",identity:e+E.smart_form,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-smart-form",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t,e+E.smart_form)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t,e+E.smart_form)}}),t.push({content:"\u667a\u80fd\u5206\u5217",identity:e+E.smart_split,rowIconClsName:"toolbar-smart-split",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,clickcallback:function(e){T_SHEET.Report.jank.log({moduleValue:"smartSplit",actionValue:"calc"}),SpreadsheetApp.plugins.smartSplit.isSupportSmartSplit()?SpreadsheetApp.plugins.smartSplit.doManualSmartSplit():SpreadsheetApp.plugins.smartSplit.showSplitGuideDialog(),w("smart_tool_split")}}),{getDropdownContent:function(){return t},beforeShow:function(t,n){var o=SpreadsheetApp.plugins.rmap;o&&o.getRelatedNumber&&o.getRelatedNumber()||o&&o.isOpenDialog()?n.disable([e+E.smart_form]):n.enable([e+E.smart_form]),(0,d.getPermission)().gEditable?n.enable([e+E.smart_split]):n.disable([e+E.smart_split])}}}},{key:"getSmartMenuItemsSub",value:function(e){var t={};return t[e+E.smart_form]={getDropdownContent:function(){var t=[];return t.push({content:"\u57fa\u4e8e\u5de5\u4f5c\u8868\u5185\u5bb9\u521b\u5efa",identity:e+E.level2_smart.smart_convert_form,hover:"",rowIconClsName:"toolbar-smart-convertform",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.plugins.rmap&&SpreadsheetApp.plugins.rmap.handle("convert_to_form")}}),t.push({content:"\u521b\u5efa\u7a7a\u767d\u6536\u96c6\u8868",identity:e+E.level2_smart.smart_new_form,hover:"",rowIconClsName:"toolbar-smart-newform",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){s.default.getRightToolButton()[e].doSubClick(),window.SpreadsheetApp&&SpreadsheetApp.plugins.rmap&&SpreadsheetApp.plugins.rmap.handle("new_to_form")}}),t},created:function(e){},beforeHide:function(e,t){},beforeShow:function(e,t){},afterHide:function(e,t){},menuItemLevel:2},t}},{key:"getFormMenuItemsMain",value:function(e){var t=[{content:"\u67e5\u770b\u6536\u96c6\u8868",identity:e+C.form_check,rowIconClsName:"toolbar-form-check",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.plugins.rmap;e.handle("check_form",e.getRelatedSheetId())}},{content:"\u5206\u4eab\u6536\u96c6\u8868",identity:e+C.form_share,rowIconClsName:"toolbar-form-share",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.plugins.rmap;e.handle("share_form",e.getRelatedSheetId())}},{content:"\u67e5\u770b\u6536\u96c6\u7ed3\u679c\u6458\u8981",identity:e+C.form_result,rowIconClsName:"toolbar-form-result",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.plugins.rmap;e.handle("result_form",e.getRelatedSheetId())}}];return clientVars.isCreator&&t.push({content:"\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868",identity:e+C.form_cancel,rowIconClsName:"toolbar-form-cancel",contentClsName:"toolbar-common-dropdown-content",clickcallback:function(){var e=SpreadsheetApp.plugins.rmap;e.handle("cancel_form",e.getRelatedSheetId())}}),{getDropdownContent:function(){return t}}}},{key:"getMoreMenuItemsMain",value:function(e){var t=[];return t.push({content:"\u6587\u4ef6",identity:x.more_level1_file,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_file)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_file)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>0?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u7f16\u8f91",identity:x.more_level1_edit,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_edit)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_edit)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>1?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u63d2\u5165",identity:x.more_level1_insert,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_insert)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_insert)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>2?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u683c\u5f0f",identity:x.more_level1_style,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_style)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_style)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>3?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u6570\u636e",identity:x.more_level1_data,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_data)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_data)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>4?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u667a\u80fd\u5de5\u5177",identity:x.more_level1_smart,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_smart)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_smart)},afterItemShow:function(e){s.default.getMenuDisplayController().collapsedAt>5?e.css("display","none"):e.css("display","block")}}),t.push({content:"\u6536\u96c6\u8868",identity:x.more_level1_form,template:"template-dropdown-expendable-row",rowIconClsName:"toolbar-file-create",contentClsName:"toolbar-common-dropdown-content",preventHideDropdown:!0,extendShow:function(t){s.default.getRightToolButton()[e].showSubDropdown(t||window.event,x.more_level1_form)},extendHide:function(t){s.default.getRightToolButton()[e].hideSubDropdown(t||window.event,x.more_level1_form)},afterItemShow:function(e){var t=window.SpreadsheetApp,n=t&&t.plugins&&t.plugins.rmap;s.default.getMenuDisplayController().collapsedAt>6||n&&n.getRelatedNumber()<=0?e.css("display","none"):e.css("display","block")}}),{getDropdownContent:function(){return t},beforeShow:function(e,t){}}}},{key:"getMoreMenuItemsSub",value:function(){return null}}]),e}();t.default=new A},"./js/app/header/save-as-template.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SaveTemplate=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js"),a=n("./js/utils/browser.js"),r=n("./js/component/toast/index.js"),s=n("./js/app/header/util.js"),l=n("./js/config/sheet.js");var d=t.SaveTemplate=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasInited=!1,this.$wrapper=null,this.$btnConfirm=null,this.$btnCancel=null,this.$wmText=null,this.$errorText=null,this.maxString=null,this.spanText=null,this.$dialog=null,this.$colse=null,this.isDialogShowing=null}return o(e,[{key:"_init",value:function(){i.isPad?this.$wrapper=$('<div class="tim-component" style="display: block;"><div class="content-dialog-iPad rename-dialog" style="width: 376px; height: 200px;"><div class="content-dialog-header"><p class="content-dialog-title">\u4fdd\u5b58\u4e3a\u6211\u7684\u6a21\u677f</p><button class="content-dialog-close"></button></div><div class="content-dialog-content"><input type="text" class="pad-ui-input-template" value="" maxlength="255"><span class="npq pad-rename-err"><span class=" pad-rename-err-icon"></span><span class="pad-rename-err-text"></span></span></div><div class="content-dialog-footer"><button class="tim-btn-t tim-btn-white-t content-dialog-btn-cancel-t">\u53d6\u6d88</button><button class="tim-btn-t tim-btn-blue-t content-dialog-btn-confirm-t">\u786e\u5b9a</button></div></div></div>'):this.$wrapper=$('<div class="tim-component" style="display: block;"><div class="content-dialog rename-dialog" style="width: 376px; height: 200px;"><div class="content-dialog-header"><p class="content-dialog-title">\u4fdd\u5b58\u4e3a\u6211\u7684\u6a21\u677f</p><button class="content-dialog-close"></button></div><div class="content-dialog-content"><input type="text" class="pad-ui-input-template" value="" maxlength="255"><span class="npq pad-rename-err"><span class=" pad-rename-err-icon"></span><span class="pad-rename-err-text"></span></span></div><div class="content-dialog-footer"><button class="tim-btn-t tim-btn-white-t content-dialog-btn-cancel-t">\u53d6\u6d88</button><button class="tim-btn-t tim-btn-blue-t content-dialog-btn-confirm-t">\u786e\u5b9a</button></div></div></div>'),this.$wrapper.appendTo(document.body),this.$wmText=this.$wrapper.find(".pad-ui-input-template"),this.$errorText=this.$wrapper.find(".pad-rename-err"),this.$spanText=this.$wrapper.find(".pad-rename-err-text"),this.$btnCancel=this.$wrapper.find(".content-dialog-btn-cancel-t"),this.$btnConfirm=this.$wrapper.find(".content-dialog-btn-confirm-t"),this.$dialog=this.$wrapper.find(".content-dialog"),this.$colse=this.$wrapper.find(".content-dialog-close"),this.$errorText.hide(),this.$wmText.removeClass("pad-ui-input-error-Template"),this.$btnConfirm.addClass("pad-ui-btn-disable-t")}},{key:"_filterTitleVal",value:function(e){return(e.match(/(:|\uff1a|\*|\\|\/|<|>|"|\?|\||(\ud83c[\udf00-\udfff])|(\ud83d[\udc00-\ude4f])|(\ud83d[\ude80-\udeff]))/,"ig")||[]).length}},{key:"_hasEmojiCharacter",value:function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t);if(console.log(n),55296<=n&&n<=56319){if(e.length>1){var o=1024*(n-55296)+(e.charCodeAt(t+1)-56320)+65536;if(118784<=o&&o<=128895)return!0;if(129311<=o&&o<=129311)return!0;if(129320<=o&&o<=129327)return!0;if(129329<=o&&o<=129330)return!0;if(129356<=o&&o<=129356)return!0;if(129375<=o&&o<=129375)return!0;if(129376<=o&&o<=129387)return!0;if(129426<=o&&o<=129431)return!0;if(129504<=o&&o<=129510)return!0;if(129488<=o&&o<=129491)return!0}}else if(e.length>1){if(8419==e.charCodeAt(t+1))return!0}else{if(8448<=n&&n<=10239)return!0;if(11013<=n&&n<=11015)return!0;if(10548<=n&&n<=10549)return!0;if(12951<=n&&n<=12953)return!0;if(169==n||174==n||12349==n||12336==n||11093==n||11036==n||11035==n||11088==n)return!0}if(9786==n||10084==n||9757==n||9996==n||9994==n||9995==n)if(e.length>t)if(65039==e.charCodeAt(t+1))return!0}}},{key:"_getStrBytes",value:function(e){var t,n,o=0,i=0;for(i=0,n=e.length;i<n;i++)o+=(t=e.charCodeAt(i))<=127?1:t<=2047?2:t<=65535?3:4;return o}},{key:"_getSubStr_36Bytes",value:function(e){var t,n,o=0,i=0;for(i=0,n=e.length;i<n&&!((o+=(t=e.charCodeAt(i))<=127?1:t<=2047?2:t<=65535?3:4)>36);i++);return e.substring(0,i)}},{key:"_docomfrim",value:function(){var e=this;if(!this.$btnConfirm.hasClass("pad-ui-btn-disable-t")){var t=this._getFormValue();this.hide();try{T_SHEET.Report.tdwReport({opername:"doc_oper",module:"templet_receive",action:"save_detail"})}catch(n){}$.ajax({url:"https://docs.qq.com/cgi-bin/template/mytemplate_add",type:"POST",data:{domain_id:clientVars.domainId,pad_id:clientVars.padId,title:t.text,xsrf:(0,a.getXsrf)()},xhrFields:{withCredentials:!0},success:function(t){t&&0===t.retcode?(e.$wmText.val(""),(0,r.showToast)("\u6a21\u677f\u4fdd\u5b58\u6210\u529f\uff0c\u5728[\u65b0\u5efa-\u6211\u7684\u6a21\u677f]\u4e2d\u67e5\u770b\u3002",{zIndex:999999},{toastType:"typeSuccess",linkTitle:"\u67e5\u770b",toolToastCloseTime:5e3,linkCallback:function(){(0,s.openTemplateList)("my")}})):this.error(t?{retcode:t.retcode}:void 0)},error:function(e){e=e||{},console.log(e);var t="\u7f51\u7edc\u5f02\u5e38\uff0c\u4fdd\u5b58\u6a21\u677f\u5931\u8d25";42114==e.retcode?t="\u6587\u4ef6\u5927\u4e8e100KB\uff0c\u6682\u4e0d\u652f\u6301\u4fdd\u5b58\u4e3a\u6a21\u677f":42113==e.retcode?t="\u6a21\u677f\u5df2\u8fbe\u4e0a\u9650\uff0c\u4fdd\u5b58\u6a21\u677f\u5931\u8d25":42112==e.retcode&&(t="\u6682\u65e0\u6743\u9650\u8bbf\u95ee\u6587\u6863\uff0c\u4fdd\u5b58\u6a21\u677f\u5931\u8d25"),(0,r.showToast)(t,{zIndex:999999},{isWarnning:!0,toolToastCloseTime:5e3})}})}}},{key:"_bindEvents",value:function(){var e=this,t=this;this.$btnCancel.click(function(){e.hide(),e.$wmText.val(""),e.$spanText.text(""),e.$errorText.hide(),e.$wmText.removeClass("pad-ui-input-error-Template")}),this.$colse.click(function(){e.hide(),e.$wmText.val(""),e.$spanText.text(""),e.$errorText.hide(),e.$wmText.removeClass("pad-ui-input-error-Template"),e.$btnConfirm.addClass("pad-ui-btn-disable-t")}),this.$btnConfirm.click(function(){e._docomfrim(),e.$btnConfirm.addClass("pad-ui-btn-disable-t")}),$(document).keydown(function(t){13===t.keyCode&&e.isDialogShowing&&e._docomfrim()});this.$wmText.on("input",function(){(function(){var e=t.$wmText.val();t._getStrBytes(e)>36?(t.$wmText.val(t.maxString),t.$errorText.show()):(t.maxString=e,t.$spanText.text(""),t.$btnConfirm.removeClass("pad-ui-btn-disable-t"),t.$wmText.addClass("pad-ui-input-error-Template "),t.$errorText.hide(),t.$wmText.removeClass("pad-ui-input-error-Template"),t._filterTitleVal(e)||t._hasEmojiCharacter(e)?(t.$spanText.text("\u6a21\u677f\u540d\u79f0\u975e\u6cd5"),t.$errorText.show(),t.$btnConfirm.addClass("pad-ui-btn-disable-t"),t.$wmText.addClass("pad-ui-input-error-Template")):(0==e.length?t.$btnConfirm.addClass("pad-ui-btn-disable-t"):t.$btnConfirm.removeClass("pad-ui-btn-disable-t"),t.$spanText.text(""),t.$errorText.hide(),t.$wmText.removeClass("pad-ui-input-error-Template")))})()}),t.$wrapper.on("touchmove",function(e){e.stopPropagation(),e.preventDefault()})}},{key:"_getFormValue",value:function(){return{text:this.$wmText.val().trim()}}},{key:"show",value:function(){var e=this;this.hasInited||(this._init(),this._bindEvents(),this.hasInited=!0),this.$wmText.val(this._getSubStr_36Bytes((0,l.getTitle)())),this.$btnConfirm.removeClass("pad-ui-btn-disable-t"),this.$wrapper.show(),this.$errorText.hide(),setTimeout(function(){e.$wmText.focus()},100),i.isIOS?this.$wmText.focus():setTimeout(function(){e.$wmText.focus().click();var t=e.$wmText.val();e.$wmText.val(""),e.$wmText.val(t)},100),this.isDialogShowing=!0;var t=this.$wmText.val();if(this._filterTitleVal(t)||this._hasEmojiCharacter(t))return this.$spanText.text("\u6a21\u677f\u540d\u79f0\u975e\u6cd5"),this.$errorText.show(),this.$btnConfirm.addClass("pad-ui-btn-disable-t"),void this.$wmText.addClass("pad-ui-input-error-Template");0==t.length?this.$btnConfirm.addClass("pad-ui-btn-disable-t"):this.$btnConfirm.removeClass("pad-ui-btn-disable-t"),this.$spanText.text(""),this.$errorText.hide(),this.$wmText.removeClass("pad-ui-input-error-Template")}},{key:"hide",value:function(){this.$wrapper.hide(),this.isDialogShowing=!1}}]),e}();t.default=new d},"./js/app/header/share.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/type.js"),a=n("./js/config/index.js"),r=n("./js/utils/browser.js"),s=n("./js/utils/wx.js"),l=n("./js/utils/user-agent.js"),d=n("./js/config/sheet.js");var c=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.setDocxShareInfo=null,this.shareInfoHasInit=!1,this.shareImageData=null}return o(e,[{key:"init",value:function(){var e=this;(l.isMobile||l.isPad)&&$.get("https://docs.qq.com/cgi-bin/online_docs/doc_info?domainId="+clientVars.domainId+"&localPadId="+clientVars.localPadId+"&getCollected=1&getIsAddedMy=1",function(t,n,o){if("success"===n&&t.doc_meta){console.log(t);var i={docType:t.doc_meta.doc_type,createTime:1e3*t.doc_meta.create_ts,ownerName:t.owner_nick,ownerAvatar:t.owner_avatar,isCollected:t.is_collected,isAddedMy:t.is_added_my};(0,d.setSheetDocInfo)(i),e.generateShareImage(i,function(t){0===t.retcode&&(e.shareImageData=t.imageData)}),window.SLR&&window.SLR.dispatch("GET_DOCINFO_SUCCESS")}else console.log("get docInfo failed")})}},{key:"generateShareImage",value:function(e,t){var n={0:"https://pub.idqqimg.com/pc/misc/files/20180625/239f920a5dd142678a212987c46c4f3e.png",1:"https://pub.idqqimg.com/pc/misc/files/20180625/cab254c834f24c92b70921f070362f05.png"}[e.docType],o=e.ownerAvatar,a=e.ownerName,r=new Date(e.createTime);(0,i.isNull)(document.getElementById("containerShareMP"))&&$("body").append('<div id="containerShareMP" hidden="hidden" ><img id="shareBackImageMP" hidden="hidden" crossOrigin="Anonymous"><img id="shareOwnerAvatarMP" hidden="hidden" crossOrigin="Anonymous"><br><canvas id="shareCanvasMP" hidden="hidden" width="420" height="336"></canvas ></div>');var s=function(){var e=document.getElementById("shareCanvasMP"),n=e.getContext("2d"),o=document.getElementById("shareBackImageMP");n.drawImage(o,0,0,420,336),n.save(),n.beginPath(),n.arc(55,282,30,0,2*Math.PI),n.clip(),o=document.getElementById("shareOwnerAvatarMP"),n.drawImage(o,25,252,60,60),n.restore(),n.fillStyle="#000000",n.font="24px Arial";var i=a;if(n.measureText(i).width>290){i.length>60&&(i=i.substr(0,60));for(var s=n.measureText(i+"...").width;s>290;){var l=(s-290)/24;l=l>1?l:1,i=i.substr(0,i.length-l),s=n.measureText(i+"...").width}i+="..."}n.fillText(i,99,272);var d=function(e){return e<10?"0"+e:String(e)},c="";c=(new Date).getFullYear()===r.getFullYear()?String(d(r.getMonth()+1))+"-"+d(r.getDate())+" "+d(r.getHours())+":"+d(r.getMinutes()):String(r.getFullYear())+"-"+d(r.getMonth()+1)+"-"+d(r.getDate()),n.fillStyle="#888888",n.font="22px Arial",n.fillText("\u521b\u5efa\u4e8e "+c,99,308),console.log("output png"),t&&t({retcode:0,imageData:e.toDataURL()}),$("#containerShareMP").remove()},l=!1,d=!1;$("#shareBackImageMP").on("load",function(e){l=!0,d&&s()}),$("#shareBackImageMP").on("error",function(e){}),$("#shareOwnerAvatarMP").on("load",function(e){d=!0,l&&s()}),$("#shareOwnerAvatarMP").on("error",function(e){$("#shareOwnerAvatarMP").attr("src","https://pub.idqqimg.com/pc/misc/files/20180524/234e0427916041a1b4967881634c4d8b.png")}),$("#shareBackImageMP").attr("src",n),$("#shareOwnerAvatarMP").attr("src",o)}},{key:"setShareInfo",value:function(){var e=this;this.setDocxShareInfo||(this.setDocxShareInfo=function(){var t={},n=e;t.share_url=e.getShareUrl()||window.location.href.split("#")[0],e.shareInfoHasInit,t.title=(0,d.getTitle)(),t.source_name="\u817e\u8baf\u6587\u6863",t.isCreator=clientVars.isCreator,t.image_url="https://pub.idqqimg.com/pc/misc/files/20190529/32e36b5d6f1b71fd3ddd129346c8f9c9.png",t.miniprogram_image_url="https://pub.idqqimg.com/pc/misc/files/20180410/5349bc325950481ebde04c38208d9028.png",t.type="sheet",t.desc="\u817e\u8baf\u6587\u6863-\u5728\u7ebf\u8868\u683c",n.shareImageData&&(t.miniprogram_image_url=n.shareImageData),l.isAndroid&&(t.singleLineTitle=t.title),t.rightFlag=clientVars.rightFlag,t.policy=clientVars.policy;var o=(0,a.getConfig)();t.editable=o.gEditable,e.shareInfoHasInit||(t.isNewCreate=clientVars.newPad);var i=(0,r.getQuery)("group_code");i&&(t.groupCode=i);var c=window.clientVars.globalPadId;if(c){var u=c.indexOf("$");t.domainId=c.slice(0,u),t.localPadId=c.slice(u+1,c.length)}t.contentEdited=window.isContentEditedToNativeSend||!1,(0,s.checkIfLoadWxJsSdk)(function(){(0,s.setWxShareInfo)(t)}),(l.isTimOrQQ||l.isTencentDocApp)&&window.mqq&&mqq.invoke("data","setShareInfo",t,function(){})}),this.setDocxShareInfo(),this.shareInfoHasInit=!0}},{key:"hideMqqInputBar",value:function(){try{mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:0,source:0},function(){})}catch(e){console.log("setSharedDocNativeKeyboardEnable fail!")}}},{key:"getShareUrl",value:function(){var e="";if(window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet){var t=(0,r.getQuery)("tab"),n=(0,r.getQuery)("c"),o=window.SpreadsheetApp.spreadsheet.getFirstSheet();if(o){var i=o.getSheetId();i&&t&&i!=t&&(e="?tab="+(0,r.getQuery)("tab")),n&&(e.indexOf("tab")>-1?e+="&c="+n:e+="?c="+n)}}return location.origin+location.pathname+e}}]),e}();t.default=new c},"./js/app/header/util.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReadRecordModule=void 0,t.showTransferAuth=function(){if(!$("#transfer-auth-container").length){var e=$('<div id="transfer-auth-container"></div>');$("body").append(e)}$("#transfer-auth-container").show();var t=window.clientVars.userId&&window.clientVars.userId.replace(/^p\./,""),n=SpreadsheetApp&&SpreadsheetApp.plugins&&SpreadsheetApp.plugins.rmap,i=n&&n.getRelatedNumber()>0;(0,o.loadModule)("TransferAuth",function(e){e.show(document.getElementById("transfer-auth-container"),{creatorDomain:window.clientVars.creatorDomain,domainId:window.clientVars.domainId,padId:window.clientVars.padId,userId:t,hasRelatedForm:i,onClose:function(){g()}})})},t.hideTransferAuth=g,t.hideTemplate=function(){(0,o.loadModule)("TemplateInfo",function(e){e.isShowing()&&e.hide()})},t.showUserReport=function(){$.ajax({url:"https://docs.qq.com/cgi-bin/online_docs/support_gettoken",type:"POST",data:{xsrf:(0,i.getXsrf)(),domain_id:window.clientVars.domainId,pad_id:window.clientVars.padId,dataType:"form"===window.clientVars.padType?1:0},success:function(e){0===e.retcode&&e.token.length>0?function(e){var t=window.clientVars.userInfo.wx_openid,n="qq"===window.clientVars.userType?window.clientVars.userInfo.uin:t,o="https://jubao.qq.com/uniform_impeach/tc_document_entry?",i=encodeURIComponent(e);if(o+="token="+i+"&scene=6001&openid="+n,!$("#supportFrame-container").length){var a=$('<div id="supportFrame-container"></div>'),r='<iframe id="supportFrame" src="'+o+'" ></iframe>',s=$(r);a.append(s),$("body").append(a);var l=$('<div class="support_mask" style="background-color: rgb(0, 0, 0); opacity: 0.2; position: fixed; left: 0px; top: 0px; z-index: 6007; width: 100%; height: 95%;"></div>');$("body").append(l),window.addEventListener("message",function(e){var t=JSON.parse(e.data);t&&"jubao"===t.from&&"jubao_close"===t.cmd&&w()},!1)}}(e.token):(0,a.showToast)("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u5c1d\u8bd5\u3002",{zIndex:999999})},error:function(e){console.log(e),(0,a.showToast)("\u8bf7\u6c42\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u5c1d\u8bd5\u3002",{zIndex:999999})}})},t.hideUserReportPage=w,t.showReadRecord=v,t.hideReadRecord=b,t.openTemplateList=function(e){var t=void 0,n=void 0;switch(e){case"my":n=3;break;case"doc":n=0;break;case"form":n=2;break;case"sheet":n=1;break;case"slide":n=4;break;default:n=1}t="https://docs.qq.com/desktop/templates-list.html?padtype="+n,"undefined"!=typeof external&&"function"===typeof external.openUrl?external.openUrl(null,t,null,""):(0,p.tencentDocOpenUrl)(t)},t.produce_backup1=function(){var e=window.clientVars.globalPadId,t=e.indexOf("$"),n=e.slice(0,t),o=e.slice(t+1,e.length);if("undefined"==typeof external||"function"!==typeof external.openUrl){var i={isFinished:!1,title:"\u526f\u672c"+(0,c.getTitle)(),iconType:window.clientVars.padType,tips:"\u6b63\u5728\u751f\u6210\u526f\u672c..."};localStorage.setItem("jump_generatecopy",JSON.stringify(i)),(0,p.tencentDocOpenUrl)("//docs.qq.com/scenario/jumppage.html?type=generatecopy")}var r=2e3,s=30,l=function(e,t){var n=0;return function o(){if(n>s)return t(),void T_SHEET.Report.monitor(33624300);n++,e(),setTimeout(o,r)}};function d(e){if(e=e||{},s=1,"undefined"!=typeof external&&"function"===typeof external.openUrl)(0,a.showToast)("\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",{top:"125px"},{toolToastCloseTime:2e3});else{var t={isFinished:!0,title:"\u526f\u672c"+(0,c.getTitle)(),iconType:u.padType,retcode:e.retcode||1,failImg:{src:"generator_fail"},tips:"\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"};localStorage.setItem("jump_generatecopy",JSON.stringify(t))}T_SHEET.Report.monitor(33624298)}!function(e,t){$.ajax({url:"/cgibin/online_docs/copydoc_async",type:"post",async:!0,timeout:3e3,data:{title:"\u526f\u672c"+(0,c.getTitle)(),domain_id:n,pad_id:o},success:function(n,o,i){0===n.retcode&&n.doc_id&&n.doc_id.domain_id&&n.doc_id.pad_id?t(n.doc_url,n.doc_id.domain_id,n.doc_id.pad_id,e):e(n)},error:function(t,n,o){e()}}),T_SHEET.Report.monitor(33624296)}(d,function(){var e=arguments,t=l(function(){(function(e,t,n,o){$.ajax({url:"/cgibin/online_docs/copydoc_loop",type:"post",async:!0,timeout:3e3,data:{domain_id:t,pad_id:n},success:function(t,n,i){if(10027!==t.retcode){if(0===t.retcode){var a=e+"?newPad=1&newPadType=clone";if("undefined"!=typeof external&&"function"===typeof external.openUrl)external.openUrl(null,a,null,"");else{var r={isFinished:!0,title:"\u526f\u672c"+(0,c.getTitle)(),iconType:u.padType,retcode:t.retcode,url:a};localStorage.setItem("jump_generatecopy",JSON.stringify(r))}return s=1,void T_SHEET.Report.monitor(33624297)}return T_SHEET.Report.monitor(33624299),o(t)}},error:function(e,t,n){o()}})}).apply(this,e)},d);setTimeout(t,r)});var u=window.clientVars;T_SHEET.Report.tdwReport({uin:u.userDomain,id:u.globalPadId,touin:u.creatorDomain,file_type:"excel",action:"clk_save",module:"copy",opername:"doc_copy",table:"dc03111"})},t.produce_backup=function(){var e=window.clientVars.globalPadId,t=e.indexOf("$"),n=e.slice(0,t),o=e.slice(t+1,e.length),i="undefined"!=typeof external&&"function"===typeof external.openUrl,s=r.isWindowPlatform&&r.isWeChat;if(!i)if(r.isPad&&r.isQQ||s)(0,a.showToast)("\u751f\u6210\u526f\u672c\u4e2d\uff0c\u8bf7\u7a0d\u5019...",{zIndex:9999},{toolToastCloseTime:5e3});else{var l={isFinished:!1,title:"\u526f\u672c"+(0,c.getTitle)(),iconType:clientVars.padType,tips:"\u6b63\u5728\u751f\u6210\u526f\u672c..."};localStorage.setItem("jump_generatecopy",JSON.stringify(l)),(0,p.tencentDocOpenUrl)("//docs.qq.com/scenario/jumppage.html?type=generatecopy")}$.ajax({url:"/cgi-bin/online_docs/createdoc_new",type:"post",async:!0,timeout:3e4,data:{title:"\u526f\u672c-"+(0,c.getTitle)(),create_type:4,domain_id:n,pad_id:o},success:function(e,t,n){if(0===e.retcode){var o=e.doc_url+"?newPad=1&newPadType=clone";if(i||r.isPad&&r.isQQ)r.isPad&&r.isQQ?window.location.href=o:external.openUrl(null,o,null,"");else if(s)window.location.href=o;else{var l={isFinished:!0,title:"\u526f\u672c-"+(0,c.getTitle)(),iconType:clientVars.padType,retcode:e.retcode,url:o};localStorage.setItem("jump_generatecopy",JSON.stringify(l))}}else if(i||s)(0,a.showToast)("\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",{top:"125px"},{toolToastCloseTime:2e3});else{var l={isFinished:!0,title:"\u526f\u672c-"+(0,c.getTitle)(),iconType:clientVars.padType,retcode:e.retcode||-1,failImg:{src:"generator_fail"},tips:"\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"};localStorage.setItem("jump_generatecopy",JSON.stringify(l))}},error:function(e,t,n){if("undefined"!=typeof external&&"function"===typeof external.openUrl)(0,a.showToast)("\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002",{top:"125px"},{toolToastCloseTime:2e3});else{var o={isFinished:!0,title:"\u526f\u672c-"+(0,c.getTitle)(),iconType:clientVars.padType,retcode:e.retcode||-1,failImg:{src:"generator_fail"},tips:"\u751f\u6210\u526f\u672c\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002"};localStorage.setItem("jump_generatecopy",JSON.stringify(o))}}}),T_SHEET.Report.tdwReport({uin:clientVars.userDomain,id:clientVars.globalPadId,touin:clientVars.creatorDomain,file_type:"excel",action:"clk_save",module:"copy",opername:"doc_copy",table:"dc03111"})},t.getFile=_,t.import_local_file=function(e){r.isTencentDocApp?window.mqq&&mqq.invoke("docx","importFile",{isImportFile:!0},function(e,t){for(var n=JSON.parse(JSON.stringify(t)),o=n.params.fileString,i=n.params.fileName,a=(n.params.filePath,"application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,.xlsx,.xls,.doc,.docx,.csv,.txt"),r=atob(o),s=[],l=0;l<r.length;l+=512){for(var d=r.slice(l,l+512),c=new Array(d.length),u=0;u<d.length;u++)c[u]=d.charCodeAt(u);var p=new Uint8Array(c);s.push(p)}var h=new Blob(s,{type:a}),f=new File([h],i,{type:a,lastModified:Date.now()});_(f)}):function(e){$("#_importFile").remove();var t=document.createElement("input");if(t.setAttribute("id","_importFile"),t.setAttribute("type","file"),t.setAttribute("style","display:none"),"undefined"!==typeof external&&"undefined"!==typeof external.nativeCall)t.setAttribute("accept","*.*");else{t.setAttribute("accept","application/msword,application/vnd.ms-excel,application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.openxmlformats-officedocument.wordprocessingml.document,text/plain,.xlsx,.xls,.doc,.docx,.csv,.txt")}document.body.appendChild(t),$(t).change(function(t){var n=r.isTencentDocApp?t:t.target.files[0],o=n;if(navigator.userAgent.indexOf("MSIE")>0&&window.ActiveXObject)try{var i=window.ActiveXObject,d=window.ActiveXObject?new i("Scripting.FileSystemObject"):{};o=d.GetFile(n)||n}catch(t){window.log&&s.default.info(t)}function c(){try{T_SHEET.Report.tdwReport({opername:"doc_import",module:"import_fail",action:"count",obj2:location.href,obj3:2,ver1:0,ver2:(/\.([^\.]*)$/.exec(o.name)||[])[1]||"",ver3:"notSupport",file_type:{doc:1,xls:2,txt:3,csv:4}[(/\.([^\.]{3})[^\.]*$/.exec(String(o.name).toLowerCase())||[])[1]]||null}),T_SHEET.Report.monitor(3474665)}catch(t){}}if(o&&o.name){var u=(0,l.checkFileSize)(n);if(u<=0)return(0,a.showToast)("\u5bfc\u5165\u5931\u8d25\uff0c\u4e0d\u80fd\u5bfc\u5165\u7a7a\u6587\u4ef6\u3002",{top:5},{toolToastCloseTime:3e3}),void c();if(u/1048576>=20)return(0,a.showToast)("\u5bfc\u5165\u5931\u8d25\uff0c\u6587\u4ef6\u5927\u5c0f\u8d85\u8fc720MB\u3002",{top:5},{toolToastCloseTime:3e3}),void c();if(!/.*\.(doc|docx|xls|xlsx|txt|csv)$/i.test(o.name))return(0,a.showToast)("\u5bfc\u5165\u5931\u8d25\uff0c\u4ec5\u652f\u6301 doc/docx/xls/xlsx/txt/csv \u683c\u5f0f\u7684\u6587\u4ef6\u3002",{top:5},{toolToastCloseTime:3e3}),void c();e(this.files)}}),t.click()}(function(e){if($("#import-file-container").length)$("#import-file-container").show();else{var t=$('<div id="import-file-container" class="alert-bg-container"></div>');$("body").append(t)}(0,o.loadModule)("ImportFile",function(t){t.show(document.getElementById("import-file-container"),{file:e[0],userDomain:clientVars.userDomain,onClose:function(){$("#import-file-container").hide()}})})});var t=localStorage.getItem("tdsourcetag");T_SHEET.Report.tdwReport({opername:"doc_core",module:"create",action:"import",source3:t||""})},t.showSupportPage=function(){var e=clientVars.userName,t=clientVars.userPic,n=clientVars.userId||"";n?"p"===n.charAt(0)&&(n=n.replace(/p./,"")):n=clientVars.uin;var o="";try{var a=Number(new Date),r=a-18e5,l=l=s.default.report("TUCAO_EXCEL",{query:{startTs:r,endTs:a}});o=JSON.stringify({type:"excel",url:window.location.href,uid:(0,i.getCookie)("uid"),rid:l}),o=encodeURIComponent(o),console.log(l)}catch(d){console.warn(d)}!function(e){if(clientVars.isLogin){console.log(e);var t=document.createElement("form");for(var n in t.id="form",t.name="form",t.style.display="none",t.setAttribute("target","_blank"),document.body.appendChild(t),e)if(Object.hasOwnProperty.call(e,n)){var o=document.createElement("input");o.type="text",o.name=n,o.value=e[n],t.appendChild(o)}t.method="POST",t.action="https://support.qq.com/product/28096",t.submit(),document.body.removeChild(t)}else(0,p.tencentDocOpenUrl)("https://support.qq.com/products/28096")}({openid:n,nickname:e,avatar:t,customInfo:o,clientInfo:window.navigator.userAgent})},t.showNewFolder=function(){var e="";e="https://docs.qq.com/desktop/?opennewfolder="+(new Date).getTime(),"undefined"!=typeof external&&"function"===typeof external.openUrl?external.openUrl(null,e,null,""):(0,p.tencentDocOpenUrl)(e);T_SHEET.Report.tdwReport({opername:"doc_folder",module:"detail_file",action:"new_folder",table:"dc03111"})},t.showShare=function(){$("#auth-container").is(":visible")&&u.default.hideAuthContainerAnim();if(h.event.default.trigger("enableAll"),h.event.default.trigger("record-hide-side"),b(),y(),$("#doc-sharebox-container").length)$("#doc-sharebox-container").show();else{var e=$('<div id="doc-sharebox-container" class="alert-bg-container"></div>');$("body").append(e)}var t=4&clientVars.rightFlag,n=window.clientVars.globalPadId,i=n.indexOf("$"),a=n.slice(0,i);(0,o.loadModule)("Share",function(e,n){n?e.init(document.getElementById("doc-sharebox-container"),{invokeFrom:"Root",padId:(0,c.getPadId)(),shareLink:function(){return d.default.getShareUrl()},shareTitle:function(){return(0,c.getTitle)()},shareDocType:clientVars.padType,domainId:a,creatorDomain:window.clientVars.creatorDomain,havePermission:t,onAuthUpdated:function(e){u.default.updatePolicyTips(e)},onClose:function(){$("#doc-sharebox-container").hide()}}):e.show({onClose:function(){$("#doc-sharebox-container").hide()}})})},t.showNotification=function(){(0,o.loadModule)("Notifications",function(e,t){if(t){var n=document.createElement("div");n.setAttribute("id","notification-container"),$(document.body).append(n),$("#notification-container").addClass("notification-container-hide"),$("#notification-container").addClass("notification-container-slide-animation");var o=$("#web_header_top").outerHeight()+$("#web_header_bottom").outerHeight(),i=parseInt($("#padpage").css("top"))+parseInt($("#web_header_bottom").css("top")),a=parseInt($(".sheet-bottom-pc").css("height"));$("#notification-container").css({top:o+i+1+"px",height:"calc(100% - "+(o+i+a)+"px"});var r={from:"core-doc"};window.clientVars.isCreator&&(r.domainId=window.clientVars.domainId,r.localPadId=window.clientVars.localPadId),e.showNotification(n,r),setTimeout(function(){$("#notification-container").removeClass("notification-container-hide"),$("#notification-container").addClass("notification-container-show")},1),window.SLR&&window.SLR.listen("NOTIFICATION-CLOSE",function(){y()}),window.SLR&&window.SLR.listen("ONE_KEY_PERMISSION_TO_VIEWABLE",function(){u.default.refreshPolicyTips()})}m||(m=!0,$("#notification-container").removeClass("notification-container-hide"),$("#notification-container").addClass("notification-container-show"),window.SLR.dispatch("NOTIFICATION_WND_DID_SHOW")),b(),h.event.default.trigger("notificationShow",!0)})},t.hideNotification=y,t.isNotificationShow=function(){return m},t.showAuth=function(){u.default.showAuth()},t.hideAuth=function(){u.default.hideAuth()};var o=n("./js/script-loader/index.js"),i=n("./js/utils/browser.js"),a=n("./js/component/toast/index.js"),r=n("./js/utils/user-agent.js"),s=f(n("./js/utils/log.js")),l=n("./js/utils/util.js"),d=f(n("./js/app/header/share.js")),c=n("./js/config/sheet.js"),u=f(n("./js/app/header/pc/auth-btn.js")),p=n("../node_modules/@tencent/tencent_doc_open_url/index.js"),h=n("./js/event/event-center.js");function f(e){return e&&e.__esModule?e:{default:e}}var m=!1;function g(){(0,o.loadModule)("TransferAuth",function(e){e.remove(),$("#transfer-auth-container").hide()})}function w(){$("#supportFrame-container").length&&$("#supportFrame-container").remove(),$(".support_mask").length&&$(".support_mask").remove()}function v(){if(h.event.toolBar.trigger("readRecordPanelShow"),!$("#read-record-container").length){var e=$('<div id="read-record-container"></div>');e.addClass("read-record-container-animation"),e.addClass("read-record-container-hide"),$("body").append(e)}$("#read-record-container").show();var t=$("#web_header_top").outerHeight()+$("#web_header_bottom").outerHeight(),n=parseInt($("#padpage").css("top"))+parseInt($("#web_header_bottom").css("top"));$("#notification-container").css({top:t+n+1+"px",height:"calc(100% - "+(t+n+45+1)+"px"}),setTimeout(function(){$("#read-record-container").removeClass("read-record-container-hide"),$("#read-record-container").addClass("read-record-container-show")},1);var i=window.clientVars.userId&&window.clientVars.userId.replace(/^p\./,"");(0,o.loadModule)("ReadRecord",function(e){e.show(document.getElementById("read-record-container"),{creatorDomain:window.clientVars.creatorDomain,domainId:window.clientVars.domainId,padId:window.clientVars.padId,userId:i,onClose:function(){b()}}),h.event.default.listen("discussShow",function(e){e&&b()})})}function b(){$("#read-record-container").removeClass("read-record-container-show"),$("#read-record-container").addClass("read-record-container-hide"),setTimeout(function(){(0,o.loadModule)("ReadRecord",function(e){e.remove(),$("#read-record-container").hide(),h.event.toolBar.trigger("readRecordPanelHide")})},300)}t.ReadRecordModule={showReadRecord:v,hideReadRecord:b};function _(e){var t=e;if($("#import-file-container").length)$("#import-file-container").show();else{var n=$('<div id="import-file-container" class="alert-bg-container"></div>');$("body").append(n)}(0,o.loadModule)("ImportFile",function(e){e.show(document.getElementById("import-file-container"),{file:t,userDomain:clientVars.userDomain,onClose:function(){$("#import-file-container").hide()}})})}function y(){if(m){m=!1,$("#notification-container").removeClass("notification-container-show"),$("#notification-container").addClass("notification-container-hide");var e=new CustomEvent("notification-reset-current-edit");document.dispatchEvent(e),window.SLR.dispatch("NOTIFICATION_WND_WILL_HIDEN"),h.event.default.trigger("notificationShow",!1)}}h.event.default.listen("discussShow",function(e){e&&y()})},"./js/app/history/history-list.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/utils/ui/tooltip.js"),r=n("./js/utils/date.js"),s=n("./js/app/history/record-change.js"),l=(o=s)&&o.__esModule?o:{default:o};var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.jlistDom=null,this.jexpandDom=null,this.preScrollTop=0,this.isRequestingMore=!1,this.itemClickHandler=null,this.jselectedItem=null,this.expandIcon=null,this.reqMoreHandler=null,this.authorsInfo=null,this.downHasMore=!1,this.upHasMore=!1,this.docString=null,this.maxVersion=0,this.maxRevision=0,this.newVersion=null,this.hasSelCurVersion=!1,this.historyItemChangeColorList=["#B30000","#E6118F","#F1633A","#3646A0","#3184E9","#09A9B9","#822F1D","#C67600","#FFB400","#0D6C54","#918B3D","#7BB725"],this.subHistoryItemChangeColorList=this.historyItemChangeColorList.slice(0),this.colorList=[]}return i(e,[{key:"setArrowIconExpand",value:function(e,t){t?(e.removeClass("history-item-arrow-icon-right"),e.addClass("history-item-arrow-icon-down"),e.attr("data-tooltip","\u6536\u8d77\u8be6\u7ec6\u8bb0\u5f55"),e.parent().next().next().children(".history-item-author-list").hide()):(e.removeClass("history-item-arrow-icon-down"),e.addClass("history-item-arrow-icon-right"),e.attr("data-tooltip","\u5c55\u5f00\u8be6\u7ec6\u8bb0\u5f55"),e.parent().next().next().children(".history-item-author-list").show()),$("#tooltip").text(this.expandIcon.attr("data-tooltip"))}},{key:"refreshEvent",value:function(){var e=this;(0,a.tooltip)(".history-item-arrow-icon[data-tooltip]"),$(".history-item-arrow-icon").unbind("mousedown"),$(".history-item-arrow-icon").mousedown(function(t){e.jexpandDom?e.jexpandDom.is($(t.delegateTarget).parent().parent().next())?(e.jexpandDom.toggle(),e.jexpandDom=null,e.setArrowIconExpand(e.expandIcon,!1),$(t.delegateTarget).parent().parent().parent().removeClass("history-item-expand"),$(t.delegateTarget).parent().parent().parent().addClass("history-item-common"),e.expandIcon=null):(e.jexpandDom.toggle(),e.jexpandDom=$(t.delegateTarget).parent().parent().next(),e.jexpandDom.toggle(),e.setArrowIconExpand(e.expandIcon,!1),e.expandIcon=$(t.delegateTarget),e.setArrowIconExpand(e.expandIcon,!0),$(t.delegateTarget).parent().parent().parent().addClass("history-item-expand"),$(t.delegateTarget).parent().parent().parent().removeClass("history-item-common")):(e.jexpandDom=$(t.delegateTarget).parent().parent().next(),e.jexpandDom.toggle(),e.expandIcon=$(t.delegateTarget),e.setArrowIconExpand(e.expandIcon,!0),$(t.delegateTarget).parent().parent().parent().addClass("history-item-expand"),$(t.delegateTarget).parent().parent().parent().removeClass("history-item-common")),t.stopPropagation()}.bind(this)),$(".history-subitem,.history-item-header").unbind("mousedown"),$(".history-subitem,.history-item-header").mousedown(function(t){var n=!1,o=$(".history-item-revert");if(o&&o.length>0&&"none"!==o.css("display")){var i=o.offset(),a=i.top,r=i.left,s=o.width(),d=o.height(),c=t.pageX,u=t.pageY;c>r&&c<r+s&&u>a&&u<a+d&&(l.default.onRevertBtnClick(),n=!0)}if(!n){e.jselectedItem&&(e.jselectedItem.hasClass("history-item-header")?(e.jselectedItem.parent().removeClass("history-item-common-selected"),e.jselectedItem.removeClass("history-item-common-selected"),e.jselectedItem.addClass("history-item-common")):(e.jselectedItem.removeClass("history-item-common-selected"),e.jselectedItem.addClass("history-item-common")),e.jselectedItem.children(".history-item-revert").remove()),e.jselectedItem=$(t.delegateTarget),e.addRevert(e.jselectedItem,t);var p,h=e.jselectedItem.parents(".history-item").next(),f=e.jselectedItem.attr("revision"),m=e.jselectedItem.hasClass("history-item-header");if(m)h.length>0&&(p=h.find(".history-item-header").attr("revision"));else{var g=e.jselectedItem.next(".history-subitem");g.length>0?p=g.attr("revision"):h.length>0&&(p=h.find(".history-item-header").attr("revision"))}var w=!1;"undefined"!=typeof e.jselectedItem.attr("revert")&&(p=void 0,w=!0),void 0==p&&(p=-1),e.itemClickHandler&&e.itemClickHandler(e.jselectedItem.attr("version"),f,e.jselectedItem.attr("time"),m,p,w,e.jselectedItem.attr("ra"),e.newVersion),e.jselectedItem.attr("version")>=e.maxVersion||f>=e.maxRevision?$(".history-item-revert").css("display","none"):$(".history-item-revert").show()}}.bind(this)),$(".history-subitem,.history-item-header").unbind("hover"),$(".history-subitem,.history-item-header").hover(function(){window.recordHoverTipShow&&window.recordHoverTip&&window.recordHoverTip.hide()},function(){window.recordHoverTipShow&&window.recordHoverTip&&window.recordHoverTip.hide()})}},{key:"selectCurVersion",value:function(){this.hasSelCurVersion||(this.jselectedItem=$($(".history-item-header")[0]),this.hasSelCurVersion=!0)}},{key:"activeBigVersion",value:function(e){this.jselectedItem=$(".history-item-header[version="+e+"]"),this.addRevert()}},{key:"addRevert",value:function(e){if(this.jselectedItem.hasClass("history-item-header")?(this.jselectedItem.parent().removeClass("history-item-common"),this.jselectedItem.parent().addClass("history-item-common-selected"),this.jselectedItem.removeClass("history-item-common"),this.jselectedItem.addClass("history-item-common-selected")):(this.jselectedItem.removeClass("history-item-common"),this.jselectedItem.addClass("history-item-common-selected")),!this.jselectedItem.children(".history-item-revert").hasClass("history-item-revert")){var t=$("<div class='history-item-revert'><div class='history-item-revert-icon'></div><div class='history-item-revert-word'>\u8fd8\u539f</div>");t.hover(function(e){$(e.delegateTarget).children().first().removeClass("history-item-revert-icon"),$(e.delegateTarget).children().first().addClass("history-item-revert-icon-hover")},function(e){$(e.delegateTarget).children().first().removeClass("history-item-revert-icon-hover"),$(e.delegateTarget).children().first().addClass("history-item-revert-icon")}),this.jselectedItem.prepend(t)}}},{key:"bindScrollEvent",value:function(e){var t=this;e.scroll(function(e){var n=$(e.delegateTarget).scrollTop(),o=$(e.delegateTarget)[0].scrollHeight;!t.upHasMore&&!t.downHasMore||t.isRequestingMore||(t.downHasMore&&n>t.preScrollTop&&o-n-$(e.delegateTarget).height()<60&&(t.isRequestingMore=!0,t.reqMoreHandler(!1,function(e){t.isRequestingMore=!1})),t.upHasMore&&n<t.preScrollTop&&n<60&&(t.isRequestingMore=!0,t.reqMoreHandler(!0,function(e){t.isRequestingMore=!1})),t.preScrollTop=n)})}},{key:"changeInfo",value:function(e,t){var n=null;if((n=e.a instanceof Array?this.namesForIDs(e.a):this.namesForIDs([e.a])).length>30&&(n=n.substring(0,29)+"...",e.a instanceof Array&&e.a.length>1&&(n+="\u7b49"+e.a.length+"\u4eba")),1==e.i||1==e.v||1==e.isCreate)return n+"\u521b\u5efa\u4e86"+this.docString;if(e.r){var o=e.r,i=0;if("string"==typeof o){var a=o.split("_");parseInt(a[0]),a[1]&&(i=parseInt(a[1]))}else o;return n+"\u5c06"+this.docString+"\u6062\u590d\u5230"+(0==i?this.localstringFromTime(e.r)+"\u65f6\u7684\u5185\u5bb9":"\u7b2c"+i+"\u7248")}return n+(t?"\u7f16\u8f91\u4e86"+this.docString:1==e.tt?"\u4fee\u6539\u4e86\u6807\u9898":"\u4fee\u6539\u4e86\u5185\u5bb9")}},{key:"subitemHtml",value:function(e){var t=null;return t=e.a instanceof Array?this.subNamesHtmlForIDs(e.a):this.subNamesHtmlForIDs([e.a]),"<div class='history-subitem history-item-common' revision='"+e.i+"' time='"+e.t+"'><div class='history-subitem-content'><div class='history-subitem-time'>"+this.subLocalstringFromTime(e.t)+"</div>"+t+"</div></div>"}},{key:"subLocalstringFromTime",value:function(e){var t=new Date;return t.setTime(e),(0,r.Format)(t,"hh:mm:ss")}},{key:"itemHeaderHtml",value:function(e,t){var n=e.i,o=e.v,i=e.t,a=e.r,r="";a&&(r=" revert='"+a+"'");var s=null;if(1!==e.isUpgrade){var l=this.getRevertAuthor(e),d=l?"' ra='"+l:"";s=e.a instanceof Array?this.namesHtmlForIDs(e.a,a):this.namesHtmlForIDs([e.a],a)}else s=this.upgradeHtml();return"<div class='history-item-header history-item-common' revision='"+n+"' version='"+o+"' time='"+i+d+"'"+r+">"+(t?"<div class='history-item-arrow-icon-outer'><div class='history-item-arrow-icon history-item-arrow-icon-right' data-tooltip='\u5c55\u5f00\u8be6\u7ec6\u8bb0\u5f55'></div></div>":"")+"<div class='history-item-version'>\u7b2c"+o+"\u7248"+(o==this.maxVersion?"(\u5f53\u524d)":"")+"</div><div class='history-item-header-content'><div class='history-item-time'>"+this.localstringFromTime(i)+"</div>"+s+"</div></div>"}},{key:"localstringFromTime",value:function(e){var t=new Date;return t.setTime(e),(0,r.Format)(t,"yyyy-MM-dd hh:mm:ss")}},{key:"upgradeHtml",value:function(){return'<div class="history-item-upgrade">\u8868\u683c\u5e95\u5c42\u5347\u7ea7</div>'}},{key:"namesHtmlForIDs",value:function(e,t){var n=this,o="",i=0;if(e&&Array.isArray(e))if(e.forEach(function(e){if(!(i>=4)){var t=n.authorInfoForID(e);if(t){var a=t.name,r=n.getColorFromId(e);if(r&&a){var s="style='background-color:"+r+"'";o+="<div class='history-item-change'>"+("<div "+(s||"")+" class='history-item-change-before'></div>")+a+"</div>",i++}}}}),t){o+="<div class='history-item-change-last history-item-by-revert'>"+this.revertInfoHtml(t)+"</div>"}else e.length>1&&(o+="<div class='history-item-change-last'>\u7b49"+e.length+"\u4eba\u4fee\u6539\u4e86\u6587\u6863</div>");return"<div class = 'history-item-author-list'>"+o+"</div>"}},{key:"revertInfoHtml",value:function(e){var t=0,n=0;if("string"==typeof e){var o=e.split("_");t=parseInt(o[0]),o[1]&&(n=parseInt(o[1]))}else t=e;return"\u6062\u590d\u4e86"+(0==n?" "+this.localstringFromTime(t)+" \u65f6":"\u7b2c"+n+"\u7248")+"\u7684\u5185\u5bb9"}},{key:"subNamesHtmlForIDs",value:function(e){var t=null,n="";(t=this.namesForIDs(e)).length>30&&(t=t.substring(0,29)+"...");var o=null;e&&Array.isArray(e)&&e.length>0&&(o="style='background-color:"+this.getColorFromId(e[0])+"'");return n+="<div class='history-subitem-change'>"+("<div "+(o||"")+" class='history-subitem-change-before'></div>")+t+"</div>"}},{key:"itemHtml",value:function(e){var t=this,n=e.l;1==e.v&&n&&n.length>=1&&(n[n.length-1].isCreate=!0);var o="<div class='history-item history-item-common'>";return o+=this.itemHeaderHtml(e,n&&n.length>1),o+="<div class='history-item-body'> ",n&&n.forEach(function(e){o+=t.subitemHtml(e)}),o+="</div></div>"}},{key:"itemsHtml",value:function(e){var t=this;if(!e)return"";var n="";return e.forEach(function(e){n+=t.itemHtml(e)}),n}},{key:"resetVarity",value:function(){this.jlistDom=null,this.jexpandDom=null,this.preScrollTop=0,this.isRequestingMore=!1,this.requestedMinPage=0,this.itemClickHandler=null,this.jselectedItem=null,this.expandIcon=null,this.reqMoreHandler=null,this.authorsInfo=null,this.upHasMore=!1,this.downHasMore=!1,this.docString=null}},{key:"namesForIDs",value:function(e){var t=this,n=[];return e.forEach(function(e){var o=t.authorInfoForID(e);o&&o.name&&n.push(o.name)}),n.join("\u3001")}},{key:"appendItems",value:function(e,t,n,o,i){if(this.authorsInfo)for(var a in this.authorsInfo)if(Object.hasOwnProperty.call(this.authorsInfo,a)){var r=this.authorInfoForID(a);t[a]||(t[a]=r)}this.authorsInfo=t,this.upHasMore=n,this.downHasMore=o,i?this.jlistDom.prepend($(this.itemsHtml(e))):$(this.itemsHtml(e)).appendTo(this.jlistDom),this.jlistDom.scrollTop=this.preScrollTop,this.refreshEvent(),this.selectCurVersion()}},{key:"prepareContainer",value:function(e,t,n,o){e.empty().append("<div class='history-list' id='history-list'></div>"),this.jlistDom=$("#history-list"),this.refreshEvent(),this.bindScrollEvent(e),this.itemClickHandler=n,this.reqMoreHandler=o,this.docString="\u8868\u683c",this.hasSelCurVersion=!1}},{key:"dismiss",value:function(){this.jlistDom&&this.jlistDom.remove(),this.resetVarity()}},{key:"setNewVersion",value:function(e){this.newVersion=e}},{key:"setLatestVersion",value:function(e){this.maxVersion=e}},{key:"setLatestRevision",value:function(e){this.maxRevision=e}},{key:"fixBtnView",value:function(e,t){var n=$(".history-item-revert");t?n.show():n.hide()}},{key:"getRevertAuthor",value:function(e){if(!e||!e.r)return null;var t=null,n=e.a;return n&&(n instanceof Array||(n=[n]),n.length>0&&(t=n[0])),t}},{key:"authorInfoForID",value:function(e){return this.authorsInfo[e]}},{key:"getColorFromId",value:function(e){if(!this.colorList[e]){this.subHistoryItemChangeColorList.length<=0&&(this.subHistoryItemChangeColorList=this.historyItemChangeColorList.slice(0));var t=Math.floor(Math.random()*this.subHistoryItemChangeColorList.length);this.colorList[e]=this.subHistoryItemChangeColorList[t],this.subHistoryItemChangeColorList.splice(t,1)}return this.colorList[e]}}]),e}();t.default=new d},"./js/app/history/record-change.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=m(n("./js/app/history/history-list.js")),a=m(n("./js/app/history/record-preview.js")),r=m(n("./js/component/pad-modals/pad-modals.js")),s=n("./js/component/toast/index.js"),l=n("./js/component/dialog/custom-dialog.js"),d=n("./js/utils/ui/tooltip.js"),c=n("./js/utils/date.js"),u=n("./js/config/sheet.js"),p=n("./js/event/event-center.js"),h=n("./js/app/header/util.js"),f=(m(n("./js/component/alert-view-boxs/alert-view-boxs.js")),n("./js/utils/user-agent.js"));function m(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.resizeHandlerForPad=function(){Math.min(window.innerWidth,document.body.offsetWidth)<640&&((0,d.hideTooltip)(),t.showRecordPreview(!1),t.report("close"),window.swReportRestart&&window.swReportRestart())}}return o(e,[{key:"init",value:function(){var e=this;this.initVariables(),p.event.default.listen("record-hide-side",function(){e.hideRecordSide()}),p.event.keyboard.listen("resize",function(){e.isShow&&e.updateContainerSize()})}},{key:"initVariables",value:function(){this.isShow=!1,this.curPage=0,this.totalPage=0,this.requestedMinPage=0,this.requestedMaxPage=0,this.lastestVersion=0,this.latestRevision=0,this.selInfo={version:0,revision:0,time:0,isBigVersion:0,revertAuthor:""},this._confirmDialog=null,this._modelTimer=null,this._isPreviewContainerInit=!1,this._isPreviewShow=!1,this._isEnableSelectRecordForVersion=!0,this._prevewEditor=null,this._table=null,this.preEditableConfig=null}},{key:"isPreviewShow",value:function(){return this._isPreviewShow}},{key:"setPriviewState",value:function(e){this._isPreviewShow=e,this._isPreviewContainerInit=e}},{key:"showRecordChange",value:function(e){p.event.toolBar.trigger("recordChangePanelBeforeShow"),T_SHEET.Report.jank.log({moduleValue:"record",actionValue:"enter"}),this.preEditableConfig=window.CoreSheet.sheetConfig.gEditable,window.CoreSheet.sheetConfig.gEditable=!1,this.showRecordPreview(!0,e),this.report("view"),p.event.toolBar.trigger("recordChangePanelAfterShow")}},{key:"onRevertBtnClick",value:function(){var e=this;this._confirmDialog=(0,l.Custom_Dialog)("\u786e\u8ba4\u5c06\u8868\u683c\u8fd8\u539f\u5230\u8be5\u7248\u672c\u5417\uff1f",{type:"question",title:"\u63d0\u793a",overlay_close:!1,onClose:function(t){t===l.DefaultButtons.OK&&(e.showRecordPreview(!1),r.default.showHistoryRevertTipBox(),e.reqRevertToVersion(e.selInfo.version,e.selInfo.revision,e.selInfo.newver),e.report("clk_recover"),e.report("recover_his")),e._confirmDialog=null}})}},{key:"onGetRecords",value:function(e,t){this.curPage=e.history.page,this.totalPage=e.history.pages,0===this.requestedMinPage&&0===this.requestedMaxPage?(this.requestedMinPage=this.curPage,this.requestedMaxPage=this.curPage):(this.curPage>this.requestedMaxPage&&(this.requestedMaxPage=this.curPage),this.curPage<this.requestedMinPage&&(this.requestedMinPage=this.curPage));var n=!1,o=!1;if(this.requestedMinPage>1&&(n=!0),this.requestedMaxPage<this.totalPage&&(o=!0),this.isShow){var r=e.history.items;i.default.appendItems(r,e.authors,n,o,t)}e.newver>0&&a.default.setOldSheetRecordsInfo(e)}},{key:"reqRecordsList",value:function(e,t,n){var o="/dop-api/get/history?padId="+clientVars.globalPadId+"&page="+t+"&_r="+parseInt(1e4*Math.random());$.get(o,{},function(e,t){n&&n("success"==t,e)})}},{key:"reqRecordForVersion",value:function(e,t,n,o){var i=this;$(".preview-body-title-load-wrap").show();var a="";parseInt(t)>0&&(a="&fRev="+t);var r="/dop-api/get/tabs?padId="+clientVars.globalPadId+"&rev="+e+a;$.get(r,{},function(a,r){var l;e==i.selInfo.revision&&("success"==r&&0==a.retcode?(a.version=e,a.padID=(0,u.getPadId)(),a.fRev=t,a.isRevertVersion=n,a.revertAuthor=o,i.onGetRecordForVersion(e,a),setTimeout(function(){e==i.selInfo.revision&&$(".preview-body-title-load-wrap").hide()},1e3)):("doc"===clientVars.padType?l={top:$(".doc-preview-container-wrapper").offset().top+$("#doc-preview-container-outer").scrollTop()-$(".preview-body-title-container").offset().top,transform:"translateY(-50%)"}:"sheet"===clientVars.padType&&(l={top:0}),(0,s.showToast)("\u62c9\u53d6\u5931\u8d25\u3002",l,{toolToastCloseTime:2e3},$("#preview-page-body")[0],!0),$(".preview-body-title-load-wrap").hide()))})}},{key:"onGetRecordForVersion",value:function(e,t){this.showPrevewContent(t,!0)}},{key:"reqRevertToVersion",value:function(e,t,n){var o=this,i=null,a=null,l=null,d=parseInt(t)<n;d?(a=this.getRevertParam("/dop-api/convertasync",e,t),l=this.getRevertParam("/dop-api/convertrevert",e,t)):a=this.getRevertParam("/dop-api/revert",e,t),(0,s.showToast)("\u6b63\u5728\u8fd8\u539f",{top:"5px"},{toolToastCloseTime:50}),$.get(a,{},function(e,t){setTimeout(r.default.hideHistoryRevertTipBox.bind(r.default),2e3),o._modelTimer&&clearTimeout(o._modelTimer),o._modelTimer=null,"success"==t&&0==e.retcode?d?i=o.queryRevertStatus(l):window.location.reload():o.showRevertFailed()}),this._modelTimer=setTimeout(function(){null!==i&&i.abort(),r.default.hideHistoryRevertTipBox(),o.showRevertFailed()},3e4)}},{key:"queryRevertStatus",value:function(e){var t=this;return $.get(e,function(n,o){"success"===o&&0===n.retcode?(a.default.hideOldSheet(),window.location.reload()):1===n.retcode?setTimeout(function(){t.queryRevertStatus(e)},2e3):t.showRevertFailed()})}},{key:"getRevertParam",value:function(e,t,n){var o=e+"?padId="+clientVars.globalPadId+"&rev="+n;return t&&(o+="&v="+t),o}},{key:"showPrevewContent",value:function(e,t){SpreadsheetApp&&SpreadsheetApp.preview.setPreviewMode(t,e,function(){a.default.showSheet(t,e)})}},{key:"fixPreviewHeight",value:function(){$("#doc-preview-container-outer").css("height",$(window).height()-$("#preview-page-header").outerHeight()-$(".preview-body-title-container").outerHeight())}},{key:"showMainFrame",value:function(e){var t=this;if(e){var n="<div id='preview-page' class='preview-page'><div class='history-modal-overlay'></div><div id='preview-page-body' class='preview-page-body'><div class='preview-body-title-container'><div class='preview-title-common preview-header-title'>\u7248\u672c\u4fe1\u606f</div><div class='preview-header-revert preview-header-revert-disabled'>\u6062\u590d</div></div></div><div class='preview-body-title-load-wrap'><div class='preview-body-title-load'></div></div><div id='recordbar' class='recordbar'><div id='recordbar-header' class='recordbar-header'><div id='recordbar-header-title' class='preview-title-common recordbar-header-title'>\u4fee\u8ba2\u8bb0\u5f55</div><div id='preview-page-back' class='preview-page-back' data-tooltip='\u5173\u95ed'><button id='read-record-close-button' class='close-button '"+(f.isPad?"":"hover")+"></button></div></div><div id='recordbar-body' class='recordbar-body'></div></div></div> ";$("body").addClass("state-history"),$(n).insertBefore($("#padpage")),this.setPriviewState(!0),$(window).unbind("networkOnline",this.networkOnlineHandler.bind(this)).bind("networkOnline",this.networkOnlineHandler.bind(this)),$(window).unbind("networkOffline",this.networkOfflineHandler.bind(this)).bind("networkOffline",this.networkOfflineHandler.bind(this)),$("#recordbar").hover(function(){window.recordHoverTipShow&&window.recordHoverTip&&window.recordHoverTip.hide()},function(){})}else $("#recordbar").unbind("hover"),$("body").removeClass("state-history"),i.default.dismiss(),$("#preview-page").remove(),setTimeout(function(){t.showPrevewContent(null,!1)},200),this.setPriviewState(!1),$(window).unbind("networkOnline",this.networkOnlineHandler.bind(this)),$(window).unbind("networkOffline",this.networkOfflineHandler.bind(this))}},{key:"networkOnlineHandler",value:function(e){this.isPreviewShow()&&(this.fixBtnView(!0,this.isRevertBtnShown()),this.enableSelectRecord())}},{key:"networkOfflineHandler",value:function(e){this.isPreviewShow()&&(this.fixBtnView(!1,this.isRevertBtnShown()),this.disableSelectRecord())}},{key:"showHistroyList",value:function(){var e=this;i.default.prepareContainer($("#recordbar-body"),!0,function(t,n,o,i,r,s,l,d){if(e.isEnableSelectRecord()){e.selInfo.version=t,e.selInfo.revision=n,e.selInfo.isBigVersion=i,e.selInfo.time=o,e.selInfo.fRev=r,e.selInfo.isRevertVersion=s,e.selInfo.revertAuthor=l,e.fixTitleView();var c=!(i&&t==e.lastestVersion||n==e.latestRevision);e.fixBtnView(c,c),parseInt(n)<d?a.default.showOldSheet(t,n,o,i,r,s,l):(a.default.hideOldSheet(),e.reqRecordForVersion(n,r,s,e.selInfo.revertAuthor,d)),e.reqRecordForVersion(n,r,s,e.selInfo.revertAuthor)}}.bind(this),function(t,n){var o=void 0;o=t?e.requestedMinPage-1:e.requestedMaxPage+1,e.reqRecordsList(!1,o,function(o,i){o&&0==i.retcode&&(e.onGetRecords(i,t),n&&n(i&&0==i.retcode))})}.bind(this))}},{key:"initDefaultVersion",value:function(e){var t=this;p.event.default.trigger("showHistoryList");var n=function(e,n,o){!e||n.retcode;var r=n.history.items,s=n.history.page,l=void 0,d=void 0;if(void 0===o)l=r[0],d=0;else for(var c=0;c<r.length;c++)if(r[c].v===o){l=r[c],d=c;break}l||(l=r[0],d=0),t.selInfo.revision=l.i,t.selInfo.version=l.v,t.selInfo.time=l.t,t.selInfo.newver=n.newver,t.selInfo.isBigVersion=!0,1===s&&(t.lastestVersion=r[0].v,t.latestRevision=r[0].i,i.default.setLatestVersion(t.lastestVersion),i.default.setLatestRevision(t.latestRevision)),t.selInfo.isRevertVersion=!1,t.selInfo.revertAuthor=i.default.getRevertAuthor(l),t.selInfo.newver>0&&a.default.createIFrame(),l.r&&(t.selInfo.isRevertVersion=!0),t.selInfo.isRevertVersion||d===r.length-1||(t.selInfo.fRev=r[d+1].i),i.default.setNewVersion(t.selInfo.newver),t.onGetRecords(n),t.fixTitleView(),t.fixBtnView(!1,!1),0!=r.length&&t.reqRecordForVersion(t.selInfo.revision,t.selInfo.fRev,t.selInfo.isRevertVersion,t.selInfo.revertAuthor,t.selInfo.newver)};this.reqRecordsList(!0,1,function(o,a){if(o&&0==a.retcode)if(void 0===e)n.call(t,o,a);else{a.history.pages;var r=a.history.items[0].v,s=parseInt((r-e)/20)+1;1===s?(n.call(t,o,a,e),i.default.activeBigVersion(e)):t.reqRecordsList(!0,s,function(o,a){n.call(t,o,a,e),i.default.activeBigVersion(e),a.history.items.length<20&&t.reqRecordsList(!0,s-1,function(e,n){t.onGetRecords(n,!0),$("#recordbar-body")[0].scrollTo({top:$("#recordbar-body")[0].scrollHeight,behavior:"smooth"})})})}})}},{key:"bindResizeHandler",value:function(){}},{key:"unbindResizeHandler",value:function(){}},{key:"showRecordPreview",value:function(e,t){var n=this;e?$("#canvasContainerPreview")&&$("#canvasContainerPreview").show():(this.isShow&&(window.CoreSheet.sheetConfig.gEditable=this.preEditableConfig),p.event.default.trigger("pc-header-enable"),p.event.default.trigger("hideHistoryList"),$("#canvasContainerPreview")&&$("#canvasContainerPreview").hide()),this.isShow!=e&&(e?(this.showMainFrame(e),this.showSheetRecordPreview(e),(0,d.tooltip)("#preview-page-back"),this.enableSelectRecord(),this.disableMoreBtn(),this.showHistroyList(),$("#preview-page-back").click(function(){(0,d.hideTooltip)(),n.showRecordPreview(!1),n.report("close"),window.swReportRestart&&window.swReportRestart()}),this.fixBtnView(!1,!1),this.initDefaultVersion(t),this.bindResizeHandler()):(i.default.dismiss(),a.default.hideOldSheet(),this.showMainFrame(e),this.enableMoreBtn(),this.showSheetRecordPreview(e),this.curPage=0,this.totalPage=0,this.requestedMaxPage=0,this.requestedMinPage=0,this.unbindResizeHandler()),this.isShow=e)}},{key:"updateContainerSize",value:function(){var e=document.getElementById("canvasContainerPreview");if(f.isPad){var t=$("header").outerHeight()||54;e.style.transform="translateY("+t+"px)"}e.style.height=window.innerHeight-(0,u.getEditorTop)()-(0,u.getEditorBottom)()+"px"}},{key:"showSheetRecordPreview",value:function(e){e?(0===$("#canvasContainerPreview").length&&$("<div id='canvasContainerPreview' style='display:block;z-index:500;'></div>").appendTo($("#padeditor")),this.updateContainerSize(),this.showPrevewContent(null,!0),$("#inputboxwithpc").hide()):($("#inputboxwithpc").show(),p.event.default.trigger("pc-header-refresh"))}},{key:"getSelTitle",value:function(){var e=(0,c.localstringFromTime)(this.selInfo.time);return this.selInfo.isBigVersion&&(e+=" \u7b2c"+this.selInfo.version+"\u7248",this.selInfo.version==this.lastestVersion&&(e+=" (\u5f53\u524d\u7248\u672c)")),e}},{key:"fixTitleView",value:function(){$(".preview-header-title").text(this.getSelTitle())}},{key:"fixBtnView",value:function(e,t){var n=$(".preview-header-revert");e?n.hasClass("preview-header-revert-disabled")&&(n.removeClass("preview-header-revert-disabled"),n.click(function(){this.onRevertBtnClick()})):n.hasClass("preview-header-revert-disabled")||(n.addClass("preview-header-revert-disabled"),n.unbind("click")),this.isShow?n.show():n.hide(),i.default.fixBtnView(e,this.isShow)}},{key:"isRevertBtnShown",value:function(){return"none"!==$(".preview-header-revert").css("display")}},{key:"isEnableSelectRecord",value:function(){return this._isEnableSelectRecordForVersion}},{key:"enableSelectRecord",value:function(){this._isEnableSelectRecordForVersion=!0,$("#history-list").css("opacity",1)}},{key:"disableSelectRecord",value:function(){this._isEnableSelectRecordForVersion=!1,$("#history-list").css("opacity",.5)}},{key:"enableMoreBtn",value:function(){$(".toolbar-more-btn").removeClass("header-function-btn-disabled")}},{key:"disableMoreBtn",value:function(){$(".toolbar-more-btn").addClass("header-function-btn-disabled")}},{key:"showRevertFailed",value:function(){a.default.hideOldSheet(),(0,l.Custom_Dialog)("\u6062\u590d\u5931\u8d25\uff0c\u8bf7\u7a0d\u5019\u91cd\u8bd5\u3002",{type:"question",title:"\u63d0\u793a",overlay_close:!1,buttons:[{caption:"\u6211\u8981\u53cd\u9988",callback:function(){return(0,h.showSupportPage)(),!0}},{caption:"\u786e\u5b9a",callback:function(){return!0}}]})}},{key:"hideRecordSide",value:function(){p.event.toolBar.trigger("recordChangePanelBeforeHide"),(0,d.hideTooltip)(),this.showRecordPreview(!1),this.isShow=!1,p.event.toolBar.trigger("recordChangePanelAfterHide")}},{key:"isShow",value:function(){return this.isShow}},{key:"report",value:function(e){try{switch(e){case"view":return T_SHEET.Report.tdwReport({opername:"doc_cooper",module:"modify_record",action:"view"});case"recover_his":var t=localStorage.getItem("tdsourcetag");T_SHEET.Report.tdwReport({opername:"doc_core",module:"edit",action:"recover_his",source3:t||""});break;case"clk_recover":T_SHEET.Report.tdwReport({opername:"doc_cooper",module:"modify_record",action:"clk_recover"});break;case"close":T_SHEET.Report.tdwReport({opername:"doc_cooper",module:"modify_record",action:"close"})}}catch(n){console.warn("\u6570\u636e\u4e0a\u62a5\u51fa\u9519",n)}}}]),e}();t.default=new g},"./js/app/history/record-preview.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),window.isRecordPreviewShowing=!1,this.initEvents()}return o(e,[{key:"initEvents",value:function(){var e=this;window.addEventListener("resize",function(t){if(window.isRecordPreviewShowing&&t&&t.isTrusted&&!t.fromImmTableSheet){e.setIFrameWidthAndHeight();var n,o=$("#editor",top.document).css("min-height");o=parseInt(o);var i=!1;(n=$("#editor"))&&n.height()!=o&&(i=!0),i&&$("#editor").height(o),SpreadsheetApp.view.canvas.excel.resize(),$(".offline-preview-body-title-load-wrap",window.parent.document).hide()}})}},{key:"initFr",value:function(){this.fr=document.createElement("iframe"),this.fr.setAttribute("id","preview-iframe"),this.fr_style="z-index:9000;position:fixed;border:none;left:0;"}},{key:"iframeReady",value:function(e){var t=this;this.fr||this.initFr(),this.fr.contentWindow.record_change?e&&e(this.fr.contentWindow.record_change):setTimeout(function(){t.iframeReady(e)},2e3)}},{key:"createIFrame",value:function(){if(this.fr||this.initFr(),!this.fr.src){var e=location.href,t=e.substring(0,e.indexOf("?"));t+="?history=1&pver=0",this.fr.src=t,document.body.appendChild(this.fr),this.setIFrameWidthAndHeight(),this.hideOldSheet()}}},{key:"setIFrameWidthAndHeight",value:function(){if(this.fr||this.initFr(),this.fr.src){var e=document.getElementById("preview-page").offsetTop,t=document.getElementById("padeditor").clientWidth,n=document.getElementById("recordbar").clientHeight+96,o=this.fr_style+"top:"+e+"px;";o+="width:"+t+"px;",o+="height:"+n+"px;",this.fr.setAttribute("style",o)}}},{key:"showSheet",value:function(e,t){e?($("#editor").show(),$("#canvasContainer").hide(),window.isRecordPreviewShowing=!0,$("#grid-preview .excel-container").hover(function(){},function(){window.recordHoverTipShow&&window.recordHoverTip&&window.recordHoverTip.hide()})):(window.isRecordPreviewShowing=!1,$("#canvasContainer").show(),$("#grid-preview .excel-container").unbind("hover"))}},{key:"showOldSheet",value:function(e,t,n,o,i,a,r){var s=this;this.fr||this.initFr(),this.iframeReady(function(l){l.reqRecordForVersion(e,t,n,o,i,a,r),s.fr.style.visibility="visible",navigator.userAgent.indexOf("Firefox")<0&&(s.fr.style.display="block"),s.setIFrameWidthAndHeight()})}},{key:"hideOldSheet",value:function(){this.fr||this.initFr(),this.fr.style.visibility="hidden",navigator.userAgent.indexOf("Firefox")<0&&(this.fr.style.display="none")}},{key:"setOldSheetRecordsInfo",value:function(e){this.iframeReady(function(t){t.onGetRecords(e)})}},{key:"getPreviewTable",value:function(){}}]),e}();t.default=new i},"./js/app/init/pc-init.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=f(n("./js/app/header-fold/index.js")),a=f(n("./js/app/recover/index.js")),r=f(n("./js/app/history/history-list.js")),s=f(n("./js/app/history/record-change.js")),l=f(n("./js/app/header/common/userline-new.js")),d=f(n("./js/app/header/pc/auth-btn.js")),c=n("./js/app/header/util.js"),u=n("./js/event/event-center.js"),p=f(n("./js/app/header/common/title.js")),h=f(n("./js/app/header/pc/right-menu/index.js"));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"immInit",value:function(){}},{key:"initAfterCanvas",value:function(){i.default.init(),a.default.start(),s.default.init(),this.registerEvent()}},{key:"getExport",value:function(){return{historylist:r.default,authBtn:d.default,recordChange:s.default,ReadRecordModule:c.ReadRecordModule,shareDialog:{showShare:c.showShare},header:{title:p.default,rightMenu:h.default}}}},{key:"registerEvent",value:function(){var e=this;u.event.network.listen("deletePad",function(){e.handleDelete()})}},{key:"handleDelete",value:function(){a.default.hasClickedRecover()||(window.location=window.location,window.location.reload(!0))}},{key:"getUserLineInterfaces",value:function(){return l.default.collabListInterfaces}}]),e}();t.default=new m},"./js/app/keyboard/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/component/toast/index.js"),a=(n("./js/utils/browser.js"),p(n("./js/component/common/index.js"))),r=p(n("./js/app/beginner-guide/create-logo-guide.js")),s=p(n("./js/app/header/common/save-status.js")),l=p(n("./js/config/index.js")),d=n("./js/config/sheet.js"),c=n("./js/event/event-center.js"),u=p(n("./js/app/aria/index.js"));function p(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"init",value:function(){c.event.keyboard.listen("keydown",this.onceCtrls.bind(this))}},{key:"onceCtrls",value:function(e){var t=this;if(37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode)return!0;var n=(e.ctrlKey||e.metaKey)&&!e.altKey,o=e.altKey,c=e.shiftKey,p=e.ctrlKey||e.metaKey;if(70===e.keyCode&&n||82===e.keyCode&&n||116===e.keyCode||112===e.keyCode&&n||122===e.keyCode||73===e.keyCode&&e.altKey&&(e.ctrlKey||e.metaKey)||123===e.keyCode)return!0;if(u.default.doAction(p,o,c,e.keyCode,e),67===e.keyCode&&n)return!!l.default.gCopyable||((0,i.showToast)("\u6587\u6863\u4f5c\u8005\u9650\u5236\u4e86\u67e5\u770b\u8005\u7684\u64cd\u4f5c\u6743\u9650\uff0c\u65e0\u6cd5\u590d\u5236\u5185\u5bb9\u3002",{},{supportMobile:!0,isNeedClose:!0}),!1);if(!l.default.gEditable&&l.default.gCopyable){var h=91===e.keyCode&&!e.ctrlKey&&!e.altKey,f=17===e.keyCode&&!e.ctrlKey&&!e.altKey;if(h||f)return!0}if(!l.default.gEditable){if($(e.target).closest(["#permitApplyContainer",".independent-pwd-panel","#DiscussMobileInputWrapper"].join(",")).length)return!0;if(e.target===$("#search-input")[0])return!0;if(e.target===$("#search-panel-input")[0])return!0;if(e.target===$(".SendLogStartTime")[0]||e.target===$(".SendLogEndTime")[0])return!0;return!!{Escape:27,Tab:9,0:48,"-":189,"+":187,"=":187,NumpadAdd:107,NumpadSubtract:109}[e.key]||(e.preventDefault(),!1)}if(83===e.keyCode&&n||e.target.className.indexOf("save")>=0){var m=!1,g=!1;if((0,d.isFullyConnected)()||(m=!0),m&&(g=!this.offlineFirstSaved),g){this.saveNotifyCard&&this.saveNotifyCard.close&&(this.saveNotifyCard.close(),this.saveNotifyCard=null);var w=a.default.createComponentNotifyCard("","normal");m?w.appendHtml($("<div>").attr("class","offline-save-icon")):w.appendHtml($("<div>").attr("class","save-icon docx-icon-common check-blue-62_46dp")),m||w.appendHtml($("<h3>\u81ea\u52a8\u4fdd\u5b58\u6210\u529f</h3>").addClass("title"));var v=void 0;m&&(v=$("<p style='margin-top: 30px; line-height: 1.5em;'>\u5df2\u4fdd\u5b58\u79bb\u7ebf\u7f16\u8f91\u5185\u5bb9\uff0c\u7f51\u7edc\u6062\u590d\u540e\u5c06\u81ea\u52a8\u540c\u6b65\u3002<br>\u5728\u6b64\u671f\u95f4\uff0c\u5173\u95ed\u6d4f\u89c8\u5668\u53ef\u80fd\u4f1a\u5bfc\u81f4\u6570\u636e\u65e0\u6cd5\u6b63\u5e38\u540c\u6b65,\u8bf7\u52ff\u5173\u95ed\u6d4f\u89c8\u5668\u3002</p>").appendTo(w),w.appendHtml(v)),w.onClose=function(){t.saveNotifyCard=null},w.show({pos:"center"}),m&&(this.offlineFirstSaved=!0),this.saveNotifyCard=w}else{var b=(0,r.default)();if(b.checkSaveFlag())return b.showLogoGuide(),e.preventDefault(),!1;m?(!this.isTipsShow&&(0,i.showToast)("\u79bb\u7ebf\u4fdd\u5b58\u6210\u529f\u3002",{top:"5px"}),s.default.showSaveTips("offline",null,"\u76ee\u524d\u7f51\u7edc\u5f02\u5e38\uff0c\u6b63\u5728\u4e3a\u4f60\u81ea\u52a8\u4fdd\u5b58\u79bb\u7ebf\u5185\u5bb9\u3002\n\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002","\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91\uff0c\u7f16\u8f91\u5185\u5bb9\u5df2\u4fdd\u5b58\u81f3\u672c\u5730\uff0c\u8054\u7f51\u540e\u5c06\u81ea\u52a8\u540c\u6b65\u3002")):!this.isTipsShow&&(0,i.showToast)("\u5df2\u81ea\u52a8\u4fdd\u5b58\u3002",{top:"5px"}),!this.isTipsShow&&setTimeout(function(){(0,i.hideToast)(),this.isTipsShow=!1},3e3),this.isTipsShow=!0}return e.preventDefault(),!1}}}]),e}();t.default=new h},"./js/app/lib/transform.js":function(e,t,n){"use strict";var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function(){var n=.017453292519943295,i=function(e,t,n,o,i,a,r,s,l,d,c,u,p,h,f,m){this.elements=window.Float32Array?new Float32Array(16):[];var g=this.elements;g[0]=void 0!==e?e:1,g[4]=t||0,g[8]=n||0,g[12]=o||0,g[1]=i||0,g[5]=void 0!==a?a:1,g[9]=r||0,g[13]=s||0,g[2]=l||0,g[6]=d||0,g[10]=void 0!==c?c:1,g[14]=u||0,g[3]=p||0,g[7]=h||0,g[11]=f||0,g[15]=void 0!==m?m:1};i.prototype={set:function(e,t,n,o,i,a,r,s,l,d,c,u,p,h,f,m){var g=this.elements;return g[0]=e,g[4]=t,g[8]=n,g[12]=o,g[1]=i,g[5]=a,g[9]=r,g[13]=s,g[2]=l,g[6]=d,g[10]=c,g[14]=u,g[3]=p,g[7]=h,g[11]=f,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},multiplyMatrices:function(e,t){var n=e.elements,o=this.elements,i=n[0],a=n[4],r=n[8],s=n[12],l=n[1],d=n[5],c=n[9],u=n[13],p=n[2],h=n[6],f=n[10],m=n[14],g=n[3],w=n[7],v=n[11],b=n[15],_=t[0],y=t[1],T=t[2],E=t[3],C=t[4],x=t[5],S=t[6],k=t[7],A=t[8],I=t[9],R=t[10],O=t[11],D=t[12],j=t[13],M=t[14],N=t[15];return o[0]=i*_+a*C+r*A+s*D,o[4]=i*y+a*x+r*I+s*j,o[8]=i*T+a*S+r*R+s*M,o[12]=i*E+a*k+r*O+s*N,o[1]=l*_+d*C+c*A+u*D,o[5]=l*y+d*x+c*I+u*j,o[9]=l*T+d*S+c*R+u*M,o[13]=l*E+d*k+c*O+u*N,o[2]=p*_+h*C+f*A+m*D,o[6]=p*y+h*x+f*I+m*j,o[10]=p*T+h*S+f*R+m*M,o[14]=p*E+h*k+f*O+m*N,o[3]=g*_+w*C+v*A+b*D,o[7]=g*y+w*x+v*I+b*j,o[11]=g*T+w*S+v*R+b*M,o[15]=g*E+w*k+v*O+b*N,this},_rounded:function(e,t){return t=Math.pow(10,t||15),Math.round(e*t)/t},_arrayWrap:function(e){return window.Float32Array?new Float32Array(e):e},appendTransform:function(e,t,o,i,a,r,s,l,d,c,u,p,h,f){var m=s*n,g=this._rounded(Math.cos(m)),w=this._rounded(Math.sin(m)),v=l*n,b=this._rounded(Math.cos(v)),_=this._rounded(Math.sin(v)),y=d*n,T=this._rounded(Math.cos(-1*y)),E=this._rounded(Math.sin(-1*y));return this.multiplyMatrices(this,this._arrayWrap([1,0,0,e,0,g,w,t,0,-w,g,o,0,0,0,1])),this.multiplyMatrices(this,this._arrayWrap([b,0,_,0,0,1,0,0,-_,0,b,0,0,0,0,1])),this.multiplyMatrices(this,this._arrayWrap([T*i,E*a,0,0,-E*i,T*a,0,0,0,0,1*r,0,0,0,0,1])),(c||u)&&this.multiplyMatrices(this,this._arrayWrap([this._rounded(Math.cos(c*n)),this._rounded(Math.sin(c*n)),0,0,-1*this._rounded(Math.sin(u*n)),this._rounded(Math.cos(u*n)),0,0,0,0,1,0,0,0,0,1])),(p||h||f)&&(this.elements[12]-=p*this.elements[0]+h*this.elements[4]+f*this.elements[8],this.elements[13]-=p*this.elements[1]+h*this.elements[5]+f*this.elements[9],this.elements[14]-=p*this.elements[2]+h*this.elements[6]+f*this.elements[10]),this}};var a=function(e,t,n,o,i,a){return this.a=null==e?1:e,this.b=t||0,this.c=n||0,this.d=null==o?1:o,this.tx=i||0,this.ty=a||0,this};function r(e,t,n){Object.defineProperty(e,t,{get:function(){return this["_"+t]},set:function(e){this["_"+t]=e,n()}})}function s(e,t){if(!e.___mixCSS3Transform){var n,a=["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","rotateX","rotateY","rotateZ","skewX","skewY","originX","originY","originZ"],s=(n=e,"object"===("undefined"===typeof HTMLElement?"undefined":o(HTMLElement))?n instanceof HTMLElement:n&&"object"===("undefined"===typeof n?"undefined":o(n))&&null!==n&&1===n.nodeType&&"string"===typeof n.nodeName);t||a.push("perspective"),e.___mixCSS3Transform=!0,function(e,t,n){for(var o=0,i=t.length;o<i;o++)r(e,t[o],n)}(e,a,function(){var n=e.matrix3d.identity().appendTransform(e.translateX,e.translateY,e.translateZ,e.scaleX,e.scaleY,e.scaleZ,e.rotateX,e.rotateY,e.rotateZ,e.skewX,e.skewY,e.originX,e.originY,e.originZ),o=(t?"":"perspective("+e.perspective+"px) ")+"matrix3d("+Array.prototype.slice.call(n.elements).join(",")+")";s?e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform=o:e.transform=o}),e.matrix3d=new i,t||(e.perspective=500),e.scaleX=e.scaleY=e.scaleZ=1,e.translateX=e.translateY=e.translateZ=e.rotateX=e.rotateY=e.rotateZ=e.skewX=e.skewY=e.originX=e.originY=e.originZ=0}}a.prototype={identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},appendTransform:function(e,t,o,i,a,r,s,l,d){if(a%360)var c=a*n,u=Math.cos(c),p=Math.sin(c);else u=1,p=0;return r||s?(r*=n,s*=n,this.append(Math.cos(s),Math.sin(s),-Math.sin(r),Math.cos(r),e,t),this.append(u*o,p*o,-p*i,u*i,0,0)):this.append(u*o,p*o,-p*i,u*i,e,t),(l||d)&&(this.tx-=l*this.a+d*this.c,this.ty-=l*this.b+d*this.d),this},append:function(e,t,n,o,i,a){var r=this.a,s=this.b,l=this.c,d=this.d;return this.a=e*r+t*l,this.b=e*s+t*d,this.c=n*r+o*l,this.d=n*s+o*d,this.tx=i*r+a*l+this.tx,this.ty=i*s+a*d+this.ty,this},initialize:function(e,t,n,o,i,a){return this.a=e,this.b=t,this.c=n,this.d=o,this.tx=i,this.ty=a,this},setValues:function(e,t,n,o,i,a){return this.a=null==e?1:e,this.b=t||0,this.c=n||0,this.d=null==o?1:o,this.tx=i||0,this.ty=a||0,this},copy:function(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)}},s.getMatrix3D=function(e){var t={translateX:0,translateY:0,translateZ:0,rotateX:0,rotateY:0,rotateZ:0,skewX:0,skewY:0,originX:0,originY:0,originZ:0,scaleX:1,scaleY:1,scaleZ:1};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return(new i).identity().appendTransform(t.translateX,t.translateY,t.translateZ,t.scaleX,t.scaleY,t.scaleZ,t.rotateX,t.rotateY,t.rotateZ,t.skewX,t.skewY,t.originX,t.originY,t.originZ).elements},s.getMatrix2D=function(e){var t={translateX:0,translateY:0,rotation:0,skewX:0,skewY:0,originX:0,originY:0,scaleX:1,scaleY:1};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return(new a).identity().appendTransform(t.translateX,t.translateY,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.originX,t.originY)},"object"===o(t)?e.exports=s:window.Transform=s}()},"./js/app/quick-save/quick-save.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/browser.js");var a=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.offlineFirstSaved=!1,this.isTipsShow=!1,this.saveNotifyCard=null,this.setCookie()}return o(e,[{key:"init",value:function(){window.onceCtrlS=this.onceCtrlS.bind(this)}},{key:"setCookie",value:function(){var e=(new Date).getTime();(0,i.setCookie)("_qpsvr_localtk",e,"qq.com","/",24)}},{key:"createShortcut",value:function(){var e=window.location.href,t={url:e=e.replace("previewtip=1",""),fname:clientVars.padTitle,sheet:!0};return t=JSON.stringify(t),"https://docs.qq.com/preview/link.url?info="+(t=encodeURIComponent(t))}},{key:"creatShortcutToDesktop",value:function(){var e={url:"https://docs.qq.com/desktop/?tdsourcetag=s_browser_shortcut",fname:"\u817e\u8baf\u6587\u6863",IconFile:"https://s1.url.cn/tim/docs/favicon.ico",IconIndex:1};return e=JSON.stringify(e),"https://docs.qq.com/preview/link.url?info="+(e=encodeURIComponent(e))}}]),e}());t.default=a},"./js/app/recover/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js"),a=n("./js/component/toast/index.js"),r=n("./js/utils/browser.js");n("./js/event/event-center.js");var s=i.isMobile||i.isPad,l=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hide=function(){t.$wrapper.hide()},this.hasClicked=!1,this.fromTrash=!1,this.hasInited=!1}return o(e,[{key:"start",value:function(){var e=(0,r.getQuery)("fromTrash");if(null!=e){var t=document.location.href;t=(0,r.removeURLParameter)(t,"fromTrash"),history.replaceState(null,null,t),1==e&&this.setFromTrash(e)}!(2!=clientVars.docStatus)&&this.show()}},{key:"hasClickedRecover",value:function(){return this.hasClicked}},{key:"show",value:function(){this.hasInited||(this.init(),this.bindEvents(),this.hasInited=!0,this.hasClicked=!1),this.$wrapper.show()}},{key:"setFromTrash",value:function(e){this.fromTrash=e}},{key:"init",value:function(){this.$wrapper=$('<div class="recover-doc-overlay">'),s?this.$wrapper.html('\n                <div class="recover-doc-m-dialog">\n                <div class="recover-doc-message-m">\u56de\u6536\u7ad9\u4e2d\u7684\u6587\u6863\u4e0d\u80fd\u7f16\u8f91\uff0c\u5982\u8981\u4f7f\u7528\u8bf7\u8fd8\u539f\u6587\u6863\u3002</div>\n                <div class="recover-doc-action-m">\n                    <a class="recover-doc-m-btn recover-doc-m-btn-cancel">\u53d6\u6d88</a>\n                    <a class="recover-doc-m-btn recover-doc-m-btn-confirm">\u8fd8\u539f</a>\n                </div>\n            '):this.$wrapper.html('\n                <div class="recover-doc-dialog">\n                    <div class="recover-doc-ribbon"></div>\n                    <div class="recover-doc-blank">\n                    </div>\n                    <div class="recover-doc-content">\n                        <div class="recover-doc-title">\u63d0\u793a</div>\n                        <div class="recover-doc-message">\u56de\u6536\u7ad9\u4e2d\u7684\u6587\u6863\u4e0d\u80fd\u7f16\u8f91\uff0c\u5982\u8981\u4f7f\u7528\u8bf7\u8fd8\u539f\u6587\u6863\u3002</div>\n                        <div class="recover-doc-action">\n                            <button class="pad-ui-btn pad-ui-btn-normal pad-ui-btn-white recover-doc-btn-cancel">\u53d6\u6d88</button>\n                            <button class="pad-ui-btn pad-ui-btn-normal pad-ui-btn-blue recover-doc-btn-confirm">\u8fd8\u539f</button>\n                        </div>\n                    </div>\n                </div>\n            '),this.$wrapper.appendTo(document.body)}},{key:"bindEvents",value:function(){var e=this,t=this,n="https://docs.qq.com/desktop/trash";s?(this.$wrapper.find(".recover-doc-m-btn-cancel").click(function(){this.fromTrash&&window.mqq&&mqq.ui&&"0"!==mqq.QQVersion?mqq.ui.popBack():i.isPad?window.location.href=n:window.location.href="https://docs.qq.com/desktop/m/trash"}),document.addEventListener("visibilitychange",function(){e.start()})):this.$wrapper.find(".recover-doc-btn-cancel").click(function(){window.location.href=n}),this.$wrapper.find(".recover-doc-btn-confirm,.recover-doc-m-btn-confirm").click(function(){var n=window.clientVars.globalPadId.split("$"),o=n[0],i=n[1];e.hasClicked=!0;var l=function(n){t.hasClicked=!1;var o="\u8fd8\u539f\u6587\u4ef6\u5931\u8d25\uff0c\u8bf7\u91cd\u8bd5"+((n=n||{}).retcode?" ("+n.retcode+")":"")+"\u3002";s?(0,a.showToast)(o,{},{standardToastType:"default"},null):(0,a.showToast)(o,{top:"20px"},{toolToastCloseTime:5e3},e.$wrapper,!0)};$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/doc_recover",type:"POST",data:{domain_id:o,pad_id:i,xsrf:(0,r.getXsrf)()},success:function(n){var d=n;if("string"===typeof n)try{d=JSON.parse(n)}catch(p){d={}}if(!d||0!==d.retcode){var c=!1,u={errorCode:d.retcode};return T_SHEET&&T_SHEET.CoreUI&&T_SHEET.CoreUI.toast&&T_SHEET.CoreUI.toast.showVipToast&&(c=T_SHEET.CoreUI.toast.showVipToast(u)),c?void t.hide():void l(d?{retcode:d.retcode}:void 0)}if(d.folder_info&&d.folder_info.folder_id){s?(0,a.showToast)("\u8fd8\u539f\u6210\u529f",{},{standardToastType:"default"},null):(0,a.showToast)("\u8fd8\u539f\u6210\u529f",{},{toolToastCloseTime:2e3})}t.fromTrash&&(0,r.setLocalActions)("RECOVER",{domainId:o,localPadId:i,padType:window.clientVars.padType,title:window.clientVars.padTitle,url:window.clientVars.shortLink,list_item_type:1,parent_folder_id:d.folder_info.folder_id}),setTimeout(e.reloadForce,2e3),t.hide()},error:function(e){l(e)}})})}},{key:"reloadForce",value:function(){window.location.reload(!0)}},{key:"setLocalActions",value:function(e,t){t.createdDate=Number(new Date);var n="docs_actions",o=function(e){if("undefined"!==typeof window.Storage)return localStorage.getItem(e)}(n);o=o&&JSON.parse(o)||[];var i={};o.forEach(function(e,t){i[e.localPadId+"$"+e.domainId]={index:t,value:e}});var a=i[t.localPadId+"$"+t.domainId];a?o[a.index]={type:"ADD"===a.value&&"MODIFY"===e?"ADD":e,data:a.value}:o.push({type:e,data:t}),function(e,t){"undefined"!==typeof window.Storage&&localStorage.setItem(e,t)}(n,JSON.stringify(o))}}]),e}();t.default=new l},"./js/app/spread-sheet/index.js":function(e,t,n){"use strict";function o(){var e=SpreadsheetApp.view.canvas.excel.selectData.select;return!!(e.xRange&&e.xRange.length>0&&e.yRange&&e.yRange.length>0)}Object.defineProperty(t,"__esModule",{value:!0}),t.hideCanvasCard=function(){var e=window.SpreadsheetApp;window.SpreadsheetApp&&e.view.canvas.pluginsApi.cardCenter.hideAll()},t.isSelectSingleCell=function(){if(!o())return!1;var e=SpreadsheetApp.view.canvas.excel.selectData.select,t=SpreadsheetApp.spreadsheet.activeSheet,n=void 0,i=void 0;if(null===t)return!1;var a=!0;e.xRange[0]===e.xRange[1]&&e.yRange[0]===e.yRange[1]||(a=!1);if(!a&&(n=t.getMerges())&&n.length>0)for(i=0;i<n.length;i++)if(n[i].startColIndex===e.xRange[0]&&n[i].endColIndex===e.xRange[1]&&n[i].startRowIndex===e.yRange[0]&&n[i].endRowIndex===e.yRange[1]){a=!0;break}return a},t.hasSelect=o,t.hasSelectAll=function(){return window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.excel.selectData.select.selectAll},t.getFormulaEditor=function(){return window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.plugins&&SpreadsheetApp.view.plugins.formulaEditorPanel},t.setTitle=function(e){return window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet.setTitle(e)},t.getTitle=function(){return window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet.getTitle()},t.setgEditable=function(e){return window.SpreadsheetApp&&window.SpreadsheetApp.sheetStatus&&window.SpreadsheetApp.sheetStatus.permission&&window.SpreadsheetApp.sheetStatus.permission.setgEditable(e)},t.getPermission=function(){return window.SpreadsheetApp&&window.SpreadsheetApp.sheetStatus&&window.SpreadsheetApp.sheetStatus.permission}},"./js/app/template-info/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/browser.js"),a=n("./js/script-loader/index.js"),r=n("./js/utils/user-agent.js");var s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.templateModule=null}return o(e,[{key:"init",value:function(){var e=window.clientVars.isOwner,t=window.clientVars.templateInfo&&window.clientVars.templateInfo.templateId,n=window.clientVars.templateInfo&&2===window.clientVars.templateInfo.templateType;e&&"undefined"!==typeof t&&n&&this.templateInit(this.toggleTemplateInfo.bind(this))}},{key:"toggleTemplateInfo",value:function(){var e=this,t="TemplateInfo"+(r.isMobile?"Mobile":"");(0,a.loadModule)(t,function(t){if(e.templateModule=t,r.isMobile)t.isShowing()?t.hide():t.show(window.clientVars);else try{var n=document.getElementById("Template-Panel");n||((n=document.createElement("div")).setAttribute("id","Template-Panel"),document.getElementById("padpage").appendChild(n),t.initShow(n,window.clientVars)),setTimeout(function(){n.classList[n.classList.contains("Template-Panel-show")?"remove":"add"]("Template-Panel-show")},1)}catch(o){console.error(o)}})}},{key:"hide",value:function(){this.templateModule&&this.templateModule.hide()}},{key:"templateInit",value:function(e){var t=this;window.SLR&&SLR.listen("SL-INIT",function(){t.getalltipflag({globalPadId:clientVars.globalPadId,xsrf:(0,i.getXsrf)()},function(t){0===t.createByTemplateFlag&&e()})})}},{key:"getalltipflag",value:function(e,t){$.ajax({type:"get",url:"/ep/api/getalltipflag",data:e,success:function(e){100==e.retcode&&t&&t(e)}})}}]),e}();t.default=new s},"./js/app/template/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.editForTemplate=function(){12==window.clientVars.docStatus&&(window.clientVars.docStatus=0,$.ajax({type:"post",url:"/cgi-bin/online_docs/doc_humtrans",data:{domain_id:clientVars.domainId,pad_id:clientVars.localPadId},success:function(e){},error:function(e){}}))}},"./js/app/tips/new-user-guide.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/event/event-center.js"),r=n("./js/config/index.js"),s=(o=r)&&o.__esModule?o:{default:o};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"showNewUserToast",value:function(){if(console.log("Notify thisIsNewUser"),s.default.gEditable){if(document.referrer&&-1!==document.referrer.indexOf("//docs.qq.com/desktop/m/template"))return void console.log("disable toast");this._showNewUserToast()}}},{key:"_showNewUserToast",value:function(){console.log("Show Icon Toast"),function(e,t){var n=e,o=(t=t||{}).duration,i=t.durationCb||function(){},a=t.cb||function(){},r=t.icon||" tap-edit-ico ",s=$('<div class="wrap-icon-toast"><div class=toast-mask></div><div class="toast-bg"><div class="toast-ico '+r+'"></div><div class="toast-text">'+n+"</div></div>").on("tap click",function(){s.remove(),a()}).appendTo("body");o&&setTimeout(function(){s.remove(),i()},o)}("\u53cc\u51fb\u7f16\u8f91\u6587\u6863",{duration:3e3});try{console.log("TDW expo_floating_window"),T_SHEET.Report.tdwReport({opername:"doc_guide",module:"new_users",action:"expo_floating_window"})}catch(e){console.error(e)}a.event.notificationCenter.one("enterActiveStatus",function(){console.log("TDW clk_floating_window");try{T_SHEET.Report.tdwReport({opername:"doc_guide",module:"new_users",action:"clk_floating_window"})}catch(e){console.error(e)}}),a.event.notificationCenter.one("localChangeContent",function(){console.log("TDW edit");try{T_SHEET.Report.tdwReport({opername:"doc_guide",module:"new_users",action:"edit"})}catch(e){console.error(e)}})}}]),e}();t.default=new l},"./js/app/tips/over-con-number.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/component/toast/index.js"),r=n("./js/config/sheet.js"),s=n("./js/utils/log.js"),l=(o=s)&&o.__esModule?o:{default:o};var d=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.maxEditNum=100,this.refreshDuration=10,this.hasShowRecoverToast=!1,this.intervalRefreshTime=-1}return i(e,[{key:"init",value:function(){this.isOverConNum()&&0!=(2&clientVars.rightFlag)&&this.showDisableEditTips()}},{key:"isOverConNum",value:function(){return!(!clientVars.isOverConNum||clientVars.isCreator)}},{key:"showDisableEditTips",value:function(){(0,a.showToast)("\u5df2\u8fbe\u5230\u540c\u65f6\u7f16\u8f91\u4eba\u6570\u4e0a\u9650\uff0c\u4f60\u76ee\u524d\u4ecd\u80fd\u67e5\u770b\u6b64\u6587\u6863\uff0c\u5982\u9700\u7f16\u8f91\u8bf7\u7a0d\u540e\u5237\u65b0\u7f51\u9875\u5c1d\u8bd5\u3002",{},{isNeedClose:!0})}},{key:"showEnableEditTips",value:function(){this.hasShowRecoverToast=!0,(0,a.showToast)('\u4f60\u53ef\u4ee5\u7f16\u8f91\u6b64\u6587\u6863\u4e86\uff0c\u8bf7<a href="">\u5237\u65b0\u5c1d\u8bd5\u3002</a>',{},{isNeedClose:!0})}},{key:"doRefresh",value:function(){var e=this,t=(0,r.getCurrSubId)(),n="/ep/pad/getdata?padid="+clientVars.globalPadId+"&type=sheet&subid="+t;$.get(n).done(function(t){var n=t&&t.retcode;t.atext&&(window.log&&l.default.info("update success"),e.refreshSheet(t),t.conNum<e.maxEditNum&&0!=(2&clientVars.rightFlag)&&(e.hasShowRecoverToast||e.showEnableEditTips())),0==n||10007==n?(window.log&&l.default.info(t.refreshtime),e.intervalRefreshTime=t.refreshtime||e.intervalRefreshTime):(window.log&&l.default.info(-1),e.intervalRefreshTime=-1)}).fail(function(){window.log&&l.default.error("update fail")}).always(function(){this.intervalRefreshTime>0&&setTimeout(this.doRefresh,this.intervalRefreshTime)})}},{key:"refreshSheet",value:function(e){}}]),e}();t.default=new d},"./js/app/web-socket-ui/offline-preview.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/utils/user-agent.js"),r=n("./js/utils/ui/tooltip.js"),s=n("./js/config/sheet.js"),l=n("./js/component/toast/index.js"),d=n("./js/app/history/record-preview.js"),c=(o=d)&&o.__esModule?o:{default:o},u=n("./js/event/event-center.js");var p=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return i(e,[{key:"requestMetaData",value:function(){var e=this;$(".preview-body-title-load-wrap").show();var t="/dop-api/get/tabs?padId="+clientVars.globalPadId;$.get(t,{},function(t,n){if("success"==n&&0==t.retcode)t.padID=(0,s.getPadId)(),$(".offline-preview-header-title").text("\u5907\u4efd-"+(0,s.getTitle)()),a.isIPad||(0,l.showToast)("\u5efa\u8bae\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730Excel\u3002",{},{isNeedClose:!0}),e.showPrevewContent(t,!0);else{(0,l.showToast)("\u62c9\u53d6\u5931\u8d25\u3002",{top:0},{toolToastCloseTime:2e3},$("#offline-preview-page-body")[0],!0)}})}},{key:"showPrevewContent",value:function(e,t){SpreadsheetApp&&SpreadsheetApp.preview.setRevertMode(t,e,function(){c.default.showSheet(t,e)})}},{key:"showMainFrame",value:function(e){if(e){$("<div id='offline-preview-page' class='offline-preview-page'><div id='offline-preview-page-header' class='offline-preview-page-header'><div id='offline-preview-page-back' class='offline-preview-page-back' data-tooltip='\u8fd4\u56de'><div class='offline-preview-back-icon'></div><div class='offline-preview-back-title'>\u8fd4\u56de</div></div></div><div class='offline-preview-page-body'><div class='offline-preview-body-title-container'><div class='offline-preview-header-title'></div><div class='offline-preview-body-title-load-wrap'><div class='offline-preview-body-title-load'></div></div></div></div></div> ").insertBefore($("#padpage")),$("#preview-body-title").text((0,s.getTitle)())}else this.showPrevewContent(null,!1),$("#offline-preview-page").remove()}},{key:"showRecordPreview",value:function(e){var t=this;e?(this.showMainFrame(e),this.showSheetRecordPreview(e),(0,r.tooltip)("#offline-preview-page-back"),$("#offline-preview-page-back").click(function(){window.showOfflineData=!1,t.showRecordPreview(!1),(0,l.showToast)("\u6570\u636e\u51fa\u9519\uff0c\u79bb\u7ebf\u7f16\u8f91\u5185\u5bb9\u65e0\u6cd5\u4e0a\u4f20\u3002\u5df2\u4e3a\u4f60\u5907\u4efd\u7f16\u8f91\u5185\u5bb9\uff0c",null,{supportMobile:!0,isNeedClose:!0,hideAllOthers:!0,isNeedBtn:!0,btnText:"\u70b9\u51fb\u67e5\u770b",btnTextAfter:"\u3002",btnCallBack:function(){(0,l.hideToast)(),c.default.showRecordChange()}})}),this.requestMetaData()):(this.showSheetRecordPreview(e),this.showMainFrame(e))}},{key:"showSheetRecordPreview",value:function(e){e?(this.showPrevewContent(null,!0),$("header").hide(),$("#inputboxwithpc").hide()):(this.showPrevewContent(null,!1),$("#inputboxwithpc").show(),$("header").show(),u.event.default.trigger("pc-header-refresh"))}},{key:"showRecordChange",value:function(){window.showOfflineData=!0,this.showRecordPreview(!0)}}]),e}();t.default=new p},"./js/app/web-socket-ui/ui-center.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=h(n("./js/component/pad-modals/pad-modals.js")),a=n("./js/component/toast/index.js"),r=h(n("./js/app/header/common/save-status.js")),s=n("./js/app/export/utils.js"),l=h(n("./js/config/index.js")),d=n("./js/utils/user-agent.js"),c=n("./js/utils/browser.js"),u=n("./js/utils/util.js"),p=(n("./js/utils/safe.js"),h(n("./js/app/web-socket-ui/offline-preview.js")),h(n("./js/app/header/common/save-status.js")));function h(e){return e&&e.__esModule?e:{default:e}}var f=new(function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.init=function(){0===$("#auth-change-dialog").length&&$('<div id="auth-change-dialog" class="modaldialog"><div class="modal-tip tip-toast">\u4f60\u5728\u6b64\u8868\u683c\u7684\u6743\u9650\u5df2\u53d1\u751f\u53d8\u5316\uff0c\u70b9\u51fb<span class="refresh">\u5237\u65b0</span>\u3002</div></div>').appendTo(document.body),0===$("#mainmodals").length&&$('\n            <div id="mainmodals">\n                <div id="connectionbox" class="modaldialog">\n                    <div class="disconnected tip-toast">\u5f53\u524d\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u540e\uff0c\u70b9\u51fb<span class="reconnect">\u91cd\u65b0\u8fde\u63a5</span>\u3002</div>\n                    <div class="loading-connect tip-toast">\u6b63\u5728\u8fde\u63a5\u7f51\u7edc\uff0c\u8bf7\u7a0d\u5019...</div>\n                    <div class="connect-fail tip-toast">\u8fde\u63a5\u5931\u8d25\uff0c\u70b9\u51fb<span class="reconnect">\u91cd\u65b0\u8fde\u63a5</span>\u3002</div>\n                </div>\n                <div id="freakout-dialog" class="modaldialog">\n                    <div class="disconnected tip-toast" contenteditable="false">\u6587\u6863\u72b6\u6001\u6709\u66f4\u65b0\uff0c\u70b9\u51fb<span class="refresh">\u5237\u65b0</span>\u3002</div>\n                </div>\n            </div>\n            ').appendTo(document.body),$(".reconnect").click(function(){d.isMiniProgram?window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent((0,c.updateUrl)(window.location.href,"rtime"))}):window.location.href=(0,c.updateUrl)(window.location.href,"rtime")}),$(".refresh").click(function(){d.isMiniProgram?window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent((0,c.updateUrl)(window.location.href,"rtime"))}):window.location.href=(0,c.updateUrl)(window.location.href,"rtime")}),$("#connectionbox .dialog-cancel-x").on("click",function(){$("#modaloverlay").hide(),$("#connectionbox").addClass("compact"),$(".connection-status").hide()}),$("#freakout-copy-first").on("click",function(){$("#modaloverlay").hide(),$("#freakout-dialog").addClass("compact"),$("#freakout-copy-first").hide(),$(".connection-status").hide()}),$("#mainmodals").on("click",".reload",function(){location.reload()}),$("#mainmodals").on("click",".download",t.exportSheetData)},this.exportSheetData=function(){(0,s.exportSheetData)(),T_SHEET.Report.monitor(33534178)},this.showUserChangeSaveSuccessTip=function(){r.default.showSaveTips("saving",3e3,null,"\u5df2\u81ea\u52a8\u4fdd\u5b58")},this.showOfflineEditingTip=function(){r.default.showSaveTips("offline",null,"\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91","\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91"),(0,u.debounce)(function(){r.default.showSaveTips("offline",3e3,"\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f","\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f")},1e3)()},this.socketOpenHideDOM=function(){if($("#connectionbox").removeClass("compact"),$(".connection-status").hide(),$("#modaloverlay").hide(),$("#connectionbox").hide(),!d.isMobile)try{window.external.setNetworkEnable("1")}catch(e){console.log("setNetworkEnable fail")}},this.showOfflineTip=function(){if((0,a.hideToast)(),$(".preview-page").length){var e={};e["margin-left"]="-"+$("#recordbar").css("width"),(0,a.showToast)("\u7f51\u7edc\u5f02\u5e38\u3002\u8fdb\u5165\u79bb\u7ebf"+(l.default.gEditable?"\u7f16\u8f91":"\u67e5\u770b")+"\u6a21\u5f0f\uff0c\u6682\u4e0d\u652f\u6301\u5386\u53f2\u7248\u672c\u7684\u67e5\u770b\u548c\u6062\u590d\u3002",e,{isWarnning:!0,toastType:"typeWarning"},null,!0)}else l.default.gEditable?d.isMobile?(0,a.showToast)("\u7f51\u7edc\u5f02\u5e38\uff0c\u79bb\u7ebf\u7f16\u8f91\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",{top:"48px"},{isWarnning:!0,supportMobile:!0,toastType:"typeWarning"}):(0,a.showToast)("\u7f51\u7edc\u5f02\u5e38\u3002\u8fdb\u5165\u79bb\u7ebf\u7f16\u8f91\u6a21\u5f0f\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",!1,{isWarnning:!0,toastType:"typeWarning"}):(0,a.showToast)("\u79bb\u7ebf\u67e5\u770b\u4e2d\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",!1,{toolToastCloseTime:5e3,supportMobile:!0,toastType:"typeWarning"});r.default.showSaveTips("offline",null,"\u76ee\u524d\u7f51\u7edc\u5f02\u5e38\uff0c"+(l.default.gEditable?"\u6b63\u5728\u4e3a\u4f60\u81ea\u52a8\u4fdd\u5b58\u79bb\u7ebf\u5185\u5bb9\u3002":"\u6b63\u5728\u79bb\u7ebf\u67e5\u770b\u5185\u5bb9\u3002")+"\n\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002","\u6b63\u5728\u79bb\u7ebf"+(l.default.gEditable?"\u7f16\u8f91":"\u67e5\u770b"))},this.showSavedText=function(){p.default.showSavedText()}}return o(e,[{key:"showNetworkErrorModal",value:function(){if((0,a.hideToast)(),!d.isMobile)try{window.external.setNetworkEnable("0")}catch(e){console.log("setNetworkEnable fail")}i.default.showModal("#connectionbox",500,!0)}}]),e}());t.default=f},"./js/component/alert-view-boxs/alert-view-boxs.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/browser.js"),a=n("./js/utils/user-agent.js");var r=function(){function e(t){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.buttonMenuDom=$(".hp-ui-button-menu"),this.menuDom=$(".hp-ui-button-menu-wrapper a"),this.type=t.type,this.title=t.title,this.content=t.content,this.inputMaxLength=t.inputMaxLength,this.inputOverflowTips=t.inputOverflowTips,this.buttons=t.buttons,this.onClose=t.onClose,this.dialogDom=null,this.dialogInputDom=null,this.dialogInputErrorDom=null,this.cdn=clientVars&&clientVars.cdn?clientVars.cdn:"",this.init()}return o(e,[{key:"createDom",value:function(e,t,n){var o=$(document.createElement(t));return o.addClass(n),e.append(o),o}},{key:"show",value:function(){var e=this;this.dialogDom=this.createDom($(document.body),"div","m-component-dialog"),this.dialogDom.on("touchmove",function(e){e.preventDefault()}),this.createDom(this.dialogDom,"div","m-component-dialog-mask").on("touchstart touchend",function(e){e.preventDefault()});var t=this.createDom(this.dialogDom,"div","m-component-dialog-body"),n=this.createDom(t,"div","m-component-dialog-title");this.title&&this.title.length>0&&n.text(this.title),n.on("touchstart touchend",function(e){e.preventDefault()});var o=this.createDom(t,"div","m-component-dialog-content");if("InputBox"===this.type){t.addClass("m-component-dialog-body-input"),document.body.clientHeight<500&&((0,i.isPortrait)()?t.css("top",96):t.css("top",72));var a=this.createDom(o,"div","m-component-dialog-input-box"),r=a[0].clientWidth-28;this.dialogInputDom=this.createDom(a,"input","m-component-dialog-input"),this.dialogInputDom.css("width",r),this.dialogInputDom.attr("spellcheck","false"),this.dialogInputDom.attr("required","required"),this.content&&this.content.length>0&&this.dialogInputDom.val(this.content),this.bindInputListener(this.dialogInputDom);var s=this.createDom(a,"div","m-component-dialog-input-clear");this.createDom(s,"div","clear-image");this.addTap(s,function(){e.dialogInputDom.val(""),e.inputBoxValChange()}),this.dialogInputErrorDom=this.createDom(o,"div","m-component-dialog-input-error-hidden");var l=document.createElement("p");this.dialogInputErrorDom.append(l),o.append(this.dialogInputErrorDom)}else{if(this.content&&this.content.length>0)this.createDom(o,"div","m-component-dialog-message").text(this.content)}for(var d=this.createDom(t,"div","m-component-dialog-footer"),c=0;c<this.buttons.length;c++){var u=this.buttons[c];if(u.label&&u.label.length>0){var p=$(document.createElement("a"));p.addClass("m-component-dialog-button");var h="m-component-dialog-btn-default";"primary"===u.type?h="m-component-dialog-btn-primary":"danger"===u.type&&(h="m-component-dialog-btn-danger"),p.addClass(h),p.text(u.label),d.append(p),this.bindButtonListener(p,u)}}"InputBox"===this.type&&this.focusInputBox()}},{key:"close",value:function(){this.onClose&&this.onClose(),this.dialogDom.remove()}},{key:"getInputText",value:function(){return this.dialogInputDom.val()}},{key:"showInputErrorTips",value:function(e){this.dialogInputErrorDom.addClass("m-component-dialog-input-error"),this.dialogInputErrorDom.children("p").text(e),this.focusInputBox()}},{key:"checkInputError",value:function(){var e=!1;if(this.inputMaxLength&&this.inputMaxLength>0&&this.dialogInputDom.val().length>this.inputMaxLength){var t="\u8f93\u5165\u5185\u5bb9\u8fc7\u957f\u3002";this.inputOverflowTips&&this.inputOverflowTips.length>0&&(t=this.inputOverflowTips),this.showInputErrorTips(t),e=!0}return e}},{key:"focusInputBox",value:function(){var e=this;a.isIOS?this.dialogInputDom.focus():setTimeout(function(){e.dialogInputDom.focus().click()},100)}},{key:"inputBoxValChange",value:function(){this.checkInputError()&&this.dialogInputErrorDom.removeClass("m-component-dialog-input-error")}},{key:"bindInputListener",value:function(e){var t=this;e.on("input propertychange change",function(){t.inputBoxValChange()}),e.blur(function(){if(a.isIOS)for(var e=0;e<t.buttons.length;e++){var n=t.buttons[e];if("primary"===n.type){n.onclick&&"function"===typeof n.onclick&&n.onclick(t);break}}})}},{key:"bindButtonListener",value:function(e,t){var n=this;e.on("click",function(e){t.onclick&&"function"===typeof t.onclick?t.onclick(n,e):n.close()})}},{key:"addTap",value:function(e,t){e.on("touchstart",function(e){var t=e.originalEvent.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()}),e.on("touchend",function(e){e.preventDefault();var n=e.originalEvent.changedTouches[0],o=n.clientX,i=n.clientY;void 0===this.touchT||Date.now()>this.touchT+400||Math.abs(i-this.touchY)>30||Math.abs(o-this.touchX)>30||t()})}},{key:"init",value:function(){var e=this;this.buttonMenuDom.on("click",function(){var t=e.buttonMenuDom;if(!t.attr("disabled")){$("#tooltip").remove();var n=t.hasClass("hp-ui-button-menu-reverse"),o=t.find(".hp-ui-button-menu-wrapper"),i=t.find(".hp-ui-button-list-ul"),a=t.find(".hp-ui-button-list-ul li"),r=-1;if(t.data("close",e.buttonCloseMenu),o.is(":visible"))e.buttonCloseMenu(t);else{i.css("min-width",t.outerWidth()+"px"),o.show(),t.addClass("hp-ui-button-active");var s=Math.max(200,Math.min($("body").height()-i.offset().top-50,435));i.css("max-height",s+"px"),n&&i.css("top","-"+(i.outerHeight()+t.outerHeight()+10)+"px"),window.setTimeout(function(){$("body").on("keydown.hp-ui-button-menu",function(n){if(o.is(":hidden"))return!0;var s=r;switch(n.keyCode){case 13:return i.find("li.hp-ui-button-menuitem-selected > a").trigger("click"),!1;case 27:return e.buttonCloseMenu(t),!1;case 38:r=r-1<0?a.length-1:r-1;break;case 40:r=(r+1)%a.length;break;default:return!0}return i.find("li:nth-child("+(s+1)+")").removeClass("hp-ui-button-menuitem-selected"),i.find("li:nth-child("+(r+1)+")").addClass("hp-ui-button-menuitem-selected"),!1}).on("click.hp-ui-button-menu",function(){e.buttonCloseMenu(t)})},0)}}}),this.menuDom.on("click",function(){if(!e.menuDom.hasClass("hp-ui-button-menu-disabled")){var t=e.menuDom.closest(".hp-ui-button");t.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.buttonCloseMenu(t)}})}},{key:"buttonCloseMenu",value:function(e){$("body").off(".hp-ui-button-menu"),e.find(".hp-ui-button-menu-wrapper").hide(),e.removeClass("hp-ui-button-active"),e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.trigger("menu-closed")}}]),e}();t.default=r},"./js/component/banner/common-banner-mo.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/ui/dom.js");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"showBottom",value:function(e,t,n,o,a){if($("#common-banner-mo").length>0)return!1;var r=this,s=$("<div>").attr("id","common-banner-mo").addClass("common-banner-mo").addClass("user-select-none").append($("<div>").addClass("docx-icon-common").addClass("banner-left-corner").addClass("banner-mo-left-corner-pos")).append($("<div>").addClass("docx-icon-common").addClass("banner-right-corner").addClass("banner-mo-right-corner-pos")).append($("<div>").addClass("docx-icon-common").addClass("close-normal_20dp").addClass("banner-mo-close-btn").click(function(){r.hide(),o&&o(!1)}));n&&s.append($("<div>").addClass("banner-mo-btn").addClass("header-function-btn-blue-normal").text(n).click(function(){r.hide(),o&&o(!0)}));var l=$("<div>").addClass("banner-mo-center").append($("<div>").addClass("docx-icon-common").addClass("txdoc-logo_42dp").addClass("banner-mo-logo-pos")).append($("<div>").addClass("banner-mo-tip-container").append($("<div>").addClass("banner-mo-tip").html(e)).append($("<div>").addClass("banner-mo-subtip").html(t)));return s.append(l),s.appendTo($("body")),(0,i.btnState)(s.find(".banner-mo-btn"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,i.btnState)(s.find(".banner-mo-close-btn"),"close-normal_20dp","close-hover_20dp","close-click_20dp"),!0}},{key:"hide",value:function(){$("#common-banner-mo").remove()}}]),e}();t.default=new a},"./js/component/banner/common-banner-pc.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/ui/dom.js");var a=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"showCommon",value:function(e,t,n,o,a){if($("#common-banner-pc").length>0)return!1;var r=$("<div>").attr("id","common-banner-pc").addClass("common-banner-pccommon").addClass("user-select-none").append($("<div>").addClass("banner-pccommon-btn").addClass("header-function-btn-blue-normal").text(n).click(function(){self.hide(),o&&o(!0)})).append($("<div>").addClass("docx-icon-common").addClass("banner-pcbottom-close-btn").addClass("close-normal_20dp").click(function(){self.hide(),o&&o(!1)})),s=$("<div>").addClass("banner-pccommon-center");return s.append($("<div>").addClass("banner-pccommon-tip-container").append($("<div>").addClass("banner-pccommon-tip").add("user-select-none").text(e)).append($("<div>").addClass("banner-pccommon-subtip").add("user-select-none").text(t))),r.append(s),r.appendTo($("body")),a>0&&setTimeout(function(){self.hide()},1e3*a),(0,i.btnState)(r.find(".banner-pccommon-btn"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,i.btnState)(r.find(".banner-pcbottom-close-btn"),"close-normal_20dp","close-hover_20dp","close-click_20dp"),!0}},{key:"showBottom",value:function(e,t,n,o,a){if($("#common-banner-pc").length>0)return!1;var r=$("<div>").attr("id","common-banner-pc").addClass("common-banner-pcbottom").addClass("user-select-none").append($("<div>").addClass("banner-pcbottom-btn").addClass("banner-pcbottom-btn").addClass("header-function-btn-blue-normal").text(n).click(function(){self.hide(),o&&o(!0)})).append($("<div>").addClass("docx-icon-common").addClass("banner-pcbottom-close-btn").addClass("close-normal_20dp").click(function(){self.hide(),o&&o(!1)})),s=$("<div>").addClass("banner-pcbottom-center");return"shortcut"===a.iconType?s.append($("<div>").addClass("shortcut-to-desktop-pclogo").addClass("banner-pcbottom-logo-pos").add("user-select-none")):"bookmark"===a.iconType?s.append($("<div>").addClass("bookmark-to-desktop-pclogo").addClass("banner-pcbottom-logo-pos").add("user-select-none")):s.append($("<div>").addClass("docx-icon-common").addClass("txdoc-logo_56dp").addClass("banner-pcbottom-logo-pos").add("user-select-none")),a.title&&"img"===a.title.type?s.append($("<div>").addClass("banner-pcbottom-tip-container").append($("<div>").addClass("banner-pcbottom-tip").addClass("banner-pcbottom-tip-img").add("user-select-none").css(a.title.style)).append($("<div>").addClass("banner-pcbottom-subtip").add("user-select-none").text(t))):s.append($("<div>").addClass("banner-pcbottom-tip-container").append($("<div>").addClass("banner-pcbottom-tip").add("user-select-none").text(e)).append($("<div>").addClass("banner-pcbottom-subtip").add("user-select-none").text(t))),r.append(s),r.appendTo($("body")),(0,i.btnState)(r.find(".banner-pcbottom-btn"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),(0,i.btnState)(r.find(".banner-pcbottom-close-btn"),"close-normal_20dp","close-hover_20dp","close-click_20dp"),!0}},{key:"hide",value:function(){$("#common-banner-pc").remove()}}]),e}();t.default=new a},"./js/component/common/close-button/close-button.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.originalParams={top:"20px",right:"20px",position:"absolute"}}return o(e,[{key:"createComponentClose",value:function(e,t,n){var o=this;if(e){this.ComponentClose=$("<div class='common-close-bt-normal docx-icon-common'></div>"),e.append(this.ComponentClose),$.each(this.originalParams,function(e,t){o.ComponentClose&&o.ComponentClose.css(e,t)}),t&&$.each(t,function(e,t){o.ComponentClose&&o.ComponentClose.css(e,t)}),this.bindComponentEvent(n)}}},{key:"bindComponentEvent",value:function(e){var t=this;this.ComponentClose&&(this.ComponentClose.click(function(){e&&e()}),this.ComponentClose.hover(function(){t.ComponentClose&&t.ComponentClose.removeClass("common-close-bt-normal").addClass("common-close-bt-hover")},function(){t.ComponentClose&&t.ComponentClose.removeClass("common-close-bt-hover").addClass("common-close-bt-normal")}))}},{key:"destroyComponentClose",value:function(){this.ComponentClose&&(this.ComponentClose.remove(),this.ComponentClose=null)}}]),e}();t.default=i},"./js/component/common/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=d(n("./js/component/common/close-button/close-button.js")),a=d(n("./js/component/common/notify-card/notify-card.js")),r=d(n("./js/component/common/online-dialog/online-dialog.js")),s=d(n("./js/component/common/prompt-box/prompt-box.js")),l=d(n("./js/component/common/qrcode/qrcode.js"));function d(e){return e&&e.__esModule?e:{default:e}}var c=new(function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.CloseButton=new i.default,this.OnlineDocDialog=r.default,this.PromptBox=new s.default,this.QrCode=new l.default}return o(e,[{key:"createComponentNotifyCard",value:function(e,t){return new a.default(e,t)}}]),e}());t.default=c},"./js/component/common/notify-card/notify-card.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=n("./js/component/common/close-button/close-button.js"),a=(o=i)&&o.__esModule?o:{default:o};t.default=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.show=function(e){return e||(e={}),this.template&&this.template.remove(),this.template=this._createTemplate(e),e.css&&this.template.css(e.css),e.pos&&this.template.addClass(e.pos),(e.container?e.container:$("body")).append(this.template),this.template.hide().fadeIn(300),this},this.close=function(){return this.template&&this.template.fadeOut(300,function(){this.template&&this.template.remove(),this.onClose&&this.onClose()}.bind(this)),this},this.appendText=function(e){return this.contents.push($("<p></p>").text(e)),this},this.appendHtml=function(e){return this.contents.push(e),this},this._createTemplate=function(e){$("<h1></h1>").text(this.title);var t=$('<div class="header"></div>');this.title&&$("<h1></h1>").text(this.title).appendTo(t),e.disableClose||(new a.default).createComponentClose(t,{top:0,right:0},this.close.bind(this));var n=$('<div class="notify-card"></div>').append(t);return this.contents.forEach(function(e){n.append(e)}),n.addClass(this.type),n},this.title=t,this.type=n||"error",this.contents=[]}},"./js/component/common/online-dialog/online-dialog.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n("./js/component/common/close-button/close-button.js"),s=(o=r)&&o.__esModule?o:{default:o};var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.DialogContainer=null,this.contentWrap=null,this.DialogCoverLayer=null,this.DialogConfirmBt=null,this.DialogClose=null,this.confirmCb=null}return a(e,[{key:"createDialog",value:function(e,t,n){Array.isArray(e)&&(this.DialogContainer?this.DialogContainer.appendTo($("body")):(this.DialogContainer=$("<div class='dialog-container'><div class='dialog-title'>\u7248\u672c\u66f4\u65b0\u516c\u544a</div><div class='dialog-content-wrapper'></div><button class='dialog-confirm-bt'>\u6211\u77e5\u9053\u4e86</button></div>"),this.DialogContainer.appendTo($("body"))),this.DialogCoverLayer=$("<div class='dialog-cover-layer'></div>"),this.DialogCoverLayer.appendTo($("body")),(new s.default).createComponentClose(this.DialogContainer,null,this.closeCallback),this.contentWrap=$(".dialog-content-wrapper"),this.DialogConfirmBt=$(".dialog-confirm-bt"),n&&(this.confirmCb=n),t&&$.each(t,function(e,t){this.DialogContainer.css(e,t)}),$.each(e,function(e,t){"object"==("undefined"===typeof t?"undefined":i(t))&&$.each(t,function(e,t){if(e&&$(".dialog-title").after($("<div class='dialog-date'>"+e+"</div>")),Array.isArray(t)){var n=0;$.each(t,function(e,t){1==++n?this.contentWrap.append($("<div><div class='dialog-text-list dialog-text-list-first'></div><div class='dialog-text dialog-text-first'>"+t+"</div></div>")):this.contentWrap.append($("<div><div class='dialog-text-list'></div><div class='dialog-text'>"+t+"</div></div>"))})}})}),this.initEvents())}},{key:"closeCallback",value:function(){this.destoryDialog(),this.confirmCb=null}},{key:"destoryDialog",value:function(){this.DialogContainer&&(this.DialogContainer.remove(),this.DialogContainer=null),this.DialogCoverLayer&&this.DialogCoverLayer.remove()}},{key:"initEvents",value:function(){var e=this;this.DialogConfirmBt.click(function(){e.destoryDialog(),e.confirmCb(),e.confirmCb=null})}}]),e}();t.default=new l},"./js/component/common/prompt-box/prompt-box.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.box_cancel=null,this.box_commit=null,this.promptbox=null}return o(e,[{key:"bindBoxEvents",value:function(e,t){e.off("touchend").on("touchend",t)}},{key:"createComponentPromptBox",value:function(e,t,n){if(!this.promptbox){this.promptbox=$('<div class="promptbox"><div class="promptbox_top"><div class="promptbox_content">\u8be5\u6587\u6863\u542b\u8868\u683c\uff0c\u9700\u5347\u7ea7\u5230\u65b0\u7248\u624d\u80fd\u4fdd\u8bc1\u987a\u7545\u7684\u7f16\u8f91\u4f53\u9a8c\u3002 </div></div><div class="promptbox_bottom"><div class="promptbox_cancel">\u6682\u4e0d\u5347\u7ea7</div><div class="promptbox_commit">\u5347\u7ea7</div></div></div><div class="promptbox_overlays"></div>'),e.append(this.promptbox),this.box_cancel=$(".promptbox_cancel"),this.box_commit=$(".promptbox_commit"),this.bindBoxEvents(this.box_cancel,t),this.bindBoxEvents(this.box_commit,n)}}},{key:"destroyComponentPromptBox",value:function(){this.box_cancel=null,this.box_commit=null,this.promptbox&&(this.promptbox.remove(),this.promptbox=null)}}]),e}();t.default=i},"./js/component/common/qrcode/qrcode.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/browser.js"),a=n("./js/utils/hash.js");var r=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.$el=null,this.qrcodeSrc="",this._qrcodeType=null,this._qrcodeParam=null}return o(e,[{key:"create",value:function(e,t,n){e&&0!==e.length&&(this.$el||(this._qrcodeType=t,this._qrcodeParam=n,this.$el=$('<div class="ui-common-qrcode">\n                <div class="ui-common-qrcode-popup-wrapper">\n                    <div class="ui-common-qrcode-popup">\n                        <div class="ui-common-qrcode-popup-img">\n                            <img />\n                        </div>\n                        <div class="ui-common-qrcode-popup-text">\u624b\u673a\u626b\u7801\u67e5\u770b</div>\n                    </div>\n                    <div class="ui-common-qrcode-popup ui-common-qrcode-popup-refresh">\n                        <div class="ui-common-qrcode-popup-img">\n                            <div class="ui-common-qrcode-popup-refresh-icon"></div>\n                        </div>\n                        <div class="ui-common-qrcode-popup-text">\u4e8c\u7ef4\u7801\u52a0\u8f7d\u5931\u8d25\uff0c\u8bf7\u70b9\u51fb\u5237\u65b0</div>\n                    </div>\n                </div>\n            </div>'),e.append(this.$el),this.bindEvents()))}},{key:"bindEvents",value:function(){var e=this;this.$el.on("mouseover",function(){e.qrcodeSrc||e.setQrcodeSrc(),"preview"===e._qrcodeType?T_SHEET.Report.tdwReport({opername:"doc_pcview"+(localStorage&&localStorage.previewOpenFrom||"fromunknown"),module:"oper",action:"pre_ptlog_hover"}):T_SHEET.Report.tdwReport({opername:"doc_pcdet",module:"ptlog",action:"web_det_hover"}),e.$el.addClass("js-show-qrcode")}),this.$el.on("mouseout",function(){e.$el.removeClass("js-show-qrcode")}),this.$el.find(".ui-common-qrcode-popup-img img").on("error",function(t){console.log(t),e.$el.addClass("js-show-refresh"),e.$el.find(".ui-common-qrcode-popup-img").one("click",function(t){t.stopPropagation(),e.setQrcodeSrc(!0)})}),this.$el.find(".ui-common-qrcode-popup-img img").on("load",function(){e.$el.removeClass("js-show-refresh")})}},{key:"setQrcodeSrc",value:function(e){var t=this;if("preview"===this._qrcodeType){var n=window.location.protocol+"//docs.qq.com/preview/cgi/save_to_mylist2?qrpr=1&fid="+(this._qrcodeParam&&this._qrcodeParam.uniqueFileId||"");this.qrcodeSrc=window.location.protocol+"//docs.qq.com/cgi-bin/online_docs/qrcode?xsrf="+(0,i.getXsrf)()+"&url="+encodeURIComponent(n)+"&t="+Date.now()}"formPreview"===this._qrcodeType?this.qrcodeSrc=window.location.protocol+"//docs.qq.com/form/preview/"+this._qrcodeParam.uniqueFileId:this.qrcodeSrc=window.location.protocol+"//docs.qq.com/cgi-bin/online_docs/qrcode?xsrf="+(0,i.getXsrf)()+"&url="+encodeURIComponent(window.location.href.replace(/\?.*$/,"").replace(/#.*$/,"")+"?opendocxfrom=qrcode"+(0,a.getToalHash)())+"&t="+Date.now(),e?$.ajax({url:this.qrcodeSrc,complete:function(){t.$el.find(".ui-common-qrcode-popup-img img").attr("src",t.qrcodeSrc)}}):this.$el.find(".ui-common-qrcode-popup-img img").attr("src",this.qrcodeSrc)}},{key:"destroy",value:function(){this.$el=null,this.qrcodeSrc=""}}]),e}();t.default=r},"./js/component/dialog/common-dialog-banner.js":function(e,t,n){"use strict";var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();!function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}o(e,[{key:"show",value:function(e,t,n,o,i){if($("#common-dialog-banner").length>0)return!1;var a=$("<div>").attr("id","common-dialog-banner").css({"z-index":1001001,position:"fixed"}),r=$("<div>").css("display","block"),s=$("<div>").addClass("eeui-mask"),l=$("<div>").addClass("eeui-dialog-banner"),d=$("<div>").addClass("eeui-dialog-banner__hd").append($("<div>").addClass(e?"":"eeui-dialog-banner__banner").addClass("docx-icon-common").addClass(e?"dialog-new-user-guide-header":"common-dialog-banner-header")),c=$("<div>").addClass("eeui-dialog-banner__bd").append($("<div>").addClass("eeui-dialog-banner__info").addClass(e?"new-user-guide":"").text(t)),u=$("<div>").addClass("eeui-dialog-banner__ft").append($("<a>").attr("href","#").addClass("eeui-dialog-banner__btn").text(n).click(function(e){e.preventDefault(),self.hide(),o&&o(!0)})),p=$("<div>").addClass("eeui-dialog-banner__ot").append($("<div>").addClass("eeui-dialog-banner__close").addClass("docx-icon-common").addClass("common-dialog-banner-close").click(function(){self.hide(),o&&o(!1)}));return l.append(d).append(c).append(u).append(p),r.append(s).append(l),a.append(r),a.appendTo($("body")),i>0&&setTimeout(function(){self.hide()},1e3*i),!0}},{key:"hide",value:function(){$("#common-dialog-banner").remove()}}])}()},"./js/component/dialog/custom-dialog.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DefaultButtons=void 0,t.Custom_Dialog=function(e,t){return $.Custom_Dialog(e,t)},n("./js/component/dialog/jquery.customDialog.js");t.DefaultButtons={OK:"\u786e\u5b9a",Cancel:"\u53d6\u6d88"}},"./js/component/dialog/jquery.customDialog.js":function(module,exports,__webpack_require__){"use strict";var _typeof="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};!function($){$.Custom_Dialog=function(){var defaults={animation_speed_hide:250,animation_speed_show:0,auto_close:!1,buttons:!0,center_buttons:!1,custom_class:!1,keyboard:!0,max_height:0,message:"",isAria:!1,modal:!0,overlay_close:!0,overlay_opacity:"1",overlay_class:!1,position:"center",reposition_speed:500,show_close_button:!0,source:!1,title:"",type:"information",show_icon:!1,vcenter_short_message:!0,width:0,onClose:null,only_mobile:!1,border_top:!0},plugin=this,options={},timeout;plugin.settings={},"string"==typeof arguments[0]&&(options.message=arguments[0]),"object"!=_typeof(arguments[0])&&"object"!=_typeof(arguments[1])||(options=$.extend(options,"object"==_typeof(arguments[0])?arguments[0]:arguments[1])),plugin.init=function(){var e;plugin&&(plugin.dialog&&plugin.dialog.remove&&plugin.dialog.remove(),plugin.overlay&&plugin.dialog.remove&&plugin.overlay.remove()),plugin.settings=$.extend({},defaults,options),plugin.isIE6="explorer"==browser.name&&6==browser.version||!1,plugin.settings.modal&&(plugin.overlay=$("<div>",{class:"CustomDialogOverlay "+(plugin.settings.overlay_class?" "+plugin.settings.overlay_class:"")}).css({position:(plugin.isIE6,"absolute"),left:0,top:0,opacity:plugin.settings.overlay_opacity,"z-index":"100004"}),plugin.settings.overlay_close&&(plugin.overlay.bind("click",function(e){plugin.close(void 0,e)}),plugin.overlay.bind("mousedown",function(e){e.preventDefault()})),plugin.overlay.appendTo("body")),plugin.dialog=$("<div>",{class:"CustomDialog CustomDialog_"+get_type()+(plugin.settings.custom_class?" "+plugin.settings.custom_class:"")}).css({position:(plugin.isIE6,"absolute"),left:0,top:0,visibility:"hidden","z-index":"100004","border-radius":"2px"}),plugin.settings.only_mobile&&plugin.dialog.css("min-height","163px"),plugin.settings.border_top||plugin.dialog.css("border-top","none"),!plugin.settings.buttons&&plugin.settings.auto_close&&plugin.dialog.attr("id","CustomDialog_"+Math.floor(9999*Math.random()));var t=parseInt(plugin.settings.width,10);!isNaN(t)&&t==plugin.settings.width&&t.toString()==plugin.settings.width.toString()&&t>0&&plugin.dialog.css({width:plugin.settings.width}),plugin.settings.title&&(e=$("<h3>",{class:"CustomDialog_Title"}).html(plugin.settings.title),plugin.settings.only_mobile&&e.css({"text-align":"center","border-bottom":"none","padding-top":"16px","font-size":"20px","font-weight":"normal","padding-bottom":"8px"}),e.appendTo(plugin.dialog));var n=get_buttons(),o=$("<div>",{class:"CustomDialog_BodyOuter"+(plugin.settings.title?"":" CustomDialog_NoTitle")+(n?"":" CustomDialog_NoButtons")}).appendTo(plugin.dialog);if(plugin.message=$("<div>",{class:"CustomDialog_Body"+(!1!==plugin.settings.show_icon?" CustomDialog_Icon":"")+(plugin.settings.body_padding?" cus_body_padding":"")}),plugin.settings.only_mobile&&plugin.message.css({"padding-top":"0px","padding-bottom":"20px"}),plugin.settings.max_height>0&&(plugin.message.css("max-height",plugin.settings.max_height),plugin.isIE6&&plugin.message.attr("style","height: expression(this.scrollHeight > "+plugin.settings.max_height+' ? "'+plugin.settings.max_height+'px" : "85px")')),"Waiting"===get_type()){$("<div>",{class:"CustomDialog-Loading"}).html('<div class="csheet-load-wrap"><div class="csheet-load-wrap-bg"></div><div class="csheet-spin"><div class="bar1"></div><div class="bar2"></div><div class="bar3"></div><div class="bar4"></div><div class="bar5"></div><div class="bar6"></div><div class="bar7"></div><div class="bar8"></div><div class="bar9"></div><div class="bar10"></div><div class="bar11"></div><div class="bar12"></div></div></div>').appendTo(plugin.message)}if(plugin.settings.vcenter_short_message){var i=$("<div>");plugin.settings.only_mobile&&i.css("font-size","16px"),i.html(plugin.settings.message).appendTo(plugin.message)}else plugin.message.html(plugin.settings.message);if(plugin.settings.source&&"object"==_typeof(plugin.settings.source)){var a=plugin.settings.vcenter_short_message?$("div:first",plugin.message):plugin.message;for(var r in plugin.settings.source)switch(r){case"ajax":var s="string"==typeof plugin.settings.source[r]?{url:plugin.settings.source[r]}:plugin.settings.source[r],l=$("<div>").attr("class","CustomDialog_Preloader").appendTo(a);s.success=function(e){l.remove(),a.append(e),draw(!1)},$.ajax(s);break;case"iframe":var d=$.extend({width:"100%",height:"100%",marginheight:"0",marginwidth:"0",frameborder:"0"},"string"==typeof plugin.settings.source[r]?{src:plugin.settings.source[r]}:plugin.settings.source[r]);a.append($("<iframe>").attr(d));break;case"inline":a.append(plugin.settings.source[r])}}if("Waiting"===get_type()){var c=$("<div>",{class:"CustomDialog-Waiting-Cancel"}).appendTo(plugin.message);c.html("\u53d6\u6d88"),plugin.settings.only_mobile?(c.on("touchstart",function(e){$(this).css("background","#e9e9e9")}),c.on("touchend",function(e){$(this).css("background","#fff"),plugin.close(void 0,e)})):c.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),c.bind("click",function(e){plugin.close(void 0,e)})}if(plugin.message.appendTo(o),n){n.reverse();var u=$("<div>",{class:"CustomDialog_Buttons"}).appendTo(plugin.dialog);plugin.settings.only_mobile&&u.css({margin:"0",width:"100%"}),$.each(n,function(e,t){var o;o=plugin.settings.only_mobile?$("<div>",0==e?{class:"ButtonMobile0"}:{class:"ButtonMobile1"}):$("<button>",{type:"button",class:"CustomDialog_Button_"+e});var i=t;$.isPlainObject(t)?(o.html(t.caption),i=t.caption):o.html(t),o.attr("aria-label",e===n.length-1?plugin.settings.message:i),o.attr("tabindex",10),plugin.settings.custom_class||plugin.settings.only_mobile||o.html()!==$.Custom_Dialog.DefaultButtons.Cancel||o.addClass("ZebraDialog_Buttons_Cancel"),plugin.settings.only_mobile?(o.on("touchstart",function(){$(this).css("background","#e9e9e9")}),o.on("touchend",function(){$(this).css("background","#fff")})):o.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),o.bind("click",function(e){var n=!0;void 0!==t.callback&&(n=t.callback(plugin.dialog,e)),!1!==n&&plugin.close(void 0!==t.caption?t.caption:t,e)}),o.appendTo(u)}),plugin.settings.only_mobile?u.wrap($("<div>").addClass("CustomDialog_ButtonsOuterMobile"+(plugin.settings.center_buttons?" CustomDialog_Buttons_Centered":""))):u.wrap($("<div>").addClass("CustomDialog_ButtonsOuter"+(plugin.settings.center_buttons?" CustomDialog_Buttons_Centered":"")))}if(plugin.dialog.appendTo("body"),plugin.settings.show_close_button){var p='<span class="CustomDialog_Close">&times;</span>';/^standard/i.test(get_type())&&(p='<span class="CustomDialog_Close_Standard"></span>');var h=$(p).bind("click",function(e){plugin.close(void 0,e)}).appendTo(e||plugin.message);h.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),e&&h.css({right:parseInt(e.css("paddingRight"),10),top:(parseInt(e.css("height"),10)+parseInt(e.css("paddingTop"),10)+parseInt(e.css("paddingBottom"),10)-h.height())/2})}return $(window).bind("resize.Custom_Dialog",function(){clearTimeout(timeout),timeout=setTimeout(function(){draw()},100)}),plugin.settings.keyboard&&$(document).bind("keyup.Custom_Dialog",function(e){return 27==e.which&&plugin.close(void 0,e),!0}),plugin.isIE6&&$(window).bind("scroll.Custom_Dialog",function(){emulate_fixed_position()}),!1!==plugin.settings.auto_close&&(plugin.dialog.bind("click",function(e){clearTimeout(plugin.timeout),plugin.close(void 0,e)}),plugin.dialog.bind("mousedown",function(e){e.preventDefault(),e.stopPropagation()}),plugin.timeout=setTimeout(plugin.close,plugin.settings.auto_close)),draw(!1),plugin},plugin.close=function(e,t){$(document).unbind(".Custom_Dialog"),$(window).unbind(".Custom_Dialog"),plugin.overlay&&plugin.overlay.animate({opacity:0},plugin.settings.animation_speed_hide,function(){plugin.overlay.remove()}),plugin.settings.onCloseBeforeAnimate&&"function"==typeof plugin.settings.onCloseBeforeAnimate&&plugin.settings.onCloseBeforeAnimate(void 0!==e?e:"",t),plugin.dialog.animate({opacity:0},plugin.settings.animation_speed_hide,function(){plugin.dialog.remove(),plugin.settings.onClose&&"function"==typeof plugin.settings.onClose&&plugin.settings.onClose(void 0!==e?e:"",t)})};var draw=function draw(){var viewport_width=$(window).width(),viewport_height=$(window).height(),dialog_width=plugin.dialog.width(),dialog_height=plugin.dialog.height(),values={left:0,top:0,right:viewport_width-dialog_width,bottom:viewport_height-dialog_height,center:(viewport_width-dialog_width)/2,middle:(viewport_height-dialog_height)/2},changeHeight=0;if(dialog_height%2===0&&(changeHeight=dialog_height+1),plugin.dialog_left=void 0,plugin.dialog_top=void 0,$.isArray(plugin.settings.position)&&2==plugin.settings.position.length&&"string"==typeof plugin.settings.position[0]&&plugin.settings.position[0].match(/^(left|right|center)[\s0-9\+\-]*$/)&&"string"==typeof plugin.settings.position[1]&&plugin.settings.position[1].match(/^(top|bottom|middle)[\s0-9\+\-]*$/)&&(plugin.settings.position[0]=plugin.settings.position[0].toLowerCase(),plugin.settings.position[1]=plugin.settings.position[1].toLowerCase(),$.each(values,function(index,value){for(var i=0;i<2;i++){var tmp=plugin.settings.position[i].replace(index,value);tmp!=plugin.settings.position[i]&&(0===i?plugin.dialog_left=eval(tmp):plugin.dialog_top=eval(tmp))}})),void 0!==plugin.dialog_left&&void 0!==plugin.dialog_top||(plugin.dialog_left=values.center,plugin.dialog_top=values.middle),plugin.settings.vcenter_short_message){var message=plugin.message.find("div:first"),message_height=message.height(),container_height=plugin.message.height();message_height<container_height&&message.css({"padding-top":(container_height-message_height)/2})}"boolean"==typeof arguments[0]&&!1===arguments[0]||0===plugin.settings.reposition_speed?(plugin.dialog.css({left:"50%",top:"50%",visibility:"visible",opacity:0,transform:"translate3d(-50%, -50%, 0)","-webkit-transform":"translate3d(-50%, -50%, 0)","-moz-transform":"translate3d(-50%, -50%, 0)","-ms-transform":"translate3d(-50%, -50%, 0)"}).animate({opacity:1},plugin.settings.animation_speed_show),0!==changeHeight&&plugin.dialog.css({height:changeHeight})):(plugin.dialog.stop(!0),plugin.dialog.css("visibility","visible").animate({left:"50%",top:"50%"},plugin.settings.reposition_speed)),plugin.dialog.find("button[class^=CustomDialog_Button]:first").focus(),plugin.isIE6&&setTimeout(emulate_fixed_position,500)},emulate_fixed_position=function(){var e=$(window).scrollTop(),t=$(window).scrollLeft();plugin.settings.modal&&plugin.overlay.css({top:e,left:t}),plugin.dialog.css({left:"50%",top:"50%"})},get_buttons=function(){if(!0!==plugin.settings.buttons&&!$.isArray(plugin.settings.buttons))return!1;if(!0===plugin.settings.buttons)switch(plugin.settings.type){case"question":plugin.settings.buttons=[$.Custom_Dialog.DefaultButtons.OK,$.Custom_Dialog.DefaultButtons.Cancel];break;default:plugin.settings.buttons=[$.Custom_Dialog.DefaultButtons.OK]}return plugin.settings.buttons},get_type=function(){var e=plugin.settings.type;switch(e){case"confirmation":case"error":case"information":case"question":case"warning":case"standardConfirm":case"waiting":break;default:e="confirmation"}return e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()},browser={init:function(){this.name=this.searchString(this.dataBrowser)||"",this.version=this.searchVersion(navigator.userAgent)||this.searchVersion(navigator.appVersion)||""},searchString:function(e){for(var t=0;t<e.length;t++){var n=e[t].string,o=e[t].prop;if(this.versionSearchString=e[t].versionSearch||e[t].identity,n){if(-1!=n.indexOf(e[t].subString))return e[t].identity}else if(o)return e[t].identity}},searchVersion:function(e){var t=e.indexOf(this.versionSearchString);if(-1!=t)return parseFloat(e.substring(t+this.versionSearchString.length+1))},dataBrowser:[{string:navigator.userAgent,subString:"MSIE",identity:"explorer",versionSearch:"MSIE"}]};return browser.init(),plugin.init()},$.Custom_Dialog.DefaultButtons={OK:"\u786e\u5b9a",Cancel:"\u53d6\u6d88"},$.Custom_Dialog.Type={Confirmation:"confirmation",Error:"error",Question:"question",Information:"information",Warning:"warning",StandardConfirm:"standardConfirm",Waiting:"waiting"}}(jQuery)},"./js/component/modals/modals.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.lastFocusedAce=!1,this.modalDom=null,this.initModals()}return o(e,[{key:"initModals",value:function(){var e=this;$(document).ready(function(){$(document).keydown(function(t){27==t.keyCode&&e.hideModal(0)})})}},{key:"showModal",value:function(e,t,n){var o=this;if("#page-login-box"!=e){var i=$(e);this.modalDom=i,-1==navigator.userAgent.toLowerCase().indexOf("iphone")&&-1==navigator.userAgent.toLowerCase().indexOf("ipad")&&-1==navigator.userAgent.toLowerCase().indexOf("android")||$(window).scrollTop(0),$(".modaldialog").hide(),i.css("display","block"),setTimeout(function(){i.addClass("modal-ready")},0),$("#modaloverlay").length||$('<div id="modaloverlay"><div id="modaloverlay-inner"></div></div>').appendTo("body"),$("#modaloverlay").unbind("click"),n||$("#modaloverlay").click(function(){o.hideModal(200)}),this.lastFocusedAce=null!=document.activeElement&&"padeditor"==document.activeElement.parentNode.id,$("#modaloverlay").stop(!0,!0).show().css({opacity:0}).animate({opacity:1},t),document.activeElement&&document.activeElement.blur(),$("input").blur(),i.find("input:visible").length&&"#page-login-box"!=e?i.find("input:visible")[0].focus():i.focus()}else console.log("showModal:page-login-box")}},{key:"showHTMLModal",value:function(e,t,n){if("#page-login-box"!=e.selector){var o=$(e);this.modalDom=o,$("#"+o.attr("id")).length?o=$($("#"+o.attr("id"))[0]):(o.appendTo("body"),o.addClass("disposeUponHide")),this.showModal("#"+o.attr("id"),t,n)}else console.log("showHTMLModal:page-login-box")}},{key:"hideModal",value:function(e){var t=$(".modaldialog"),n=this;t.removeClass("modal-ready"),setTimeout(function(){t.css("display","none"),n.modalDom&&n.modalDom.hasClass("disposeUponHide")&&n.modalDom.remove()},250),$("#modaloverlay").animate({opacity:0},e,function(){$("#modaloverlay").hide()})}},{key:"submitModal",value:function(e){var t=this,n=this,o=$(e);if(!o.is(":visible"))return!1;var i=o.serialize();return $(e).parents().filter(".modaldialog").find(".error-message").remove(),$("<div>").addClass("loading-indicator").css({position:"absolute",top:"10px",left:"10px"}).appendTo($(e).parents().filter(".modaldialog")),$.post(o.attr("action"),i,function(i){if(i.html){var a=$(i.html).appendTo("body");a.addClass("disposeUponHide"),o.trigger("closed"),t.showModal("#"+a.attr("id"),0)}else i.moreInfo?o.trigger("more-info"):i.error?i.reset&&(o.trigger("reset"),e.reset()):i.success&&i.cont?document.location.href==i.cont?document.location.reload():document.location.href=i.cont:i.success&&(o.trigger("closed"),n.hideModal(0))}).fail(function(e){$("<div/>").text("An error has occurred. We're looking into it.").addClass("error-message").appendTo(o.parents().filter(".modaldialog"))}).always(function(){o.parents().filter(".modaldialog").find(".loading-indicator").remove()}),!1}}]),e}();t.default=new i},"./js/component/pad-modals/pad-modals.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/component/modals/modals.js"),r=(o=a)&&o.__esModule?o:{default:o},s=n("./js/utils/pad/actions.js");var l=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hideHistoryRevertTipBox=function(){t.hideModal(0,"#history-revert-dialog")},this.hasInit=!1}return i(e,[{key:"init",value:function(){$(".modaldialog input[value=Cancel]").live("click",function(){r.default.hideModal()})}},{key:"showHistoryRevertTipBox",value:function(){0===$("#history-revert-dialog").length&&$('\n                <div id="history-revert-dialog" class="modaldialog">\n                    <div class="modal-tip tip-toast">\u6b63\u5728\u6062\u590d, \u8bf7\u7a0d\u5019...</div>\n                </div>\n            ').appendTo(document.body),this.showModal("#history-revert-dialog")}},{key:"showModal",value:function(e,t,n){this.hasInit||(this.init(),this.hasInit=!0),r.default.showModal(e,t,n)}},{key:"showAuthChangeModal",value:function(){this.showModal("#auth-change-dialog",500,!0)}},{key:"hideModal",value:function(e,t){this.hasInit||(this.init(),this.hasInit=!0),t&&"none"==$("#history-revert-dialog").css("display")||((0,s.cancelActions)("hide-feedbackbox"),(0,s.cancelActions)("hide-sharebox"),$("#sharebox-response").hide(),r.default.hideModal(e))}}]),e}();t.default=new l},"./js/component/toast/components/Toast/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),r=n("react"),s=(o=r)&&o.__esModule?o:{default:o},l=n("./js/utils/user-agent.js");var d=function(e){function t(e,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var o=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,n));return o.hide=o.hide.bind(o),o}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,r.Component),a(t,[{key:"componentDidMount",value:function(){}},{key:"useMobileUI",value:function(){return l.isMobile&&!/(ipad)/i.test(navigator.userAgent)}},{key:"handleCssParam",value:function(e){return"object"!==("undefined"===typeof e?"undefined":i(e))&&(e={}),delete e.top,delete e.left,delete e.right,delete e.bottom,delete e.position,delete e.transform,delete e.width,delete e.height,delete e["max-width"],delete e["max-height"],e.borderSizing="border-box",e.display="flex",e.position="fixed",e.zIndex="10001",this.useMobileUI()?(e.top="0px",e.left="0px",e.right="0px"):(e.top="105px",e.left="30px",e.right="30px"),e}},{key:"handleContentCss",value:function(e){var t={};if(this.useMobileUI()&&(t.position="relative",t.left="0px",t.top="0px",t.width=document.body.clientWidth+"px",t.paddingTop="15px",t.paddingBottom="15px",t.paddingLeft="12px",t.paddingRight="12px",t.borderRadius="0px",t.whiteSpacing="nowrap"),e){var n=e.toastType;n&&("typeNotice"===n?(t.backgroundColor="rgba(0,0,0,0.75)",t.color="white"):"typeNoticeWhite"===n?(t.backgroundColor="#ffffff",t.color="black"):"typeSuccess"===n?(t.backgroundColor="rgba(0,0,0,0.75)",t.color="white"):"typeWarning"===n&&(t.backgroundColor="#ff7d6f",t.color="white"))}return t}},{key:"handleTypeIcon",value:function(e){if(e){var t=e.toastType;if(t){var n="toast-icon";return"typeNotice"===t?n+=" toast-icon-notice":"typeNoticeWhite"===t?n+=" toast-icon-notice":"typeSuccess"===t?n+=" toast-icon-success":"typeWarning"===t&&(n+=" toast-icon-warnning"),s.default.createElement("div",{className:"toast-icon-container"},s.default.createElement("div",{className:n}))}}return""}},{key:"realContent",value:function(){var e=this.props.options,t=e.messageContent,n=e.extendParam;if("function"===typeof t)return s.default.createElement("span",{id:"toastContent"},t());if(n&&n.linkTitle){var o=n.linkTitle,i=t.split(o);return console.log("------",i),s.default.createElement("span",{id:"toastContent"},i[0],this.handleLinkType(),i[1])}return s.default.createElement("span",{id:"toastContent"},t)}},{key:"handleLinkType",value:function(){var e=this.props.options.extendParam;if(e&&e.linkTitle){var t=e.linkCallback||function(){};return s.default.createElement("span",{id:"tool-toast-content-link",className:"toast-link-mobile",onClick:t},e.linkTitle)}return null}},{key:"handleBtnText",value:function(e){if(e&&e.isNeedBtn)return s.default.createElement("span",{id:"toolToastBtn",onClick:e.btnCallBack},e.btnText)}},{key:"handleBtnTextAfter",value:function(e){if(e&&e.btnTextAfter)return s.default.createElement("span",{id:"toolToastBtnAfter"},e.btnTextAfter)}},{key:"handleHide",value:function(e){var t=this.hide;if(e){if(e.manualClose){var n={};return this.useMobileUI()&&(n["margin-left"]="auto",n["margin-right"]="0px"),s.default.createElement("div",{className:"toast-close-white",onClick:t,style:n},s.default.createElement("div",{className:"toast-close-white-img"}))}var o=3e3;return e.toolToastCloseTime&&parseFloat(e.toolToastCloseTime)&&(o=parseFloat(e.toolToastCloseTime)),setTimeout(function(){t()},o),""}return setTimeout(function(){t()},3e3),""}},{key:"hide",value:function(){this.props.hideFunc();var e=this.props.options.extendParam;e&&e.toolToastRemoveCallBack&&e.toolToastRemoveCallBack()}},{key:"render",value:function(){var e=this.props.options,t=(e.messageContent,e.cssParam),n=e.extendParam;return s.default.createElement("div",{id:"toastWrap",style:this.handleCssParam(t)},s.default.createElement("div",{id:"toast",style:this.handleContentCss(n)},this.handleTypeIcon(n),s.default.createElement("span",{id:"toastContent"},this.realContent()),this.handleBtnText(n),this.handleBtnTextAfter(n),this.handleHide(n)))}}]),t}();t.default=d},"./js/component/toast/container/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("react"),a=s(i),r=s(n("./js/component/toast/components/Toast/index.js"));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.type,n=e.hideFunc,o=e.options;return"TOAST"===t?a.default.createElement(r.default,{hideFunc:n,options:o}," "):null}}]),t}();t.default=l},"./js/component/toast/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();t.showToast=p,t.hideToast=h,t.changeToastText=function(e){p(e)};var i=n("react"),a=l(i),r=n("react-dom"),s=l(n("./js/component/toast/container/index.js"));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={show:!1,options:null,hideFunc:null,type:"TOAST"},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,i.Component),o(t,[{key:"componentDidMount",value:function(){this.props.mountCallback&&this.props.mountCallback(this)}},{key:"isShow",value:function(){return this.state.show}},{key:"show",value:function(e,t){this.setState({show:!0,options:e,hideFunc:t})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){return this.state.show?a.default.createElement(s.default,this.state):null}}]),t}(),c=!1,u=null;function p(e,t,n,o){console.log(u),n&&!n.toolToastCloseTime&&(n.manualClose=!0);var i,s={messageContent:e,cssParam:t||{},extendParam:n};u?(h(),u.show(s,h)):(o?i=o:(!c&&$("body").append("<div id='toastContainer' style='position: absolute; top: 0; left: 0; z-index: 10012;'></div>"),c=!0,i=document.getElementById("toastContainer")),(0,r.render)(a.default.createElement(d,{ref:function(e){u=e},mountCallback:function(e){e&&e.show(s,h)}}),i))}function h(){u&&u.hide()}},"./js/config/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.configurations=void 0,t.initConfig=l,t.initExternalConfig=function(){o.isMobile&&a&&1==a&&(r.gEditable=!1,r.isPreview=!0,window.SpreadsheetApp&&window.SpreadsheetApp.sheetStatus&&(SpreadsheetApp.sheetStatus.permission.setgEditable(!1),SpreadsheetApp.sheetStatus.permission.isPreview=!0))},t.getConfig=function(){return l(),r},t.manulInitConfigurations=function(){function e(e,t){var n=t;if((0,i.isString)(e))try{n=JSON.parse(e)}catch(o){}else(0,i.isObject)(e)&&(n=e);return n}$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/common_config",type:"POST",xhrFields:{withCredentials:!0},data:{keys:JSON.stringify(["ai_auto_column"])},success:function(t){var n={},o={},i={};n=e(t,n),o=e(n.configs,o),i=e(o.ai_auto_column,i),0===n.cgicode&&0===n.retcode&&1===i.status&&(s.aiAutoColumnEnable=!0)}})},t.setSheetConfig=function(e,t){r[e]=t};var o=n("./js/utils/user-agent.js"),i=n("./js/utils/type.js"),a=(0,n("./js/utils/browser.js").getQuery)("m_readonly"),r={gEditable:!1,isCreator:!1,isPreview:!1,isTimOnline:!0,isLogin:!1,isFormPreview:!1,isOwner:!1,isSnapshot:!1,isFullScreen:!1,gCopyable:!1},s=t.configurations={aiAutoColumnEnable:!1};function l(){window.clientVars&&(r.gEditable=(!clientVars.isOverConNum||clientVars.isCreator)&&0!=(2&clientVars.rightFlag)&&!clientVars.isFormPreview,r.isFormPreview=clientVars.isFormPreview,r.isPreview=clientVars.preview,r.isLogin=clientVars.isLogin,r.isCreator=clientVars.isCreator,r.isOwner=clientVars.isOwner,r.isSnapshot=clientVars.isSnapshot,r.gCopyable=!!r.gEditable||!(clientVars.advPolicy&&1===clientVars.advPolicy.view_forbid_copy_print))}t.default=r},"./js/config/sheet.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCurrSubId=function(){return SpreadsheetApp?SpreadsheetApp.spreadsheet.getActiveSheetId():(0,o.getQuery)("tab")},t.getPadId=function(){return clientVars.padId},t.getTitle=function(){return window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet.getTitle()},t.isFullyConnected=function(){return SpreadsheetApp&&SpreadsheetApp.socket&&SpreadsheetApp.socket.client&&"OPENED"===SpreadsheetApp.socket.client.getRoomState()},t.getMyUserInfo=function(){return a.myUserInfo},t.setMyUserInfo=function(){a.myUserInfo={userId:clientVars.userId,name:clientVars.userName,ip:clientVars.clientIp,colorId:clientVars.userColor||0,status:"connected",userLink:clientVars.userLink,userPic:clientVars.userPic,uin:clientVars.uin,openTime:Date.now()}},t.getOffTop=function(){return"182px"},t.setHasAllLoad=function(e){a.hasAllLoad=e},t.getHasAllLoad=function(e){return a.hasAllLoad},t.setSheetDocInfo=function(e){a.coreSheetDocInfo=e},t.getSheetDocInfo=function(){return a.coreSheetDocInfo},t.getHeaderHeight=r,t.getEditorTop=function(){var e=document.getElementById("padpage"),t=i.isPad?r():0;return e?e.getBoundingClientRect().top+t:t},t.getCanvasTop=function(){var e=document.getElementById("padeditor"),t=i.isPad?r():0;return e?e.getBoundingClientRect().top+t:t},t.getEditorBottom=function(){return i.isMobile||i.isPad?$("#mobile-sheetbox").outerHeight()||0:$(".tsSheetbox").outerHeight()||0};var o=n("./js/utils/browser.js"),i=n("./js/utils/user-agent.js"),a=(n("./js/event/event-center.js"),{title:"",myUserInfo:null,hasAllLoad:!1,coreSheetDocInfo:null});function r(){return $("header").outerHeight()||54}},"./js/event/event-center.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.event=t.eventCenter=void 0;var o=n("./js/event/event.js"),i={init:function(){return(0,o.create)("default")},create:function(e){return(0,o.create)(e)}},a=i;"undefined"!==typeof window&&(a=window.__eventCenter=window.__eventCenter?window.__eventCenter:i);var r=t.eventCenter=a;t.event={default:r.init(),notificationCenter:r.create("notificationCenter"),keyboard:r.create("keyboard"),toolBar:r.create("toolBar"),search:r.create("search"),sheetsBar:r.create("sheetsBar"),network:r.create("network"),history:r.create("history"),loginEvent:r.create("login")}},"./js/event/event.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.create=function(e){return l(e)},t.remove=function(e,t){l().remove(e,t)},t.one=function(e,t,n){l().one(e,t,n)},t.listen=function(e,t,n){l().listen(e,t,n)},t.trigger=function(){l().trigger.apply(this,arguments)};var o="default",i=Array.prototype.shift,a=Array.prototype.unshift,r={};function s(e,t){for(var n,o=0,i=e.length;o<i;o++){var a=e[o];n=t.call(a,o,a)}return n}function l(e){var t={},n=[],l={listen:function(e,o,i){!function(e,t,n){n[e]||(n[e]=[]),n[e].push(t)}(e,o,t);var a=n[e];void 0!==a?"listened"!==a&&Array.isArray(a)&&("last"===i?a.length&&a.pop()():"ignoreOffline"===i||s(a,function(){this()}),n[e]="listened"):n[e]="listened"},one:function(e,t,n){this.listen(e,t,n),t.once=!0},remove:function(e,n){!function(e,t,n){if(t[e])if(n)for(var o=t[e].length;o>=0;o--)t[e][o]===n&&t[e].splice(o,1);else t[e]=[]}(e,t,n)},trigger:function(){var e,o,r=this;a.call(arguments,t),e=function(){return function(){var e=i.call(arguments),t=i.call(arguments),n=arguments,o=this,a=e[t];if(a&&a.length)return s(a,function(){if("function"===typeof this){var i=this.apply(o,n);return this.once&&function(e,t,n){if(t[e]&&n)for(var o=t[e].length-1;o>=0;o--)"function"==typeof t[e][o]&&t[e][o].once&&t[e].splice(o,1)}(t,e,this),i}})}.apply(r,o)};var l=(o=arguments)[1];return"listened"===n[l]?e():(n[l]||(n[l]=[]),Array.isArray(n[l])?n[l].push(e):void 0)}};return(e=e||o)?r[e]?r[e]:r[e]=l:l}},"./js/event/keyborad.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.manualInitKeyboard=function(){!function(){i.isMobile||i.isPad?$(window).on("touchstart touchmove touchend",function(e){r.event.keyboard.trigger(e.type,e)}):$(window).on("mousedown mouseout mouseover mouseup mousemove",function(e){r.event.keyboard.trigger(e.type,e)});$(window).on("paste copy focus blur keydown keypress keyup click dragover drop scroll compositionstart compositionend unload resize",function(e){r.event.keyboard.trigger(e.type,e)}),$(window).on("dragstart",function(e){e.preventDefault()})}()};var o,i=n("./js/utils/user-agent.js"),a=n("./js/config/index.js"),r=((o=a)&&o.__esModule,n("./js/event/event-center.js"))},"./js/event/web-interface-extra.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/config/index.js"),r=(o=a)&&o.__esModule?o:{default:o},s=n("./js/utils/user-agent.js");var l=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.hasInit=!1,this.interfaceMap={},this.ExecuteJs=this.ExecuteJs.bind(this),this.registerInterface=this.registerInterface.bind(this),this.ExecuteClient=this.ExecuteClient.bind(this)}return i(e,[{key:"init",value:function(){this.registerInterface("setShareInfo","1.0.2","data","TIM",function(){}),this.registerInterface("EditBarUndo","2.0.0","web","TIM",this.onEditBarUndo),this.registerInterface("EditBarRedo","2.0.0","web","TIM",this.onEditBarRedo),this.registerInterface("EditBarDone","2.0.0","web","TIM",this.onEditBarDone),this.registerInterface("setCellValue","1.0.2","web","TIM",this.onSetCellValue),this.registerInterface("ClientInputDone","2.0.0","web","TIM",this.onClientInputDone),this.registerInterface("ClientInputBegin","2.0.0","web","TIM",this.onClientInputBegin),this.registerInterface("sharedDocSheetCommitCellValue","1.0.2","ui","TIM",function(){}),this.registerInterface("getKeyboardHeight","2.0.0","docx","TIM",function(){}),this.registerInterface("setDismissWhenBack","2.0.0","docx","TIM",function(){}),this.registerInterface("setCreateNewPadAndLoaded","2.0.0","docx","TIM",function(){}),this.registerInterface("setSharedDocInputBarCellValue","1.0.2","ui","TIM",function(){}),this.registerInterface("setEditToolBarDisplay","2.0.0","docx","TIM",function(){}),this.registerInterface("setClipboardContent","2.0.0","docx","TIM",this.onSetClipboardContent),this.registerInterface("getClipboardContent","2.0.0","docx","TIM",this.onGetClipboardContent),this.registerInterface("setCellValue","6.7.0","web","QQ",this.onSetCellValue),this.registerInterface("sharedDocSheetCommitCellValue","6.7.0","ui","QQ",function(){}),this.registerInterface("setSharedDocInputBarCellValue","6.7.0","ui","QQ",function(){}),this.registerInterface("setKeyBoardStatus","2.0.0","docx","TIM",function(){}),this.registerInterface("getKeyBoardStatus","2.0.0","docx","TIM",function(){}),this.hasInit=!0}},{key:"ExecuteJs",value:function(e){this.hasInit||this.init();var t=void 0,n=arguments.length;if(s.isTim&&r.default.gEditable)for(var o in t="TIM",this.interfaceMap[t])this.interfaceMap[t][o].name&&this.interfaceMap[t][o].name==e&&this.interfaceMap[t][o].version&&(0,s.MTIMLargerOrEqual)(this.interfaceMap[t][o].version)&&(n>1?this.interfaceMap[t][o].callback&&this.interfaceMap[t][o].callback(arguments[1]):this.interfaceMap[t][o].callback&&this.interfaceMap[t][o].callback());if((0,s.genMQQVer)()&&r.default.gEditable){t="QQ";var i=arguments.length;for(var a in this.interfaceMap[t])this.interfaceMap[t][a].name&&this.interfaceMap[t][a].name==e&&this.interfaceMap[t][a].version&&(0,s.MQQLargerOrEqual)(this.interfaceMap[t][a].version)&&(i>1?this.interfaceMap[t][a].callback&&this.interfaceMap[t][a].callback(arguments[1]):this.interfaceMap[t][a].callback&&this.interfaceMap[t][a].callback())}}},{key:"ExecuteClient",value:function(e,t,n){this.hasInit||this.init();var o=void 0;if(t=t||{},s.isTim&&r.default.gEditable)for(var i in o="TIM",this.interfaceMap[o])this.interfaceMap[o][i].name&&this.interfaceMap[o][i].name==e&&this.interfaceMap[o][i].version&&(0,s.MTIMLargerOrEqual)(this.interfaceMap[o][i].version)&&(n&&(this.interfaceMap[o][i].callback=n),window.mqq&&mqq.invoke(this.interfaceMap[o][i].module,this.interfaceMap[o][i].name,t,this.interfaceMap[o][i].callback));if((0,s.genMQQVer)()&&r.default.gEditable)for(var a in o="QQ",this.interfaceMap[o])this.interfaceMap[o][a].name&&this.interfaceMap[o][a].name==e&&this.interfaceMap[o][a].version&&(0,s.MQQLargerOrEqual)(this.interfaceMap[o][a].version)&&(n&&(this.interfaceMap[o][a].callback=n),window.mqq&&mqq.invoke(this.interfaceMap[o][a].module,this.interfaceMap[o][a].name,t,this.interfaceMap[o][a].callback))}},{key:"registerInterface",value:function(e,t,n,o,i){if(e&&t&&n&&o){var a={name:e,version:t,module:n,from:o,callback:i||null};this.interfaceMap[o]||(this.interfaceMap[o]=[]),this.interfaceMap[o].push(a)}}},{key:"onEditBarUndo",value:function(){window.useMobileCanvas&&this.newOnEditBarUndo()}},{key:"onEditBarRedo",value:function(){window.useMobileCanvas&&this.newOnEditBarRedo()}},{key:"onEditBarDone",value:function(){if(window.useMobileCanvas)this.newOnEditBarDone();else{var e=window.sheetNode.getHotInstance();this.ExecuteClient("setEditToolBarDisplay",{display:!1}),e.runHooks("DisAppearFtoverlays"),e.runHooks("clearRangeCache"),e.deselectCell(),e.docxState.changeStateToBrowse()}}},{key:"onSetCellValue",value:function(e){if(window.useMobileCanvas)this.newOnSetCellValue(e);else{console.error(e);try{window.isExistIOSWebview=!0,e.row&&e.col&&window.sheetNode.setDataAtCell(e.row,e.col,e.value)}catch(t){alert(t.toString())}}}},{key:"onGetClipboardContent",value:function(e){if(!window.useMobileCanvas){var t=window.sheetNode.getHotInstance(),n=e;n&&"text"==n.type&&n.content&&(t.runHooks("afterFtOverlaysPasteSuccess",n.content),this.ExecuteClient("setEditToolBarDisplay",{display:!0}),t.docxState.changeStateToSelected())}}},{key:"onClientInputDone",value:function(){}},{key:"onClientInputBegin",value:function(){}},{key:"onGetSharedDocSheetInputBarContent",value:function(e){}},{key:"newOnSetCellValue",value:function(e){}},{key:"newOnEditBarUndo",value:function(){}},{key:"newOnEditBarRedo",value:function(){}},{key:"onSetClipboardContent",value:function(e){}},{key:"onGetSharedDocNativeKeyboardEnable",value:function(){}},{key:"newOnClientInputDone",value:function(){}}]),e}();t.default=new l},"./js/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),n("../node_modules/core-js/index.js");var o=A(n("./js/app/bootStrap.js")),i=A(n("./js/app/aria/index.js")),a=(A(n("./js/app/web-socket-ui/ui-center.js")),n("./js/event/event-center.js")),r=A(n("./js/network/login.js")),s=n("./js/network/pskey-error.js"),l=A(n("./js/app/header/common/save-status.js")),d=k(n("./js/utils/user-agent.js")),c=n("./js/utils/browser.js"),u=n("./js/utils/ui/image.js"),p=A(n("./js/utils/ui/measure.js")),h=n("./js/utils/util.js");n("./css/index-common.less"),n("./css/index-pc.less");var f=n("./js/config/index.js"),m=A(f),g=(n("./js/utils/aria/index.js"),k(n("./js/config/sheet.js"))),w=A(n("./js/network/client.js")),v=A(n("./js/app/auth/advanced.js")),b=n("./js/script-loader/index.js"),_=n("./js/app/export/utils.js");n("./js/service-worker/sw.js");var y=A(n("./js/app/header/mobile/mobile-share-model.js")),T=A(n("./js/app/header/share.js")),E=A(n("./js/app/init/pc-init.js")),C=A(n("./js/app/template-info/index.js")),x=A(n("./js/report/flowlog.js"));n("../node_modules/@tencent/dui/lib/utils/polyfill.js");var S=n("./js/component/toast/index.js");function k(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function A(e){return e&&e.__esModule?e:{default:e}}window.performanceData||(window.performanceData={_jsStartRun:Number(new Date)});var I={ui:{},util:{getQuery:c.getQuery,getXsrf:c.getXsrf,getBkn:c.getBkn,viewImage:u.viewImage,cookie:{get:c.getCookie},checkIsIphoneX:d.checkIsIphoneX,randomStr:h.randomStr,textMeasure:p.default,ariaHelp:i.default},lib:{getExif:function(){return n.e("bundle_exif").then(n.t.bind(null,"./js/app/lib/exif.js",7)).then(function(e){return e.default})}},configurations:f.configurations,sheetConfig:m.default,sheet:g,userAgent:d,client:w.default,login:r.default,saveStatus:l.default,onPskeyError:s.onPskeyError,advPermissions:v.default,loadModule:b.loadModule,export:{exportSheetData:_.exportSheetData,postExportSheetInfo:_.postExportSheetInfo},CommonMobileShareObject:y.default,shareController:T.default,templateInfo:C.default};I=(0,h.extend)(I,E.default.getExport()),window.CoreSheet=I,t.default=I,window.__console={};var R=(0,c.getQuery)("showLog");["log","error","warn","debug"].forEach(function(e){window.__console[e]=window.console[e],R||(window.console[e]=function(){})}),window.performanceData&&!window.performanceData.jsStartRun&&(window.performanceData.jsStartRun=Number(new Date)),window.__global={},window.__global.eventCenter=a.eventCenter,window.__global.event=a.event,window.tdwReport=T_SHEET.Report.tdwReport,window.tdwSingleReport=T_SHEET.Report.tdwSingleReport,$.getXsrf=c.getXsrf,window.padutils={showToolToast:S.showToast,toolToast:S.showToast,hideToolToast:S.hideToast},window.getCookie=c.getCookie,window.notificationCenter={subscribe:a.event.notificationCenter.listen,notify:a.event.notificationCenter.trigger},window.reLocateForNative=function(){},window.setKeyboardHeight=function(){};var O=!1,D=null,j=function(){if(!O){x.default.info("loadCoreSheet"),D&&clearTimeout(D),O=!0;var e=new o.default;window.performanceData&&(window.performanceData.bootStart=Number(new Date)),window._loadStartTime&&window._loadStartTime>0&&window.performanceData&&(window.performanceData._starterRunFinish=Number(new Date)-window._loadStartTime),window.clientVars?(e.start(),window.performanceData&&(window.performanceData.bootEnd=Number(new Date))):window.initBootStrap=function(){e.start(),window.performanceData&&(window.performanceData.bootEnd=Number(new Date))}}};window.noQickLookLoaded=!1,x.default.info("hasQuickLookFinish",window.hasQuickLookFinish),window.hasQuickLookFinish?j():(window.loadCoreSheet=j,D=setTimeout(function(){x.default.info("quickLookTimeout"),window.noQickLookLoaded=!0,j(),T_SHEET.Report.monitor(34320117)},4e3)),window.__ws&&window.__ws.trigger("setLoadData",{type:"coresheet"})},"./js/network/ajax.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.autoAjaxWithLoginHandler=a,t.autoAjaxWithRetcodeReport=r,t.autoAjaxWithTag=s,t.autoAjaxWithXsrf=l,t.manualInitAjax=function(){$(document).ready(function(){s(),l(),a(),r()})};var o=n("./js/network/pskey-error.js"),i=n("./js/utils/util.js");function a(){var e=$.ajax;$.ajax=function(t){var n=t.success;return t.success=function(e,t,i){if(-1==this.url.indexOf("setRedDot"))if(this.url.indexOf("user_info")&&this.url.indexOf("only_check"))n&&n.apply(this,arguments);else{var a=e&&e.retcode,r=e&&e.ret,s=a||r;if((0,o.isPskeyError)(s)){var l=this.url.split("?")[0];console.error("core-sheet onPskeyError("+l+") = "+s),(0,o.onPskeyError)(l,s)}else n&&n.apply(this,arguments)}else n&&n.apply(this,arguments)},e.apply(this,arguments)}}function r(){var e=$.ajax,t=[11e3,11005,11004,11007,11008,1e5,100001,100003,100004,100100,100101,100012,111111,99999,99992,1007,1e4,10001,30001,30002,30003,40001,40002,40003,40004,40005,40006,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115];$.ajax=function(n){var o=Number(new Date),i=n.success||function(){},a=n.complete||function(){};return n.complete=function(e,t){var i=Number(new Date);if(a.call(n,e,t),T_SHEET.Report){if(n.url.indexOf("cgi-bin/appstage/mstats_batch_report")>-1)return;try{200===e.status||T_SHEET.Report.retcode({url:n.url,type:2,code:0===e.status?-999:e.status,time:i-o})}catch(r){}}},n.success=function(e,a,r){var s=Number(new Date);if(i.call(n,e,a,r),T_SHEET.Report){if(n.url.indexOf("cgi-bin/appstage/mstats_batch_report")>-1)return;try{if(e&&0===e.retcode)T_SHEET.Report.retcode({url:n.url,type:1,code:0,time:s-o});else{var l=-998;e&&e.retcode&&(l=e.retcode);var d=2;t.indexOf(l)>-1&&(d=3),T_SHEET.Report.retcode({url:n.url,type:d,code:l,time:s-o})}}catch(c){}}},e(n)}}function s(){jQuery.ajaxPrefilter(function(e,t,n){(e.url.indexOf("docx.qq.com")>-1||e.url.indexOf("docs.qq.com")>-1)&&(e.url+=e.url.indexOf("?")>-1?"&tag="+clientVars.padId:"?tag="+clientVars.padId)})}function l(){$.ajaxPrefilter(function(e,t,n){if(e.contentType){var o,a=(0,i.filter)(document.cookie.split(/;\s+/),function(e){return"TOK"==e.split("=")[0]})[0];a&&(o=a.split("=")[1]),-1!=e.contentType.indexOf("json")?(e.data=e.data||"{}",e.data=JSON.stringify((0,i.extend)(JSON.parse(e.data),{xsrf:o}))):-1!=e.contentType.indexOf("application/x-www-form-urlencoded")&&(e.data=e.data||"",-1==e.data.indexOf("xsrf=")&&(e.data+=(e.data?"&":"")+"xsrf="+o))}})}},"./js/network/client.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/event/event-center.js"),a=n("./js/utils/util.js"),r=n("./js/utils/browser.js"),s=f(n("./js/config/index.js")),l=n("./js/config/sheet.js"),d=f(n("./js/app/collaborator/index.js")),c=f(n("./js/app/header/share.js")),u=n("./js/app/template/index.js"),p=n("./js/utils/user-agent.js"),h=f(n("./js/app/init/pc-init.js"));function f(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}return o(e,[{key:"initConfig",value:function(e,t,n){this.serverVars=e,this.options=n,this.userId=t.userId,this.userSet={},this.authorInfos={},this.userSet[this.userId]=t,this.pos=e.pos,this.tellAboutHistoricalAuthors(e.historicalAuthorData),this.tellActiveAuthorInfo(t),this.throttleGetRemark=(0,a.throttle)(this.getRemarksFromUserInfos.bind(this),5e3),this.sheetNotifyTimeId=null}},{key:"listenEvent",value:function(){var e=this;__core.event&&__core.event.network.listen("userNewInfo",function(t){e.handleUserNewInfo(t)}),__core.event&&__core.event.network.listen("userLeave",function(t){e.handleUserLeave(t)}),__core.event&&__core.event.network.listen("cursor",function(t){e.handleCursorMessage(t)}),i.event.notificationCenter.listen("localChangeContent",function(){e.onUserLocalChange()}),i.event.network.listen("userCaretChange",function(t){e.notifyUserCaretAfterSelection(t)})}},{key:"getUserLineInterfaces",value:function(){return window.SpreadsheetApp&&SpreadsheetApp.view&&SpreadsheetApp.view.header&&SpreadsheetApp.view.header.component&&SpreadsheetApp.view.header.component.collabListInterfaces}},{key:"userJoinForUserline",value:function(e){h.default.getUserLineInterfaces()&&h.default.getUserLineInterfaces().userJoinOrUpdate(e)}},{key:"userLeaveForUseline",value:function(e){h.default.getUserLineInterfaces()&&h.default.getUserLineInterfaces().userLeave(e)}},{key:"onUserJoin",value:function(e){0===clientVars.invitedUserInfos.filter(function(t){return t.userId===e.userId}).length&&clientVars.invitedUserInfos.push(e),this.userJoinForUserline(e),window.SpreadsheetApp&&window.SpreadsheetApp.view.reportLocation()}},{key:"onUserLeave",value:function(e){this.userLeaveForUseline(e),d.default.removeUserCaret(e)}},{key:"onUpdateUserInfo",value:function(e){this.userJoinForUserline(e)}},{key:"tellAboutHistoricalAuthors",value:function(e){for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t)){var n=e[t];this.userSet[t]||this.tellAuthorInfo(t,n.colorId,!0,n.name,n.userLink)}}},{key:"tellAuthorInfo",value:function(e,t,n,o,i){if((t||"number"==typeof t)&&(t=Number(t),this.options&&this.options.colorPalette&&this.options.colorPalette[t%this.options.colorPalette.length])){var a=this.options.colorPalette[t%this.options.colorPalette.length];d.default.setAuthorInfo(e,{bgcolor:a,name:o,userLink:i})}}},{key:"tellActiveAuthorInfo",value:function(e){this.tellAuthorInfo(e.userId,e.colorId,!1,e.name,e.userLink)}},{key:"notifyUserCaretAfterSelection",value:function(e){var t=this;e&&(this.sheetNotifyTimeId&&clearTimeout(this.sheetNotifyTimeId),this.sheetNotifyTimeId=setTimeout(function(){t.notifyUserCaretUpdate(e)},200))}},{key:"notifyUserCaretUpdate",value:function(e){e.tabId=(0,l.getCurrSubId)(),e.openTime=(0,l.getMyUserInfo)().openTime,this._sendCursorMessage({type:"caret",sheet:e,changedBy:(0,l.getMyUserInfo)().userId})}},{key:"_sendCursorMessage",value:function(e){window.SpreadsheetApp&&SpreadsheetApp.socket.client&&SpreadsheetApp.socket.client.sendMessage("CURSOR_MESSAGE",null,JSON.stringify(e),null)}},{key:"handleUserNewInfo",value:function(e){var t=e.userId;t!=this.userId&&(this.userSet[t]?(this.userSet[t]=e,this.onUpdateUserInfo(e)):(this.userSet[t]=e,this.onUserJoin(e),this.throttleGetRemark()),this.tellActiveAuthorInfo(e))}},{key:"handleUserLeave",value:function(e){var t=e.userId;t!=this.userId&&(this.userSet[t]&&(delete this.userSet[e.userId],this.tellAuthorInfo(e.userId,e.colorId,!0,e.name,e.userLink)),this.onUserLeave(e))}},{key:"handleCursorMessage",value:function(e){if(e.changedBy){var t=clientVars.invitedUserInfos.findIndex(function(t){return t.userId===e.changedBy}),n=window.clientVars.invitedUserInfos[t];if(!n)return void console.log("handle cursor msg error");n.name?s.default.gEditable&&d.default.updateUserCaret(e,!1):n.showTeamworkCard=function(){s.default.gEditable&&d.default.updateUserCaret(e,!1)}}}},{key:"getRemarksFromUserInfos",value:function(){for(var e=this,t=function(t){if(0==t)console.log("__________****Fail****___________");else{var n=t.rsp;if(void 0!=n)for(var o=0;o<clientVars.invitedUserInfos.length;o++)for(var i=clientVars.invitedUserInfos[o].userId.split(".")[1],a=0;a<n.length;a++){var r=n[a].markName;n[a].uin=n[a].uid,void 0!=r&&n[a].uid==i&&(clientVars.invitedUserInfos[o].name=r,clientVars.invitedUserInfos[o].userPic=n[a].userPic,clientVars.invitedUserInfos[o].uin=n[a].uin.toString(),clientVars.invitedUserInfos[o].status="connected",p.isMobile,e.userJoinForUserline(clientVars.invitedUserInfos[o]),clientVars.invitedUserInfos[o].showTeamworkCard&&(clientVars.invitedUserInfos[o].showTeamworkCard(),clientVars.invitedUserInfos[o].showTeamworkCard=null))}}},n=[],o="[",i=0;i<clientVars.invitedUserInfos.length;i++){n[i]=clientVars.invitedUserInfos[i].uin;var a=clientVars.invitedUserInfos.length==i+1?"":",",s=clientVars.invitedUserInfos[i].userId.split(".")[1];void 0!=s&&(o=o+s+a)}o+="]",$.ajax({url:"//docs.qq.com/sdc/getusermarkname",xhrFields:{withCredentials:!0},data:{bkn:(0,r.getBkn)(),domainId:clientVars.domainId,localPadId:clientVars.localPadId,uids:o,xsrf:(0,r.getXsrf)()},success:function(e){0===e.retcode?t(e.result):(console.log("getRemarksFromUserInfos error:"+e.retcode+":"+e.tips),t(!1))},error:function(){console.log("getRemarksFromUserInfos error"),t(!1)}})}},{key:"onUserLocalChange",value:function(){window.isContentEditedToNativeSend||(window.isContentEditedToNativeSend=!0,c.default.setShareInfo()),(0,u.editForTemplate)()}}]),e}();t.default=new m},"./js/network/login.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o,i=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),a=n("./js/utils/browser.js"),r=n("./js/config/index.js"),s=(o=r)&&o.__esModule?o:{default:o},l=n("./js/utils/user-agent.js"),d=n("./js/utils/ui/dom.js"),c=n("./js/network/pskey-error.js"),u=n("./js/event/event-center.js");var p=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isRegisteredLoginListeners=!1,u.event.loginEvent.listen("logoutApp",function(){t.logoutApp()})}return i(e,[{key:"wxworkLogin",value:function(){if(l.isWxWork)if(s.default.isLogin)window.sessionStorage&&sessionStorage.setItem("weWorkALogin_9GS3","false");else if(this.canWWAutoLogin()){window.sessionStorage&&sessionStorage.setItem("weWorkALogin_9GS3","false"),console.log("core-doc(WeWork) auto ww-login");var e="https://docs.qq.com/scenario/ww-login.html?from=autologin&url="+encodeURIComponent(window.location.href);window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=ww20388f7040b655b7&redirect_uri="+encodeURIComponent(e)+"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect")}}},{key:"canWWAutoLogin",value:function(){return!window.sessionStorage||"false"!==sessionStorage.getItem("weWorkALogin_9GS3")}},{key:"init",value:function(e,t){var n=this;if(this.appendTemplates(e,t),this.initAccountAvatar(),this.registerListeners(t),this.initLoginEvent(),!l.isMobile&&(0,a.getQuery)("jumpuin")){var o=(0,a.getQuery)("jumpuin"),i=(0,a.getCookie)("utype"),r=(0,a.getCookie)("p_luin")||(0,a.getCookie)("p_uin"),s=r?r.replace(/^[o0]+/i,""):null;"qq"===i&&o==s?this.checkLoginState(function(){console.error("core-sheet jump already login");var e=(0,a.removeURLParameter)(window.location.href,"jumpuin");window.history.replaceState(window.history.state,null,e)},function(e){n.showLoginFrame()}):setTimeout(function(){console.error("core-sheet jump raise login with state = "+clientVars.isLogin),n.showLoginFrame()},800)}}},{key:"forbidRegisterLoginListeners",value:function(){this.isRegisteredLoginListeners=!0}},{key:"appendTemplates",value:function(e,t){e=e||$("header");var n=null;n=t?this.getUnloginStatusTemplate():this.getLoginStatusTemplate(),e.append($(n))}},{key:"getUnloginStatusTemplate",value:function(){return'<div class="unlogin-container"><span class="unlogin-hint">\u5f53\u524d\u4ec5\u80fd\u67e5\u770b\uff0c\u767b\u5f55\u540e\u83b7\u5f97\u66f4\u591a\u64cd\u4f5c\u6743\u9650\u3002</span><span class="login-button header-function-btn-blue-normal">\u7acb\u5373\u767b\u5f55</span></div>'}},{key:"getLoginStatusTemplate",value:function(){return clientVars&&clientVars.userName&&setTimeout(function(){$(".user-info-nick").html(clientVars.userName),$(".login-dropdown-uin").html(clientVars.uin),$(".login-dropdown-nick").html(clientVars.userName)},0),'\n            <span class="login-container" id="login-container">\n                <div class="user-info-container" id="user-info-container">\n            </span>\n        '}},{key:"initAccountAvatar",value:function(){var e=document.querySelector("#user-info-container");e&&window.SLR&&window.SLR.listen("SL-INIT",function(){window.SLR.load("AccountAvatar",function(t){t.init({container:e,userPic:clientVars.userPic})})})}},{key:"registerListeners",value:function(e){var t=this;if(e&&($(".login-button").on("click",function(e){if(l.isWxWork){var n="https://docs.qq.com/scenario/ww-login.html?from=detail&url="+encodeURIComponent(window.location.href);window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=ww20388f7040b655b7&redirect_uri="+encodeURIComponent(n)+"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect")}else t.checkIfAccountSwitched("Login")?t.checkLoginState(function(){window.SLR&&window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"Login"})},function(e){t.showLoginFrame()}):t.showLoginFrame()}),(0,d.btnState)($(".login-button"),"header-function-btn-blue-normal","header-function-btn-blue-hover","header-function-btn-blue-selected"),-1!=location.href.indexOf("autoshowlogin")&&(this.showLoginFrame(),window.history.replaceState))){var n=(0,a.removeURLParameter)(window.location.href,"autoshowlogin");window.history.replaceState(window.history.state,null,n)}window.addEventListener("focus",function(){!l.isMobile&&t.checkIfAccountSwitched("resetModifiers")&&window.SLR&&window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"resetModifiers"})})}},{key:"logoutApp",value:function(){(0,c.logoutApp)()}},{key:"registerLogoutListeners",value:function(){SLR.listen("TXDOC-LOGOUT",function(e){"2"==e.detail.data&&(location.href="/ep/account/sign-out?stay=1")})}},{key:"registerSwitchAccountListeners",value:function(){SLR.listen("TXDOC-SWITCH-ACCOUNT",function(e){"2"==e.detail.data&&(location.href="/ep/account/sign-out?stay=1&autoshowlogin=1")})}},{key:"showLoginFrame",value:function(e){var t=this;SLR.listen("SL-INIT",function(){t.initLogin(e)}),this.initLogin(e)}},{key:"initLogin",value:function(e){var t=$("#loginContainer");if(t.length){var n={padId:"",domainId:"",isMaskClose:!e};window.Login?window.Login.show(t[0],n):SLR.load("Login",function(e){e.show(t[0],n),window.Login=e})}}},{key:"initLoginEvent",value:function(){SLR.listen("TX-LOGIN-SHOW",function(e){var t=e.detail.data||{},n=$("#loginContainer");if(n.length){var o={padId:"",domainId:"",isQQonly:t.isQQonly,cb:t.cb,target:t.self||"top"};window.Login?window.Login.show(n,o):SLR.load("Login",function(e){e.show(n,o),window.Login=e})}})}},{key:"hasLoginCookie",value:function(){return!!((0,a.getCookie)("uid")&&(0,a.getCookie)("uid_key")||(0,a.getCookie)("p_luin")&&(0,a.getCookie)("p_lskey")||(0,a.getCookie)("p_uin")&&(0,a.getCookie)("p_skey"))}},{key:"ptLoginType",value:function(){return(0,a.getCookie)("p_luin")&&(0,a.getCookie)("p_lskey")?1:(0,a.getCookie)("p_uin")&&(0,a.getCookie)("p_skey")?0:-1}},{key:"checkLoginState",value:function(e,t,n){this.hasLoginCookie()?$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/user_info",data:{only_check:1,xsrf:(0,a.getXsrf)()},timeout:n||1e3,success:function(n){if(n.hasOwnProperty("retcode")&&0===n.retcode)console.log("core-sheet checkLoginState success"),e&&e();else{var o=n.hasOwnProperty("retcode")?n.retcode:-306;console.warn("core-sheet checkLoginState fail: "+o),t&&t(o)}},error:function(e){var n=e.hasOwnProperty("retcode")&&e.retcode,o=e.hasOwnProperty("errCode")&&e.errCode,i=n||o||-306;console.warn("core-sheet checkLoginState error: "+i),t&&t(i)}}):(console.log("core-sheet checkLoginState invalid"),t&&t(0))}},{key:"checkIfAccountSwitched",value:function(e){var t=window.clientVars&&window.clientVars.userInfo,n=window.clientVars&&window.clientVars.userType,o=(0,a.getCookie)("utype"),i=window.clientVars&&window.clientVars.uidKey,r=(0,a.getCookie)("uid_key");if(window.clientVars&&window.clientVars.isLogin&&!t)return console.log("core-sheet("+e+") check user_info null"),!1;if(!t||!t.hasOwnProperty("uin")&&!t.hasOwnProperty("toid"))return!!this.hasLoginCookie()&&(console.error("core-sheet("+e+") check other tab login with "+o),!0);if(!this.hasLoginCookie())return!1;var s=null;t.hasOwnProperty("toid")&&(s=t.toid);var l=(0,a.getCookie)("uid");if(s&&l){if(s!=l)return console.error("core-sheet("+e+") check uid switched"),!0;if(n&&o){if(n!=o)return console.error("core-sheet("+e+") check switched from "+n+" to "+o),!0;if("reLoginForPskeyError"===e&&i&&r&&i!=r)return console.error("core-sheet("+e+") check only uid_key changed"),!0}}else console.error("core-sheet("+e+") check oUid = "+s+", nUid = "+l);return!1}},{key:"loginReport",value:function(e){if(e){var t=e.errCode||"null",n=e.cgi||"null",o=e.loginType||"pskey_expired",i=n;if("string"===typeof n){i=n.split("?")[0];var r=new RegExp(/https:\/\/docs.qq.com|\/\/docs.qq.com|.*?(?=\/ep\/api)/g);i=i.replace(r,"")}var s,l=(0,a.getCookie)("loginTime")||0,d=localStorage.getItem("renewalTime")||0,c="null",u="null";if(l)(s=new Date).setTime(l),c=s.toLocaleString();if(d)(s=new Date).setTime(d),u=s.toLocaleString();var p=(new Date).getTime(),h=new Date;h.setTime(p);var f=[c,l,u,d,h.toLocaleString(),p,"web",t,i,o,"core-sheet"].join(";");console.log("loginReport reportMsg = ",f);var m={opername:"tech_doc",module:"b_login_project",action:"doc_login",table:"dc03111",ver6:f};T_SHEET.Report.tdwReport(m)}}}]),e}();t.default=new p},"./js/network/pskey-error.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isPskeyError=function(e){return 11e3===e||11005===e||11006===e||1e5===e},t.onPskeyError=u,t.continueLogin=h,t.logoutApp=g,t.manualInitPskeyErrorHandler=function(){(function e(){window.SLR?SLR.listen("TX-LOGIN-PSKEY-EXPIRED",function(e){var t="unknown url",n=0;if(e.detail){if(e.detail.hasOwnProperty("url")){var o=e.detail.url;if("string"===typeof o){var i=o.split("?");t=i[0]}}e.detail.hasOwnProperty("code")&&(n=e.detail.code),console.error("core-sheet listen onPskeyError("+t+") = "+n)}else console.error("core-sheet listen onPskeyError opt.detail = null");u(t,n)}):setTimeout(function(){e()},1e3)})(),window.clientVars&&!o.isMobile&&function e(){window.SLR?SLR.listen("TX-LOGIN-ACCOUNT-SWITCHED",function(e){if(e.detail&&e.detail.hasOwnProperty("op")){var t=e.detail.op;if("Login"===t||"reLoginForPskeyError"===t)return window.SLR.dispatch("SHOW_TOAST",{title:"\u5176\u4ed6\u9875\u9762\u5df2\u767b\u5f55\uff0c\u6b63\u5728\u5237\u65b0...",time:1500}),void setInterval(function(){window.location.reload()},1800)}if((0,s.hideToast)(),window.modals){var n=$("#account_switched_toast");if(0==n.length){window.modals.showHTMLModal('<div id="account_switched_toast" class="modaldialog modal-ready"><div  class="disconnected tip-toast">\u5e10\u53f7\u4fe1\u606f\u53d8\u5316\uff0c\u70b9\u51fb<span  class="blue">\u5237\u65b0</span>\u3002</div></div>',500,!0),$("#account_switched_toast .blue").click(function(){window.modals.hideModal(0),window.location.reload()})}else window.modals.showModal("#account_switched_toast",500,!0)}else(0,s.showToast)("\u5e10\u53f7\u4fe1\u606f\u53d8\u5316\uff0c\u70b9\u51fb",null,{isNeedBtn:!0,supportMobile:!0,btnText:"\u5237\u65b0",btnTextAfter:"\u3002",btnCallBack:function(){(0,s.hideToast)(),window.location.reload()}})}):setTimeout(function(){e()},1e3)}();h()};var o=n("./js/utils/user-agent.js"),i=n("./js/utils/browser.js"),a=c(n("./js/network/login.js")),r=c(n("./js/config/index.js")),s=n("./js/component/toast/index.js"),l=c(n("./js/component/banner/common-banner-mo.js")),d=c(n("./js/component/modals/modals.js"));function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){a.default.loginReport({errCode:t,cgi:e});var n=a.default.hasLoginCookie();log.warn("onPskeyError",{url:e,retcode:t,module:"core-sheet",isMobile:o.isMobile,islogin:r.default.isLogin,hascookie:n,utype:(0,i.getCookie)("utype"),pttype:a.default.ptLoginType()}),e.indexOf("user_info")<0?a.default.checkLoginState(function(){log.error("onPskeyErrorException",{url:e,retcode:t,module:"core-sheet",isMobile:o.isMobile,islogin:r.default.isLogin,hascookie:!0,utype:(0,i.getCookie)("utype"),pttype:a.default.ptLoginType()}),a.default.loginReport({errCode:t,cgi:e,loginType:"cgi_exp_err_report"})},function(e){o.isMobile?w((0,o.getAppName)(),t):r.default.isLogin&&p(!0)}):o.isMobile?w((0,o.getAppName)(),t):r.default.isLogin&&p(!0)}function p(e){if((0,s.hideToast)(),e)if(0==$("#pskey_error_dialog").length){d.default.showHTMLModal('<div id="pskey_error_dialog" class="modaldialog modal-ready"><div  class="disconnected tip-toast">\u767b\u5f55\u8fc7\u671f\uff0c<span  class="blue">\u91cd\u65b0\u767b\u5f55</span>\u3002</div></div>',500,!0),$("#pskey_error_dialog .blue").click(function(){try{d.default.hideModal(0),a.default.checkIfAccountSwitched("reLoginForPskeyError")?a.default.checkLoginState(function(){window.SLR&&window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"reLoginForPskeyError"})},function(e){a.default.showLoginFrame()}):a.default.showLoginFrame()}catch(e){location.reload()}})}else d.default.showModal("#pskey_error_dialog",500,!0);else(0,s.showToast)("\u767b\u5f55\u8fc7\u671f\uff0c",null,{isNeedBtn:!0,supportMobile:!0,btnText:"\u91cd\u65b0\u767b\u5f55",btnTextAfter:"\u3002",btnCallBack:function(){(0,s.hideToast)();try{a.default.showLoginFrame()}catch(e){location.reload()}}})}function h(){if(r.default.isLogin){var e=(new Date).getTime();localStorage.setItem("renewalTime",e);var t=setInterval(function(){if(a.default.checkIfAccountSwitched("autoResetPskey")&&window.SLR)return window.SLR.dispatch("TX-LOGIN-ACCOUNT-SWITCHED",{op:"autoResetPskey"}),void clearInterval(t);e=(new Date).getTime(),localStorage.setItem("renewalTime",e),$.ajax({url:"//docs.qq.com/cgi-bin/online_docs/user_info",data:{xsrf:(0,i.getXsrf)()}})},6e5)}}var f=!1;function m(e){"skey"===e?((0,i.delCookie)("p_uin","docs.qq.com","/"),(0,i.delCookie)("p_skey","docs.qq.com","/"),(0,i.delCookie)("p_luin","docs.qq.com","/"),(0,i.delCookie)("p_lskey","docs.qq.com","/"),(0,i.delCookie)("loginTime","docs.qq.com","/"),localStorage.removeItem("renewalTime")):"uid"===e?((0,i.delCookie)("uid","docs.qq.com","/"),(0,i.delCookie)("uid","qq.com","/"),(0,i.delCookie)("uid_key","docs.qq.com","/"),(0,i.delCookie)("loginTime","docs.qq.com","/"),localStorage.removeItem("renewalTime")):((0,i.delCookie)("utype","docs.qq.com"),(0,i.delCookie)("is_bind","docs.qq.com"),(0,i.delCookie)("p_uin","docs.qq.com","/"),(0,i.delCookie)("p_skey","docs.qq.com","/"),(0,i.delCookie)("p_luin","docs.qq.com","/"),(0,i.delCookie)("p_lskey","docs.qq.com","/"),(0,i.delCookie)("uid","docs.qq.com","/"),(0,i.delCookie)("uid","qq.com","/"),(0,i.delCookie)("uid_key","docs.qq.com","/"),(0,i.delCookie)("TOK","docs.qq.com","/"),(0,i.delCookie)("ES2","docs.qq.com","/"),(0,i.delCookie)("loginTime","docs.qq.com","/"),localStorage.removeItem("renewalTime"))}function g(){m(),setTimeout(function(){window.mqq&&window.mqq.invoke("docx","logoutAccount")},100)}function w(e,t){f?console.log("core-sheet("+e+") handleMobilePskeyError repeatedly"):(console.log("core-sheet("+e+") handleMobilePskeyError relaunching"),f=!0,setTimeout(function(){f=!1,console.log("core-sheet("+e+") handleMobilePskeyError relaunched"),l.default.showBottom("\u817e\u8baf\u6587\u6863","\u767b\u5f55\u540e\u53ef\u7f16\u8f91\u548c\u65b0\u5efa\u6587\u6863","\u7acb\u5373\u767b\u5f55",function(e){o.isTimOrQQ&&11006===t?function(){if(o.isTimOrQQ){var e=o.isTim?"TIM":"QQ";console.error("core-sheet("+e+") onClickBannerLogin2 reload"),m("uid"),window.location.reload()}}():function(){if(o.isTencentDocApp)console.log("core-sheet(APP) onClickBannerLogin"),g();else if(o.isMiniProgram)console.log("core-sheet(MiniProgram) onClickBannerLogin"),m(),window.wx.miniProgram.reLaunch({url:"/pages/list/list?reason=pskey_error"});else if(o.isWeChat)console.log("core-sheet(WeChat) onClickBannerLogin"),window.location.replace("https://docs.qq.com/scenario/h5auth.html?url="+encodeURIComponent(window.location.href)+"&wxonly=1");else if(o.isWeWork){console.log("core-sheet(WeWork) onClickBannerLogin");var e="https://docs.qq.com/scenario/ww-login.html?from=detail&url="+encodeURIComponent(window.location.href);window.location.replace("https://open.weixin.qq.com/connect/oauth2/authorize?appid=ww20388f7040b655b7&redirect_uri="+encodeURIComponent(e)+"&response_type=code&scope=snsapi_userinfo&state=weworklogin#wechat_redirect")}else if(o.isTimOrQQ)if(window.mqq){var t=o.isTim?"TIM":"QQ";console.log("core-sheet("+t+") onClickBannerLogin"),window.mqq.invoke("data","updateLoginInfo",{key:"pskey"},function(e){0===e.code?0===e.result?(console.log("core-sheet("+t+") onClickBannerLogin updateLoginInfo success"),setTimeout(function(){window.location.reload()},1e3)):1===e.result?console.error("core-sheet("+t+") onClickBannerLogin updateLoginInfo too frequently"):2===e.result?console.error("core-sheet("+t+") onClickBannerLogin updateLoginInfo failed"):console.error("core-sheet("+t+") onClickBannerLogin updateLoginInfo result = "+e.result):console.error("core-sheet("+t+") onClickBannerLogin updateLoginInfo rescode = "+e.code)})}else console.log("core-sheet("+t+") onClickBannerLogin window.mqq is null");else console.error("core-sheet(unknown) onClickBannerLogin."),window.location.href="https://docs.qq.com/login.html"}()})},2e3))}},"./js/report/flowlog.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o={isFake:!0,listeners:[],var:{},namespace:"",version:0,_pid:0,_sessionId:"",_startTime:"",_uid:""};["invokeWk","config","deleteDatabase","dispatch","getDBLog","getDBLogByTime","getUUID","getWorkerVar","hideConsole","listen","loadAsset","loadAssetLoader","query","raven","record","report","reportLog","showConsole","ws","debug","error","info","log","warn"].forEach(function(e){o[e]=function(){}});try{o=window.WebLog?new window.WebLog("flow"):o}catch(i){}t.default=o},"./js/report/pv.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportForPV=function(){try{var e,t=window.AlloyReport.tdwReport||l.tdw||function(){},n=window.immMonitor||window.AlloyReport.monitor||s.default.monitor||function(){},o={sheet:{PC:3410973,Mobile:3410974,IOS:3410975,Android:3410976,All:3410982},All:3410983},r=o.sheet;i.isMobile?(n(r[e="Mobile"]),i.isAndroid?e="Android":i.isIOS&&(e="IOS")):e="PC",n(r[e]),n(r.All),n(o.All),clientVars.preview&&t({opername:"doc_pcview",module:"open",action:"pre_req"});var d=(0,a.getQuery)("tdsourcetag");d||(d=localStorage.getItem("tdsourcetag")),d&&((0,a.setCookie)("adtag",d),localStorage.setItem("tdsourcetag",d)),t({opername:"doc_core",module:"visit",action:"detail_page",source3:d||""}),n(33635051),n(33635108)}catch(c){monitor(3410984)}},t.reportForQLPV=function(){try{var e,t=window.AlloyReport.tdwReport||l.tdw||function(){},n=window.immMonitor||window.AlloyReport.monitor||s.default.monitor||function(){},o={PC:34024799,Mobile:34024802,IOS:34024801,Android:34024800,All:34024798};i.isMobile?(n(o[e="Mobile"]),i.isAndroid?e="Android":i.isIOS&&(e="IOS")):e="PC",n(o[e]),n(o.All);var r=(0,a.getQuery)("tdsourcetag");r||(r=localStorage.getItem("tdsourcetag")),r&&((0,a.setCookie)("adtag",r),localStorage.setItem("tdsourcetag",r)),t({opername:"doc_core",module:"visit",action:"detail_page_quicklook",source3:r||""})}catch(d){monitor(3410984)}};var o,i=n("./js/utils/user-agent.js"),a=n("./js/utils/browser.js"),r=n("../node_modules/@tencent/alloy_report_next/index.js"),s=(o=r)&&o.__esModule?o:{default:o},l=n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js")},"./js/report/raven-config.js":function(e,t,n){"use strict";function o(e){var t=new RegExp("(?:^|;+|\\s+)"+e+"=([^;]*)"),n="";return window.document&&(n=window.document.cookie.match(t)),(n?n[1]:"")||null}var i=navigator.userAgent,a=!i.match(/(iPad).*OS\s([\d_]+)/)&&i.match(/(iPhone\sOS)\s([\d_]+)/),r=i.match(/(Android)\s+([\d.]+)/),s=a||r,l=function(e){var t="",n=window.location;return n&&(t=n.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(#|&|$)"))),t?decodeURIComponent(t[2]):""}("currentEnv"),d=[{test:function(e){return"info-report"===(e&&e.logger)},dsn:"https://92a977ae267b4a7e80f07924c32f46df@report.url.cn/sentry/386",project:"386"},{test:function(e){var t=e&&e.culprit;return!(!t||!/s1\.url\.cn\/tim\/docs\/components\//.test(t))},dsn:"https://a3ab7140dcb24d5b8106842ad06454c7@report.url.cn/sentry/334",project:"334"},{test:function(e){return!0},dsn:"https://74bac65beda24ea5a74931da952e024a@report.url.cn/docssentry/8",project:"8"}];try{l?(console.log("currentEnv",l),window.Raven&&Raven.setTagsContext({plantform:s?"mobile":"pc",uid:o("uid"),currentEnv:l})):window.Raven&&Raven.setTagsContext({plantform:s?"mobile":"pc",uid:o("uid")})}catch(u){console.warn(u)}var c=s?33710522:33710521;l&&(c=s?33715453:33715452),window.__jsErrorCount=0,window.addEventListener("error",function(e){var t=e&&e.message||"";console.log("error",T_SHEET.Report.monitor,t,c),T_SHEET.Report.monitor&&(t.match("cefQuery")?T_SHEET.Report.monitor(33715741):t.match("playBackgroundMusic")?T_SHEET.Report.monitor(33715742):t.match("setKeyboardHeight")?T_SHEET.Report.monitor(33715743):t.match("test")?T_SHEET.Report.monitor(33715744):t.match("showTips")?T_SHEET.Report.monitor(33938728):t.match("ExecuteJsInterface")?T_SHEET.Report.monitor(34594185):(T_SHEET.Report.monitor(c),window.__jsErrorCount++,1===window.__jsErrorCount&&window.tencentDocReport&&window.tencentDocReport.tdw&&window.tencentDocReport.tdw({opername:"quality_doc",module:"excel_detail",action:"js_error"})))}),window.Raven&&Raven.config("https://74bac65beda24ea5a74931da952e024a@report.url.cn/docssentry/8",{release:window.__globalReleaseVersion,ignoreErrors:["cefQuery","playBackgroundMusic","setKeyboardHeight","Cannot read property 'test' of undefined","setKeyboardHeight","showTips","ExecuteJsInterface","Changeset"],shouldSendCallback:function(e){return!(window.__jsErrorCount>9)},dataCallback:function(e){if(d&&d.length>0)for(var t=0;t<d.length;t++){var n=d[t];if(n.test&&n.test(e)){e.project!==n.project&&(window.Raven.setDSN(n.dsn),e.project=n.project);break}}return e=window.log&&window.log.raven(e)}}).install()},"./js/report/weblog-config.js":function(e,t,n){"use strict";window.log?(log.config({pid:2,release:"release-20190829-26118152"}),log.record=function(e,t){},T_SHEET.Report.monitor(33712847)):(window.log={isFake:!0,listeners:[],var:{},namespace:"",version:0,_pid:0,_sessionId:"",_startTime:"",_uid:""},["invokeWk","config","deleteDatabase","dispatch","getDBLog","getDBLogByTime","getUUID","getWorkerVar","hideConsole","listen","loadAsset","loadAssetLoader","query","raven","record","report","reportLog","showConsole","ws","debug","error","info","log","warn"].forEach(function(e){log[e]=function(){}}),window.WebLog=function(){return window.log},T_SHEET.Report.monitor(33712848),console.warn("[wl]log undefined"))},"./js/report/whitescreen.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.coreSheetChecker=t.whiteScreenChecker=t.Checker=void 0;var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}(),i=n("./js/utils/user-agent.js");var a=function(){},r=window,s=r.log||{invokeWk:a,report:a,info:a,error:a},l=r.WebLog,d=l?new l("checker"):s,c=window.T_SHEET&&T_SHEET.Report&&T_SHEET.Report.tdwReport||a,u=window.T_SHEET&&T_SHEET.Report&&T_SHEET.Report.monitor||a,p=t.Checker=function(){function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.isChecked=!1,this.name=t,this.options=n,this.hasFinished=!1,this.startTs=0,this.endTs=0,this.nextTickTs=0,this.isCheckedWithError=!1}return o(e,[{key:"_check",value:function(){var e=this.name,t=this.options,n=void 0===t?{}:t,o=n.common,i=void 0===o?{}:o,a=n.timeout,r=n.nextTick,l=n.runNextTick,c=i.reportKeyPrefix,p=void 0===c?"":c,h=this.isChecked,f=r.monitorIds,m=void 0===f?{}:f,g=r.reportKey,w=(r.reportRate,e+"_nextTick"),v=g||p+w,b=Number(new Date);this.nextTickTs=b,window.__ws&&window.__ws.trigger("checkerData",{n:e,t:"nextTick",ts:b,flag:h});var _=h?m.right:m.error;if(_&&u(_),this.hasFinished=!0,d.info(w,{flag:h}),!h){var y=s.report(v);window.__ws&&window.__ws.trigger("checkerError",{name:e,reportId:y})}!h&&a&&s.invokeWk("CLEAR_CHECKER_TIMEOUT",{name:e}),l&&l(h)}},{key:"start",value:function(){var e=this,t=this.name,n=this.options,o=void 0===n?{}:n,i=o.common,a=void 0===i?{}:i,r=o.timeout,l=o.withCatchError,c=a.reportKeyPrefix,u=void 0===c?"":c,p=t+"_start";d.info(p);var h=Number(new Date);if(this.startTs=h,window.__ws&&window.__ws.trigger("checkerData",{n:t,t:"start",ts:h}),r){var f=r.time,m=r.getTime,g=r.monitorId,w=r.reportKey,v=r.reportRate;s.invokeWk("SET_CHECKER_TIMEOUT",{name:t,time:f||(m?m():0),monitorId:g,reportKey:w,reportRate:v,reportKeyPrefix:u})}l||setTimeout(function(){e._check()},0)}},{key:"end",value:function(){if(!this.isCheckedWithError){this.isChecked=!0;var e=this.name,t=this.options,n=t.timeout,o=t.withCatchError,i=e+"_end",a=Number(new Date);this.endTickTs=a,window.__ws&&window.__ws.trigger("checkerData",{n:e,t:"end",ts:a}),d.info(i),n&&s.invokeWk("CLEAR_CHECKER_TIMEOUT",{name:e}),o&&this._check()}}},{key:"endWithError",value:function(e){if(!this.isChecked){this.isCheckedWithError=!0;var t=this.name,n=this.options.withCatchError,o=Number(new Date),i="";try{i=e.toString()}catch(a){}window.__ws&&window.__ws.trigger("checkerData",{n:t,t:"endWithError",ts:o,msg:i}),s.error("[init error]",i),s.report("EXCEL_CHECKER_INIT_CATCH"),window.AlloyReport&&window.AlloyReport.monitor(34378724),n&&this._check()}}}]),e}();function h(){try{if(r.clientVars&&r.clientVars.isBlankPage)return;var e=function(){var e=(i.isMobile,document.querySelector("#canvasContainer canvas"));return e?{width:e.width,height:e.height,dataURL:e.toDataURL(),isReal:!0}:{width:0,height:0,dataURL:"",isReal:!1}}(),t=e.width,n=e.height,o=e.dataURL,a=e.isReal;return{isCanvasBlank:o===function(e,t){if(!e||!t)return"";var n=document.createElement("canvas");return n.width=e,n.height=t,n.toDataURL()}(t,n),isReal:a}}catch(l){console.warn("checkExcelCanvasError",l),s.error("checkExcelCanvasError",{msg:l.message}),u(33906053),c({opername:"excel_error",module:"error",action:"checkExcelCanvas",ver5:r.location.href,ver6:r.clientVars.isMobile,ver7:l.message})}}var f=(window&&(window.performance||window.webkitPerformance||window.msPerformance)||{}).timing,m=t.whiteScreenChecker=new p("whitescreen",{timeout:{time:0,getTime:function(){var e=(f||{}).navigationStart,t=void 0===e?0:e;return t>0?3e4-(Date.now()-t):3e4},monitorId:33945552,reportRate:.2},nextTick:{monitorIds:{right:33945550,error:33945551}},common:{reportKeyPrefix:"EXCEL_CHECKER_"},withCatchError:!0,runNextTick:function(e){if(e){window.__ws&&window.__ws.trigger("firstScreenFinish");var t=h();if(!t)return;var n=t||{},o=n.isCanvasBlank,a=n.isReal;if(s.info("whiteScreenChecker",t),o){var l=a?"whitescreen_canvas_error":"whitescreen_dom_error",d=a?"EXCEL_CHECKER_whitescreen_canvas_error":"EXCEL_CHECKER_whitescreen_dom_error";u(a?33945554:33945553),c({opername:"excel_error",module:"error",action:l,ver5:r.location.href,ver6:o,ver7:a}),s.report(d),setTimeout(function(){var e=function(e){try{var t=(i.isMobile,document.querySelector("#canvasContainer canvas"));if(!t)return"";var n=e.width,o=e.height,a=t.getContext("2d"),r=document.createElement("canvas"),s=r.getContext("2d");return r.width=n,r.height=o,s.putImageData(a.getImageData(20,20,n,o),0,0),r.toDataURL("image/jpeg",1)}catch(l){return"getCanvasData ERROR"}}({width:150,height:150});s.report(d,{data:{type:"canvasData",canvasData:e}})},1500)}}}}),g=t.coreSheetChecker=new p("coresheet",{nextTick:{monitorIds:{right:33945534,error:33945535}},common:{reportKeyPrefix:"EXCEL_CHECKER_"}});window.addEventListener("beforeunload",function(){if(!window.__reloadAndRetry&&!m.isChecked){var e="whitescreen_beforeunload"+(window.quickLookRenderEnd?"_quickLook":""),t=f||{},n=t.fetchStart,o=void 0===n?0:n,i=t.responseStart,a=void 0===i?0:i,r=window.performanceData&&window.performanceData.jsStartRun,s=Date.now();c({opername:"excel_error",module:"error",action:e,ver5:o||s,ver6:a||0,ver7:r||0,ver8:s||0})}}),t.default={Checker:p,whiteScreenChecker:m,coreSheetChecker:g}},"./js/script-loader/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ScriptLoader=void 0,t.manualInitScriptLoader=function(){(0,i.getCookie)("dev_route_id")?o.ScriptLoader.init("/tim/docs/components/assets.v4.json"):o.ScriptLoader.init("//s1.url.cn/tim/docs/components/assets.v4.json");window.SLR=o.ScriptLoader},t.loadModule=function(e,t){window.swReportStop&&window.swReportStop(),a[e]?(t(a[e],!1),window.swReportRestart&&window.swReportRestart()):o.ScriptLoader.load(e,function(n){a[e]=n,t(n,!0),window.swReportRestart&&window.swReportRestart()})};var o=n("./js/script-loader/script-loader.js"),i=n("./js/utils/browser.js"),a={};t.ScriptLoader=o.ScriptLoader},"./js/script-loader/script-loader.js":function(e,t,n){"use strict";function o(){}Object.defineProperty(t,"__esModule",{value:!0}),function(){if("function"===typeof window.CustomEvent)return!1;function e(e,t){var n=t||{bubbles:!1,cancelable:!1,detail:void 0},o=document.createEvent("CustomEvent");return o.initCustomEvent(e,n.bubbles,n.cancelable,n.detail),o}e.prototype=window.Event.prototype,window.CustomEvent=e}();var i=t.ScriptLoader={metadata:null,firstLoaded:{},asset:null,assetLoaded:!1,cache:{},evtArr:[],init:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;if(a||(this.asset=this.asset||{},this.asset.QReport={url:"//s1.url.cn/pub/js/alloyreport.js?_bid=2231",state:-1},this.loadReport()),a<=2){var r=e+"?_t="+Date.now();this.ajax({url:r,success:function(e){n.metadata=e.data.metadata,delete e.data.metadata,delete e.data.ScriptLoader,Object.keys(e.data).forEach(function(t){if(n.asset[t]={url:e.data[t].js||null,state:-1},e.data[t].dependency){var o=e.data[t].dependency;n.asset[t].dep=o,Object.keys(o).forEach(function(e){n.asset[e]={url:o[e],state:-1}})}}),n.assetLoaded=!0,n.dispatch("SL-INIT"),t&&t(),n.evtArr.forEach(function(e){n.dispatch(e.eventName,e.detail)}),n.monitor(3078347)},fail:function(o){console.log(o),n.init(e,t,i,++a),n.monitor(3078348)}})}else i&&i({code:1,msg:"load error"})},loadReport:function(){window.QReport||this.loadScriptProcess({asset:this.asset,cache:this.cache,mod:"QReport",parentModule:"QReport"},o,o,0)},monitor:function(e){window.QReport&&window.QReport.monitor(e)},load:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o,n=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,r=this.asset,s=this.cache;try{"undefined"!==typeof r[e]?"undefined"===typeof s[e]&&a<=2?(r[e].dep&&Object.keys(r[e].dep).forEach(function(o){window[o]?(s[o]=window[o],r[o].state=0):"undefined"===typeof s[o]&&-1===r[o].state&&n.loadScriptProcess({asset:r,cache:s,mod:o,parentModule:e},t,i,a)}),-1===r[e].state&&this.loadScriptProcess({asset:r,cache:s,mod:e,parentModule:e},t,i,a)):s[e]&&this.firstLoaded[e]&&this.checkAllLoaded(r,e)&&(t(s[e],s),this.firstLoaded[e]=!0):(console.log(e+" is not found."),i&&i({code:1,msg:e+" is not found."}))}catch(l){console.log(l),this.monitor(3078382),i&&i({code:2,msg:l})}},loadScriptProcess:function(e,t,n,o){var i=e.asset,a=e.cache,r=e.mod,s=e.parentModule,l=this,d=null;d=this.createScript(i[r].url),i[r].state=1,d.addEventListener("load",function(){window[r]&&(a[r]=window[r],i[r].state=0,!l.firstLoaded[s]&&l.checkAllLoaded(i,s)&&t(a[s],a),l.monitor(3078345))}),d.addEventListener("error",function(){i[r].state=o>=2?2:-1,l.load(r,t,n,++o),d&&l.removeScript(d),n&&n({code:3,msg:"load error"}),l.monitor(3078346)})},checkAllLoaded:function(e,t){var n=e[t];if(0!==e[t].state)return!1;if("undefined"!==typeof n.dep)for(var o=Object.keys(n.dep),i=0,a=o.length;i<a;i++)if(!window[o[i]])return!1;return this.firstLoaded[t]=!0,!0},createScript:function(e){var t=document.createElement("script");return t.src=e,t.async=!1,t.type="text/javascript",document.body.appendChild(t),t},removeScript:function(e){e&&e.parentNode&&e.parentNode.removeChild(e)},ajax:function(e){var t=this,n=function(e){var t={};return t.url=e.url,t.paramObj=e.param||{},t.success=e.success||o,t.fail=e.fail||o,t.method=e.ajaxType||"GET",t.method=t.method.toUpperCase(),t}(e),i=function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n+"="+encodeURIComponent(e[n]));return t.join("&")}(n.paramObj),a=function(e,t){return e+=e.indexOf("?")>=0?"&":"?"+t}(n.url,i),r=function(){for(var e=null,t=[function(){return new XMLHttpRequest},function(){return new(0,window.XDomainRequest)},function(){return new window.ActiveXObject("Msxml2.XMLHTTP")},function(){return new window.ActiveXObject("Msxml3.xmlhttp")},function(){return new window.ActiveXObject("Microsoft.XMLHTTP")}],n=0,o=t.length;n<o;n++){try{e=t[n]()}catch(i){continue}break}return e}();if(!r)throw new Error("XMLHttp is not defined");r.open("GET",a,!0),r.send(),r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var e=JSON.parse(r.responseText);n.success({data:e,code:0}),t.monitor(3078349)}else n.fail({code:r.status}),r.status>=400&&r.status<500?t.monitor(3078350):r.status>=500&&r.status<600&&t.monitor(3078351)},r.onerror=function(){n.fail({code:-1})}},dispatch:function(e,t){if(this.assetLoaded){var n=new window.CustomEvent(e,{detail:t});window.dispatchEvent(n)}else this.evtArr.push({eventName:e,detail:t})},listen:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o;window.addEventListener(e,t)}};window.ScriptLoader||(window.ScriptLoader=i),window.SLR=i},"./js/service-worker/sw.js":function(e,t,n){"use strict";n("../node_modules/@tencent/tencent-doc-report/lib/index.browser.js");!function(){try{navigator.serviceWorker&&navigator.serviceWorker.getRegistrations().then(function(e){for(var t=0;t<e.length;t++)e[t].unregister()})}catch(t){console.log("unregister service-worker error :",t)}var e=navigator.userAgent.toLowerCase();/(android)/.test(e)||/(iphone|ipad|ipod)/.test(e);window.swReportCatonStart=function(){},window.swReportStop=function(){window.T_SHEET.Report.jank.stopReport()},window.swReportRestart=function(){window.T_SHEET.Report.jank.restartReport()}}()},"./js/utils/aria/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAriaLabel=function(e,t){document.querySelectorAll(e).forEach(function(e,n){var o=e.getAttribute("data-tooltip");o&&(e.setAttribute("aria-label",o),e.setAttribute("tabindex",t||10))})}},"./js/utils/browser.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.localStorageUtil=void 0,t.getQuery=a,t.getQueryObject=function(e){var t={},n=void 0;n=/^\?/.test(e)?e.substr(1):e;for(var o=n.split("&"),i=0;i<o.length;i++)t[o[i].split("=")[0]]=unescape(o[i].split("=")[1]);return t},t.getHash=function(e){var t=window.location.hash.match(new RegExp("(#|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""},t.removeURLParameter=function(e,t){var n=e.split("?");if(n.length>=2){for(var o=encodeURIComponent(t)+"=",i=n[1].split(/[&;]/g),a=i.length;a-- >0;)-1!==i[a].lastIndexOf(o,0)&&i.splice(a,1);return e=n[0]+(i.length>0?"?"+i.join("&"):"")}return e},t.updateQueryStringParameter=function(e,t){var n=!0,o=!1,i=void 0;try{for(var a,r=Object.keys(t)[Symbol.iterator]();!(n=(a=r.next()).done);n=!0){var s=a.value,l=new RegExp("([?&])"+s+"=.*?(&|$)","i"),d=t[s],c=-1!==e.indexOf("?")?"&":"?";e=e.match(l)?e.replace(l,"$1"+s+"="+d+"$2"):e+c+s+"="+d}}catch(u){o=!0,i=u}finally{try{!n&&r.return&&r.return()}finally{if(o)throw i}}return e},t.getCookie=r,t.setCookie=s,t.delCookie=l,t.clearCookie=function(e,t,n,o,i){var a=document.cookie.match(new RegExp("([^ ;][^;]*)(?=(=[^;]*)(;|$))","gi")),r=!0,s=!1,l=void 0;try{for(var d,c=Object.keys(a)[Symbol.iterator]();!(r=(d=c.next()).done);r=!0){var u=d.value;document.cookie=a[u]+"=;expires=Mon, 26 Jul 1997 05:00:00 GMT; path=/; "}}catch(p){s=!0,l=p}finally{try{!r&&c.return&&c.return()}finally{if(s)throw l}}},t.getCookieUid=function(){return r("uid")},t.getCookieUin=function(){return(r("p_luin")||r("p_uin")).replace(/^[o0]+/i,"")},t.getBkn=function(){var e=r("skey"),t=5381;if(!e)return;for(var n=0,o=e.length;o>n;++n)t+=(t<<5)+e.charAt(n).charCodeAt();return 2147483647&t},t.getXsrf=function(){return r("TOK")||""},t.getUidParam=function(e){var t=a("uid"),n=a("uid_key"),o=t?"uid="+t+"&uid_key="+n:"";if(!o)return e;return e.indexOf("?")>=0?e+"&"+o:e+"?"+o},t.setLocalActions=function(e,t){t.createdDate=Number(new Date);var n="docs_actions",o=d.getItem(n);o=o&&JSON.parse(o)||[];var i={};o.forEach(function(e,t){var n=e.data;i[n.localPadId+"$"+n.domainId]={index:t,type:e.type,value:n}});var a=i[t.localPadId+"$"+t.domainId];if(a){var r=!0,s=!1,l=void 0;try{for(var c,u=Object.keys(t)[Symbol.iterator]();!(r=(c=u.next()).done);r=!0){var p=c.value;a.value[p]=t[p]}}catch(h){s=!0,l=h}finally{try{!r&&u.return&&u.return()}finally{if(s)throw l}}o[a.index]={type:"ADD"===a.type&&"MODIFY"===e?"ADD":e,data:a.value}}else o.push({type:e,data:t});d.setItem(n,JSON.stringify(o))},t.isPortrait=function(){if("number"==typeof window.orientation)return window.orientation/90%2==0;try{var e=window.screen.orientation.angle;if("number"==typeof e)return e/90%2==0}catch(t){}return!0},t.supportRotate=function(){window.mqq&&mqq.ui&&mqq.ui.setWebViewBehavior&&mqq.ui.setWebViewBehavior({restoreOrientation:"1"})},t.forceRotatePortrait=function(){window.mqq&&mqq.ui&&mqq.ui.setWebViewBehavior&&mqq.ui.setWebViewBehavior({orientation:0})},t.updateUrl=function(e,t){var t=(t||"t")+"=",n=new RegExp(t+"\\d+"),o=Number(new Date);if(e.indexOf(t)>-1)return e.replace(n,t+o);if(e.indexOf("?")>-1){var i=e.split("?");return i[1]?i[0]+"?"+t+o+"&"+i[1]:i[0]+"?"+t+o}return e.indexOf("#")>-1?e.split("#")[0]+"?"+t+o+location.hash:e+"?"+t+o},t.openUrlForMobile=function(e){i.isTimOrQQ&&window.mqq?i.isQQ?mqq.invoke("ui","openUrl",{url:e,target:1,style:2},function(){}):mqq.iOS?mqq.invoke("nav","openLinkInNewWebView",{url:e},function(){}):mqq.invoke("ui","openUrl",{url:e,target:1,style:2,useQQBrowser:!0},function(){}):window.location.href=e};n("./js/utils/util.js");var o=n("./js/utils/type.js"),i=n("./js/utils/user-agent.js");function a(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""}function r(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}function s(e,t,n,o,i){var a=new Date;a.setTime(a.getTime()+(i?36e5*i:2592e6)),document.cookie=e+"="+t+"; expires="+a.toGMTString()+"; path="+(o||"/")+"; "+(n?"domain="+n+";":"")}function l(e,t,n){document.cookie=e+"=; expires=Mon, 26 Jul 1997 05:00:00 GMT; path="+(n||"/")+"; "+(t?"domain="+t+";":"")}var d=t.localStorageUtil={setItem:function(e,t){(0,o.isUndefined)(window.Storage)?s(e,t):localStorage.setItem(e,t)},getItem:function(e){return(0,o.isUndefined)(window.Storage)?r(e):localStorage.getItem(e)},delItem:function(e){(0,o.isUndefined)(window.Storage)?l(e):delete localStorage[e]}}},"./js/utils/date.js":function(e,t,n){"use strict";function o(e,t){var n={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds(),"q+":Math.floor((e.getMonth()+3)/3),S:e.getMilliseconds()};for(var o in/(y+)/.test(t)&&(t=t.replace(RegExp.$1,String(e.getFullYear()).substr(4-RegExp.$1.length))),n)new RegExp("("+o+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?n[o]:("00"+n[o]).substr(String(n[o]).length)));return t}Object.defineProperty(t,"__esModule",{value:!0}),t.Format=o,t.localstringFromTime=function(e){var t=new Date;return t.setTime(e),o(t,"yyyy/MM/dd hh:mm:ss")},t.simpleDateTime=function(e){var t=new Date(Number(e)),n=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"][t.getDay()],o=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()],i=t.getDate(),a=t.getFullYear(),r=t.getHours()+":"+("0"+t.getMinutes()).slice(-2);return n+" "+o+" "+i+" "+a+" "+r},t.toISOString=function(e){function t(e){return e<10?"0"+e:e}return e.getUTCFullYear()+"-"+t(e.getUTCMonth()+1)+"-"+t(e.getUTCDate())+"T"+t(e.getUTCHours())+":"+t(e.getUTCMinutes())+":"+t(e.getUTCSeconds())+"."+function(e){e<100&&(e="0"+e);e<10&&(e="0"+e);return e}(e.getUTCMilliseconds())+"Z"},t.prettyDate=function(e){if(!e)return;var t=e.replace(/\s+/,"").split(/[^0-9]/),n=null;n=t.length>=5?e?new Date(t[0],t[1]-1,t[2],t[3],t[4]):new Date:e?new Date(e):new Date;var o=new Date,i="",a=n.getHours(),r=n.getMinutes(),s=(a>9?a:"0"+a)+":"+(r>9?r:"0"+r),l=new Date(o.getFullYear(),o.getMonth(),o.getDate())-n;i=l>0&&l<864e5?"\u6628\u5929 "+s:n.getFullYear()<o.getFullYear()?n.getFullYear()+"/"+(n.getMonth()+1)+"/"+n.getDate()+" "+s:n.getMonth()<o.getMonth()||n.getDate()<o.getDate()?n.getMonth()+1+"/"+n.getDate()+" "+s:s;return i},t.dateFormat=function(e){return e instanceof Date?[e.getFullYear(),"\u5e74",e.getMonth()+1,"\u6708",e.getDate(),"\u65e5 ",e.getHours()>9?e.getHours():"0"+e.getHours(),":",e.getMinutes()>9?e.getMinutes():"0"+e.getMinutes(),":",e.getSeconds()>9?e.getSeconds():"0"+e.getSeconds()].join(""):e.toString?e.toString():""}},"./js/utils/env.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createEnvAlert=function(){var e=clientVars.envi||{},t=e.type,n=function(){var n=[" \u5f00\u53d1\u73af\u5883  "," \u7cfb\u7edf\u6d4b\u8bd5\u73af\u5883  "," \u6b63\u5f0f\u73af\u5883  "][t],i=e.port?"    \u7aef\u53e3: "+e.port:"",a=(0,o.getCookie)("route_ip");a&&(a=a.split(":")[0]),"10.137.144.80"===a&&(n=" \u7cfb\u7edf\u6d4b\u8bd5\u73af\u5883"),a="ip\uff1a "+a;var r=$('<div className="createEnviAlert"></div>').appendTo("body");n="\u5f53\u524d\u5728  "+a+n+i,(0,o.getCookie)("fd")&&(n+=" \u76ee\u5f55\uff1a"+(0,o.getCookie)("fd")),(0,o.getCookie)("dev_route_id")&&(n+=" dev_route_id:"+(0,o.getCookie)("dev_route_id")),r.text(n),r.css({background:"#000",color:"#fff",opacity:.7,width:650,height:"30px",position:"absolute",top:0,left:200,zIndex:9999,textAlign:"center",lineHeight:"30px"}),setTimeout(function(){r.fadeOut(1e3,function(){r.remove()})},3e3)};if(i.event.keyboard.listen("keydown",function(e){192===e.keyCode&&e.shiftKey&&e.ctrlKey&&n()}),0===e.type)return n()},t.isDevMode=function(){var e=clientVars.envi,t=(0,o.getCookie)("dev_oa_name");if(e&&0===e.type&&t)return!0;return!1};var o=n("./js/utils/browser.js"),i=n("./js/event/event-center.js")},"./js/utils/hash.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseHash=a,t.stringifyHash=r,t.pushState=s,t.get=function(e){return i.KV[e]},t.set=function(e,t){if((0,o.isUndefined)(e)||(0,o.isUndefined)(t))return console.error("[pad_hash_tools]\u4e0d\u5141\u8bb8\u4f20\u5165\u7a7a\u503c"),!1;i.KV[e]=t;return u(r(i.KV)),!0},t.getHashObj=function(){return i.KV},t._updateTools=l,t.getHashValue=d,t.getToalHash=function(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.slice(t)},t.pushHash=c,t.replaceHash=u,t.clear=function(){i.KV={},u("")};var o=n("./js/utils/type.js"),i={KV:{}};function a(e){var t=d(),n={};return(t?t.split("&"):[]).forEach(function(e){var t=e.split("="),o=t[0],i=t[1];n[o]=i}),n}function r(e){var t="#",n=!0,o=!0,i=!1,a=void 0;try{for(var r,s=Object.keys(e)[Symbol.iterator]();!(o=(r=s.next()).done);o=!0){var l=r.value,d=l+"="+e[l];n?(t+=d,n=!1):t=t+"&"+d}}catch(c){i=!0,a=c}finally{try{!o&&s.return&&s.return()}finally{if(i)throw a}}return n?"":t}function s(e,t){var n=window.history;try{t?n.replaceState(null,"",e):n.pushState(null,"",e)}catch(o){window.location[t?"replace":"assign"](e)}}function l(e){i.KV=a()}function d(){var e=window.location.href,t=e.indexOf("#");return-1===t?"":e.slice(t+1)}function c(e,t){var n=-1===e.indexOf("#")?"#"+e:e;s(window.location.pathname+window.location.search+n,t),l()}function u(e){c(e,!0)}l(d())},"./js/utils/log.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=log=window.log},"./js/utils/pad/actions.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCancellableAction=function(e,t){var n=o[e];n||(n={},o[e]=n);var a=i++;return n[a]=!0,function(){var n=o[e];n&&n[a]&&t()}},t.cancelActions=function(e){o[e]&&delete o[e]};var o={},i=1},"./js/utils/safe.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeHTML=function(e){var t=/[&<>'"]/g;t.MAP||(t.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"});return e.replace(t,function(e){return t.MAP[e]})}},"./js/utils/type.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function i(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function a(e){return"[object Null]"===Object.prototype.toString.call(e)}t.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},t.isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)},t.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},t.isObject=function(e){return"object"===("undefined"===typeof e?"undefined":o(e))},t.isFunction=function(e){return"[object Function]"===Object.prototype.toString.call(e)},t.isUndefined=i,t.isNull=a,t.isSet=function(e){return!i(e)&&!a(e)},t.arrayEqual=function(e){var t=e;if(this===t)return!0;if(this instanceof Array===!1||t instanceof Array===!1||this.length!==t.length)return!1;for(var n=0;n<this.length;n++)if(this[n]!==t[n])return!1;return!0}},"./js/utils/ui/dom.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.nodeToString=function(e){var t=document.createElement("div");t.appendChild(e.cloneNode(!0));var n=t.innerHTML;return t=e=null,n},t.btnState=function(e,t,n,o){e.bind("mousedown",function(e){$(this).removeClass(n+" "+t),$(this).addClass(o)}),e.bind("mouseup",function(e){$(this).removeClass(o+" "+t),$(this).addClass(n)}),e.bind("mouseenter",function(e){$(this).removeClass(t),$(this).addClass(n)}),e.bind("mouseleave",function(e){$(this).removeClass(n+" "+o),$(this).addClass(t)})},t.btnRemoveState=function(e){e.unbind("mousedown"),e.unbind("mouseup"),e.unbind("mouseenter"),e.unbind("mouseleave")}},"./js/utils/ui/image.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.viewImage=function e(t,o){o||(o=0);"string"===typeof t&&(t=[t]);if(((0,i.MTIMLargerOrEqual)("1.0.2")||(0,i.MQQLargerOrEqual)("6.7.0"))&&!(i.isPad&&(0,i.getIOSVersion)()<=9))return t=[].concat(t).map(function(e){return/^http/i.test(e)?e:"https:"+e}),void(window.mqq&&mqq.invoke("troopNotice","showPicture",{index:o,imageIDs:t}));$(".lightbox-container").remove();var s=$("<div>").addClass("lightbox-container");$("body").append(s);var d=$('<button class="hp-ui-button docx-icon-common image-close-icon"></button>');d.on("click",u);(0,a.btnState)(d,"image-close-icon","image-close-icon-hover","image-close-icon");$(".lightbox-container").on("touchmove",function(e){e.preventDefault(),e.stopPropagation()});$(".lightbox-container").on("mousemove",function(e){e.stopPropagation()});var c=Date.now();function u(){Date.now()>c+500&&$(".lightbox-container").remove()}function p(n){return t&&n&&0===o?((0,r.showToast)("\u5df2\u7ecf\u662f\u7b2c\u4e00\u5f20",{},{supportMobile:!0,toolToastCloseTime:2e3}),void $("#toolToastWrap").css({zIndex:10006})):t&&!n&&o===t.length-1?((0,r.showToast)("\u5df2\u7ecf\u662f\u6700\u540e\u4e00\u5f20",{},{supportMobile:!0,toolToastCloseTime:2e3}),void $("#toolToastWrap").css({zIndex:10006})):void e(t,n?o-1:o+1)}var h=null;h=i.isMobile?$("<div>").addClass("lightbox-inner").addClass("center-content").append($("<img id='lightbox-img' ondragstart='return false'>").attr("src",t[o])):$("<div>").addClass("lightbox-inner").addClass("center-content").append($("<img id='lightbox-img' ondragstart='return false'>").attr("src",t[o])).css({paddingLeft:50,paddingRight:50}).append(d);var f=$("<div>").addClass("center-wrap").append(h);s.append(f);$('<div id="pageNum"></div>').text(o+1+"/"+t.length).appendTo(s);!function(){var e=$("#lightbox-img")[0];if(e.clientWidth>document.body.clientWidth||e.clientHeight>document.body.clientHeight){var t=Math.min(document.body.clientWidth/e.clientWidth,document.body.clientHeight/e.clientHeight);e.width=e.clientWidth*t,e.Height=e.clientHeight*t}}();!function(e){var t=$("#lightbox-img")[0];t.style.transformOrigin="center",t.style.transform="scale("+e+")",t.style.msTransform="scale("+e+")",t.style.mozTransform="scale("+e+")",t.style.webkitTransform="scale("+e+")",t.style.oTransform="scale("+e+")"}(1);if(!i.isMobile){var m=t[o-1],g=t[o+1];(m||g)&&($('<div id="lightbox-prev-wrap"><div id="lightbox-prev"></div></div>').click(function(){return p(!0),!1}).appendTo(s),$('<div id="lightbox-next-wrap"><div id="lightbox-next"></div></div>').click(function(){return p(!1),!1}).appendTo(s)),s.click(u)}s.css("z-index",10005);$("#lightbox-img").bind("load",function(){$(this).stop(!0,!0).fadeIn()});i.isMobile&&function(e,t,o){(0,l.default)(e);var i=1,a=!0;function r(){$(e).animate({originX:0,originY:0,scaleX:1,scaleY:1,translateX:0,translateY:0,width:t||"auto",height:o||"auto"},300),i=1}n.e("bundle_alloy_finger").then(n.t.bind(null,"./js/app/lib/alloy_finger.js",7)).then(function(n){var s=n.default;new s(e,{multipointStart:function(t){a=!1;var n=(t.touches[0].pageX+t.touches[1].pageX)/2,o=(t.touches[0].pageY+t.touches[1].pageY)/2,r=e.getBoundingClientRect(),s=r.left+r.width/2,l=r.top+r.height/2,d=n-s,c=o-l,u=e.originX,p=e.originY;e.originX=d/e.scaleX,e.originY=c/e.scaleY,e.translateX+=d-u*e.scaleX,e.translateY+=c-p*e.scaleX,i=e.scaleX},pinch:function(t){e.scaleX=e.scaleY=Math.min(i*t.zoom,3),c=Date.now()},pressMove:function(n){var i=e.scaleX,r=e.width,s=n.deltaX,l=n.deltaY;i<=1||i*r<=document.body.clientWidth?a=!0:e&&function(n,i){var a=e.getAttribute("rate");if(e.width=t,e.height=o,1!==e.scaleX||e.scaleX!==a){var r=(e.scaleX-1)*(e.width/2+e.originX)+e.originX,s=-(e.scaleX-1)*(e.width/2-e.originX)+e.originX,l=(e.scaleX-1)*(e.height/2+e.originY)+e.originY,d=-(e.scaleX-1)*(e.height/2-e.originY)+e.originY;if(e.translateX+n<=r&&e.translateX+n>=s&&e.translateY+i<=l&&e.translateY+i>=d)return!0}return!1}(s,l)?(e.translateX+=n.deltaX,e.translateY+=n.deltaY,a=!1):a=!0},doubleTap:function(e){r()},singleTap:function(e){u()},touchEnd:function(e){},multipointEnd:function(t){e.scaleX<1&&r()},swipe:function(e){if(!a)return!1;var t=e.direction;switch(t){case"Left":p(!1);break;case"Right":p(!0)}}})})}($(".lightbox-inner")[0],$("#lightbox-img")[0].clientWidth,$("#lightbox-img")[0].clientHeight)};var o,i=n("./js/utils/user-agent.js"),a=n("./js/utils/ui/dom.js"),r=n("./js/component/toast/index.js"),s=n("./js/app/lib/transform.js"),l=(o=s)&&o.__esModule?o:{default:o}},"./js/utils/ui/index.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.locked=function(){o={bodyHeight:$("body").css("height"),bodyOverflow:$("body").css("overflow"),bodyPosition:$("body").css("position")},$("html").css({height:"100%",overflow:"hidden"}),$("body").css({height:"100%",overflow:"hidden",position:"fixed",top:0,left:0,right:0,bottom:0})},t.release=function(){$("html").css({overflow:"",height:""}),$("body").css({height:o.bodyHeight||"",overflow:o.bodyOverflow||"",position:o.bodyPosition||"",left:"",top:"",right:"",bottom:""})};var o={}},"./js/utils/ui/measure.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(t,n,o){return n&&e(t.prototype,n),o&&e(t,o),t}}();var i=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.defaultStyle="position: absolute;left:-10000px;",this.dom=$('<span style="'+this.defaultStyle+'"></span>'),this.dom.appendTo(document.body)}return o(e,[{key:"getTextWidth",value:function(e,t){var n=e+";"+this.defaultStyle;return this.dom.attr("style",n),t=t.replace(/\s/g,"_"),this.dom.text(t),this.dom.outerWidth()}}]),e}();t.default=new i},"./js/utils/ui/toolbar-html.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getToolbarContentMenuButton=function(e){var t=e.id,n=e.tooltip,o=e.identity,i=e.disabled,a=e.stateClassName,r=e.iconContent,s=e.iconClassName;return"\n            "+function(e){var t=e.id,n=e.tooltip,o=e.disabled,i=e.stateClassName,a=e.className,r=e.identity,s=e.iconContent;return"<div "+function(e){return e?'id="'+e+'"':""}(t)+" "+function(e){return e?'data-tooltip="'+e+'"':""}(n)+" "+(r?'identity="'+r+'"':"")+" "+(o?"disabled":"")+' class="hp-ui-button '+(a||"")+" "+(i||"")+'" aria-label="'+(n||s)+'" tabindex="3" role="menu">'}({id:t,tooltip:n,identity:o,disabled:i,stateClassName:a,className:"toolbar-menu-button-wrapper",iconContent:r})+'\n                <div class="toolbar-menu-button-outer-container toolbar-inline-block" style="user-select: none;">\n                    <div class="toolbar-menu-button-inner-container toolbar-inline-block" style="user-select: none;">\n                        <div class="toolbar-menu-button-icon toolbar-menu-button-content docx-icon-container toolbar-inline-block '+(s||"")+'" style="user-select: none;">\n                            '+(r||"")+'\n                        </div>\n                        <div class="toolbar-menu-button-dropdown toolbar-inline-block" style="user-select: none;"></div>\n                    </div>\n                </div>\n            </div>'},t.getDropdown=function(){return'\n            <script id="template-dropdown-wrapper" type="text/html">\n                <div id="dropdown-wrapper" class="dropdown-wrapper common-web-popup-boxshadow"></div>\n            <\/script>\n\n            <script id="template-dropdown-image-content-row" type="text/html">\n                <li class="li-dropdown-ic li-dropdown">\n                    <div class="dropdown-ic-img-wrapper dropdown-img-wrapper">\n                        <div class="dropdown-ic-img dropdown-img"></div>\n                    </div>\n                    <div class="dropdown-ic-content-wrapper dropdown-content-wrapper">\n                        <div class="dropdown-ic-content dropdown-content"></div>\n                    </div>\n                </li>\n            <\/script>\n\n            <script id="template-dropdown-image-row" type="text/html">\n                <li class="li-dropdown-i li-dropdown">\n                    <div class="dropdown-i-img-wrapper dropdown-img-wrapper">\n                        <div class="dropdown-i-img dropdown-img"></div>\n                    </div>\n                </li>\n            <\/script>\n\n            <script id="template-dropdown-content-row" type="text/html">\n                <li class="li-dropdown-c li-dropdown">\n                    <div class="dropdown-c-content-wrapper dropdown-content-wrapper">\n                        <div class="dropdown-c-content dropdown-content"></div>\n                    </div>\n                </li>\n            <\/script>\n\n            <script id="template-dropdown-content-separator-row" type="text/html">\n                <li class="li-dropdown-c li-dropdown li-dropdown-separator">\n                    <div class="dropdown-separator-wrapper">\n                        <div class="dropdown-separator"></div>\n                    </div>\n                    <div class="dropdown-c-content-wrapper dropdown-content-wrapper">\n                        <div class="dropdown-c-content dropdown-content"></div>\n                    </div>\n                </li>\n            <\/script>\n\n            <script id="template-dropdown-celltype-row" type="text/html">\n                <li class="li-dropdown-celltype li-dropdown">\n                    <div class="dropdown-celltype-wrapper">\n                        <div class="dropdown-celltype-title"></div>\n                        <div class="dropdown-celltype-detail"></div>\n                    </div>\n                </li>\n            <\/script>\n\n            <script id="template-dropdown-separator-row" type="text/html">\n                <div class="dropdown-separator-wrapper">\n                    <div class="dropdown-separator"></div>\n                </div>\n            <\/script>'}},"./js/utils/ui/tooltip.js":function(module,exports,__webpack_require__){"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.tooltip=tooltip,exports.horizontalTooltip=horizontalTooltip,exports.hideTooltip=hideTooltip,exports.removeTooltip=removeTooltip,exports.setNewFeatureTips=setNewFeatureTips,exports.setToolbarFormFeatureTips=setToolbarFormFeatureTips,exports.changeTooltipText=changeTooltipText;var _userAgent=__webpack_require__("./js/utils/user-agent.js"),_eventCenter=__webpack_require__("./js/event/event-center.js"),_setTimeoutId=void 0;function toolTipMouseenter(e){var extendParam=e.data?e.data.extendParam:null,drawViewCallback=e.data?e.data.drawViewCallback:null;_setTimeoutId&&(clearTimeout(_setTimeoutId),_setTimeoutId=0),$("#tooltip").remove();var vtimeOut=0;if(extendParam&&extendParam.timeOut&&(vtimeOut=extendParam.timeOut),!(extendParam&&extendParam.showTtpInNeedScroll&&$(this)[0].scrollWidth<=$(this).outerWidth())){var handleElement=$(this),setTimeoutId=setTimeout(function(){$("#tooltip").remove();var tooltipData=handleElement.attr("data-tooltip")?handleElement.attr("data-tooltip"):handleElement.data("tooltip");if("function"===typeof tooltipData&&(tooltipData=tooltipData()),"undefined"!=typeof tooltipData&&"string"!=typeof tooltipData&&(tooltipData=handleElement[0].getAttribute("data-tooltip")),tooltipData&&!handleElement.hasClass("hp-ui-button-active")){if(extendParam&&extendParam.mouseenterCallBack&&extendParam.mouseenterCallBack(),tooltipData&&tooltipData.indexOf("()")&&0==tooltipData.indexOf("'")){var tempTooltipData=tooltipData;try{tooltipData=eval(tooltipData)}catch(e){tooltipData=tempTooltipData}}var tooltip=$("<div id='tooltip'>");if(/\n/.test(tooltipData)){var lines=tooltipData.split(/\n/);lines.forEach(function(e){var t=document.createElement("p");$(t).text(e),tooltip.append(t)})}else tooltip.text(tooltipData);tooltip.prependTo($("body")),tooltip.data("target-dom",e.target);var tooltip_taper_angle_Class="tooltip-before";extendParam&&(extendParam.tooltipArrowClass&&(tooltip_taper_angle_Class=extendParam.tooltipArrowClass),extendParam.tooltipClass&&!tooltip.hasClass(extendParam.tooltipClass)&&tooltip.addClass(extendParam.tooltipClass));var tooltipAngle=$("<div id='"+tooltip_taper_angle_Class+"'>"),tooltip_taper_angle=null;tooltip_taper_angle="tooltip-after"==tooltip_taper_angle_Class?tooltipAngle.appendTo(tooltip):tooltipAngle.prependTo(tooltip),drawViewCallback(tooltip,tooltip_taper_angle,handleElement)}},vtimeOut);vtimeOut>0&&(_setTimeoutId=setTimeoutId)}}function toolTipMouseleave(e){var t=e.data?e.data.extendParam:null;$("#tooltip").remove(),_setTimeoutId&&(clearTimeout(_setTimeoutId),_setTimeoutId=0),t&&t.mouseleaveCallBack&&t.mouseleaveCallBack()}function baseTooltip(e,t,n){if(_userAgent.isMobile||_userAgent.isPad)_userAgent.isPad&&e&&String(e).indexOf("otherusers");else{removeTooltip(e);var o=$(e);o.on("mouseenter",null,{drawViewCallback:t,extendParam:n},toolTipMouseenter),o.on("mouseleave",null,{drawViewCallback:t,extendParam:n},toolTipMouseleave)}}function tooltip(e,t){return baseTooltip(e,function(e,n,o){if(o.siblings(".dropdown-wrapper.open").length>0||o.siblings(".toolbar-border-palette.open").length>0||"toolbar-colorPicker-picker-wrapper"==o.attr("id")||"toolbar-colorPicker-picker-paint-wrapper"==o.attr("id")||("sheet-calculate-button"==o.attr("id")||"sheet-calculate-more"==o.attr("id"))&&$("#sheet-calculate").siblings(".dropdown-wrapper.open").length>0||"web_header_readonly_tip"==o.attr("id")&&!$(".readonly_tip_popup").is(":hidden"))$("#tooltip").remove();else{var i=Number(o.attr("data-tooltip-offsetleft")||0),a=o.offset().top+o.outerHeight()+10+(t.top||0),r=o.offset().left+o.outerWidth()/2-e.outerWidth()/2+i;r=(r=Math.min(document.body.clientWidth-e.outerWidth()-10,r))<=10?10:r;var s=o.offset().left+o.outerWidth()/2-r+i;n.css({left:t.beforeLeft||s}),a+30>window.innerHeight&&n&&"tooltip-after"==n.attr("id")&&(a=o.offset().top-e.outerHeight()-10),e.css({top:a,left:r>0?r:0,zIndex:1e5,maxWidth:t.maxWidth||"300px",paddingLeft:t.paddingLeft||"10px",textAlign:t.textAlign||"center"}).hide().fadeIn(),t.afterShow&&t.afterShow(e)}},t=t||{})}function horizontalTooltip(e,t,n){return t||(t={}),t.tooltipArrowClass||(t.tooltipArrowClass="tooltip-right"),baseTooltip(e,function(e,o,i){n&&n.height&&e.css("height",n.height),e.css("line-height",e.css("height")),t&&t["min-width"]&&e.css("min-width",t["min-width"]-16);var a,r=i.offset().top;"tooltip-right"==$(o).get(0).id?(a=i.offset().left+i.outerWidth(),i.offset().left+i.outerWidth()+e.outerWidth()+20>window.innerWidth&&(a=i.offset().left-e.outerWidth()-19,$(o).get(0).setAttribute("id","tooltip-left"))):a=i.offset().left-e.outerWidth()-9,t&&t.left&&(a+=t.left),r<0&&o.css({top:e.outerHeight()/2+r}),e.css({top:r>0?r:0,left:a>0?a:0,zIndex:1e5}).hide().fadeIn()},t)}function hideTooltip(){$("#tooltip").remove()}function removeTooltip(e){$(e).each(function(){$(this).off("mouseenter",null,toolTipMouseenter),$(this).off("mouseleave",null,toolTipMouseleave)})}function setNewFeatureTips(e,t){var n=(t=t||{}).localStorageKey;if(!n)throw new Error("\u4e00\u5b9a\u8981\u63d0\u4ea4\u4e00\u4e2a\u672c\u5730\u5b58\u50a8\u7684 key");var o=t.tip;if(o){var i=t.times||2,a=t.clickDisappear||!0,r=t.hideOriginToolTip||!0,s=t.duration||1e4,l=t.noTipsAfterUse||!0;if(localStorage){var d=parseInt(localStorage.getItem(n))||0;if(d>i)return;localStorage.setItem(n,parseInt(d)+1)}var c=$("<div></div>").addClass("toolbar-new-feature-tip-new").html(o);e.append(c);var u=e.attr("data-tooltip");e.attr("origin-data-tooltip",u),r&&e.removeAttr("data-tooltip");var p=!1;a&&(e.one("click",h),c.one("click",h)),s&&setTimeout(function(){h()},s)}function h(t){p||(p=!0,c.remove(),e.attr("data-tooltip")||e.attr("data-tooltip",u),e.removeAttr("origin-data-tooltip"),tooltip("#"+e.attr("id")),t&&(t.currentTarget!==e[0]?(t.stopPropagation(),t.preventDefault()):l&&localStorage.setItem(n,parseInt(i)+1)))}}function setToolbarFormFeatureTips(e,t){var n=(t=t||{}).localStorageKey;if(!n)throw new Error("\u4e00\u5b9a\u8981\u63d0\u4ea4\u4e00\u4e2a\u672c\u5730\u5b58\u50a8\u7684 key");var o=t.times||1;if(localStorage){var i=parseInt(localStorage.getItem(n))||0;if(i>=o)return;localStorage.setItem(n,parseInt(i)+1)}var a=$("<div></div>").addClass("toolbar-new-feature-tip-new-big");function r(){a.remove()}if(a.html('<div><div class="close-icon"></div><h4>\u6536\u96c6\u4fe1\u606f\u5f88\u9ebb\u70e6\uff1f</h4><div class="toolbar-new-feature-tips-new-step"><div>\u521b\u5efa\u6536\u96c6\u8868</div><div>\u5206\u4eab\u5230\u7fa4</div><div>\u81ea\u52a8\u6c47\u603b\u5230\u8868\u683c</div></div><div class="bind-form-new-icon"></div><button class="create-bind-form">\u521b\u5efa\u6536\u96c6\u8868</button></div>'),e.after(a),t.duration){var s=t.duration||1e4;setTimeout(function(){r()},s)}$(".create-bind-form").one("click",function(){window.SpreadsheetApp.plugins.rmap.handle("new_to_form"),T_SHEET.Report.tdwReport({opername:"doc_form",module:"excel",action:"clk_guide_create"}),r()});var l=a.find(".close-icon");a.one("click",r),l.one("click",r),T_SHEET.Report.tdwReport({opername:"doc_form",module:"excel",action:"expo_new_guide"})}function changeTooltipText(e){var t=$("#tooltip");/\n/.test(e)?e.split(/\n/).forEach(function(e){var n=document.createElement("p");$(n).text(e),t.append(n)}):t.text(e)}},"./js/utils/user-agent.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getQQVer=y,t.getTIMVer=T,t.MQQLargerOrEqual=function(e){var t=y();return 0!=t&&t>=E(e)},t.MTIMLargerOrEqual=function(e){var t=T();return 0!=t&&t>=E(e)},t.getAppName=function(){var e="unknown";p?e="APP":m?e="MiniProgram":_?e="QQ":b?e="TIM":v?e="WeChat":w&&(e="WeWork");return e},t.getIOSVersion=function(){var e=navigator.userAgent.toLowerCase(),t=null;if(e.indexOf("like mac os x")>0){var n=e.match(/os [\d._]+/gi);t=String(n).replace(/[^0-9|_.]/gi,"").replace(/_/gi,"."),t=parseInt(t.split(".")[0],10)}return t},t.getClientVersion=function(){var e=navigator.userAgent,t=(navigator.appVersion,C(e,/\sTencentDocs\/\d+\.\d+\.\d+\.\d+/i)),n=t?null:C(e,/\sTIM.{0,5}\d+\.\d+\.\d+\.\d+/i),o=null;t||n||(o=window.mqq&&mqq.clientVersion>"0"?mqq.clientVersion:null);return{app_version:t,tim_version:n,qq_version:o,h5:!t&&!n&&!o}},t.genMQQVer=function(){if(s&&-1==i.indexOf("TIM")&&-1==i.indexOf("tim")){var e=new RegExp("QQ/{1}[0-9].{1}[0-9].{1}[0-9]","i"),t=e.exec(i);if(!t||!t[0])return 0;var n=t[0];return E(n.split("/")[1])}return 0},t.checkTencentDocAppVersionSupportFunction=function(e){if(!p)return!1;return navigator.userAgent.match(/TencentDocs\/(\S*)/)[1]>=e},t.checkIsIphoneX=function(){if(x.clientWidth>0)return!0;if(/iphone x/gi.test(window.navigator.userAgent))return!0;var e=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),t=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),n=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return e||t||n};var o=navigator.userAgent.toLowerCase(),i={isIE:"",ie:/rv:([\d.]+)\) like gecko/.test(o)||/msie ([\d.]+)/.test(o),ie9:!1,ie10:!1,chrome:/chrome\/([\d.]+)/.test(o),opera:/opera/.test(o),safari:/webkit/.test(o),mozilla:/mozilla/.test(o)&&!/(compatible|webkit)/.test(o),edge:/edge/.test(o)};if(i.ie){var a=navigator.appVersion.split(";")[1].replace(/[ ]/g,"");i.ie9="MSIE9.0"==a,i.ie10="MSIE10.0"==a}t.userAgent=i;var r=t.isPad=/(ipad)/i.test(o),s=t.isMobile=/(mobile)/i.test(o)&&!r,l=(t.isMac=/Mac OS X/i.test(o)&&!s,t.isAndroid=/android|adr/i.test(o),t.isIOS=/(iphone|ipad|ipod)/.test(o)),d=(t.isWindowStore=/MSAppHost/i.test(o),t.isWindowPlatform=/(win64|wow64|win32|wow32)/i.test(o),t._isIphoneX=function(){return!(!l||!(812==screen.availHeight&&375==screen.availWidth||375==screen.availHeight&&812==screen.availWidth||375==screen.width&&812==screen.height||812==screen.width&&375==screen.height))},t.isPCQQBrowser=!s&&/QQBrowser/i.test(o)&&!/QBCore/i.test(o)),c=t.isMobileQQBrowser=s&&/MQQBrowser/i.test(o)&&!/TBS/i.test(o),u=t.isQQBrowser=s?c:d,p=t.isTencentDocApp=/TencentDocs/i.test(o),h=t.isWxMiniProgram=window.location.href.indexOf("__wxjs_environment=miniprogram")>-1||/MicroMessenger/i.test(o)&&/miniProgram/i.test(o),f=t.isQQMiniProgram=window.location.href.indexOf("__wxjs_environment=qqminiprogram")>-1||/QQ/i.test(o)&&/MiniApp/i.test(o),m=t.isMiniProgram=h||f,g=t.isWxWork=/(wxwork)/i.test(o),w=t.isWeWork=g,v=t.isWeChat=/MicroMessenger/i.test(o)&&!g&&!h,b=(t.isWechat=v,t.isTim=/TIM/i.test(o)),_=t.isQQ=/QQ/i.test(o)&&!p&&!g&&!v&&!u&&!b&&!f;t.isTimOrQQ=b||_,t.isTimOrQQFamily=b||/QQ/i.test(o),t.isPCTim=/QBCore/i.test(o)&&/TIM2.0/i.test(o),t.isPcApp="undefined"!=typeof external&&"undefined"!=typeof external.nativeCall,t.isSafari=-1!==navigator.userAgent.indexOf("Mac")&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome");function y(){if(s&&!b){var e=new RegExp("QQ/{1}[0-9].{1}[0-9].{1}[0-9]","i").exec(i);return e&&e[0]?E(e[0].split("/")[1]):0}return 0}function T(){if(s){var e=new RegExp("TIM[0-9].{1}[0-9]/{1}[0-9].{1}[0-9].{1}[0-9]","i").exec(i);if(!e||!e[0])if(!(e=new RegExp("TIM/[0-9].{1}[0-9].{1}[0-9]","i").exec(i))||!e[0])return 0;return E(e[0].split("/")[1])}return 0}function E(e){var t=e.split("."),n=0;return t.length>=1&&(n=1e4*parseInt(t[0]),t.length>=2&&(n+=100*parseInt(t[1]),t.length>=3&&(n+=parseInt(t[2])))),n}function C(e,t){try{return t.exec(e)[0].split("/")[1]}catch(n){return null}}var x=document.createElement("div");x.className="iphoneXCheckDiv",document.body.appendChild(x)},"./js/utils/util.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.randomStr=function(e){var e="undefined"!=typeof e?e:4,t="";for(var n=0;n<e;n++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t},t.uniqueId=function(){return[clientVars.clientIp,a(Number(new Date),7),a(Math.floor(1e9*Math.random()),4)].join(".")},t.loadScript=function e(t,n,o,i){"undefined"==typeof i&&(i=0);var a=document.createElement("script");a.type="text/javascript";a.onload=function(){n&&n()};a.onerror=function(){i<=2?(e(t,n,o,++i),a&&function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}(a)):o&&o()};a.src=t;document.getElementsByTagName("body")[0].appendChild(a)},t.checkFileSize=function(e,t){var n,o=0;navigator.userAgent.indexOf("MSIE")>0&&(n=!0);if(n){var i=window.ActiveXObject,a=new i("Scripting.FileSystemObject"),e=a.GetFile(e);o=e.Size}else o=e.size;return t?o<t:o},t.extend=function e(){var t,n,a,r,s,l=arguments[0]||{},d=1,c=arguments.length,u=!1;"boolean"===typeof l&&(u=l,l=arguments[1]||{},d=2);"object"===("undefined"===typeof l?"undefined":o(l))||(0,i.isFunction)(l)||(l={});c===d&&(l=this,--d);for(;d<c;d++)if(null!=(t=arguments[d])){var p=!0,h=!1,f=void 0;try{for(var m,g=Object.keys(t)[Symbol.iterator]();!(p=(m=g.next()).done);p=!0){var w=m.value;n=l[w],a=t[w],l!==a&&(u&&a&&((0,i.isObject)(a)||(r=(0,i.isArray)(a)))?(r?(r=!1,s=n&&(0,i.isArray)(n)?n:[]):s=n&&(0,i.isObject)(n)?n:{},l[w]=e(u,s,a)):void 0!==a&&(l[w]=a))}}catch(v){h=!0,f=v}finally{try{!p&&g.return&&g.return()}finally{if(h)throw f}}}return l},t.filter=function(e,t,n){var o,i=[];n=!!n;for(var a=0,r=e.length;a<r;a++)o=!!t(e[a],a),n!==o&&i.push(e[a]);return i},t.throttle=function(e,t,n){var o,i,a,r=null,s=0;n||(n={});var l=function(){s=!1===n.leading?0:new Date,r=null,a=e.apply(o,i)};return function(){var d=new Date;s||!1!==n.leading||(s=d);var c=t-(d-s);return o=this,i=arguments,c<=0?(clearTimeout(r),r=null,s=d,a=e.apply(o,i)):r||!1===n.trailing||(r=setTimeout(l,c)),a}},t.debounce=function(e,t){var n=null;return function(){var o=this,i=arguments;n&&(clearTimeout(n),n=null),n=setTimeout(function(){e.apply(o,i)},t)}};var i=n("./js/utils/type.js");function a(e,t){return(Array(t+1).join("0")+Number(e).toString(35)).slice(-t)}},"./js/utils/wx.js":function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkIfLoadWxJsSdk=function(e){if(!o.isWeChat)return;if(e=e||function(){},window.wx)e();else{var t=document.createElement("script");t.src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js",t.onload=e,document.head.appendChild(t)}},t.setWxShareInfo=function e(t){var n=t.title;var o=t.desc;var i=t.share_url;var a=t.image_url;window.wx.onMenuShareAppMessage({title:n,desc:o,link:i,imgUrl:a,type:"",dataUrl:"",success:function(){T_SHEET.Report.tdwReport({opername:"doc_share",module:"wecha_h5",action:"wechat_suc"})},cancel:function(){},trigger:function(){T_SHEET.Report.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_wechat"})}});wx.onMenuShareTimeline({title:n,link:i,imgUrl:a,success:function(){T_SHEET.Report.tdwReport({opername:"doc_share",module:"wecha_h5",action:"moment_suc"})},cancel:function(){},trigger:function(){T_SHEET.Report.tdwReport({opername:"doc_share",module:"wecha_h5",action:"share_moment"})}});wx.onMenuShareQQ({title:n,desc:o,link:i,imgUrl:a,success:function(){},cancel:function(){}});setTimeout(function(){e(t)},1e3)},t.initForMiniProgram=function(){!function(e){if(e=e||function(){},o.isMiniProgram){var t=document.createElement("script");t.src=o.isQQMiniProgram?"https://qzonestyle.gtimg.cn/qzone/qzact/act/external/qqjssdk/qqjssdk-1.0.0.js":"https://res.wx.qq.com/open/js/jweixin-1.3.2.js",t.onload=e,document.head.appendChild(t)}}(function(){var e=window.clientVars.padTitle,t=window.clientVars.padType,n={doc:0,sheet:1},o=function(){wx.miniProgram.postMessage({data:{title:e,type:n[t]}})};window.WeixinJSBridge&&WeixinJSBridge.invoke?o():document.addEventListener("WeixinJSBridgeReady",o,!1)})};var o=n("./js/utils/user-agent.js")},react:function(e,t){e.exports=window.React},"react-dom":function(e,t){e.exports=window.ReactDOM}})};window.$&&window.React?entryInit():window.coreSheetEntryInit=function(){hasInit||(hasInit=!0,entryInit())}}();
//# sourceMappingURL=core-sheet-pc-fa6e5936f3.js.map