(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_excel_plugin_pc"],{1673:function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(46)),r=n(171);t.MenuItemContext=o.createContext({itemStyle:void 0,clickHandler:r.emptyFn,selectedIds:[]}),t.SubMenuContext=o.createContext({zIndex:1e4,visible:!0,type:"normal"})},1677:function(e,t,n){"use strict";function i(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.r(t);var o=n(46),r=n(141),a=n.n(r),s=a.a.shape({trySubscribe:a.a.func.isRequired,tryUnsubscribe:a.a.func.isRequired,notifyNestedSubs:a.a.func.isRequired,isSubscribed:a.a.func.isRequired}),l=a.a.shape({subscribe:a.a.func.isRequired,dispatch:a.a.func.isRequired,getState:a.a.func.isRequired});function c(e){var t;void 0===e&&(e="store");var n=e+"Subscription",r=function(t){i(a,t);var r=a.prototype;function a(n,i){var o;return(o=t.call(this,n,i)||this)[e]=n.store,o}return r.getChildContext=function(){var t;return(t={})[e]=this[e],t[n]=null,t},r.render=function(){return o.Children.only(this.props.children)},a}(o.Component);return r.propTypes={store:l.isRequired,children:a.a.element.isRequired},r.childContextTypes=((t={})[e]=l.isRequired,t[n]=s,t),r}var u=c();function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e}).apply(this,arguments)}function h(e,t){if(null==e)return{};var n,i,o={},r=Object.keys(e);for(i=0;i<r.length;i++)n=r[i],t.indexOf(n)>=0||(o[n]=e[n]);return o}var f=n(1704),g=n.n(f),m=n(1706),v=n.n(m),b=n(1687),w=null,A={notify:function(){}};var y=function(){function e(e,t,n){this.store=e,this.parentSub=t,this.onStateChange=n,this.unsubscribe=null,this.listeners=A}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=function(){var e=[],t=[];return{clear:function(){t=w,e=w},notify:function(){for(var n=e=t,i=0;i<n.length;i++)n[i]()},get:function(){return t},subscribe:function(n){var i=!0;return t===e&&(t=e.slice()),t.push(n),function(){i&&e!==w&&(i=!1,t===e&&(t=e.slice()),t.splice(t.indexOf(n),1))}}}}())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=A)},e}(),x=0,C={};function I(){}function k(e,t){var n,r;void 0===t&&(t={});var a=t,c=a.getDisplayName,u=void 0===c?function(e){return"ConnectAdvanced("+e+")"}:c,f=a.methodName,m=void 0===f?"connectAdvanced":f,w=a.renderCountProp,A=void 0===w?void 0:w,k=a.shouldHandleStateChanges,_=void 0===k||k,E=a.storeKey,D=void 0===E?"store":E,M=a.withRef,S=void 0!==M&&M,P=h(a,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),T=D+"Subscription",O=x++,R=((n={})[D]=l,n[T]=s,n),L=((r={})[T]=s,r);return function(t){v()(Object(b.isValidElementType)(t),"You must pass a component to the function returned by "+m+". Instead received "+JSON.stringify(t));var n=t.displayName||t.name||"Component",r=u(n),a=p({},P,{getDisplayName:u,methodName:m,renderCountProp:A,shouldHandleStateChanges:_,storeKey:D,withRef:S,displayName:r,wrappedComponentName:n,WrappedComponent:t}),s=function(n){function s(e,t){var i;return(i=n.call(this,e,t)||this).version=O,i.state={},i.renderCount=0,i.store=e[D]||t[D],i.propsMode=Boolean(e[D]),i.setWrappedInstance=i.setWrappedInstance.bind(d(d(i))),v()(i.store,'Could not find "'+D+'" in either the context or props of "'+r+'". Either wrap the root component in a <Provider>, or explicitly pass "'+D+'" as a prop to "'+r+'".'),i.initSelector(),i.initSubscription(),i}i(s,n);var l=s.prototype;return l.getChildContext=function(){var e,t=this.propsMode?null:this.subscription;return(e={})[T]=t||this.context[T],e},l.componentDidMount=function(){_&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},l.componentWillReceiveProps=function(e){this.selector.run(e)},l.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},l.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=I,this.store=null,this.selector.run=I,this.selector.shouldComponentUpdate=!1},l.getWrappedInstance=function(){return v()(S,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+m+"() call."),this.wrappedInstance},l.setWrappedInstance=function(e){this.wrappedInstance=e},l.initSelector=function(){var t=e(this.store.dispatch,a);this.selector=function(e,t){var n={run:function(i){try{var o=e(t.getState(),i);(o!==n.props||n.error)&&(n.shouldComponentUpdate=!0,n.props=o,n.error=null)}catch(r){n.shouldComponentUpdate=!0,n.error=r}}};return n}(t,this.store),this.selector.run(this.props)},l.initSubscription=function(){if(_){var e=(this.propsMode?this.props:this.context)[T];this.subscription=new y(this.store,e,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},l.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(C)):this.notifyNestedSubs()},l.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},l.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},l.addExtraProps=function(e){if(!S&&!A&&(!this.propsMode||!this.subscription))return e;var t=p({},e);return S&&(t.ref=this.setWrappedInstance),A&&(t[A]=this.renderCount++),this.propsMode&&this.subscription&&(t[T]=this.subscription),t},l.render=function(){var e=this.selector;if(e.shouldComponentUpdate=!1,e.error)throw e.error;return Object(o.createElement)(t,this.addExtraProps(e.props))},s}(o.Component);return s.WrappedComponent=t,s.displayName=r,s.childContextTypes=L,s.contextTypes=R,s.propTypes=R,g()(s,t)}}var _=Object.prototype.hasOwnProperty;function E(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function D(e,t){if(E(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),i=Object.keys(t);if(n.length!==i.length)return!1;for(var o=0;o<n.length;o++)if(!_.call(t,n[o])||!E(e[n[o]],t[n[o]]))return!1;return!0}var M=n(1680);function S(e){return function(t,n){var i=e(t,n);function o(){return i}return o.dependsOnOwnProps=!1,o}}function P(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function T(e,t){return function(t,n){n.displayName;var i=function(e,t){return i.dependsOnOwnProps?i.mapToProps(e,t):i.mapToProps(e)};return i.dependsOnOwnProps=!0,i.mapToProps=function(t,n){i.mapToProps=e,i.dependsOnOwnProps=P(e);var o=i(t,n);return"function"===typeof o&&(i.mapToProps=o,i.dependsOnOwnProps=P(o),o=i(t,n)),o},i}}var O=[function(e){return"function"===typeof e?T(e):void 0},function(e){return e?void 0:S(function(e){return{dispatch:e}})},function(e){return e&&"object"===typeof e?S(function(t){return Object(M.bindActionCreators)(e,t)}):void 0}];var R=[function(e){return"function"===typeof e?T(e):void 0},function(e){return e?void 0:S(function(){return{}})}];function L(e,t,n){return p({},n,e,t)}var N=[function(e){return"function"===typeof e?function(e){return function(t,n){n.displayName;var i,o=n.pure,r=n.areMergedPropsEqual,a=!1;return function(t,n,s){var l=e(t,n,s);return a?o&&r(l,i)||(i=l):(a=!0,i=l),i}}}(e):void 0},function(e){return e?void 0:function(){return L}}];function B(e,t,n,i){return function(o,r){return n(e(o,r),t(i,r),r)}}function H(e,t,n,i,o){var r,a,s,l,c,u=o.areStatesEqual,d=o.areOwnPropsEqual,p=o.areStatePropsEqual,h=!1;function f(o,h){var f=!d(h,a),g=!u(o,r);return r=o,a=h,f&&g?(s=e(r,a),t.dependsOnOwnProps&&(l=t(i,a)),c=n(s,l,a)):f?(e.dependsOnOwnProps&&(s=e(r,a)),t.dependsOnOwnProps&&(l=t(i,a)),c=n(s,l,a)):g?function(){var t=e(r,a),i=!p(t,s);return s=t,i&&(c=n(s,l,a)),c}():c}return function(o,u){return h?f(o,u):(s=e(r=o,a=u),l=t(i,a),c=n(s,l,a),h=!0,c)}}function G(e,t){var n=t.initMapStateToProps,i=t.initMapDispatchToProps,o=t.initMergeProps,r=h(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),a=n(e,r),s=i(e,r),l=o(e,r);return(r.pure?H:B)(a,s,l,e,r)}function Y(e,t,n){for(var i=t.length-1;i>=0;i--){var o=t[i](e);if(o)return o}return function(t,i){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+i.wrappedComponentName+".")}}function j(e,t){return e===t}var F=function(e){var t=void 0===e?{}:e,n=t.connectHOC,i=void 0===n?k:n,o=t.mapStateToPropsFactories,r=void 0===o?R:o,a=t.mapDispatchToPropsFactories,s=void 0===a?O:a,l=t.mergePropsFactories,c=void 0===l?N:l,u=t.selectorFactory,d=void 0===u?G:u;return function(e,t,n,o){void 0===o&&(o={});var a=o,l=a.pure,u=void 0===l||l,f=a.areStatesEqual,g=void 0===f?j:f,m=a.areOwnPropsEqual,v=void 0===m?D:m,b=a.areStatePropsEqual,w=void 0===b?D:b,A=a.areMergedPropsEqual,y=void 0===A?D:A,x=h(a,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),C=Y(e,r,"mapStateToProps"),I=Y(t,s,"mapDispatchToProps"),k=Y(n,c,"mergeProps");return i(d,p({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:C,initMapDispatchToProps:I,initMergeProps:k,pure:u,areStatesEqual:g,areOwnPropsEqual:v,areStatePropsEqual:w,areMergedPropsEqual:y},x))}}();n.d(t,"Provider",function(){return u}),n.d(t,"createProvider",function(){return c}),n.d(t,"connectAdvanced",function(){return k}),n.d(t,"connect",function(){return F})},1678:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(46)),s=o(n(141)),l=r(n(142)),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){t.props.disabled||(e.nativeEvent._dui_dropdown_keep=!0)},t}return i(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,i=e.style,o=e.children,r=l.default(t,n);return a.createElement("div",{className:r,style:i,onClick:this.handleClick},o)},t}(a.Component);t.default=c,c.defaultProps={prefixCls:"dui-dropdown-keep",disabled:!1},c.propTypes={prefixCls:s.string,style:s.object,className:s.string,disabled:s.bool}},1680:function(e,t,n){"use strict";n.r(t),n.d(t,"createStore",function(){return s}),n.d(t,"combineReducers",function(){return c}),n.d(t,"bindActionCreators",function(){return d}),n.d(t,"applyMiddleware",function(){return f}),n.d(t,"compose",function(){return h}),n.d(t,"__DO_NOT_USE__ActionTypes",function(){return r});var i=n(1707),o=function(){return Math.random().toString(36).substring(7).split("").join(".")},r={INIT:"@@redux/INIT"+o(),REPLACE:"@@redux/REPLACE"+o(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+o()}};function a(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function s(e,t,n){var o;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(s)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var l=e,c=t,u=[],d=u,p=!1;function h(){d===u&&(d=u.slice())}function f(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return c}function g(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return h(),d.push(e),function(){if(t){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,h();var n=d.indexOf(e);d.splice(n,1)}}}function m(e){if(!a(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,c=l(c,e)}finally{p=!1}for(var t=u=d,n=0;n<t.length;n++){(0,t[n])()}return e}return m({type:r.INIT}),(o={dispatch:m,subscribe:g,getState:f,replaceReducer:function(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");l=e,m({type:r.REPLACE})}})[i.a]=function(){var e,t=g;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(f())}return n(),{unsubscribe:t(n)}}})[i.a]=function(){return this},e},o}function l(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function c(e){for(var t=Object.keys(e),n={},i=0;i<t.length;i++){var o=t[i];0,"function"===typeof e[o]&&(n[o]=e[o])}var a,s=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:r.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof n(void 0,{type:r.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+r.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(c){a=c}return function(e,t){if(void 0===e&&(e={}),a)throw a;for(var i=!1,o={},r=0;r<s.length;r++){var c=s[r],u=n[c],d=e[c],p=u(d,t);if("undefined"===typeof p){var h=l(c,t);throw new Error(h)}o[c]=p,i=i||p!==d}return i?o:e}}function u(e,t){return function(){return t(e.apply(this,arguments))}}function d(e,t){if("function"===typeof e)return u(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),i={},o=0;o<n.length;o++){var r=n[o],a=e[r];"function"===typeof a&&(i[r]=u(a,t))}return i}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),i=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},o={getState:n.getState,dispatch:function(){return i.apply(void 0,arguments)}},r=t.map(function(e){return e(o)});return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){p(e,t,n[t])})}return e}({},n,{dispatch:i=h.apply(void 0,r)(n.dispatch)})}}}},1681:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isMyComment=function(e){var t=o();return e===t},t.isPadCreator=function(){var e=window.clientVars.creatorId,t=o(),n=r();return e===t||e===n},t.isPadOwner=function(){var e=window.clientVars.ownerId,t=o(),n=r();return e===t||e===n},t.isSelectSingleCell=a,t.getCommentsListLen=function(e){if(!e||0===e.length)return 0;return e.filter(function(e){return!!e}).length},t.checkPanelShow=function(){var e=window.SpreadsheetApp,t=e.view.canvas.excel;if(3===t.tableData.tableStatus||e.view.canvas.filterPanelShowing||!a()||t.tableMenu&&t.tableMenu.isShow())return!1;return!0};t.getDocid=function(){return encodeURIComponent(window.clientVars.globalPadId)},t.getSid=function(){return window.clientVars.collab_client_vars.client.sid},t.getNow=function(){return+new Date},t.formatTime=function(e){var t=new Date(1e3*e),n=[t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes()].map(function(e){return e<10?"0"+e:e.toString()});return n[0]+"-"+n[1]+" "+n[2]+":"+n[3]},t.formatNickName=function(e){return e.length>7?e.slice(0,7)+"...":e},t.getUserName=function(){return window.clientVars.userName},t.getUserPic=function(){return window.clientVars.userPic};var i=t.getUserUid=function(){return window.clientVars.uin};function o(){return window.clientVars.userInfo.tinyid}function r(){return window.clientVars.userInfo.uid}t.isCreator=function(e){if(!e||0===e.length)return!1;for(var t=void 0,n=0;n<e.length;n++)e[n]&&(t=e[n]);return!!t&&i()===t.uin};function a(){var e=window.SpreadsheetApp,t=e.view.canvas.excel.selectData.select,n=e.spreadsheet.activeSheet,i=void 0,o=void 0;if(null===n)return!1;var r=!0;if(t.xRange[0]===t.xRange[1]&&t.yRange[0]===t.yRange[1]||(r=!1),!r&&(i=n.getMerges())&&i.length>0)for(o=0;o<i.length;o++)if(i[o].startColIndex===t.xRange[0]&&i[o].endColIndex===t.xRange[1]&&i[o].startRowIndex===t.yRange[0]&&i[o].endRowIndex===t.yRange[1]){r=!0;break}return r}},1684:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(46)),s=o(n(141)),l=r(n(142)),c=n(171),u=n(1690),d=n(1673),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=a.createRef(),t.clickedIds=[],t.handleClick=function(e){if(0!==t.clickedIds.length){var n=t.clickedIds.shift();t.clickedIds=[],t.props.onClick(n,e)}},t.handleItemClick=function(e){t.clickedIds.push(e)},t}return i(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){var e,t=this,n=this.props,i=n.prefixCls,o=n.className,r=n.style,s=n.children,c=n.itemStyle,p=n.selectedIds,h=n.visible,f=n.type,g=l.default(i,i+"-"+f,o,((e={})[i+"-hidden"]=!h,e));return a.createElement(u.DropdownContext.Consumer,null,function(e){var n=e.visible;return a.createElement(d.MenuItemContext.Provider,{value:{itemStyle:c,clickHandler:t.handleItemClick,selectedIds:p}},a.createElement(d.SubMenuContext.Provider,{value:{zIndex:1e4,visible:n&&h,type:f}},a.createElement("ul",{className:g,style:r,onClick:t.handleClick},s)))})},t}(a.Component);t.default=p,p.defaultProps={prefixCls:"dui-menu",onClick:c.emptyFn,selectedIds:[],visible:!0,type:"normal"},p.propTypes={prefixCls:s.string,style:s.object,className:s.string,onClick:s.func,itemStyle:s.object,selectedIds:s.arrayOf(s.string),visible:s.bool,type:s.oneOf(["normal","compact"])}},1685:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),l=r(n(141)),c=a(n(142)),u=n(171),d=n(1673),p=a(n(1678)),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.domRef=s.createRef(),t.handleClick=function(e){var n=t.context.clickHandler,i=t.props,o=i.disabled,r=i.onClick;if(!o){r(e);var a=e.nativeEvent;a._dui_submenu_click?delete a._dui_submenu_click:n(t.props.id)}},t}return i(t,e),t.prototype.isSelected=function(){return-1!==this.context.selectedIds.indexOf(this.props.id)},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,i=t.className,r=t.style,a=t.children,l=t.onMouseEnter,u=t.onMouseLeave,d=t.disabled,h=t.description,f=this.context.itemStyle,g=c.default(n,i,((e={})[n+"-disabled"]=d,e[n+"-selected"]=this.isSelected(),e));return s.createElement(p.default,{disabled:!d},s.createElement("li",{className:g,style:o({},f,r),onClick:this.handleClick,ref:this.domRef,onMouseEnter:l,onMouseLeave:u},a,h?s.createElement("span",{className:n+"-description"},h):null))},t.contextType=d.MenuItemContext,t}(s.Component);t.default=h,h.defaultProps={prefixCls:"dui-menu-item",id:"",onMouseEnter:u.emptyFn,onMouseLeave:u.emptyFn,onClick:u.emptyFn,disabled:!1},h.propTypes={prefixCls:l.string,style:l.object,className:l.string,id:l.string,onMouseEnter:l.func,onMouseLeave:l.func,onClick:l.func,disabled:l.bool,description:l.string}},1686:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(46)),s=o(n(141)),l=n(171),c=r(n(142)),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.trigger=function(e){if(!t.props.disabled){if(e._dui_trigger_instances){var n=e._dui_trigger_instances.indexOf(t);if(-1!==n)return e._dui_trigger_instances.splice(n,1),void(0===e._dui_trigger_instances.length&&delete e._dui_trigger_instances)}t.props.action()}},t.cancel=function(e){if(!t.props.disabled){var n=e.nativeEvent;n._dui_trigger_instances?n._dui_trigger_instances.push(t):n._dui_trigger_instances=[t]}},t}return i(t,e),t.prototype.componentDidMount=function(){document.addEventListener("click",this.trigger),this.props.disableContextMenu||document.addEventListener("contextmenu",this.trigger)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.trigger),this.props.disableContextMenu||document.removeEventListener("contextmenu",this.trigger)},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,i=e.style,o=e.children,r=e.domRef,s=e.disableContextMenu,l=c.default(t,n);return a.createElement("div",{className:l,style:i,onClick:this.cancel,onContextMenu:s?void 0:this.cancel,ref:r},o)},t}(a.Component);t.default=u,u.defaultProps={prefixCls:"dui-trigger",action:l.emptyFn,disabled:!1,disableContextMenu:!1},u.propTypes={className:s.string,prefixCls:s.string,style:s.object,action:s.func,disabled:s.bool,domRef:s.object,disableContextMenu:s.bool}},1687:function(e,t,n){"use strict";e.exports=n(1705)},1689:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(1684));t.Menu=o.default;var r=i(n(1685)),a=i(n(1700));n(197).injectStyle(".dui-menu,.dui-menu-submenu-content{-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16);list-style:none;background:#fff;padding:8px 0;margin:0;border:1px solid rgba(0,0,0,.12);border-radius:3px;-webkit-tap-highlight-color:transparent;overflow-y:auto;overflow-x:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.dui-menu-hidden{visibility:hidden}.dui-menu-item{position:relative;-webkit-box-sizing:content-box;box-sizing:content-box;white-space:nowrap;-webkit-transition:background-color .2s linear;transition:background-color .2s linear;padding:9px 12px 9px 28px;font-size:14px;height:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,.8);cursor:pointer}.dui-menu-item-disabled{opacity:.3}.dui-menu-item-description{color:rgba(0,0,0,.4)}.dui-menu-item-disabled .dui-menu-item-description{color:rgba(0,0,0,.8)}.dui-menu-item-selected::before{content:'';position:absolute;display:inline-block;width:16px;height:16px;left:6px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);background-repeat:no-repeat;background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%3E%3Cpath%20fill%3D%22%23000%22%20d%3D%22M5.368%2011.575L2.75%209.04l.753-1%202.73%201.88%206.914-6.526.852.854-7.808%208.186-.824-.86z%22%20opacity%3D%22.638%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E);background-size:contain;background-position:center}:not(.dui-menu-item-disabled).dui-menu-item:hover{background-color:rgba(0,0,0,.04)}:not(.dui-menu-item-disabled).dui-menu-item:active{background-color:rgba(0,0,0,.08)}.dui-menu-submenu::after{content:'';background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%224%22%20height%3D%226%22%3E%3Cpath%20d%3D%22M3.936%203.123L.374%205.95a.261.261%200%200%201-.31%200A.158.158%200%200%201%200%205.826V.174C0%20.078.098%200%20.22%200a.25.25%200%200%201%20.154.05l3.562%202.827a.15.15%200%200%201%200%20.246z%22%20opacity%3D%22.4%22%2F%3E%3C%2Fsvg%3E);display:inline-block;width:4px;height:6px;background-position:center;background-size:contain;margin-left:24px}.dui-menu-submenu:active{background-color:rgba(0,0,0,.04)}.dui-menu-submenu-wrapper{padding:0;background:0 0;position:absolute;-webkit-transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,transform;transition-property:visibility,opacity,transform,-webkit-transform;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}.dui-menu-submenu-wrapper-visible{visibility:visible;-webkit-transition-duration:.16s;transition-duration:.16s;opacity:1;-webkit-transform:scale3d(1,1,1) translate(0);transform:scale3d(1,1,1) translate(0)}.dui-menu-submenu-wrapper-hidden-bottom,.dui-menu-submenu-wrapper-hidden-top{visibility:hidden;-webkit-transition-duration:.12s;transition-duration:.12s}.dui-menu-submenu-wrapper-hidden-bottom{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(-5px);transform:scale3d(1,1,1) translateY(-5px)}.dui-menu-submenu-wrapper-hidden-top{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(5px);transform:scale3d(1,1,1) translateY(5px)}.dui-menu-contextmenu-popup{position:absolute;z-index:9999;overflow-y:auto;overflow-x:hidden;-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16)}.dui-menu-contextmenu-popup-hidden{visibility:hidden}.dui-menu-contextmenu-popup-left-top{-webkit-transform:translate(-100%,-100%);transform:translate(-100%,-100%)}.dui-menu-contextmenu-popup-left-bottom{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.dui-menu-contextmenu-popup-right-top{-webkit-transform:translateY(-100%);transform:translateY(-100%)}.dui-menu-compact,.dui-menu-submenu-content-compact{padding:6px 0;border:1px solid rgba(0,0,0,.12);-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16)}.dui-menu-compact .dui-menu-item,.dui-menu-submenu-content-compact .dui-menu-item{font-size:12px;height:12px;padding:8px 12px 8px 28px}");var s=i(n(1701));o.default.Item=r.default,o.default.SubMenu=a.default,o.default.ContextMenu=s.default,t.default=o.default},1690:function(e,t,n){"use strict";var i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(46));t.DropdownContext=o.createContext({visible:!0,zIndex:9999})},1691:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.LINK_TYPE=void 0;!function(e){e[e.modifyBox=1]="modifyBox",e[e.hoverBox=2]="hoverBox"}(i||(t.LINK_TYPE=i={}));var o=t.PANEL_TYPE=void 0;!function(e){e[e.preview=1]="preview",e[e.focus=2]="focus"}(o||(t.PANEL_TYPE=o={}));var r=t.EDITABLE_ID=void 0;!function(e){e.none="none",e.top="top"}(r||(t.EDITABLE_ID=r={}));var a=t.TEXT_AREA_TYPE=void 0;!function(e){e.add="add",e.edit="edit"}(a||(t.TEXT_AREA_TYPE=a={}))},1698:function(e,t,n){"use strict";var i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(1699));t.Checkbox=o.default;var r=i(n(1721));n(197).injectStyle(".dui-checkbox{position:relative;padding-left:20px;font-size:14px;line-height:20px;-webkit-tap-highlight-color:transparent}.dui-checkbox-multi-line{padding-left:24px}.dui-checkbox-icon{position:absolute;z-index:1;left:0;top:2px;width:16px;height:16px;border:1px solid rgba(0,0,0,.16);-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background:#fff}.dui-checkbox-icon-square{border-radius:2px}.dui-checkbox-icon-circle{border-radius:50%}.dui-checkbox-input:hover+.dui-checkbox-icon{border-color:#0188fb}.dui-checkbox-normal.dui-checkbox-checked .dui-checkbox-icon{background-color:#0188fb}.dui-checkbox-hollow.dui-checkbox-checked .dui-checkbox-icon{background-color:#fff}.dui-checkbox-checked .dui-checkbox-icon,.dui-checkbox-checked:hover .dui-checkbox-icon{border-color:#0188fb}.dui-checkbox-checked .dui-checkbox-icon::after{content:'';display:block;left:0;top:0;width:100%;height:100%;background-position:center;background-repeat:no-repeat}.dui-checkbox-normal.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-hollow.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%230188fb%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-disabled .dui-checkbox-label{opacity:.36}.dui-checkbox-disabled .dui-checkbox-icon,.dui-checkbox-disabled:hover .dui-checkbox-icon{border-color:rgba(0,0,0,.08)}.dui-checkbox-normal.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon{background:rgba(0,0,0,.08);border-color:transparent}.dui-checkbox-normal.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-hollow.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon{background:#fff}.dui-checkbox-hollow.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20opacity%3D%22.08%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox:not(.dui-checkbox-disabled) .dui-checkbox-input{cursor:pointer}.dui-checkbox-input{position:absolute;z-index:2;margin:0;opacity:0;left:0;top:0;height:100%;width:16px}.dui-checkbox-input-full{width:100%}"),o.default.Group=r.default,t.default=o.default},1699:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__rest||function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var o=0;for(i=Object.getOwnPropertySymbols(e);o<i.length;o++)t.indexOf(i[o])<0&&Object.prototype.propertyIsEnumerable.call(e,i[o])&&(n[i[o]]=e[i[o]])}return n},a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=a(n(46)),c=a(n(141)),u=s(n(142)),d=n(171),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={checked:!!t.props.defaultChecked},t.handleChange=function(e){var n=t.props;n.disabled||("checked"in n||t.setState({checked:e.target.checked}),n.onChange(e.target.checked,{target:o({},n,{checked:e.target.checked}),stopPropagation:e.stopPropagation.bind(e),preventDefault:e.preventDefault.bind(e),nativeEvent:e.nativeEvent}))},t}return i(t,e),t.prototype.render=function(){var e,t,n=this.props,i=n.prefixCls,a=n.className,s=n.style,c=n.children,d=n.disabled,p=n.hollow,h=n.labelClickable,f=n.shape,g=r(n,["prefixCls","className","style","children","disabled","hollow","labelClickable","shape"]),m="checked"in this.props?this.props.checked:this.state.checked,v=u.default(i,a,i+"-"+(p?"hollow":"normal"),((e={})[i+"-multi-line"]=l.Children.count(c)>1,e[i+"-checked"]=m,e[i+"-disabled"]=d,e)),b=u.default(i+"-input",((t={})[i+"-input-full"]=h,t)),w=u.default(i+"-icon",i+"-icon-"+f);return l.createElement("div",{className:v,style:s},l.createElement("input",o({},g,{type:"checkbox",className:b,onChange:this.handleChange})),l.createElement("span",{className:w}),l.createElement("div",{className:i+"-label"},c))},t}(l.Component);t.default=p,p.defaultProps={prefixCls:"dui-checkbox",onChange:d.emptyFn,disabled:!1,hollow:!1,labelClickable:!0,shape:"square"},p.propTypes={prefixCls:c.string,style:c.object,className:c.string,onChange:c.func,hollow:c.bool,labelClickable:c.bool,shape:c.oneOf(["circle","square"])}},1700:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),l=a(n(123)),c=r(n(141)),u=a(n(142)),d=a(n(1685)),p=n(1673),h=a(n(1678)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._hidePrevented=!1,t._restoringHeight=!1,t.itemRef=s.createRef(),t.popupWrapperRef=s.createRef(),t.popupContentRef=s.createRef(),t.state={visible:!1},t.handleMouseEnter=function(){t.props.disabled||t.setState({visible:!0})},t.handleMouseLeave=function(){t.props.disabled||t._hidePrevented||t.setState({visible:!1})},t.preventHide=function(){t._hidePrevented=!0,setTimeout(function(){t._hidePrevented=!1},10)},t.handleSubmenuClick=function(e){e.nativeEvent._dui_submenu_click=!0},t}return i(t,e),t.prototype.getPopoutMetrics=function(){var e={placement:"bottom",location:{left:"0px",top:"0px"},forcedHeight:0},t=this.itemRef.current;if(!t)return e;var n=t.domRef.current;if(!n)return e;var i=this.popupWrapperRef.current;if(!i)return e;var o=window.innerWidth,r=window.innerHeight,a=n.getBoundingClientRect(),s=a.right,l=a.left,c=a.top,u=a.bottom,d=i.getBoundingClientRect(),p=d.width,h=d.height,f=s+p<o?"right":"left",g=r-c-2,m=u-2,v="bottom",b=0;return h>=g?h>=m?g>=m?(v="bottom",b=g):(v="top",b=m):v="top":v="bottom",e={placement:v,location:{left:window.pageXOffset+("right"===f?s+-2:l-p- -2)+"px",top:window.pageYOffset+("bottom"===v?c:u-(b||h))+"px"},forcedHeight:b}},t.prototype.isVisible=function(){var e=this.state.visible,t=this.context.visible,n=this.props.disabled;return t&&e&&!n},t.prototype.componentDidUpdate=function(e,t){var n=this;t.visible&&!this.state.visible&&setTimeout(function(){n._restoringHeight=!0,n.forceUpdate(function(){n._restoringHeight=!1})},120)},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,i=t.className,r=t.style,a=t.children,c=t.id,f=t.title,g=t.disabled,m=t.popupStyle,v=this.context,b=v.zIndex,w=v.type,A=this.isVisible(),y=u.default(n,i,((e={})[n+"-disabled"]=g,e)),x=this.getPopoutMetrics(),C=x.location,I=x.placement,k=x.forcedHeight,_=u.default(n+"-wrapper",n+"-wrapper-"+(A?"visible":"hidden-"+I)),E=u.default(n+"-content",n+"-content-"+w);return s.createElement(p.SubMenuContext.Provider,{value:{zIndex:b+1,visible:A,type:w}},s.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.preventHide},s.createElement(h.default,null,s.createElement(d.default,{id:c,className:y,style:r,ref:this.itemRef,disabled:g,onClick:this.handleSubmenuClick},f||c)),l.default.createPortal(s.createElement("div",{className:_,ref:this.popupWrapperRef,style:o({},C,{zIndex:b})},s.createElement("ul",{className:E,style:o({height:k&&!this._restoringHeight?k+"px":void 0},m),ref:this.popupContentRef},a)),document.body)))},t.contextType=p.SubMenuContext,t}(s.Component);t.default=f,f.defaultProps={prefixCls:"dui-menu-submenu",id:"",disabled:!1},f.propTypes={prefixCls:c.string,style:c.object,className:c.string,id:c.string,title:c.node,disabled:c.bool,popupStyle:c.object}},1701:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__assign||function(){return(o=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),l=a(n(123)),c=r(n(141)),u=a(n(142)),d=a(n(1684)),p=a(n(1686)),h=n(171),f=s.createElement(d.default,null).type,g={horizontal:"right",vertical:"bottom",height:0},m=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popupRef=s.createRef(),t.anchorRef=s.createRef(),t.state={visible:!1,menu:null,location:{left:0,top:0},metrics:o({},g)},t.handleContextMenu=function(e){e.preventDefault();var n=t.props,i=n.menu,r=n.disabled,a=n.onVisibleChange;r||t.setState({menu:"function"===typeof i?i(e):i,visible:!1,location:{left:e.pageX,top:e.pageY},metrics:o({},t.state.metrics,{height:0})},function(){t.updatePopoutMetrics(),t.setState({visible:!0},function(){a(!0)})})},t.hide=function(){t.isVisible()&&t.setState({visible:!1},function(){t.props.onVisibleChange(!1)})},t}return i(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},t.prototype.componentDidMount=function(){document.addEventListener("scroll",this.hide,{passive:!0})},t.prototype.componentWillUnmount=function(){document.removeEventListener("scroll",this.hide)},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.visible;return"boolean"===typeof t?t:n},t.prototype.updatePopoutMetrics=function(){var e=this.props,t=e.popupBoundary,n=e.popupMargin,i=this.anchorRef.current,o=this.popupRef.current;if(o&&i){var r=this.state.location,a=r.left,s=r.top,l=a-window.pageXOffset,c=s-window.pageYOffset,u=0,d=window.innerWidth,p=0,h=window.innerHeight,f=i.getBoundingClientRect(),g=f.left,m=f.right,v=f.top,b=f.bottom;"container"===t&&(u=Math.max(u,g),d=Math.min(d,m),p=Math.max(p,v),h=Math.min(h,b)),u+=n,d-=n,p+=n,h-=n;var w=o.getBoundingClientRect(),A=w.width,y=w.height,x=h-c,C=c-p,I="bottom",k=0;y>x?y>C?x>=C?(I="bottom",k=x):(I="top",k=C):I="top":I="bottom";var _={horizontal:l+A<=d?"right":l<=(d+u)/2?"right":"left",vertical:I,height:k};this.setState({metrics:_})}},t.prototype.render=function(){var e,t=this,n=this.props,i=n.prefixCls,r=n.className,a=n.style,c=n.children,d=n.disabled,h=n.popupStyle,g=this.isVisible(),m=u.default(i,r,((e={})[i+"-disabled"]=d,e)),v=this.state,b=v.location,w=b.left,A=b.top,y=v.menu,x=v.metrics,C=x.height,I=x.vertical,k=x.horizontal,_=u.default(i+"-popup",i+"-popup-"+k+"-"+I,i+"-popup-"+(g?"visible":"hidden")),E=s.Children.map(y,function(e){return s.isValidElement(e)&&e.type===f?s.cloneElement(e,{visible:g,onClick:function(n,i){e.props.onClick(n,i),t.hide()}}):e});return s.createElement(p.default,{action:this.hide},s.createElement("div",{className:m,style:a,onContextMenu:this.handleContextMenu,ref:this.anchorRef},c),l.default.createPortal(s.createElement(p.default,{className:_,style:o({left:w+"px",top:A+"px",height:C?C+"px":void 0},h),action:this.hide,domRef:this.popupRef,disableContextMenu:!0},E),document.body))},t}(s.Component);t.default=m,m.defaultProps={prefixCls:"dui-menu-contextmenu",disabled:!1,popupBoundary:"viewport",popupMargin:0,onVisibleChange:h.emptyFn},m.propTypes={prefixCls:c.string,style:c.object,className:c.string,menu:c.any,disabled:c.bool,popupStyle:c.object,visible:c.bool,popupBoundary:c.oneOf(["container","viewport"]),popupMargin:c.number,onVisibleChange:c.func}},1704:function(e,t,n){"use strict";var i=n(1687),o={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},r={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},a={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},s={};function l(e){return i.isMemo(e)?a:s[e.$$typeof]||o}s[i.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var c=Object.defineProperty,u=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,h=Object.getPrototypeOf,f=Object.prototype;e.exports=function e(t,n,i){if("string"!==typeof n){if(f){var o=h(n);o&&o!==f&&e(t,o,i)}var a=u(n);d&&(a=a.concat(d(n)));for(var s=l(t),g=l(n),m=0;m<a.length;++m){var v=a[m];if(!r[v]&&(!i||!i[v])&&(!g||!g[v])&&(!s||!s[v])){var b=p(n,v);try{c(t,v,b)}catch(w){}}}return t}return t}},1705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,r=i?Symbol.for("react.portal"):60106,a=i?Symbol.for("react.fragment"):60107,s=i?Symbol.for("react.strict_mode"):60108,l=i?Symbol.for("react.profiler"):60114,c=i?Symbol.for("react.provider"):60109,u=i?Symbol.for("react.context"):60110,d=i?Symbol.for("react.async_mode"):60111,p=i?Symbol.for("react.concurrent_mode"):60111,h=i?Symbol.for("react.forward_ref"):60112,f=i?Symbol.for("react.suspense"):60113,g=i?Symbol.for("react.memo"):60115,m=i?Symbol.for("react.lazy"):60116;function v(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case o:switch(e=e.type){case d:case p:case a:case l:case s:case f:return e;default:switch(e=e&&e.$$typeof){case u:case h:case c:return e;default:return t}}case m:case g:case r:return t}}}function b(e){return v(e)===p}t.typeOf=v,t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=u,t.ContextProvider=c,t.Element=o,t.ForwardRef=h,t.Fragment=a,t.Lazy=m,t.Memo=g,t.Portal=r,t.Profiler=l,t.StrictMode=s,t.Suspense=f,t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===a||e===p||e===l||e===s||e===f||"object"===typeof e&&null!==e&&(e.$$typeof===m||e.$$typeof===g||e.$$typeof===c||e.$$typeof===u||e.$$typeof===h)},t.isAsyncMode=function(e){return b(e)||v(e)===d},t.isConcurrentMode=b,t.isContextConsumer=function(e){return v(e)===u},t.isContextProvider=function(e){return v(e)===c},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===o},t.isForwardRef=function(e){return v(e)===h},t.isFragment=function(e){return v(e)===a},t.isLazy=function(e){return v(e)===m},t.isMemo=function(e){return v(e)===g},t.isPortal=function(e){return v(e)===r},t.isProfiler=function(e){return v(e)===l},t.isStrictMode=function(e){return v(e)===s},t.isSuspense=function(e){return v(e)===f}},1706:function(e,t,n){"use strict";e.exports=function(e,t,n,i,o,r,a,s){if(!e){var l;if(void 0===t)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[n,i,o,r,a,s],u=0;(l=new Error(t.replace(/%s/g,function(){return c[u++]}))).name="Invariant Violation"}throw l.framesToPop=1,l}}},1707:function(e,t,n){"use strict";(function(e,i){var o,r=n(1709);o="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:i;var a=Object(r.a)(o);t.a=a}).call(this,n(199),n(1708)(e))},1708:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1709:function(e,t,n){"use strict";function i(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",function(){return i})},1711:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMergeRange=a,t.cellToMasterCell=function(e,t,n){var i=a(e,t,n);if(i)return{row:i.startRowIndex,col:i.startColIndex};return{row:t,col:n}},t.isCellBeenHidden=function(e,t,n){var i=new r.default(e.spreadsheet.getActiveSheetId(),t,t,n,n),o=a(e,t,n);o&&(i=o);for(var s=e.spreadsheet.activeSheet.data,l=s.columnMetadata,c=void 0===l?[]:l,u=s.rowMetadata,d=void 0===u?[]:u,p=i,h=p.startRowIndex,f=p.endRowIndex,g=p.startColIndex,m=p.endColIndex,v=!0,b=!0,w=h;w<=f;w++){var A=d[w];if(!A||!A.hiddenByFilter&&!A.hiddenByUser){b=!1;break}}for(var y=g;y<=m;y++){var x=c[y];if(!x||!x.hiddenByUser){v=!1;break}}if(b||v)return!0;return!1},t.isCellInVision=function(e,t,n){var i=e.spreadsheet.getActiveSheetId(),o=new r.default(i,t,t,n,n),a=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n),s=a&&a.getMergeReference();s&&(o=s);var l=e.view.canvas.excel.areaData,c=l.row.frozen,u=l.col.frozen,d=l.row.flow,p=l.col.flow;if(c.length>0){if(u.length>0){var h=new r.default(i,c.from,c.to,u.from,u.to);if(h.isCross(o))return!0}if(p.length>0){var f=new r.default(i,c.from,c.to,p.from,p.to);if(f.isCross(o))return!0}}if(d.length>0){if(p.length>0){var g=new r.default(i,d.from,d.to,p.from,p.to);if(g.isCross(o))return!0}if(u.length>0){var m=new r.default(i,d.from,d.to,u.from,u.to);if(m.isCross(o))return!0}}return!1},t.hexToRgb=function(e){var t=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,i){return t+t+n+n+i+i}),n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t),i=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return[i,o,r]},t.checkIsIn=function(e,t){if(e.x>t[0]&&e.y>t[1]&&e.x<t[0]+t[2]&&e.y<t[1]+t[3])return!0;return!1};var i,o=n(11),r=(i=o)&&i.__esModule?i:{default:i};function a(e,t,n){var i=e.spreadsheet.activeSheet.getCellDataAtPosition(t,n);return i&&i.getMergeReference()}},1714:function(e,t,n){"use strict";var i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var r=o(n(46));t.renderChildren=function(e,t,n,o,a){var s=e.children,l=e.options||[],c=e.disabled,u=i({paddingBottom:22},a);return l.length?l.map(function(e,a){return"string"===typeof e?r.createElement(o,{key:a,value:e,onChange:n,checked:-1!==t.indexOf(e),disabled:c,style:i({},u)},e):r.createElement(o,i({},e,{key:a,value:e.value,onChange:n,checked:-1!==t.indexOf(e.value),disabled:e.disabled||c,style:i({},u,e.style)}),e.label)}):r.Children.map(s,function(e){return r.cloneElement(e,{checked:-1!==t.indexOf(e.props.value),onChange:n,disabled:e.props.disabled||c,style:i({},u,e.props.style)})})}},1716:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(114)),o=c(n(16)),r=c(n(14)),a=c(n(47));t.queryComment=function(e){return u(this,void 0,void 0,i.default.mark(function t(){var n,o,r,a,s,l;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.anchorid){t.next=3;break}return t.abrupt("return",[]);case 3:return n=n.replace(window.clientVars.padId+"-",""),t.next=6,d("/v3/oidbinterface/oidb_0xbd1_0",{str_anchor:n});case 6:if(o=t.sent,r=o.data,!(a=o.err)){t.next=14;break}return h(a),t.abrupt("return",[]);case 14:if(s=r.msg_anchorcomments,l=s.rpt_comment){t.next=18;break}return t.abrupt("return",[]);case 18:return t.abrupt("return",l.map(m).sort(function(e,t){return e.times<=t.times?-1:1}));case 19:case"end":return t.stop()}},t,this)}))},t.addComment=function(e){return u(this,void 0,void 0,i.default.mark(function t(){var n,o,r,a,s,l,c,u,h;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.anchorid,o=e.content,r=e.target,a=e.syncGroup,n){t.next=3;break}return t.abrupt("return",null);case 3:return n=n.replace(window.clientVars.padId+"-",""),t.next=6,d("/v3/oidbinterface/oidb_0xbca_0",{rpt_comment:[{str_anchor:n,str_content:o,str_targetid:r}],bool_sync_to_qgroup:a});case 6:if(s=t.sent,l=s.data,!(c=s.err)){t.next=14;break}return p(c),t.abrupt("return",null);case 14:if(u=l.rpt_comment){t.next=17;break}return t.abrupt("return",null);case 17:return h=m(u[0]),t.abrupt("return",h);case 19:case"end":return t.stop()}},t,this)}))},t.editComment=function(e){return u(this,void 0,void 0,i.default.mark(function t(){var n,o,r,a,s,l,c;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.anchorid,o=e.commentid,r=e.content,n&&o){t.next=3;break}return t.abrupt("return",null);case 3:return n=n.replace(window.clientVars.padId+"-",""),t.next=6,d("/v3/oidbinterface/oidb_0xbcc_0",{rpt_comment:[{str_anchor:n,str_content:r,str_commentid:o}]});case 6:if(a=t.sent,s=a.data,!(l=a.err)){t.next=14;break}return g(l),t.abrupt("return",null);case 14:if((c=s.rpt_comment)&&c[0]){t.next=17;break}return t.abrupt("return",null);case 17:return t.abrupt("return",m(c[0]));case 18:case"end":return t.stop()}},t,this)}))},t.delComment=function(e){return u(this,void 0,void 0,i.default.mark(function t(){var n,o,r,a;return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.anchorid,o=e.commentid,void 0!==n&&void 0!==o){t.next=3;break}return t.abrupt("return",!1);case 3:return n=n.replace(window.clientVars.padId+"-",""),t.next=6,d("/v3/oidbinterface/oidb_0xbce_0",{str_anchorid:n,str_commentid:e.commentid,uint32_opr_flag:e.delAll?1:0});case 6:if(r=t.sent,r.data,!(a=r.err)){t.next=12;break}return f(a),t.abrupt("return",!1);case 12:return t.abrupt("return",!0);case 13:case"end":return t.stop()}},t,this)}))},t.addFail=p,t.queryFail=h,t.delFail=f,t.editFail=g;var s=n(1681),l=n(71);function c(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,n,i){return new(n||(n=a.default))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})};function d(e,t){return u(this,void 0,void 0,i.default.mark(function n(){var a,l,c,u;return i.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if(a=window.location.origin+e,(l=window.clientVars.uin)&&"0"!==l){n.next=4;break}return n.abrupt("return",new Error(e+": \u83b7\u53d6\u7684\u7528\u6237uin\u6709\u9519\u8bef"));case 4:return c=(0,r.default)({},t,{str_docid:(0,s.getDocid)(),str_sid:(0,s.getSid)()}),n.prev=5,n.next=8,fetch(a,{method:"POST",body:(0,o.default)(c),headers:new Headers({"Content-Type":"application/json"}),credentials:"same-origin"}).then(function(e){return e.json()});case 8:if("OK"===(u=n.sent).ActionStatus){n.next=11;break}return n.abrupt("return",{err:new Error(e+":"+(0,o.default)(u))});case 11:return n.abrupt("return",{data:u});case 14:return n.prev=14,n.t0=n.catch(5),console.error("Error:",n.t0),n.abrupt("return",n.t0);case 18:case"end":return n.stop()}},n,this,[[5,14]])}))}function p(e){(0,l.showToast)("\u6dfb\u52a0\u6279\u6ce8\u5931\u8d25"),console.error(e)}function h(e){(0,l.showToast)("\u67e5\u8be2\u6279\u6ce8\u5931\u8d25"),console.error(e)}function f(e){(0,l.showToast)("\u5220\u9664\u6279\u6ce8\u5931\u8d25"),console.error(e)}function g(e){(0,l.showToast)("\u4fee\u6539\u6279\u6ce8\u5931\u8d25"),console.error(e)}function m(e){return{id:e.str_commentid,uin:e.str_author,nickName:e.str_author_name,times:e.uint64_time,userImg:e.str_head_url,content:e.str_content}}},1721:function(e,t,n){"use strict";var i=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function i(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}(),o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(46)),s=o(n(141)),l=r(n(142)),c=n(1714),u=n(171),d=r(n(1699)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={values:t.props.defaultValues||[]},t.handleSingleChange=function(e,n){if(!t.props.disabled){var i=t.state.values,o=[];i.indexOf(n.target.value)>=0&&!e?(o=i.filter(function(e){return e!==n.target.value}),t.setState({values:o}),t.props.onChange(o,n)):-1===i.indexOf(n.target.value)&&e&&(o=i.concat(n.target.value),t.setState({values:o}),t.props.onChange(o,n))}},t}return i(t,e),t.getDerivedStateFromProps=function(e,t){return"values"in e?{values:e.values}:null},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,i=e.style,o=e.itemStyle,r=l.default(t,n);return a.createElement("div",{className:r,style:i},c.renderChildren(this.props,this.state.values,this.handleSingleChange,d.default,o))},t}(a.Component);t.default=p,p.defaultProps={prefixCls:"dui-checkbox-group",disabled:!1,onChange:u.emptyFn},p.propTypes={prefixCls:s.string,style:s.object,className:s.string,options:s.array,disabled:s.bool,values:s.array,children:s.node,defaultValues:s.array,onChange:s.func,itemStyle:s.object}},1723:function(e,t,n){e.exports={default:n(1724),__esModule:!0}},1724:function(e,t,n){n(762),e.exports=n(34).Object.getOwnPropertySymbols},1745:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(47)),o=f(n(9)),r=f(n(14)),a=f(n(41)),s=f(n(1723));t.setCommentPanelShow=m,t.getAnchors=v,t.queryAnchorId=b,t.activeRangeByAnchorId=w,t.scrollActiveCellToTopCenter=A;var l=f(n(7)),c=f(n(243)),u=f(n(173)),d=n(112),p=n(1837),h=n(82);function f(e){return e&&e.__esModule?e:{default:e}}var g=function(e,t){var n={};for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&t.indexOf(i)<0&&(n[i]=e[i]);if(null!=e&&"function"===typeof s.default){var o=0;for(i=(0,s.default)(e);o<i.length;o++)t.indexOf(i[o])<0&&(n[i[o]]=e[i[o]])}return n};function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e.spreadsheet,i=n.activeSheetId,o=v(e),s=(0,a.default)(o,2),l=s[0],c=s[1],u=t.showPanelCallback,p=t.hidePanelCallback,f=g(t,["showPanelCallback","hidePanelCallback"]);e.view.discuss.showCommentPanel((0,r.default)({targetId:i,anchorIds:c,activeAnchorId:l,switchAnchorCallback:function(t){console.log("sheet \u56de\u8c03\u5f97\u5230\u7684\u53c2\u6570",t),w(e,{anchorId:t}).then(function(e){e()}).catch(function(){})},deleteCommentCallback:function(e){console.log("\u5220\u9664\u6279\u6ce8\u7684\u56de\u8c03\u51fd\u6570",e)},editCommentCallback:function(e){console.log("\u7f16\u8f91\u6279\u6ce8\u7684\u56de\u8c03\u51fd\u6570",e)},deleteAnchorCallback:function(e){var t=(n.activeSheet.sheetRangeControl.getSheetRange(e)||{}).gridRange,i=void 0===t?null:t;i&&(0,d.deleteCommentRange)(i)},createCommentCallback:function(t,n,i){b(e)||(A(e),(0,d.defineCommentRange)(l))},showPanelCallback:function(t){e.event.default.trigger(h.EVENT_NAME.UI_SHOW,"comment-panel-m"),e.view.mobileToolBar&&e.view.mobileToolBar.addContainerTransition(),e.view.mobileToolBar&&e.view.mobileToolBar.moveCanvasContainer(0),"function"===typeof u&&u(t)},hidePanelCallback:function(t){e.view.canvas.excel.restoreStatus(),"function"===typeof p&&p(t)}},f))}function v(e){var t=b(e)||(0,p.getRandomWorkbookRangeId)(),n=[];try{var i=e.view.getSelection().rangeSelections,a=void 0===i?[]:i,s=e.spreadsheet.activeSheet.sheetRangeControl.ranges,l=(0,o.default)(s).reduce(function(e,t){var n=s[t],i=n.sheetRangeType,o=n.gridRange,a=void 0===o?{}:o;return i!==u.default.COMMENT_RANGE?e:(e.push((0,r.default)({id:t},a)),e)},[]);!s[t]&&a.length&&l.push((0,r.default)({id:t},a[0])),n=l.sort(function(e,t){return e.startRowIndex===t.startRowIndex?e.startColIndex-t.startColIndex:e.startRowIndex-t.startRowIndex}).map(function(e){return e.id})}catch(c){}return[t,n]}function b(e){try{var t=e.view.canvas.excel.selectData.active.yIndex,n=e.view.canvas.excel.selectData.active.xIndex,i=e.spreadsheet.activeSheet.data.rowData[t],o=i&&i.values[n];if(!o||!o.sheetRangeReferences)return"";for(var r=0,a=o.sheetRangeReferences[r];r<o.sheetRangeReferences.length;r++)if(a.type===u.default.COMMENT_RANGE)return a.id;return""}catch(s){return""}}function w(e,t){return new i.default(function(n,i){var o=t.anchorId,r=t.sheetId,a=t.showCommentPanel,s=t.commentId,c=e.spreadsheet,u=c.activeSheetId,d=function(){var t=c.activeSheet.sheetRangeControl.getSheetRange(o);if(t&&t.gridRange){var r=t.gridRange;n(function(){e.view.setSelection(r),A(e),a&&m(e,{activeCommentId:s})})}else i(new Error("anchorId not exist"))};r&&r!==u?c.getSheetBySheetId(r)?l.default.event.sheetsBar.trigger("switchSheet",r,u,{onSuccess:d,onFail:function(){l.default.event.sheetsBar.trigger("switchSheet",u),i(new Error("switch sheet error"))}}):i(new Error("sheetId not exist")):d()})}function A(e){var t=e.view.getSelection().rangeSelections;if(t.length){var n=t[0],i=n.startColIndex,o=n.startRowIndex;if(void 0!==i&&void 0!==o){var r=e.view.canvas.excel,a=r.areaData,s=r.configData,l=r.tableData.col.getWidth(i),u=a.col.getAreaName(i),d=-(a.col.getViewportLeft(i)-s.rowHeadWidth-(r.bodyWidth-l)/2),p=a.row.getAreaName(o),h=-(a.row.getViewportTop(o)-s.colHeadHeight-60);r.tableScroll({areaX:u,diffX:d,areaY:p,diffY:h,type:c.default.constant.TABLE_SCROLL_MODE.EASE,step:16})}}}window._queryAnchorId=b},1746:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(14)),o=m(n(3)),r=m(n(0)),a=m(n(1)),s=m(n(4)),l=m(n(5)),c=n(46),u=m(c),d=m(n(1698)),p=n(1681),h=(n(244),m(n(1846))),f=n(21),g=m(n(8));function m(e){return e&&e.__esModule?e:{default:e}}var v=!!window.ActiveXObject||"ActiveXObject"in window,b=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n._isMounted=!1,n.state={textContent:e.defaultValue.trim(),isLoading:!1},n.inputRef=(0,c.createRef)(),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this;this._isMounted=!0;var t=this.inputRef.current;t&&t.focus(),window.SpreadsheetApp.view.canvas.pluginsApi.cardCenter._updatePosition(),v&&t&&t.addEventListener("textinput",function(){e.handleChange()})}},{key:"componentDidUpdate",value:function(){console.warn("textContent",this.state.textContent),this.props.focus&&this.inputRef.current&&this.inputRef.current.focus()}},{key:"componentWillUnmount",value:function(){this._isMounted=!1}},{key:"handleChange",value:function(){this.setState({textContent:this.getContent()})}},{key:"onConfirm",value:function(e){var t=this;e&&(e.preventDefault(),e.stopPropagation()),this.setState({isLoading:!0}),this.props.textareaConfirm({content:this.getContent(),editableId:this.props.editableId}).then(function(){t.setState({isLoading:!1,textContent:""}),window.SpreadsheetApp.view.canvas.pluginsApi.cardCenter._updatePosition(),t.setContent("")})}},{key:"onCancel",value:function(e){e.preventDefault(),e.stopPropagation(),this.props.textareaCancel(),window.SpreadsheetApp.view.canvas.pluginsApi.cardCenter._updatePosition()}},{key:"handleKeyDown",value:function(e){var t=this;if(this._isMounted&&document.activeElement===this.inputRef.current)switch(e.keyCode){case 13:(0,f.macCmdAndWinCtrl)()&&this.onConfirm();break;case 8:case 46:setTimeout(function(){t.getContent()||t.setContent("")},0)}}},{key:"handlePaste",value:function(){var e=this;setTimeout(function(){e.setContent(e.getContent())},0)}},{key:"handleFocus",value:function(){var e=this.inputRef.current;if(e&&e.lastChild){var t=document.createRange(),n=window.getSelection();t.selectNodeContents(e.lastChild),t.collapse(!1),n.removeAllRanges(),n.addRange(t),g.default.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"input"})}}},{key:"handleBlur",value:function(){this.props.onblur&&this.props.onblur()}},{key:"getContent",value:function(){var e=this.inputRef.current;return e?e.innerText.replace(/(\s|&nbsp;|\n|<br>)+$/g,"").replace(/^(\s|&nbsp;|\n|<br>)+/g,""):""}},{key:"setContent",value:function(e){var t=this.inputRef.current;return!!t&&(t.innerHTML=e,this.handleChange(),!0)}},{key:"renderUser",value:function(){if(0===(0,p.getCommentsListLen)(this.props.comments)){var e=(0,p.getUserPic)(),t=(0,p.getUserName)();return u.default.createElement("div",{className:"comment-user-info-wrap"},u.default.createElement("div",{className:"comment-user-info"},u.default.createElement("img",{className:"comment-user-info-img",src:e,alt:t}),u.default.createElement("span",{className:"comment-user-info-nickName"},(0,p.formatNickName)(t))))}return null}},{key:"render",value:function(){if(!this.props.getEditable())return null;var e=this.state,t=e.isLoading,n=e.textContent,o=this.props,r=o.app,a=o.syncGroup,s=o.setSyncGroup,l=o.defaultValue,c=r&&r.view&&r.view.discuss&&r.view.discuss.getQQGroupName(),p=!t,f=n.length>0,g={autoCapitalize:"false",autoComplete:"false",autoFocus:!0,spellCheck:!1,contentEditable:!0,suppressContentEditableWarning:!0,"data-placeholder":"\u6dfb\u52a0\u6279\u6ce8"};return u.default.createElement("div",{className:"comment-textarea-group"},this.renderUser(),u.default.createElement("div",(0,i.default)({},g,{className:"textarea"+(v?" isIE":""),ref:this.inputRef,dangerouslySetInnerHTML:{__html:l||""},onInput:this.handleChange.bind(this),onKeyDown:this.handleKeyDown.bind(this),onFocus:this.handleFocus.bind(this),onBlur:this.handleBlur.bind(this),onPaste:this.handlePaste.bind(this)})),c?u.default.createElement("div",{className:"sync-qq-group",style:{marginBottom:f?35:0}},u.default.createElement(d.default,{checked:a,hollow:!0,onChange:s},u.default.createElement("span",{className:"qq-group-name"},"\u540c\u6b65\u5230\u7fa4\uff1a",c))):null,u.default.createElement("div",{className:"btn-group"+(f?" btn-group-show":"")},u.default.createElement(h.default,{className:"btn-confirm",enable:p,loading:t,private:!0,onClick:this.onConfirm.bind(this)},"\u786e\u5b9a"),u.default.createElement(h.default,{className:"btn-cancel",enable:p,onClick:this.onCancel.bind(this)},"\u53d6\u6d88")))}}]),t}(c.Component);t.default=b;var w=new RegExp("("+/[-:@a-zA-Z0-9_.,~%+\/\\?=&#!;()[\]$]/.source+"|"+/[\u0030-\u0039\u0041-\u005A\u0061-\u007A\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u00FF\u0100-\u1FFF\u3040-\u9FFF\uF900-\uFDFF\uFE70-\uFEFE\uFF10-\uFF19\uFF21-\uFF3A\uFF41-\uFF5A\uFF66-\uFFDC]/.source+")"),A=new RegExp(/\b(?:(?:https?|s?ftp|ftps|file|nfs):\/\/|mailto:|tel:|www\.)/.source+w.source+"+");new RegExp(/<a[^>]*>.*<\/a>/.source+"|("+A.source+")","gi")},1747:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.SHOW="SHOW",t.HIDE="HIDE",t.UPDATE_TYPE="UPDATE_TYPE",t.UPDATE_EDITOR="UPDATE_EDITOR",t.SET_ANCHOR_ID="SET_ANCHOR_ID",t.UPDATE_COMMENTS="UPDATE_COMMENTS",t.ADD_COMMENT="ADD_COMMENT",t.DEL_COMMENT="DEL_COMMENT",t.EDIT_COMMENT="EDIT_COMMENT",t.SET_SYNC_GROUP="SET_SYNC_GROUP",t.SET_HIGHLIGHT="SET_HIGHLIGHT"},1748:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setHighlight=t.setSyncGroup=t.editComment=t.delComment=t.addComment=t.updateComments=t.updateEditor=t.setPanelTypeFocus=t.setAnchorid=t.hide=t.show=void 0;var i=n(1691),o=n(1747);t.show=function(){return{type:o.SHOW}},t.hide=function(){return{type:o.HIDE}},t.setAnchorid=function(e){return{type:o.SET_ANCHOR_ID,payload:{anchorid:e}}},t.setPanelTypeFocus=function(){return{type:o.UPDATE_TYPE,payload:{type:i.PANEL_TYPE.focus}}},t.updateEditor=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return{type:o.UPDATE_EDITOR,payload:{editableId:e,textContent:t}}},t.updateComments=function(e){return{type:o.UPDATE_COMMENTS,payload:{comments:e}}},t.addComment=function(e){return{type:o.ADD_COMMENT,payload:{comment:e}}},t.delComment=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return{type:o.DEL_COMMENT,payload:{commentid:e,delAll:t}}},t.editComment=function(e){return{type:o.EDIT_COMMENT,payload:{newComment:e}}},t.setSyncGroup=function(e){return{type:o.SET_SYNC_GROUP,payload:{syncGroup:e}}},t.setHighlight=function(e){return{type:o.SET_HIGHLIGHT,payload:{commentId:e}}}},1749:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterProtocol=function(e){e.trim&&(e=e.trim());e=i.test(e)?"mailto:"+e:function(e){/^(https?|ftp|file)\:\/\//i.test(e)||(e=/^(\/\/)/.test(e)?"http:"+e:"http://"+e);return e}(e);return e},t.safeStr=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")};var i=/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-\.])+\@([a-z\u00a1-\uffff0-9_\-\.])+\.([a-z]{2,})$/i},1750:function(e,t,n){var i=n(1876);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1835:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=_(n(114)),o=_(n(3)),r=_(n(0)),a=_(n(1)),s=_(n(4)),l=_(n(5)),c=_(n(59)),u=_(n(47)),d=_(n(243)),p=n(113),h=_(n(1836)),f=_(n(1852)),g=_(n(1856)),m=_(n(1861)),v=_(n(1867)),b=n(1681),w=_(n(35));n(1868);var A=_(n(7)),y=_(n(15)),x=n(1711),C=n(22),I=_(n(12)),k=n(10);function _(e){return e&&e.__esModule?e:{default:e}}var E=function(e,t,n,i){return new(n||(n=u.default))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},D=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{alloyExcel:e.excel}));return n.x=0,n.y=0,n.hideAll=function(){n.formula&&n.formula.hide(),n.comment&&n.comment.hide(),n.commentMobile&&n.commentMobile.hide(),n.link&&n.link.hideModifyBox(),C.isMobile,n._unbindPositionCenter()},n._scale=function(){n.hasShow()&&n._updatePosition(),n.link&&n.link.onScale()},n._selectionShow=function(e){if(e){var t=n.stage.selectData,i=t.active.xIndex,o=t.active.yIndex;if(n.area.x=i,n.area.y=o,n.comment&&n.comment.disableAutoShow)n.comment.disableAutoShow();else{var r=e.activeChange,a=e.selectChange;if(r||a)if(e.show){if(r)n.hideAll(),n._updatePosition(),n.showAll(n.area);else if(a){var s=t.active,l=s.xRange,c=s.yRange,u=t.select,d=u.xRange,p=u.yRange;l[0]===d[0]&&l[1]===d[1]&&c[0]===p[0]&&c[1]===p[1]?(n.hideAll(),n.area.x=i,n.area.y=o,n._updatePosition(),n.showAll(n.area)):n.hideAll()}}else n.hideAll()}}},n._handleTableMove=function(e){var t=e.diffX||0,i=e.diffY||0,o=n.x,r=n.y;n.x=o-t,n.y=r-i;var a=!(0,x.isCellInVision)(n.app,n.area.y,n.area.x);n.dom.setAttribute("style","top: "+n.y+"px; left:"+n.x+"px; display:"+(a?"none":"flex"))},n.app=e.spreadsheetApp,n.positionCenterKey=null,n._initDom(),n.area={x:-1,y:-1},n.locateType=d.default.constant.PLUGIN_LOCATE_TYPE.BODY,(0,c.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"init",n).call(n),n._bindEvent(),n.changeStopPropagationSlots(Math.pow(2,6)),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"initCommentMobile",value:function(){this.commentMobile||(this.commentMobile=new f.default({wrap:this.dom,parent:this,app:this.app}))}},{key:"initComment",value:function(){this.comment||(this.comment=new h.default({wrap:this.dom,parent:this}))}},{key:"initFormula",value:function(){this.formula||(this.formula=new g.default({wrap:this.dom,app:this.app}))}},{key:"initLink",value:function(){this.link||(this.link=new m.default({wrap:this.dom.parentElement,parent:this}))}},{key:"addComment",value:function(){this.initComment(),this.comment.addComment()}},{key:"checkCommentShow",value:function(e){return this.initComment(),this.comment.activeCommentByRefer(e)}},{key:"addCommentMobile",value:function(){this.initCommentMobile(),this.commentMobile.handleContextMenu()}},{key:"addLink",value:function(){this.initLink(),this.link.addLink()}},{key:"showAll",value:function(e){var t=this,n=this.stage.tableMenu;if((!n||!n.isShow())&&!(e.x<0||e.y<0)&&(0,b.checkPanelShow)()){var i=this.commentShow(e).then(function(){(0,b.checkPanelShow)()?(t.initFormula(),t.formula.show({row:t.area.y,col:t.area.x}),t._updatePosition()):t.hideAll()}),o=new u.default(function(e){I.default.wait(2e3).run(function(){e()})}).then(function(){(0,b.checkPanelShow)()?(t.initFormula(),t.formula.show({row:t.area.y,col:t.area.x}),t._updatePosition()):t.hideAll()});u.default.race([i,o]).then(function(){t.hasShow()&&t._bindPositionCenter()})}}},{key:"hasShow",value:function(){for(var e=[this.formula,this.comment,this.commentMobile,this.link],t=0;t<e.length;t++)if(e[t]&&e[t].getVisible())return!0;return!1}},{key:"commentShow",value:function(e){return E(this,void 0,void 0,i.default.mark(function t(){return i.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!C.isPc){t.next=6;break}return this.initComment(),t.next=4,this.comment.show(e);case 4:t.next=9;break;case 6:return this.initCommentMobile(),t.next=9,this.commentMobile.show();case 9:case"end":return t.stop()}},t,this)}))}},{key:"_bindEvent",value:function(){this.addHook(k.PLUGIN_HOOK.SELECTION_SHOW,(0,p.throttle)(this._selectionShow,100,this,!0)),this.addHook(k.PLUGIN_HOOK.TABLE_MOVE,this._handleTableMove.bind(this)),this.addHook(k.PLUGIN_HOOK.SCALE,this._scale.bind(this)),this.addHook(k.PLUGIN_HOOK.ENTER_INPUT_STATUS,this.hideAll.bind(this)),this.dom.addEventListener("transitionend",this._updatePosition.bind(this)),this.dom.addEventListener("webkitTransitionEnd",this._updatePosition.bind(this)),this.dom.addEventListener("dblclick",function(e){e.stopPropagation()}),A.default.event.sheetsBar.listen("switchSheet",this.hideAll.bind(this)),A.default.event.sheetsBar.listen("addSheet",this.hideAll.bind(this)),this.stage.event.eventTable.remove("clearTable",this.hideAll.bind(this)),C.isPc?this._bindEventPC():C.isPad?this._bindEventPad():this._bindEventMobile()}},{key:"_bindEventPC",value:function(){var e=this;this.addHook(k.PLUGIN_HOOK.MOUSE_DOWN,function(t){if(t.x<0||t.y<0)e.hideAll();else{e.initLink(),e.link.onMouseDown(t);2!==e.stage.mouseData.button||e.hideAll()}}),this.addHook(k.PLUGIN_HOOK.MOUSE_MOVE,function(t){e.initLink(),e.link.onMouseMove(t)}),this.addHook(k.PLUGIN_HOOK.TABLE_MENU,function(){e.hideAll()});for(var t=document.querySelectorAll(".oper-point"),n=0;n<t.length;n++)t[n].addEventListener("mousedown",function(){e.hideAll()})}},{key:"_bindEventPad",value:function(){var e=this;this.addHook(k.PLUGIN_HOOK.TAP,function(t){setTimeout(function(){e.initLink(),e.link.onMouseDown(t)},0)});for(var t=document.querySelectorAll(".oper-point"),n=0;n<t.length;n++)t[n].addEventListener("touchstart",function(){e.hideAll()})}},{key:"_bindEventMobile",value:function(){var e=this;this.addHook(k.PLUGIN_HOOK.TAP,function(t){setTimeout(function(){e.initLink(),e.link.onMouseDown(t)},0)})}},{key:"_bindPositionCenter",value:function(){var e=this,t=this.app.spreadsheet.getActiveSheetId(),n=this.area.x,i=this.area.y;this.positionCenterKey=this.app.spreadsheet.activeSheet.positionCenter.add({type:"card-center",config:{ignoreSetCell:!1},selfData:{xRange:new w.default(t,n,n,y.default.COLUMNS),yRange:new w.default(t,i,i,y.default.ROWS)},calc:function(t){e.hideAll()}})}},{key:"_unbindPositionCenter",value:function(){this.positionCenterKey&&this.app.spreadsheet.activeSheet.positionCenter.remove(this.positionCenterKey)}},{key:"_initDom",value:function(){var e=document.createElement("div");e.id="card-center",this.dom=e}},{key:"_updatePosition",value:function(){var e=this.dom;this._updateRect();var t=this._calcPosition(this.area.x,this.area.y,this.rect);this.y=isNaN(t.y)?0:t.y,this.x=isNaN(t.x)?0:t.x,e.setAttribute("style","top: "+t.y+"px; left:"+t.x+"px")}},{key:"_updateRect",value:function(){var e=this.dom;this.rect=e.getBoundingClientRect()}},{key:"_calcPosition",value:function(e,t,n){var i=this.stage,o=i.tableData,r=i.areaData,a=i.configData,s=a.colHeadHeight,l=a.rowHeadWidth,c=r.col.getViewportLeft(e),u=r.row.getViewportTop(t),d=(0,v.default)({left:c,top:u,width:0,height:o.getCellBackgroundHeight(t,e,!1)},{width:n.width,height:n.height},{x:{min:a.rowHeadWidth,max:this.stage.width},y:{min:a.colHeadHeight,max:this.stage.height}},{yPriority:1,targetXPoint:[0]});return{x:d.left-l,y:d.top-s}}}]),t}(d.default.AlloyExcelUIPlugin);t.default=D},1836:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(114)),o=v(n(0)),r=v(n(1)),a=v(n(47)),s=v(n(123)),l=v(n(443)),c=n(1691),u=n(1745),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1716)),p=n(1681),h=v(n(12)),f=v(n(8));n(1838);var g=n(1842),m=n(1748);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e,t,n,i){return new(n||(n=a.default))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},w=function(){function e(t){(0,o.default)(this,e),this.disableAutoShow=null,this._render(t.wrap),this.parent=t.parent}return(0,r.default)(e,[{key:"show",value:function(e){return b(this,void 0,void 0,i.default.mark(function e(){var t,n,o;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.getAnchorId()){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,d.queryComment({anchorid:t});case 5:if(n=e.sent,o=this.getAnchorId(),t===o&&0!==(0,p.getCommentsListLen)(n)&&(0,p.checkPanelShow)()){e.next=9;break}return e.abrupt("return");case 9:return g.store.dispatch((0,m.updateComments)(n)),g.store.dispatch((0,m.show)()),e.abrupt("return");case 12:case"end":return e.stop()}},e,this)}))}},{key:"addComment",value:function(){var e=this.getAnchorId();d.queryComment({anchorid:e}).then(function(e){g.store.dispatch((0,m.updateComments)(e))}),g.store.dispatch((0,m.show)()),g.store.dispatch((0,m.setPanelTypeFocus)()),g.store.dispatch((0,m.updateEditor)(c.EDITABLE_ID.top,"")),this.parent._updatePosition()}},{key:"handleToolBarRemove",value:function(){this.hide()}},{key:"hide",value:function(){g.store.dispatch((0,m.hide)())}},{key:"activeCommentByRefer",value:function(e){var t=this,n=e.anchorId,i=e.commentId,o=function(e){"function"===typeof e&&e(),l.default.show({type:"error",message:"\u6279\u6ce8\u5df2\u88ab\u5220\u9664",autoClose:!0})};return new a.default(function(r,a){(0,u.activeRangeByAnchorId)(t.parent.app,e).then(function(e){d.queryComment({anchorid:n}).then(function(n){var s=n.map(function(e){return e.id});i&&s.indexOf(i)>-1?r(function(){t.disableAutoShow=function(){t.disableAutoShow=null,t.parent.hideAll(),t.parent._updatePosition(),g.store.dispatch((0,m.setHighlight)(i)),g.store.dispatch((0,m.setPanelTypeFocus)()),g.store.dispatch((0,m.updateComments)(n)),g.store.dispatch((0,m.show)())},t.hide(),e()}):o(a)}).catch(function(){o(a)})}).catch(function(){o(a)})})}},{key:"getVisible",value:function(){return g.store.getState().visible}},{key:"_render",value:function(e){var t=this;h.default.wait(0).run(function(){try{if(!e)return void console.error("Comment wrap is null");var n=document.createElement("div");n.id="commentPanel-container",e.appendChild(n),s.default.render((0,g.app)(t.parent.app),n)}catch(i){f.default.monitor(34235871)}})}},{key:"getAnchorId",value:function(){var e=g.store.getState().anchorid;return e||(e=(0,u.queryAnchorId)(this.parent.app),g.store.dispatch((0,m.setAnchorid)(e))),e}}]),e}();t.default=w},1837:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.getRandomWorkbookRangeId=function(){var e,t;return String((e=1e9,t=9999999999,Math.floor(Math.random()*(t-e+1))+e))}},1838:function(e,t,n){var i=n(1839);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1839:function(e,t,n){t=e.exports=n(36)(!1);var i=n(758),o=i(n(1840)),r=i(n(1841));t.push([e.i,".commentPanel {\n  display: flex;\n  width: 280px;\n  background: #FFFFFF;\n  flex-flow: column nowrap;\n  justify-content: space-between;\n  align-items: stretch;\n}\n.commentPanel-preview {\n  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.14);\n  cursor: pointer;\n}\n.commentPanel-preview:hover {\n  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.2);\n}\n.commentPanel-focus {\n  cursor: default;\n  box-shadow: 0 0 10px 0 rgba(0, 0, 0, 0.2);\n}\n.comment-header {\n  display: flex;\n  height: 30px;\n  border-bottom: 1px solid #f4f4f4;\n  visibility: visible;\n  flex-flow: row nowrap;\n  justify-content: flex-end;\n  align-items: center;\n  font-size: 12px;\n  padding-right: 24px;\n}\n.comment-header .clear-btn-box {\n  color: #777;\n  cursor: pointer;\n  transition: all 0.2s;\n  display: inline-flex;\n  align-items: center;\n}\n.comment-header .clear-btn-box:hover {\n  color: #388BF6;\n}\n.comment-header .clear-icon {\n  display: inline-block;\n  width: 14px;\n  height: 14px;\n  background: url("+o+") no-repeat center center;\n  background-size: 100%;\n  transition: background 0.3s ease-in;\n  margin-right: 5px;\n}\n.comment-header .clear-btn {\n  display: inline-block;\n  height: 18px;\n}\n.comment-header .clear-btn-box:hover .clear-icon {\n  background-image: url("+r+");\n}\n.comment-list {\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n.commentPanel-focus .comment-list {\n  max-height: 330px;\n}\n.folded-tips {\n  position: relative;\n  height: 34px;\n  line-height: 34px;\n  text-align: center;\n  color: #8e8e8e;\n  cursor: pointer;\n}\n.folded-tips .icon {\n  background: url(/static/img/comment_icon_fold.png) no-repeat left center;\n  display: flex;\n  width: 100%;\n  height: 100%;\n  flex-flow: row nowrap;\n  justify-content: center;\n  font-size: 12px;\n  align-items: center;\n}\n.folded-tips .icon svg {\n  margin-right: 4px;\n}\n.comment-item {\n  position: relative;\n  padding: 21px 24px 18px 23px;\n}\n.comment-item.highlight {\n  background: #fffbe1;\n}\n.comment-item.highlight:hover {\n  background: #fffbe1 !important;\n}\n.commentPanel-focus .comment-item:not(.editing):hover {\n  background-color: #fafafa;\n}\n/* \u7528\u6237\u4fe1\u606f */\n.comment-user-info-wrap {\n  display: flex;\n  flex-flow: row nowrap;\n  justify-content: space-between;\n  align-items: center;\n}\n.comment-textarea-group .comment-user-info-wrap {\n  margin-bottom: 10px;\n}\n.comment-user-info-wrap .comment-user-info {\n  display: inline-flex;\n  align-items: center;\n}\n.comment-user-info-img {\n  overflow: hidden;\n  display: inline-block;\n  background: white;\n  width: 28px;\n  height: 28px;\n  border: 1ps solid white;\n  border-radius: 50%;\n  margin-right: 10px;\n}\n.comment-user-info-nickName {\n  font-size: 12px;\n  color: #333;\n}\n.comment-user-info-times {\n  font-size: 12px;\n  color: #aaa;\n}\n.folded-tips .comment-item-top-border,\n.comment-item .comment-item-top-border {\n  position: absolute;\n  top: 0;\n  left: 24px;\n  width: 232px;\n  border-bottom: 1px solid #f4f4f4;\n}\n.folded-tips .comment-item-bottom-border,\n.comment-item .comment-item-bottom-border {\n  position: absolute;\n  bottom: 0;\n  left: 24px;\n  width: 232px;\n  border-bottom: 1px solid #f4f4f4;\n}\n.comment-item:last-child .comment-item-bottom-border {\n  border-bottom: none;\n}\n.commentPanel-preview .comment-item .comment-btn-group {\n  display: none;\n}\n.commentPanel-focus .comment-item .comment-btn-group {\n  display: none;\n}\n.commentPanel-focus .comment-item:not(.editing):hover .comment-btn-group {\n  display: inline-block;\n}\n.commentPanel-focus .comment-item:hover .comment-user-info-times,\n.commentPanel-focus .comment-item.editing .comment-user-info-times {\n  display: none;\n}\n.comment-item .comment-btn-group {\n  line-height: 12px;\n}\n.comment-item .comment-btn-group .comment-edit {\n  margin-right: 10px;\n}\n.comment-item .comment-btn-group .comment-edit,\n.comment-item .comment-btn-group .comment-del {\n  line-height: 1;\n  font-size: 12px;\n  cursor: pointer;\n  color: #388bf6;\n}\n.comment-item .comment-text {\n  margin-top: 10px;\n  font-size: 14px;\n  line-height: 20px;\n  word-break: break-all;\n  white-space: pre-wrap;\n}\n.comment-item .comment-text-folded {\n  display: -webkit-box;\n  -webkit-line-clamp: 3;\n  overflow: hidden;\n  cursor: pointer;\n  max-height: 60px;\n  text-overflow: ellipsis;\n}\n.comment-item .comment-text-expanded {\n  cursor: default;\n}\n.panel-textarea {\n  padding: 0 24px 17px;\n}\n.panel-textarea > p {\n  font-size: 12px;\n  color: #777;\n  padding-top: 20px;\n  padding-bottom: 12px;\n}\n.panel-textarea > p + .comment-textarea-group {\n  padding-top: 0;\n}\n.comment-textarea-group {\n  display: flex;\n  flex-flow: column nowrap;\n  justify-content: flex-end;\n  padding-top: 17px;\n  overflow-x: hidden;\n}\n.comment-textarea-group .sync-qq-group {\n  padding-top: 15px;\n}\n.comment-textarea-group .sync-qq-group .dui-checkbox-icon {\n  top: 3px;\n  width: 14px;\n  height: 14px;\n}\n.comment-textarea-group .qq-group-name {\n  font-size: 12px;\n  color: #202020;\n  opacity: 0.64;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n}\n#commentPanel-container .comment-textarea-wrap {\n  position: relative;\n}\n#commentPanel-container .textarea {\n  position: relative;\n  box-sizing: border-box;\n  min-height: 40px;\n  max-height: 80px;\n  color: black;\n  background-color: #f5f5f5;\n  padding: 10px 7px;\n  font-size: 14px;\n  line-height: 20px;\n  word-break: break-all;\n  white-space: pre-wrap;\n  overflow-x: hidden;\n  overflow-y: scroll;\n  resize: none;\n  border: none;\n  -webkit-appearance: none;\n  width: 232px;\n  cursor: text;\n}\n#commentPanel-container .textarea:empty::after {\n  content: attr(data-placeholder);\n  color: rgba(0, 0, 0, 0.24);\n}\n#commentPanel-container .textarea.isIE::after {\n  position: absolute;\n  top: 10px;\n  left: 7px;\n}\n.comment-textarea-group .btn-group {\n  display: flex;\n  flex-flow: row-reverse;\n  justify-content: flex-start;\n  overflow: hidden;\n  height: 0;\n  margin: 0;\n  transition: all 0.3s ease-out;\n}\n.comment-textarea-group .btn-group.btn-group-show {\n  margin-top: 14px;\n  height: auto;\n}\n.comment-textarea-group .btn-cancel {\n  margin-right: 10px;\n}\n",""])},1840:function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/clear-btn@2x-a6a7d26ae3.png"},1841:function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/clear-btn-hover@2x-c70736e56f.png"},1842:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.app=t.store=void 0;var i=C(n(83)),o=C(n(14)),r=C(n(3)),a=C(n(0)),s=C(n(1)),l=C(n(4)),c=C(n(5)),u=C(n(46)),d=n(1677),p=C(n(1843)),h=C(n(1844)),f=C(n(1746)),g=C(n(1850)),m=n(1691),v=n(1681),b=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1716)),w=n(1748),A=n(316),y=n(112),x=C(n(8));function C(e){return e&&e.__esModule?e:{default:e}}var I=t.store=(0,g.default)(),k=function(e){function t(){(0,a.default)(this,t);var e=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).apply(this,arguments));return e.getEditable=function(){return e.props.app.sheetStatus.permission.gEditable},e}return(0,c.default)(t,e),(0,s.default)(t,[{key:"handleClick",value:function(){var e=this.props.app;e.sheetStatus.permission.gEditable&&this.props.type===m.PANEL_TYPE.preview&&(this.props.setPanelTypeFocus(),e.view.canvas.pluginsApi.cardCenter._updatePosition())}},{key:"renderCommentList",value:function(){var e=this.props,t=e.type,n=e.editableId,i=e.comments,o=e.highlightCommentId;return u.default.createElement(h.default,{getEditable:this.getEditable,comments:i,type:t,anchorid:this.props.anchorid,editableId:n,highlightCommentId:o,updateEditor:this.props.updateEditor,editComment:this.props.editComment,delComment:this.props.delComment})}},{key:"renderTextArea",value:function(){var e=this,t=this.props,n=t.app,i=t.type,o=t.editableId,r=t.comments,a=t.syncGroup,s=t.setSyncGroup;if(i===m.PANEL_TYPE.focus&&o===m.EDITABLE_ID.top){return u.default.createElement("div",{className:"panel-textarea",style:{display:this.getEditable()?"block":"none"}},(0,v.getCommentsListLen)(this.props.comments)>0&&u.default.createElement("p",null,"\u8ffd\u52a0\u6279\u6ce8"),u.default.createElement(f.default,{app:n,getEditable:this.getEditable,editableId:m.EDITABLE_ID.top,comments:r,syncGroup:a,setSyncGroup:s,textareaCancel:function(){e.props.hide()},textareaConfirm:function(t){var i=t.content,o=e.props.anchorid;return o||(o=(0,A.getRandomWorkbookRangeId)(),(0,y.defineCommentRange)(o),e.props.setAnchorid(o)),x.default.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"send_com"}),b.addComment({anchorid:o,content:i,target:n.spreadsheet.activeSheetId,syncGroup:a}).then(function(t){e.props.addComment(t)})}.bind(this),defaultValue:""}))}return null}},{key:"render",value:function(){var e=this.props,t=e.visible;e.comments,e.type,e.editableId,e.hide;return u.default.createElement("div",{style:{display:t?"block":"none"},onClick:this.handleClick.bind(this)},u.default.createElement("div",{className:E(this.props.type)},u.default.createElement(p.default,{type:this.props.type,anchorid:this.props.anchorid,comments:this.props.comments,delComment:this.props.delComment}),this.renderCommentList(),this.renderTextArea()))}}]),t}(u.default.Component),_=(0,d.connect)(function(e){return(0,o.default)({},e)},function(e){return{hide:function(){return e((0,w.hide)())},addComment:function(t){return e((0,w.addComment)(t))},editComment:function(t){return e((0,w.editComment)(t))},delComment:function(t,n){return e((0,w.delComment)(t,n))},setPanelTypeFocus:function(){return e((0,w.setPanelTypeFocus)())},updateEditor:function(t,n){return e((0,w.updateEditor)(t,n))},setAnchorid:function(t){return e((0,w.setAnchorid)(t))},setSyncGroup:function(t){return e((0,w.setSyncGroup)(t))}}})(k);t.app=function(e){return u.default.createElement(d.Provider,{store:I},u.default.createElement(_,{app:e}))};function E(e){var t;return"commentPanel "+(t={},(0,i.default)(t,m.PANEL_TYPE.preview,"commentPanel-preview"),(0,i.default)(t,m.PANEL_TYPE.focus,"commentPanel-focus"),t)[e]}},1843:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(3)),o=m(n(0)),r=m(n(1)),a=m(n(4)),s=m(n(5)),l=g(n(46)),c=m(n(308)),u=n(1691),d=n(1681),p=g(n(1716)),h=n(112),f=m(n(8));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"clearComments",value:function(){var e=this,t=this.props.anchorid;c.default.confirm({title:"\u6e05\u7a7a\u6279\u6ce8",content:"\u786e\u5b9a\u5220\u9664\u6b64\u5355\u5143\u683c\u4e0b\u7684\u6240\u6709\u6279\u6ce8\u5417\uff1f",onOk:function(){p.delComment({anchorid:t,commentid:"",delAll:!0}).then(function(t){t&&(e.props.delComment("",!0),(0,h.deleteCommentRange)()),f.default.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"clear_com"})})}})}},{key:"render",value:function(){var e=this.props,t=e.comments,n=e.type;return(0,d.getCommentsListLen)(t)>0&&n===u.PANEL_TYPE.focus&&(0,d.isPadOwner)()?l.createElement("div",{className:"comment-header"},l.createElement("span",{className:"clear-btn-box",onClick:this.clearComments.bind(this)},l.createElement("i",{className:"clear-icon"}),l.createElement("a",{className:"clear-btn"},"\u6e05\u7a7a\u6279\u6ce8"))):null}}]),t}(l.Component);t.default=v},1844:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(14)),o=m(n(3)),r=m(n(0)),a=m(n(1)),s=m(n(4)),l=m(n(5)),c=g(n(46)),u=g(n(123)),d=m(n(1845)),p=n(1691),h=n(1681),f=m(n(12));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(){(0,r.default)(this,t);var e=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).apply(this,arguments));return e.listRef=c.createRef(),e}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentWillReceiveProps",value:function(e){if(this.listRef.current){var t,n=(0,h.getCommentsListLen)(this.props.comments);(0,h.getCommentsListLen)(e.comments)>n&&0!==n&&(t=this.listRef.current)&&f.default.wait(50).run(function(){t.scrollTop=t.scrollHeight})}}},{key:"componentDidUpdate",value:function(){this.setScroller(this.props.editableId)}},{key:"setScroller",value:function(e){if(this.props.type===p.PANEL_TYPE.focus){var t=e,n=this.refs[t];if(!n)return;var i=u.findDOMNode(n),o=this.listRef.current;if(!i||!o)return;var r=i.offsetTop,a=i.offsetHeight,s=o.scrollTop;r+a-s>o.offsetHeight&&(o.scrollTop+=150),r-s<0&&(o.scrollTop-=150)}}},{key:"renderComment",value:function(e){var t=this.props.comments[e];return t?c.createElement(d.default,(0,i.default)({ref:t.id,key:t.id},this.props,t)):null}},{key:"renderList",value:function(){var e=this,t=this.props.comments,n=this.renderComment.bind(this),i=(0,h.getCommentsListLen)(t);return i<=3||this.props.type===p.PANEL_TYPE.focus?t&&t.map(function(t,n){return e.renderComment.call(e,n)}):[n(0),c.createElement("div",{className:"folded-tips",key:"fold-tap"},c.createElement("div",{className:"icon"},c.createElement("svg",{width:"7px",height:"6px",viewBox:"0 0 7 6",version:"1.1",xmlns:"http://www.w3.org/2000/svg"},c.createElement("title",null,"Group"),c.createElement("desc",null,"Created with Sketch."),c.createElement("g",{id:"Page-1",stroke:"none",strokeWidth:"1",fill:"none",fillRule:"evenodd"},c.createElement("g",{id:"\u6240\u6709\u5f39\u6846",transform:"translate(-1734.000000, -813.000000)"},c.createElement("g",{id:"Group",transform:"translate(1731.000000, 810.000000)"},c.createElement("g",{id:"Group-33",transform:"translate(3.000000, 4.000000)",stroke:"#979797",strokeWidth:"0.81"},c.createElement("polyline",{id:"Path-3-Copy-2",transform:"translate(3.167603, 3.647548) scale(1, -1) translate(-3.167603, -3.647548) ",points:"9.76996262e-15 4.4379534 3.16760254 2.85714286 6.33520508 4.4379534"}),c.createElement("polyline",{id:"Path-3-Copy-3",transform:"translate(3.167603, 0.790405) scale(1, -1) translate(-3.167603, -0.790405) ",points:"9.76996262e-15 1.58081055 3.16760254 3.99680289e-15 6.33520508 1.58081055"})),c.createElement("rect",{id:"Rectangle",x:"0",y:"0",width:"12",height:"12"}))))),"\u5df2\u6298\u53e0",i-3,"\u6761\u6279\u6ce8"),c.createElement("div",{className:"comment-item-bottom-border"})),n(i-2),n(i-1)]}},{key:"render",value:function(){return c.createElement("div",{className:"comment-list",ref:this.listRef},this.renderList())}}]),t}(c.Component);t.default=v},1845:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=b(n(47)),o=b(n(3)),r=b(n(0)),a=b(n(1)),s=b(n(4)),l=b(n(5)),c=n(46),u=b(c),d=b(n(308)),p=b(n(1746)),h=n(1691),f=n(1681),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(1716)),m=n(112),v=b(n(8));function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));n.highlightTimer=0,n.handleBlur=function(){n.setState({textFocus:!1})};var i=e.id,a=e.editableId,l=e.highlightCommentId;return n.state={textFocus:i===a,highlight:i===l},n.commentRef=(0,c.createRef)(),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"componentDidMount",value:function(){var e=this,t=this.commentRef.current,n=this.props,i=n.id,o=n.highlightCommentId;t&&i===o&&window.setTimeout(function(){t.scrollIntoView(),e.highlightTimer=window.setTimeout(function(){e.setState({highlight:!1})},3300)},0)}},{key:"componentWillUnmount",value:function(){0!==this.highlightTimer&&(this.highlightTimer=0,window.clearTimeout(this.highlightTimer))}},{key:"handleEditBtn",value:function(){this.props.updateEditor(this.props.id,this.props.content),this.setState({textFocus:!0}),v.default.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"edit_com"})}},{key:"handleDelBtn",value:function(){var e=this,t=this.props.anchorid,n=this.props.id;console.warn("before commentid: ",n),d.default.confirm({title:"\u5220\u9664\u6279\u6ce8",content:"\u786e\u5b9a\u5220\u9664\u6b64\u6761\u6279\u6ce8\u5417\uff1f",onOk:function(){g.delComment({anchorid:t,commentid:n}).then(function(t){t&&(e.props.delComment(n,!1),1===(0,f.getCommentsListLen)(e.props.comments)&&(0,m.deleteCommentRange)(),window.SpreadsheetApp.view.canvas.pluginsApi.cardCenter._updatePosition()),v.default.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"del_com"})})}})}},{key:"getCls",value:function(){if(!this.props.getEditable())return"comment-item";var e=["comment-item"];this.state.highlight&&e.push("highlight");var t=this.props;return t.id===t.editableId&&e.push("editing"),e.join(" ")}},{key:"renderBtnGroup",value:function(){var e=[];return(0,f.isMyComment)(this.props.uin)?e=[u.default.createElement("a",{key:"edit ",className:"comment-edit comment-btn",onClick:this.handleEditBtn.bind(this)},"\u7f16\u8f91"),u.default.createElement("a",{key:"del",className:"comment-del comment-btn",onClick:this.handleDelBtn.bind(this)},"\u5220\u9664")]:(0,f.isPadOwner)()&&(e=[u.default.createElement("a",{key:"del",className:"comment-del comment-btn",onClick:this.handleDelBtn.bind(this)},"\u5220\u9664")]),u.default.createElement("div",{className:"comment-btn-group"},e)}},{key:"render",value:function(){var e=this,t=this.props,n=t.id,o=t.editableId,r=t.userImg,a=t.nickName,s=t.content,l=t.times;return u.default.createElement("div",{className:this.getCls(),ref:this.commentRef},u.default.createElement("div",{className:"comment-user-info-wrap"},u.default.createElement("div",{className:"comment-user-info"},u.default.createElement("img",{className:"comment-user-info-img",src:r,alt:a}),u.default.createElement("span",{className:"comment-user-info-nickName"},(0,f.formatNickName)(a))),u.default.createElement("span",{className:"comment-user-info-times"},(0,f.formatTime)(l)),this.renderBtnGroup()),o===n?u.default.createElement(p.default,{getEditable:this.props.getEditable,onblur:this.handleBlur,focus:this.state.textFocus,editableId:o,comments:this.props.comments,defaultValue:s,textareaCancel:function(){e.props.updateEditor(h.EDITABLE_ID.top,"")},textareaConfirm:function(t){var n=t.content,r=e.props.anchorid;return r?g.editComment({anchorid:r,content:n,commentid:o}).then(function(t){e.props.editComment(t)}):new i.default(function(){})}.bind(this)}):u.default.createElement("p",{className:"comment-text "+(this.props.type===h.PANEL_TYPE.focus?"comment-text-expended":"comment-text-folded")},s||" "),u.default.createElement("div",{className:"comment-item-bottom-border"}))}}]),t}(u.default.Component);t.default=w},1846:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=c(n(3)),o=c(n(0)),r=c(n(1)),a=c(n(4)),s=c(n(5)),l=c(n(46));function c(e){return e&&e.__esModule?e:{default:e}}n(1847);var u=function(e){function t(){return(0,o.default)(this,t),(0,a.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"handleClick",value:function(e){if(this.props.enable){var t=this.props.onClick;t&&t(e)}}},{key:"render",value:function(){var e=this.props.loading?l.default.createElement("i",{className:"card-center-btn-loading-icon"}):this.props.children;return l.default.createElement("a",{tabIndex:this.props.tabIndex,className:d(this.props),onClick:this.handleClick.bind(this)},e)}}]),t}(l.default.Component);function d(e){var t="card-center-btn",n=e.enable;return e.loading&&(n=!1),e.private&&(t+=" card-center-btn-private"),e.className&&(t=t+" "+e.className),n||(t+=" card-center-btn-disabled"),e.loading&&(t+=" card-center-btn-loading"),t}u.defaultProps={enable:!0,loading:!1},t.default=u},1847:function(e,t,n){var i=n(1848);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1848:function(e,t,n){t=e.exports=n(36)(!1);var i=n(758)(n(1849));t.push([e.i,".card-center-btn {\n  display: inline-block;\n  width: 74px;\n  height: 28px;\n  line-height: 28px;\n  text-align: center;\n  font-size: 14px;\n  border: 1px solid #C3C8CC;\n  background-color: white;\n  color: #000;\n  border-radius: 2px;\n  cursor: pointer;\n  transition: background-color 0.3s ease-in;\n  position: relative;\n}\n.card-center-btn-disabled,\n.card-center-btn:disabled {\n  pointer-events: none!important;\n  background-color: #ebebeb !important;\n  border-color: #ebebeb !important;\n  color: #aaa !important;\n}\n.card-center-btn:hover {\n  background-color: #f6f6f6;\n  border: 1px solid #d0d3d6;\n}\n.card-center-btn:active {\n  background-color: #e9e9e9;\n  border: 1px solid #d0d3d6;\n}\n.card-center-btn-private {\n  border-color: #0188fb;\n  background-color: #0188fb;\n  color: #fff;\n}\n.card-center-btn-private:hover {\n  border-color: #1ea8ff;\n  background-color: #1ea8ff;\n}\n.card-center-btn-private:active {\n  border-color: #007eea;\n  background-color: #007eea;\n}\n.card-center-btn-loading-icon {\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  margin: -7px 0 0 -7px;\n  background: url("+i+") no-repeat center center;\n  display: inline-block;\n  width: 15px;\n  height: 15px;\n  background-size: 100%;\n  -webkit-animation: rotateAni 2s infinite linear;\n          animation: rotateAni 2s infinite linear;\n}\n@-webkit-keyframes rotateAni {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n  50% {\n    -webkit-transform: rotate(180deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n@keyframes rotateAni {\n  0% {\n    -webkit-transform: rotate(0deg);\n  }\n  50% {\n    -webkit-transform: rotate(180deg);\n  }\n  100% {\n    -webkit-transform: rotate(360deg);\n  }\n}\n",""])},1849:function(e,t){e.exports="//s2.url.cn/tim/docs/sheets/static/img/loading-btn-179acee7e8.png"},1850:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return(0,o.createStore)(a.default)};var i,o=n(1680),r=n(1851),a=(i=r)&&i.__esModule?i:{default:i}},1851:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=s(n(24)),o=s(n(14));t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:l,t=arguments[1],n=t.type,s=t.payload;switch(n){case a.SHOW:return(0,o.default)({},e,{visible:!0});case a.HIDE:return(0,o.default)({},l,{syncGroup:e.syncGroup});case a.SET_ANCHOR_ID:return(0,o.default)({},e,{anchorid:s.anchorid});case a.UPDATE_TYPE:if(s.type===e.type)return e;var c=(0,o.default)({},e,{type:s.type});return s.type===r.PANEL_TYPE.focus&&(c.editableId=r.EDITABLE_ID.top),(0,o.default)({},c);case a.UPDATE_EDITOR:return(0,o.default)({},e,{editableId:s.editableId});case a.UPDATE_COMMENTS:return(0,o.default)({},e,{comments:s.comments});case a.ADD_COMMENT:return(0,o.default)({},e,{comments:[].concat((0,i.default)(e.comments),[s.comment])});case a.DEL_COMMENT:if(s.delAll)return(0,o.default)({},e,{comments:[],visible:!1,editableId:r.EDITABLE_ID.top});var u=s.delAll?[]:e.comments.map(function(e){return e&&e.id===s.commentid?null:e});return(0,o.default)({},e,{comments:u});case a.EDIT_COMMENT:return(0,o.default)({},e,{comments:e.comments.map(function(e){return e&&e.id===s.newComment.id?s.newComment:e}),editableId:r.EDITABLE_ID.top});case a.SET_SYNC_GROUP:return(0,o.default)({},e,{syncGroup:s.syncGroup});case a.SET_HIGHLIGHT:return(0,o.default)({},e,{highlightCommentId:s.commentId})}return e};var r=n(1691),a=n(1747);function s(e){return e&&e.__esModule?e:{default:e}}var l={visible:!1,type:r.PANEL_TYPE.preview,comments:[],editableId:r.EDITABLE_ID.none,anchorid:"",syncGroup:!0,highlightCommentId:""}},1852:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(114)),o=p(n(0)),r=p(n(1)),a=p(n(47)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),l=n(123),c=n(1681),u=n(1745),d=p(n(1853));function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e,t,n,i){return new(n||(n=a.default))(function(o,r){function a(e){try{l(i.next(e))}catch(t){r(t)}}function s(e){try{l(i.throw(e))}catch(t){r(t)}}function l(e){e.done?o(e.value):new n(function(t){t(e.value)}).then(a,s)}l((i=i.apply(e,t||[])).next())})},f=function(){function e(t){var n=this;(0,o.default)(this,e),this.handleClick=function(){(0,u.setCommentPanelShow)(n.app,{showPanelCallback:function(){n.hide()}})},this.app=t.app,this.parent=t.parent,this.wrapper=document.createElement("div"),this.wrapper.id=e.WrapperId,t.wrap.appendChild(this.wrapper)}return(0,r.default)(e,[{key:"getVisible",value:function(){return"block"===this.wrapper.style.display}},{key:"handleContextMenu",value:function(){(0,u.setCommentPanelShow)(this.app,{autoFocus:!0}),this.parent._updatePosition()}},{key:"show",value:function(){return h(this,void 0,void 0,i.default.mark(function e(){var t,n,o,r;return i.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,u.queryAnchorId)(this.app)){e.next=4;break}return this.parent.hideAll(),e.abrupt("return");case 4:if(this.app.view.discuss){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,this.app.view.discuss.getComments(t);case 8:if(n=e.sent,o=(0,c.getCommentsListLen)(n),r=(0,u.queryAnchorId)(this.app),!this.app.view.discuss.isPanelShow("comment")){e.next=14;break}return this.app.view.discuss.switchCommentAnchor(r),e.abrupt("return");case 14:if(t===r&&(0,c.checkPanelShow)()){e.next=17;break}return this.parent.hideAll(),e.abrupt("return");case 17:return this.render(o),e.abrupt("return");case 19:case"end":return e.stop()}},e,this)}))}},{key:"hide",value:function(){this.wrapper.style.display="none"}},{key:"render",value:function(e){(0,l.render)(s.createElement(d.default,{count:e,onClick:this.handleClick}),this.wrapper),this.wrapper.style.display="block"}}]),e}();t.default=f,f.WrapperId="comment-mobile-wrapper"},1853:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46));n(1854);t.default=function(e){var t=e.count,n=e.onClick;return i.createElement("div",{className:"show-comment-list",onClick:n},"\u67e5\u770b\u6279\u6ce8",t?i.createElement(i.Fragment,null," ","(",i.createElement("span",{className:"count"},t),")"):null)}},1854:function(e,t,n){var i=n(1855);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1855:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".show-comment-list {\n  margin-top: 8px;\n  border-radius: 2px;\n  box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.18);\n  padding: 10px 12px;\n  background-color: #ffffff;\n  font-size: 15px;\n  line-height: 1;\n  color: #0188fd;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n}\n.show-comment-list .count {\n  font-weight: bold;\n}\n",""])},1856:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(0)),o=d(n(1)),r=n(125),a=d(n(46)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(123));n(1857);var l=d(n(1859)),c=n(1860),u=n(22);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){(0,i.default)(this,e),this.visible=!1,this.wrap=t.wrap,this.app=t.app,this.messages=[],u.isMobile?this.containerId="formula-error-card-container-m":this.containerId="formula-error-card-container"}return(0,o.default)(e,[{key:"show",value:function(e){this.yIndex=e.row,this.xIndex=e.col,this.isPluginWillShow(e)&&(this.messages.length>0?(this.visible=!0,this._render()):this.hide())}},{key:"hide",value:function(){this.visible=!1,this._render()}},{key:"getVisible",value:function(){return this.visible}},{key:"isPluginWillShow",value:function(e){var t=this._getTitleAndMessage(e.row,e.col),n=this.app.view.canvas.excel.inputCenter.board.showing,i=void 0;return i=u.isMobile?this.app.view.plugins.validationListPanel&&this.app.view.plugins.validationListPanel.isShowing:this.app.view.canvas.plugins.validationListCard&&this.app.view.canvas.plugins.validationListCard.isShowing,t.length>0&&!i&&!n&&(this.messages=t,!0)}},{key:"_render",value:function(){if(this.wrap){var e=this.wrap.querySelector("#"+this.containerId);e||((e=document.createElement("div")).id=this.containerId,this.wrap.appendChild(e)),s&&s.render(a.default.createElement(l.default,{messages:this.messages,visible:this.visible}),e)}else console.error("Formula Error wrap is null")}},{key:"_getTitleAndMessage",value:function(e,t){var n=[],i=this.app.spreadsheet.activeSheet.getCellDataAtPosition(e,t),o=i&&(0,r.getCellAttachInfo)(i);if(o){var a=o.formulaError,s=o.dvError,l=o.dvInputMsg;if(u.isMobile||a&&a.message&&a.title&&n.push({content:a.message,title:a.title,type:c.MESSAGE_TYPE.ERROR}),l){var d=l.message;d.slice&&"$"===d.slice(0,1)&&(d=d.slice(1)),n.push({content:d,title:l.title,type:c.MESSAGE_TYPE.WARN})}else s&&s.message&&s.title&&n.push({content:s.message,title:s.title,type:c.MESSAGE_TYPE.ERROR})}return n}}]),e}();t.default=p},1857:function(e,t,n){var i=n(1858);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1858:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".formula-error-card {\n  display: block;\n  width: 280px;\n  font-size: 14px;\n  background-color: #fff;\n  border: 0 none;\n  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.14);\n  padding: 14px 14px 14px 14px;\n  word-break: break-all;\n  order: 1;\n  margin-bottom: 8px;\n  box-sizing: border-box;\n}\n.formula-error-card:hover {\n  box-shadow: 0 0 6px 0 rgba(0, 0, 0, 0.2);\n}\n.formula-error-title {\n  font-size: 14px;\n  display: inline;\n}\n.title-error-style {\n  color: #f72626;\n}\n.title-warn-style {\n  color: #F5A623;\n}\n.formula-error-content {\n  color: #000;\n  margin: 0;\n}\n.formula-error-card-container-m .formula-error-card {\n  width: 208px;\n  font-size: 13px;\n  padding: 12px 13px 12px 13px;\n}\n.formula-error-card-container-m .formula-error-title {\n  font-size: 13px;\n}\n",""])},1859:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46));t.default=function(e){var t=e.visible,n=t?e.messages:[];return i.createElement("div",{style:{display:t?"block":"none"}},n.map(function(e,t){var o="formula-error-title title-"+e.type+"-style";return i.createElement("div",{className:"formula-error-card",key:e.title+e.content,style:{marginTop:t>0&&n.length>1?8:0}},i.createElement("span",{className:o},e.title+"\uff1a"),i.createElement("span",{className:"formula-error-content"},e.content))}))}},1860:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=t.MESSAGE_TYPE=void 0;!function(e){e.NORMAL="normal",e.WARN="warn",e.ERROR="error"}(i||(t.MESSAGE_TYPE=i={}))},1861:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(0)),o=u(n(1)),r=u(n(46)),a=u(n(123)),s=u(n(1862)),l=n(10),c=u(n(8));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,i.default)(this,e),this.parent=t.parent,this.mouseMoveTimer=-1,this._render(t.wrap),this.initEvent()}return(0,o.default)(e,[{key:"initEvent",value:function(){var e=this.parent.stage;e.event.eventTable.listen("tableMove",this.hide.bind(this)),e.event.eventSelection.listen("selectionChange",this.hideHoverBox.bind(this)),e.event.eventTable.listen("enterInputStatus",this.hideHoverBox.bind(this)),e.event.eventTable.listen("clearTable",this.hide.bind(this))}},{key:"onMouseDown",value:function(e){var t=this.parent.stage;if(t.configData.permissions){var n=t.tableData.getCellDataAtPosition(e.y,e.x,l.GET_CELLDATA.DEFAULT);n&&n.link&&(clearTimeout(this.mouseMoveTimer),this.showHoverBox())}else this.linkObj&&this.linkObj.openUrlReadOnly()}},{key:"onMouseMove",value:function(e){var t=this,n=this.parent.stage,i=e.newCell;n.mouseData;if(i.x>=0&&i.y>=0){var o=n.tableData.getCellDataAtPosition(i.y,i.x,l.GET_CELLDATA.DEFAULT);n.configData.permissions&&(clearTimeout(this.mouseMoveTimer),o.link?this.mouseMoveTimer=window.setTimeout(function(){t.showHoverBox()},300):this.isHoverShow()&&(this.mouseMoveTimer=window.setTimeout(function(){t.hideHoverBox()},300)))}}},{key:"onScale",value:function(){this.getVisible()&&(this.isModifyShow()?(this.hideModifyBox(),this.showModifyBox()):(this.showModifyBox(),this.showHoverBox()))}},{key:"showHoverBox",value:function(){this.linkObj&&this.linkObj.showHoverBox()}},{key:"showModifyBox",value:function(){this.linkObj&&this.linkObj.showModifyBox()}},{key:"hide",value:function(){this.linkObj&&this.linkObj.state.visible&&this.linkObj.hide()}},{key:"hideHoverBox",value:function(){this.linkObj&&this.linkObj.state.visible&&!this.linkObj.state.modify&&this.linkObj.hide()}},{key:"hideModifyBox",value:function(){this.linkObj&&this.linkObj.state.visible&&this.linkObj.state.modify&&this.linkObj.hide()}},{key:"addLink",value:function(){this.linkObj&&(this.hide(),this.linkObj.showModifyBox())}},{key:"getVisible",value:function(){return!!this.linkObj&&this.linkObj.state.visible}},{key:"inHoverBox",value:function(e,t){return!(this.linkObj.state.modify||!this.linkObj.state.visible)&&(this.linkObj.hoverBox&&this.linkObj.hoverBox.inHoverBox(e,t))}},{key:"isModifyShow",value:function(){return this.getVisible()&&this.linkObj.state.modify}},{key:"isHoverShow",value:function(){return this.getVisible()&&!this.linkObj.state.modify}},{key:"_render",value:function(e){var t=this,n=document.createElement("div");n.className="link-wrap pc",e.appendChild(n),n.addEventListener("mousemove",function(e){clearTimeout(t.mouseMoveTimer),e.stopPropagation()});try{a.default.render(r.default.createElement(s.default,{ref:function(e){t.linkObj=e},stage:this.parent.stage}),n)}catch(i){c.default.monitor(34235871)}}}]),e}();t.default=d},1862:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=f(n(3)),o=f(n(0)),r=f(n(1)),a=f(n(4)),s=f(n(5)),l=f(n(46)),c=f(n(1863)),u=f(n(1864)),d=n(10),p=n(1749),h=f(n(8));function f(e){return e&&e.__esModule?e:{default:e}}n(1865);var g=function(e){function t(){(0,o.default)(this,t);var e=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).apply(this,arguments));return e.cellX=-1,e.cellY=-1,e.state={visible:!1,modify:!1,url:"",text:"",position:{x:0,y:0,width:0,height:0}},e.hide=function(){e.setState({visible:!1})},e.getCellXY=function(){var t=e.props.stage,n=t.areaData.col.getIndex(t.mouseData.currX),i=t.areaData.row.getIndex(t.mouseData.currY),o=t.tableData.getCellDataAtPosition(i,n,d.GET_CELLDATA.DEFAULT);return o.parent&&o.parent.mergeData&&(n=o.parent.mergeData.xRange[0],i=o.parent.mergeData.yRange[0]),{xIndex:n,yIndex:i}},e.clearLink=function(){e.props.stage.hookFunc.setLink&&e.props.stage.hookFunc.setLink({x:e.cellX,y:e.cellY,value:e.value,url:"",lastValue:e.value,lastUrl:e.url,type:"clean"}),e.hide(),e.props.stage.focusInput()},e.showModify=function(){var t=e.props.stage;e._showModifyBox(),t.event.eventMenu.trigger("tableMenuHide"),t.event.eventLink.trigger("linkModifyBoxShow")},e.doInsertLink=function(t,n){var i={x:e.cellX,y:e.cellY,url:n,value:t,lastUrl:e.url,lastValue:e.value,type:e.cell.link?"set":"insert"};e.props.stage.hookFunc.setLink&&e.props.stage.hookFunc.setLink(i),t!==e.value&&h.default.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_text"}),n!==e.url&&h.default.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url"}),e.hide(),e.props.stage.focusInput()},e.openUrl=function(){e.props.stage.configData.openUrl(e.url)},e.stopPropagation=function(e){e.nativeEvent.stopImmediatePropagation()},e}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){}},{key:"hideOtherPanel",value:function(){window.SpreadsheetApp.view.plugins.searchReplacePanel&&window.SpreadsheetApp.view.plugins.searchReplacePanel.close&&window.SpreadsheetApp.view.plugins.searchReplacePanel.close(),window.SpreadsheetApp.view.canvas.pluginsApi.cardCenter.hideAll()}},{key:"showHoverBox",value:function(e){if(!e){var t=this.getCellXY(),n=t.xIndex,i=t.yIndex;n===this.cellX&&i===this.cellY||this.hide(),this.updateCurrInfo(n,i)}this.setState({visible:!0,render:!1,url:this.url,text:this.value,modify:!1})}},{key:"showHoverBoxBySelection",value:function(){var e=this.getActiveXY(),t=e.xIndex,n=e.yIndex;this.updateCurrInfo(t,n),this.setState({visible:!0,render:!1,url:this.url,text:this.value,modify:!1})}},{key:"_showModifyBox",value:function(){this.hideOtherPanel(),this.setState({visible:!0,render:!0,url:this.url,text:this.value,modify:!0})}},{key:"showModifyBox",value:function(){var e=this.getActiveXY(),t=e.xIndex,n=e.yIndex;this.updateCurrInfo(t,n),this.hideOtherPanel(),this.setState({visible:!0,render:!0,url:this.url,text:this.value,modify:!0})}},{key:"updateCurrInfo",value:function(e,t){var n=this.props.stage;this.cell=null,this.cellX=e,this.cellY=t,this.url="",this.value="";var i=n.tableData.getCellDataAtPosition(t,e,d.GET_CELLDATA.DEFAULT);if(i.merged&&(i=i.parent),i.link){var o=i.link;this.url=(0,p.safeStr)(o.url),this.value=o.text}else this.value=n.hookFunc.__linkModify&&n.hookFunc.__linkModify(this.cellY,this.cellX)||"";this.cell=i}},{key:"getActiveXY",value:function(){var e=this.props.stage.selectData.active;return{xIndex:e.xIndex,yIndex:e.yIndex}}},{key:"openUrlReadOnly",value:function(){var e=this,t=this.getCellXY(),n=t.xIndex,i=t.yIndex;this.updateCurrInfo(n,i),this.cell&&this.cell.link&&setTimeout(function(){e.openUrl()},100)}},{key:"render",value:function(){var e=this,t={display:this.state.visible?"block":"none"},n=this.state,i=n.url,o=n.text;if(this.cellX<0&&this.cellY<0||!this.state.visible)return null;var r=this.state.modify?l.default.createElement(c.default,{stage:this.props.stage,cellX:this.cellX,cellY:this.cellY,text:o,url:i,doCancel:this.hide,doInsertLink:this.doInsertLink}):l.default.createElement(u.default,{ref:function(t){return e.hoverBox=t},stage:this.props.stage,cellX:this.cellX,cellY:this.cellY,text:o,url:i,clearLink:this.clearLink,modifyLink:this.showModify,openUrl:this.openUrl});return l.default.createElement("div",{className:"link-card",style:t,onClick:this.stopPropagation,onDoubleClick:this.stopPropagation},r)}}]),t}(l.default.Component);t.default=g},1863:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(3)),o=p(n(0)),r=p(n(1)),a=p(n(4)),s=p(n(5)),l=p(n(46)),c=p(n(142)),u=n(21),d=n(250);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));n.state={textValue:"",urlValue:"",showWarning:!1},n.getPositionForModify=function(){var e=n.props.stage,t=e.cells.getRealPosition(n.props.cellX,n.props.cellY),i=(0,u.findPosition)({left:t.posX[0],top:t.posY[0],width:t.posX[1]-t.posX[0],height:t.posY[1]-t.posY[0]},{width:388,height:202},{x:{min:e.configData.rowHeadWidth,max:e.width},y:{min:e.configData.colHeadHeight,max:e.height}},{yPriority:1}),o={};return i.yDir&&i.yDir>0?(i.top+=8,o.arrowClass="top"):(i.top+=8,o.arrowClass="bottom"),o.arrowLeft=100*i.xArrow+"%",o.left=i.left-e.configData.rowHeadWidth+"px",o.top=i.top-e.configData.colHeadHeight+"px",o},n.keydownApply=function(e){13===e.keyCode&&n.doApply()},n.handleTextChange=function(e){n.setState({textValue:e.target.value})},n.handleUrlChange=function(e){n.setState({urlValue:e.target.value,showWarning:e.target.value.length<=0})},n.doApply=function(){var e=n.state.urlValue;if(0!==e.length){var t=void 0;"string"===typeof e&&(e=e.trim(),t=(0,d.parseLinkUrl)(e,!0)),t?(n._hideWarnning(),n.props.doInsertLink(n.isMultiline?n.props.text:n.state.textValue,e)):n._showWarnning()}},n.cancel=function(){n.props.doCancel()},n.state={textValue:e.text,urlValue:e.url,showWarning:!1};var r=String.fromCharCode(10);return e.text.indexOf(r)>=0?(n.isMultiline=!0,n.state.textValue="\u9009\u533a\u5185\u6d89\u53ca\u6362\u884c\u6587\u672c\uff0c\u4fee\u6539\u4f1a\u5bfc\u81f4\u6362\u884c\u4e22\u5931\u3002"):n.isMultiline=!1,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){""===this.state.textValue||null===this.state.textValue?this.textInput&&this.textInput.focus():(this.linkInput&&this.linkInput.select(),this.linkInput&&this.linkInput.focus()),document.addEventListener("keydown",this.keydownApply)}},{key:"componentWillUnmount",value:function(){document.removeEventListener("keydown",this.keydownApply)}},{key:"_checkProtocolHeader",value:function(e){return/^(https?|ftp|file)\:\/\//i.test(e)||(e=/^(\/\/)/.test(e)?"http:"+e:"http://"+e),e}},{key:"_hideWarnning",value:function(){this.setState({showWarning:!1})}},{key:"_showWarnning",value:function(){this.setState({showWarning:!0})}},{key:"render",value:function(){var e=this,t=this.getPositionForModify(),n={left:t.left,top:t.top},i=(0,c.default)({"link-modify-warnning":!0,show:this.state.showWarning}),o=(0,c.default)({"link-modify-button":!0,"link-modify-valid":this.state.urlValue.length>0}),r=(0,c.default)({"link-modify-input":!0,"link-input":!0,"link-modify-input-warn":this.state.showWarning}),a=(0,c.default)({"link-arrow":!0,top:"top"===t.arrowClass,bottom:"bottom"===t.arrowClass}),s={left:t.arrowLeft};l.default.createElement("div",{className:"link-modify-header"},l.default.createElement("div",{className:"link-modify-header-text",onClick:this.cancel},"\u53d6\u6d88"),l.default.createElement("div",{className:"link-modify-header-btn",onClick:this.doApply},"\u5b8c\u6210"));return l.default.createElement("div",{className:"link-modify-wrap ",style:n},l.default.createElement("div",{className:a,style:s}),l.default.createElement("div",{className:"link-modify-content"},!1,!1,l.default.createElement("div",{className:"link-modify-line"},l.default.createElement("label",{className:"link-modify-title"},"\u6587\u672c"),l.default.createElement("input",{ref:function(t){return e.textInput=t},className:"link-modify-input",type:"text",value:this.state.textValue,onChange:this.handleTextChange,disabled:this.isMultiline})),l.default.createElement("div",{className:"link-modify-line"},l.default.createElement("label",{className:"link-modify-title"},"\u94fe\u63a5"),l.default.createElement("input",{ref:function(t){return e.linkInput=t},className:r,type:"text",placeholder:"\u8bf7\u8f93\u5165\u7f51\u9875\u94fe\u63a5\u5730\u5740",value:this.state.urlValue,onChange:this.handleUrlChange})),l.default.createElement("div",{className:i},"\u8bf7\u8f93\u5165\u6709\u6548\u7684\u94fe\u63a5"),l.default.createElement("div",{className:o,onClick:this.doApply},"\u5e94\u7528")))}}]),t}(l.default.Component);t.default=h},1864:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=p(n(3)),o=p(n(0)),r=p(n(1)),a=p(n(4)),s=p(n(5)),l=p(n(46)),c=n(1749),u=p(n(142)),d=n(21);function p(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.getPositionForHover=function(e){var t=n.props.stage,i=t.configData,o=t.cells.getRealPosition(n.props.cellX,n.props.cellY),r=o.posX[0]-i.rowHeadWidth,a=void 0,s=o.posY[0]-i.colHeadHeight-5,l=o.posY[1]-i.colHeadHeight-5,c="";r<5&&(r=5);var u=e.getBoundingClientRect().width;return r+u+i.rowHeadWidth+20>i.tableWidth&&(r=i.tableWidth-u-i.rowHeadWidth-20),s<50?(a=l,a+=0,c="at-top"):(a=s-33,a-=0),{x:r,y:a,width:u,height:e.getBoundingClientRect().height,arrowClass:c,arrowLeft:""}},n.getPositionForHoverM=function(e){var t=n.props.stage,i=t.cells.getRealPosition(n.props.cellX,n.props.cellY),o=(0,d.findPosition)({left:i.posX[0],top:i.posY[0],width:i.posX[1]-i.posX[0],height:i.posY[1]-i.posY[0]},{width:200,height:35},{x:{min:t.configData.rowHeadWidth,max:t.width},y:{min:t.configData.colHeadHeight,max:t.height}},{yPriority:-1,sourceXPoint:[0],targetXPoint:[0,.5,1]});return o.left=o.left-t.configData.rowHeadWidth,o.top=o.top-t.configData.colHeadHeight,{x:o.left,y:o.top}},n.refCallback=function(e){n.elementRef=e},n.state={visiable:!1,position:{x:0,y:0,width:0,height:0,arrowLeft:"",arrowClass:""}},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.updatePosition()}},{key:"componentDidUpdate",value:function(){this.updatePosition()}},{key:"inHoverBox",value:function(e,t){var n=this.props.stage.configData;return e-=n.rowHeadWidth,t-=n.colHeadHeight,e>=this.state.position.x&&e<=this.state.position.x+this.state.position.width&&t>=this.state.position.y&&t<=this.state.position.y+this.state.position.height}},{key:"updatePosition",value:function(){if(!this.state.visiable){var e=this.getPositionForHover(this.elementRef);this.setState({visiable:!0,position:e})}}},{key:"render",value:function(){var e=this,t=this.props,n=t.url,i=t.text;i.length||(i=n),n=(0,c.filterProtocol)(n);var o=(0,u.default)({"link-box-inner":!0,ipad:!1}),r={};return this.state.visiable?(r.visibility="visible",r.left=this.state.position.x+"px",r.top=this.state.position.y+"px"):r.visibility="hidden",l.default.createElement("div",{className:"link-box",style:r,ref:this.refCallback},l.default.createElement("div",{className:o},!1,l.default.createElement("span",{className:"link-content",onClick:function(){return e.props.openUrl()}},n),l.default.createElement("span",{className:"link-cancel",onClick:function(){return e.props.clearLink()}},"\u53d6\u6d88\u94fe\u63a5"),l.default.createElement("span",{className:"link-modify",onClick:function(){return e.props.modifyLink()}},"\u4fee\u6539")))}}]),t}(l.default.Component);t.default=h},1865:function(e,t,n){var i=n(1866);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1866:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".link-wrap.pc,\n.link-wrap.ipad {\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n}\n.link-wrap.pc .link-card,\n.link-wrap.ipad .link-card {\n  position: absolute;\n}\n.link-wrap.pc .link-box,\n.link-wrap.ipad .link-box {\n  height: 33px;\n  line-height: 33px;\n  padding: 5px 0px;\n  z-index: 104;\n  position: absolute;\n}\n.link-wrap.pc .link-box-inner,\n.link-wrap.ipad .link-box-inner {\n  height: 33px;\n  line-height: 33px;\n  font-size: 14px;\n  background-color: #ffffff;\n  color: #018ffb;\n  overflow: hidden;\n  white-space: nowrap;\n  box-sizing: border-box;\n  box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.3);\n  /* position: absolute; */\n  /* z-index: 104; */\n  /* display: none; */\n}\n.link-wrap.pc .link-box-inner.ipad,\n.link-wrap.ipad .link-box-inner.ipad {\n  height: 40px;\n  line-height: 40px;\n  overflow: visible;\n  position: relative;\n  border-radius: 4px;\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.16);\n  border: solid 1px #e5e5e5;\n}\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow {\n  position: absolute;\n  width: 0;\n  height: 100%;\n  z-index: 1;\n}\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow.at-top,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow.at-top {\n  transform: rotate(180deg);\n  -moz-transform: rotate(180deg);\n  -webkit-transform: rotate(180deg);\n}\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow:after,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow:after,\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow:before,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow:before {\n  content: '';\n  display: block;\n  position: absolute;\n  left: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n}\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow:after,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow:after {\n  bottom: -17px;\n  border-color: #fff transparent transparent transparent;\n  border-width: 8px 10px 10px 10px;\n}\n.link-wrap.pc .link-box-inner.ipad .link-box-inner-arrow:before,\n.link-wrap.ipad .link-box-inner.ipad .link-box-inner-arrow:before {\n  bottom: -18px;\n  border-color: #e5e5e5 transparent transparent transparent;\n  border-width: 8px 10px 10px 10px;\n}\n.link-wrap.pc .link-content,\n.link-wrap.ipad .link-content {\n  position: relative;\n  z-index: 2;\n  display: inline-block;\n  margin-left: 12px;\n  max-width: 230px;\n  text-overflow: ellipsis;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  tap-highlight-color: rgba(0, 0, 0, 0);\n  cursor: pointer;\n}\n.link-wrap.pc .link-cancel,\n.link-wrap.ipad .link-cancel {\n  position: relative;\n  z-index: 2;\n  margin-left: 20px;\n  display: inline-block;\n  vertical-align: top;\n  cursor: pointer;\n  font-size: 12px;\n}\n.link-wrap.pc .link-modify,\n.link-wrap.ipad .link-modify {\n  position: relative;\n  z-index: 2;\n  margin-left: 12px;\n  margin-right: 12px;\n  display: inline-block;\n  vertical-align: top;\n  cursor: pointer;\n  font-size: 12px;\n}\n.link-wrap.pc .link-cell,\n.link-wrap.ipad .link-cell {\n  cursor: pointer;\n}\n.link-wrap.mobile {\n  position: absolute;\n  top: 0;\n  left: 0;\n  pointer-events: auto;\n}\n.link-wrap.mobile .link-box {\n  position: absolute;\n}\n.link-wrap.mobile .link-content {\n  height: 33px;\n  line-height: 33px;\n  padding: 0 10px;\n  box-sizing: border-box;\n  box-shadow: 0 0 3px 0 rgba(0, 0, 0, 0.3);\n  max-width: 200px;\n  font-size: 13px;\n  background-color: #ffffff;\n  color: #00a4ff;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  position: absolute;\n  z-index: 104;\n  -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n  tap-highlight-color: rgba(0, 0, 0, 0);\n  border-radius: 1px;\n}\n.link-modify-wrap {\n  box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);\n  border: 1px solid #f0f0f0;\n  background-color: #fff;\n  min-width: 386px;\n  min-height: 200px;\n  position: absolute;\n  font-size: 14px;\n  z-index: 104;\n  border-radius: 2px;\n}\n.link-arrow {\n  position: absolute;\n  width: 100%;\n  height: 100%;\n  z-index: 1;\n}\n/* \u5411\u4e0a\u7684\u5e26 border \u7684\u4e09\u89d2\u5f62 */\n.link-arrow.top:after,\n.link-arrow.top:before,\n.link-arrow.bottom:after,\n.link-arrow.bottom:before {\n  content: '';\n  display: block;\n  position: absolute;\n  left: 0;\n  width: 0;\n  height: 0;\n  border-style: solid;\n}\n.link-arrow.top:after {\n  top: -17px;\n  border-color: transparent transparent #fff transparent;\n  border-width: 10px 10px 8px 10px;\n}\n.link-arrow.top:before {\n  top: -18px;\n  border-color: transparent transparent #e5e5e5 transparent;\n  border-width: 10px 10px 8px 10px;\n}\n/* \u5411\u4e0b\u7684\u5e26 border \u7684\u4e09\u89d2\u5f62 */\n.link-arrow.bottom:after {\n  bottom: -17px;\n  border-color: #fff transparent transparent transparent;\n  border-width: 8px 10px 10px 10px;\n}\n.link-arrow.bottom:before {\n  bottom: -18px;\n  border-color: #e5e5e5 transparent transparent transparent;\n  border-width: 8px 10px 10px 10px;\n}\n.link-modify-content {\n  padding: 18px 24px 0px 24px;\n  overflow: hidden;\n  position: relative;\n  z-index: 2;\n}\n.link-modify-line {\n  padding-top: 18px;\n  height: 30px;\n}\n.link-modify-title {\n  font-size: 14px;\n  height: 16px;\n  line-height: 16px;\n  padding: 7px 0;\n  color: #333333;\n  margin-right: 12px;\n}\n.link-modify-input {\n  width: 280px;\n  height: 26px;\n  border: 1px solid #d9d9d9;\n  font-size: 12px;\n  padding: 1px 8px;\n  outline: none;\n  -webkit-user-select: auto;\n  -moz-user-select: auto;\n   -ms-user-select: auto;\n       user-select: auto;\n}\n.link-modify-input:focus {\n  border-color: #4d90fe;\n}\n.link-modify-input-warn {\n  border-color: #ef4e2f;\n}\n.link-modify-warnning {\n  color: #ef4e2f;\n  font-size: 12px;\n  margin-top: 10px;\n  visibility: hidden;\n}\n.link-modify-warnning.show {\n  visibility: visible;\n}\n.link-modify-button {\n  width: 76px;\n  height: 30px;\n  float: right;\n  text-align: center;\n  color: white;\n  background: #4d90fe;\n  border-radius: 2px;\n  line-height: 30px;\n  background-color: #ebebeb;\n  color: #aaa;\n  cursor: auto;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n   -ms-user-select: none;\n       user-select: none;\n}\n.link-modify-valid {\n  background-color: #388cf5;\n  color: #fff;\n  cursor: pointer;\n}\n/******************** pad \u7aef\u72ec\u6709\u6837\u5f0f  *******************/\n.link-modify-wrap.ipad {\n  box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.16);\n  border: solid 0.5px #e5e5e5;\n  border-radius: 6px;\n}\n.link-modify-wrap.ipad .link-modify-content {\n  padding: 0 17px 17px 17px;\n}\n.link-modify-wrap.ipad .link-modify-line {\n  padding-top: unset;\n  height: unset;\n  margin-top: 16px;\n}\n.link-modify-wrap.ipad .link-modify-title {\n  font-size: 16px;\n}\n.link-modify-wrap.ipad .link-modify-input {\n  width: 290px;\n  height: 30px;\n  border: solid 1px #e5e5e5;\n  border-radius: 2px;\n  font-size: 15px;\n}\n.link-modify-wrap.ipad .link-modify-input.link-input {\n  color: #0188fb;\n}\n.link-modify-wrap.ipad .link-modify-input.link-input:focus {\n  color: #0188fb;\n}\n.link-modify-wrap.ipad .link-modify-input:focus {\n  border-color: #0086ff;\n}\n.link-modify-wrap.ipad .link-modify-input-warn {\n  border-color: #ef4e2f !important;\n  color: #ef4e2f !important;\n}\n.link-modify-wrap.ipad .link-modify-header {\n  height: 40px;\n  line-height: 40px;\n  width: 100%;\n}\n.link-modify-wrap.ipad .link-modify-warnning {\n  margin-top: 12px;\n  margin-left: 44px;\n}\n.link-modify-wrap.ipad .link-modify-header-text {\n  display: inline-block;\n  font-size: 16px;\n  cursor: pointer;\n}\n.link-modify-wrap.ipad .link-modify-header-text:hover {\n  opacity: 0.8;\n}\n.link-modify-wrap.ipad .link-modify-header-btn {\n  display: inline-block;\n  float: right;\n  background-color: transparent;\n  color: #0188fb;\n  font-size: 16px;\n}\n.link-modify-wrap.ipad .link-modify-header-btn:hover {\n  opacity: 0.8;\n}\n.link-modify-wrap.ipad .link-modify-split {\n  height: 1px;\n  border: none;\n  padding: 0;\n  margin: 0;\n  background: rgba(0, 0, 0, 0.06);\n  position: relative;\n  -webkit-transform: scaleX(2);\n          transform: scaleX(2);\n}\n@media (-webkit-min-device-pixel-ratio: 1.5), (min-device-pixel-ratio: 1.5) {\n  .link-modify-wrap.ipad .link-modify-split {\n    -webkit-transform: scaleY(0.7) scaleX(2);\n            transform: scaleY(0.7) scaleX(2);\n  }\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {\n  .link-modify-wrap.ipad .link-modify-split {\n    -webkit-transform: scaleY(0.5) scaleX(2);\n            transform: scaleY(0.5) scaleX(2);\n  }\n}\n",""])},1867:function(e,t,n){"use strict";function i(e,t,n,i,o){var r=t.width*o*n,a=t.width*o*(1-n);return void 0!==n&&(!(e-r<i.min)&&!(e+a>i.max))}function o(e,t,n){return e-t>=n}function r(e,t,n){return e+t<=n}Object.defineProperty(t,"__esModule",{value:!0}),e.exports&&(e.exports=function(e,t,n,a){var s=void 0,l=void 0,c=void 0,u=void 0,d=void 0;void 0===a.sourceXPoint&&(a.sourceXPoint=[.5]),void 0===a.targetXPoint&&(a.targetXPoint=[.2,.3,.4,.5,.6,.7,.8]),void 0===a.scale&&(a.scale=1);for(var p=!1,h=a.sourceXPoint[0],f=void 0,g=-1,m=e.left+h*e.width;!p&&g<=a.targetXPoint.length;)g++,p=i(m,t,f=a.targetXPoint[g],n.x,a.scale);return p?(d=f,s=e.left+e.width*a.sourceXPoint[0]-f*t.width,u=0):h>.8?e.left+e.width>=n.x.max?(s=n.x.max-t.width,d=.8,u=1):(s=n.x.min,d=.2,u=-1):h<.2?e.left<=n.x.min?(s=n.x.min,d=.2,u=-1):(s=n.x.max-t.width,d=.8,u=1):Math.abs(e.left)-n.x.min<n.x.max-Math.abs(e.left)?(s=n.x.min,d=.2,u=-1):(s=n.x.max-t.width,d=.8,u=1),void 0===a.yPriority&&(a.yPriority=-1),p=!1,a.yPriority<0&&((p=o(e.top,t.height,n.y.min))?(l=e.top-t.height-4,c=-1):(p=r(e.top+e.height,t.height,n.y.max))?(l=e.top+e.height+4,c=1):e.top>n.y.max/2?(l=e.top-t.height-4,c=-1):(l=e.top+e.height+4,c=1)),a.yPriority>0&&((p=r(e.top+e.height,t.height,n.y.max))?(l=e.top+e.height+4,c=1):(p=o(e.top,t.height,n.y.min))?(l=e.top-t.height-4,c=-1):e.top>n.y.max/2?(l=e.top-t.height-4,c=-1):(l=e.top+e.height+4,c=1)),{left:s,top:l,yDir:c,xDir:u,xArrow:d}})},1868:function(e,t,n){var i=n(1869);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1869:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,"#card-center {\n  position: absolute;\n  display: flex;\n  flex-flow: column nowrap;\n  z-index: 104;\n  pointer-events: auto;\n}\n.formula-error-card-container {\n  order: 1;\n  margin-bottom: 8px;\n}\n#commentPanel-container {\n  order: 2;\n}\n",""])},1870:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=h(n(3)),r=h(n(0)),a=h(n(1)),s=h(n(4)),l=h(n(5)),c=h(n(243)),u=h(n(62)),d=h(n(173)),p=n(125);function h(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.LEFT_TOP=0]="LEFT_TOP",e[e.RIGHT_TOP=1]="RIGHT_TOP",e[e.LEFT_BOTTOM=2]="LEFT_BOTTOM",e[e.RIGHT_BOTTOM=3]="RIGHT_BOTTOM"}(i||(i={}));var f="#0188FB",g=(i.RIGHT_TOP,"#ff4419"),m=(i.LEFT_TOP,function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{alloyExcel:e.excel}));return n.reRender=function(){n.stage.render()},n.renderSubscript=function(e){var t=n.stage.areaData,i=n.getSheet();if(void 0!==i.data){var o=i.data.rowData,r=void 0,a=void 0,s=void 0;for(r=t.row.frozen.from;r<=t.row.frozen.to;r++)if(o[r]){for(a=t.col.frozen.from;a<=t.col.frozen.to;a++)(s=o[r].values[a])&&n.render(s,r,a,e,t.row.frozen,t.col.frozen);for(a=t.col.flow.from;a<=t.col.flow.to;a++)(s=o[r].values[a])&&n.render(s,r,a,e,t.row.frozen,t.col.flow)}for(r=t.row.flow.from;r<=t.row.flow.to;r++)if(o[r]){for(a=t.col.frozen.from;a<=t.col.frozen.to;a++)(s=o[r].values[a])&&n.render(s,r,a,e,t.row.flow,t.col.frozen);for(a=t.col.flow.from;a<=t.col.flow.to;a++)(s=o[r].values[a])&&n.render(s,r,a,e,t.row.flow,t.col.flow)}}},n.app=e.spreadsheetApp,n.cache={},n.getSheet=e.getSheet,n.addHook("afterRender",n.renderSubscript),n.stage.render(),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"render",value:function(e,t,n,i,o,r){var a=void 0,s=void 0,l=this.getSheet();if(void 0!==l.data){var c=l.data,h=c.rowMetadata[t],m=c.columnMetadata[n];if(!(h&&(h.hiddenByUser||h.hiddenByFilter)||m&&(m.hiddenByUser||m.hiddenByFilter))){var v,b=void 0;if(v=e.getSheetRange())for(b=0;b<v.length;b++)if(v[b].type===d.default.COMMENT_RANGE){var w=this.stage.tableData.getCellBackgroundWidth(t,n,!1);a=this.stage.areaData.col.getViewportLeft(n)+w-this.subscriptSize,s=this.stage.areaData.row.getViewportTop(t);var A=this.stage.areaData.col.getArea(n),y=this.stage.areaData.row.getArea(t);if(a>A.maxDistance||a+this.subscriptSize<A.viewStart)continue;if(s>y.maxDistance||s+this.subscriptSize<y.viewStart)continue;i.save(),i.beginPath(),i.rect(Math.max(a,A.viewStart),Math.max(s,y.viewStart),Math.min(A.maxDistance-a,this.subscriptSize),Math.min(y.maxDistance-s,this.subscriptSize)),i.closePath(),i.clip(),i.beginPath(),i.fillStyle=f,i.moveTo(a+this.subscriptSize,s),i.lineTo(a+this.subscriptSize,s+this.subscriptSize),i.lineTo(a,s),i.fill(),i.closePath(),i.restore();break}var x=e.getEffectiveValue(),C=(0,p.getDataValidationError)(e),I=x&&x.type===u.default.ERROR;if(C||I){a=this.stage.areaData.col.getViewportLeft(n),s=this.stage.areaData.row.getViewportTop(t);var k=this.stage.areaData.col.getArea(n),_=this.stage.areaData.row.getArea(t);if(a>k.maxDistance||a+this.subscriptSize<k.viewStart)return;if(s>_.maxDistance||s+this.subscriptSize<_.viewStart)return;i.save(),i.beginPath(),i.rect(Math.max(a,k.viewStart),Math.max(s,_.viewStart),Math.min(k.maxDistance-a,this.subscriptSize),Math.min(_.maxDistance-s,this.subscriptSize)),i.closePath(),i.clip(),i.beginPath(),i.fillStyle=g,i.moveTo(a+this.subscriptSize,s),i.lineTo(a,s),i.lineTo(a,s+this.subscriptSize),i.closePath(),i.fill(),i.restore()}}}}},{key:"subscriptSize",get:function(){return 10*this.stage.tableData.scale}}]),t}(c.default.AlloyExcelPlugin));t.default=m},1871:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=b(n(41)),o=b(n(3)),r=b(n(0)),a=b(n(1)),s=b(n(4)),l=b(n(5)),c=b(n(11)),u=b(n(243)),d=b(n(35)),p=b(n(15)),h=b(n(7)),f=n(1711),g=b(n(1872)),m=n(22),v=n(33);function b(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{alloyExcel:e.excel}));return n.updateFilter=function(){n.getSheet().getBasicFilter()?n.doFilter():n.closeFilter()},n.doFilter=function(){var e=n.getSheet().basicFilter;null!==e&&void 0!==e&&(n.addHook("afterRender",n.render),n.getSheet()===n.app.spreadsheet.activeSheet&&(m.isPc?(n.addHook("mouseDown",n.mouseDown),n.addHook("mouseMove",n.mouseMove)):(n.addHook("touchStart",n.touchStart),n.addHook("tap",n.tap))))},n.closeFilter=function(){n.removeHook("afterRender",n.render),n.getSheet()===n.app.spreadsheet.activeSheet&&(m.isPc?(n.removeHook("mouseDown",n.mouseDown),n.removeHook("mouseMove",n.mouseMove)):(n.removeHook("touchStart",n.touchStart),n.removeHook("tap",n.tap)))},n.render=function(e){var t=n.getSheet().basicFilter,i=n.getSheet().sheetId;if(null!==t&&void 0!==t){var o=t.range,r=o.startRowIndex,a=new d.default(i,o.startColIndex,o.endColIndex,p.default.COLUMNS),s=void 0;for(s=a.startIndex;s<=a.endIndex;s++)n.clearFilterHeader(e,r,s),n.renderFilterHeader(e,r,s)}},n.renderFilterHeader=function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=(0,f.cellToMasterCell)(n.app,t,i),a=r.row,s=r.col,l=(n.stage.tableData.getCellDataAtPosition(a,s,u.default.constant.GET_CELLDATA.DEFAULT),n.getBtnInfo(a,s)),c=n.getIconInfo(a,s,o);if(l&&c){var d=n.stage.areaData.col.getArea(s),p=n.stage.areaData.row.getArea(a),h=l.x,g=l.y,m=l.width;h>d.maxDistance||h+m<d.viewStart||g>p.maxDistance||g+m<p.viewStart||(e.save(),n._clipCellArea(e,a,s,!1),e.drawImage(c.icon,c.x,c.y,c.imgWidth,c.imgHeight),e.restore())}},n.clearFilterHeader=function(e,t,i){var o=(0,f.cellToMasterCell)(n.app,t,i),r=o.row,a=o.col,s=n.stage.tableData.getCellDataAtPosition(r,a,u.default.constant.GET_CELLDATA.DEFAULT),l=n.getBtnInfo(r,a),c=n.stage.areaData.col.getArea(a),d=n.stage.areaData.row.getArea(r);if(l){var p=l.x,h=l.y,g=l.width;p>c.maxDistance||p+g<c.viewStart||h>d.maxDistance||h+g<d.viewStart||(e.save(),n._clipCellArea(e,r,a,!0),e.beginPath(),e.fillStyle=s.getBackgroundColor(),e.rect(p,h,g,g),e.fill(),e.closePath(),e.restore())}},n.mouseMove=function(e){n.cacheRender.col===e.lastCell.x&&n.cacheRender.row===e.lastCell.y&&(n.clearFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col),n.renderFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col,!1)),n.isInFilterHeader(e.newCell.y,e.newCell.x)&&(n.clearFilterHeader(n.stage.ctx,e.newCell.y,e.newCell.x),n.renderFilterHeader(n.stage.ctx,e.newCell.y,e.newCell.x,!0),n.cacheRender.col=e.newCell.x,n.cacheRender.row=e.newCell.y)},n.mouseDown=function(e){2!==n.stage.mouseData.button&&(n.isInFilterHeader(e.y,e.x)?(n.stage.mouseData.response.push("filterHeader"),n.showFilterBoard(e.y,e.x)):n.closeFilterBoard())},n.touchStart=function(e){n.isInFilterHeader(e.y,e.x)&&(n.clearFilterHeader(n.stage.ctx,e.y,e.x),n.renderFilterHeader(n.stage.ctx,e.y,e.x,!0),n.cacheRender.col=e.x,n.cacheRender.row=e.y,n.cacheRender.x=n.stage.touchData.currX,n.cacheRender.y=n.stage.touchData.currY,n.stage.wrap.addEventListener("touchmove",n.touchMove),n.stage.wrap.addEventListener("touchend",n.touchEnd))},n.touchMove=function(e){(Math.abs(n.stage.touchData.currX-n.cacheRender.x)>10||Math.abs(n.stage.touchData.currY-n.cacheRender.y)>10)&&(n.clearFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col),n.renderFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col,!1),n.stage.wrap.removeEventListener("touchmove",n.touchMove),n.stage.wrap.removeEventListener("touchend",n.touchEnd))},n.touchEnd=function(){n.clearFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col),n.renderFilterHeader(n.stage.ctx,n.cacheRender.row,n.cacheRender.col,!1),n.stage.wrap.removeEventListener("touchmove",n.touchMove),n.stage.wrap.removeEventListener("touchend",n.touchEnd)},n.tap=function(e){n.isInFilterHeader(e.y,e.x)?(n.clearFilterHeader(n.stage.ctx,e.y,e.x),n.renderFilterHeader(n.stage.ctx,e.y,e.x,!1),n.stage.touchData.response.push("filterHeader"),n.stage.touchData.stopSelect=!0,n.showFilterBoard(e.y,e.x)):n.closeFilterBoard()},n.app=e.spreadsheetApp,n.getSheet=e.getSheet,m.isMobile?(n._iconWidth=22,n.iconsList=(new g.default).iconsList):(n._iconWidth=18,n.iconsList=(new g.default).iconsListM),n.cacheRender={col:-1,row:-1},n.updateFilter(),n.initEvent(),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"initEvent",value:function(){h.default.event.sheetsBar.listen("switchSheetEnd",this.updateFilter)}},{key:"getIconInfo",value:function(e,t,n){var i=void 0,o=this.iconWidth,r=this.iconWidth,a=this.getSheet().getBasicFilter();if(null===a)return null;i=a.criteriaMap.get(t)?n?"iconDoneHover":"iconDone":n?"iconReadyHover":"iconReady";var s=h.default.window.devicePixelRatio||1;s=(s*=this.stage.tableData.scale)<=1?1:s<=2?2:3;var l=this.getBtnInfo(e,t);return{icon:this.iconsList[""+i+s],x:l.x+0,y:l.y+0,imgWidth:o,imgHeight:r}}},{key:"getBtnInfo",value:function(e,t){var n=this.stage.tableData.getCellDataAtPosition(e,t,u.default.constant.GET_CELLDATA.DEFAULT),i=(this.stage.areaData.col.getArea(t),this.stage.areaData.row.getArea(e),this.stage.areaData.col.getViewportLeft(t)+this.stage.tableData.getCellBackgroundWidth(e,t,!1)),o=this.stage.areaData.row.getViewportTop(e),r=this.getOffsetY(e,t),a=this.iconWidth;return{x:i=i-n.paddingRight+v.CELL_FONT_FORMAT.PADDING_RIGHT,y:o+=r,width:a,height:a}}},{key:"_clipCellArea",value:function(e,t,n,i){var o=this.stage.tableData.getCellDataAtPosition(t,n,u.default.constant.GET_CELLDATA.DEFAULT),r=this.getBtnInfo(t,n),a=this.stage.areaData.col.getArea(n),s=this.stage.areaData.row.getArea(t),l=this.stage.areaData.row.getViewportTop(t),c=this.stage.tableData.getCellBackgroundHeight(t,n,!1),d=this.stage.areaData.col.getViewportLeft(n),p=this.stage.tableData.getCellBackgroundWidth(t,n,!1);l<s.viewStart&&(c-=s.viewStart-l),d<a.viewStart&&(p-=a.viewStart-d),e.beginPath(),i&&(e.fillStyle=o.getBackgroundColor());var h=Math.max(a.viewStart,r.x,d+1),f=Math.max(s.viewStart,r.y,l+1);e.rect(h,f,Math.min(a.maxDistance-h,r.width,p-2),Math.min(s.maxDistance-f,r.height,c-2)),i&&e.fill(),e.closePath(),e.clip()}},{key:"showFilterBoard",value:function(e,t){if(this.app.sheetStatus.permission.gEditable){this.app.view.canvas.pluginsApi.cardCenter.hideAll();var n=this.getSheet().getBasicFilter();if(n){var i=n.range;t<i.startColIndex&&(t=i.startColIndex),this.stage.hookFunc.showFilterPanel&&this.stage.hookFunc.showFilterPanel({range:i,col:t,row:e,filter:n})}}}},{key:"closeFilterBoard",value:function(){this.stage.hookFunc.closeFilterPanel&&this.stage.hookFunc.closeFilterPanel()}},{key:"isInFilterHeader",value:function(e,t){var n=this.getSheet().basicFilter;if(null===n||void 0===n)return!1;var o=n.range,r=o.startRowIndex,a=this.stage.tableData.getCellDataAtPosition(e,t),s=void 0,l=this.stage.tableData.getCellDataAtPosition(o.startRowIndex,o.endColIndex),u=l&&l.parent&&l.parent.mergeData;if(u){var d=(0,i.default)(u.xRange,2),p=d[0],h=d[1],g=Math.min(p,o.startColIndex),v=Math.max(h,o.endColIndex);o=new c.default(o.sheetId,o.startRowIndex,o.endRowIndex,g,v)}if(t>=o.startColIndex&&t<=o.endColIndex){if(a&&a.parent&&a.parent.mergeData){if(!(r>=(s=a.parent.mergeData).yRange[0]&&r<=s.yRange[1]))return!1}else if(r!==e)return!1;var b=this.getAABB(e,t),w={x:m.isPc?this.stage.mouseData.currX:this.stage.touchData.currX,y:m.isPc?this.stage.mouseData.currY:this.stage.touchData.currY};if((0,f.checkIsIn)(w,b))return!0}return!1}},{key:"getAABB",value:function(e,t){var n=this.getBtnInfo(e,t);return n?[n.x,n.y,n.width,n.height]:[0,0,0,0]}},{key:"getOffsetY",value:function(e,t){var n=0;switch(this.stage.tableData.getCellDataAtPosition(e,t,u.default.constant.GET_CELLDATA.DEFAULT).verticalAlign){case u.default.constant.VERTICAL_ALIGN.MIDDLE:n=(this.stage.tableData.getCellBackgroundHeight(e,t,!1)-this.iconWidth)/2;break;case u.default.constant.VERTICAL_ALIGN.TOP:(n=5)+this.iconWidth>this.stage.tableData.getCellBackgroundHeight(e,t,!1)&&(n=1);break;case u.default.constant.VERTICAL_ALIGN.BOTTOM:(n=this.stage.tableData.getCellBackgroundHeight(e,t,!1)-this.iconWidth-5)<=0&&(n=this.stage.tableData.getCellBackgroundHeight(e,t,!1)-this.iconWidth-1);break;default:console.error("Error")}return n}},{key:"iconWidth",get:function(){return this._iconWidth*this.stage.tableData.scale>>0}}]),t}(u.default.AlloyExcelPlugin);t.default=w},1872:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(9)),o=a(n(0)),r=a(n(1));function a(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,o.default)(this,e),this.iconSrc={iconReady1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAOJJREFUOBHdlD0Kg0AQhZ+rhT+dgnoDPYOinUIOkdPlKB7CA4hdtLYQiU8whU4S2DQhA7Lsm3mfO8syRtd1F6XUbVmWABqxeofVezX6vr/7vh/Ytq2BAaZpwjiOg+JJdCH8M71kKK1jCKY/BllCu2iaBm3bSimkaYqyLE858Y6yLEMURafiMAyR5/lJpyCCTNNEVVVwXfdpchxn05iTQgSxkJC6rrG+3O0j2PM8ibFp4h3t1WylKArM84w4jndZXN+C6EiSRDQexZetHQs/7X8QxHnCUaAb9JJhcSit8+TrwfYAJwpCOL9oIUYAAAAASUVORK5CYII=",iconReady2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAddJREFUWAntWEuOgkAQLZCFogtj/KBhrSYuZu03LtQjzSHmIl7DxBPMyguQuJu4My6MU49ApiMNDeigi66kQ1PVXe/5uhBSBrF5nufebrcvni55dHkUaUcG2xmG8em6rmcEZL7Z2SiShQTrh0l9WIEyjUqlQvV6nUqlkmTt/7mu1yudTic6n88NcDEZagm4V5ABLgQAdmBLEPJrpmhlQga4CthdEHor04RUx6EV0gqpFFDFdQ2pFLJUC8L4fr+nw+EQ3ma6DodDWiwWqfakPrLJZEKdTidVUnFRu92m6XQquhLnqQnhfbNer8m27cSEYhBfENgjvKvEsHSemhB2g8xmsyHTVG/DGpCpVqtS4DinOvPdThzBfD6/80Zvx+MxOY4TDSg8mQkh32AwoNFoFJu63+8nxmM3ciAXISSMU6DZbNJsNkvCTIzlJiSrkXK57NeYZaX+N4mQy00ImfAUocjxFPEHOq1WK6rVahGQLI78PyVAabVafpFfLhfq9XpZsKVrHyaErCjiZ9lDR/YsEmIeTUhUQzbXCslUEX1aIVEN2RwKoT9D6EK8ygTsIwjtQAQtESEAVyEWtmMCsN3bNaxMv43GnStmuOXhH18h0vyBAHOL7hm4/AL2VV/phesr2gAAAABJRU5ErkJggg==",iconReady3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAAAXNSR0IArs4c6QAAAtNJREFUaAXtmruO4jAYhe2AxJ2G6wAlAqSImpugGC5PMd1eHmq10+1jrKbhGRAPAGgLOlgKGrI+EYmsiCHZOEEx8l8Qx07s8/nYnkxiSq5hGAbdbrdfKaVfWJbOzrNWWZSPTO9fpm/F9L43Go2f7NyAXoqf/X7/cj6ff7HCV5zLGgzqI5FIvJVKpT8anHoGKJgBY64slG42m28s7wcKGDHJ5/Mkk8kQTdOQFfm4XC7kdDqRw+EAMEvvd43BYE6ZAahcLicNFETDAGiGdivABFt0KwNOyRoO7TrmmL36yTL8bnU+rx1MckykWyQueQrMpYMiV6wci5wlLoKUYy4dFLli5VjkLHERpBxz6aDIFSvHImeJi6CndSzuAn63eLlckvV6ffcav4WdTodMJhO/txMhx4bDIalUKr4b/+zGcrlMRqPRZ8We8oXAYrEYmc/nJJ1Oe2rMy0WpVMqsE3WLhBAYGgbUYrEI5D0J/gtGRzn+zffFJwyGVjF0xuOxLwH8TYPBgFSrVT7LdzoQMLTebreJrtvvhf5bUKvVErrf2WBgYKjYb48Xi8VAHOfhAgXzM0eSyaQ5R0UXCx4K6UDBUCFWNSwmXoTizfNsNiPZrP0GEFUEEoGDQRX7KOBpaPX7fVKr1QIBcVYSChgawWLQ7Xad7dnnzWbzbrl9oc9EaGDQ0+v1bjpSKBSEHpe8sIYKhsXEOYfY9ytzDsbjQo+prmyhgqF1a9UDCBaL6XRqfh1xVSZ4QbjddhWHv1N4Usd3LPY5VVCyt9sfAgYpWCweGaEPxUfC8G0pML43ZEgrx2RwideoHON7Q4a0ckwGl3iNyjG+N2RIYy8V9vuZgQ1XsgavHUwYiisLBk/fsoZD+wp7qd4tGGyNOx6PhKe3yqJ6hFZohnYrwETZD93tdr/Z8dUqkPnIhuFHvV6fYY4Z2G6KDJmBoB0MVxbD3BOMTDj3TJud/wFDOLTng9rgTAAAAABJRU5ErkJggg==",iconReadyHover1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAORJREFUOBHdlD0Kg0AQhd+uIv6UQfEEnkHRSqscIqfzLB7CWuySTixEJD7BEHASwqYJGZCFN/M+d4ZlVNd1Z611vSzLCQaxem+r96L6vr/6vn9yHMcAA0zThHEcb5o3MYXwz/SSoY2uIZj+GGQL7aJpGrRtK6WQJAmKojjkxBmlaYooig7FYRgiy7KDTkEEWZaFsizhed7D5LrupjEnhQhi4fpIUVUVlFLbR3AQBBJj08QZ7dVsL89zzPOMOI53WTzfgujgcD+Jl619Yn6u+UEQ9wlXgWnQS4bNpbTuk3oYhq8W2x1Bq0HnHeNhhwAAAABJRU5ErkJggg==",iconReadyHover2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAd5JREFUWAntWL2OgkAQHpAoopVGkIRSTbS50t/C4DvdQ9yL+Bo2PMCV9iR2V5poobcfQW4TWFgw4hW7ycbNN7MzH9+OuI5GbIRh6N3v9y+23LLpslnnOLFkB03TPj3PC7WYzDcDe3WyyMj1w0h9GLEyvWazSZZlka7rGb6vg263G53PZ7perz1wQfYt0r2DDPJCAOSOxxaEopqpW5kHA3xyud16z4dnIVgrQgJhElgplEghWCiFBMIksFIokUKwMAR4Cg6CgI7HYwqXASaTCW02GxlXkj6yxWJBtm1LBeWdBoMBLZdLHspdSxNqNBrk+z612+3cgLzRNM1oD/bKDmlCCIhf5d1uR+zeUhgfPniATqdT6Ms7lCKEjTi29XrNx8hcz+dzGg6HmbY8sDQhBEORTqdTYdzRaESz2UxozzNUIoSAUMBxnFTsfr9Pq9UqhcsClQnhUoUa4W571Gq1ohozDOm3SYpnZUKIhG8civxx4wPBbrebSlIGqP4ocRa8Z1Dkl8uFXPf5f1BPEwKv8XhcRoRc36eOLDdyRaMiVCScUkgpVKRAkR01hP4MoQvxrsHlPoHQAUTQEuEMgGoZj3ZMnOzw7xpWetRGY50rxnDPZnR8tUjzlwQ59+iegcsvdW1fPtUV+DUAAAAASUVORK5CYII=",iconReadyHover3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAAAXNSR0IArs4c6QAAAuFJREFUaAXtWruO4jAUdQDxpuGNoOIl8Wh5CRpgP2O63ZmPWu10+xmr6fgECmpAW9AuQjRkfCIcRQzgBCebBNkShPja955zj22CsULORVVVZbPZ/FAU5Tut6tD7JLN5+Urx/qP4lhTve6VS+UXvVeBV8Lbb7UrH4/E3Nc5w79dCSX1EIpGXXC73NwClnoEUxIAwZy6Ksl6vX2ndT6ZSLBYjlDUJBAKsytPX0+lEKBlyOByMON9CmFOUqVYJUnj5qUAAhpmRAyfI0mFEoJRfywX2DuaYvvr5ZfhdS74ROzj5YyJdY8Kpk8Q4CfKcWSrmOUk4gKRinAR5ziwV85wkHEBSMU6CPGeWinlOEg6gp1UsxCF+17xYLMhqtbrb5lFjs9kkk8nk0e5ESLHhcEjy+fzDwW91pJsxZDQa3TKbqhciFgwGyWw203+am4rIaRSNRjWf8C1ShIghcDweJ/P5nNB9BhEcWl/4QKISiYSwL2FiQIDhOB6PhcEMBgNSLBaF/cCBLcTgCJO91Wrh40OlXq+Tdrv9UN9rnWwjBufIeKFQuBbnbl0mk7FFcWMQW4lhpwhzBPPObMG2Geao6GJxGc9WYnCOzUsANW6HXQY13iMRyaS+A2g0CX22nRjQ4HvIzGLS7/dJqVQSInCrsyPEEKzRaJBOR99k/hK/Wq2Sbrf7pd6uCseIAWCv17u6fKfTaaHHJTPkHSXGFhPjF244HNbmYCgk9JjK5eYoMUTHI5Jx1ZtOpySVSnGBiTZwNm1ndNlsVht6+/2elMtlUcym+v8XYkBSq9VMAbKrkeND0S6gVv1IYlYz5nZ7qZjbCliNLxWzmjG320vF3FbAanypmNWMud0+QPfycN5PKzhw5ddixA5OGIpLRganyPxaLrAvcZbqnZHB6TG8jOyZzatXYGW4GUZwUuibst1u/9DrjBn8fKXD8IP+5vuGOabSvb0XVPiZELCDw5mLqv+TAOWe6bDzJ9x5tp/y//05AAAAAElFTkSuQmCC",iconDone1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAOdJREFUOBHNlDEOgzAMRU2IgAUG4AAsSNwBIbGA1EP0dD0Fx0GIrTAzQfM7RGkxHQJDPX1i/xfLCnaGYbgJIR7ruiZkEco7Ke/dGcfxGcdxEgSBBYZoWRaa53kS6MQWgpvhBUNYtcGYLgNJBk5d11Hf91yKsiyjtm13Obajuq4pDMNdcRRFhBwXLMj3fWqahlzX1R4p5bsTz/P0mSlYEArSNKWyLHVtVVWknon+/haHIBQWRaHr8zzXmhM/QZzh6Oz/QOw7MtvH0M1ZmbkPrf7+7WyAcd2MsE+wCmwDXjAklpLaJ6cX2wu804YC5y7+YwAAAABJRU5ErkJggg==",iconDone2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAdBJREFUWAntWMGqgkAUvZYFJUREG0MILahNuApaBGlFuzZ+zPuI9yN9QD/QL7x/ENw92rWK3hyxkAzujPKshRcG9d479xzO2ExejYSFYWjdbrdvceuJYYpRpkUC7KRp2pdlWaGWkPkRzl6ZLF5g/QpSrp4o02u1WtTtdqler7/I/T/X9Xql8/lMl8ulBy41AeUB7h1kgAsBgJ2YB0LxO1O2MncGuKawTRD6KKsIcctRKcQppHMJ9/jxeKQowqaqbqZp0n6/l5oovWTr9Zqweaoa5mw2G+lp0oQMw4gLi+1dujhyt9sttdtt6TnShFBxMBjQfD6XLr5YLAjLpWJKhFDYdV0aDocshuM4NJvN2LznBGVCWAbf96nT6TzXejzjbFqtVo9nlRtlQijebDbjdyN1Bj0wG40G7XY7wjWP5SIEoH6/T8vlMoPpeV769M7EOUduQig8mUwy9W3bzvhUHIUIqQDJ5laEOKUqhSqFOAW4uPT/IbaQrtNoNOLS2HhhQtixp9Mpjcfj+EhhEZmEwoSCIGAg1MLVz57T6yMVij8l0IV4l6WwIyh0AhG0RFIBuEqxezsmATt9XMOqFrfRROdKMDyIke9LsJiWwDygewYuf7ZxXGHX5NvrAAAAAElFTkSuQmCC",iconDone3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAAAXNSR0IArs4c6QAAAvJJREFUaAXtms1u2kAQx8cESIACEQRECQIEiABRFC4ICSERPvICnHvrx0NVza3nPEGUt+AJkqgHOEE5cMHdP8KRG2EZdteyjTwHbGa8u//fjDfxmlVoa6qqKq+vr98URfnKXNfs+yct5uQj0/uX6ZswvQ+5XO4X+65Cr4KP6XT6ebVa/WbBAb671RjU8+np6ZdUKvXHh0odAxSKgcJsWRTl5eXlO/P9RIARUywWo0gkQj6fDy7H23q9puVySfP5HGCa3h8+BoM5tTFARaNR10BBNAoAzdCuGZhQlmvNgUq51T5ov8Yce//r55bbb1fy9drB5I6JtIvExOeBmSTIcWGvYo4riYkgr2ImCXJc+Ggr5hdJ9ePjI81mM5EuDNteXFzQeDw2jJsFhCo2GAwoEAiYjXFwPBgM0nA4PLidvoEQ2Pn5OfV6PX1/Us7v7u4oHo8L9SUEhpFLpRLd3NwIidA3bjabVCwW9S6uc2EwjNputymTyXAJ0De6vLykVquld3GfSwHDk/VoNKJQKMQtBMsOzCssdmWYFDAICYfD3MKQmPv7ezo7O5PBtOlDGhh6y2azXLdSp9OhdDotDQodSQVDh7e3t1QoFHC6l1WrVWo0Gntde8hF0sEwR/r9/n/vIIwEJZNJ6na7RmEhv3QwqME/WMyZk5MTQ3HaNX6/0MOPYf+WgGE0s2rgqUX/ZslQIWfAMjDoubq6MpSVz+cNYzICloLJEMjbhwfGmzm72nkVsyvzvON6FePNnF3tvIrZlXnecb2K8WbOrna2VCyRSFjOa82aYYdsLE/K5TLV63Xpq+Udw5HlYHijW6vVqFKpbNZpu0RY4bMcTOQ1tQiwLXNMRPC+bT2wfTPllOu8ijmlEvvqwF4q7PfbGDZcudX02sGEW3GiwWAXmVvtg/YJ9lI9aDDYGrdYLEhPr8WceoRWaIZ2zcCksA/l7e3tiR0HWsDNR3YbPrPf2UaYYyq2m8LhZiBoB8OWRX3/lQ2VO6bNzv8AsDOwGJL8juUAAAAASUVORK5CYII=",iconDoneHover1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABIAAAASCAYAAABWzo5XAAAAAXNSR0IArs4c6QAAAPRJREFUOBHNVDEOgzAMPAICCcFCmJkQvAEhMQBLH9HX9Rk8B7G1TIiBgTbukCJwO6Qd6uly9l2sOLLV9/1JCHFZ11XCIJT2prRnaxiGq+/70nVdAxtgWRbM83wT1ImpCd1MWvIQRm0wop8ZOYw5uq6DGgKXQpIkaNv2kGM7qqoKQRAcisMwBOW4YI08z0Nd11Cj1RrbttE0zfNxNbkBr8oNSTCOYxRFodmyLBFFkT7vwVsjKszzXNenaaoxBz4acYJ33P8Zsf9o276UElmWbSkWW+rj3T9Ng1XtyHEc8bs3on1Cq8A0SEseDi0ltU8u0zR9tdgeoztFULSc6f0AAAAASUVORK5CYII=",iconDoneHover2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACQAAAAkCAYAAADhAJiYAAAAAXNSR0IArs4c6QAAAfFJREFUWAntWMGqgkAUvZpFFFFYiwSDKGgVvUXQIqiMdn3Q+4j3I/1B637hfUNCrVy2aJFvjqhvSsc3Js9aOCCO586dczgzOHoVYs22bdN13S/WtdhlsCvPdmJkB0VRPk3TtBVfzDcD9TxVxHA5TNSH5jujVyoVqtVqpKpqzNj/g263G10uF7perzq0gN0C3SvEgBcGgNtvFgR5eyZvZwIFuHPcRr7rw6sQ9AtBAmNCuHAotELQ0QR4BN7v93Q+nyO4DNDtdmm73coMJeklW61WVK1WpSblByHHsiweSuxLC6rX67RerxMniwsih3vxxQ25w6QFIcswDJpOp3cTJD3MZjMvJ2nMYyyVICRPJhPq9XqP80Se+/0+jcfjCP4XkFoQO5EJ+6nRaAjnbjabtFgshPGkQGpBmAxfBtgb3BkUcmiaRpvNhsrlcoil6TwlCASdTofm83mEa7lcUqvViuCywNOCQDAajSI82DtZWiZBWYhFuYUgkTMBXjgUOCG6Fw6JnAlw6e+hIEF0L5VKNBgMRGFpPLOgdrvtvSCHw6F3pEgzCwYqx+PRRUzXX/sn7TiOJ7HY1IKVCuG3dAj1GUIV4lWN4z7BoQOEoCTCBQDl0oJyjE92eLuCleqV0Vjliincsctbvlys+SUB5w7VM2j5AQqlYXQuGemdAAAAAElFTkSuQmCC",iconDoneHover3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADYAAAA2CAYAAACMRWrdAAAAAXNSR0IArs4c6QAAAvBJREFUaAXtWsuK4kAUrfhWxjcqoiI+UERwI4IIPum9PzC7eXzUML2bH3A/9F/4BSq9EF0NiBszddKWSDoxsVNFJ5ICLXPvzb3n3FtlqrQkcm6yLEvr9fq7JEnfqKhNr78wnZ17ivcfxbekeJ+LxeJvei0Dr4S37XabPx6Pf6hyhmunNkrqJRgMfs1kMq8eVOoRSKEYKMyZiyStVqsfVPaLVSkcDhPKmng8HiaydX86nQglQw6HwzXOnz7MKcpUEYIUXk5qKADDzMiBE8rSZkRQKac2FfY25tjl288pw08r+dfYwckZE0mLiYHMJWaQINup3YrZriQGgNyKGSTIduqHrZjPSqoXiwXZ7XZWXOjem06nyXw+19UbKSxVbDweE5/PUm408fn9fjKZTDR1ZoWWiCUSCTIcDs3GMm03Go1IPB43ba9laIkYHFYqFdJuX9bRWjHuknU6HVIul++6R8vYMjE47fV6JJfLafm/S5bP50m3273rHj1jLsSwsp5OpyQUCunFMZRHIhHFB91LGdqaMeBCDIEYMDNB1TYgM5vNLCVG7ZMbMTj+6FDq9/skm82qsVm65koMSDD5S6WSaVD1ep20Wi3T9mYNuRPDsMLzLRqNGmJIpVJkMBgY2n3EgDsxgAgEAsqcud6uq8HhIYx5JeIBj1hCiMExlkS3qoGVRSwWg6mQJowY0DYaDV3Q98xDXSc3FEKJ3YgrXOUSE55izgHcinFOqHB3bsWEp5hzALdinBMq3J1bMeEp5hzgUyqWTCY503jvjv+Pgu9jKBKv10uq1SppNpvcd8taIYUTw/YFq/xarabs07RAiJDhOMTbkQHqHTtaJ7f9fn+B/ylz7BJd4AeXmMDkCnHtVkxIWgU69dDfAXHeT2k4cOXUdo0dnDAUl4wMTpE5tamwL3GW6pmRwekxvK7ZM51de2BluBlGcJLom7TZbP7SfsYUTu7pMHwpFApPmGMyjptC4GRCwA4OZy7y5V82VO6RDjv/B7BVt53829x6AAAAAElFTkSuQmCC"},this.iconSrcM={iconReady1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAQFJREFUOBHtlTEOgzAMRZ2IAVhAsCFGLoA4AWw9RE/Xa7EhEENBjAwINV+qUKAxZUi3Zkqc/Gfng2LRNM1NSvlY1zUmC0OxBsW6i7Ztn1EUxa7rWsASzfNM4zgOEpXagqIysMCUVso0QP7gzZSfWeFsKQ6TaZqorutDdL/MsozCMNwH3ysWHAQB9X1PXdcZhUmSUFEUxj0EWSuEEFRVFfm+/yHGv4o9nOEGC4YAUBOAS6gnOQXj4PHKeZ5TmqY6wzhnPdZPAwa/l2U59VXXXALDy7Is8QaQer10PTu/BIba8zwWYtq4lt6k/BL7gzeD1EeWA9qJrQEWmA4an+pR1pvpC+wRTney3iiLAAAAAElFTkSuQmCC",iconReady2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAfpJREFUWAntmTuOwjAQhichINHwCDRIqXgJaLbmnYIz7SH2IlwjV9iWOhLdio4Ksf6jwJoEaf1arZFsKYo9mbG//JlYgfGItTRNo+v1+sG6MTt67LCpHRlM4nneexRFqZfDfjJjaBPlE5YvBv0W5MqG9XqdWq0WVSqVJ77/Z7pcLnQ6neh8Podg9RlKDBwbYcEFAcGWtxjAWc7apuyNEGeOrQfgl2oO+K8fl1PYKVxQwKVEQRDjQ6ewcUkLEzqFC4IYHwYqMyZJQofDQSX0HjMejymO4/tYtKOUEqvVitrttugaJT98Li6Xy5JdxKAEHAQB7XY7wlm24VMRsdVqVTY081cCRiQUXq/X0otC2TBU/zWmDAzS0WhEk8lEGHo4HEr5P5tYCxgTLhYLIcWazabSEylCawOL5LNu3vLQ2sCYDG/9ZrPh533oz+dz6nQ6DzbVgRFgLI78nE6nJY7BYECz2axkVzUYAwZAUclGo2Ekb/mbMwp8y2fssb7vZ/ttrVbj19Puy+/8vyyJ3WC73eKfGup2u794y182DgyEfr8vTyIYYTQlBNfUcnPAWvIJBDuFBUTScnEKa8knEOwUFhBJy+UlFUYdjFCtsbVxbEconAAUpSXuAkxWtFvZK4dJXq6w6GflUFZhZHewZ0eWHlZI+wMBpj2qoGD9BiWmYmm8DI4wAAAAAElFTkSuQmCC",iconReady3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAAAXNSR0IArs4c6QAABK5JREFUeAHt3VtLG0EUB/BJjFEh3m+IGryjRPIo3i9VhH6PvpT2qR+kT5W+9HsUfCh+hkJffPSC+CSCL4rGzn+bLJOjGXc3Z3c29CyUzOzMnMz8OjkJGJ2MItfV1VXp6enpw/Pz82EmkynqxwLpIlVDQBvdaaMz/Xjc1tb2Y2xs7I/RrDK1iu6Uv7i4+Ko7ftTlbO2+PAYX0HYVbfd9YmLiiy4/YKQHDNzLy8uf+vFd8HDSs5GAxv01Pj7+HsjeTsXOFdxGXOHvwxKmGJmp5tzf+qafFnK5nOrt7VUdHR0qm/Vvh3+m/2BEpVJR9/f36vb2Vj0+PvorRrrQObmcq76h+YrAHR0dVbqD31kKjQWwAbu6ulRnZ6e6vr72kbFhYZvVhUNzOHau4Joiwcowg515wTarG4rmTaQFuaIJUDvYYgfXfc6VnBsNF6OoHWz93Bs9rIy0CQiwTYehTYAZEG0hBNimw9AmwAyIthACbNNhaBNgBkRbCAG26TC0CTADoi2EANt0GNoEmAHRFkKAbToMbQLMgGgLIcA2HYY2AWZAtIUQYJsOQ5sAMyDaQgiwTYehTYAZEG0hBNimw9AmwAyIthACbNNhaBNgBkRbCAG26TC0CTADoi1EztbI2XZycqJOT085Q0aOtbCwoHZ3dyOPDzMwsR28ubmp+vv7w8wtlr59fX1qY2MjltivBU0MGF+LPTg4UHh0denv63pzaG9vT2wKiQFjRdjBW1tbiS2OPhF27sDAAL0daz1RYKxkfn5eLS4uxrqo14LPzc05ed7EgbH49fX1RHcSvhjt6pXjBDjJfOwi75qvICfAmADezbe3t825xFLGq2VwcDCW2EGCOgPG5JAXl5aWgswzUp/Z2dlY4weZlFNgTDCuHdbT0+Ms75rwzoHjyJH4XQl85s7n8+ZanZSdA2PVeJff2dlhA1hbW1NDQ0Ns8ZoJlApgLGBmZkaVSqVm1uKNnZ6eZonT9ESqAVIDjPmsrq42tfO6u7tZXwkcyKkCruXjKLkzTXnX/I9JFTAmhnf/KPkYu394eNhcWyrKqQOGCvLo8vJyYKCpqalQ/QMHZuiYSmCsK+iOLBQKkXY8g12gEKkFDpJTa33oL2EHWnlCnVILjPXjU4HtRzsrKytqZGQkIapoT5NqYCwJ+bVcLr9YXbFYfPX+i46Ob6QeGD50pyLv2na2Y9O6p28JYDPX4i+L7O/ve3/CpW4lKa24+wlkSBDs2r29PXVzc+P9TaGQw511bxlgCCHv4l8rXS2RIloJlM5VgKkIc12AmUFpOAGmIsx1AWYGpeEEmIow1wWYGZSGE2AqwlwXYGZQGk6AqQhzXYCZQWk4AaYizHUBZgal4QSYijDXBZgZlIYTYCrCXBdgZlAaToCpCHNdgJlBaTgBpiLMdQFmBqXhcFDJnXkTZ/PIFU2A2sEWB5WcmeFw8JFc0QSoHWyxg4/NcDhVSjeYt6QcQABmsDMv2MpxZ6ZIhPJbx515Z5qdn59/07E/RYgvQxoLHE1OTn72gPX2liMnG0OFbtGpof7ISX3jAWdQ6khHuiwfI0KT/htQtTuqneeJu94ONuPJsb+mxttljWo99vcvkX4L2PeeJDsAAAAASUVORK5CYII=",iconReadyHover1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAARBJREFUOBHtlbEKhDAMhtMiii4KLoqbL6A+ga73EPd0vpeLCAonOIiDoFxTRLTXikNvM1Bok/5faooNqev6RSkt13X1QYMxVs9Yb9I0zcdxHN80TQ1YgHmeYZqmnuJJdUHxZMhCJtVyTAnkAe9F+VspjD2FMBmGAaqqErznZRzH4Hne2bmtlGDXdaFtWz5kyiAIIMsyWYj7lKUghEBRFGDb9o/Ysiwewz0qU4JRwP5IDhDFmBBjV3YJRmEYhqdPTpIEoii6YvKYssZHZZqm0HUdLMtySnLcI85vgbGWeZ7jGwDs9RIZ0vUtMCpllyglbs576a8IitgD3gvDLpn22E50GbKQaWDjYz2qHMdRazP9AqsOTi+S4fW6AAAAAElFTkSuQmCC",iconReadyHover2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAg5JREFUWAntmUtuwjAQhichsEDiFdggZcNDIFZd8kZwqR6iF+EaiBt0zzJSd12CxALqPwqpU0iwHEc1ki1FmYzt8Zc/IwcyFrHm+753vV4/mLlmR5sdOrUvBrOzLOvd8zzfCmE/mdPVifIByzeDfnNCZd1SqUTlcpls234w9v9cl8uFjscjnc9nF6ygWwNHR1hwQUCwhW0N4CBndVP2Rogzx9bW6/nzlAm2AU4QRpnbKKxMyoRARuEEYZS5jcLKpEwIZBROEEaZ++UUdmRufb/f0+FwkJkazen3+7RaraJrUUNK4dlsRvV6XXSNu3G1Wo2m0+mdX8QhBew4Dm02GyoUCiJrxMbgpyLmFovFmF/0QgoYwRuNBs3nc9F1onFQ1nXl/41JA4MAeTgYDCKYZ0a326XhcPhsWGp/JmBEnkwmgdqpq7DOarUq9UT+xs0MLJLPWfOWh84MjGDYMRaLBR83Zo/HY2o2mzGf7IUSYCze6/Ue5men06HRaCTLdzdPGTAiQ0l+B6hUKkrylqdWCnzLZ5zZV5pgv8UHGpVN6tWcBoC32HK5pNPpRK1WK22oVJ9yYFAgb/NqSlMiL0g+rgHm1cjDNgrnoSof0yjMq5GHbRTOQ1U+5ksqjDoYoVqja+PYvqDwDqAoLXEdcGnRbmWvEGb3coVFOyiHsgoju4MtO4L00ELaXwgwbVEFBesPT/thpsGAKvYAAAAASUVORK5CYII=",iconReadyHover3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAAAXNSR0IArs4c6QAABKpJREFUeAHt3clOG0EQBuC2WQVm34QAs4rNkBNiX3OIlPfIJUpOeZCcgnLJe0TikAOPECk3TiziiJAQB8SS/i3Gaca4GI+rZhqlRorc7p4pd38ut8dmnM6Y0HZ+fl64u7v78PDw8C6TyeTtbS60i951BKzRlTU6trcHdXV1PwYHB/84zSYT3LE7NZ6enn61O3605WxQr7fRBazdvbX7Pjw8/MWWb3BkERi4Z2dnP+3t2+jhdM9KAhb319DQ0HsgFzMVmau4lbiqr4clTHFk5nHO/W0rS9NCNps1LS0tpr6+3qCsW2WB+/t7c3t7a66vrw3KwYbpws7Jb+of39BKigDt6OgwdodgX70lBODV2NhoGhoazOXlZQkZCQvbrC28c49H5iquKxKtDDPYuRtss7Yh71ZiWtAtnkDYDrbI4CfnuTrnxsPFUWE72Jbm3vhh9UhKQIEpHYY2BWZApEIoMKXD0KbADIhUCAWmdBjaFJgBkQqhwJQOQ5sCMyBSIRSY0mFoU2AGRCqEAlM6DG0KzIBIhVBgSoehTYEZEKkQCkzpMLQpMAMiFUKBKR2GNgVmQKRCKDClw9CmwAyIVAgFpnQY2hSYAZEKocCUDkObAjMgUiESu07q8PDQHB0dUX1JrG1qaspsb28n8niJZfD6+rrp7OxMZFDUg+DK0bW1NWoX1rbEgHFh3N7enrHXzLIOoJpguHYMfcClpkltiQFjQF1dXWZjYyOpsZU9DjK3u7u7rF6yIlFgDATz3/T0tOSYno09MTFhZmZmnm2TrEwcGINZXV0tZrPkwNzY7e3tqb1yUgFOcj5OY951n9xUgNEBnFFsbm66fREp49XS09MjEjtK0NSA0bnJyUnReXF8fNzMzs5GcRDbJ1VgjAoZJvHO3tbWltq86z5bqQPjvBjnpuEfkLidrLaMX/wgJn5elfaWOjAA8Olqa2uLzWJlZcX09vayxaslkBfAGADmy7m5uVrGUjx2dHTUzM/P1xyHK4A3wBjQ8vJyTe/4uVyO9ZXAgewVcDAfx/muwKd5131ivAJGx/CpK858jOzv6+tzx+ZF2TtgqIyNjVU1j+bzeVMoFLwADXfCS2B0EhkZ5UygtbU1VsaHIaTuewsc5TuEYN5tamqS8qk5rrfAGBk+jVF/2llaWjL9/f01I0gG8BoYA8d57cLCQpmB/Y+HzOLiYlm9bxXeAwMMmeqeIWDepTLbJ+RXARzMx8F3C7u7u6a5udknx4p9SezP9hV7ELEBn9J2dnbMxcWFGRgYiHhU+ru9GmBQjYyMFP+lzxa9B69iiog+HP/2VGDh50SBFVhYQDi8ZrACCwsIh9cMVmBhAeHwmsEKLCwgHF4zWIGFBYTDawYrsLCAcHjNYAUWFhAOrxmswMICwuE1gxVYWEA4vGawNLC9vuvKfQx3PR63XssvC4TtYIuFSo7dQ7HwkW7xBMJ2sMVSOwduOKwqZRvcKi1HEIAZ7NwNtrrcmSsSo/zScmfFNc1OTk6+2difYsTXQyoL7NsrkT7rkpOVgWK32Knh6ZKTtuIGa1DaiPu2/G9Zv9gP8X8e+Gi3H6znCYWyZQ912d/qksOiksv+/gUGXgooaZ32lAAAAABJRU5ErkJggg==",iconDone1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAAR1JREFUOBHVlTGqhDAQhidxC0UbXRXEwhOINoK9Wjw8w55uj+JJRKx0ra1knRRBJHGzkAfvTTWZmf9jMkaGDMPwQyl9btt2Bw22s14760HGcZw9z7ubpqkBC7CuKyzL8qLYqS4odoYsZFItbQog/w98E9yCheZ5hr7vZWkWT5IEfN8X1kjBrutC13UwTZNQGIYh5HkuzGFQOmPDMKBpGvaVz2rLslgOa2QmBaPAcRyoqgoIIVyPfl3XYNs2j4mcSzAK4jiGoii4tixLiKKIn2XORzAKsyzj+jRNuX/lKIGPo7iCHXNK4KNA1f8b4CAIVBsG6Q9yJrRty17IOS47K48Cn903pgz+Boq1vwfGHYXrRJchC5k3XHz7jtK+TN9N+0Zp7rIqpwAAAABJRU5ErkJggg==",iconDone2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAg9JREFUWAntmUuKwkAQhisx+EAQHxuVKCi4E6MLxY0YfGw9zhxiLuLeE3iFuUNgXA3uXInTf0icTEww6cSZDnRBSHe6uuvLn6JtKYWYWZal3263d9Y02dVil0j2yWCOiqK86bpuKQ7sB3tYF4kygOWLQRuao2y9VCpRtVqlXC4X4Pt/j67XK53PZ7pcLnWwqgzFBI6IsOCCgGBzzASwnbOiKesS4u5hawE4UyaBX/25pMJSYZ8CMiV8gqTe1XhWPBwOdDqdeKbe5zSbTdrtdvd+1AZXSqzXayoWi1FjPPjh3II1eIwLuFwu02azIXZ6ih1TVVXabreENXiMCxiB2u02zWaz2DHn8zkhHXiNGxgBDcOgXq8XOfZgMKDhcBjZP8gxETAWXC6X3uNfUAz7WaPRoMViEToedSAxcD6ft3NS08I3nEKh8NTnz4ARqFarkWmaoTFXqxVVKpXQ8TgDiRV2g/X7fRqNRm73fp9Op9TpdO79pI3UgAEStGuMx+OkjL/mpwqMPdZvPHu1fw1v/zGCd1TAtgR+9UeRCkuFfQpkLiXCDwC+N4vbxWFnMpnEnfbUP3VgnHXx69btdp8G53FIHZjnf1oc8MzlsASO83l5fKXCPKrFmZNJhVEHI1RrRDUP2ycUPgIUpSXPAB4JYW7Zy4E5Zq6wqNrlUFZhZG+wZ5edHkJI+wMBpj2qoGD9Bh2GXyYhVRKoAAAAAElFTkSuQmCC",iconDone3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAAAXNSR0IArs4c6QAABMxJREFUeAHtnctOGzEUhp0QAoj7TYCACBACRFG5CiFAXIKI1A1LnqCbql31Qboq6qZPwAtUYtGHqNQX4CLEDiQ2IAj1P5DImcbOZHrsMerxZhwf+7fPNyeemYwjp0QoXV5evnl8fHz/9PRUSKVSOXlsC1XhjwoByehWMjqVx5OGhobvQ0NDvxWzSJU+yErZ8/PzL7LiB5lPl8r5GJ2AZFeU7L6NjIx8lvl7tAwAA+7FxcUPecxHl+OaOgIS7s/h4eF3gBxEKiKX4epw1V8OlmCKlqmXOfeXLCxPC5lMRnR2doqmpiaRTpeL6+/pP2hRLBbF3d2duLm5EQ8PD2WPMV3IOflt5uWCVqYIuAMDA0JWKFfmjJ4AArClpUU0NzeLq6urMmQELNimZaagNkfkMlyVSLQ8mIGdmsA2LQ05tRDTAqd4BMLswBYRXHGfy3NuPLhoFWYHtuW5N74stzQRYMAmOgQ2BkwA0STBgE10CGwMmACiSYIBm+gQ2BgwAUSTBAM20SGwMWACiCYJBmyiQ2BjwAQQTRIM2ESHwMaACSCaJBiwiQ6BjQETQDRJMGATHQIbAyaAaJLImIyUtuPjY3F9fU0pGVurq6tLHB4exm5fT0NnEby1tfXXK5V6BkpVF691tre3qeRq6jgDPDg4KNbW1moOyHaF9fX1YFmC7X5K+s4Ao8O5uTkxOTlZ6tv5cWpqSszOzjrt1ylgeIapoqenx6mT6Kyvr09sbm4679c5YKwc2t/fF9ls1pmzWHVTKBQE+nadnAOGg1gBs7Oz48RXrLjZ29sTbW0Vyz+c9I1OEgGMjsfGxsTi4iKyVtPq6qqQS0mt9mESTwwwBrWysmLV+YmJCTE/P2/y37otUcA2v77d3d1O73d1ZypRwBgULkC46IXXdekGHKUcF1Bc1BobG6NUt1onccDwrr+/n/QWChfQ8FJSqxQN4l4AxvhmZmbE9PS0YajRTEtLS8EFNFpt+7W8AQxXNzY2ggeCuG6Pjo6K5eXluM2ttPMKcOkhJLyQOYrnHR0dIp/Pe7c63yvAANne3h6AigK1VOdfTkxJw9bRO8BwFF913CNHTfh9o7e3N2p1p/W8BAwCeMrL5Sr+PlIVTNK/0FUdlFLoLWA8hOzu7ipDrZ714Tfm6iN7LvUWMIYX5WJH+YBiAhXX5jXguE751I4BWz4bDJgBWyZgWZ4jmAFbJmBZniOYAVsmYFmeI5gBWyZgWZ4jmAFbJmBZniOYAVsmYFmeI5gBWyZgWd79ek4ih1pbWxNfdxbFlVcHGCt2sKAPq9V9f5uBE/BqAOOtMV6Ejo+Pe7f2wRTJ3gPGn2cWFhYivWE2OZqUzXvABwcHSbEh6Zdv00gw6kUYsJ4NiYUBk2DUizBgPRsSCwMmwagXYcB6NiQWBkyCUS/CgPVsSCwMmASjXoQB69mQWBgwCUa9CAPWsyGxMGASjHoRbFRyq5qxNw+neATC7MAWG5WcqnLY+IhTPAJhdmCLCD5R5bCrlDSoRZyPQADMwE5NYMvbnalEYuRrbXcW7Gl2dnb2VWp/jKHPTfQEjuQ/Vj8FgGV485aTelB1W+TUULnlpCy4xx6UUulI5vk2om6kzw1e2B2V9vNEaRDBqh5v+6vSqJ2XUI3b/v4BCUUGCBF8rH8AAAAASUVORK5CYII=",iconDoneHover1:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABYAAAAWCAYAAADEtGw7AAAAAXNSR0IArs4c6QAAARVJREFUOBHVlTGOhDAMRZ2ABBI0IChA4gaIBokeKm6zF5lmLsVFQFSIC+wIlk8xww7xLowy0q6r5Md+SSxbFn3fX6Zp+pjn2SQNJoS4SSmvouu6T9/3zQWsAUu0gGkcx5vES3VB8TKwwJRanqmA/D8wWwnDMFDbtopPPqQkSSgIgoewWbFgz/OoaRrCBSoLw5CyLFMdrRqbY8MwqKoqsixrF2zb9noGH85YMAJc16WyLHex0BzH2elb4UcwHOM4pjzP7zFFUVAURfc9t/gVjMBtLtM05Vjf9ENgtOlZOwQ+C4X/3wBzzaD6Edsgz851Xa8V8qxz+8OpQNmdscPgM1D4vg+MGfVKnXI/AAtME4NvmVHah+kX+HpAvOXxPzUAAAAASUVORK5CYII=",iconDoneHover2:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACwAAAAsCAYAAAAehFoBAAAAAXNSR0IArs4c6QAAAghJREFUWAntmU+KwjAUxl9rqYKg6EYriohLRUHEjVjErXeYa8xuFrOauYZ38ERiixu9gU6+Ykus1moSmQoJaPPn5b2fX2OaNMbpdLI9z/s+Ho8fROSwTxaTb5rmqtFofBnb7faHwX5mkTLOxKB/jc1m47EGp1KpEKsgpnjc7l/LhmEQE5QOhwM4fJN9BcMgi7AghIBgOycnymVN2ZAQV54tAuYNspzXwK++O1phrXBMAT0kYoIoL1oiHtfrNe12O5GuUZ9arUbL5TIqP5oRGhLz+Zzy+fyjMa7sCoUCwYdIEgIuFou0WCxE4hEWM+gLHyJJCBiBHMeh8Xj8dMzJZEL1ev3pfmEHYWA4GAwG1G63Q1+p1263S71eL9XunoEUMBzPZjMql8v3YgRt1WqVptNpql2agTSwbdvBmMzlcomxQhvLEpqULvxKA8Mbdiuu61445guYEUqlEl8lnFcCjOidTof6/f4VyGg0omazeVUvWqEMGAC3Zo3hcCjKdrOfUmBu7xUFw7yrMikFVgmW5EsDJymjql4rrErJJD9a4SRlVNXLP9wTSLDYUf3QQCjlwNj6YNnZarUSfopcNV63Bu9XoUiW036/D/D0n+7Vd0krrBWOKfC+Q0L1QjsmjFSRZ4PCPrzhaIlvkIqgsDOYwHZOvsW2NSscLJ7PwcKGTF7BarAjpbc6uv0DWY9m0aEBCdkAAAAASUVORK5CYII=",iconDoneHover3:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAFgAAABYCAYAAABxlTA0AAAAAXNSR0IArs4c6QAABLFJREFUeAHt3dlO3DAUBuCTYdh3EIJhEYhFCEasQpR9GfoG3PautA9Vlbve8gYVb8ETAOoFEhKoEkIIpv4RszhMasd2MkY6voA4Ocexv8kksySTgN5KsVgMrq6uToIg+Cpm5UW9o7SM/6sFhNtfEXUh3E5HR0d/inoRWQH+3Nzc5B4fH3+JhQXUudgJCNzz5ubmLwMDA38y2HIZ1w40nI0N9c00CC4vL7+JgB/hIK47EfiexT5XiJdba21tpa6uLnp5eaHn5+fyfJ6IFmhoaKBMJkP39/f08PBQDoRtRtTy5TliArhPT0+MW42imMaGCDPYhUoe+2Dp1QK2XC5mAmE72GILlgrvFiSOWJVadu+AY7XIwUoBBlYS2QUwsJ2fMpuBlUR2AQxs56fMZmAlkV0AA9v5KbMZWElkF8DAdn7KbAZWEtkFMLCdnzKbgZVEdgEMbOenzGZgJZFdAAPb+SmzGVhJZBfAwHZ+ymwGVhLZBWTt0vWzz87O6O7uTj8hwcju7m46Pj5OcA2VplPbgre3t0l8jV1Zc52m0IednZ3U1p4a8NDQEK2vr6c2sKgVbWxs0ODgYNRi5/NTA0bP8/k8TU5OOh+EboPT09M0NzenG+4kLlVg9BhPz97eXiedj9NIf38/bW1txUlxEps6cDabpUKhQI2NjU4GoNOIONORjo6OCOtOu6QOjAHiKL63t5faWA8PD6mjQzqBKbV11wUYoxsfH6elpaXEB7q2tkbDw8OJrydqBXUDRodWV1cpl8tF9c16/sTEBC0uLlq3Y9NAXYHxmhRP3/b2dpsx1Mzt6emh3d3dmsvSnFlXYAy0paXl9aDn8k0IDqA4qKV5II160OoOjI6JaxmcvoTCARQHUh+KF8CAmJ2dpZmZGWuT5eXl1wOodUOOGvAGGOPZ3NwkvCEwLSMjI7SysmKankieV8ClNyFNTU2xB9vZ2UkHBwdefKBU3XmvgNGxElR1J1XTuAgF7w7xjs234h0wgMSVkrGe6vh8w2bXkuSD4iUwBoyDFaBVZX5+nqamplRhdVvuLTBeF+/v7ythfPiM+X+d9BYYndbZp+ICQJ+L373zWU6zbwysCWUaxsCmcpp5DKwJZRrGwKZymnkMrAllGsbApnKaeQysCWUaxsCmcpp5DKwJZRrGwKZymnkMrAllGsbApnKaeQysCWUaxsCmcpp5DKwJZRqW/vmcpj0N5bW1tdHCwkJorn/VDweMX9cDLE5S8f3bDDzcHwa4r6/v9XRXnDHp8jy2pLd574FxwQpOQR0bG0vaIpH28fO2lZ9eFavAlsLFXOD29lZK5lcREof7CgO7N5VaZGCJw32Fgd2bSi0ysMThvsLA7k2lFhlY4nBfYWD3plKLDCxxuK8wsHtTqUUGljjcVxjYvanUIgNLHO4rDOzeVGrxHTCuOeNiJlDLLiO+HcCd/MrlI3wNU+6sZxNhO9hiC76o7idu2YWfAaj1aFTH8XRFAFYwg12oXGTFHaNOxcxPpQW4H1r1PdFK8/l/fAHYBuJPcH19/Vv8L8RvgjOiBMTu4Vxc/f8Z++AibvCJGVHBPD+eACzfTIvlH5PElsy3/Y0HWR0tUGve9vcfLHPLUFdwXvoAAAAASUVORK5CYII="},this.iconsList={},this.iconsListM={},this.init(this.iconSrc,this.iconsList),this.init(this.iconSrcM,this.iconsListM)}return(0,r.default)(e,[{key:"init",value:function(e,t){for(var n=(0,i.default)(e),o=0;o<n.length;o++){var r=n[o],a=e[r],s=new Image;s.src=a,t[r]=s}}}]),e}();t.default=s},1873:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=A(n(24)),o=A(n(3)),r=A(n(0)),a=A(n(1)),s=A(n(4)),l=A(n(5)),c=A(n(59)),u=A(n(46)),d=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(123)),p=A(n(243)),h=n(244),f=n(98),g=A(n(1874)),m=A(n(7)),v=A(n(1875)),b=n(764),w=A(n(307));function A(e){return e&&e.__esModule?e:{default:e}}n(1750);var y=m.default.document,x=function(e){function t(e){(0,r.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,{alloyExcel:e.excel}));return n.hide=function(){n.showing&&(n.dom.style.display="none",n.xIndex=-1,n.yIndex=-1,n.showing=!1,n._unbindEvent(),m.default.event.toolBar.trigger("validationListHide"))},n._sortAndFilterItems=function(e){if(""!==e){for(var t=[],i=n.originItems,o=i.length,r=e.toLowerCase(),a=0;a<o;a++){var s=i[a];-1!==s.toLowerCase().indexOf(r)&&t.push(s)}n.items=t}else n.items=n.originItems},n._searchAndSort=function(e){n._sortAndFilterItems(e);var t=n.calculateCenter.updateItems(n.items);n.panelHeight=t.height,n.panelWidth=t.width,n._reRender(),n._setCardPosition(t)},n._tableMove=function(){var e=n.calculateCenter.getMovedPosition();n._setCardPosition(e)},n._bindEvent=function(){var e=n.card;n.handDocumentClick=function(t){if(!1!==t.isTrusted){var i=t.target;if(!(i===e||e.contains(i)||i.classList.contains("label-span")||i.classList.contains("excel-container")||n.spreadsheetApp.view.canvas.container.contains(i))){var o=n.spreadsheetApp.view.canvas.excel.inputCenter.board;o&&o.board&&o.board.contains&&o.board.contains(i)||n.hide()}}},(0,h.addEvent)(y,"click",n.handDocumentClick,!0),n.addHook("tableMove",n._tableMove),n.addHook("selectionShow",n._selectionShow),n.stage.event.eventTable.listen("scale",n._tableMove),n.stage.event.eventMenu.listen("tableMenuShowed",n.hide),n.stage.event.eventInput.listen("editorValueChange",n._searchAndSort)},n._unbindEvent=function(){(0,h.removeEvent)(y,"click",n.handDocumentClick,!0),n.removeHook("tableMove",n._tableMove),n.removeHook("selectionShow",n._selectionShow),n.stage.event.eventTable.remove("scale",n._tableMove),n.stage.event.eventMenu.remove("tableMenuShowed",n.hide),n.stage.event.eventInput.remove("editorValueChange",n._searchAndSort)},n._selectionShow=function(e){if(e){var t=e.activeChange,i=e.selectChange;t?n.hide():i&&n.hide()}},n._handleSelect=function(e){n.stage.inputCenter.board.showing?(n.stage.setCellEditorValueWhenActive(e),n.stage.overActiveEditor()):w.default.Api.userEnter({text:e,colIndex:n.xIndex,rowIndex:n.yIndex}),n.hide()},n.spreadsheetApp=e.spreadsheetApp,n.excel=e.excel,n.showing=!1,n.locateType=p.default.constant.PLUGIN_LOCATE_TYPE.BODY,n.stopPropagationSlots=p.default.constant.PLUGIN_EVENT_STOP.SLOT_ALL,n.dom=n._initUI(),(0,c.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"init",n).call(n),n.calculateCenter=new g.default(n.spreadsheetApp),n}return(0,l.default)(t,e),(0,a.default)(t,[{key:"show",value:function(e){if(this.xIndex=e.x,this.yIndex=e.y,this.triggerBy=e.triggerBy,this.triggerBy!==b.LIST_TRIGGER_BY.ENTER_EDIT||!this.spreadsheetApp.view.canvas.excel.formulaBoard.showType){this._initData(),this.showing=!0,this.spreadsheetApp.view.canvas.pluginsApi.cardCenter.hideAll();var t=this.spreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e.y,e.x),n=t?t.getEditValue():"";n=null===n?"":n,this.card.style.cssText=this._getStyle(),d.render(this._render(),this.card),m.default.event.toolBar.trigger("validationListShow")}}},{key:"_initUI",value:function(){var e=y.createElement("div");return e.classList.add("validation-list-container"),this.card=e,e}},{key:"_initData",value:function(){var e=(0,f.getDropDownValues)(this.yIndex,this.xIndex);this.items=e||[],this.originItems=[].concat((0,i.default)(this.items))}},{key:"_setCardPosition",value:function(e){this.card.style.left=e.left+"px",this.card.style.top=e.top+"px",this.card.style.display=e.hidden?"none":"block"}},{key:"_reRender",value:function(){this.showing&&this._unbindEvent(),d.render(this._render(),this.card)}},{key:"_render",value:function(){var e=this,t=(new Date).getTime();return u.default.createElement(v.default,{items:this.items,moundedCb:function(){e._bindEvent()},selectCb:this._handleSelect,key:t,width:this.panelWidth,height:this.panelHeight})}},{key:"_getStyle",value:function(){var e=this.calculateCenter.init({yIndex:this.yIndex,xIndex:this.xIndex,items:this.items}).getPanelInfo();return this.panelHeight=e.height,this.panelWidth=e.width,"position: absolute; z-index: 501; pointer-events: auto;; left:"+e.left+"px; top:"+e.top+"px;"}},{key:"isShowing",get:function(){return this.showing}}]),t}(p.default.AlloyExcelUIPlugin);t.default=x},1874:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=u(n(41)),r=u(n(14)),a=u(n(0)),s=u(n(1)),l=n(174),c=n(1711);function u(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.NOT=0]="NOT",e[e.ALL=1]="ALL",e[e.PART=2]="PART"}(i||(i={}));var d=function(){function e(t){(0,a.default)(this,e),this.configs={fontSize:14,lineHeight:32,minWidth:107,maxWidth:480,maxHeight:375,paddingWidth:50,paddingHeight:18,panelMargin:2},this.app=t}return(0,s.default)(e,[{key:"init",value:function(e){return this.yIndex=e.yIndex,this.xIndex=e.xIndex,this.items=e.items,this.calcInputWidth=new l.CalcInputWidth(this.configs.fontSize),this}},{key:"getPanelInfo",value:function(){if(this._isPanelShouldHide())return{hidden:!0,top:0,left:0,width:0,height:0};var e=this._calcArea(),t=(0,r.default)({},e,{height:e.height}),n=this._calcPosition(t);return this.width=t.width,this.height=t.height,this.isLeft=n.isLeft,this.isTop=n.isTop,(0,r.default)({},e,{top:n.top,left:n.left,hidden:!1})}},{key:"getMovedPosition",value:function(){if(this._isPanelShouldHide())return{hidden:!0,top:0,left:0};var e=this._reCalcPosition();return(0,r.default)({hidden:!1},e)}},{key:"updateItems",value:function(e){this.items=e;var t=this._calcArea(),n=t.width,i=t.height;if(this.width=n,this.height=i+this.configs.paddingHeight,this._isPanelShouldHide())return{hidden:!0,top:0,left:0,width:0,height:0};var o=this._reCalcPosition();return(0,r.default)({hidden:!1,width:n,height:i},o)}},{key:"_isPanelShouldHide",value:function(){var e=this.yIndex,t=this.xIndex;return!(0,c.isCellInVision)(this.app,e,t)}},{key:"_getVisionArea",value:function(){var e=this.xIndex,t=this.yIndex,n=this.app.view.canvas.excel.configData,i=n.colHeadHeight,o=n.rowHeadWidth,r=this.app.view.canvas.excel.areaData,a=void 0,s=void 0,l=r.col.frozen.viewWidth+r.col.flow.viewWidth,c=r.row.frozen.viewHeight+r.row.flow.viewHeight,u=r.row.frozen.from,d=r.row.frozen.to,p=r.col.frozen.from,h=r.col.frozen.to;return t>=u&&t<=d?e>=p&&e<=h?(a=r.col.frozen.viewStart,s=r.row.frozen.viewStart):(a=r.col.flow.viewStart,s=r.row.frozen.viewStart):e>=p&&e<=h?(a=r.col.frozen.viewStart,s=r.row.flow.viewStart):(a=r.col.flow.viewStart,s=r.row.flow.viewStart),{x:a-o,y:s-i,width:l-12,height:c-12}}},{key:"_checkInVision",value:function(e){var t=this._getVisionArea(),n=t.x,o=t.y,r=t.height,a=n+t.width,s=o+r,l=e.x,c=e.y,u=e.height,d=l+e.width,p=c+u;return d<n||p<o||l>a||c>s?i.NOT:l>n&&d<a&&c>o&&p<s?i.ALL:i.PART}},{key:"_isOnTop",value:function(){var e=this._getCellPositon(),t=e.startY,n=e.endY,i=this._getVisionArea(),o=i.height-n-12;return t-i.y>o}},{key:"_isOnLeft",value:function(){var e=this._getCellPositon(),t=e.startX,n=e.endX,i=this._getVisionArea();return i.width-n-12>t-i.x}},{key:"_getCellPositon",value:function(){var e=this.app.view.canvas.excel.configData,t=e.colHeadHeight,n=e.rowHeadWidth,i=this.yIndex,r=this.xIndex,a=this.app.view.canvas.excel.cells.getRealPosition(r,i),s=(0,o.default)(a.posX,2),l=s[0],c=s[1],u=(0,o.default)(a.posY,2),d=u[0],p=u[1];return{startX:l-=n,endX:c-=n,startY:d-=t,endY:p-=t}}},{key:"_getCellOffset",value:function(e){if(!this.app.view.canvas.excel.inputCenter.board.showing)return{x:0,y:0};var t=this._getCellPositon(),n=t.startX,i=t.startY,o=this._getVisionArea(),r=o.x,a=o.y,s=0,l=0;return n<r&&(s=r-n),i<a&&!e.isTop&&(l=a-i),{x:s,y:l}}},{key:"_calcPosition",value:function(e){var t=this.configs.panelMargin,n=this._getCellPositon(),o=n.startX,a=n.endX,s=n.startY,l=n.endY,c=o,u=l+t,d=!0,p=!1,h=!0;this._checkInVision((0,r.default)({x:c,y:u},e))!==i.ALL?(c=a-e.width,u=l+t,d=!1,p=!1,h=!1):d=!0,d||this._checkInVision((0,r.default)({x:c,y:u},e))===i.ALL?d=!0:(c=o,u=s-e.height-t,d=!1,p=!0,h=!0),d||this._checkInVision((0,r.default)({x:c,y:u},e))===i.ALL?d=!0:(c=a-e.width,u=s-e.height-t,d=!1,p=!0,h=!1),d||(p=this._isOnTop(),c=(h=this._isOnLeft())?o:a-e.width,u=p?s-e.height-t:l+t);var f=this._getCellOffset({isLeft:h,isTop:p});return{top:u+f.y,left:c+f.x,isTop:p,isLeft:h}}},{key:"_reCalcPosition",value:function(){var e=this.configs.panelMargin,t=this._getCellPositon(),n=t.startX,i=t.endX,o=t.startY,r=t.endY,a=this.isLeft?n:i-this.width,s=this.isTop?o-this.height-e:r+e,l=this._getCellOffset({isLeft:this.isLeft,isTop:this.isTop});return{top:s+l.y,left:a+l.x}}},{key:"_calcArea",value:function(){var e=this.configs,t=e.lineHeight,n=e.maxHeight,i=e.maxWidth,o=e.minWidth,r=e.paddingWidth,a=e.paddingHeight,s=this._calcFontsWidth()+r,l=this.items.length*t+a;return s>i&&(s=i),s<o&&(s=o),l>n&&(l=n,s+=10),{width:s,height:l}}},{key:"_calcFontsWidth",value:function(){return this.calcInputWidth.calc(this.items.join("\n"),{whiteSpace:"pre"})}}]),e}();t.default=d},1875:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=u(n(3)),o=u(n(0)),r=u(n(1)),a=u(n(4)),s=u(n(5)),l=u(n(46)),c=u(n(1689));function u(e){return e&&e.__esModule?e:{default:e}}n(1750);var d=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleSelect=function(e){n.props.selectCb&&n.props.selectCb(e)},n.items=n.props.items,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.props.moundedCb&&this.props.moundedCb()}},{key:"render",value:function(){return l.default.createElement("div",null,l.default.createElement(c.default,{onClick:this.handleSelect,style:{height:this.props.height,width:this.props.width,overflowY:"auto"}},this.items.map(function(e){return l.default.createElement(c.default.Item,{id:e,key:e},l.default.createElement("div",{className:"validation-list-item"},e))})))}}]),t}(l.default.Component);t.default=d},1876:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".validation-list-container .dui-menu {\n  padding: 8px 0px;\n}\n.validation-list-container .dui-menu .dui-menu-item {\n  height: 32px;\n  padding: 0 24px;\n}\n.validation-list-container .dui-menu .dui-menu-item .validation-list-item {\n  display: inline-block;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  width: 100%;\n}\n",""])},1877:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=v(n(3)),o=v(n(0)),r=v(n(1)),a=v(n(4)),s=v(n(5)),l=v(n(243)),c=n(310),u=n(98),d=n(764),p=n(1711),h=n(22),f=n(82),g=v(n(12)),m=n(33);function v(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));n._showFormula=function(){var e=n.app.view.canvas.plugins.validationListCard;n.stage.formulaBoard.showType&&n.stage.inputCenter.board.showing&&e&&e.hide()},n._hideFormula=function(){var e=n.app.view.canvas.plugins.validationListCard;if(!n.stage.formulaBoard.showType&&n.stage.inputCenter.board.showing){var t=n.stage.selectData.active,i=t.xIndex,o=t.yIndex;n.isCellContainList(o,i)&&e&&e.show({y:o,x:i,triggerBy:d.LIST_TRIGGER_BY.ENTER_EDIT})}},n._preRender=function(e){n.stage.areaData;var t=[],i=n.stage.selectData.active;!function(i,o){if(n._isCellToRenderList(i,o)){n._clearHeader(e,i,o),n._renderHeader(e,i,o);var r=(0,p.getMergeRange)(n.app,i,o);r&&t.push(r)}}(i.yIndex,i.xIndex)},n._renderHeader=function(e,t,i){var o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],r=(0,p.cellToMasterCell)(n.app,t,i),a=r.row,s=r.col,c=(n.stage.tableData.getCellDataAtPosition(a,s,l.default.constant.GET_CELLDATA.DEFAULT),n._getIcon(a,s,o)),u=n._getIconInfo(a,s),d=n._getButtonInfo(a,s),h=n.stage.areaData.col.getArea(s),f=n.stage.areaData.row.getArea(a);d.x>h.maxDistance||d.x+d.width<h.viewStart||d.y>f.maxDistance||d.y+d.height<f.viewStart||(n.renderedCell={x:s,y:a},e.save(),n._clipCellArea(e,a,s),o&&(c.isDark?e.fillStyle="rgba(255, 255, 255, 0.64)":e.fillStyle="rgba(0, 0, 0, 0.04)",e.roundRect(d.x,d.y,d.width,d.height,n.radius),e.fill()),e.drawImage(c.iconImg,u.x,u.y,u.width,u.height),e.restore())},n._clearHeader=function(e,t,i){var o=(0,p.cellToMasterCell)(n.app,t,i),r=o.row,a=o.col,s=n.stage.tableData.getCellDataAtPosition(r,a,l.default.constant.GET_CELLDATA.DEFAULT),c=(n._getIconInfo(r,a),n._getButtonInfo(r,a)),u=n.stage.areaData.col.getArea(a),d=n.stage.areaData.row.getArea(r);c.x>u.maxDistance||c.x+c.width<u.viewStart||c.y>d.maxDistance||c.y+c.height<d.viewStart||(n.renderedCell={x:-1,y:-1},e.save(),n._clipCellArea(e,r,a),e.beginPath(),e.fillStyle=s.getBackgroundColor(),e.rect(c.x,c.y,c.width,c.height),e.fill(),e.closePath(),e.restore())},n._mouseMove=function(e){var t=e.lastCell,i=t.x,o=t.y,r=e.newCell,a=r.x,s=r.y,l=n.cacheRender,c=l.x,u=l.y,d=(0,p.cellToMasterCell)(n.app,o,i);o=d.row,i=d.col,s=(d=(0,p.cellToMasterCell)(n.app,s,a)).row,a=d.col,i>-1&&o>-1&&c===i&&u===o&&n._isCellToRenderList(u,c)&&(n._clearHeader(n.stage.ctx,u,c),n._renderHeader(n.stage.ctx,u,c,!1)),a<0||s<0||n._isCellToRenderList(s,a)&&n._isInHeader(s,a)&&(n._clearHeader(n.stage.ctx,s,a),n._renderHeader(n.stage.ctx,s,a,!0),n.cacheRender.x=a,n.cacheRender.y=s)},n._mouseDown=function(e){2!==n.stage.mouseData.button&&n._isCellToRenderList(e.y,e.x)&&n._isInHeader(e.y,e.x)&&n._showListCard(e.y,e.x)},n._tap=function(e){n._isCellToRenderList(e.y,e.x)&&n._isInHeader(e.y,e.x)&&(n.stage.touchData.response.push("validationListHeader"),n.stage.touchData.stopSelect=!0,g.default.wait(50).run(function(){n._clearHeader(n.stage.ctx,e.y,e.x),n._renderHeader(n.stage.ctx,e.y,e.x,!0),n.stage.selectCell(e.x,e.y,!1),g.default.wait(150).run(function(){n._clearHeader(n.stage.ctx,e.y,e.x),n._renderHeader(n.stage.ctx,e.y,e.x,!1),n._showListCard(e.y,e.x)})}))},n.app=e.spreadsheetApp,n.getSheet=e.getSheet,n.cacheRender={x:null,y:null},n.renderedCell={x:-1,y:-1},n.showBoard=!1;var r=void 0,s=void 0;return h.isMobile?(n._headerWidth=22,n._iconWidth=9,n._iconHeight=6,n._radius=2,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTggMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjYgKDY3NDkxKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5SZWN0YW5nbGUgQ29weSA1PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC40MDAwMDAwMDYiPgogICAgICAgIDxnIGlkPSJFeGNlbC3nrZvpgIkmYW1wO+mqjOivgS1ub3JtYWwt56e75Yqo56uvIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNDIxLjAwMDAwMCwgLTQzMC4wMDAwMDApIiBmaWxsPSIjRkZGRkZGIiBmaWxsLXJ1bGU9Im5vbnplcm8iPgogICAgICAgICAgICA8cG9seWdvbiBpZD0iUmVjdGFuZ2xlLUNvcHktNSIgcG9pbnRzPSI0MjEgNDMwIDQzOSA0MzAgNDMwLjA0Mzg3NyA0NDIiPjwvcG9seWdvbj4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",(s=new Image).src=r,n.iconDarkBG=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTggMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjYgKDY3NDkxKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5SZWN0YW5nbGUgQ29weSA1PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC42Mzk5OTk5ODYiPgogICAgICAgIDxnIGlkPSJFeGNlbC3nrZvpgIkmYW1wO+mqjOivgS1ob3Zlci3np7vliqjnq68tQ29weSIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQyMS4wMDAwMDAsIC00MzAuMDAwMDAwKSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlJlY3RhbmdsZS1Db3B5LTUiIHBvaW50cz0iNDIxIDQzMCA0MzkgNDMwIDQzMC4wNDM4NzcgNDQyIj48L3BvbHlnb24+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",(s=new Image).src=r,n.iconDarkBGHover=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTggMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjYgKDY3NDkxKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5SZWN0YW5nbGUgQ29weTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwb2x5Z29uIGlkPSJwYXRoLTEiIHBvaW50cz0iNDIxIDMwMCA0MzkgMzAwIDQzMC4wNDM4NzcgMzEyIj48L3BvbHlnb24+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUkQtRXhjZWwtMS445a6a56i/IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iRXhjZWwt562b6YCJJmFtcDvpqozor4Etbm9ybWFsLeenu+WKqOerryIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQyMS4wMDAwMDAsIC0zMDAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgPHVzZSBpZD0iUmVjdGFuZ2xlLUNvcHkiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyIgb3BhY2l0eT0iMC40MDAwMDAwMDYiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",(s=new Image).src=r,n.iconLightBG=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMThweCIgaGVpZ2h0PSIxMnB4IiB2aWV3Qm94PSIwIDAgMTggMTIiIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUyLjYgKDY3NDkxKSAtIGh0dHA6Ly93d3cuYm9oZW1pYW5jb2RpbmcuY29tL3NrZXRjaCAtLT4KICAgIDx0aXRsZT5SZWN0YW5nbGUgQ29weTwvdGl0bGU+CiAgICA8ZGVzYz5DcmVhdGVkIHdpdGggU2tldGNoLjwvZGVzYz4KICAgIDxkZWZzPgogICAgICAgIDxwb2x5Z29uIGlkPSJwYXRoLTEiIHBvaW50cz0iNDIxIDMwMCA0MzkgMzAwIDQzMC4wNDM4NzcgMzEyIj48L3BvbHlnb24+CiAgICA8L2RlZnM+CiAgICA8ZyBpZD0iUkQtRXhjZWwtMS445a6a56i/IiBzdHJva2U9Im5vbmUiIHN0cm9rZS13aWR0aD0iMSIgZmlsbD0ibm9uZSIgZmlsbC1ydWxlPSJldmVub2RkIj4KICAgICAgICA8ZyBpZD0iRXhjZWwt562b6YCJJmFtcDvpqozor4Etbm9ybWFsLeenu+WKqOerryIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTQyMS4wMDAwMDAsIC0zMDAuMDAwMDAwKSI+CiAgICAgICAgICAgIDxtYXNrIGlkPSJtYXNrLTIiIGZpbGw9IndoaXRlIj4KICAgICAgICAgICAgICAgIDx1c2UgeGxpbms6aHJlZj0iI3BhdGgtMSI+PC91c2U+CiAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICAgICAgPHVzZSBpZD0iUmVjdGFuZ2xlLUNvcHkiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyIgb3BhY2l0eT0iMC40MDAwMDAwMDYiIHhsaW5rOmhyZWY9IiNwYXRoLTEiPjwvdXNlPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",(s=new Image).src=r,n.iconLightBGHover=s):(n._headerWidth=18,n._iconWidth=8,n._iconHeight=5,n._radius=1,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjVweCIgdmlld0JveD0iMCAwIDggNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPlJlY3RhbmdsZSBDb3B5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC42Mzk5OTk5ODYiPgogICAgICAgIDxnIGlkPSJleGNlbF/nrZvpgIkmYW1wO+aVsOaNrumqjOivgeeureWktC3mt7HoibIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMjEuMDAwMDAwLCAtMjA1LjAwMDAwMCkiIGZpbGw9IiNGRkZGRkYiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgIDxnIGlkPSLliIbnu4QtMiIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzE2LjAwMDAwMCwgMTk4LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgPHBvbHlnb24gaWQ9IlJlY3RhbmdsZS1Db3B5IiBwb2ludHM9IjUgNyAxMyA3IDkuMDE5NTAwODYgMTIiPjwvcG9seWdvbj4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+",(s=new Image).src=r,n.iconDarkBG=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjVweCIgdmlld0JveD0iMCAwIDggNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPlJlY3RhbmdsZSBDb3B5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC42Mzk5OTk5ODYiPgogICAgICAgIDxnIGlkPSJleGNlbF/nrZvpgIkmYW1wO+aVsOaNrumqjOivgeeureWktC3mt7HoibItaG92ZXIiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0zMjEuMDAwMDAwLCAtMjA1LjAwMDAwMCkiIGZpbGw9IiMwMDAwMDAiIGZpbGwtcnVsZT0ibm9uemVybyI+CiAgICAgICAgICAgIDxnIGlkPSLmlbDmja7pqozor4EtaG92ZXIt5rex6ImyIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgzMTYuMDAwMDAwLCAxOTguMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8cG9seWdvbiBpZD0iUmVjdGFuZ2xlLUNvcHkiIHBvaW50cz0iNSA3IDEzIDcgOS4wMTk1MDA4NiAxMiI+PC9wb2x5Z29uPgogICAgICAgICAgICA8L2c+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4=",(s=new Image).src=r,n.iconDarkBGHover=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjVweCIgdmlld0JveD0iMCAwIDggNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPlJlY3RhbmdsZSBDb3B5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC40MDAwMDAwMDYiPgogICAgICAgIDxnIGlkPSJleGNlbF/nrZvpgIkmYW1wO+aVsOaNrumqjOivgeeureWktCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyMS4wMDAwMDAsIC0xNTkuMDAwMDAwKSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGcgaWQ9IuaVsOaNrumqjOivgS1ub3JtYWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMxNi4wMDAwMDAsIDE1Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJSZWN0YW5nbGUtQ29weSI+CiAgICAgICAgICAgICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI1IDcgMTMgNyA5LjAxOTUwMDg2IDEyIj48L3BvbHlnb24+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",(s=new Image).src=r,n.iconLightBG=s,r="data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iOHB4IiBoZWlnaHQ9IjVweCIgdmlld0JveD0iMCAwIDggNSIgdmVyc2lvbj0iMS4xIiB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIj4KICAgIDwhLS0gR2VuZXJhdG9yOiBTa2V0Y2ggNTIuNiAoNjc0OTEpIC0gaHR0cDovL3d3dy5ib2hlbWlhbmNvZGluZy5jb20vc2tldGNoIC0tPgogICAgPHRpdGxlPlJlY3RhbmdsZSBDb3B5PC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTEuOOWumueovyIgc3Ryb2tlPSJub25lIiBzdHJva2Utd2lkdGg9IjEiIGZpbGw9Im5vbmUiIGZpbGwtcnVsZT0iZXZlbm9kZCIgb3BhY2l0eT0iMC40MDAwMDAwMDYiPgogICAgICAgIDxnIGlkPSJleGNlbF/nrZvpgIkmYW1wO+aVsOaNrumqjOivgeeureWktCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoLTMyMS4wMDAwMDAsIC0xNTkuMDAwMDAwKSIgZmlsbD0iIzAwMDAwMCIgZmlsbC1ydWxlPSJub256ZXJvIj4KICAgICAgICAgICAgPGcgaWQ9IuaVsOaNrumqjOivgS1ub3JtYWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDMxNi4wMDAwMDAsIDE1Mi4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxnIGlkPSJSZWN0YW5nbGUtQ29weSI+CiAgICAgICAgICAgICAgICAgICAgPHBvbHlnb24gcG9pbnRzPSI1IDcgMTMgNyA5LjAxOTUwMDg2IDEyIj48L3BvbHlnb24+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==",(s=new Image).src=r,n.iconLightBGHover=s),n.addHook("afterRender",function(e){var t=n.stage.selectData.active,i=n.stage.tableData.getCellDataAtPosition(t.yIndex,t.xIndex,l.default.constant.GET_CELLDATA.DEFAULT);n._isCellToRenderList(t.yIndex,t.xIndex)&&i.paddingRight<2*m.CELL_FONT_FORMAT.PADDING_RIGHT+1?n._updatePaddingRight():n._preRender(e)}),n.addHook("selectionShow",function(e){e&&e.activeChange&&n._updatePaddingRight()}),n.getSheet()!==n.app.spreadsheet.activeSheet?(0,a.default)(n):(h.isPc?(n.addHook("mouseDown",n._mouseDown),n.addHook("mouseMove",n._mouseMove)):n.addHook("tap",n._tap),h.isMobile||(n.stage.event.eventFormula.listen("showFormula",n._showFormula),n.stage.formulaBoard.showType&&n.stage.event.eventFormula.listen("hideFormula",n._hideFormula)),n)}return(0,s.default)(t,e),(0,r.default)(t,[{key:"_updatePaddingRight",value:function(){var e=this.stage.selectData.active,t=e.yIndex,n=e.xIndex,i=[];if(this._isCellToRenderList(t,n)){var o={};o[l.default.constant.SET_CELLDATA.STYLE]={paddingRight:h.isMobile?m.CELL_FONT_FORMAT.PADDING_RIGHT_FILTER_M:m.CELL_FONT_FORMAT.PADDING_RIGHT_FILTER},i.push([n,t,o])}var r=this.renderedCell,a=r.x,s=r.y;if(a>-1&&s>-1&&(a!==n||s!==t)){var c=m.CELL_FONT_FORMAT.PADDING_RIGHT;this._isCellContainFilter(s,a)&&(c=h.isMobile?m.CELL_FONT_FORMAT.PADDING_RIGHT_FILTER_M:m.CELL_FONT_FORMAT.PADDING_RIGHT_FILTER);var u={};u[l.default.constant.SET_CELLDATA.STYLE]={paddingRight:c},i.push([a,s,u]),this.renderedCell={x:-1,y:-1}}i.length>0&&(this.stage.event.eventCell.trigger("setCellsData",{infos:i}),this.stage.renderNextTick())}},{key:"isCellContainList",value:function(e,t){var n=(0,p.cellToMasterCell)(this.app,e,t),i=(0,u.getUIDVAtPosition)(n.row,n.col);return!(!i||i.validType!==c.VALID_TYPE.LIST)}},{key:"isCellContainListButNoHeader",value:function(e,t){return this.isCellContainList(e,t)&&!this._isCellToRenderList(e,t)}},{key:"_isCellToRenderList",value:function(e,t){var n=this.stage.selectData.active;if(e!==n.yIndex||t!==n.xIndex)return!1;if(this.stage.inputCenter.board.showing){var i=this.stage.inputCenter,o=i.x,r=i.y;if(o===t&&r===e)return!1}return!this._isCellContainFilter(e,t)&&(!(0,p.isCellBeenHidden)(this.app,e,t)&&this.isCellContainList(e,t))}},{key:"_getIcon",value:function(e,t,n){var i=this.stage.tableData.getCellDataAtPosition(e,t,l.default.constant.GET_CELLDATA.DEFAULT),o=(0,p.hexToRgb)(i.getBackgroundColor()),r=!(.299*o[0]+.587*o[1]+.114*o[2]>192);return{isDark:r,iconImg:r?n?this.iconDarkBGHover:this.iconDarkBG:n?this.iconLightBGHover:this.iconLightBG}}},{key:"_getButtonInfo",value:function(e,t){var n=this.stage.tableData.getCellDataAtPosition(e,t,l.default.constant.GET_CELLDATA.DEFAULT),i=this.stage.tableData.getCellBackgroundHeight(e,t,!1),o=0;switch(n.verticalAlign){case l.default.constant.VERTICAL_ALIGN.MIDDLE:o=(i-this.headerWidth)/2;break;case l.default.constant.VERTICAL_ALIGN.TOP:o=1;break;case l.default.constant.VERTICAL_ALIGN.BOTTOM:o=i-1-this.headerWidth}var r=this.stage.areaData.col.getViewportLeft(t),a=this.stage.areaData.row.getViewportTop(e)+o;return{x:r+this.stage.tableData.getCellBackgroundWidth(e,t,!1)-n.paddingRight+m.CELL_FONT_FORMAT.PADDING_RIGHT,y:a,width:this.headerWidth,height:this.headerWidth}}},{key:"_getButtonAABB",value:function(e,t){var n=this._getButtonInfo(e,t);return[n.x,n.y,n.width,n.height]}},{key:"_getIconInfo",value:function(e,t){var n=this._getButtonInfo(e,t),i=(n.height-this.iconHeight)/2+1,o=(n.width-this.iconWidth)/2;return{x:n.x+o,y:n.y+i,width:this.iconWidth,height:this.iconHeight}}},{key:"_clipCellArea",value:function(e,t,n){var i=this.stage.tableData.getCellDataAtPosition(t,n,l.default.constant.GET_CELLDATA.DEFAULT),o=this._getButtonInfo(t,n),r=this.stage.areaData.col.getArea(n),a=this.stage.areaData.row.getArea(t),s=this.stage.areaData.row.getViewportTop(t),c=this.stage.tableData.getCellBackgroundHeight(t,n,!1),u=this.stage.areaData.col.getViewportLeft(n),d=this.stage.tableData.getCellBackgroundWidth(t,n,!1);s<a.viewStart&&(c-=a.viewStart-s),u<r.viewStart&&(d-=r.viewStart-u),e.beginPath(),e.fillStyle=i.getBackgroundColor();var p=Math.max(r.viewStart,o.x,u+1),h=Math.max(a.viewStart,o.y,s+1);e.rect(p,h,Math.min(r.maxDistance-p,o.width,d-2),Math.min(a.maxDistance-h,o.height,c-2)),e.fill(),e.closePath(),e.clip()}},{key:"_showListCard",value:function(e,t){if(this.app.sheetStatus.permission.gEditable)if(this.app.view.canvas.pluginsApi.cardCenter.hideAll(),h.isMobile){var n=this.app.view.plugins.validationListPanel;n&&n.isVDListShowWithCell(e,t)?n.close():n&&n.isPanelShowing()?n.close(function(){n.show(e,t)}):n&&n.show(e,t),this.app.event.default.trigger(f.EVENT_NAME.UI_SHOW,"validation-list-card-m")}else this.app.view.canvas.plugins.validationListCard&&this.app.view.canvas.plugins.validationListCard.show({y:e,x:t,triggerBy:d.LIST_TRIGGER_BY.CLICK_HEADER})}},{key:"_closeListCardM",value:function(e){var t=this.app.view.plugins.validationListPanel;t&&t.isPanelShowing()&&t&&t.close()}},{key:"_isInHeader",value:function(e,t){if(!this.app.sheetStatus.permission.gEditable)return!1;if(e!==this.renderedCell.y||t!==this.renderedCell.x)return!1;var n=this._getButtonAABB(e,t),i=void 0;return i=h.isPc?{x:this.stage.mouseData.currX,y:this.stage.mouseData.currY}:{x:this.stage.touchData.currX,y:this.stage.touchData.currY},!!(0,p.checkIsIn)(i,n)}},{key:"_isCellContainFilter",value:function(e,t){var n=this.app.spreadsheet.activeSheet.getBasicFilter();if(n){var i=n.range;if(e===i.startRowIndex&&t>=i.startColIndex&&t<=i.endColIndex)return!0}return!1}},{key:"headerWidth",get:function(){return this._headerWidth*this.stage.tableData.scale>>0}},{key:"iconWidth",get:function(){return this._iconWidth*this.stage.tableData.scale>>0}},{key:"iconHeight",get:function(){return this._iconHeight*this.stage.tableData.scale>>0}},{key:"radius",get:function(){return this._radius*this.stage.tableData.scale>>0}}]),t}(l.default.AlloyExcelPlugin);t.default=b},1878:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=g(n(3)),o=g(n(0)),r=g(n(1)),a=g(n(4)),s=g(n(5)),l=g(n(59)),c=g(n(243));n(1879);var u,d=n(33),p=n(112),h=g(n(7)),f=g(n(8));function g(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.NO_NUMBER=0]="NO_NUMBER",e[e.BEYOND_LIMIT=1]="BEYOND_LIMIT",e[e.TOO_MANY=2]="TOO_MANY"}(u||(u={}));var m=!1,v=!1,b=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));return n.checkShowHide=function(){n.stage.areaData.row.flow.to>=n.stage.areaData.row.flow.length-1?(n.update(),n.show()):n.hide()},n.update=function(){n.wrap.style.top=n.stage.areaData.row.getViewportTop(n.stage.areaData.row.flow.to+1)-n.stage.configData.colHeadHeight+"px",n.wrapContainer.style.top=n.stage.configData.colHeadHeight+1+"px"},n.show=function(){n.showing||(n.showing=!0,n.dom.style.display="block",f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"show_insert_row"}))},n.hide=function(){n.showing&&(n.showing=!1,n.dom.style.display="none")},n.switchSheet=function(){n.hideError(),n.setInputValue()},n.spreadsheetApp=e.spreadsheetApp,n.locateType=c.default.constant.PLUGIN_LOCATE_TYPE.GLOBAL,n.dom=n.initUI(),n.showing=!1,n.initMouse(),(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"init",n).call(n),n.sheetPool={},n.setInputValue(),n.stage.changeOffsetY({active:90,input:90}),n.addHook("afterRender",n.checkShowHide),h.default.event.sheetsBar.listen("switchSheetEnd",n.switchSheet),n.listenPermissionsStatusChange(),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"listenPermissionsStatusChange",value:function(){var e=this;this.spreadsheetApp.sheetStatus.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){this.hide(),this.removeHook("afterRender",this.checkShowHide)}},{key:"switchToEditable",value:function(){this.addHook("afterRender",this.checkShowHide)}},{key:"initUI",value:function(){return this.wrapContainer=document.createElement("div"),this.wrapContainer.className="expand-row-container",this.wrap=document.createElement("div"),this.wrap.className="expand-row-wrap",this.info1=document.createElement("div"),this.info1.className="expand-row-info",this.info1.innerText="\u5728\u5e95\u90e8\u6dfb\u52a0",this.wrap.appendChild(this.info1),this.input=document.createElement("input"),this.input.className="expand-row-input",this.input.setAttribute("type","text"),this.wrap.appendChild(this.input),this.info2=document.createElement("div"),this.info2.className="expand-row-info",this.info2.innerText="\u884c",this.wrap.appendChild(this.info2),this.button=document.createElement("button"),this.button.className="expand-row-button",this.button.innerText="\u6dfb\u52a0",this.wrap.appendChild(this.button),this.error=document.createElement("div"),this.error.className="expand-row-error",this.wrap.appendChild(this.error),this.wrapContainer.appendChild(this.wrap),this.wrapContainer}},{key:"initMouse",value:function(){var e=this;this.wrap.addEventListener("mousedown",function(e){e.stopPropagation()}),this.button.addEventListener("click",function(){e.expandRows()}),this.input.addEventListener("keydown",function(t){13===t.keyCode&&e.expandRows()}),this.input.addEventListener("blur",function(t){var n=parseInt(e.input.value);isNaN(n)||(e.sheetPool[e.spreadsheetApp.spreadsheet.getActiveSheetId()]=n)})}},{key:"setInputValue",value:function(){if(void 0===this.sheetPool[this.spreadsheetApp.spreadsheet.getActiveSheetId()]){var e=this.getRecommendRows();this.input.value=String(e),this.sheetPool[this.spreadsheetApp.spreadsheet.getActiveSheetId()]=e}else this.input.value=this.sheetPool[this.spreadsheetApp.spreadsheet.getActiveSheetId()]}},{key:"getRowCount",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet;return d.MAX_CELL_COUNT/e.getColCount()>>0}},{key:"getValidRows",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet;return this.getRowCount()-e.getRowCount()}},{key:"getRecommendRows",value:function(){var e=this.getValidRows();return e<0?(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_under10"}),0):e>10?10:(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_under10"}),e)}},{key:"expandRows",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet,t=e.getRowCount(),n=parseInt(this.input.value),i=this.getRowCount();if(isNaN(n))this.showError(u.NO_NUMBER);else if(t+n>i||(t+n)*e.getColCount()>d.MAX_CELL_COUNT)this.showError(u.BEYOND_LIMIT);else if(n>=2500)this.showError(u.TOO_MANY);else if(!(n<=0)){(0,p.insertRows)([{index:t,amount:n}]).catch(function(e){console.error(e)});var o=this.stage.areaData.row.flow.viewHeight,r=this.stage.areaData.row.flow.offsetY-this.stage.areaData.row.flow.maxOffsetY;Math.abs(r)>o&&r<0&&(r+=o,r-=135),this.stage.tableScroll({areaY:c.default.constant.TABLE_AREA.FLOW,diffY:r}),this.stage.focusInput(),this.hideError(),v||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_amount"}),v=!0)}}},{key:"showError",value:function(e){switch(e){case u.NO_NUMBER:this.error.innerText="\u8bf7\u8f93\u5165\u6570\u5b57\u3002";break;case u.BEYOND_LIMIT:var t=this.getValidRows();this.error.innerText=t<=0?"\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\u3002":"\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\uff0c\u8bf7\u8f93\u5165"+t+"\u884c\u5185\u7684\u6570\u503c\u3002",f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error"}),m||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error_amount"}),m=!0);break;case u.TOO_MANY:this.error.innerText="\u4e00\u6b21\u63d2\u5165\u8fc7\u591a\u884c\uff0c\u63a8\u8350\u5206\u6279\u63d2\u5165\u3002";break;default:return void console.error("\u672a\u77e5\u7684\u9519\u8bef\u7c7b\u578b")}this.error.style.display="inline-block"}},{key:"hideError",value:function(){this.error.innerText="",this.error.style.display="none"}}]),t}(c.default.AlloyExcelUIPlugin);t.default=b},1879:function(e,t,n){var i=n(1880);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1880:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'.expand-row-container {\n  display: none;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  overflow: hidden;\n}\n.expand-row-wrap {\n  height: 100px;\n  background-color: #f8f8f8;\n  position: absolute;\n  padding: 35px 0 0 49px;\n  pointer-events: auto;\n  z-index: 101;\n  font-size: 13px;\n}\n.expand-row-button {\n  display: inline-block;\n  background-color: #ffffff;\n  border: 1px solid rgba(0, 0, 0, 0.08);\n  border-radius: 1px;\n  cursor: default;\n  font-size: 11px;\n  text-align: center;\n  white-space: nowrap;\n  margin-left: 14px;\n  height: 28px;\n  line-height: 28px;\n  outline: 0px;\n  padding: 0 10px;\n  width: 68px;\n  vertical-align: middle;\n  font-family: "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n}\n.expand-row-button:hover {\n  border: 1px solid rgba(0, 0, 0, 0.2);\n}\n.expand-row-button:active {\n  border: 1px solid rgba(0, 0, 0, 0.2);\n  background-color: #f8f8f8;\n}\n.expand-row-input {\n  border-radius: 1px;\n  border: 1px solid rgba(0, 0, 0, 0.08);\n  font-size: 13px;\n  height: 24px;\n  padding: 0 14px 0 15px;\n  vertical-align: middle;\n  width: 31px;\n  background-color: #f8f8f8;\n}\n.expand-row-input:focus {\n  border-color: #0088FB;\n}\n.expand-row-info {\n  margin: 0 6px;\n  vertical-align: middle;\n  position: relative;\n  display: inline-block;\n  opacity: 0.64;\n  font-size: 14px;\n  color: #000000;\n  text-align: center;\n}\n.expand-row-error {\n  font-size: 14px;\n  color: #FE6C6C;\n  vertical-align: middle;\n  position: relative;\n  display: none;\n  margin-left: 20px;\n}\n',""])},1881:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(3)),o=m(n(0)),r=m(n(1)),a=m(n(4)),s=m(n(5)),l=m(n(59)),c=m(n(243));n(1882);var u,d=n(33),p=n(112),h=m(n(7)),f=m(n(8)),g=n(10);function m(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.BEYOND_LIMIT=0]="BEYOND_LIMIT"}(u||(u={}));var v=!1,b=!1,w=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));return n.checkShowHide=function(){n.stage.areaData.col.flow.to>=n.stage.areaData.col.flow.length-1?(n.update(),n.show()):n.hide()},n.update=function(){n.dom.style.left=n.stage.configData.rowHeadWidth+1+"px",n.wrap.style.left=n.stage.areaData.col.getViewportLeft(n.stage.areaData.col.flow.to+1)+9-(n.stage.configData.rowHeadWidth+1)+"px",n.button.style.height=n.stage.configData.colHeadHeight+1+"px",n.button.style.width=n.stage.configData.colHeadHeight+1+"px"},n.show=function(){n.showing||(n.showing=!0,n.dom.style.display="block",n.update(),f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"show_insert_row"}))},n.hide=function(){n.showing&&(n.showing=!1,n.dom.style.display="none")},n.switchSheet=function(){},n.spreadsheetApp=e.spreadsheetApp,n.locateType=c.default.constant.PLUGIN_LOCATE_TYPE.GLOBAL,n.dom=n.initUI(),n.showing=!1,n.initMouse(),(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"init",n).call(n),n.sheetPool={},n.addHook("afterRender",n.checkShowHide),h.default.event.sheetsBar.listen("switchSheetEnd",n.switchSheet),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"initUI",value:function(){var e=document.createElement("div");e.className="expand-one-col-container",this.wrap=document.createElement("div"),this.wrap.className="expand-one-col-wrap",this.button=document.createElement("div"),this.button.className="expand-one-col-button",this.button.title="\u5411\u53f3\u589e\u52a0\u4e00\u5217";var t=document.createElement("div");return t.innerHTML='<svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <g id="6.17" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="as">\n                <g>\n                    <rect id="Rectangle" fill="#000000" opacity="0" x="0" y="0" width="22" height="22"></rect>\n                    <path d="M11,19 C6.581722,19 3,15.418278 3,11 C3,6.581722 6.581722,3 11,3 C15.418278,3 19,6.581722 19,11 C19,15.418278 15.418278,19 11,19 Z M11,17.75 C14.7279221,17.75 17.75,14.7279221 17.75,11 C17.75,7.27207794 14.7279221,4.25 11,4.25 C7.27207794,4.25 4.25,7.27207794 4.25,11 C4.25,14.7279221 7.27207794,17.75 11,17.75 Z M10.35,10.35 L10.35,7 L11.65,7 L11.65,10.35 L15,10.35 L15,11.65 L11.65,11.65 L11.65,15 L10.35,15 L10.35,11.65 L7,11.65 L7,10.35 L10.35,10.35 Z" fill="#000000" fill-rule="nonzero"></path>\n                </g>\n            </g>\n        </g>\n    </svg>',this.button.appendChild(t),this.wrap.appendChild(this.button),e.appendChild(this.wrap),e}},{key:"initMouse",value:function(){var e=this;this.dom.addEventListener("mousedown",function(e){e.stopPropagation()}),this.button.addEventListener("click",function(){e.ExpandOneCols()})}},{key:"getColCount",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet;return d.MAX_CELL_COUNT/e.getRowCount()>>0}},{key:"ExpandOneCols",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet.getColCount();if(!(e+1>this.getColCount())){(0,p.insertColumns)([{index:e,amount:1}]).catch(function(e){console.error(e)});var t=this.stage.areaData.col.flow.viewWidth,n=this.stage.areaData.col.flow.offsetX-this.stage.areaData.col.flow.maxOffsetX;Math.abs(n)>t&&n<0&&(n+=t,n-=g.ADD_COL_WIDTH),this.stage.tableScroll({areaX:c.default.constant.TABLE_AREA.FLOW,diffX:n}),this.stage.focusInput(),b||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_amount"}),b=!0)}}},{key:"showError",value:function(e){switch(e){case u.BEYOND_LIMIT:this.error.innerText="\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\u3002",f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error"}),v||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error_amount"}),v=!0);break;default:return void console.error("\u672a\u77e5\u7684\u9519\u8bef\u7c7b\u578b")}this.error.style.display="inline-block"}},{key:"hideError",value:function(){this.error.innerText="",this.error.style.display="none"}}]),t}(c.default.AlloyExcelUIPlugin);t.default=w},1882:function(e,t,n){var i=n(1883);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1883:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".expand-one-col-container {\n  display: none;\n  position: absolute;\n  bottom: 0;\n  right: 0;\n  top: 0;\n  overflow: hidden;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.expand-one-col-wrap {\n  height: 100px;\n  position: absolute;\n  pointer-events: auto;\n  z-index: 102;\n  font-size: 13px;\n}\n.expand-one-col-button {\n  box-sizing: border-box;\n  color: #777777;\n  opacity: 0.64;\n}\n.expand-one-col-button:hover {\n  opacity: 0.4;\n}\n.expand-one-col-button:active {\n  opacity: 0.8;\n}\n",""])},1884:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=m(n(3)),o=m(n(0)),r=m(n(1)),a=m(n(4)),s=m(n(5)),l=m(n(59)),c=m(n(243));n(1885);var u,d=n(33),p=n(112),h=m(n(7)),f=m(n(8)),g=n(10);function m(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.BEYOND_LIMIT=0]="BEYOND_LIMIT"}(u||(u={}));var v=!1,b=!1,w=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));return n.checkShowHide=function(){n.stage.areaData.row.flow.to>=n.stage.areaData.row.flow.length-1?(n.update(),n.show()):n.hide()},n.update=function(){n.dom.style.top=n.stage.configData.colHeadHeight+1+"px",n.wrap.style.top=n.stage.areaData.row.getViewportTop(n.stage.areaData.row.flow.to+1)+9-(n.stage.configData.colHeadHeight+1)+"px",n.button.style.height=n.stage.configData.rowHeight-2+"px",n.button.style.width=n.stage.configData.rowHeadWidth+1+"px",n.buttonIcon.style.width=n.stage.configData.rowHeight-2+"px",n.buttonIcon.style.height=n.stage.configData.rowHeight-2+"px"},n.show=function(){n.showing||(n.showing=!0,n.dom.style.display="block",n.update(),f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"show_insert_row"}))},n.hide=function(){n.showing&&(n.showing=!1,n.dom.style.display="none")},n.switchSheet=function(){},n.spreadsheetApp=e.spreadsheetApp,n.locateType=c.default.constant.PLUGIN_LOCATE_TYPE.GLOBAL,n.dom=n.initUI(),n.showing=!1,n.initMouse(),(0,l.default)(t.prototype.__proto__||(0,i.default)(t.prototype),"init",n).call(n),n.sheetPool={},n.addHook("afterRender",n.checkShowHide),h.default.event.sheetsBar.listen("switchSheetEnd",n.switchSheet),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"initUI",value:function(){var e=document.createElement("div");return e.className="expand-one-row-container",this.wrap=document.createElement("div"),this.wrap.className="expand-one-row-wrap",this.button=document.createElement("div"),this.button.className="expand-one-row-button",this.button.setAttribute("title","\u5411\u4e0b\u589e\u52a0\u4e00\u884c"),this.buttonIcon=document.createElement("div"),this.buttonIcon.className="expand-one-row-button-icon",this.buttonIcon.innerHTML='<svg width="22px" height="22px" viewBox="0 0 22 22" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n        <g id="6.17" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n            <g id="as">\n                <g>\n                    <rect id="Rectangle" fill="#000000" opacity="0" x="0" y="0" width="22" height="22"></rect>\n                    <path d="M11,19 C6.581722,19 3,15.418278 3,11 C3,6.581722 6.581722,3 11,3 C15.418278,3 19,6.581722 19,11 C19,15.418278 15.418278,19 11,19 Z M11,17.75 C14.7279221,17.75 17.75,14.7279221 17.75,11 C17.75,7.27207794 14.7279221,4.25 11,4.25 C7.27207794,4.25 4.25,7.27207794 4.25,11 C4.25,14.7279221 7.27207794,17.75 11,17.75 Z M10.35,10.35 L10.35,7 L11.65,7 L11.65,10.35 L15,10.35 L15,11.65 L11.65,11.65 L11.65,15 L10.35,15 L10.35,11.65 L7,11.65 L7,10.35 L10.35,10.35 Z" fill="#000000" fill-rule="nonzero"></path>\n                </g>\n            </g>\n        </g>\n    </svg>',this.button.appendChild(this.buttonIcon),this.wrap.appendChild(this.button),e.appendChild(this.wrap),e}},{key:"initMouse",value:function(){var e=this;this.dom.addEventListener("mousedown",function(e){e.stopPropagation()}),this.button.addEventListener("click",function(){e.ExpandOneRows()})}},{key:"getRowCount",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet;return console.log(d.MAX_CELL_COUNT),d.MAX_CELL_COUNT/e.getColCount()>>0}},{key:"ExpandOneRows",value:function(){var e=this.spreadsheetApp.spreadsheet.activeSheet.getRowCount();if(!(e+1>this.getRowCount())){(0,p.insertRows)([{index:e,amount:1}]).catch(function(e){console.error(e)});var t=this.stage.areaData.row.flow.viewHeight,n=this.stage.areaData.row.flow.offsetY-this.stage.areaData.row.flow.maxOffsetY;Math.abs(n)>t&&n<0&&(n+=t,n-=g.ADD_ROW_HEIGHT),this.stage.tableScroll({areaY:c.default.constant.TABLE_AREA.FLOW,diffY:n}),this.stage.focusInput(),b||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_amount"}),b=!0)}}},{key:"showError",value:function(e){switch(e){case u.BEYOND_LIMIT:this.error.innerText="\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\u3002",f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error"}),v||(f.default.tdwReport({opername:"doc_excel_editor",module:"excel_row_panel",action:"insert_row_error_amount"}),v=!0);break;default:return void console.error("\u672a\u77e5\u7684\u9519\u8bef\u7c7b\u578b")}this.error.style.display="inline-block"}},{key:"hideError",value:function(){this.error.innerText="",this.error.style.display="none"}}]),t}(c.default.AlloyExcelUIPlugin);t.default=w},1885:function(e,t,n){var i=n(1886);"string"===typeof i&&(i=[[e.i,i,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};n(37)(i,o);i.locals&&(e.exports=i.locals)},1886:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".expand-one-row-container {\n  display: none;\n  position: absolute;\n  bottom: 0;\n  left: 0;\n  right: 0;\n  overflow: hidden;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.expand-one-row-wrap {\n  height: 100px;\n  position: absolute;\n  pointer-events: auto;\n  z-index: 102;\n  font-size: 13px;\n}\n.expand-one-row-button {\n  box-sizing: border-box;\n  color: #777777;\n  position: relative;\n  opacity: 0.64;\n}\n.expand-one-row-button:hover {\n  opacity: 0.4;\n}\n.expand-one-row-button:active {\n  opacity: 0.8;\n}\n.expand-one-row-button .expand-one-row-button-icon {\n  position: absolute;\n  left: 50%;\n  -webkit-transform: translate(-50%, 0);\n          transform: translate(-50%, 0);\n}\n",""])},1887:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=d(n(3)),o=d(n(0)),r=d(n(1)),a=d(n(4)),s=d(n(5)),l=d(n(243)),c=d(n(17)),u=d(n(15));function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,o.default)(this,t);var n=(0,a.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));return n.showing=!1,n.lastList=[],n.hideSearch=function(){n._clearLastList(),n._removeEvent(),n.showing=!1,n.stage.render()},n._runMutation=function(e){var t=e.mutation;switch(t.id){case c.default.INSERT_DIMENSION_MUTATION:n._insertDimension(t);break;case c.default.DELETE_DIMENSION_MUTATION:n._deleteDimension(t)}},n.app=e.spreadsheetApp,n.showing=!1,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"showSearch",value:function(e){this.showing&&this._clearLastList();for(var t=void 0,n=void 0,i=void 0,o=0;o<e.length;o++)t=e[o][0],n=e[o][1],(i=this.stage.tableData.getCellDataAtPosition(n,t))&&(i.coverColor="#fff1b8");this.lastList=e,this._listenEvent(),this.showing=!0,this.stage.render()}},{key:"_clearLastList",value:function(){if(this.lastList&&0!==this.lastList.length){for(var e=void 0,t=void 0,n=void 0,i=0;i<this.lastList.length;i++)e=this.lastList[i][0],t=this.lastList[i][1],(n=this.stage.tableData.getCellDataAtPosition(t,e))&&(n.coverColor=null);this.lastList.length=0}}},{key:"_listenEvent",value:function(){this.showing}},{key:"_removeEvent",value:function(){this.showing}},{key:"_insertDimension",value:function(e){if(this.lastList&&0!==this.lastList.length)for(var t=e.type===u.default.ROWS?1:0,n=0;n<this.lastList.length;n++){this.lastList[n][t]>=e.index&&(this.lastList[n][t]+=e.amount)}}},{key:"_deleteDimension",value:function(e){if(this.lastList&&0!==this.lastList.length)for(var t=e.type===u.default.ROWS?1:0,n=0;n<this.lastList.length;n++){var i=this.lastList[n][t];i>=e.index&&(i<e.index+e.amount?(this.lastList.splice(n,1),n--):this.lastList[n][t]-=e.amount)}}}]),t}(l.default.AlloyExcelPlugin);t.default=p},1888:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i,o=v(n(9)),r=v(n(3)),a=v(n(0)),s=v(n(1)),l=v(n(4)),c=v(n(5)),u=v(n(243)),d=v(n(7)),p=n(1711),h=n(22),f=n(205),g=v(f),m=n(10);function v(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.NORMAL_STATUS=0]="NORMAL_STATUS",e[e.SCAN_STATUS=1]="SCAN_STATUS",e[e.ACTIVE_STATUS=2]="ACTIVE_STATUS",e[e.INPUT_STATUS=3]="INPUT_STATUS"}(i||(i={}));var b=function(e){function t(e){(0,a.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,{alloyExcel:e.excel}));return n.initDocumentEvent=function(){var e=n;d.default.window.document.body.querySelector("header").addEventListener("click",function(){e.closeRemindBoard()})},n.mouseMove=function(e){if(n.stage.tableData.tableStatus!==i.INPUT_STATUS){var t=n.isInMentionRange(e.newCell.y,e.newCell.x);if(t.exist&&t.existDetail){var o=t.existDetail.mentionId,r=t.existDetail.rowIndex,a=t.existDetail.colIndex;o!==n.cacheInfo.mentionId&&(n.stage._renderMentionSegmentWithStatus(r,a,o,f.MENTION_STATUS.HOVER),n.cacheInfo.mentionId&&n.stage._renderMentionSegmentWithStatus(n.cacheInfo.row,n.cacheInfo.col,n.cacheInfo.mentionId,f.MENTION_STATUS.NORMAL),n.cacheInfo.mentionId=o,n.cacheInfo.row=r,n.cacheInfo.col=a)}else n.cacheInfo.mentionId&&(n.stage._renderMentionSegmentWithStatus(n.cacheInfo.row,n.cacheInfo.col,n.cacheInfo.mentionId,f.MENTION_STATUS.NORMAL),n.initOrClearCache())}},n.mouseDown=function(e){if(2!==n.stage.mouseData.button&&n.stage.tableData.tableStatus!==i.INPUT_STATUS){n.closeRemindBoard();var t=n.isInMentionRange(e.y,e.x);t.exist&&t.existDetail&&n.showRemindBoard(t.existDetail.x,t.existDetail.y,t.existDetail.rowHeight,t.existDetail.mentionId)}},n.tap=function(e){n.closeRemindBoard();var t=n.isInMentionRange(e.y,e.x);t.exist&&t.existDetail&&n.showRemindBoard(t.existDetail.x,t.existDetail.y,t.existDetail.rowHeight,t.existDetail.mentionId)},n.closeRemindBoard=function(){d.default.event.mentionEvent.trigger("hideQuickRemindMenu")},n.getAABB=function(e,t,i){var o=n.stage.tableData.scale,r=i.size.width*o>>0,a=i.size.height*o>>0;return i?[e,(t-=.75*a)>>0,r,a]:[0,0,0,0]},n.app=e.spreadsheetApp,n.getSheet=e.getSheet,n.initRemind(),n.initOrClearCache(),n.initDocumentEvent(),n}return(0,c.default)(t,e),(0,s.default)(t,[{key:"initOrClearCache",value:function(){this.cacheInfo={mentionId:"",row:-1,col:-1}}},{key:"initRemind",value:function(){if(this.getSheet()===this.app.spreadsheet.activeSheet){h.browser.isPc?(this.addHook(m.PLUGIN_HOOK.MOUSE_DOWN,this.mouseDown),this.addHook(m.PLUGIN_HOOK.MOUSE_MOVE,this.mouseMove)):this.addHook(m.PLUGIN_HOOK.TAP,this.tap);var e=d.default.event.sheetsBar,t=d.default.event.toolBar;e.listen("switchSheetEnd",this.closeRemindBoard),t.listen("quickPanelHide",this.closeRemindBoard),t.listen("hideKeyboard",this.closeRemindBoard),this.addHook(m.PLUGIN_HOOK.TABLE_MOVE,this.closeRemindBoard),this.addHook(m.PLUGIN_HOOK.ENTER_INPUT_STATUS,this.closeRemindBoard)}}},{key:"showRemindBoard",value:function(e,t,n,i){var o=this.app.sheetStatus.permission;o&&o.gEditable&&(this.app.view.canvas.pluginsApi.cardCenter.hideAll(),d.default.event.mentionEvent.trigger("setQuickRemindMenu",{mentionId:i,pos:{x:e,y:t},visible:!0,rowHeight:n}))}},{key:"isInMentionRange",value:function(e,t){var n=this.stage.tableData.getCellDataAtPosition(e,t);n&&n.upperX&&(t+=Number(n.upperX),n=this.stage.tableData.getCellDataAtPosition(e,t));var i=this.getSheet().getCellDataAtPosition(e,t);if(null===i||void 0===i)return{exist:!1};var r=i.getMentionDetails();if(null===r||0==(0,o.default)(r).length)return{exist:!1};var a={x:h.browser.isPc?this.stage.mouseData.currX:this.stage.touchData.currX,y:h.browser.isPc?this.stage.mouseData.currY:this.stage.touchData.currY};if(null!==n&&null!==n.lines)for(var s=0;s<n.lines.length;s++)for(var l=n.lines[s],c=l.offsetX,u=l.offsetY,d=this.stage.tableData.scale,f=this.stage.areaData.col.getViewportLeft(t)+c*d,m=this.stage.areaData.row.getViewportTop(e)+u*d,v=l.segments,b=0;b<v.length;b++){var w=v[b],A=this.getAABB(f,m,w);if(w instanceof g.default&&(0,p.checkIsIn)(a,A))return{exist:!0,existDetail:{mentionId:w.mentionInfo.mentionId,x:A[0],y:A[1]+A[3]+this.stage.configData.distanceY,rowHeight:l.getLineHeight(),rowIndex:e,colIndex:t}};f+=A[2]}return{exist:!1}}}]),t}(u.default.AlloyExcelPlugin);t.default=b},778:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MentionRemind=t.AlloyExcelSearch=t.ExpandOneRow=t.ExpandOneCol=t.ExpandRow=t.ValidationListHeader=t.ValidationListCard=t.FilterHeader=t.Subscript=t.CardCenter=void 0;var i=h(n(1835)),o=h(n(1870)),r=h(n(1871)),a=h(n(1873)),s=h(n(1877)),l=h(n(1878)),c=h(n(1881)),u=h(n(1884)),d=h(n(1887)),p=h(n(1888));function h(e){return e&&e.__esModule?e:{default:e}}t.CardCenter=i.default,t.Subscript=o.default,t.FilterHeader=r.default,t.ValidationListCard=a.default,t.ValidationListHeader=s.default,t.ExpandRow=l.default,t.ExpandOneCol=c.default,t.ExpandOneRow=u.default,t.AlloyExcelSearch=d.default,t.MentionRemind=p.default}}]);
//# sourceMappingURL=bundle_excel_plugin_pc-e010113ef0.js.map