(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-alloyexcel-pc"],{10:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportConstant=function(e){e.constant={TABLE_AREA:n,GET_CELLDATA:a,SET_CELLDATA:o,PLUGIN_HOOK:s,TABLE_SCROLL_MODE:r,SELECT_SHOW_TYPE:l,SELECT_HIDE_TYPE:h,SELECT_STATUS:g,TEXT_ALIGN:c,VERTICAL_ALIGN:d,TEXT_WRAP:u,PLUGIN_LOCATE_TYPE:f,PLUGIN_EVENT_STOP:v}};var n=t.TABLE_AREA={FLOW:"flow",FROZEN:"frozen"},a=t.GET_CELLDATA={NORMAL:0,DEFAULT:1,FILL:2},o=t.SET_CELLDATA={TEXT:"text",SEGMENTS:"segments",BACKGROUND:"backgroundColor",TEXT_ALIGN:"textAlign",VERTICAL_ALIGN:"verticalAlign",TEXT_WRAP:"textWrap",LINK:"link",BORDER_COLOR:"borderColor",BORDER_STYLE:"borderStyle",RECORD_AUTHOR:"recordAuthor",DESTROY:"destroy",STYLE:"style"},s=(t.SET_CELLSTYLE={PADDING_RIGHT:"paddingRight",PADDING_LEFT:"paddingLeft"},t.PLUGIN_HOOK={BEFORE_RENDER:"beforeRender",AFTER_RENDER:"afterRender",SELECTION_SHOW:"selectionShow",MOUSE_MOVE:"mouseMove",MOUSE_DOWN:"mouseDown",CLICK:"click",TABLE_MOVE:"tableMove",TAP:"tap",TOUCH_START:"touchStart",ENTER_INPUT_STATUS:"enterInputStatus",TABLE_MENU:"tableMenu",SCALE:"scale"}),r=t.TABLE_SCROLL_MODE={IMMEDIATE:0,EASE:1},l=t.SELECT_SHOW_TYPE={FORMULA:"formula",SELECT:"select",IMAGE_BLUR:"imageBlur",AUTO_FILL:"autoFill",EXTERNAL:"external",DIMENSION:"dimension"},h=t.SELECT_HIDE_TYPE={INIT:"init",INPUT:"input",IMAGE_FOCUS:"imageFocus"},g=t.SELECT_STATUS={NORMAL:"normal",FORMULA:"formula"},c=t.TEXT_ALIGN={LEFT:"left",CENTER:"center",RIGHT:"right"},d=t.VERTICAL_ALIGN={TOP:"top",MIDDLE:"middle",BOTTOM:"bottom"},u=t.TEXT_WRAP={NORMAL:"normal",NOWRAP:"nowrap"},f=t.PLUGIN_LOCATE_TYPE={GLOBAL:"global",BODY:"body"},v=t.PLUGIN_EVENT_STOP={SLOT_MOUSE_DOWN:1,SLOT_MOUSE_UP:2,SLOT_CLICK:3,SLOT_DBLCLICK:4,SLOT_CONTEXTMENU:5,SLOT_MOUSE_MOVE:6,SLOT_NULL:0,SLOT_ALL:Math.pow(2,6)-1};t.FROZEN_PROVIEW_EVENT_TYPE={SHEET_FREEZE_PREVIEW:"SHEET_FREEZE_PREVIEW",SHEET_FREEZE_CANCEL_PREVIEW:"SHEET_FREEZE_CANCEL_PREVIEW"};t.DOUBLE_CLICK_THRESHOLD=500,t.LONG_PRESS_THRESHOLD=150,t.AlloyMentionBlockIdentifier="alloy-mention-block",t.SCROLL_MARGIN=8,t.ADD_COL_WIDTH=70,t.ADD_ROW_HEIGHT=100,t.MOBILE_HEADER_HEIGHT=54,t.MOBILE_BOTTOM_HEIGHT=43,t.IPHONE_X_SAFE_BOTTOM_HEIGHT=34},1156:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=A(i(3)),a=A(i(0)),o=A(i(1)),s=A(i(4)),r=A(i(5)),l=A(i(1157)),h=i(21),g=A(i(1300)),c=i(10),d=A(i(687)),u=A(i(1304)),f=A(i(1305)),v=(A(i(12)),A(i(8)));function A(e){return e&&e.__esModule?e:{default:e}}var C=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i._autoMove=function(){var e=i.autoMoveData;if(0===e.toX&&0===e.toY)return i.tableTick.autoMoveTick&&clearTimeout(i.tableTick.autoMoveTick),void(i.autoMoveState=!1);var t=void 0;e.toY<0?(t=i.tableData.row.getHeight((0,h.findNextShowRow)(i.tableData,i.areaData.row.flow.from-1,-1)),e.diffY=t):e.toY>0?(t=i.tableData.row.getHeight((0,h.findNextShowRow)(i.tableData,i.areaData.row.flow.from+1,1)),e.diffY=-1*t):e.diffY=0,e.toX<0?(t=i.tableData.col.getWidth((0,h.findNextShowCol)(i.tableData,i.areaData.col.flow.from-1,-1)),e.diffX=t):e.toX>0?(t=i.tableData.col.getWidth((0,h.findNextShowCol)(i.tableData,i.areaData.col.flow.from+1,1)),e.diffX=-1*t):e.diffX=0,i.autoScroll()?i.autoMoveState=!1:i.tableTick.autoMoveTick=setTimeout(i._autoMove,60)},i.mouseData=new f.default({stage:i}),e.config.captureScale||(i.keyboard=new g.default({stage:i})),i.resize=(0,h.debounce)(i.resize,200),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"stopAutoMove",value:function(){clearTimeout(this.tableTick.autoMoveTick),this.autoMoveState=!1}},{key:"judgeAutoMove",value:function(e){var t=this.autoMoveData;t.x=e.x,t.y=e.y,t.isOverMax=e.isOverMax;var i=this.areaData.row.isInAutoMove(e),n=this.areaData.col.isInAutoMove(e);switch(i){case 0:case 1:case 2:t.toY=0;break;case 3:t.areaY=c.TABLE_AREA.FLOW,t.toY=-1;break;case 4:t.areaY=c.TABLE_AREA.FLOW,t.toY=1}switch(n){case 0:case 1:case 2:t.toX=0;break;case 3:t.areaX=c.TABLE_AREA.FLOW,t.toX=-1;break;case 4:t.areaX=c.TABLE_AREA.FLOW,t.toX=1}this.autoMoveState||(this.autoMoveState=!0,this._autoMove())}},{key:"handleEvent",value:function(e,t){var i=null;switch(e){case"mousemove":if(i="onmousemove",this.container.classList.remove("drag-rowcol"),this.mouseData.down)return this.event.eventMouse.trigger("mousedrag",t),void this.event.eventFormula.trigger("formulaErrorBoradHide");break;case"mousedown":i="onmousedown";break;case"click":i="onclick";break;case"mouseup":i="onmouseup";break;case"dblclick":i="ondblclick";break;case"rightClick":return void this.event.eventMenu.trigger("tableMenuShow");default:console.log("undefined event: ",e)}null!==i&&this.components.forEach(function(e){e[i]&&(0,h.checkIsIn)(t,e.aabb)&&e[i](t)})}},{key:"scrollToInY",value:function(e){var t=this.tableData.row.length,i=this.areaData.globalTop,n=i[t-1]*e+this.areaData.row.frozen.maxDistance,a=this.configData;this.areaData.row.frozen.length>0&&n++;var o=(0,h.binarySearch)(n,i)-1;if(o===this.areaData.row.flow.from||o<0)return!1;var s=this.areaData.row.flow.offsetY+a.colHeadHeight,r=this.areaData.row.getGlobalTop(o)-this.areaData.row.frozen.viewHeight-s;isNaN(r)||this.handleScroll({dir:1,diff:-r})}},{key:"scrollToInX",value:function(e){var t=this.tableData.col,i=t.length,n=t.widths,a=this.areaData.globalLeft,o=a[i-1]+n[i-1],s=a.concat(o),r=o*e+this.areaData.col.frozen.maxDistance,l=this.configData;this.areaData.col.frozen.length>0&&r++;var g=(0,h.binarySearch)(r,s)-1;if(g===this.areaData.col.flow.from||g<0)return!1;var c=this.areaData.col.flow.offsetX+l.rowHeadWidth,d=this.areaData.col.getGlobalLeft(g)-this.areaData.col.frozen.viewWidth-c;isNaN(d)||this.handleScroll({dir:0,diff:-d})}},{key:"scrollToPxInX",value:function(e){var t=this.tableData.col.length,i=(this.areaData.col.globalLeft[t-1]+this.tableData.col.getWidth(t-1))*e-this.areaData.col.flow.offsetX;isNaN(i)||this.handleScroll({dir:0,diff:-i})}},{key:"scrollToPxInY",value:function(e){var t=this.tableData.row.length,i=(this.areaData.row.globalTop[t-1]+this.tableData.row.getHeight(t-1))*e-this.areaData.row.flow.offsetY;isNaN(i)||this.handleScroll({dir:1,diff:-i})}},{key:"scrollOneInY",value:function(e){if(this.configData.record_preview){if(!window.isRecordPreviewShowing)return!0}else if(window.isRecordPreviewShowing)return!0;var t,i=1;e>0&&(i=-1);var n=(0,h.findNextShowRow)(this.tableData,this.areaData.row.flow.from+e,e);t=i*this.tableData.row.getHeight(n),this.handleScroll({dir:1,diff:t})}},{key:"scrollOneInX",value:function(e){var t,i=1;e>0&&(i=-1);var n=(0,h.findNextShowCol)(this.tableData,this.areaData.col.flow.from+e,e);t=i*this.tableData.col.getWidth(n),this.handleScroll({dir:0,diff:t})}},{key:"resize",value:function(){v.default.jank.log({moduleValue:"view",actionValue:"resize",detail:[{width:this.width,height:this.height}]});var e=this.configData,t=e.quicklook,i=this.selectData,n=window.devicePixelRatio||1;t||(this.width=this.wrap.offsetWidth>>0,this.height=this.wrap.offsetHeight>>0,this.ctx.translate(-.5,-.5),this.bodyWidth=this.width-e.rowHeadWidth,this.bodyHeight=this.height-e.colHeadHeight,this.canvas.setAttribute("width",Math.round(this.width*n)),this.canvas.setAttribute("height",Math.round(this.height*n)),this.canvas.style.width=this.width+"px",this.canvas.style.height=this.height+"px",this.ctx.scale(n,n),this.ctx.translate(.5,.5),this.scaleTo(this.tableData.scale,!0),i.change({type:c.SELECT_SHOW_TYPE.SELECT}),this.render())}},{key:"insertLink",value:function(){this.event.eventLink.trigger("insertLink"),3===this.tableData.tableStatus&&this.event.eventInput.trigger("inputHide")}},{key:"enterInputState",value:function(){this.event.eventInput.trigger("inputShow",{editValue:""})}},{key:"setActiveEditor",value:function(){if("PCInputBar"===(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).from)return this.tableData.inputStatus=2,void this.event.eventInput.trigger("inputShow",{stockEditAsFormula:!0});this.event.eventInput.trigger("inputShow")}},{key:"overActiveEditor",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).isSwitchingSheet,t=void 0!==e&&e;this.event.eventInput.trigger("inputHide",{force:!0,isSwitchingSheet:t})}},{key:"setCellEditorValue",value:function(e){this.event.eventInput.trigger("inputValueAndCursorChange",{value:e})}},{key:"cleanCellValue",value:function(){this.event.eventInput.trigger("inputValueAndCursorChange",{value:""})}},{key:"inputShowAndSetValue",value:function(e){this.tableData.inputStatus=2,this.event.eventInput.trigger("inputShow",{editValue:e})}},{key:"setCellEditorValueWhenActive",value:function(e){this.inputCenter.board.showing&&this.event.eventInput.trigger("inputValueChange",e)}}]),t}(l.default);l.default.AlloyExcelPlugin=d.default,l.default.AlloyExcelUIPlugin=u.default,t.default=C},1157:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=ie(i(1158)),a=ie(i(25)),o=ie(i(154)),s=ie(i(9)),r=ie(i(0)),l=ie(i(1)),h=ie(i(1159)),g=ie(i(1164)),c=ie(i(1166)),d=ie(i(1172)),u=ie(i(1178)),f=ie(i(1189)),v=ie(i(1202)),A=ie(i(1208)),C=ie(i(1224)),p=ie(i(1235)),I=ie(i(1247)),m=ie(i(1250)),y=ie(i(1253)),w=ie(i(1255)),x=ie(i(1258)),b=ie(i(686)),R=ie(i(1259)),E=ie(i(1263)),_=ie(i(1266)),D=ie(i(1272)),T=ie(i(1273)),S=i(284),k=ie(S),L=ie(i(1274)),M=ie(i(1278)),O=ie(i(1285)),F=ie(i(1286)),H=i(21),B=i(10),P=ie(i(1287)),N=ie(i(1290)),Y=ie(i(1291)),z=i(99),W=ie(i(1292)),X=ie(i(12)),G=ie(i(8)),V=i(22),U=i(26),j=ie(i(1293)),K=ie(i(1294)),Z=ie(i(1295)),Q=ie(i(1296)),J=ie(i(1297)),q=i(205),ee=ie(q),te=i(33);function ie(e){return e&&e.__esModule?e:{default:e}}var ne=B.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_PREVIEW,ae=B.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_CANCEL_PREVIEW,oe=function(){function e(t){var i=this;(0,r.default)(this,e),this.props=t.data,this.index=t.index,this.state=this.props[this.index],this.wrap=t.container,this.event=new P.default({stage:this}),this.width=this.wrap.offsetWidth>>0,this.height=this.wrap.offsetHeight>>0,this.captureScale=t.config.captureScale,this.backgroundColor=t.config.backgroundColor,this.renderSize=t.config.renderSize,this.quicklook=t.config.quicklook,void 0===t.config&&(t.config={}),t.config.stage=this,this.configData=new O.default(t.config),void 0===t.tableDataConfig&&(t.tableDataConfig={}),this.tableData=new L.default({stage:this,config:t.tableDataConfig}),this.tableData.init(this.state),this.areaData=new M.default({stage:this}),this.areaData.init(),this.tableData.init(this.state),this.selectData=new k.default({stage:this}),this.tableTick=new x.default({stage:this}),this.hookFunc=new F.default({stage:this,hooks:t.hooks}),this.bodyWidth=this.width-this.configData.rowHeadWidth,this.bodyHeight=this.height-this.configData.colHeadHeight,void 0===t.config.normalOffset?this.normalOffset=0:this.normalOffset=t.config.normalOffset,void 0===t.config.scanOffset?this.scanOffset=0:this.scanOffset=t.config.scanOffset,void 0===t.config.activeOffset?this.activeOffset=0:this.activeOffset=t.config.activeOffset,void 0===t.config.inputOffset?this.inputOffset=this.height/2>>0:this.inputOffset=t.config.inputOffset,this.scrollSeed=0,this.limitOffsetYEnterFull=0,this.autoMoveData={},this.autoMoveState=!1,this._lastIsSelectionInScreen=!1,this.components=[],this.hoverTips=null,this.captureScale||this.initEvent(),this.initStage(t);var n=+new Date;this.useData(this.index),this.captureScale||G.default.speed.runReport(U.SPEED_REPORT_POINTS.RENDER_TABLE_BODY,n,+new Date),this.renders={borderRender:new j.default({stage:this,ctx:this.ctx}),richTextRender:new K.default({stage:this,ctx:this.ctx}),mentionRender:new Z.default({stage:this,ctx:this.ctx}),backgroundRender:new Q.default({stage:this,ctx:this.ctx})},this.lineEngine=new J.default,n=+new Date,this.initUI(t),this.captureScale||(G.default.speed.runReport(U.SPEED_REPORT_POINTS.RENDER_TABLE_BODY,n,+new Date),this.hookFunc.beforeFirstRender&&this.hookFunc.beforeFirstRender()),this.render(),this.captureScale||(this.event.eventTable.trigger("tableFirstRendered"),this.hookFunc.afterFirstRender&&this.hookFunc.afterFirstRender()),this.loadAll=!1,this.cells.initAll(function(){n=+new Date,i.initTable(i.state),i.hookFunc.afterAllRender&&i.hookFunc.afterAllRender(),console.log("render done!!!!!!"),i.captureScale||(G.default.speed.runReport(U.SPEED_REPORT_POINTS.RENDER_TABLE_BODY,n,+new Date),i.loadAll=!0)})}return(0,l.default)(e,[{key:"initStage",value:function(){var e=window.devicePixelRatio||1,t=document.createElement("div");t.className="excel-container",t.style.webkitTransformOrigin=t.style.transformOrigin="left top",t.style.width=t.style.height="100%",this.container=t;var i=document.createElement("div");i.style.width=i.style.height="100%",this.canvasWrap=i;var n=document.createElement("canvas"),a=n.getContext("2d"),o=1,s=1;this.captureScale&&(this.captureScale.x&&(o=this.captureScale.x),this.captureScale.y&&(s=this.captureScale.y),n.setAttribute("id","sideCanvas"),t.style.position="absolute"),this.renderSize&&(this.renderSize.x&&(this.width=this.renderSize.x),this.renderSize.y&&(this.height=this.renderSize.y)),this.quicklook&&(e=H.ios||H.android||H.mac?1.5:1),n.setAttribute("width",Math.round(this.width*e*o)),n.setAttribute("height",Math.round(this.height*e*s)),n.style.backgroundColor="#f8f8f8",this.width=this.width*o,this.height=this.height*s,n.style.width=this.width+"px",n.style.height=this.height+"px",this.canvas=n,this.ctx=a,this.ctx.scale(e,e),this.ctx.translate(.5,.5),this.canvasWrap.appendChild(n),this.container.appendChild(i),this.wrap.appendChild(this.container)}},{key:"initUI",value:function(){this.touchBoard=new h.default({container:this.container,canvas:this.canvas,stage:this,permissions:this.permissions}),this.colHeader=new c.default({container:this.container,stage:this,backgroundColor:this.backgroundColor}),this.rowHeader=new d.default({container:this.container,stage:this,backgroundColor:this.backgroundColor}),this.positionCenter=new T.default({stage:this}),this.angle=new g.default({stage:this});var e=+new Date;this.cells=new u.default({stage:this,col:this.colHeader,row:this.rowHeader,container:this.container}),this.cells.initFirstScreenData(),G.default.speed.runReport(U.SPEED_REPORT_POINTS.RENDER_TABLE_BODY,e,+new Date),this.frozenBoard=new m.default({container:this.container,stage:this}),this.funcBoard=new I.default({container:this.touchBoard.board,stage:this}),this.selectionCenter=new A.default({containers:this.funcBoard.list,stage:this}),this.formulaBoard=new f.default({container:this.container,stage:this}),this.cellToolbar=new w.default({container:this.container,stage:this}),this.frame=new v.default({container:this.touchBoard.board,stage:this}),this.captureScale||(this.inputCenter=new C.default({container:this.container,stage:this}),this.input=this.inputCenter.board.input),this.imageCenter=new _.default({container:this.container,containers:this.funcBoard.list,stage:this}),this.scroll=new p.default({container:this.container,stage:this}),this.formulaCenter=new y.default({stage:this}),this.filterCenter=new D.default({stage:this}),this.tableMenu=new R.default({stage:this,container:this.container}),this.smartSelectionMenu=new E.default({stage:this,container:this.container}),this.pluginBodyBoard=new N.default({stage:this,container:this.container}),this.pluginGlobalBoard=new Y.default({stage:this,container:this.container}),this.components.push(this.angle,this.colHeader,this.rowHeader,this.cells),this.positionCenter.run(),this.areaData.row.flow.needOffsetY=this.normalOffset,this.areaData.col.flow.needOffsetX=0,this.areaData.row.frozen.updateMaxOffsetY(),this.areaData.row.flow.updateMaxOffsetY(),this.limitOffsetYEnterFull=this.areaData.row.flow.maxOffsetY-this.areaData.row.flow.viewHeight}},{key:"useData",value:function(){this.tableData.tableStatus=2}},{key:"initData",value:function(){var e=this.tableData.data,t=void 0,i=void 0;for(t=0;t<e.length;t++)for(i=0;i<e[t].length;i++)null!==e[t][i]&&void 0!==e[t][i]&&(e[t][i]=(0,b.default)(e[t][i],this))}},{key:"initEvent",value:function(){var e=this;"undefined"!==typeof __core&&__core.event&&__core.event.windowSizeEvent&&(window.onresize=function(){__core.event.windowSizeEvent.trigger("resize")}),this.event.eventTable.listen("enterNormalStatus",function(){0!==e.tableData.tableStatus&&(e.event.eventSelection.trigger("selectionHide"),e.selectData.change({active:{xIndex:-1,yIndex:-1},select:{xRange:[-1,-1],yRange:[-1,-1]},type:B.SELECT_SHOW_TYPE.SELECT,show:!1}),e.tableData.tableStatus=0,e.areaData.row.flow.needOffsetY=e.normalOffset,e.areaData.row.flow.updateMaxOffsetY(),e.hookFunc.enterNormalStatus&&e.hookFunc.enterNormalStatus())}),this.event.eventTable.listen("enterScanStatus",function(){1!==e.tableData.tableStatus&&(e.tableData.tableStatus=1,e.areaData.row.flow.needOffsetY=e.scanOffset,e.areaData.row.flow.updateMaxOffsetY(),e.hookFunc.enterScanStatus&&e.hookFunc.enterScanStatus())}),this.event.eventTable.listen("enterActiveStatus",function(){2!==e.tableData.tableStatus&&(e.tableData.tableStatus=2,e.areaData.row.flow.needOffsetY=e.activeOffset,e.areaData.row.flow.updateMaxOffsetY(),e.hookFunc.enterActiveStatus&&e.hookFunc.enterActiveStatus())}),this.event.eventTable.listen("enterInputStatus",function(){3!==e.tableData.tableStatus?(e.tableData.tableStatus=3,e.areaData.row.flow.needOffsetY=e.inputOffset,e.areaData.row.flow.updateMaxOffsetY(),e.hookFunc.enterInputStatus&&e.hookFunc.enterInputStatus()):e.hookFunc.inputBoardChange&&e.hookFunc.inputBoardChange()}),this.event.eventTable.listen("tableMove",function(){e.hookFunc.tableMove&&e.hookFunc.tableMove()}),this.event.eventTable.listen("scale",function(){e.hookFunc.scale&&e.hookFunc.scale()}),this.event.eventSelection.listen("selectionShow",function(t){2===e.tableData.tableStatus||t&&!t.show||(e.selectData.selectStatus===B.SELECT_STATUS.NORMAL&&e.event.eventTable.trigger("enterActiveStatus"),e._lastIsSelectionInScreen=!0,e.hookFunc.selectionEnterViewPort&&e.hookFunc.selectionEnterViewPort())}),this.configData.record_preview&&(this.event.eventRecord.listen("recordviewCellHover",function(t){if(t.hover){var i=$(e.touchBoard.board),n=i.width(),a=i.height(),o=t.author;t.currX<n-16?e.updateRecordViewHover("cell",t.cellRange,i,n,a,o,!0):e.updateRecordViewHover("cell",null,null,0,0,null,!1)}else e.updateRecordViewHover("cell",null,null,0,0,null,!1)}),this.event.eventRecord.listen("recordviewImageHover",function(t){if(t.hover){var i=$(e.touchBoard.board),n=i.width(),a=i.height(),o=t.tableImage.wrap,s=parseInt(o.style.left),r=parseInt(o.style.top);s+=t.tableImage.parent.distanceX,r+=t.tableImage.parent.distanceY;var l=t.author,h={x:s-e.areaData.col[t.tableImage.parent.areaX].offsetX+1,y:r-e.areaData.row[t.tableImage.parent.areaY].offsetY+1,w:parseInt(o.style.width),h:parseInt(o.style.height)};e.updateRecordViewHover("image",h,i,n,a,l,!0)}else e.updateRecordViewHover("image",null,null,0,0,null,!1)}))}},{key:"updateRecordViewHover",value:function(e,t,i,n,a,o,s){var r=null,l=null;if(s&&(o&&CoreSheet&&CoreSheet.historylist&&CoreSheet.historylist.authorInfoForID&&CoreSheet.historylist.authorInfoForID(o)&&(l=CoreSheet.historylist.authorInfoForID(o)),o&&CoreSheet&&CoreSheet.historylist&&CoreSheet.historylist.getColorFromId(o)&&(r=CoreSheet.historylist.getColorFromId(o))),!this.hoverTips){this.hoverTips=function(){var e=$("<div class='history-preview-user-tip user-select-none'>").html("<span class='history-preview-user-tip-content user-select-none'></span>"),t=$("<div class='history-preview-user-tip-wrapper user-select-none'>").css({position:"absolute",left:0,top:0});t.append(e);var i="",n=!0,a=!0,o=null;return{hover:function(){return t},setPosition:function(e,t){this.hover().css({left:e,top:t})},setNickName:function(t){a&&(t||(t=""),e.find("span").text(t))},setBgColor:function(t){a&&e.css("background-color",t||"black")},calRefreshState:function(e,t){n&&"image"==i?(a="image"==e,i="image"):(i=e,a=!0),t||"image"!=e||(a=!0)},show:function(e,i,s){if(a){o&&(X.default.erase(o),o=null),n=!0,window.recordHoverTipShow=n,window.recordHoverTip=this;var r=this;X.default.wait(0).run(function(){t.css("visibility","visible");var n=e.x;n+r.width()+16>i&&(n=i-r.width()-16);var a=e.y-r.height();a<2&&(a=2),r.setPosition(n,a)})}},hide:function(){a&&(o&&X.default.erase(o),n=!1,window.recordHoverTipShow=n,window.recordHoverTip=void 0,o=X.default.wait(200).run(function(){t.css("visibility","hidden")}))},width:function(){return e.width()+12},height:function(){return e.height()}}}()}if(this.hoverTips.calRefreshState(e,s),s){var h=l.name;i.append(this.hoverTips.hover()),this.hoverTips.setBgColor(r),this.hoverTips.setNickName(h),this.hoverTips.show(t,n,a)}else this.hoverTips&&this.hoverTips.hide()}},{key:"initTable",value:function(e){var t=this;e.filter&&e.filter.range&&this.doFilter(e.filter),e.frozen&&this.updateFrozen({col:e.frozen.col,row:e.frozen.row});var i=void 0,n=void 0;e.colHide&&(i=(0,s.default)(e.colHide)).length>0&&(0,H.arrayToRange)(i).forEach(function(e){t.hideCol(e)}),e.rowHide&&(n=(0,s.default)(e.rowHide)).length>0&&(0,H.arrayToRange)(n).forEach(function(e){t.hideRow(e)}),this.imageCenter.updateAllImage()}},{key:"_scroll",value:function(e){var t=e.x,i=e.y,n=e.isOverMax,a=void 0,o=void 0,s=!1,r=!1,l=null,h=null,g=0,c=0;if(t){if(g=t.diff,void 0===(l=t.area)||void 0===g)return void console.error("scroll arguments error: ",e);0!==g&&((o=(a=this.areaData.col[l]).offsetX-g>>0)<0&&(o=0,s=!0),o>a.maxOffsetX&&(n?a.maxOffsetX=o:(o=a.maxOffsetX,s=!0)),a.offsetX=o)}if(i){if(c=i.diff,void 0===(h=i.area)||void 0===c)return void console.error("scroll arguments error: ",e);0!==c&&((o=(a=this.areaData.row[h]).offsetY-c>>0)<0&&(o=0,r=!0),o>a.maxOffsetY&&(n?a.maxOffsetY=o:(o=a.maxOffsetY,r=!0)),a.offsetY=o)}return this.render(),s&r}},{key:"autoScroll",value:function(){var e=this.autoMoveData,t={};return e.areaX&&(t.x={area:e.areaX,diff:e.diffX||0}),e.areaY&&(t.y={area:e.areaY,diff:e.diffY||0}),e.isOverMax&&(t.isOverMax=!0),this._scroll(t)}},{key:"_calcAnimationStep",value:function(e,t){var i=Math.abs(e||t);if(0===i)return 8;var n=8+i/(window.innerHeight/2)*8;return Math.min(16,Math.max(8,Math.round(n)))}},{key:"tableScroll",value:function(e){var t=this,i={};if(e.areaX&&(i.x={area:e.areaX,diff:e.diffX||0}),e.areaY&&(i.y={area:e.areaY,diff:e.diffY||0}),e.type===B.TABLE_SCROLL_MODE.EASE){var n=e.diffX||0,a=e.diffY||0,o=e.areaX||this.areaData.areaX,s=e.areaY||this.areaData.areaY;if(!o||!s)return;var r=this.areaData.col[o].offsetX,l=this.areaData.row[s].offsetY,h=e.step||this._calcAnimationStep(n,a);if(!n&&!a)return void(e.animatedEnd&&e.animatedEnd());var g=function(e){0===n?i.y&&(i.y.diff=e+(t.areaData.row[s].offsetY-l)):(i.x&&(i.x.diff=e+(t.areaData.col[o].offsetX-r)),i.y&&(e=e/n*a,i.y.diff=e+(t.areaData.row[s].offsetY-l))),t._scroll(i)};(0,H.Linear)(0,n||a,h,g,function(t){g(t),e.animatedEnd&&e.animatedEnd()})}else this._scroll(i),e.animatedEnd&&e.animatedEnd()}},{key:"scrollToRowCol",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t={};if(void 0!==e.row){t.y={};var i=0;e.row>=this.areaData.row.frozen.length?(t.y.area=B.TABLE_AREA.FLOW,i=this.areaData.row.frozen.totalHeight):t.y.area=B.TABLE_AREA.FROZEN,t.y.diff=-(this.areaData.row.getGlobalTop(e.row)-this.configData.colHeadHeight-i-this.areaData.row[t.y.area].offsetY)}if(void 0!==e.col){t.x={};var n=0;e.col>=this.areaData.col.frozen.length?(t.x.area=B.TABLE_AREA.FLOW,n=this.areaData.col.frozen.totalWidth):t.x.area=B.TABLE_AREA.FROZEN,t.x.diff=-(this.areaData.col.getGlobalLeft(e.col)-this.configData.rowHeadWidth-n-this.areaData.col[t.x.area].offsetX)}this._scroll(t)}},{key:"preciousScrollToRowCol",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.areaData.col[B.TABLE_AREA.FLOW]&&(this.areaData.col[B.TABLE_AREA.FLOW].offsetX=0),this.areaData.row[B.TABLE_AREA.FLOW]&&(this.areaData.row[B.TABLE_AREA.FLOW].offsetY=0),this.scrollToRowCol(e)}},{key:"handleScroll",value:function(e){var t=this.areaData.areaX,i=this.areaData.areaY,n=this.selectData,a=this.configData;if(a.record_preview&&window.recordHoverTipShow&&window.recordHoverTip&&window.recordHoverTip.hide(),void 0!==e.dir&&(e.dir?(e.diffX=0,e.diffY=e.diff):(e.diffY=0,e.diffX=e.diff)),0===this.tableData.tableStatus&&this.areaData.row.flow.offsetY<this.limitOffsetYEnterFull&&e.diffY<0){this.scrollSeed++;(0,H.isPortrait)()||(this.scrollStep=5),this.scrollSeed>30&&(this.event.eventTable.trigger("enterScanStatus"),this.scrollSeed=0)}else if(1===this.tableData.tableStatus&&e.diffY>(window.hidingNav?3+a.navHeight:3))this.event.eventTable.trigger("enterNormalStatus"),this.scrollSeed=0;else if(2===this.tableData.tableStatus)if(V.isIOS&&!(0,H.isPortrait)())if((this.touchData.mouseMoveOffsetY>0&&e.diffY<0||this.touchData.mouseMoveOffsetY<0&&e.diffY>0)&&(this.touchData.mouseMoveOffsetY=0),window.showingNav)this.touchData.mouseMoveOffsetY=a.navHeight;else if(window.hidingNav)this.touchData.mouseMoveOffsetY=-a.navHeight;else{var o=!1;n.isAnyInScreen||((this.touchData.mouseMoveOffsetY<0&&e.diffY<this.touchData.mouseMoveOffsetY||this.touchData.mouseMoveOffsetY>0&&e.diffY>this.touchData.mouseMoveOffsetY||0==this.touchData.mouseMoveOffsetY)&&e.diffY>this.touchData.mouseMoveOffsetY+5?this.hookFunc&&this.hookFunc.enterNormalStatusWithSelection&&this.hookFunc.enterNormalStatusWithSelection():(this.touchData.mouseMoveOffsetY<0&&e.diffY<this.touchData.mouseMoveOffsetY||this.touchData.mouseMoveOffsetY>0&&e.diffY>this.touchData.mouseMoveOffsetY||0==this.touchData.mouseMoveOffsetY)&&e.diffY<this.touchData.mouseMoveOffsetY+0&&this.hookFunc&&this.hookFunc.selectionLeaveViewPort&&this.hookFunc.selectionLeaveViewPort(),o=!0),this._lastIsSelectionInScreen!==n.isAnyInScreen&&((this.touchData.mouseMoveOffsetY<0&&e.diffY<this.touchData.mouseMoveOffsetY||this.touchData.mouseMoveOffsetY>0&&e.diffY>this.touchData.mouseMoveOffsetY||0==this.touchData.mouseMoveOffsetY)&&n.isAnyInScreen?(this._lastIsSelectionInScreen=n.isAnyInScreen,this.hookFunc&&this.hookFunc.selectionEnterViewPort&&this.hookFunc.selectionEnterViewPort(),o=!0):(Math.abs(e.diffX)<Math.abs(this.touchData.mouseMoveOffsetY+e.diffY)&&(this.touchData.mouseMoveOffsetY<0&&e.diffY<this.touchData.mouseMoveOffsetY||this.touchData.mouseMoveOffsetY>0&&e.diffY>this.touchData.mouseMoveOffsetY||0==this.touchData.mouseMoveOffsetY)&&(this._lastIsSelectionInScreen=n.isAnyInScreen,this.hookFunc&&this.hookFunc.selectionLeaveViewPort&&this.hookFunc.selectionLeaveViewPort(),this.tableData.selectionStatus+=1),o=!0)),!o&&n.isAnyInScreen&&(e.diffY>this.touchData.mouseMoveOffsetY?window.CoreSheet.userAgent.iOS&&this.hookFunc&&this.hookFunc.enterActiveStatus&&this.hookFunc.enterActiveStatus():e.diffY)}else n.isAnyInScreen||(e.diffY>5?this.hookFunc.enterNormalStatusWithSelection&&this.hookFunc.enterNormalStatusWithSelection():this.areaData.row.flow.offsetY<this.limitOffsetYEnterFull&&e.diffY<0&&!n.isAnyInScreen&&this.hookFunc.selectionLeaveViewPort&&this.hookFunc.selectionLeaveViewPort()),this._lastIsSelectionInScreen!==n.isAnyInScreen&&(n.isAnyInScreen?(this._lastIsSelectionInScreen=n.isAnyInScreen,this.hookFunc.selectionEnterViewPort&&this.hookFunc.selectionEnterViewPort()):Math.abs(e.diffX)<Math.abs(e.diffY)&&(this._lastIsSelectionInScreen=n.isAnyInScreen,this.hookFunc.selectionLeaveViewPort&&this.hookFunc.selectionLeaveViewPort(),this.tableData.selectionStatus+=1));var s={};s=Math.abs(e.diffX)>Math.abs(e.diffY)?{x:{area:t,diff:e.diffX}}:{y:{area:i,diff:e.diffY}},this._scroll(s)&&cancelAnimationFrame(this.tableTick.scrollTick)}},{key:"renderNextTick",value:function(){var e=this;this.readyRender||(this.readyRender=!0,setTimeout(function(){e.readyRender=!1,e.render()},0))}},{key:"render",value:function(){this.updateRowHeightIfNeed(),this.areaData.calcIndex(),this.ctx.globalCompositeOperation="source-over",this.ctx.clearRect(0,0,this.width,this.height),this.ctx.strokeStyle="#d8dade",this.ctx.globalCompositeOperation="destination-over",this.cells.render(),this.ctx.clearRect(0,0,this.width,this.configData.colHeadHeight),this.ctx.globalCompositeOperation="source-over",this.event.eventTable.trigger("afterRender",this.ctx),this.colHeader.render(),this.rowHeader.render(),this.angle.render(),this.frozenBoard.hackUpdate()}},{key:"renderColHeader",value:function(){this.colHeader.render(),this.angle.render()}},{key:"renderRowHeader",value:function(){this.rowHeader.render(),this.angle.render()}},{key:"addAdjustLine",value:function(e){var t=this.tableData;t.adjustHeightSign=!0,void 0===t.adjustHeightLine[e]&&(t.adjustHeightLine[e]=!0)}},{key:"scaleTo",value:function(e,t){var i=e;G.default.jank.log({moduleValue:"view",actionValue:"scale",detail:[{width:this.width,height:this.height},i]});var n=this.tableData,a=n.scale,o=this.configData;i<.5?i=.5:i>2&&(i=2),i!==n.scale||t?(this.areaData.col.frozen.defaultOffsetX=this.areaData.col.frozen.offsetX/n.scale>>0,this.areaData.row.frozen.defaultOffsetY=this.areaData.row.frozen.offsetY/n.scale>>0,this.areaData.col.flow.defaultOffsetX=this.areaData.col.flow.offsetX/n.scale>>0,this.areaData.row.flow.defaultOffsetY=this.areaData.row.flow.offsetY/n.scale>>0,n.scale=i,this.container.style.webkitTransform=this.container.style.transform="scale(1)",this.bodyWidth=this.width-o.rowHeadWidth,this.bodyHeight=this.height-o.colHeadHeight,this.event.eventTable.trigger("scale",a),this.areaData.row.flow.needOffsetY=this.areaData.row.flow.needOffsetY,this.limitOffsetYEnterFull=this.areaData.row.flow.maxOffsetY-this.areaData.row.flow.viewHeight,2===n.tableStatus&&this.selectData.change({type:B.SELECT_SHOW_TYPE.SELECT}),this.render()):this.container.style.webkitTransform=this.container.style.transform="scale(1)"}},{key:"scaleTable",value:function(e,t){var i=this.areaData,n=i.col.flow.offsetX+t.x-this.configData.rowHeadWidth,a=i.row.flow.offsetY+t.y-this.configData.colHeadHeight,o=i.col.flow.totalWidth,s=i.row.flow.totalHeight;this.scaleTo(e);var r=i.col.flow.totalWidth,l=i.row.flow.totalHeight,h=(r/o-1)*n+i.col.flow.correctMaxOffsetX,g=(l/s-1)*a+i.row.flow.correctMaxOffsetY;i.col.flow.correctMaxOffsetX=0,i.row.flow.correctMaxOffsetY=0;var c=this.areaData,d=c.areaX,u=c.areaY;this.tableScroll({diffX:-h,diffY:-g,areaX:d,areaY:u,type:B.TABLE_SCROLL_MODE.IMMEDIATE,animatedEnd:null})}},{key:"clearTable",value:function(){var e=this.tableData;e.locking=!0,e.hideRowMap={},e.hideColMap={},e.shapes={},this.areaData.row.frozen.length=0,this.areaData.col.frozen.length=0,this.areaData.row.frozen.offsetY=0,this.areaData.row.flow.offsetY=0,this.areaData.col.frozen.offsetX=0,this.areaData.col.flow.offsetX=0,e.row.setHeights.length=0,e.filter={},e.filterHideRowMap={},3===e.tableStatus&&this.event.eventInput.trigger("inputHide"),this.selectData&&this.selectData.resetSelect(),this.event.eventTable.trigger("clearTable"),e.tableStatus=0}},{key:"mergeCell",value:function(e,t,i,n){(i<1||n<1)&&console.error("error arguments in merge cell: ",i,n),i+n<=2?this.splitCell(e,t):(this.event.eventCell.trigger("mergeCell",{x:e,y:t,w:i,h:n}),this.renderNextTick())}},{key:"splitCell",value:function(e,t){var i,n,a=this.tableData.getCellDataAtPosition(t,e,B.GET_CELLDATA.NORMAL);a&&a.mergeData&&(i=a.mergeData.xRange[1]-a.mergeData.xRange[0]+1,n=a.mergeData.yRange[1]-a.mergeData.yRange[0]+1,this.event.eventCell.trigger("splitCell",{x:e,y:t,w:i,h:n}),this.renderNextTick())}},{key:"showRow",value:function(e){this.event.eventDimension.trigger("showRow",{range:e}),this.renderNextTick()}},{key:"showCol",value:function(e){this.event.eventDimension.trigger("showCol",{range:e}),this.renderNextTick()}},{key:"hideRow",value:function(e){var t=[],i=void 0;for(i=e[0];i<=e[1];i++)t.push(this.tableData.row.getHeight(i));this.event.eventDimension.trigger("hideRow",{range:e,rowHeights:t}),this.renderNextTick()}},{key:"hideCol",value:function(e){var t=[],i=void 0;for(i=e[0];i<=e[1];i++)t.push(this.tableData.col.getWidth(i));this.event.eventDimension.trigger("hideCol",{range:e,colWidths:t}),this.renderNextTick()}},{key:"removeRow",value:function(e){var t=this.tableData,i=[],n=void 0;for(n=e[0];n<=e[1];n++)i.push(t.row.getHeight(n));this.event.eventDimension.trigger("removeRow",{range:e,rowHeights:i}),t.adjustHeightSign&&(t.adjustHeightLine=(0,H.mapDelete)(t.adjustHeightLine,e[0],e[1]-e[0]+1)),this.renderNextTick()}},{key:"removeCol",value:function(e){var t=this.tableData,i=[],n=void 0;for(n=e[0];n<=e[1];n++)i.push(t.col.getWidth(n));this.event.eventDimension.trigger("removeCol",{range:e,colWidths:i});var a=t.row.setHeights;for(n=0;n<a.length;n++)"number"!==typeof rowHeight&&this.addAdjustLine(n);this.renderNextTick()}},{key:"addRow",value:function(e,t){var i=this.tableData;this.event.eventDimension.trigger("addRow",{index:e,amount:Number(t)}),i.adjustHeightSign&&(i.adjustHeightLine=(0,H.mapInsert)(i.adjustHeightLine,e,Number(t))),this.renderNextTick()}},{key:"addCol",value:function(e,t){this.tableData;this.event.eventDimension.trigger("addCol",{index:e,amount:Number(t)}),this.renderNextTick()}},{key:"setColWidth",value:function(e,t){var i=this.tableData,n=void 0;n=i.hideColMap[e]?i.hideColMap[e].width:i.col.widths[e],this.event.eventDimension.trigger("setColWidth",{index:e,oldWidth:"number"===typeof n?n:this.configData.colWidth,newWidth:Number(t)}),this.renderNextTick()}},{key:"setRowHeight",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.tableData,a=void 0,o=void 0;n.hideRowMap[e]?(a=n.hideRowMap[e].height,o=n.hideRowMap[e].setHeight):n.filterHideRowMap[e]?(a=n.filterHideRowMap[e].height,o=n.filterHideRowMap[e].setHeight):(a=n.row.heights[e],o=n.row.setHeights[e]),t!==o&&(this.event.eventDimension.trigger("setRowHeight",{index:e,newHeight:t,oldHeight:a,user:i}),this.renderNextTick())}},{key:"setCellsData",value:function(e){this.event.eventCell.trigger("setCellsData",{infos:e}),this.renderNextTick()}},{key:"setAreaData",value:function(e,t,i){this.event.eventCell.trigger("setAreaData",{data:i,xRange:e,yRange:t}),this.renderNextTick()}},{key:"setTableAll",value:function(e,t){var i=this,n=this.tableData;this.state.data=e.data,t&&n.row.updateHeights(t),n.init(e),this.areaData.init(),this.initData(this.index),this.rowHeader.init(),this.colHeader.init(),this.cells.init(),this.cells.stopLastInitAllLoop(),this.hookFunc.setLastPosition&&this.hookFunc.setLastPosition(),this.cells.initFirstScreenData(),this.frozenBoard.init(),this.event.eventTable.trigger("reset"),this.hookFunc.setLastSelect&&this.hookFunc.setLastSelect(),n.hideRowMap={},n.hideColMap={},n.tableStatus=2,n.locking=!1,this.hookFunc.beforeFirstRender&&this.hookFunc.beforeFirstRender(),this.render(),this.hookFunc.afterFirstRender&&this.hookFunc.afterFirstRender(),this.cells.initAll(function(){console.log("cal all"),i.initTable(e),i.hookFunc.afterAllRender&&i.hookFunc.afterAllRender(),i.render()})}},{key:"updateRowHeightIfNeed",value:function(){var e=this.tableData,t=void 0;if(e.adjustHeightSign){for(t in e.adjustHeightLine)Object.prototype.hasOwnProperty.call(e.adjustHeightLine,t)&&this.cells.checkRowHeight(t);e.adjustHeightLine=(0,o.default)(null),e.adjustHeightSign=!1}}},{key:"cleanCellStyles",value:function(e,t){"number"===typeof e&&(e=e<0?[0,this.colHeader.widths.length-1]:[e,e]),"number"===typeof t&&(t=t<0?[0,this.rowHeader.heights.length-1]:[t,t]),this.event.eventCell.trigger("cleanCellStyles",{x:e,y:t}),this.renderNextTick()}},{key:"addImage",value:function(e){this.event.eventShape.trigger("addImage",{shape:e})}},{key:"updateImage",value:function(e){this.event.eventShape.trigger("updateImage",{shape:e})}},{key:"removeImage",value:function(e){this.event.eventShape.trigger("removeImage",{id:e})}},{key:"doFilter",value:function(e){var t=this;this.closeFilter();var i=this.tableData,n=e.range;n.xRange[0]<0&&(n.xRange[0]=0),n.xRange[1]>i.col.widths.length-1&&(n.xRange[1]=i.col.widths.length-1),n.yRange[0]<0&&(n.yRange[0]=0),n.yRange[1]>i.row.heights.length-1&&(n.yRange[1]=i.row.heights.length-1),i.filter=e,i.filter.open=!0,this.event.eventFilter.trigger("doFilter");var a=i.filter.hide;a.length>0&&(a.sort(function(e,t){return e>t?1:-1}),(0,H.arrayToRange)(a).forEach(function(e){for(var n=[],a=e[0];a<=e[1];a++)n.push(i.row.getHeight(a));t.event.eventFilter.trigger("hideFilterRow",{range:e,rowHeights:n})}));this.renderNextTick()}},{key:"closeFilter",value:function(){var e=this,t=this.tableData;if(t.filter.open){var i=t.filter.hide;if(i.length>0)i.sort(function(e,t){return e>t?1:-1}),(0,H.arrayToRange)(i).forEach(function(t){e.event.eventFilter.trigger("showFilterRow",{range:t})});t.filter.open=!1,this.event.eventFilter.trigger("closeFilter"),t.filter.range.xRange=[],t.filter.range.yRange=[],t.filter.states={},t.filter.hide=[],this.renderNextTick()}}},{key:"closePickShape",value:function(){this.selectData.pickShape&&this.selectData.change({type:B.SELECT_SHOW_TYPE.IMAGE_BLUR})}},{key:"updateFrozen",value:function(e){void 0!==e.col&&this.updateFrozenCol(e.col),void 0!==e.row&&this.updateFrozenRow(e.row)}},{key:"updateFrozenCol",value:function(e){this.tableData.frozen.col!==e&&(e>this.tableData.col.widths.length&&(e=this.tableData.col.widths.length),this.event.eventDimension.trigger("updateFrozenCol",e),this.renderNextTick())}},{key:"updateFrozenRow",value:function(e){this.tableData.frozen.row!==e&&(e>this.tableData.row.heights.length&&(e=this.tableData.row.heights.length),this.event.eventDimension.trigger("updateFrozenRow",e),this.renderNextTick())}},{key:"setFrozenPreviewState",value:function(){this.event.eventDimension.trigger(ne)}},{key:"cacelFrozenPreviewState",value:function(){this.event.eventDimension.trigger(ae)}},{key:"doCopy",value:function(){this.event.eventCopy.trigger("copyFrameShow")}},{key:"closeCopy",value:function(){this.event.eventCopy.trigger("copyFrameHide")}},{key:"cancelTableStatus",value:function(){this.event.eventTable.trigger("enterNormalStatus"),this.event.eventLink.trigger("linkHide"),this.selectData.resetSelect(),this.renderNextTick()}},{key:"enterScanStatusForMobile",value:function(){this.event.eventLink.trigger("linkHide"),this.selectData.resetSelect(),this.event.eventSelection.trigger("selectionHide"),this.event.eventTable.trigger("enterScanStatus"),this.renderNextTick()}},{key:"enterActiveState",value:function(){this.event.eventTable.trigger("enterActiveStatus")}},{key:"restoreStatus",value:function(){switch(this.tableData.tableStatus){case 0:this.hookFunc.enterNormalStatus&&this.hookFunc.enterNormalStatus();break;case 1:this.hookFunc.enterScanStatus&&this.hookFunc.enterScanStatus();break;case 2:this.hookFunc.enterActiveStatus&&this.hookFunc.enterActiveStatus();break;case 3:this.hookFunc.enterInputStatus&&this.hookFunc.enterInputStatus()}}},{key:"setDistanceX",value:function(e){this.configData.distanceX=e}},{key:"setDistanceY",value:function(e){this.configData.distanceY=e}},{key:"changeOffsetY",value:function(e){var t=this.areaData.row.flow;switch(void 0!==e.normal&&(this.normalOffset=e.normal),void 0!==e.scan&&(this.scanOffset=e.scan),void 0!==e.active&&(this.activeOffset=e.active),void 0!==e.input&&(this.inputOffset=e.input),this.tableData.tableStatus){case 0:t.needOffsetY=this.normalOffset;break;case 1:t.needOffsetY=this.scanOffset;break;case 2:t.needOffsetY=this.activeOffset;break;case 3:t.needOffsetY=this.inputOffset}t.updateMaxOffsetY()}},{key:"changeOffsetX",value:function(e){this.areaData.col.flow.needOffsetX=e,this.areaData.col.flow.updateMaxOffsetX()}},{key:"__selectMove",value:function(e){3===this.tableData.tableStatus&&this.event.eventInput.trigger("inputHide"),this.tableData.tableStatus<2||(this.event.eventSelection.trigger("selectionMove",e),this.input.focus())}},{key:"selectCell",value:function(e,t,i,n,a,o){this.selectData.resetSelect();var s={xRange:[e,e],yRange:[t,t]},r={xIndex:e,yIndex:t};(0,S.aroundEdges)(this.tableData,s),this.selectData.change({select:s,active:r,type:B.SELECT_SHOW_TYPE.EXTERNAL}),i&&this.makeCellVisiable(e,t,n,a,o)}},{key:"selectAreaByGridRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.selectData.active;null!==t&&(n=t),this.selectData.resetSelect();var a={xRange:[e.startColIndex,e.endColIndex],yRange:[e.startRowIndex,e.endRowIndex]};(0,S.aroundEdges)(this.tableData,a),this.selectData.change({select:a,active:n,type:B.SELECT_SHOW_TYPE.EXTERNAL}),i&&this.makeCellVisiable(n.x,n.y)}},{key:"selectAreaCell",value:function(e,t,i,o){"object"!==("undefined"===typeof t?"undefined":(0,a.default)(t))&&(i=t,t={x:e.xRange[0],y:e.yRange[0]}),this.selectData.resetSelect();var s=(0,n.default)({xRange:e.xRange,yRange:e.yRange},o),r={xIndex:t.x,yIndex:t.y};(0,S.aroundEdges)(this.tableData,s),this.selectData.change({select:s,active:r,type:B.SELECT_SHOW_TYPE.EXTERNAL}),i&&this.makeCellVisiable(t.x,t.y)}},{key:"selectRow",value:function(e){this.selectData.resetSelect();var t={xRange:[0,this.tableData.col.length-1],yRange:[e[0],e[1]],selectRow:!0},i={xIndex:0,yIndex:e[0]};this.selectData.change({select:t,active:i,type:B.SELECT_SHOW_TYPE.EXTERNAL})}},{key:"selectCol",value:function(e){this.selectData.resetSelect();var t={xRange:[e[0],e[1]],yRange:[0,this.tableData.row.length-1],selectCol:!0},i={xIndex:e[0],yIndex:0};this.selectData.change({select:t,active:i,type:B.SELECT_SHOW_TYPE.EXTERNAL})}},{key:"selectAll",value:function(){this.selectData.resetSelect();var e={xRange:[0,this.colCount-1],yRange:[0,this.rowCount-1],selectAll:!0},t=this.selectData.active;this.selectData.change({select:e,active:t,type:B.SELECT_SHOW_TYPE.EXTERNAL})}},{key:"showTableToolbar",value:function(e){this.event.eventMenu.trigger("cellToolbarShow",e)}},{key:"hideTableToolbar",value:function(){this.event.eventMenu.trigger("cellToolbarHide")}},{key:"focusInput",value:function(){this.inputCenter.board.focus()}},{key:"blurInput",value:function(){this.inputCenter.board.blur()}},{key:"hideInput",value:function(){3===this.tableData.tableStatus&&(this.event.eventInput.trigger("inputHide"),this.event.eventSelection.trigger("selectionShow"))}},{key:"makeCellVisiable",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;this.areaData.makeVisiable({col:e,row:t}),this.event.eventTable.trigger("makeCellVisiable",{x:e,y:t,offsetX:i,offsetY:n,offsetYTo:a})}},{key:"getRowCount",value:function(){return this.tableData.row.length}},{key:"getColCount",value:function(){return this.tableData.col.length}},{key:"showSmartBtn",value:function(e){this.event.eventSmart.trigger("showSmartBtn",e)}},{key:"hideSmartBtn",value:function(){this.event.eventSmart.trigger("hideSmartBtn")}},{key:"renderSelection",value:function(){this.selectData.change({type:B.SELECT_SHOW_TYPE.EXTERNAL})}},{key:"turnOnSmartSelection",value:function(){this.event.eventSmart.trigger("turnOnSmartSelection")}},{key:"turnOffSmartSelection",value:function(){this.event.eventSmart.trigger("turnOffSmartSelection")}},{key:"getDefaultValue",value:function(e,t,i){var n,a=void 0,o=void 0;if("width"===i?a=this.tableData.col.getWidth:"height"===i&&(a=this.tableData.row.getHeight),!a)return"";for(n=a(e,{ignoreScale:!0}),o=e;o<=t;o++)if(n!==a(o,{ignoreScale:!0}))return"";return n}},{key:"checkRangeValidation",value:function(e){return!!(e&&2===e.length&&"number"===typeof e[0]&&"number"===typeof e[1]&&e[0]>=0&&e[1]>=0&&e[0]<=e[1])}},{key:"showDialogForRowsColumnsSetting",value:function(e){var t=this,i=this.selectData.select,n="",a="",o=void 0;if("ROW"===e)n="\u8bbe\u7f6e\u884c\u9ad8",a="\u884c\u9ad8 ( \u9ed8\u8ba4\u503c: "+this.configData.rowHeight+"\u50cf\u7d20 )",o=this.getDefaultValue(i.yRange[0],i.yRange[1],"height");else{if("COL"!==e)return;n="\u8bbe\u7f6e\u5217\u5bbd",a="\u5217\u5bbd ( \u9ed8\u8ba4\u503c: "+this.configData.colWidth+"\u50cf\u7d20 )",o=this.getDefaultValue(i.xRange[0],i.xRange[1],"width")}(0,z.inputDialog)({title:n,info:a,defaultValue:o,min:10,errorInfo:"\u6709\u6548\u8303\u56f4\uff1a10-1000",callback:function(n){var a=[];"ROW"===e?(a=i.yRange,t.checkRangeValidation(a)&&t.hookFunc.setRowHeight&&t.hookFunc.setRowHeight(a,n)):"COL"===e&&(a=i.xRange,t.checkRangeValidation(a)&&t.hookFunc.setColWidth&&t.hookFunc.setColWidth(a,n))}})}},{key:"setColWidthToDefault",value:function(){var e=this.selectData.select.xRange,t=this.configData.colWidth;this.checkRangeValidation(e)&&this.hookFunc.setColWidth&&this.hookFunc.setColWidth(e,t)}},{key:"setRowHeightColWidthAutoFit",value:function(e){var t=this,i=this.selectData.select,n=i.yRange,a=i.xRange;"ROW"===e&&this.checkRangeValidation(n)?this.rowHeader.backgroundBoard._autoFitRowHeights(n):"COL"===e&&this.checkRangeValidation(a)?this.colHeader.backgroundBoard._autoFitColWidths(a,function(e){t.hookFunc.setColWidth&&t.hookFunc.setColWidth(a,e)}):"AUTO"===e&&this.checkRangeValidation(a)&&this.checkRangeValidation(n)&&this.colHeader.backgroundBoard._autoFitColWidths(a,function(e){t.hookFunc.resizeRowsColumns&&t.hookFunc.resizeRowsColumns(n,void 0,a,e)})}},{key:"insertFormula",value:function(e){var t=this.inputCenter.board,i="",n=0;if(t.restoreFocusStateIfNeed(),2===this.tableData.inputStatus){i=t.getCurrentText();var a=t.getCurrentRange();if(a.start!==a.end)return t.alloyRTE.deleteText(),this.insertFormula(e);n=a.start}var o=(0,W.default)(e.formula,n,i.replace(/\n/g,"")),s=o.value,r=o.curpos;0===this.tableData.inputStatus?this.event.eventInput.trigger("inputShow",{editValue:s,cursor:r,stockEditAsFormula:!0,forceUpdateValue:!0}):(1!==this.tableData.inputStatus&&3!==this.tableData.inputStatus||(this.tableData.inputStatus=2),this.event.eventInput.trigger("inputValueAndCursorChange",{value:s,cursor:r,type:"FORMULA"}))}},{key:"tableInputBoardFormat",value:function(e,t){this.inputCenter.board.format({cmd:e,value:t})}},{key:"toolbarInputFormat",value:function(e,t,i){this.inputCenter.board.format({range:e,cmd:t,value:i})}},{key:"toolbarUndoRedoForInputBoard",value:function(e){"undo"===e&&this.inputCenter.board.undo(),"redo"===e&&this.inputCenter.board.redo()}},{key:"inputChannel",value:function(e){var t=e.type;if("ENTER_TOOLBAR_INPUT"===t)this.event.eventInput.trigger("inputShow",{enterToolbarInput:!0,stockEditAsFormula:!0});else if("EXIT"===t){e.moveDirection;this.inputCenter.board.alloyRTE.focus()}else if("SYNC_VALUE"===t){var i=e.value;this.event.eventInput.trigger("inputValueAndCursorChange",{value:i,channelType:t})}else if("FORMAT"===t){var n=e.cmd,a=e.value,o=e.range;this.toolbarInputFormat(o,n,a)}}},{key:"showSortAreaOverlay",value:function(e,t){this.event.eventTable.trigger("showSortAreaOverlay",e,t)}},{key:"hideSortAreaOverlay",value:function(){this.event.eventTable.trigger("hideSortAreaOverlay")}},{key:"__isCellVisual",value:function(e,t){var i=this.areaData;return(i.row.frozen.length>0&&e>=i.row.frozen.from&&e<=i.row.frozen.to||e>=i.row.flow.from&&e<=i.row.flow.to)&&(i.col.frozen.length>0&&t>=i.col.frozen.from&&t<=i.col.frozen.to||t>=i.col.flow.from&&t<=i.col.flow.to)}},{key:"setMenuConfig",value:function(e){this.configData.pcMenu=e}},{key:"setHideGridlines",value:function(e){this.tableData.hideGridlines!==e&&(this.tableData.hideGridlines=e,this.renderNextTick())}},{key:"highlightMentionWhenFocus",value:function(e,t,i){var n=this;this._renderMentionSegmentWithStatus(e,t,i,q.MENTION_STATUS.HIGHTLIGHT),setTimeout(function(){n._renderMentionSegmentWithStatus(e,t,i,q.MENTION_STATUS.NORMAL)},3e3)}},{key:"_renderMentionSegmentWithStatus",value:function(e,t,i,n){var a=this._findMention(e,t,i);a&&(a.setMentionSegmentStatus(n),this.renderNextTick())}},{key:"_findMention",value:function(e,t,i){var n=this.tableData.getCellDataAtPosition(e,t);if(!n||!n.lines||!n.lines.length)return null;for(var a=void 0,o=void 0,s=0;s<n.lines.length;s++){a=n.lines[s];for(var r=0;r<a.segments.length;r++)if((o=a.segments[r])instanceof ee.default&&o.mentionInfo.mentionId===i)return o}return null}},{key:"switchPermission",value:function(e){this.configData.permissions!==e&&(this.configData.permissions=e,this.event.eventTable.trigger("permissionChange"))}},{key:"highLightRangeOuterLineWithBorder",value:function(e,t){var i=this.renders&&this.renders.borderRender;if(i){var n=e.startRow,a=e.endRow,o=e.startCol,s=e.endCol,r=t&&t.style||te.BORDER_STYLE.THICK,l=t&&t.color||"#4fa217",h=this.areaData.col.getViewportLeft(o),g=this.areaData.col.getViewportLeft(s)+this.tableData.getCellBackgroundWidth(n,s,!1),c=this.areaData.row.getViewportTop(n),d=this.areaData.row.getViewportTop(a)+this.tableData.getCellBackgroundHeight(a,o,!1),u=[h,c,g,c],f=[h,d,g,d],v=[h,c,h,d],A=[g,c,g,d];i.collect({style:r,color:l},[u,f,v,A],!0),i.render()}}},{key:"scale",set:function(e){this.scaleTo(e)},get:function(){return this.tableData.scale}},{key:"rowCount",get:function(){return this.tableData.row.length},set:function(e){console.error("can't set row count")}},{key:"colCount",get:function(){return this.tableData.col.length},set:function(e){console.error("can't set col count")}}]),e}();(0,B.exportConstant)(oe),t.default=oe},1159:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(3)),a=c(i(0)),o=c(i(1)),s=c(i(4)),r=c(i(5)),l=c(i(1160)),h=i(21),g=i(10);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.stage.event.eventTable.listen("tableFirstRendered",function(){i.initMouse()}),i.moveTick=16,i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initMouse",value:function(){var e=this;if(!this.stage.configData.preview&&(this.stage.container.addEventListener("mousedown",function(t){e.stage.mouseData.mousedown(t)},!0),this.stage.container.addEventListener("mouseup",function(t){e.stage.mouseData.mouseup(t)},!0),this.board.addEventListener("mousedown",function(t){t.preventDefault(),e.stage.handleEvent("mousedown",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})}),this.board.addEventListener("mouseup",function(t){t.preventDefault(),e.stage.handleEvent("mouseup",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})}),this.stage.container.addEventListener("contextmenu",function(t){t.preventDefault(),e.stage.handleEvent("rightClick")}),this.stage.container.addEventListener("click",function(t){e.stage.handleEvent("click",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})}),this.stage.container.addEventListener("dblclick",function(t){e.stage.selectData.pickShape||e.stage.handleEvent("dblclick",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})}),this.stage.container.addEventListener("mousemove",function(t){e.stage&&e.stage.mouseData&&Date.now()-e.stage.mouseData.protect>e.moveTick&&(e.stage.mouseData.mousemove(t),e.stage.handleEvent("mousemove",{x:e.stage.mouseData.currX,y:e.stage.mouseData.currY,diffX:e.stage.mouseData.diffX,diffY:e.stage.mouseData.diffY,e:t}))}),document.addEventListener("mouseup",function(t){e.stage.event.eventMouse.remove("mousedrag"),e.stage.event.eventMouse.trigger("mousedragEnd"),e.stage.event.eventMouse.remove("mousedragEnd")}),this.setupMouseScrollEvent(),window.addEventListener("resize",function(){e.stage.resize()}),h.mac)){var t=!1;try{var i=Object.defineProperty({},"passive",{get:function(){t=!0}});window.addEventListener("test",null,i)}catch(n){}document.addEventListener("mousewheel",function(e){var t=void 0;void 0!==e.wheelDeltaX?t=e.wheelDeltaX:void 0!==e.deltaX&&(t=-e.deltaX),0!=t&&e.preventDefault()},!!t&&{passive:!1})}}},{key:"setupMouseScrollEvent",value:function(){var e=this;if(h.isFireFox){var t="onwheel"in document.createElement("div")?"wheel":"DOMMouseScroll";this.board.addEventListener(t,this.handleMouseScrollEventForFirefox.bind(this))}else{var i="onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll";this.board.addEventListener(i,function(t){t.preventDefault();var i=0,n=0;void 0!==t.wheelDeltaY?i=t.wheelDeltaY:void 0!==t.deltaY?i=-t.deltaY:t.wheelDelta?i=t.wheelDelta:t.detail&&(i=-t.detail),void 0!==t.wheelDeltaX?n=t.wheelDeltaX:void 0!==t.deltaX&&(n=-t.deltaX);var a=2*e.stage.configData.rowHeight*(e.stage.scale||1);e._smoothScrollY||0===i||i%120!==0?(e._smoothScrollY=!0,i*=.3):i=Math.ceil(i/120)*a,e._smoothScrollX||0===n||n%120!==0?(e._smoothScrollX=!0,n*=.3):n=Math.ceil(n/120)*a,e.scrollByPixel(n,i)})}}},{key:"handleMouseScrollEventForFirefox",value:function(e){var t=0,i=0;if("wheel"===e.type)t=e.deltaX,i=e.deltaY,1===e.deltaMode?h.mac?(0!==i&&(i=i>0?Math.max(10,Math.min(10*i,80)):Math.min(-10,Math.max(10*i,-80))),0!==t&&(t=t>0?Math.max(10,Math.min(10*t,80)):Math.min(-10,Math.max(10*t,-80)))):(0!==i&&(i=i>0?Math.max(20,Math.min(20*i,100)):Math.min(-20,Math.max(20*i,-100))),0!==t&&(t=t>0?Math.max(20,Math.min(20*t,100)):Math.min(-20,Math.max(20*t,-100)))):(i*=.3,t*=.3),this.scrollByPixel(-t,-i);else{var n=e.axis,a=e.detail>0?Math.max(10,Math.min(10*e.detail,80)):Math.min(-10,Math.max(10*e.detail,-80));1===n?this.scrollByPixel(-a,0):this.scrollByPixel(0,-a)}e.preventDefault()}},{key:"scrollByPixel",value:function(e,t){this.stage.areaData.areaX=g.TABLE_AREA.FLOW,this.stage.areaData.areaY=g.TABLE_AREA.FLOW,e&&this.stage.handleScroll({dir:0,diff:e}),t&&this.stage.handleScroll({dir:1,diff:t})}}]),t}(l.default);t.default=d},1160:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.canvas=t.canvas,this.container=t.container,this.init(),this.initStyle(),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){var e=document.createElement("div");e.style.width="100%",e.style.height="100%",e.className="touch-board",this.board=e,this.container.appendChild(e)}},{key:"initStyle",value:function(){i(1161)}},{key:"changeMoveTick",value:function(e){this.moveTick=e}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(){e.stage.tableData.scale<.8?e.changeMoveTick(30):e.changeMoveTick(16)})}}]),e}();t.default=s},1161:function(e,t,i){var n=i(1162);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1162:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".touch-board {\n    position: absolute;\n    top: 0;\n    left: 0;\n    /* overflow: hidden; */\n    z-index: 101;\n    background-color: rgba(255, 255, 255, 0);\n    /* opacity: 0; */\n    /* filter: alpha(opacity=0);  */\n}\n",""])},1164:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(3)),a=g(i(0)),o=g(i(1)),s=g(i(4)),r=g(i(5)),l=g(i(1165)),h=i(10);function g(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,r.default)(t,e),(0,o.default)(t,[{key:"onmousedown",value:function(e){if(2!==e.button){var t=this.stage.selectData;t.resetSelect(),t.select.selectAll?this.stage.event.eventSelection.trigger("selectionTo",{x:0,y:0}):t.change({selectQueue:[{xRange:[0,this.stage.tableData.col.length-1],yRange:[0,this.stage.tableData.row.length-1],selectAll:!0}],active:{xIndex:0,yIndex:0},type:h.SELECT_SHOW_TYPE.SELECT}),this.stage.event.eventMouse.trigger("mousedown",{x:-1,y:-1})}}},{key:"onclick",value:function(){this.stage.event.eventMouse.trigger("click",{x:this.stage.mouseData.lastCell.x,y:this.stage.mouseData.lastCell.y})}},{key:"onmousemove",value:function(e){this.stage.event.eventMouse.trigger("mousemove",{lastCell:this.stage.mouseData.lastCell,newCell:{x:-1,y:-1}}),this.stage.mouseData.lastCell.x=-1,this.stage.mouseData.lastCell.y=-1}}]),t}(l.default);t.default=c},1165:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.ctx=this.stage.ctx,this.init(),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){this.startX=this.width=this.stage.configData.rowHeadWidth,this.startY=this.height=this.stage.configData.colHeadHeight;var e=4*this.stage.tableData.scale>>0;this.point1=[this.width-e,e],this.point2=[this.width-e,this.height-e],this.point3=[this.width-this.height+e,this.height-e],this.aabb=[0,0,this.width,this.height]}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(){e.init()}),this.stage.event.eventSelection.listen("selectionShow",function(){e.render()})}},{key:"render",value:function(){this.ctx.globalCompositeOperation="source-over",this.lineTotalHeight=this.stage.tableData.viewportY,this.lineTotalWidth=this.stage.tableData.viewportX,this.ctx.save(),this.ctx.beginPath(),this.ctx.strokeStyle="#d8dade",this.ctx.fillStyle="#f4f5f8",this.ctx.rect(0,0,this.width,this.height),this.ctx.closePath(),this.ctx.fill(),this.ctx.beginPath(),this.ctx.moveTo(0,0),this.ctx.lineTo(0,this.lineTotalHeight),this.ctx.moveTo(this.startX,0),this.ctx.lineTo(this.startX,this.lineTotalHeight),this.ctx.moveTo(0,0),this.ctx.lineTo(this.lineTotalWidth,0),this.ctx.moveTo(0,this.startY),this.ctx.lineTo(this.lineTotalWidth,this.startY),this.ctx.closePath(),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.fillStyle=this.stage.selectData.select.selectAll?"#018bff":"#babdc1",this.ctx.moveTo(this.point1[0],this.point1[1]),this.ctx.lineTo(this.point2[0],this.point2[1]),this.ctx.lineTo(this.point3[0],this.point3[1]),this.ctx.closePath(),this.ctx.fill(),this.ctx.restore()}}]),e}();t.default=s},1166:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(i(3)),a=v(i(0)),o=v(i(1)),s=v(i(4)),r=v(i(5)),l=v(i(1167)),h=v(i(1168)),g=i(21),c=v(i(202)),d=i(10),u=v(i(12)),f=v(i(8));function v(e){return e&&e.__esModule?e:{default:e}}var A=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.selectArea=function(){var e,t=i.stage.selectData,n=i.stage.areaData.col.getIndex(i.stage.mouseData.currX),a=t.select,o=[],s=[a.yRange[0],a.yRange[1]],r=i.stage.areaData.col;e=n-i.cacheSelectIndex;var l=a.xRange[0];e>0?(o[0]=i.cacheSelectIndex,o[1]=i.cacheSelectIndex+e):0===e?(o[0]=i.cacheSelectIndex,o[1]=i.cacheSelectIndex):(o[0]=n,o[1]=n-e),r.frozen.length>0&&n<=r.frozen.to&&n>=r.frozen.from&&l>r.frozen.to+1&&(o[0]=r.flow.from),i.stage.tableData.selectionChanged=!0,t.change({select:{xRange:o,yRange:s,selectCol:!0},type:d.SELECT_SHOW_TYPE.SELECT})},i.hoverHideIcon=!1,i.hoverHideIndex=-1,i.backgroundBoard=new h.default({stage:i.stage,container:i.stage.container,parent:i}),i.cacheSelectIndex=0,i._shortPressTimer=null,i._longPressTimer=null,i._shortPressFlag=!1,i._longPressFlag=!1,i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"onmousedown",value:function(e){var t=this.stage.areaData.col.getIndex(e.x),i=this.stage.selectData;e.xIndex=t,e.yIndex=0,(0,g.isInRange)(t,i.select.xRange)&&2===e.button&&i.select.selectCol||(this.hoverHideIcon?this._showColHide():((0,g.isInRange)(t,i.select.xRange)&&i.select.selectCol?this.longPressDetectHandler(e):this.shortPressHandler(e),this.stage.inputCenter.board.hasFocus()||this.stage.inputCenter.board.focus()))}},{key:"longPressDetectHandler",value:function(e){var t=this;this.stage.event.eventMouse.one("mousedrag",function(i){Math.abs(e.x-i.x)<=10&&Math.abs(e.y-i.y)<=10||(t._failLongPress(),u.default.erase(t._shortPressTimer),t.shortPressHandler(e))}),this._longPressTimer=u.default.wait(d.LONG_PRESS_THRESHOLD).run(function(){if(t.stage.configData.permissions){u.default.erase(t._shortPressTimer),t._longPressFlag=!0,t._shortPressFlag=!1,console.log("----\u5f00\u59cb\u957f\u6309\u62d6\u52a8"),t._addDragStartWithLongPress(),t.stage.event.eventDimension.trigger("dragRowColStart"),t.stage.colHeader.backgroundBoard.showMoveCol(e);var i=t.stage.selectData.select.xRange,n=i[1]-i[0]>0?"move_more_col":"move_one_col";f.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:n})}}),this._shortPressTimer=u.default.wait(d.LONG_PRESS_THRESHOLD).run(function(){t.shortPressHandler(e)})}},{key:"shortPressHandler",value:function(e){if(!this._longPressFlag){this._shortPressFlag=!0,this._longPressFlag=!1;var t=this.stage.selectData;if(this.stage.areaData.switchArea(e),t.resetSelect(),c.default.key.shift)return this.selectArea(e),void this._addDragStartWithShortPress();this.cacheSelectIndex=e.xIndex,t.change({select:{xRange:[e.xIndex,e.xIndex],yRange:[0,this.stage.tableData.row.length-1],selectCol:!0},active:this.getActivationWhenSelectCol({xIndex:e.xIndex,yIndex:e.yIndex}),type:d.SELECT_SHOW_TYPE.SELECT}),this._addDragStartWithShortPress(),this.stage.event.eventMouse.trigger("mousedown",{x:e.xIndex,y:-1})}}},{key:"onclick",value:function(){this.stage.event.eventMouse.trigger("click",{x:this.stage.mouseData.lastCell.x,y:this.stage.mouseData.lastCell.y})}},{key:"onmousemove",value:function(e){this.stage.mouseData.down||(e.xIndex=this.stage.areaData.col.getIndex(e.x),this.backgroundBoard.checkResizeCol(e),this._checkHideTriangle(e),this.stage.event.eventMouse.trigger("mousemove",{lastCell:this.stage.mouseData.lastCell,newCell:{x:e.xIndex,y:-1}}),this.stage.mouseData.lastCell.x=e.xIndex,this.stage.mouseData.lastCell.y=-1)}},{key:"onmouseup",value:function(){this._failLongPress(),this.stage.hookFunc.tableRowColHeaderMouseup&&this.stage.hookFunc.tableRowColHeaderMouseup("row")}},{key:"_failLongPress",value:function(){this._longPressTimer&&(u.default.erase(this._longPressTimer),this._longPressFlag=!1,this._shortPressFlag=!0)}},{key:"_addDragStartWithShortPress",value:function(){var e=this;this._shortPressFlag&&(this.stage.event.eventTable.listen("tableMove",this.selectArea),this.stage.event.eventMouse.one("mousedrag",function(t){e.selectArea(t),t.y=null,e.stage.judgeAutoMove(t)}),this.stage.event.eventMouse.one("mousedragEnd",function(t){e.stage.event.eventTable.remove("tableMove",e.selectArea),e.stage.stopAutoMove()}),this.stage.event.eventTable.trigger("enterActiveStatus"))}},{key:"_addDragStartWithLongPress",value:function(){var e=this;this._longPressFlag&&(this.stage.event.eventMouse.one("mousedrag",function(e){console.log("----\u957f\u6309\u62d6\u52a8\u4e2d...")}),this.stage.event.eventMouse.one("mousedragEnd",function(t){console.log("----\u7ed3\u675f\u957f\u6309\u62d6\u52a8"),e.stage.event.eventDimension.trigger("dragRowColEnd")}))}},{key:"_checkHideTriangle",value:function(e){if(this.stage.configData.permissions){var t=e.xIndex,i=void 0,n=this.stage.configData,a=this.stage.tableData,o=this.stage.areaData;if(a.hideColMap[t-1]||a.hideColMap[t+1]){var s=n.hideTriangle[0],r=(n.colHeadHeight-s)/3>>0,l=n.hideTriangle[1]+4,h=n.hideTriangle[2],c=!1;if(a.hideColMap[t-1]&&(i=[o.col.getViewportLeft(t),r,h+l,s],(0,g.checkIsIn)(e,i)&&(this._renderHoverHideTriangle(t-1),c=!0)),c)return this.hoverHideIcon=!0,void(this.hoverHideIndex=t-1);a.hideColMap[t+1]&&(i=[o.col.getViewportLeft(t)+a.col.getWidth(t)-h-l,r,h+l,s],(0,g.checkIsIn)(e,i)&&(this._renderHoverHideTriangle(t+1),c=!0)),c?(this.hoverHideIcon=!0,this.hoverHideIndex=t+1):this.hoverHideIcon&&(this.hoverHideIcon=!1,this.hoverHideIndex=-1,this.stage.renderColHeader())}else this.hoverHideIcon&&(this.hoverHideIcon=!1,this.hoverHideIndex=-1,this.stage.renderColHeader())}}},{key:"_showColHide",value:function(){var e=this.hoverHideIndex,t=0,i=[],n=this.stage.tableData;if(n.hideColMap[e-1]?t=-1:n.hideColMap[e+1]?t=1:i=[e],0!==t)for(;n.hideColMap[e];)i.push(e),e+=t;console.log("hide col: ",i),this.stage.hookFunc.showColHide&&this.stage.hookFunc.showColHide(i)}}]),t}(l.default);t.default=A},1167:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(21),s=i(10);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.backgroundColor=t.backgroundColor,this.ctx=this.stage.ctx,this.viewWidth=this.stage.width,this.viewHeight=this.stage.configData.colHeadHeight,this.cacheSelect={},this.defaultLine="#d8dade",this.initEvent(),this.init()}return(0,a.default)(e,[{key:"init",value:function(){this.aabb=[this.stage.configData.rowHeadWidth,0,this.viewWidth-this.stage.configData.rowHeadWidth,this.viewHeight]}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventSelection.listen("selectionShow",function(t){t&&t.selectChange&&(e._calcCacheSelect(t),e.stage.renderColHeader())}),this.stage.event.eventSelection.listen("selectionHide",function(){0===e.stage.tableData.inputStatus&&(e.cacheSelect={})}),this.stage.event.eventTable.listen("scale",function(){e._scale()}),this.stage.event.eventTable.listen("clearTable",function(){e._clear()})}},{key:"_scale",value:function(){this.viewWidth=this.stage.width,this.viewHeight=this.stage.configData.colHeadHeight,this.aabb=[this.stage.configData.rowHeadWidth,0,this.viewWidth-this.stage.configData.rowHeadWidth,this.viewHeight]}},{key:"_calcCacheSelect",value:function(){var e=this;this.cacheSelect={};var t=this.stage.selectData.getSelectQueue(),i=void 0,n=void 0;t.forEach(function(t){var a=t.sheetIds;for(n=t.selectCol||t.selectAll?200:e.stage.hookFunc.isActiveSheetIdInSheetIds(a)?100:0,i=t.xRange[0];i<=t.xRange[1];i++)void 0===e.cacheSelect[i]?e.cacheSelect[i]=n:e.cacheSelect[i]=Math.max(e.cacheSelect[i],n)})}},{key:"_clear",value:function(){}},{key:"_renderHoverHideTriangle",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=(this.stage.configData.colHeadHeight-i)/2>>0,a=t[1],o=t[2],s=void 0,r=void 0,l=void 0,h=this.stage.areaData.col,g=this.stage.tableData;for(this.ctx.lineWidth=2,this.ctx.strokeStyle="#d4d4d4",this.ctx.fillStyle="#ffffff",s=e+1;g.hideColMap[s];)s++;for(s<g.col.length&&s>=(r=h.getArea(s)).from&&s<=r.to&&(l=h.getViewportLeft(s))>=r.viewStart-2&&l<=r.viewStart+r.viewWidth+2&&(this.ctx.translate(-.5,-.5),this.ctx.clearRect(l,n-2,a+o+4,i+4),this.ctx.beginPath(),this.ctx.translate(.5,.5),this.ctx.rect(l,n-2,a+o+4,i+4),this.ctx.stroke(),this.ctx.fill(),this._renderHideTriangleRight(l),this.ctx.closePath()),s=e-1;g.hideColMap[s];)s--;s>=0&&s>=(r=h.getArea(s)).from&&s<=r.to&&(l=h.getViewportLeft(s)+g.col.getWidth(s))>=r.viewStart-2&&l<=r.viewStart+r.viewWidth+2&&(this.ctx.translate(-.5,-.5),this.ctx.clearRect(l-o-a-4,n-2,a+o+4,i+4),this.ctx.beginPath(),this.ctx.translate(.5,.5),this.ctx.rect(l-o-a-4,n-2,a+o+4,i+4),this.ctx.stroke(),this.ctx.fill(),this._renderHideTriangleLeft(l),this.ctx.closePath()),this.ctx.lineWidth=1}},{key:"_renderHideTriangleLeft",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=(this.stage.configData.colHeadHeight-i)/2>>0,a=t[1],o=t[2];this.ctx.translate(-.5,-.5),this.ctx.drawImage(this.stage.configData.hideLeftIcon,e-o-a,n,a,i),this.ctx.translate(.5,.5)}},{key:"_renderHideTriangleRight",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=(this.stage.configData.colHeadHeight-i)/2>>0,a=t[1],o=t[2];this.ctx.translate(-.5,-.5),this.ctx.drawImage(this.stage.configData.hideRightIcon,e+o,n,a,i),this.ctx.translate(.5,.5)}},{key:"getColorStatus",value:function(e){var t=0,i=this.stage.tableData;return i.filter.open&&(0,o.isInRange)(e,i.filter.range.xRange)&&(t=1),t+(this.cacheSelect[e]||0)}},{key:"_renderArea",value:function(e){var t,i=void 0,n=void 0,a=void 0,s=void 0,r=(this.stage.selectData,this.stage.areaData.col),l=r[e].maxDistance,h=r[e].viewWidth,g=this.stage.tableData,c=g.col,d=r[e].from,u=Math.min(r[e].to,c.widths.length-1),f=r.getViewportLeft(d),v=void 0,A=this.stage.configData;for(a=f,this.ctx.clearRect(r[e].viewStart,0,h,this.viewHeight),this.backgroundColor&&(this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(r[e].viewStart,0,h,this.viewHeight)),this.ctx.save(),t=this.defaultLine,s=d;s<=u;s++)if((0,o.isColShow)(g,s)){if(i=c.getWidth(s),a>=l)break;g.hideColMap[s-1]&&this._renderHideTriangleRight(a),a+=i,this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.moveTo(a,0),this.ctx.lineTo(a,this.viewHeight),this.ctx.stroke(),this.ctx.closePath(),g.hideColMap[s+1]&&this._renderHideTriangleLeft(a)}for(a=f-1,s=d;s<=u;s++)if((0,o.isColShow)(g,s)){if(i=c.getWidth(s),v=this.getColorStatus(s),n=A.tableHeaderColor[v],a>=l)break;this.ctx.fillStyle="#777777",this.ctx.fillText(o.colName[s],a+i/2,this.viewHeight/2),this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.rect(a,0,i+1,this.viewHeight),this.ctx.fill(),this.ctx.closePath(),a+=i}this.ctx.restore(),g.viewportX=a}},{key:"render",value:function(){this.ctx.globalCompositeOperation="destination-over";var e=this.stage.areaData.col;this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.font=this.fontSize+'px "Microsoft YaHei", "sourcecode", sans-serif',e.frozen.length>0&&this._renderArea(s.TABLE_AREA.FROZEN),this._renderArea(s.TABLE_AREA.FLOW)}},{key:"getActivationWhenSelectCol",value:function(e){for(var t=e,i=t.xIndex,n=t.yIndex,a=this.stage.getRowCount();n<a;){var o=this.stage.tableData.getCellDataAtPosition(n,i);if(!o||!o.merge&&!o.merged)break;var s=o.merge?o.mergeData:o.parent&&o.parent.mergeData;if(!s)break;if(s.xRange[0]===s.xRange[1])break;n=Math.max(s.yRange[0],s.yRange[1])+1}return{xIndex:i,yIndex:n<a?n:t.yIndex}}},{key:"fontSize",get:function(){return 10*this.stage.tableData.scale>>0},set:function(e){console.error("can't set fontSize")}}]),e}();t.default=l},1168:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(3)),a=c(i(0)),o=c(i(1)),s=c(i(4)),r=c(i(5)),l=c(i(59)),h=c(i(1169)),g=i(21);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i._moveMousemove=function(e){var t=i.stage.configData,n=e.clientY-t.distanceY,a=e.clientX-t.distanceX-i.moveCacheLeft,o=e.clientX-t.distanceX;a=Math.max(a,t.rowHeadWidth),n=Math.max(n,t.colHeadHeight),a<80?i.stage.judgeAutoMove({x:a,autoMoveThreshold:20}):o>i.stage.width-120?i.stage.judgeAutoMove({x:o,autoMoveThreshold:20}):i.stage.stopAutoMove(),i._checkMoveTo(e);var s=i.stage.tableData.col.length,r=i.stage.areaData.col.getViewportLeft(s)-100-4;a>r&&(a=r),i.moveBar.style.left=a+"px",i.moveBar.style.top=n+"px"},i._moveMouseup=function(){i.stage.touchBoard.board.classList.remove("drag-rowcol"),i.stage.stopAutoMove(),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_moveEnd",i).call(i),document.removeEventListener("mousemove",i._moveMousemove),document.removeEventListener("mouseup",i._moveMouseup),document.removeEventListener("keydown",i._preventShortcutKeys,!0)},i._hideResizeHandle=function(){(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_hideResizeHandle",i).call(i),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_hideResizeBar",i).call(i),i.resizeRuler.style.display="none",i.resizeCacheX=-1},i._resizeMousemove=function(e){e.stopPropagation();var t=i.stage.configData,n=e.clientX-t.distanceX-i.moveCacheLeft;(n=Math.max(n,t.rowHeadWidth))<80?i.stage.judgeAutoMove({x:n,autoMoveThreshold:100,isOverMax:!0}):n>i.stage.width-120?i.stage.judgeAutoMove({x:n,autoMoveThreshold:100,isOverMax:!0}):i.stage.stopAutoMove(),i._updateResizeHandle(),i._updateResizeRulerPosition()},i._resizeMouseup=function(e){var t=i.stage.tableData,n=i.stage.mouseData.currX-i.resizeCacheOffsetX+(i.stage.areaData.col.flow._offsetX-i.resizeBeginViewOffsetX),a=void 0;i.parent.resizing=!1,0!==n&&(a=(t.col.getWidth(i.resizeCacheX)+n)/t.scale>>0,i._setColumnsWidthSameWidth(a),i._hideResizeHandle()),i.stage.stopAutoMove(),document.removeEventListener("mousemove",i._resizeMousemove),document.removeEventListener("mouseup",i._resizeMouseup),document.removeEventListener("keydown",i._preventShortcutKeys,!0),i.resizeHandle.addEventListener("mouseleave",i._hideResizeHandle)},i._preventShortcutKeys=function(e){e.preventDefault(),e.stopPropagation()},i.stage.configData.permissions&&i.initMouse(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1170)}},{key:"init",value:function(){var e=document.createElement("div");e.className="col-board",this.board=e,e.style.left=0,e.style.top=0;var t=document.createElement("div");t.className="resizer-vertical-handle",this.resizeHandle=t,t.style.height=this.stage.configData.colHeadHeight+"px";var i=document.createElement("div");i.className="resizer-vertical-handle-bar",this.resizeBar=i,i.style.height=this.stage.height+"px",t.appendChild(i),e.appendChild(t);var n=document.createElement("div");n.className="resizer-vertical-ruler",this.resizeRuler=n,t.appendChild(n);var a=document.createElement("div");a.className="move-vertical-cover",this.moveCover=a;var o=document.createElement("div");o.className="move-vertical-line",o.style.height=this.stage.height+"px",o.style.top=this.stage.configData.colHeadHeight+"px",this.moveLine=o;var s=document.createElement("div");s.className="move-vertical-bar";var r=document.createElement("div");r.className="move-vertical-bar-label",s.appendChild(r),this.moveBar=s,this.moveLabel=r,e.appendChild(a),e.appendChild(o),e.appendChild(s),this.container.appendChild(e)}},{key:"initMouse",value:function(){var e=this;this.resizeHandle.addEventListener("mouseleave",this._hideResizeHandle),this.resizeHandle.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),e.resizeCacheOffsetX=e.stage.mouseData.currX,e.resizeBeginViewOffsetX=e.stage.areaData.col.flow._offsetX,e._showResizeBarRuler(),e.parent.resizing=!0,document.addEventListener("mousemove",e._resizeMousemove),document.addEventListener("mouseup",e._resizeMouseup),document.addEventListener("keydown",e._preventShortcutKeys,!0),e.resizeHandle.removeEventListener("mouseleave",e._hideResizeHandle)}),this.resizeHandle.addEventListener("dblclick",function(){e._setColumnsAutoFit(),e._hideResizeHandle()}),this.resizeHandle.addEventListener("contextmenu",function(t){e._hideResizeHandle(),e.stage.handleEvent("mousedown",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})})}},{key:"showMoveCol",value:function(e){this.stage.touchBoard.board.classList.add("drag-rowcol"),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"showMoveCol",this).call(this,e)&&(document.addEventListener("mousemove",this._moveMousemove),document.addEventListener("mouseup",this._moveMouseup),document.addEventListener("keydown",this._preventShortcutKeys,!0))}},{key:"checkResizeCol",value:function(e){if(this.stage.configData.permissions){var t=e.x,i=0,n=this.stage.areaData.col,a=this.stage.tableData;if(n.frozen.length>0)for(;i<=n.frozen.to;i++)if(Math.abs(t-n.getViewportLeft(i)-a.col.getWidth(i,{ignoreHide:!1}))<3)return void this._showResizeHandle(i);for(i=Math.max(0,n.flow.from);i<=n.flow.to;i++)if((0,g.isColShow)(a,i)&&Math.abs(t-n.getViewportLeft(i)-a.col.getWidth(i,{ignoreHide:!1}))<3)return void this._showResizeHandle(i);this._hideResizeHandle()}}},{key:"_showResizeHandle",value:function(e){var t=this.stage.tableData,i=this.stage.configData,n=this.stage.areaData.col.getViewportLeft(e),a=t.col.getWidth(e,{ignoreHide:!1});this.resizeCacheX=e,this.resizeCacheMinLeft=i.rowHeadWidth,this.resizeHandle.style.left=n+a-2+"px",this.resizeHandle.style.display="block",this._updateResizeRulerPosition()}},{key:"_updateResizeHandle",value:function(){var e=this.stage.mouseData.currX;e<this.resizeCacheMinLeft?e=this.resizeCacheMinLeft:e>this.stage.width&&(e=this.stage.width),this.resizeHandle.style.left=e+"px"}},{key:"_showResizeBarRuler",value:function(){(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_showResizeBar",this).call(this),this.resizeRuler.style.display="block",this._updateResizeRulerPosition()}},{key:"_updateResizeRulerPosition",value:function(){var e=this.stage.mouseData.currX;e<this.resizeCacheMinLeft?e=this.resizeCacheMinLeft:e>this.stage.width&&(e=this.stage.width);var t=parseInt(e-this.stage.areaData.col.getViewportLeft(this.resizeCacheX));t=Math.max(t,0),this.resizeRuler.innerText="\u5bbd\u5ea6\uff1a"+t+"\u50cf\u7d20",this.resizeRuler.style.left=-this.resizeRuler.offsetWidth+"px"}},{key:"_checkMoveTo",value:function(e){var t=this.stage.areaData.col.getIndex(e.clientX-this.stage.configData.distanceX),i=this.stage.tableData.col.getWidth(t,{ignoreHide:!1}),n=this.stage.areaData.col.getViewportLeft(t),a=e.clientX-this.stage.configData.distanceX-n;t<this.moveCacheXRange[0]&&a>i/2&&(t+=1),t>this.moveCacheXRange[1]&&a>i/2&&(t+=1),t>=this.moveCacheXRange[0]&&t<=this.moveCacheXRange[1]&&(t=this.moveCacheXRange[0]),this._showMoveLine(t)}},{key:"_showMoveLine",value:function(e){var t=this.stage.areaData.col.getViewportLeft(e);this.moveCacheToX=e,t=Math.max(t,this.stage.configData.rowHeadWidth),this.moveLine.style.left=t+"px"}}]),t}(h.default);t.default=d},1169:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=i(21),s=i(10),r=l(i(8));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,n.default)(this,e),this.parent=t.parent,this.stage=t.stage,this.container=t.container,this.resizeCacheOffsetX=0,this.resizeCacheX=-1,this.resizeCacheMinLeft=0,this.moveCacheXRange=[-1,-1],this.moveCacheLeft=0,this.moveCacheWidth=0,this.moveCacheToX=-1,this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(){e._scale()})}},{key:"_scale",value:function(){this.resizeHandle.style.height=this.stage.configData.colHeadHeight+"px",this.resizeBar.style.height=this.stage.height+"px",this.moveLine.style.height=this.stage.height+"px",this.moveLine.style.top=this.stage.configData.colHeadHeight+"px"}},{key:"showMoveCol",value:function(e){if(!this.stage.configData.permissions)return!1;var t=this.stage.areaData,i=this.stage.selectData,n=this.stage.configData,a=i.select.xRange,o=a[0],s=a[1],r=Math.max(e.y,n.colHeadHeight),l=t.col.getViewportLeft(o),h=t.col.getViewportLeft(s+1)-l;this.moveCover.style.display="block",this.moveCover.style.left=l+"px",this.moveCover.style.width=h+"px",this.moveCover.style.height=n.colHeadHeight+"px",l=Math.max(e.x-50,n.rowHeadWidth),this.moveBar.style.top=r+"px",this.moveBar.style.left=l+"px";var g=a[1]-a[0]+1;return this.moveLabel.innerText="\u62d6\u52a8 "+Math.max(g,1)+" \u5217",this.moveCacheXRange[0]=o,this.moveCacheXRange[1]=s,this.moveCacheLeft=e.x-l,this.moveCacheWidth=h,this.moveBar.style.display="block",this.moveLine.style.display="block",this._showMoveLine(o),this.stage.tableData.tableColMoving=!0,!0}},{key:"_moveEnd",value:function(){this.moveBar.style.display="none",this.moveLine.style.display="none",this.moveCover.style.display="none",this.stage.tableData.tableColMoving=!1,this._moveCol(),this.moveCacheXRange[0]=-1,this.moveCacheXRange[1]=-1,this.moveCacheLeft=0,this.moveCacheWidth=0,this.moveCacheToX=-1}},{key:"_showResizeHandle",value:function(){}},{key:"_hideResizeHandle",value:function(){return-1!==this.resizeCacheX&&(this.resizeHandle.style.display="none",this.resizeCacheX=-1,!0)}},{key:"_showResizeBar",value:function(){this.resizeBar.style.display="block"}},{key:"_hideResizeBar",value:function(){this.resizeBar.style.display="none"}},{key:"_getColumnWidths",value:function(e){for(var t=this.stage.tableData,i=t.row.length-1,n=0,a=0,o=0;o<=i;o++){var r=t.getCellDataAtPosition(o,e,s.GET_CELLDATA.DEFAULT);r&&r.merge&&r.mergeData&&r.mergeData.xRange&&r.mergeData.xRange[0]!==r.mergeData.xRange[1]||(n=Math.max(n,r.getMaxTextWidth()),a=Math.max(n,0===n?this.stage.configData.colWidth:n))}return{maxTextWidth:Math.ceil(n),maxAutoFitWidth:Math.ceil(a)}}},{key:"_setColumnsAutoFit",value:function(){var e=this,t=this.stage.selectData.select,i=this.resizeCacheX,n=t.xRange,a=void 0,s="";(t.selectCol||t.selectAll)&&(0,o.isInRange)(i,n)?(a=n,s="clk_auto_ncol_size"):(a=[i,i],s="clk_auto_1col_size"),this._autoFitColWidths(a,function(t){e.stage.hookFunc.setColWidth&&e.stage.hookFunc.setColWidth(a,t)}),r.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:s})}},{key:"_autoFitColWidths",value:function(e,t){for(var i=[],n=[],a=e[0];a<=e[1];a++){var o=this._getColumnWidths(a);i.push(o.maxTextWidth),n.push(o.maxAutoFitWidth)}0!==i.reduce(function(e,t){return e+t})&&t&&t(n)}},{key:"_setColumnsWidthSameWidth",value:function(e){var t=this.stage.selectData,i=t.select.xRange,n=void 0;if(e<0&&(e=0),!((n=(t.select.selectCol||t.select.selectAll)&&(0,o.isInRange)(this.resizeCacheX,i)?i:[this.resizeCacheX,this.resizeCacheX])[0]<0||n[1]<0)){this.stage.hookFunc.setColWidth&&this.stage.hookFunc.setColWidth(n,e);var a=n[0]===n[1]?"drag_1col_size":"drag_n1col_size";r.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:a})}}},{key:"_moveCol",value:function(){this.moveCacheToX>=this.moveCacheXRange[0]&&this.moveCacheToX<=this.moveCacheXRange[1]||(console.log("moveCol: ",this.moveCacheXRange,this.moveCacheToX),this.stage.hookFunc.moveCol&&this.stage.hookFunc.moveCol(this.moveCacheXRange,this.moveCacheToX))}}]),e}();t.default=h},1170:function(e,t,i){var n=i(1171);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1171:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".col-board {\n    position: absolute;\n    z-index: 102;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n.resizer-vertical-handle {\n    cursor: e-resize;\n    background: #4d90fe;\n    border-style: none;\n    width: 5px;\n    height: 100%;\n    position: relative;\n    display: none;\n    -webkit-user-drag: none;\n    z-index: 103;\n}\n\n.resizer-vertical-handle-bar {\n    position: absolute;\n    width: 1px;\n    background-color: #4d90fe;\n    left: 2px;\n    border: 0;\n    padding: 0;\n    overflow: hidden;\n    display: none;\n}\n\n.resizer-vertical-ruler {\n    position: absolute;\n    background-color: #fff;\n    top: -30px; /* 26\u81ea\u8eab\u9ad8\u5ea6 + 4\u95f4\u8ddd  */\n    border: 1px solid rgba(0, 0, 0, 0.08);\n    box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.08);\n    border-radius: 1px;\n    font-size: 12px;\n    padding: 3px 10px 4px 10px;\n    color: rgba(0, 0, 0, 0.88);\n    white-space: nowrap;\n    display: none;\n}\n\n.move-vertical-header {\n    /* cursor: pointer; */\n    cursor: default;\n    position: absolute;\n    display: none;\n}\n\n.move-vertical-bar {\n    display: none;\n    position: absolute;\n    width: 100px;\n    height: 200px;\n    border-radius: 2px;\n    border: solid 1px rgba(0, 0, 0, 0.08);\n    background-color: rgba(255, 255, 255, 0.96);\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12);\n    cursor: -webkit-grab;\n    cursor: grab;\n}\n\n.move-vertical-bar::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: rgba(1, 136, 251, 0.08);\n}\n\n.move-vertical-bar::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100px;\n    height: 22px;\n    background-color: #e6e6e6;\n}\n.move-vertical-bar-label {\n    width: 100%;\n    height: 200px;\n    font-family: 'PingFang SC', 'Microsoft YaHei', '\u9ed1\u4f53', '\u5b8b\u4f53', sans-serif;\n    font-size: 12px;\n    font-weight: normal;\n    font-style: normal;\n    font-stretch: normal;\n    line-height: 200px;\n    letter-spacing: 0.3px;\n    text-align: center;\n    color: rgba(0, 0, 0, 0.4);\n}\n\n.move-vertical-line {\n    display: none;\n    position: absolute;\n    width: 4px;\n    background-color: #0188fb;\n    cursor: -webkit-grab;\n    cursor: grab;\n}\n.move-vertical-line::before {\n    content: '';\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background-color: #0188fb;\n    -webkit-transform: translateX(-25%) translateY(-100%);\n            transform: translateX(-25%) translateY(-100%);\n}\n\n.move-vertical-cover {\n    display: none;\n    position: absolute;\n    background-color: rgba(255, 255, 255, 0.4);\n    top: 0px;\n}\n",""])},1172:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(i(3)),a=v(i(0)),o=v(i(1)),s=v(i(4)),r=v(i(5)),l=v(i(1173)),h=v(i(1174)),g=i(21),c=v(i(202)),d=i(10),u=v(i(12)),f=v(i(8));function v(e){return e&&e.__esModule?e:{default:e}}var A=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.selectArea=function(e){var t,n=i.stage.selectData,a=i.stage.areaData.row.getIndex(i.stage.mouseData.currY),o=n.select,s=[o.xRange[0],o.xRange[1]],r=[],l=i.stage.areaData.row;t=a-i.cacheSelectIndex;var h=o.yRange[0];t>0?(r[0]=i.cacheSelectIndex,r[1]=i.cacheSelectIndex+t):0===t?(r[0]=i.cacheSelectIndex,r[1]=i.cacheSelectIndex):(r[0]=a,r[1]=a-t),l.frozen.length>0&&a<=l.frozen.to&&a>=l.frozen.from&&h>l.frozen.to+1&&(r[0]=l.flow.from),i.stage.tableData.selectionChanged=!0,n.change({select:{xRange:s,yRange:r,selectRow:!0},type:d.SELECT_SHOW_TYPE.SELECT})},i.hoverHideIcon=!1,i.hoverHideIndex=-1,i.backgroundBoard=new h.default({stage:i.stage,container:i.stage.container,parent:i}),i._shortPressTimer=null,i._longPressTimer=null,i._shortPressFlag=!1,i._longPressFlag=!1,i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"onmousedown",value:function(e){var t=this.stage.areaData.row.getIndex(e.y),i=this.stage.selectData;e.xIndex=0,e.yIndex=t,(0,g.isInRange)(t,i.select.yRange)&&2===e.button&&i.select.selectRow||(this.hoverHideIcon?this._showRowHide(e):((0,g.isInRange)(t,i.select.yRange)&&i.select.selectRow?this.longPressDetectHandler(e):this.shortPressHandler(e),this.stage.inputCenter.board.hasFocus()||this.stage.inputCenter.board.focus()))}},{key:"longPressDetectHandler",value:function(e){var t=this;this.stage.event.eventMouse.one("mousedrag",function(i){Math.abs(e.x-i.x)<=10&&Math.abs(e.y-i.y)<=10||(t._failLongPress(),u.default.erase(t._shortPressTimer),t.shortPressHandler(e))}),this._longPressTimer=u.default.wait(d.LONG_PRESS_THRESHOLD).run(function(){if(t.stage.configData.permissions){u.default.erase(t._shortPressTimer),t._longPressFlag=!0,t._shortPressFlag=!1,console.log("----\u5f00\u59cb\u957f\u6309\u62d6\u52a8"),t._addDragStartWithLongPress(),t.stage.event.eventDimension.trigger("dragRowColStart"),t.stage.rowHeader.backgroundBoard.showMoveRow(e);var i=t.stage.selectData.select.yRange,n=i[1]-i[0]>0?"move_more_row":"move_one_row";f.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:n})}}),this._shortPressTimer=u.default.wait(d.LONG_PRESS_THRESHOLD).run(function(){t.shortPressHandler(e)})}},{key:"shortPressHandler",value:function(e){if(!this._longPressFlag){this._shortPressFlag=!0,this._longPressFlag=!1;var t=this.stage.selectData;if(this.stage.areaData.switchArea(e),t.resetSelect(),c.default.key.shift)return this.selectArea(e),void this._addDragStartWithShortPress();this.cacheSelectIndex=e.yIndex,t.change({select:{xRange:[0,this.stage.tableData.col.length-1],yRange:[e.yIndex,e.yIndex],selectRow:!0},active:this.getActivationWhenSelectRow({xIndex:e.xIndex,yIndex:e.yIndex}),type:d.SELECT_SHOW_TYPE.SELECT}),this._addDragStartWithShortPress(),this.stage.event.eventMouse.trigger("mousedown",{x:-1,y:e.yIndex})}}},{key:"onclick",value:function(){this.stage.event.eventMouse.trigger("click",{x:this.stage.mouseData.lastCell.x,y:this.stage.mouseData.lastCell.y})}},{key:"onmousemove",value:function(e){this.stage.mouseData.down||(e.yIndex=this.stage.areaData.row.getIndex(e.y),this.backgroundBoard.checkResizeRow(e),this._checkHideTriangle(e),this.stage.event.eventMouse.trigger("mousemove",{lastCell:this.stage.mouseData.lastCell,newCell:{x:-1,y:e.yIndex}}),this.stage.mouseData.lastCell.x=-1,this.stage.mouseData.lastCell.y=e.yIndex)}},{key:"onmouseup",value:function(){this._failLongPress(),this.stage.hookFunc.tableRowColHeaderMouseup&&this.stage.hookFunc.tableRowColHeaderMouseup("row")}},{key:"_failLongPress",value:function(){this._longPressTimer&&(u.default.erase(this._longPressTimer),this._longPressFlag=!1,this._shortPressFlag=!0)}},{key:"_addDragStartWithShortPress",value:function(){var e=this;this._shortPressFlag&&(this.stage.event.eventTable.listen("tableMove",this.selectArea),this.stage.event.eventMouse.one("mousedrag",function(t){e.selectArea(t),t.x=null,e.stage.judgeAutoMove(t)}),this.stage.event.eventMouse.one("mousedragEnd",function(t){e.stage.event.eventTable.remove("tableMove",e.selectArea),e.stage.stopAutoMove()}),this.stage.event.eventTable.trigger("enterActiveStatus"))}},{key:"_addDragStartWithLongPress",value:function(){var e=this;this._longPressFlag&&(this.stage.event.eventMouse.one("mousedrag",function(e){console.log("----\u957f\u6309\u62d6\u52a8\u4e2d...")}),this.stage.event.eventMouse.one("mousedragEnd",function(t){console.log("----\u7ed3\u675f\u957f\u6309\u62d6\u52a8"),e.stage.event.eventDimension.trigger("dragRowColEnd")}))}},{key:"_checkHideTriangle",value:function(e){if(this.stage.configData.permissions){var t=e.yIndex,i=void 0,n=this.hideRowInDir(t,-1),a=this.hideRowInDir(t,1);if(-1!==n||-1!==a){var o=this.stage.configData,s=o.hideTriangle[0],r=o.hideTriangle[1]+4,l=o.hideTriangle[2],h=!1;if(-1!==n&&(i=[2,this.stage.areaData.row.getViewportTop(t),s,l+r],(0,g.checkIsIn)(e,i)&&(this._renderHoverHideTriangle(t-1),h=!0)),h)return this.hoverHideIcon=!0,void(this.hoverHideIndex=n);-1!==a&&(i=[2,this.stage.areaData.row.getViewportTop(t)+this.stage.tableData.row.getHeight(t)-l-r,s,l+r],(0,g.checkIsIn)(e,i)&&(this._renderHoverHideTriangle(t+1),h=!0)),h?(this.hoverHideIcon=!0,this.hoverHideIndex=a):this.hoverHideIcon&&(this.hoverHideIcon=!1,this.hoverHideIndex=-1,this.stage.renderRowHeader())}else this.hoverHideIcon&&(this.hoverHideIcon=!1,this.hoverHideIndex=-1,this.stage.renderRowHeader())}}},{key:"_showRowHide",value:function(){var e=this.hoverHideIndex,t=0,i=[];if(0!==(t=this.stage.tableData.hideRowMap[e-1]?-1:this.stage.tableData.hideRowMap[e+1]?1:[e]))for(;this.stage.tableData.hideRowMap[e];)i.push(e),e+=t;console.log("hide row: ",i),this.stage.hookFunc.showRowHide&&this.stage.hookFunc.showRowHide(i)}}]),t}(l.default);t.default=A},1173:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(21),s=i(10);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.backgroundColor=t.backgroundColor,this.ctx=this.stage.ctx,this.viewHeight=this.stage.height-11,this.viewWidth=this.stage.configData.rowHeadWidth,this.cacheSelect={},this.defaultLine="#d8dade",this.initEvent(),this.init()}return(0,a.default)(e,[{key:"init",value:function(){this.aabb=[0,this.stage.configData.colHeadHeight,this.viewWidth,this.viewHeight-this.stage.configData.colHeadHeight]}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventSelection.listen("selectionShow",function(t){t&&t.selectChange&&(e._calcCacheSelect(),e.stage.renderRowHeader())}),this.stage.event.eventSelection.listen("selectionHide",function(){0===e.stage.tableData.inputStatus&&(e.cacheSelect={})}),this.stage.event.eventTable.listen("scale",function(){e._scale()}),this.stage.event.eventTable.listen("clearTable",function(){e._clear()})}},{key:"_scale",value:function(){this.viewWidth=this.stage.configData.rowHeadWidth,this.viewHeight=this.stage.height-11,this.aabb=[0,this.stage.configData.colHeadHeight,this.viewWidth,this.viewHeight-this.stage.configData.colHeadHeight]}},{key:"_calcCacheSelect",value:function(){var e=this;this.cacheSelect={};var t=this.stage.selectData.getSelectQueue(),i=void 0,n=void 0;t.forEach(function(t){var a=t.sheetIds;for(n=t.selectRow||t.selectAll?200:e.stage.hookFunc.isActiveSheetIdInSheetIds(a)?100:0,i=t.yRange[0];i<=t.yRange[1];i++)void 0===e.cacheSelect[i]?e.cacheSelect[i]=n:e.cacheSelect[i]=Math.max(e.cacheSelect[i],n)})}},{key:"hideFilterRow",value:function(e){var t=this;e.sort(function(e,t){return e>t?1:-1}),(0,o.arrayToRange)(e).forEach(function(e){for(var i=[],n=e[0];n<=e[1];n++)i.push(t.stage.tableData.row.getHeight(n,{ignoreScale:!0}));t.stage.event.eventFilter.trigger("hideFilterRow",{range:e,rowHeights:i})}),this.stage.renderNextTick()}},{key:"showFilterRow",value:function(e){var t=this;e.sort(function(e,t){return e>t?1:-1}),(0,o.arrayToRange)(e).forEach(function(e){t.stage.event.eventFilter.trigger("showFilterRow",{range:e})}),this.stage.renderNextTick()}},{key:"_clear",value:function(){}},{key:"hideRowInDir",value:function(e,t){for(var i=this.stage.tableData;;){if(e+=t,i.hideRowMap[e])return e;if(!i.filterHideRowMap[e])return-1}}},{key:"_renderHoverHideTriangle",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=t[1],a=t[2],o=void 0,s=void 0,r=void 0,l=this.stage.areaData.row,h=this.stage.tableData;for(this.ctx.lineWidth=2,this.ctx.strokeStyle="#d4d4d4",this.ctx.fillStyle="#ffffff",o=e+1;h.hideRowMap[o];)o++;for(o<h.row.length&&o>=(s=l.getArea(o)).from&&o<=s.to&&(r=l.getViewportTop(o))>=s.viewStart-2&&r<=s.viewStart+s.viewHeight+2&&(this.ctx.translate(-.5,-.5),this.ctx.clearRect(0,r,i+4,a+n+4),this.ctx.beginPath(),this.ctx.translate(.5,.5),this.ctx.rect(0,r,i+4,a+n+4),this.ctx.stroke(),this.ctx.fill(),this._renderHideTriangleBottom(r),this.ctx.closePath()),o=e-1;h.hideRowMap[o];)o--;o>=0&&o>=(s=l.getArea(o)).from&&o<=s.to&&(r=l.getViewportTop(o)+h.row.getHeight(o))>=s.viewStart-2&&r<=s.viewStart+s.viewHeight+2&&(this.ctx.translate(-.5,-.5),this.ctx.clearRect(0,r-a-n-4,i+4,a+n+4),this.ctx.beginPath(),this.ctx.translate(.5,.5),this.ctx.rect(0,r-a-n-4,i+4,a+n+4),this.ctx.stroke(),this.ctx.fill(),this._renderHideTriangleTop(r),this.ctx.closePath()),this.ctx.lineWidth=1}},{key:"_renderHideTriangleTop",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=t[1],a=t[2];this.ctx.translate(-.5,-.5),this.ctx.drawImage(this.stage.configData.hideTopIcon,2,e-a-n,i,n),this.ctx.translate(.5,.5)}},{key:"_renderHideTriangleBottom",value:function(e){var t=this.stage.configData.hideTriangle,i=t[0],n=t[1],a=t[2];this.ctx.translate(-.5,-.5),this.ctx.drawImage(this.stage.configData.hideBottomIcon,2,e+a,i,n),this.ctx.translate(.5,.5)}},{key:"getColorStatus",value:function(e){var t=0,i=this.stage.tableData;return i.filter.open&&(0,o.isInRange)(e,i.filter.range.yRange)&&(t=1),t+(this.cacheSelect[e]||0)}},{key:"_renderArea",value:function(e){var t,i=void 0,n=void 0,a=void 0,s=void 0,r=(this.stage.selectData,this.stage.areaData.row),l=r[e].maxDistance,h=r[e].viewHeight,g=this.stage.tableData.row,c=r[e].from,d=Math.min(r[e].to,g.heights.length-1),u=r.getViewportTop(c),f=void 0,v=this.stage.configData;for(a=u,this.ctx.clearRect(0,r[e].viewStart,this.viewWidth,h),this.backgroundColor&&(this.ctx.fillStyle=this.backgroundColor,this.ctx.fillRect(0,r[e].viewStart,this.viewWidth,h)),this.ctx.save(),t=this.defaultLine,s=c;s<=d;s++)if((0,o.isRowShow)(this.stage.tableData,s)){if(i=g.getHeight(s),a>l)break;this.hideRowInDir(s,-1)>-1&&this._renderHideTriangleBottom(a),a+=i,this.ctx.beginPath(),this.ctx.strokeStyle=t,this.ctx.moveTo(0,a),this.ctx.lineTo(this.viewWidth,a),this.ctx.stroke(),this.ctx.closePath(),this.hideRowInDir(s,1)>-1&&this._renderHideTriangleTop(a)}for(a=u-1,s=c;s<=d;s++)if((0,o.isRowShow)(this.stage.tableData,s)){if(i=g.getHeight(s),s===this.selectLastRowIndex&&!0===this.resizing&&(i=this.modifyRowheight),f=this.getColorStatus(s),n=v.tableHeaderColor[f],a>l)break;this.ctx.fillStyle="#777777",this.ctx.fillText(s+1,this.viewWidth/2,a+i/2),this.ctx.beginPath(),this.ctx.fillStyle=n,this.ctx.rect(0,a,this.viewWidth,i+1),this.ctx.fill(),this.ctx.closePath(),a+=i}this.ctx.restore(),this.stage.tableData.viewportY=a}},{key:"render",value:function(){this.ctx.globalCompositeOperation="destination-over";var e=this.stage.areaData.row;this.ctx.textBaseline="middle",this.ctx.textAlign="center",this.ctx.font=this.fontSize+'px "Microsoft YaHei", "sourcecode", sans-serif',e.frozen.length>0&&this._renderArea(s.TABLE_AREA.FROZEN),this._renderArea(s.TABLE_AREA.FLOW)}},{key:"getActivationWhenSelectRow",value:function(e){for(var t=e,i=t.xIndex,n=t.yIndex,a=this.stage.getColCount();i<a;){var o=this.stage.tableData.getCellDataAtPosition(n,i);if(!o||!o.merge&&!o.merged)break;var s=o.merge?o.mergeData:o.parent&&o.parent.mergeData;if(!s)break;if(s.yRange[0]===s.yRange[1])break;i=Math.max(s.xRange[0],s.xRange[1])+1}return{xIndex:i<a?i:t.xIndex,yIndex:n}}},{key:"fontSize",get:function(){return 10*this.stage.tableData.scale>>0},set:function(e){console.error("can't set fontSize")}}]),e}();t.default=l},1174:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(3)),a=c(i(0)),o=c(i(1)),s=c(i(4)),r=c(i(5)),l=c(i(59)),h=c(i(1175)),g=i(21);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i._moveMousemove=function(e){var t=i.stage.configData,n=e.clientY-t.distanceY-i.moveCacheTop,a=e.clientX-t.distanceX,o=e.clientY-t.distanceY;a=Math.max(a,t.rowHeadWidth),(n=Math.max(n,t.colHeadHeight))<80?i.stage.judgeAutoMove({y:n,autoMoveThreshold:20}):o>i.stage.height-120?i.stage.judgeAutoMove({y:o,autoMoveThreshold:20}):i.stage.stopAutoMove(),i._checkMoveTo(e),i.moveBar.style.left=a+"px",i.moveBar.style.top=n+"px"},i._moveMouseup=function(){i.stage.touchBoard.board.classList.remove("drag-rowcol"),i.stage.stopAutoMove(),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_moveEnd",i).call(i),document.removeEventListener("mousemove",i._moveMousemove),document.removeEventListener("mouseup",i._moveMouseup),document.removeEventListener("keydown",i._preventShortcutKeys,!0)},i._hideResizeHandle=function(){(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_hideResizeHandle",i).call(i),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_hideResizeBar",i).call(i),i.resizeRuler.style.display="none",i.resizeCacheY=-1},i._resizeMousemove=function(e){e.stopPropagation();var t=i.stage.configData,n=e.clientY-t.distanceY-i.moveCacheTop;(n=Math.max(n,t.colHeadHeight))<80?i.stage.judgeAutoMove({y:n,autoMoveThreshold:100,isOverMax:!0}):n>i.stage.height-120?i.stage.judgeAutoMove({y:n,autoMoveThreshold:100,isOverMax:!0}):i.stage.stopAutoMove(),i._updateResizeHandle(),i._updateResizeRulerPosition()},i._resizeMouseup=function(e){var t=i.stage.tableData,n=i.stage.mouseData.currY-i.resizeCacheOffsetY+(i.stage.areaData.row.flow._offsetY-i.resizeBeginViewOffsetY),a=void 0;i.parent.resizing=!1,i.stage.stopAutoMove(),0!==n&&(a=(t.row.getHeight(i.resizeCacheY)+n)/t.scale>>0,i._setRowsHeightWithSameHeight(a),i._hideResizeHandle()),document.removeEventListener("mousemove",i._resizeMousemove),document.removeEventListener("mouseup",i._resizeMouseup),document.removeEventListener("keydown",i._preventShortcutKeys,!0),i.resizeHandle.addEventListener("mouseleave",i._hideResizeHandle)},i._preventShortcutKeys=function(e){e.preventDefault(),e.stopPropagation()},i.stage.configData.permissions&&i.initMouse(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1176)}},{key:"init",value:function(){var e=document.createElement("div");e.className="row-board",this.board=e,e.style.top=0,e.style.left=0;var t=document.createElement("div");t.className="resizer-horizontal-handle",this.resizeHandle=t,t.style.width=this.stage.configData.rowHeadWidth+"px";var i=document.createElement("div");i.className="resizer-horizontal-handle-bar",this.resizeBar=i,i.style.width=this.stage.width+"px",t.appendChild(i),e.appendChild(t);var n=document.createElement("div");n.className="resizer-horizontal-ruler",this.resizeRuler=n,t.appendChild(n);var a=document.createElement("div");a.className="move-horizontal-cover",this.moveCover=a;var o=document.createElement("div");o.className="move-horizontal-line",o.style.width=this.stage.width+"px",o.style.left=this.stage.configData.rowHeadWidth+"px",this.moveLine=o;var s=document.createElement("div"),r=document.createElement("div");s.className="move-horizontal-bar",r.className="move-horizontal-bar-label",s.appendChild(r),this.moveBar=s,this.moveLabel=r,e.appendChild(a),e.appendChild(o),e.appendChild(s),this.container.appendChild(e)}},{key:"initMouse",value:function(){var e=this;this.resizeHandle.addEventListener("mouseleave",this._hideResizeHandle),this.resizeHandle.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),e.resizeCacheOffsetY=e.stage.mouseData.currY,e.resizeBeginViewOffsetY=e.stage.areaData.row.flow._offsetY,e._showResizeBarRuler(),e.parent.resizing=!0,document.addEventListener("mousemove",e._resizeMousemove),document.addEventListener("mouseup",e._resizeMouseup),document.addEventListener("keydown",e._preventShortcutKeys,!0),e.resizeHandle.removeEventListener("mouseleave",e._hideResizeHandle)}),this.resizeHandle.addEventListener("dblclick",function(t){e._setRowAutoFit()}),this.resizeHandle.addEventListener("contextmenu",function(t){e._hideResizeHandle(),e.stage.handleEvent("mousedown",{x:e.stage.mouseData.startX,y:e.stage.mouseData.startY,button:t.button})})}},{key:"showMoveRow",value:function(e){this.stage.touchBoard.board.classList.add("drag-rowcol"),(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"showMoveRow",this).call(this,e)&&(document.addEventListener("mousemove",this._moveMousemove),document.addEventListener("mouseup",this._moveMouseup),document.addEventListener("keydown",this._preventShortcutKeys,!0))}},{key:"checkResizeRow",value:function(e){if(this.stage.configData.permissions){var t=e.y,i=0,n=this.stage.areaData.row,a=this.stage.tableData;if(n.frozen.length>0)for(;i<=n.frozen.to;i++)if(Math.abs(t-n.getViewportTop(i)-a.row.getHeight(i,{ignoreHide:!1}))<3)return void this._showResizeHandle(i);for(i=Math.max(0,n.flow.from);i<=n.flow.to;i++)if((0,g.isRowShow)(a,i)&&Math.abs(t-n.getViewportTop(i)-a.row.getHeight(i,{ignoreHide:!1}))<3)return void this._showResizeHandle(i);this._hideResizeHandle()}}},{key:"_showResizeHandle",value:function(e){var t=this.stage.tableData,i=this.stage.configData,n=this.stage.areaData.row.getViewportTop(e),a=t.row.getHeight(e,{ignoreHide:!1});this.resizeCacheY=e,this.resizeCacheMinTop=i.colHeadHeight,this.resizeHandle.style.top=n+a-2+"px",this.resizeHandle.style.display="block",this._updateResizeRulerPosition()}},{key:"_updateResizeHandle",value:function(){var e=this.stage.mouseData.currY;e<this.resizeCacheMinTop?e=this.resizeCacheMinTop:e>this.stage.height&&(e=this.stage.height),this.resizeHandle.style.top=e+"px"}},{key:"_showResizeBarRuler",value:function(){(0,l.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_showResizeBar",this).call(this),this.resizeRuler.style.display="block",this._updateResizeRulerPosition()}},{key:"_updateResizeRulerPosition",value:function(){var e=this.stage.mouseData.currY;e<this.resizeCacheMinTop?e=this.resizeCacheMinTop:e>this.stage.height&&(e=this.stage.height);var t=parseInt(e-this.stage.areaData.row.getViewportTop(this.resizeCacheY));t=Math.max(t,0),this.resizeRuler.innerText="\u9ad8\u5ea6\uff1a"+t+"\u50cf\u7d20"}},{key:"_checkMoveTo",value:function(e){var t=this.stage.areaData.row.getIndex(e.clientY-this.stage.configData.distanceY),i=this.stage.tableData.row.getHeight(t,{ignoreHide:!1}),n=this.stage.areaData.row.getViewportTop(t),a=e.clientY-this.stage.configData.distanceY-n;t<this.moveCacheYRange[0]&&a>i/2&&(t+=1),t>this.moveCacheYRange[1]&&a>i/2&&(t+=1),t>=this.moveCacheYRange[0]&&t<=this.moveCacheYRange[1]&&(t=this.moveCacheYRange[0]),this._showMoveLine(t)}},{key:"_showMoveLine",value:function(e){var t=this.stage.areaData.row.getViewportTop(e);this.moveCacheToY=e,t=Math.max(t,this.stage.configData.colHeadHeight),this.moveLine.style.top=t+"px"}}]),t}(h.default);t.default=d},1175:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(21),s=r(i(8));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.parent=t.parent,this.stage=t.stage,this.container=t.container,this.resizeCacheOffsetY=0,this.resizeCacheY=-1,this.resizeCacheMinTop=0,this.moveCacheYRange=[-1,-1],this.moveCacheTop=0,this.moveCacheHeight=0,this.moveCacheToY=-1,this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(){e._scale()})}},{key:"_scale",value:function(){this.resizeHandle.style.width=this.stage.configData.rowHeadWidth+"px",this.resizeBar.style.width=this.stage.width+"px",this.moveLine.style.width=this.stage.width+"px",this.moveLine.style.left=this.stage.configData.rowHeadWidth+"px"}},{key:"showMoveRow",value:function(e){if(!this.stage.configData.permissions)return!1;var t=this.stage.areaData,i=this.stage.configData,n=this.stage.selectData.select.yRange,a=n[0],o=n[1],s=Math.max(e.x,i.rowHeadWidth),r=t.row.getViewportTop(a),l=t.row.getViewportTop(o+1)-r;this.moveCover.style.display="block",this.moveCover.style.top=r+"px",this.moveCover.style.height=l+"px",this.moveCover.style.width=i.rowHeadWidth+"px",r=Math.max(e.y-17,i.colHeadHeight),this.moveBar.style.left=s+"px",this.moveBar.style.top=r+"px";var h=n[1]-n[0]+1;return this.moveLabel.innerText="\u62d6\u52a8 "+Math.max(h,1)+" \u884c",this.moveCacheYRange[0]=a,this.moveCacheYRange[1]=o,this.moveCacheTop=e.y-r,this.moveCacheHeight=l,this.moveBar.style.display="block",this.moveLine.style.display="block",this._showMoveLine(a),this.stage.tableData.tableRowMoving=!0,!0}},{key:"_moveEnd",value:function(){this.moveBar.style.display="none",this.moveLine.style.display="none",this.moveCover.style.display="none",this.stage.tableData.tableRowMoving=!1,this._moveRow(),this.moveCacheYRange[0]=-1,this.moveCacheYRange[1]=-1,this.moveCacheTop=0,this.moveCacheHeight=0,this.moveCacheToY=-1}},{key:"_showResizeHandle",value:function(){}},{key:"_hideResizeHandle",value:function(){return-1!==this.resizeCacheY&&(this.resizeHandle.style.display="none",this.resizeBar.style.display="none",this.resizeCacheY=-1,!0)}},{key:"_showResizeBar",value:function(){this.resizeBar.style.display="block"}},{key:"_hideResizeBar",value:function(){this.resizeBar.style.display="none"}},{key:"_setRowAutoFit",value:function(){var e=this.stage.selectData.select,t=e.yRange,i=this.resizeCacheY,n="";(e.selectRow||e.selectAll)&&(0,o.isInRange)(i,t)?(this._autoFitRowHeights(t),n="clk_auto_nrow_size"):(this._autoFitRowHeights([i,i]),n="clk_auto_1row_size"),s.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:n})}},{key:"_autoFitRowHeights",value:function(e){for(var t=e[0];t<=e[1];t++)this.stage.addAdjustLine(t);this.stage.hookFunc.setRowHeight&&this.stage.hookFunc.setRowHeight(e,void 0),this._hideResizeHandle()}},{key:"_setRowsHeightWithSameHeight",value:function(e){var t=this.stage.selectData,i=t.select.yRange,n=void 0;if(e<0&&(e=0),!((n=(t.select.selectRow||t.select.selectAll)&&(0,o.isInRange)(this.resizeCacheY,i)?i:[this.resizeCacheY,this.resizeCacheY])[0]<0||n[1]<0)){this.stage.hookFunc.setRowHeight&&this.stage.hookFunc.setRowHeight(n,e);var a=n[0]===n[1]?"drag_1row_size":"drag_n1row_size";s.default.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:a})}}},{key:"_moveRow",value:function(){this.moveCacheToY>=this.moveCacheYRange[0]&&this.moveCacheToY<=this.moveCacheYRange[1]||(console.log("moveRow: ",this.moveCacheYRange,this.moveCacheToY),this.stage.hookFunc.moveRow&&this.stage.hookFunc.moveRow(this.moveCacheYRange,this.moveCacheToY))}}]),e}();t.default=l},1176:function(e,t,i){var n=i(1177);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1177:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".row-board {\n    position: absolute;\n    z-index: 102;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n.resizer-horizontal-handle {\n    cursor: n-resize;\n    background: #4d90fe;\n    border-style: none;\n    height: 5px;\n    width: 100%;\n    position: relative;\n    display: none;\n    z-index: 103;\n}\n\n.resizer-horizontal-handle-bar {\n    position: absolute;\n    height: 1px;\n    background-color: #4d90fe;\n    top: 2px;\n    border: 0;\n    padding: 0;\n    overflow: hidden;\n    display: none;\n}\n\n.resizer-horizontal-ruler {\n    position: absolute;\n    background-color: #fff;\n    left: 5px;\n    top: -32px; /*26\u81ea\u8eab\u9ad8\u5ea6 + 4px\u95f4\u8ddd + 2border */\n    border: 1px solid rgba(0, 0, 0, 0.08);\n    box-shadow: 0 2px 10px 0 rgba(0, 0, 0, 0.08);\n    border-radius: 1px;\n    font-size: 12px;\n    padding: 3px 10px 4px 10px;\n    white-space: nowrap;\n    display: none;\n}\n\n.move-horizontal-header {\n    /* cursor: pointer; */\n    cursor: default;\n    position: absolute;\n    display: none;\n}\n\n.move-horizontal-bar {\n    display: none;\n    position: absolute;\n    width: 280px;\n    height: 34px;\n    border-radius: 2px;\n    border: solid 1px rgba(0, 0, 0, 0.08);\n    background-color: rgba(255, 255, 255, 0.96);\n    box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12);\n    cursor: -webkit-grab;\n    cursor: grab;\n}\n.move-horizontal-bar::before {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    background-color: rgba(1, 136, 251, 0.08);\n}\n\n.move-horizontal-bar::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 29px;\n    height: 34px;\n    background-color: #e6e6e6;\n}\n.move-horizontal-bar-label {\n    width: 100%;\n    height: 34px;\n    font-family: 'PingFang SC', 'Microsoft YaHei', '\u9ed1\u4f53', '\u5b8b\u4f53', sans-serif;\n    font-size: 12px;\n    font-weight: normal;\n    font-style: normal;\n    font-stretch: normal;\n    line-height: 34px;\n    letter-spacing: 0.3px;\n    text-align: center;\n    color: rgba(0, 0, 0, 0.4);\n}\n\n.move-horizontal-line {\n    display: none;\n    position: absolute;\n    height: 4px;\n    background-color: #0188fb;\n    cursor: -webkit-grab;\n    cursor: grab;\n}\n.move-horizontal-line::before {\n    content: '';\n    position: absolute;\n    width: 8px;\n    height: 8px;\n    background-color: #0188fb;\n    -webkit-transform: translateX(-100%) translateY(-25%);\n            transform: translateX(-100%) translateY(-25%);\n}\n\n.move-horizontal-cover {\n    display: none;\n    position: absolute;\n    background-color: rgba(255, 255, 255, 0.4);\n    left: 0px;\n}\n",""])},1178:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(3)),a=f(i(0)),o=f(i(1)),s=f(i(4)),r=f(i(5)),l=f(i(1179)),h=i(21),g=i(284),c=f(i(1183)),d=f(i(202)),u=i(10);f(i(12));function f(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.selectArea=function(e){var t,n,a,o,s=i.stage.selectData,r=i.stage.areaData,l=s.active.xIndex,h=s.active.yIndex,c=r.col.getIndex(i.stage.mouseData.currX),d=r.row.getIndex(i.stage.mouseData.currY),f={};c<0&&(c=r.col.frozen.length>0?r.col.frozen.from:r.col.flow.from),d<0&&(d=r.row.frozen.length>0?r.row.frozen.from:r.row.flow.from),c<0||d<0||(a=Math.max(c,l),o=Math.max(d,h),t=Math.min(l,c),n=Math.min(h,d),f.xRange=[t,a],f.yRange=[n,o],(0,g.aroundEdges)(i.stage.tableData,f),i.stage.tableData.selectionChanged=!0,s.change({select:f,type:u.SELECT_SHOW_TYPE.SELECT}))},i.stage.configData.permissions&&new c.default({stage:i.stage,container:e.container}),i.canDrag={row:!1,col:!1},i.mouseMoveTimer=null,i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"notNeedHandle",value:function(){if(this.stage.configData.record_preview){if(!window.isRecordPreviewShowing)return!0}else if(window.isRecordPreviewShowing)return!0;return!1}},{key:"onmousedown",value:function(e){if(!this.notNeedHandle()&&!this.stage.inputCenter.checkInputInitValueChange()){var t=this.stage.areaData.col.getIndex(e.x),i=this.stage.areaData.row.getIndex(e.y),n=this.stage.selectData;if(!(t<0||i<0)){this.stage.areaData.switchArea(e),n.resetSelect();var a=(this.stage.tableData.getCellDataAtPosition(i,t)||{}).text;this.stage.inputCenter.board.setAriaInfo&&this.stage.inputCenter.board.setAriaInfo(t,i,a);var o=!1;if(0!==this.stage.tableData.inputStatus){var s=this.stage.inputCenter.board.getCurrentText(),r=this.stage.inputCenter.board.getCurrentRange(),l=r?r.start:s.length;o=this._isSelectArea(s,l)}if(d.default.key.shift||o)return this.selectArea(e),void this._addDrag();var g=this.stage.tableData.getCellDataAtPosition(i,t,u.GET_CELLDATA.DEFAULT),c=void 0;g.merged||g.merge?(g=g.parent,t=(c=this._getMergeCoord(g)).xIndex,i=c.yIndex):c={xRange:[t,t],yRange:[i,i]},this.addSheetIds(c),n.selectStatus===u.SELECT_STATUS.FORMULA&&0===(0,h.getCursorPosition)()&&n.setSelectStatus(u.SELECT_STATUS.NORMAL),n.change({active:{xIndex:t,yIndex:i},select:c,type:u.SELECT_SHOW_TYPE.SELECT}),this.stage.inputCenter.board.hasFocus()||this.stage.inputCenter.board.focus(),this._addDrag(),this.stage.event.eventMouse.trigger("mousedown",{x:t,y:i})}}}},{key:"addSheetIds",value:function(e){var t=this.stage.inputCenter.board.crossSheetFormulaEditorCache,i=this.stage.hookFunc.getActiveSheetName();if(this.stage.inputCenter.board.isInCrossSheetFormulaEditingMode()&&t.originSheetName!==i)e.sheetIds=[t.startSheetId,t.endSheetId];else{var n=this.stage.hookFunc.getActiveSheetId();e.sheetIds=[n,n]}}},{key:"onclick",value:function(){this.stage.event.eventMouse.trigger("click",{x:this.stage.mouseData.lastCell.x,y:this.stage.mouseData.lastCell.y})}},{key:"_isSelectArea",value:function(e,t){var i=e.slice(0,t),n=!1;return/=.*?(([a-zA-Z]{1,3}[0-9]{1,3}:)([a-zA-Z]{0,3}[0-9]{0,3}:?)*)$/gi.exec(i)&&(n=!0),n}},{key:"_addDrag",value:function(){var e=this;this.notNeedHandle()||(this.stage.event.eventTable.listen("tableMove",this.selectArea),this.stage.event.eventMouse.one("mousedrag",function(t){e.selectArea(t),e.stage.judgeAutoMove(t)}),this.stage.event.eventMouse.one("mousedragEnd",function(){e.stage.event.eventTable.remove("tableMove",e.selectArea),e.stage.stopAutoMove()}))}},{key:"onmousemove",value:function(e){if(!this.stage.mouseData.down&&!this.notNeedHandle()){this.stage.mouseData.lastCell.x<0&&this.stage.rowHeader.backgroundBoard._hideResizeHandle(e),this.stage.mouseData.lastCell.y<0&&this.stage.colHeader.backgroundBoard._hideResizeHandle(e);var t=this.stage.areaData.col.getIndex(e.x),i=this.stage.areaData.row.getIndex(e.y),n=this.stage.tableData.getCellDataAtPosition(this.stage.mouseData.lastCell.y,this.stage.mouseData.lastCell.x,u.GET_CELLDATA.DEFAULT);if(t<0||i<0)console.error("mousemove x/y result error");else{var a=this.stage.tableData.getCellDataAtPosition(i,t,u.GET_CELLDATA.DEFAULT);a.merged&&(t=(a=a.parent).parent.mergeData.xRange[0],i=a.parent.mergeData.yRange[0]),n&&n!==a&&n.formulaError&&this.stage.formulaCenter.hideCard({delay:200}),this.stage.configData.permissions||(a.link?this.stage.container.classList.add("link-cell"):n.link&&this.stage.container.classList.remove("link-cell")),this.stage.configData.record_preview&&this._checkRecordHover(t,i),this.stage.event.eventMouse.trigger("mousemove",{lastCell:this.stage.mouseData.lastCell,newCell:{x:t,y:i}}),this.stage.mouseData.lastCell.x=t,this.stage.mouseData.lastCell.y=i}}}},{key:"_checkRecordHover",value:function(e,t){var i=!1;this.stage.mouseData.lastCell.x===e&&this.stage.mouseData.lastCell.y===t||(i=!0);var n=this.stage.tableData.getCellDataAtPosition(t,e,u.GET_CELLDATA.DEFAULT);if(!n.recordAuthor||!i&&window.recordHoverTipShow){if(!n.recordAuthor&&window.recordHoverTipShow){this.stage.event.eventRecord.trigger("recordviewCellHover",{hover:!1})}}else{var a=this.getRealPosition(e,t),o={cell:n,cellRange:{x:a.posX[0],y:a.posY[0],w:a.posX[1]-a.posX[0],h:a.posY[1]-a.posY[0]},currX:this.stage.mouseData.currX,author:n.recordAuthor,hover:!0};this.stage.event.eventRecord.trigger("recordviewCellHover",o)}}},{key:"ondblclick",value:function(){var e=this.stage.areaData.row.getViewportTop(this.stage.tableData.row.length),t=this.stage.areaData.col.getViewportLeft(this.stage.tableData.col.length);this.stage.mouseData.currX<0||this.stage.mouseData.currX>t||this.stage.mouseData.currY<0||this.stage.mouseData.currY>e||this.notNeedHandle()||(this.stage.tableData.inputStatus=2,this.stage.event.eventInput.trigger("inputShow"))}},{key:"extendContent",value:function(e){var t=this.stage.selectData,i=t.select.xRange[1],n=t.select.yRange[1],a=this.stage.areaData.col.getIndex(e.x),o=this.stage.areaData.row.getIndex(e.y),s=Math.abs(a-i);Math.abs(o-n)<s?o=n:a=i,-1===o&&(o=0),this.stage.event.eventSmart.trigger("smartSelectionShow",{x:a,y:o})}}]),t}(l.default);t.default=v},1179:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(24)),a=c(i(0)),o=c(i(1)),s=i(21),r=c(i(1180)),l=c(i(1181)),h=c(i(1182)),g=i(10);c(i(12));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,a.default)(this,e),this.col=t.col,this.row=t.row,this.stage=t.stage,this.ctx=this.stage.ctx,this.renderAreaX="",this.renderAreaY="",this.startX=null,this.startY=null,this.name="TableBody",this.borderCenter=new r.default({stage:this.stage}),this.mergeCenter=new l.default({stage:this.stage,body:this}),this.copyFrame=new h.default({stage:this.stage}),this.firstRenderRange=null,this.enableRenderShard=!0,this.lastLoopId=-1,this.initEvent(),this.init()}return(0,o.default)(e,[{key:"init",value:function(){this.startX=this.stage.configData.rowHeadWidth,this.startY=this.stage.configData.colHeadHeight,this.aabb=[this.startX,this.startY,this.stage.width,this.stage.height]}},{key:"stopLastInitAllLoop",value:function(){clearTimeout(this.lastLoopId)}},{key:"initFirstScreenData",value:function(){this.stage.areaData.calcIndex(),this.stage.areaData.row.frozen.length>0&&this.initByRange(this.stage.areaData.row.frozen.from,this.stage.areaData.row.frozen.to,0,this.stage.tableData.col.length-1),this.initByRange(this.stage.areaData.row.flow.from,this.stage.areaData.row.flow.to,0,this.stage.tableData.col.length-1),this.firstRenderRange={start:this.stage.areaData.row.flow.from,end:this.stage.areaData.row.flow.to}}},{key:"initAll",value:function(e,t,i){var n=this;this.lastLoopId=setTimeout(function(){if(n.enableRenderShard){var a=void 0,o=void 0;if(t||(t=1),1===t)a=(o=i||n.firstRenderRange.start-1)-100,n.initByRange(Math.max(0,a),o,0,n.stage.tableData.col.length-1),a<=0?n.initAll(e,2):n.initAll(e,1,a-1);else{var s=(a=i||n.firstRenderRange.end+1)+100;n.initByRange(a,Math.min(s,n.stage.tableData.row.length-1),0,n.stage.tableData.col.length-1),s>=n.stage.tableData.row.length?e():n.initAll(e,2,s+1)}}},1)}},{key:"initByRange",value:function(e,t,i,n){console.log("cacl range from ",e,i,"to",t,n);var a=void 0,o=void 0,s=void 0;for(a=e;a<=t;a++)for(o=i;o<=n;o++)this.borderCenter.regulateBorder(o,a),(s=this.stage.tableData.merge[o+"|"+a])&&this.mergeCenter.mergeCell({x:o,y:a,w:s.w,h:s.h},!0),this.stage.tableData.getCellDataAtPosition(a,o,g.GET_CELLDATA.NORMAL)&&this.handleMultiLine(o,a);this.stage.hookFunc.loopRender&&this.stage.hookFunc.loopRender({rowStart:e,rowEnd:t,colStart:i,colEnd:n})}},{key:"initProps",value:function(e){var t=void 0,i=void 0,n=void 0,a=this.stage.tableData.row.length,o=this.stage.tableData.col.length;for(t=0;t<a;t++)for(i=0;i<o;i++)this.borderCenter.regulateBorder(i,t),(n=e[i+"|"+t])&&this.mergeCenter.mergeCell({x:i,y:t,w:n.w,h:n.h},!0)}},{key:"initStyle",value:function(){}},{key:"handleMultiLine",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,g.GET_CELLDATA.NORMAL);i&&(i.text&&""!==i.text?(i.handleCellLines(e,t),i.calcTextAlign(e,t),i.calcVerticalAlign(e,t)):i.lines.length=0,this.calcHidden(e,t),this.stage.addAdjustLine(t))}},{key:"_scale",value:function(){this.startX=this.stage.configData.rowHeadWidth,this.startY=this.stage.configData.colHeadHeight,this.aabb=[this.startX,this.startY,this.stage.width,this.stage.height]}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(t){e._scale(t)}),this.stage.event.eventDimension.listen("setRowHeight",function(t){e._setRowHeight(t)}),this.stage.event.eventDimension.listen("setColWidth",function(t){e._setColWidth(t)}),this.stage.event.eventDimension.listen("addCol",function(t){e._addCol(t)}),this.stage.event.eventDimension.listen("addRow",function(t){e._addRow(t)}),this.stage.event.eventDimension.listen("hideCol",function(t){e._hideCol(t)}),this.stage.event.eventDimension.listen("hideRow",function(t){e._hideRow(t)}),this.stage.event.eventDimension.listen("showCol",function(t){e._showCol(t)}),this.stage.event.eventDimension.listen("showRow",function(t){e._showRow(t)}),this.stage.event.eventDimension.listen("removeCol",function(t){e._removeCol(t)}),this.stage.event.eventDimension.listen("removeRow",function(t){e._removeRow(t)}),this.stage.event.eventCell.listen("splitCell",function(t){e.mergeCenter.splitCell(t),e.handleMultiLine(e.stage.tableData.getCellDataAtPosition(t.y,t.x,g.GET_CELLDATA.FILL))}),this.stage.event.eventCell.listen("mergeCell",function(t){e.mergeCenter.mergeCell(t)}),this.stage.event.eventCell.listen("setCellsData",function(t){e._setCellsData(t)}),this.stage.event.eventCell.listen("setAreaData",function(t){e._setAreaData(t)}),this.stage.event.eventCell.listen("cleanCellStyles",function(t){e._cleanCellStyles(t)}),this.stage.event.eventTable.listen("makeCellVisiable",function(t){e._makeCellVisiable(t)}),this.stage.event.eventFilter.listen("doFilter",function(){e._doFilter()}),this.stage.event.eventFilter.listen("closeFilter",function(){e._closeFilter()}),this.stage.event.eventFilter.listen("hideFilterRow",function(t){e._hideRow(t)}),this.stage.event.eventFilter.listen("showFilterRow",function(t){e._showRow(t)}),this.stage.event.eventTable.listen("clearTable",function(){e._clear()})}},{key:"checkRowHeight",value:function(e){var t=this.stage.tableData,i=this.stage.configData.rowHeight,n=0,a=0;if(t.hideRowMap[e]?(n=t.hideRowMap[e].height,a=t.hideRowMap[e].setHeight):t.filterHideRowMap[e]?(n=t.filterHideRowMap[e].height,a=t.filterHideRowMap[e].setHeight):(n=t.row.heights[e],a=t.row.setHeights[e]),void 0===a||null===a){for(var o=0,r=t.col.length,l=0;l<r;l++)if((0,s.isColShow)(t,l)){var h=t.getCellDataAtPosition(e,l,g.GET_CELLDATA.DEFAULT);h.merge&&h.mergeData.yRange[0]!==h.mergeData.yRange[1]||h.merged||(o=Math.max(o,h.getTextHeight()))}void 0!==n&&null!==n||(n=i),(o=Math.max(o,i))!==n&&this.stage.event.eventDimension.trigger("setRowHeight",{index:e,newHeight:o,oldHeight:n})}}},{key:"getRealPosition",value:function(e,t){var i=void 0,n=void 0,a=void 0,o=this.stage.tableData.getCellDataAtPosition(t,e,g.GET_CELLDATA.DEFAULT);return o.merged||o.merge?i=this._getMergeCoord(o):(n=this.stage.areaData.col.getViewportLeft(e),a=this.stage.areaData.row.getViewportTop(t),i={posX:[n,n+this.stage.tableData.col.getWidth(e)],posY:[a,a+this.stage.tableData.row.getHeight(t)],xRange:[e,e],yRange:[t,t],xIndex:e,yIndex:t}),i}},{key:"getTheoryPosition",value:function(e,t){var i,n,a=this.stage.tableData.col.getWidth(e),o=this.stage.tableData.row.getHeight(t);return{posX:[i=this.stage.areaData.col.getViewportLeft(e),i+a],posY:[n=this.stage.areaData.row.getViewportTop(t),n+o]}}},{key:"_getMergeCoord",value:function(e){var t=e.parent.mergeData,i=[],n=[],a=this.stage.areaData.col.getViewportLeft(t.xRange[0]),o=this.stage.areaData.col.getViewportLeft(t.xRange[1])+this.stage.tableData.col.getWidth(t.xRange[1]),s=this.stage.areaData.row.getViewportTop(t.yRange[0]),r=this.stage.areaData.row.getViewportTop(t.yRange[1])+this.stage.tableData.row.getHeight(t.yRange[1]);return i.push(t.xRange[0]),i.push(t.xRange[1]),n.push(t.yRange[0]),n.push(t.yRange[1]),{posX:[a,o],posY:[s,r],xRange:i,yRange:n,xIndex:t.xRange[0],yIndex:t.yRange[0]}}},{key:"_makeCellVisiable",value:function(e){this._makeCellVisiableByCell(e)}},{key:"calcCellOffsetToTable",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this.stage.selectData,a=this.stage.areaData,o=this.stage.tableData;e=e||n.active.xRange,t=t||n.active.yRange;var r=a.row.frozen.length,l=a.col.frozen.length,h=a.row.getViewportTop(t[0]),g=a.col.getViewportLeft(e[0]),c=o.getCellBackgroundWidth(t[0],e[0],!1),d=o.getCellBackgroundHeight(t[0],e[0],!1),u=e[0]>=l?a.col.flow.viewStart:a.col.frozen.viewStart+1,f=e[0]>=l?a.col.flow.maxDistance:a.col.flow.viewStart,v=t[0]>=r?a.row.flow.viewStart:a.row.frozen.viewStart+1,A=t[0]>=r?Math.min(a.row.flow.maxDistance,window.innerHeight):a.row.flow.viewStart;if(i){var C=(0,s.getSoftKeyboardHeight)();0,s.android&&this.stage.inputCenter.board.showing&&(C=0),A-=C}f===a.col.flow.maxDistance&&(f-=12*o.scale+1),A===a.row.flow.maxDistance&&(A-=12*o.scale+1);var p=0,I=0;return g<u&&g+c>u||g+c<=u||c>f-u?p=g-u:(g<f&&g+c>f||g>=f)&&(p=g+c-f),h<v&&h+d>v||h+d<=v||d>A-v?I=h-v:(h<A&&h+d>A||h>=A)&&(I=h+d-A),1===Math.abs(p)&&(p=0),1===Math.abs(I)&&(I=0),p>0?p+=1:p<0&&(p-=1),I>0?I+=1:I<0&&(I-=1),{diffX:p,diffY:I}}},{key:"_makeCellVisiableByCell",value:function(e,t){var i=this,n=this.stage.areaData,a=this.stage.selectData,o=this.stage.tableData,s=a.active,r=e&&void 0!==e.x?[e.x,e.x]:s.xRange,l=e&&void 0!==e.y?[e.y,e.y]:s.yRange,h=this.calcCellOffsetToTable(r,l),c=h.diffX,d=h.diffY,u=r[0],f=l[0],v=n.row.frozen.viewHeight+n.row.flow.viewHeight,A=n.col.frozen.viewWidth+n.col.flow.viewWidth,C=o.getCellBackgroundHeight(f,u),p=o.getCellBackgroundWidth(f,u),I=d>0?o.row.getHeight(f+1,{ignoreHide:!1}):d<0?o.row.getHeight(f-1,{ignoreHide:!1}):0,m=c>0?o.col.getWidth(u+1,{ignoreHide:!1}):c<0?o.col.getWidth(u-1,{ignoreHide:!1}):0;if(C+Math.abs(d)+I<=v&&(d>0?d+=I:d<0&&(d-=I)),p+Math.abs(c)+m<=A&&(c>0?c+=m:c<0&&(c-=m)),0!==c||0!==d){var y=this.stage.tableData.getCellDataAtPosition(l[0],r[0],g.GET_CELLDATA.DEFAULT),w=n.areaX,x=n.areaY;y.parent&&(y=y.parent,x=n.row.getAreaName(y.mergeData.yRange[0]),w=n.col.getAreaName(y.mergeData.xRange[0])),this.stage.tableScroll({diffX:-c,diffY:-d,areaX:w,areaY:x,type:g.TABLE_SCROLL_MODE.IMMEDIATE,animatedEnd:function(){var e=2===i.stage.tableData.tableStatus;a.change({type:g.SELECT_SHOW_TYPE.SELECT,show:e}),t&&t()}})}else{var b=2===this.stage.tableData.tableStatus;a.change({type:g.SELECT_SHOW_TYPE.SELECT,show:b}),t&&t()}}},{key:"_makeCellVisiableByPx",value:function(e){var t=e.x,i=e.y,n=this.stage.tableData,a=this.stage.areaData,o=this.stage.configData,s=a.col,r=a.row,l=e.offsetY?-r.flow.needOffsetY+e.offsetY:0,h=e.offsetX?-(r.flow.needOffsetX||0)+e.offsetX:0,c=e.offsetYTo||0,d=e.offsetXTo||0,u=void 0,f=void 0,v=0,A=0;if(t<s.frozen.length)t>=s.frozen.to?v=a.col.getViewportLeft(t)-s.frozen.viewWidth+n.getCellBackgroundWidth(i,t,!1)-o.rowHeadWidth+h:t<=s.frozen.from?v=a.col.getViewportLeft(t)-o.rowHeadWidth-h:console.log("cell has visiable in col"),u=g.TABLE_AREA.FROZEN;else{if(t>=s.flow.to){var C=n.col.length-1,p=a.col.getViewportLeft(C)-s.flow.viewWidth+n.getCellBackgroundWidth(0,C,!1)-o.rowHeadWidth;v=(v=a.col.getViewportLeft(t+d)-s.flow.viewWidth+n.getCellBackgroundWidth(i,t,!1)-o.rowHeadWidth+s.flow.needOffsetX+h)>p?p:v}else t<=s.flow.from?(v=a.col.getViewportLeft(t)-h,v-=s.flow.viewStart):console.log("cell has visiable in col");u=g.TABLE_AREA.FLOW}if(i<r.frozen.length)i>=r.frozen.to?A=a.row.getViewportTop(i)-r.frozen.viewHeight+n.getCellBackgroundHeight(i,t,!1)-o.colHeadHeight+l:i<=r.frozen.from?A=a.row.getViewportTop(i)-o.colHeadHeight-l:console.log("cell has visiable in row"),f=g.TABLE_AREA.FROZEN;else{if(i>=r.flow.to-c){var I=n.row.length-1,m=a.row.getViewportTop(I-1+c)-r.flow.viewHeight+n.getCellBackgroundHeight(I,0,!1)-o.colHeadHeight+r.flow.needOffsetY;A=(A=a.row.getViewportTop(i+c)-r.flow.viewHeight+n.getCellBackgroundHeight(i,t,!1)-o.colHeadHeight+r.flow.needOffsetY+l)>m?m:A}else i<=r.flow.from?(A=a.row.getViewportTop(i)-l,A-=r.flow.viewStart):console.log("cell has visiable in row");f=g.TABLE_AREA.FLOW}this.stage.tableScroll({areaX:u,areaY:f,diffX:-v,diffY:-A})}},{key:"_setCellsData",value:function(e){var t=e.infos,i=void 0,n=void 0,a=void 0,o=void 0,s=void 0,r=void 0;for(o=0;o<t.length;o++)n=(i=t[o])[0],a=i[1],(s=this._setCellData({x:n,y:a,data:i[2]}))&&(r=this.stage.tableData.getCellDataAtPosition(a,n,g.GET_CELLDATA.NORMAL),s.multiLine?this.handleMultiLine(n,a):(s.textAlign&&r.calcTextAlign(n,a),s.verticalAlign&&r.calcVerticalAlign(n,a)))}},{key:"_setAreaData",value:function(e){var t=e.data,i=e.xRange,n=e.yRange,a=i[0],o=i[1],s=n[0],r=n[1],l=void 0,h=void 0,c=this.stage.tableData.col.length-1,d=this.stage.tableData.row.length-1,u=[],f=void 0,v=void 0;for(h=s;h<=r;h++)if(h>d)console.warn("\u8d85\u51fa\u884c\u8fb9\u754c");else for(l=a;l<=o;l++)l>c?console.warn("\u8d85\u51fa\u5217\u8fb9\u754c"):u.push(this._setCellData({x:l,y:h,data:t[h-s][l-a]}));for(h=s;h<=r;h++)if(h>d)console.warn("\u8d85\u51fa\u884c\u8fb9\u754c");else for(l=a;l<=o;l++)l>c?console.warn("\u8d85\u51fa\u5217\u8fb9\u754c"):(f=u.shift())&&(v=this.stage.tableData.getCellDataAtPosition(h,l,g.GET_CELLDATA.NORMAL),f.multiLine?this.handleMultiLine(l,h):(f.textAlign&&v.calcTextAlign(l,h),f.verticalAlign&&v.calcVerticalAlign(l,h)))}},{key:"_setCellData",value:function(e){var t=e.x,i=e.y,n=e.data,a=this.stage.tableData.col.length-1,o=this.stage.tableData.row.length-1;if(i>o||t>a)return console.warn("\u5199\u64cd\u4f5c\u8d8a\u754c",t,a,i,o),null;var s=this.stage.tableData.getCellDataAtPosition(i,t,g.GET_CELLDATA.FILL),r={multiLine:!1,verticalAlign:!1,textAlign:!1};if(n&&/Object/.test(Object.prototype.toString.call(n))){if(void 0!==n[g.SET_CELLDATA.TEXT]&&(s.setText(n[g.SET_CELLDATA.TEXT]),r.multiLine=!0),void 0!==n[g.SET_CELLDATA.SEGMENTS]&&(s.setSegments(n[g.SET_CELLDATA.SEGMENTS]),r.multiLine=!0),void 0!==n[g.SET_CELLDATA.BACKGROUND]&&s.setBackgroundColor(n[g.SET_CELLDATA.BACKGROUND]),void 0!==n[g.SET_CELLDATA.TEXT_ALIGN]&&(s.setTextAlign(n[g.SET_CELLDATA.TEXT_ALIGN]),r.textAlign=!0),void 0!==n[g.SET_CELLDATA.VERTICAL_ALIGN]&&(s.setVerticalAlign(n[g.SET_CELLDATA.VERTICAL_ALIGN]),r.verticalAlign=!0),void 0!==n[g.SET_CELLDATA.TEXT_WRAP]&&s.setTextWrap(n[g.SET_CELLDATA.TEXT_WRAP]),void 0!==n[g.SET_CELLDATA.LINK]&&s.setLink(n[g.SET_CELLDATA.LINK]),void 0===n[g.SET_CELLDATA.BORDER_COLOR]&&void 0===n[g.SET_CELLDATA.BORDER_STYLE]||this.borderCenter.setCellBorder(t,i,n[g.SET_CELLDATA.BORDER_COLOR],n[g.SET_CELLDATA.BORDER_STYLE]),void 0!==n[g.SET_CELLDATA.STYLE]){var l=n[g.SET_CELLDATA.STYLE];void 0!==l.paddingLeft&&(s.paddingLeft=l.paddingLeft),void 0!==l.paddingRight&&(s.paddingRight=l.paddingRight),r.multiLine=!0}if(n[g.SET_CELLDATA.DESTROY]&&!s.merge&&!s.merged){s.covers&&this._cancelHidden(t,i);var h=this.stage.tableData.getCellDataAtPosition(i,t-1,g.GET_CELLDATA.NORMAL),c=void 0,d=void 0;h&&(h.covers?(d=!0,c=t-1):isNaN(h.upperX)||(d=!0,c=t-1+h.upperX),d&&this._cancelHidden(c,i)),this.stage.tableData.destroyCellDataAtPosition(i,t),d&&this._addHidden(c,i)}}else console.error("error value in setCellData: ",n);return r}},{key:"_updataRowHeightIfNeed",value:function(e,t){if(t&&t.length){var i=!1,n=void 0;for(n=0;n<t.length;n++)if(t[n].fontSize){i=!0;break}!this.stage.tableData.row.getSetHeight(e)&&i&&this.checkRowHeight(e)}}},{key:"_hideRow",value:function(e){var t;t=e.range[0],this.borderCenter.refreshBottomBorder(t-1)}},{key:"_hideCol",value:function(e){var t,i=e.range,n=void 0,a=void 0,o=this.stage.tableData.row.length,s=void 0,r=void 0,l=!1,h=void 0;for(s=i[0],t=i[1],a=0;a<o;a++){for(l=!1,(r=this.stage.tableData.getCellDataAtPosition(a,s-1,g.GET_CELLDATA.NORMAL))&&(r.covers?(l=!0,h=s-1):isNaN(r.upperX)||(l=!0,h=s-1+r.upperX),l&&this._cancelHidden(h,a)),n=s;n<=t;n++)(r=this.stage.tableData.getCellDataAtPosition(a,n,g.GET_CELLDATA.NORMAL))&&r.covers&&this._cancelHidden(n,a);l&&this._addHidden(h,a)}s=i[0],this.borderCenter.refreshRightBorder(s-1)}},{key:"_showRow",value:function(e){var t,i,n=e.range,a=void 0,o=void 0,s=this.stage.tableData.col.length;for(t=n[0],i=n[1],o=t;o<=i;o++)for(a=0;a<s;a++)this.handleMultiLine(a,o);for(o=t-1;o<=i;o++)this.borderCenter.refreshBottomBorder(o)}},{key:"_showCol",value:function(e){var t,i,n=e.range,a=void 0,o=void 0,s=this.stage.tableData.row.length;for(t=n[0],i=n[1],o=0;o<s;o++)for(a=t;a<=i;a++)this.handleMultiLine(a,o);for(a=t-1;a<=i;a++)this.borderCenter.refreshRightBorder(a)}},{key:"_removeRow",value:function(e){var t,i=e.range,n=void 0;n=i[0],t=i[1],this.stage.tableData.data.splice(n,t-n+1),(n=i[0])>0&&this.borderCenter.refreshBottomBorder(n-1)}},{key:"_removeCol",value:function(e){var t,i=e.range,n=void 0,a=void 0,o=this.stage.tableData.row.length,s=void 0,r=void 0,l=!1,h=void 0;for(s=i[0],t=i[1],a=0;a<o;a++){for(l=!1,(r=this.stage.tableData.getCellDataAtPosition(a,s-1,g.GET_CELLDATA.NORMAL))&&(r.covers?(l=!0,h=s-1):isNaN(r.upperX)||(l=!0,h=s-1+r.upperX),l&&this._cancelHidden(h,a)),n=s;n<=t;n++)(r=this.stage.tableData.getCellDataAtPosition(a,n,g.GET_CELLDATA.NORMAL))&&r.covers&&this._cancelHidden(n,a);this.stage.tableData.data[a]&&this.stage.tableData.data[a].splice(s,t-s+1),l&&this._addHidden(h,a)}(s=i[0])>0&&this.borderCenter.refreshRightBorder(s-1)}},{key:"_addRow",value:function(e){var t=e.index,i=e.amount,n=void 0,a=void 0;for(n=0;n<i;n++){var o=this.stage.tableData.col.length,s=new Array(o);for(a=0;a<s.length;a++)s[a]=null;this.stage.tableData.data.splice(t,0,s)}this.borderCenter.conflictBorderInY(t+i-1,t+i),this.borderCenter.conflictBorderInY(t-i,t-i+1)}},{key:"_addCol",value:function(e){var t=e.index,i=e.amount,n=void 0,a=void 0,o=void 0,s=this.stage.tableData.row.heights.length,r=void 0,l=!1,h=void 0;for(o=0;o<s;o++){for(l=!1,(r=this.stage.tableData.getCellDataAtPosition(o,t,g.GET_CELLDATA.NORMAL))&&!isNaN(r.upperX)&&(l=!0,h=t+r.upperX,this._cancelHidden(h,o)),a=0;a<i;a++)n=null,this.stage.tableData.data[o]&&this.stage.tableData.data[o].splice(t+a,0,n);l&&this._addHidden(h,o)}this.borderCenter.conflictBorderInX(t+i-1,t+i),this.borderCenter.conflictBorderInX(t-i,t-i+1)}},{key:"_setRowHeight",value:function(e){var t,i=e.index,n=void 0,a=void 0;for(n=0,t=this.stage.tableData.col.length;n<t;n++)null!==(a=this.stage.tableData.getCellDataAtPosition(i,n,g.GET_CELLDATA.NORMAL))&&(a&&a.parent?(a=this.stage.tableData.getCellDataAtPosition(a.parent.mergeData.yRange[0],a.parent.mergeData.xRange[0],g.GET_CELLDATA.NORMAL)).calcVerticalAlign(a.parent.mergeData.xRange[0],a.parent.mergeData.yRange[0]):a.calcVerticalAlign(n,i))}},{key:"_setColWidth",value:function(e){var t,i=e.index,n=void 0,a=void 0,o=this.stage.tableData;for(n=0,t=o.row.length;n<t;n++)null!==(a=o.getCellDataAtPosition(n,i,g.GET_CELLDATA.NORMAL))&&(a.parent?(a=a.parent,this.handleMultiLine(a.mergeData.xRange[0],a.mergeData.yRange[0])):this.handleMultiLine(i,n))}},{key:"_getParagraphsTextWidth",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Number.POSITIVE_INFINITY,a=t.map(function(t){var n=e.ctx.measureText(t).width;return Math.min(Math.ceil(n),i)});return{widths:a,maxWidth:Math.max.apply(Math,(0,n.default)(a))}}},{key:"_doFilter",value:function(){var e=this.stage.tableData.filter.range,t=void 0,i=void 0;if(e)for(i=e.yRange[0],t=e.xRange[0];t<=e.xRange[1];t++)this.handleMultiLine(t,i)}},{key:"_closeFilter",value:function(){var e=this.stage.tableData.filter.range,t=void 0,i=void 0;if(e)for(i=e.yRange[0],t=e.xRange[0];t<=e.xRange[1];t++)this.handleMultiLine(t,i)}},{key:"_cancelHidden",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,g.GET_CELLDATA.NORMAL);if(i&&i.covers){var n=i.covers,a=void 0,o=void 0,s=i;for(a=0;a<n.length;a++)delete(o=n[a]).upperX;for(a=0;a<n.length;a++)o=n[a],this.borderCenter.chooseOneInX(s,o),s=o;delete i.covers}}},{key:"_addHidden",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,g.GET_CELLDATA.NORMAL);if(i){var n=i.getMaxTextWidth(),a=this.stage.tableData.col.length,o=void 0,r=i,l=void 0;for(o=n-this.stage.tableData.col.getWidth(e,{ignoreScale:!0}),i.covers=[],l=e+1;l<a;l++){if(r=this.stage.tableData.getCellDataAtPosition(t,l,g.GET_CELLDATA.FILL),(0,s.isColShow)(this.stage.tableData,l)&&(null!==r.text&&""!==r.text||r.merge||r.merged)){l--;break}if(r.upperX=e-l,i.covers.push(r),this.borderCenter.hideLeftBorder(l,t),this.borderCenter.hideRightBorder(l,t),(o-=this.stage.tableData.col.getWidth(l,{ignoreScale:!0}))<=0)break}l===a&&l--,this.borderCenter.showRightBorder(l,t),i.covers.length>0&&this.borderCenter.hideRightBorder(e,t)}}},{key:"calcHidden",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,g.GET_CELLDATA.NORMAL);if(i){var n=i.getMaxTextWidth()||0,a=this.stage.tableData.getCellBackgroundWidth(t,e);if(i.textWrap===g.TEXT_WRAP.NORMAL&&(n=Math.min(n,a)),null!==i.text&&""!==i.text&&n<=a||i.merge||i.merged){if(i.covers)this._cancelHidden(e,t);else if(!isNaN(i.upperX)){var o=e+i.upperX,r=t;this._cancelHidden(o,r),this._addHidden(o,r)}}else if(null!==i.text&&""!==i.text&&(0,s.isColShow)(this.stage.tableData,e))if(i.covers)this._cancelHidden(e,t),this._addHidden(e,t);else if(isNaN(i.upperX))this._addHidden(e,t);else{var l=e+i.upperX,h=t;this._cancelHidden(l,h),this._addHidden(e,t),this._addHidden(l,h)}else if(i.covers)this._cancelHidden(e,t),this.calcHidden(e-1,t);else if(isNaN(i.upperX))this.calcHidden(e-1,t);else{var c=e+i.upperX;delete i.upperX,this.calcHidden(c,t)}}}},{key:"_clear",value:function(){this.mergeCenter.clear()}},{key:"_renderArea",value:function(e,t){var i=void 0,n=this.stage.tableData,a=this.stage.areaData.col,o=this.stage.areaData.row,r=a[e].to,l=o[t].to,h=a[e].from,c=o[t].from;if(0!==a[e].length&&0!==o[t].length){this.ctx.clearRect(a[e].viewStart,o[t].viewStart,a[e].viewWidth,o[t].viewHeight),this.renderAreaX=e,this.renderAreaY=t,this.copyFrame.render(e,t);for(var d=0,u=0,f=l;f>=c;f--)if((0,s.isRowShow)(n,f))for(var v=r;v>=h;v--)(0,s.isColShow)(n,v)&&(u=a.getViewportLeft(v),d=o.getViewportTop(f),(i=n.getCellDataAtPosition(f,v,g.GET_CELLDATA.DEFAULT)).renderBorder(this.ctx,u,d,v,f),i.render(this.ctx,u,d,v,f),i.renderSeq=n.renderSeq);this.stage.renders.borderRender.render(),this.stage.renders.richTextRender.render(),this.stage.renders.mentionRender.render(),this.stage.renders.backgroundRender.render()}}},{key:"render",value:function(){var e=this.stage.tableData,t=this.stage.areaData,i=t.col,n=t.row;this.ctx.save(),this.ctx.textBaseline="alphabetic",this.ctx.textAlign="left",e.renderSeq++,this._renderArea(g.TABLE_AREA.FROZEN,g.TABLE_AREA.FROZEN),e.renderSeq++,this._renderArea(g.TABLE_AREA.FLOW,g.TABLE_AREA.FROZEN),e.renderSeq++,this._renderArea(g.TABLE_AREA.FROZEN,g.TABLE_AREA.FLOW),e.renderSeq++,this._renderArea(g.TABLE_AREA.FLOW,g.TABLE_AREA.FLOW);var a=i.flow.offsetX,o=a+i.flow.viewWidth-i.flow.totalWidth;if(o>0){var s=i.flow.viewStart+i.flow.totalWidth-a,r=n.flow.maxDistance;this.ctx.clearRect(s+1.5,0,o,r)}e.renderSeq>1e16&&(e.renderSeq=0),this.ctx.restore()}}]),e}();t.default=d},1180:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(84)),a=h(i(0)),o=h(i(1)),s=i(21),r=i(10),l=h(i(399));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage}return(0,o.default)(e,[{key:"regulateBorder",value:function(e,t){var i=void 0,n=this.stage.tableData,a=n.getCellDataAtPosition(t,e,r.GET_CELLDATA.NORMAL);i=n.getCellDataAtPosition(t+1,e,r.GET_CELLDATA.NORMAL),this.chooseOneInY(a,i),i=n.getCellDataAtPosition(t,e+1,r.GET_CELLDATA.NORMAL),this.chooseOneInX(a,i)}},{key:"refreshBottomBorder",value:function(e){var t=this.stage.tableData,i=t.col.length,n=void 0,a=void 0,o=(0,s.findNextShowRow)(t,e,1);if(null===o){if(e<0)return;for(n=0;n<i;n++)(a=t.getCellDataAtPosition(e,n,r.GET_CELLDATA.NORMAL))&&(a.borderBottomShow=!0)}else this.conflictBorderInY(e,o)}},{key:"refreshRightBorder",value:function(e){var t=this.stage.tableData,i=t.row.length,n=void 0,a=void 0,o=(0,s.findNextShowCol)(t,e,1);if(null===o){if(e<0)return;for(n=0;n<i;n++)(a=t.getCellDataAtPosition(n,e,r.GET_CELLDATA.NORMAL))&&(a.borderRightShow=!0)}else this.conflictBorderInX(e,o)}},{key:"conflictBorderInX",value:function(e,t){var i=this.stage.tableData,n=i.col.length,a=i.row.length,o=void 0,l=void 0,h=void 0;if((e>=t||e<0&&t<0)&&console.warn("invalid arguments in conflictBorderInY"),t>n-1||!(0,s.isColShow)(i,t)){if(e>=0&&(0,s.isColShow)(i,e))for(o=0;o<a;o++)(l=i.getCellDataAtPosition(o,e,r.GET_CELLDATA.NORMAL))&&(l.borderRightShow=!0)}else if(e<0||!(0,s.isColShow)(i,e)){if(t>=0&&(0,s.isColShow)(i,t))for(o=0;o<a;o++)(h=i.getCellDataAtPosition(o,t,r.GET_CELLDATA.NORMAL))&&(h.borderLeftShow=!0)}else for(o=0;o<a;o++)l=i.getCellDataAtPosition(o,e,r.GET_CELLDATA.NORMAL),h=i.getCellDataAtPosition(o,t,r.GET_CELLDATA.NORMAL),this.chooseOneInX(l,h)}},{key:"conflictBorderInY",value:function(e,t){var i=this.stage.tableData,n=i.col.length,a=i.row.length,o=void 0,l=void 0,h=void 0;if((e>=t||e<0&&t<0)&&console.warn("invalid arguments in conflictBorderInY"),t>a-1||!(0,s.isRowShow)(i,t)){if(e>=0&&(0,s.isRowShow)(i,e))for(o=0;o<n;o++)(l=i.getCellDataAtPosition(e,o,r.GET_CELLDATA.NORMAL))&&(l.borderBottomShow=!0)}else if(e<0||!(0,s.isRowShow)(i,e)){if(t>=0&&(0,s.isRowShow)(i,t))for(o=0;o<n;o++)(h=i.getCellDataAtPosition(t,o,r.GET_CELLDATA.NORMAL))&&(h.borderTopShow=!1)}else for(o=0;o<n;o++)l=i.getCellDataAtPosition(e,o,r.GET_CELLDATA.NORMAL),h=i.getCellDataAtPosition(t,o,r.GET_CELLDATA.NORMAL),this.chooseOneInY(l,h)}},{key:"setCellBorder",value:function(e,t,i,a){var o=this.stage.tableData,s=o.getCellDataAtPosition(t,e,r.GET_CELLDATA.FILL),l=void 0,h=o.col.widths,g=o.row.heights;s.borderColor=(0,n.default)(i),s.borderStyle=(0,n.default)(a),t>0&&(l=o.getCellDataAtPosition(t-1,e,r.GET_CELLDATA.NORMAL),this.chooseOneInY(l,s)),e<h.length-1&&(l=o.getCellDataAtPosition(t,e+1,r.GET_CELLDATA.NORMAL),this.chooseOneInX(s,l)),t<g.length-1&&(l=o.getCellDataAtPosition(t+1,e,r.GET_CELLDATA.NORMAL),this.chooseOneInY(s,l)),e>0&&(l=o.getCellDataAtPosition(t,e-1,r.GET_CELLDATA.NORMAL),this.chooseOneInX(l,s))}},{key:"hideLeftBorder",value:function(e,t){this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.NORMAL).borderLeftShow=!1}},{key:"hideRightBorder",value:function(e,t){this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.NORMAL).borderRightShow=!1}},{key:"showLeftBorder",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.FILL);if(isNaN(i.upperX)){var n=this.stage.tableData.getCellDataAtPosition(t,e-1,r.GET_CELLDATA.NORMAL);this.chooseOneInX(n,i)}}},{key:"showRightBorder",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.FILL),n=this.stage.tableData.getCellDataAtPosition(t,e+1,r.GET_CELLDATA.NORMAL);if(n){if(!isNaN(n.upperX))return;this.chooseOneInX(i,n)}else i.borderRightShow=!0}},{key:"chooseOneInY",value:function(e,t){if(e||t)if(!e||t)if(e||!t){var i=this.stage.tableData.hideGridlines,n=new l.default(e.borderStyle[2],e.borderColor[2],i),a=new l.default(t.borderStyle[0],t.borderColor[0],i);n.compare(a)>=0?(e.borderBottomShow=!0,t.borderTopShow=!1):(e.borderBottomShow=!1,t.borderTopShow=!0)}else t.borderTopShow=!0;else e.borderBottomShow=!0}},{key:"chooseOneInX",value:function(e,t){if(e||t)if(!e||t)if(e||!t){if(!isNaN(t.upperX))return e.borderRightShow=!1,void(t.borderLeftShow=!1);var i=this.stage.tableData.hideGridlines,n=new l.default(e.borderStyle[1],e.borderColor[1],i),a=new l.default(t.borderStyle[3],t.borderColor[3],i);n.compare(a)>=0?(e.borderRightShow=!0,t.borderLeftShow=!1):(e.borderRightShow=!1,t.borderLeftShow=!0)}else t.borderLeftShow=!0;else e.borderRightShow=!0}}]),e}();t.default=g},1181:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(9)),a=l(i(31)),o=l(i(0)),s=l(i(1)),r=i(10);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,o.default)(this,e),this.stage=t.stage,this.body=t.body,this.mergePositionKey={}}return(0,s.default)(e,[{key:"mergeCell",value:function(e,t){var i=e.x,n=e.y,a=e.w,o=e.h,s=this.stage.tableData,l=s.getCellDataAtPosition(n,i,r.GET_CELLDATA.FILL),h=void 0,g=void 0,c=void 0;if(!(n+o>s.row.length)&&!(i+a>s.col.length)){for(h=0;h<o;h++)for(g=0;g<a;g++)(c=s.getCellDataAtPosition(n+h,i+g,r.GET_CELLDATA.NORMAL))&&c.merge&&this._cancelMerged(i+g,n+h);if(this._doMerge(i,n,a,o),this._calcMergeCell(l),!t)for(h=0;h<o;h++)for(g=0;g<a;g++)this.body.calcHidden(i+g,n+h)}}},{key:"_doMerge",value:function(e,t,i,n){var a,o=this,s=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.FILL);s.merge=!0;var l={xRange:[e,e+i-1],yRange:[t,t+n-1],positionCenterKey:null,cell:s};s.mergeData=l,a=this.stage.positionCenter.add({type:"merge",config:{ignoreSet:!0,ignoreAdd:!1,ignoreRemove:!1,ignoreFrozen:!0,ignoreMerge:!0,removeType:"follow"},selfData:s.mergeData,calc:function(e,t,i){if(e.yRange[1]<e.yRange[0])return o.stage.positionCenter.remove(e.positionCenterKey),void delete o.mergePositionKey[e.positionCenterKey];if(e.xRange[1]<e.xRange[0])return o.stage.positionCenter.remove(e.positionCenterKey),void delete o.mergePositionKey[e.positionCenterKey];if("remove"===t){var n=o.stage.tableData.getCellDataAtPosition(e.yRange[0],e.xRange[0],r.GET_CELLDATA.NORMAL);e.cell!==n&&(delete e.cell.mergeData,n.merge=!0,e.cell=n,e.cell.mergeData=e)}o._calcMergeCell(e.cell)}}),s.mergeData.positionCenterKey=a,this.mergePositionKey[a]=1}},{key:"_handleMergeInner",value:function(e,t,i,n){var a=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.DEFAULT),o=void 0,s=void 0,l=void 0;for(a.merge||console.error("handleMergeInner must be a merge cell"),o=0;o<n;o++)for(s=0;s<i;s++)(l=this.stage.tableData.getCellDataAtPosition(t+o,e+s,r.GET_CELLDATA.FILL)).parent=a,0===o&&0===s||(l.merged=!0,l.text=null),o!==n-1&&(l.borderBottomShow=!1),0!==o&&(l.borderTopShow=!1),s!==i-1&&(l.borderRightShow=!1),0!==s&&(l.borderLeftShow=!1)}},{key:"splitCell",value:function(e){var t=e.x,i=e.y,n=this.stage.tableData.getCellDataAtPosition(i,t,r.GET_CELLDATA.NORMAL);n&&n.merge&&this._cancelMerged(t,i)}},{key:"_cancelMerged",value:function(e,t){var i=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.NORMAL),n=void 0,a=i.mergeData;if(i&&i.merge){for(i.merge=!1,this.stage.positionCenter.remove(a.positionCenterKey),delete this.mergePositionKey[a.positionCenterKey],t=a.yRange[0];t<=a.yRange[1];t++)for(e=a.xRange[0];e<=a.xRange[1];e++)null===(n=this.stage.tableData.getCellDataAtPosition(t,e,r.GET_CELLDATA.NORMAL))&&console.error("error in cancelMerged"),n.parent=null,n.merged=!1,t!==a.yRange[0]&&(n.borderTopShow=!1),t!==a.yRange[1]&&(n.borderBottomShow=!0),e!==a.xRange[1]&&(n.borderRightShow=!0),e!==a.xRange[0]&&(n.borderLeftShow=!1);for(this.body.handleMultiLine(i),t=a.yRange[0];t<=a.yRange[1];t++)this.body.calcHidden(e,t);delete i.mergeData}}},{key:"_calcMergeCell",value:function(e){var t,i=e.mergeData,n=i.xRange,a=i.yRange;if(i.xRange[0]===i.xRange[1]&&i.yRange[0]===i.yRange[1])return this._cancelMerged(i.xRange[0],i.yRange[0]),void(-1!==n[0]&&-1!==a[0]&&this.body.handleMultiLine(n[0],a[0]));(this._handleMergeInner(n[0],a[0],n[1]-n[0]+1,a[1]-a[0]+1),0,t=this.stage.tableData.row.getRangeHeight(a),0!==this.stage.tableData.col.getRangeWidth(n)&&this.body.handleMultiLine(n[0],a[0]),0!==t)&&this.stage.tableData.getCellDataAtPosition(a[0],n[0],r.GET_CELLDATA.NORMAL).calcVerticalAlign(n[0],a[0])}},{key:"clear",value:function(){var e=void 0,t=!0,i=!1,o=void 0;try{for(var s,r=(0,a.default)((0,n.default)(this.mergePositionKey));!(t=(s=r.next()).done);t=!0)e=s.value,this.stage.positionCenter.remove(e)}catch(l){i=!0,o=l}finally{try{!t&&r.return&&r.return()}finally{if(i)throw o}}this.mergePositionKey={}}}]),e}();t.default=h},1182:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){var i=this;(0,n.default)(this,e),this._scale=function(){i.showing&&i._calc()},this._hide=function(){i.showing&&(i.showing=!1,i.range.xRange.length=0,i.range.yRange.length=0,i.stage.renderNextTick(),i.stage.hookFunc.cancelCopyCells&&i.stage.hookFunc.cancelCopyCells(),i.stage.event.eventTable.remove("scale",i._scale),i.stage.event.eventTable.remove("clearTable",i._hide),i.stage.event.eventTable.remove("enterInputStatus",i._hide))},this._show=function(){var e=i.range,t=i.stage.selectData.select;e.xRange[0]=t.xRange[0],e.xRange[1]=t.xRange[1],e.yRange[0]=t.yRange[0],e.yRange[1]=t.yRange[1],i._calc(),i.showing=!0,i.stage.renderNextTick(),i.stage.event.eventTable.listen("scale",i._scale),i.stage.event.eventTable.listen("clearTable",i._hide),i.stage.event.eventTable.listen("enterInputStatus",i._hide)},this.stage=t.stage,this.range={xRange:[],yRange:[]},this.showing=!1,this.ctx=this.stage.ctx,this.init(),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){var e=this;this.positionCenterKey=this.stage.positionCenter.add({type:"copyFrame",config:{ignoreSet:!1,ignoreAdd:!1,ignoreRemove:!1,ignoreHideShow:!1,ignoreFrozen:!1,listenSetBefore:!0,listenHideShowBefore:!0},selfData:this.range,calc:function(){e._hide()}})}},{key:"initEvent",value:function(){this.stage.event.eventCopy.listen("copyFrameShow",this._show),this.stage.event.eventCopy.listen("copyFrameHide",this._hide)}},{key:"_calc",value:function(){var e,t,i=this.stage.tableData.col,n=this.stage.tableData.row,a=this.range.xRange[0],o=this.range.yRange[0],s=this.range.xRange[1],r=this.range.yRange[1],l=void 0,h=0,g=0;for(l=a;l<=s;l++)h+=i.getWidth(l);for(l=o;l<=r;l++)g+=n.getHeight(l);e=this.stage.areaData.col.getRealGlobalLeft(a),t=this.stage.areaData.row.getRealGlobalTop(o),this.width=h+2,this.height=g+2,this.left=e-1,this.top=t-1}},{key:"render",value:function(e,t){this.showing&&(this.ctx.save(),this.ctx.lineWidth=2,this.ctx.setLineDash([10,2]),this.ctx.strokeStyle=this.stage.configData.copyFrameColor,this.ctx.beginPath(),this.ctx.rect(this.left-(this.stage.areaData.col[e].visualOffsetX||this.stage.areaData.col[e].offsetX)-this.stage.areaData.col[e].shadowX,this.top-(this.stage.areaData.row[t].visualOffsetY||this.stage.areaData.row[t].offsetY)-this.stage.areaData.row[t].shadowY,this.width,this.height),this.ctx.stroke(),this.ctx.closePath(),this.ctx.restore())}}]),e}();t.default=s},1183:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=l(i(1184)),s=i(21),r=i(10);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.xRange=[],this.yRange=[],this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"initStyle",value:function(){i(1187)}},{key:"init",value:function(){var e=document.createElement("div");this.area=e,e.className="smart-selection",this.container.appendChild(e),this.SmartBtn=new o.default({container:this.container,stage:this.stage,autoHide:!0})}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventSmart.listen("smartSelectionShow",function(t){e._calc(t)}),this.stage.event.eventSmart.listen("smartSelectionEnd",function(){e._end(),e.stage.focusInput()})}},{key:"_hasMerge",value:function(){var e,t,i,n,a=this.stage.selectData.select,o=a.xRange,s=a.yRange,l=void 0,h=void 0,g=this.stage.tableData,c=void 0;for(e=o[0],t=o[1],i=s[0],n=s[1],h=i;h<=n;h++)for(l=e;l<=t;l++)if((c=g.getCellDataAtPosition(h,l,r.GET_CELLDATA.NORMAL))&&c.merge)return!0;return!1}},{key:"_calc",value:function(e){var t=void 0,i=void 0,n=void 0,a=void 0,o=this.stage.selectData.select,s=void 0,r=void 0,l=void 0;this._hasMerge()?(s=o.xRange[1]-o.xRange[0]+1,r=o.yRange[1]-o.yRange[0]+1):r=s=1,e.x<o.xRange[0]?((l=o.xRange[0]-e.x)%s!==0&&(l=(1+(l/s>>0))*s),t=o.xRange[0]-l):t=o.xRange[0],e.x>o.xRange[1]?((l=e.x-o.xRange[1])%s!==0&&(l=(1+(l/s>>0))*s),i=o.xRange[1]+l):i=o.xRange[1],e.y<o.yRange[0]?((l=o.yRange[0]-e.y)%r!==0&&(l=(1+(l/r>>0))*r),n=o.yRange[0]-l):n=o.yRange[0],e.y>o.yRange[1]?((l=e.y-o.yRange[1])%r!==0&&(l=(1+(l/r>>0))*r),a=o.yRange[1]+l):a=o.yRange[1],t<0||n<0||i>=this.stage.tableData.col.length||a>=this.stage.tableData.row.length||(this.xRange=[t,i],this.yRange=[n,a],this._show())}},{key:"_show",value:function(e){var t=this.stage.areaData,i=this.xRange[0],n=this.xRange[1],a=this.yRange[0],o=this.yRange[1],s=t.col.getViewportLeft(i),r=t.row.getViewportTop(a),l=t.col.getViewportLeft(n)+this.stage.tableData.col.getWidth(n),h=t.row.getViewportTop(o)+this.stage.tableData.row.getHeight(o);r=Math.max(this.stage.configData.colHeadHeight,r),this.area.style.left=s+"px",this.area.style.top=r+"px",this.area.style.width=l-s+1+"px",this.area.style.height=h-r+1+"px";var g=l-s+1+s,c=h-r+1+r;this.SmartBtn.setPosition(g,c),this.area.style.display="block"}},{key:"_end",value:function(){var e=[],t=[],i=void 0,n=void 0,a=this.stage.selectData.select.xRange,o=this.stage.selectData.select.yRange,l=void 0,h=void 0,g=void 0,c=void 0,d=void 0,u={xRange:[],yRange:[]},f=this.stage.selectData;for(i=o[0];i<=o[1];i++)for(n=a[0];n<=a[1];n++)e.push([n,i]);for(this.area.style.display="none",this.xRange[0]<f.select.xRange[0]?(h=this.xRange[0],g=f.select.xRange[0]-1,l="left"):this.xRange[1]>f.select.xRange[1]?(h=f.select.xRange[1]+1,g=this.xRange[1],l="right"):(h=f.select.xRange[0],g=f.select.xRange[1]),this.yRange[0]<f.select.yRange[0]?(c=this.yRange[0],d=f.select.yRange[0]-1,l="top"):this.yRange[1]>f.select.yRange[1]?(c=f.select.yRange[1]+1,d=this.yRange[1],l="bottom"):(c=f.select.yRange[0],d=f.select.yRange[1]),i=c;i<=d;i++)for(n=h;n<=g;n++)t.push([n,i]);u.xRange[0]=this.xRange[0],u.xRange[1]=this.xRange[1],u.yRange[0]=this.yRange[0],u.yRange[1]=this.yRange[1],this.stage.selectData.change({select:u,type:r.SELECT_SHOW_TYPE.AUTO_FILL}),this.stage.hookFunc.smartSelection&&this.stage.hookFunc.smartSelection({ctrl:(0,s.macCmdAndWinCtrl)(),oldCells:e,newCells:t,direction:l})}}]),e}();t.default=h},1184:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(41)),a=l(i(0)),o=l(i(1)),s=l(i(12)),r=l(i(8));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){var i=this;(0,a.default)(this,e),this._hide=function(){i.smartBtnMenus=[],i.area.style.display="none",i.stage.event.eventTable.remove("tableMove",i._handleTableMove),i.stage.event.eventTable.remove("clearTable",i._hide),i.stage.event.eventDimension.remove("setColWidth",i._hide),i.stage.event.eventDimension.remove("setRowHeight",i._hide),i.stage.event.eventDimension.remove("addCol",i._hide),i.stage.event.eventDimension.remove("addRow",i._hide),i.stage.event.eventDimension.remove("hideCol",i._hide),i.stage.event.eventDimension.remove("hideRow",i._hide),i.stage.event.eventFilter.remove("hideFilterRow",i._hide),i.stage.event.eventDimension.remove("showCol",i._hide),i.stage.event.eventFilter.remove("showFilterRow",i._hide),i.stage.event.eventDimension.remove("showRow",i._hide),i.stage.event.eventDimension.remove("removeCol",i._hide),i.stage.event.eventDimension.remove("removeRow",i._hide),i.stage.event.eventDimension.remove("updateFrozenCol",i._hide),i.stage.event.eventDimension.remove("updateFrozenRow",i._hide),document.body.removeEventListener("dblclick",i._hide)},this._handleSelectionShow=function(e){e.selectChange?i._hide():i.setPosition()},this._handleTableMove=function(e){e.areaX,e.areaY;var t=e.diffX,n=e.diffY;try{return void((void 0!==t&&Math.abs(t)>=4||void 0!==n&&Math.abs(n)>=4)&&i._hide())}catch(a){}i._hide()},this.stage=t.stage,this.container=t.container,this.smartBtnMenus=[],this.position={left:void 0,top:void 0},this.area=null,this.autoHide=t.autoHide,this.initStyle(),this.init()}return(0,o.default)(e,[{key:"initStyle",value:function(){i(1185)}},{key:"init",value:function(){var e=this,t=document.createElement("div");this.area=t,t.className="smart-btn",this.container.appendChild(t),this.stage.event.eventSmart.listen("showSmartBtn",function(t){s.default.wait(100).run(function(){e._show(t)})}),this.stage.event.eventSmart.listen("hideSmartBtn",function(){e._hide()})}},{key:"initEvent",value:function(){var e=this;this.area.addEventListener("mousedown",function(t){t.stopPropagation(),r.default.tdwReport({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option"}),e.stage.event.eventSmart.trigger("smartSelectionMenuShow",e.smartBtnMenus,e.position)})}},{key:"getSmartBtnPosition",value:function(){var e=this.stage.selectData.select,t=e.xRange[1],i=e.yRange[1],n=this.stage.areaData,a=this.stage.tableData,o=n.col.getViewportLeft(t),s=n.row.getViewportTop(i),r=a.getCellBorderWidth(i,t,!0),l=a.getCellBorderHeight(i,t,!0),h=s+l+28+5>n.stage.height,g=o+r+36+5>n.stage.width;return h&&g?[o-(46+r),s-38,r,l]:h?[o,s-38,r,l]:g?[o-46,s,r,l]:[o,s,r,l]}},{key:"setPosition",value:function(){var e=this.getSmartBtnPosition(),t=(0,n.default)(e,4),i=t[0],a=t[1],o=t[2],s=t[3];this.position.left=i,this.position.top=a,this.area.style.left=i+5+o+"px",this.area.style.top=a+5+s+"px"}},{key:"_show",value:function(e){this.setPosition(),this.smartBtnMenus=e,this.area.style.display="block",this.initEvent(),this.autoHide&&(this.stage.event.eventTable.listen("tableMove",this._handleTableMove),this.stage.event.eventTable.listen("clearTable",this._hide),this.stage.event.eventDimension.listen("setColWidth",this._hide),this.stage.event.eventDimension.listen("setRowHeight",this._hide),this.stage.event.eventDimension.listen("addCol",this._hide),this.stage.event.eventDimension.listen("addRow",this._hide),this.stage.event.eventDimension.listen("hideCol",this._hide),this.stage.event.eventDimension.listen("hideRow",this._hide),this.stage.event.eventFilter.listen("hideFilterRow",this._hide),this.stage.event.eventDimension.listen("showCol",this._hide),this.stage.event.eventFilter.listen("showFilterRow",this._hide),this.stage.event.eventDimension.listen("showRow",this._hide),this.stage.event.eventDimension.listen("removeCol",this._hide),this.stage.event.eventDimension.listen("removeRow",this._hide),this.stage.event.eventDimension.listen("updateFrozenCol",this._hide),this.stage.event.eventDimension.listen("updateFrozenRow",this._hide),document.body.addEventListener("dblclick",this._hide))}}]),e}();t.default=h},1185:function(e,t,i){var n=i(1186);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1186:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".smart-btn {\n    position: absolute;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAeCAYAAAA/xX6fAAAACXBIWXMAAAsTAAALEwEAmpwYAAA7ImlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMwMTQgNzkuMTU2Nzk3LCAyMDE0LzA4LzIwLTA5OjUzOjAyICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCAoV2luZG93cyk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTgtMDYtMjZUMjE6NTE6MzQrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxOC0wNi0yN1QxNzo0NDoxMSswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTgtMDYtMjdUMTc6NDQ6MTErMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDxkYzpmb3JtYXQ+aW1hZ2UvcG5nPC9kYzpmb3JtYXQ+CiAgICAgICAgIDxwaG90b3Nob3A6Q29sb3JNb2RlPjM8L3Bob3Rvc2hvcDpDb2xvck1vZGU+CiAgICAgICAgIDxwaG90b3Nob3A6VGV4dExheWVycz4KICAgICAgICAgICAgPHJkZjpCYWc+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8cGhvdG9zaG9wOkxheWVyTmFtZT4rPC9waG90b3Nob3A6TGF5ZXJOYW1lPgogICAgICAgICAgICAgICAgICA8cGhvdG9zaG9wOkxheWVyVGV4dD4rPC9waG90b3Nob3A6TGF5ZXJUZXh0PgogICAgICAgICAgICAgICA8L3JkZjpsaT4KICAgICAgICAgICAgPC9yZGY6QmFnPgogICAgICAgICA8L3Bob3Rvc2hvcDpUZXh0TGF5ZXJzPgogICAgICAgICA8eG1wTU06SW5zdGFuY2VJRD54bXAuaWlkOjM1ZTZiOTAxLTkzMzEtMGU0Ny05ODVjLTZlOGU3YjljMzdjNTwveG1wTU06SW5zdGFuY2VJRD4KICAgICAgICAgPHhtcE1NOkRvY3VtZW50SUQ+YWRvYmU6ZG9jaWQ6cGhvdG9zaG9wOjlhODNhODhlLTc5ZWUtMTFlOC1iYzA1LWQ4NTZiYTUxNjM2ODwveG1wTU06RG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD54bXAuZGlkOjNkOGFiNGE1LTg5NmMtMzk0Zi1hZjNlLTE1MDdiOWIyZWZjOTwveG1wTU06T3JpZ2luYWxEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06SGlzdG9yeT4KICAgICAgICAgICAgPHJkZjpTZXE+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPmNyZWF0ZWQ8L3N0RXZ0OmFjdGlvbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0Omluc3RhbmNlSUQ+eG1wLmlpZDozZDhhYjRhNS04OTZjLTM5NGYtYWYzZS0xNTA3YjliMmVmYzk8L3N0RXZ0Omluc3RhbmNlSUQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDp3aGVuPjIwMTgtMDYtMjZUMjE6NTE6MzQrMDg6MDA8L3N0RXZ0OndoZW4+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpzb2Z0d2FyZUFnZW50PkFkb2JlIFBob3Rvc2hvcCBDQyAyMDE0IChXaW5kb3dzKTwvc3RFdnQ6c29mdHdhcmVBZ2VudD4KICAgICAgICAgICAgICAgPC9yZGY6bGk+CiAgICAgICAgICAgICAgIDxyZGY6bGkgcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6YWN0aW9uPnNhdmVkPC9zdEV2dDphY3Rpb24+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDppbnN0YW5jZUlEPnhtcC5paWQ6MzVlNmI5MDEtOTMzMS0wZTQ3LTk4NWMtNmU4ZTdiOWMzN2M1PC9zdEV2dDppbnN0YW5jZUlEPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6d2hlbj4yMDE4LTA2LTI3VDE3OjQ0OjExKzA4OjAwPC9zdEV2dDp3aGVuPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6c29mdHdhcmVBZ2VudD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNCAoV2luZG93cyk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjI4PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMwPC9leGlmOlBpeGVsWURpbWVuc2lvbj4KICAgICAgPC9yZGY6RGVzY3JpcHRpb24+CiAgIDwvcmRmOlJERj4KPC94OnhtcG1ldGE+CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz5sDll0AAAAIGNIUk0AAHolAACAgwAA+f8AAIDpAAB1MAAA6mAAADqYAAAXb5JfxUYAAAFoSURBVHja7NcxS1xBEAfw3zsPCcGAWOiBICqx0uLQQkxl6TewTZX+Oq208BMYiI0gipWVoEKqaIKQSgjYpAgkIRDJISI2CoqbZiNyeuLbhEPiDSxvZ2b/+999M7PvbeZZR9AzJJccfOHo5y/s5wMqF/WPUFnNB1uZ4t3Se0zmJNwsaLA0CZuED5+wqPqNrdf5UN/3oSuFMFNoOdfVd5YLdVxtdXpyjo85+Z7DZsJCe/Am7ZX+pYQQmln6HxJmWbadZVl4rCcNA9iL+mcsoYJStM1gDBNRf4sDvEglvMTaNdsIPlzTB3FSM6YbP2K8ymivmbc9+sZv/c9IWOhTDMf+NsJ9WxG7CYQXOIz9ZezU+F+iF7P/KvZXZ2kI4Ub7s+vbfAUsNrosSgm4s5jRDavDKuZTd9mWgClh6o4YljFeL4YTCYStMXHqfSM/hRB26hX+QnxuYD3av+IV5jAabRV0YhpPEi4y4PcAIlaOQ0QgZwMAAAAASUVORK5CYII=');\n    background-color: #f5f5f5;\n    background-size: 45%;\n    background-repeat: no-repeat;\n    background-position: 4px 50%;\n    height: 28px;\n    width: 36px;\n    box-sizing: border-box;\n    border: 1px solid #e0e2e4;\n    border-radius: 3px;\n    display: none;\n    z-index: 104;\n}\n\n.smart-btn:hover,\n.smart-btn:active {\n    background-color: #e5e5e5;\n}\n\n.smart-btn:after {\n    content: '';\n    position: absolute;\n    display: block;\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAcAAAAEAQMAAAB4CLc+AAAABlBMVEUAAACeoaQ0TcZsAAAAAXRSTlMAQObYZgAAABlJREFUeF4FwAENAAAIArBHMA7hyM6cqbgHCh4Bw3iWbFUAAAAASUVORK5CYII=);\n    width: 7px;\n    height: 4px;\n    right: 4px;\n    top: 12px;\n}\n",""])},1187:function(e,t,i){var n=i(1188);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1188:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".smart-selection {\n    position: absolute;\n    border: 1px #3eb3ff dashed;\n    box-sizing: border-box;\n    background-color: rgba(158, 191, 249, 0.2);\n}\n\n.smart-selection-container {\n    width: 100%;\n    height: 100%;\n    position: absolute;\n    top: 0;\n    left: 0;\n    overflow: hidden;\n    display: none;\n}\n\n.smart-selection-m {\n    position: absolute;\n    box-sizing: border-box;\n    border: 1px solid #f49c20;\n    background-color: rgba(244, 156, 32, 0.2);\n}\n\n.smart-selection-m .right-select-btn {\n    position: absolute;\n    width: 16px;\n    height: 16px;\n    padding: 5px;\n    right: -13px;\n    bottom: -13px;\n    z-index: 10;\n}\n\n.smart-selection-m .right-select-btn:before {\n    content: '';\n    display: block;\n    width: 16px;\n    height: 16px;\n    border: 0.5px solid rgba(0, 0, 0, 0.15);\n    background-color: #ffffff;\n    box-sizing: border-box;\n    border-radius: 0;\n}\n\n.smart-selection-m .lrselect-btn-center {\n    border-radius: 0;\n    background-color: rgba(255, 183, 20, 1);\n}\n\n.smart-selection-tips {\n    position: absolute;\n    width: 240px;\n    height: 160px;\n    background: #fff;\n    display: none;\n    border-radius: 3px;\n    box-shadow: 0px 0px 5px #aaa;\n    font-size: 13px;\n}\n\n.smart-selection-tips:before {\n    content: '';\n    position: absolute;\n    top: -6px;\n    left: 94px;\n    -webkit-transform: rotate(45deg);\n            transform: rotate(45deg);\n    width: 14px;\n    height: 14px;\n    background: #fff;\n    box-shadow: -2px -2px 2px 0px #ccc;\n}\n\n.smart-selection-tips-content {\n    width: 100%;\n    height: 100%;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n}\n",""])},1195:function(e,t,i){"use strict";var n=o(i(25)),a=o(i(107));function o(e){return e&&e.__esModule?e:{default:e}}!function(){var i=.017453292519943295,o=function(e,t,i,n,a,o,s,r,l,h,g,c,d,u,f,v){this.elements=window.Float32Array?new Float32Array(16):[];var A=this.elements;A[0]=void 0!==e?e:1,A[4]=t||0,A[8]=i||0,A[12]=n||0,A[1]=a||0,A[5]=void 0!==o?o:1,A[9]=s||0,A[13]=r||0,A[2]=l||0,A[6]=h||0,A[10]=void 0!==g?g:1,A[14]=c||0,A[3]=d||0,A[7]=u||0,A[11]=f||0,A[15]=void 0!==v?v:1};o.prototype={set:function(e,t,i,n,a,o,s,r,l,h,g,c,d,u,f,v){var A=this.elements;return A[0]=e,A[4]=t,A[8]=i,A[12]=n,A[1]=a,A[5]=o,A[9]=s,A[13]=r,A[2]=l,A[6]=h,A[10]=g,A[14]=c,A[3]=d,A[7]=u,A[11]=f,A[15]=v,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},multiplyMatrices:function(e,t){var i=e.elements,n=this.elements,a=i[0],o=i[4],s=i[8],r=i[12],l=i[1],h=i[5],g=i[9],c=i[13],d=i[2],u=i[6],f=i[10],v=i[14],A=i[3],C=i[7],p=i[11],I=i[15],m=t[0],y=t[1],w=t[2],x=t[3],b=t[4],R=t[5],E=t[6],_=t[7],D=t[8],T=t[9],S=t[10],k=t[11],L=t[12],M=t[13],O=t[14],F=t[15];return n[0]=a*m+o*b+s*D+r*L,n[4]=a*y+o*R+s*T+r*M,n[8]=a*w+o*E+s*S+r*O,n[12]=a*x+o*_+s*k+r*F,n[1]=l*m+h*b+g*D+c*L,n[5]=l*y+h*R+g*T+c*M,n[9]=l*w+h*E+g*S+c*O,n[13]=l*x+h*_+g*k+c*F,n[2]=d*m+u*b+f*D+v*L,n[6]=d*y+u*R+f*T+v*M,n[10]=d*w+u*E+f*S+v*O,n[14]=d*x+u*_+f*k+v*F,n[3]=A*m+C*b+p*D+I*L,n[7]=A*y+C*R+p*T+I*M,n[11]=A*w+C*E+p*S+I*O,n[15]=A*x+C*_+p*k+I*F,this},_rounded:function(e,t){return t=Math.pow(10,t||15),Math.round(e*t)/t},_arrayWrap:function(e){return window.Float32Array?new Float32Array(e):e},appendTransform:function(e,t,n,a,o,s,r,l,h,g,c,d,u,f){var v=r*i,A=this._rounded(Math.cos(v)),C=this._rounded(Math.sin(v)),p=l*i,I=this._rounded(Math.cos(p)),m=this._rounded(Math.sin(p)),y=h*i,w=this._rounded(Math.cos(-1*y)),x=this._rounded(Math.sin(-1*y));return this.multiplyMatrices(this,this._arrayWrap([1,0,0,e,0,A,C,t,0,-C,A,n,0,0,0,1])),this.multiplyMatrices(this,this._arrayWrap([I,0,m,0,0,1,0,0,-m,0,I,0,0,0,0,1])),this.multiplyMatrices(this,this._arrayWrap([w*a,x*o,0,0,-x*a,w*o,0,0,0,0,1*s,0,0,0,0,1])),(g||c)&&this.multiplyMatrices(this,this._arrayWrap([this._rounded(Math.cos(g*i)),this._rounded(Math.sin(g*i)),0,0,-1*this._rounded(Math.sin(c*i)),this._rounded(Math.cos(c*i)),0,0,0,0,1,0,0,0,0,1])),(d||u||f)&&(this.elements[12]-=d*this.elements[0]+u*this.elements[4]+f*this.elements[8],this.elements[13]-=d*this.elements[1]+u*this.elements[5]+f*this.elements[9],this.elements[14]-=d*this.elements[2]+u*this.elements[6]+f*this.elements[10]),this}};var s=function(e,t,i,n,a,o){return this.a=null==e?1:e,this.b=t||0,this.c=i||0,this.d=null==n?1:n,this.tx=a||0,this.ty=o||0,this};function r(e,t,i){(0,a.default)(e,t,{get:function(){return this["_"+t]},set:function(e){this["_"+t]=e,i()}})}function l(e,t){if(!e.___mixCSS3Transform){var i,a=["translateX","translateY","translateZ","scaleX","scaleY","scaleZ","rotateX","rotateY","rotateZ","skewX","skewY","originX","originY","originZ"],s=(i=e,"object"===("undefined"===typeof HTMLElement?"undefined":(0,n.default)(HTMLElement))?i instanceof HTMLElement:i&&"object"===("undefined"===typeof i?"undefined":(0,n.default)(i))&&null!==i&&1===i.nodeType&&"string"===typeof i.nodeName);t||a.push("perspective"),e.___mixCSS3Transform=!0,function(e,t,i){for(var n=0,a=t.length;n<a;n++)r(e,t[n],i)}(e,a,function(){var i=e.matrix3d.identity().appendTransform(e.translateX,e.translateY,e.translateZ,e.scaleX,e.scaleY,e.scaleZ,e.rotateX,e.rotateY,e.rotateZ,e.skewX,e.skewY,e.originX,e.originY,e.originZ),n=(t?"":"perspective("+e.perspective+"px) ")+"matrix3d("+Array.prototype.slice.call(i.elements).join(",")+")";s?e.style.transform=e.style.msTransform=e.style.OTransform=e.style.MozTransform=e.style.webkitTransform=n:e.transform=n}),e.matrix3d=new o,t||(e.perspective=500),e.scaleX=e.scaleY=e.scaleZ=1,e.translateX=e.translateY=e.translateZ=e.rotateX=e.rotateY=e.rotateZ=e.skewX=e.skewY=e.originX=e.originY=e.originZ=0}}s.prototype={identity:function(){return this.a=this.d=1,this.b=this.c=this.tx=this.ty=0,this},appendTransform:function(e,t,n,a,o,s,r,l,h){if(o%360)var g=o*i,c=Math.cos(g),d=Math.sin(g);else c=1,d=0;return s||r?(s*=i,r*=i,this.append(Math.cos(r),Math.sin(r),-Math.sin(s),Math.cos(s),e,t),this.append(c*n,d*n,-d*a,c*a,0,0)):this.append(c*n,d*n,-d*a,c*a,e,t),(l||h)&&(this.tx-=l*this.a+h*this.c,this.ty-=l*this.b+h*this.d),this},append:function(e,t,i,n,a,o){var s=this.a,r=this.b,l=this.c,h=this.d;return this.a=e*s+t*l,this.b=e*r+t*h,this.c=i*s+n*l,this.d=i*r+n*h,this.tx=a*s+o*l+this.tx,this.ty=a*r+o*h+this.ty,this},initialize:function(e,t,i,n,a,o){return this.a=e,this.b=t,this.c=i,this.d=n,this.tx=a,this.ty=o,this},setValues:function(e,t,i,n,a,o){return this.a=null==e?1:e,this.b=t||0,this.c=i||0,this.d=null==n?1:n,this.tx=a||0,this.ty=o||0,this},copy:function(e){return this.setValues(e.a,e.b,e.c,e.d,e.tx,e.ty)}},l.getMatrix3D=function(e){var t={translateX:0,translateY:0,translateZ:0,rotateX:0,rotateY:0,rotateZ:0,skewX:0,skewY:0,originX:0,originY:0,originZ:0,scaleX:1,scaleY:1,scaleZ:1};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return(new o).identity().appendTransform(t.translateX,t.translateY,t.translateZ,t.scaleX,t.scaleY,t.scaleZ,t.rotateX,t.rotateY,t.rotateZ,t.skewX,t.skewY,t.originX,t.originY,t.originZ).elements},l.getMatrix2D=function(e){var t={translateX:0,translateY:0,rotation:0,skewX:0,skewY:0,originX:0,originY:0,scaleX:1,scaleY:1};for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return(new s).identity().appendTransform(t.translateX,t.translateY,t.scaleX,t.scaleY,t.rotation,t.skewX,t.skewY,t.originX,t.originY)},"object"===(0,n.default)(t)?e.exports=l:window.Transform=l}()},1202:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i(3)),a=d(i(0)),o=d(i(1)),s=d(i(4)),r=d(i(59)),l=d(i(5)),h=d(i(1203)),g=(d(i(7)),i(245)),c=d(i(8));function d(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.hasMove=!1,i.initMouse(),i.initToolbar(),i}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initMouse",value:function(){var e=this,t=function t(i){window.isRecordPreviewShowing||(e._move(i),e.hasMove=!0,e.clipMode||e.stage.judgeAutoMove(i),e.stage.event.eventMouse.one("mousedragEnd",function(){e.stage.event.eventMouse.remove("mousedrag",t),e.hasMove&&(e._syncPropertiesToData(),e.hasMove=!1),e.stage.stopAutoMove()}))};this.frame.addEventListener("mousedown",function(i){i.preventDefault(),i.stopPropagation(),1===i.which&&(e.stage.event.eventMenu.trigger("tableMenuHide"),e.stage.event.eventMouse.one("mousedrag",t))}),this.frame.addEventListener("dragstart",function(e){e.preventDefault()}),this.frame.addEventListener("dblclick",function(){e.stage.event.eventShape.trigger("imageZoom",e.id)}),this.frame.addEventListener("contextmenu",function(t){(e.clipMode||window.showOfflineData)&&(t.stopPropagation(),t.preventDefault())})}},{key:"_frameMove",value:function(e){var t=e.x,i=e.y;this._move({diffX:t,diffY:i}),this._syncPropertiesToData()}},{key:"initToolbar",value:function(){var e=this,t=document.createElement("div");this.toolbar=t,t.className="frame-image-toolbar",t.style.display="none",this.board.appendChild(t);var i=document.createElement("div");i.className="frame-image-toolbar-btn frame-image-toolbar-btn-crop",i.dataset.tooltip="\u88c1\u526a",i.addEventListener("mousedown",function(e){e.stopPropagation()}),i.addEventListener("click",function(){e.stage.event.eventMenu.trigger("tableMenuHide"),e.clipMode?e._endClip():e._beginClip()}),t.appendChild(i);var n=document.createElement("div");n.className="frame-image-toolbar-btn frame-image-toolbar-btn-reset",n.dataset.tooltip="\u6062\u590d\u539f\u56fe",n.addEventListener("mousedown",function(e){e.stopPropagation()}),n.addEventListener("click",function(){e.stage.event.eventMenu.trigger("tableMenuHide"),e.resetOriginal()}),this.resetBtn=n,t.appendChild(n),(0,g.showTooltip)(".frame-image-toolbar-btn")}},{key:"_show",value:function(e){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_show",this).call(this,e),this.stage.configData.permissions&&(this.toolbar.style.display="block")}},{key:"_beginClip",value:function(){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_beginClip",this).call(this),this.toolbar.className="frame-image-toolbar frame-image-toolbar-cropping";try{c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_size_cut"})}catch(e){}}},{key:"_endClip",value:function(){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_endClip",this).call(this),this.toolbar.className="frame-image-toolbar"}},{key:"_hide",value:function(e){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_hide",this).call(this,e),this.toolbar.style.display="none"}},{key:"_move",value:function(){for(var e,i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];(e=(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_move",this)).call.apply(e,[this].concat(a)),this._movedToReport=!0}},{key:"_change",value:function(){for(var e,i=arguments.length,a=Array(i),o=0;o<i;o++)a[o]=arguments[o];(e=(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_change",this)).call.apply(e,[this].concat(a)),this._resizedToReport=!0}},{key:"_syncPropertiesToData",value:function(){var e=this.stage.tableData.shapes[this.id],i=e.width,a=e.height;if((0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_syncPropertiesToData",this).call(this),this._movedToReport){this._movedToReport=!1;try{c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_move"})}catch(o){}}if(this._resizedToReport){this._resizedToReport=!1;try{c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_zoom"}),i*a<this.width*this.height?c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_zoom_in"}):i*a>this.width*this.height&&c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_zoom_out"})}catch(o){}}}},{key:"isOriginal",value:function(){return!this.originalWidth||!this.originalHeight||this.width===this.originalWidth*this.stage.tableData.scale&&this.height===this.originalHeight*this.stage.tableData.scale&&0===this.clipTop&&0===this.clipLeft&&0===this.clipRight&&0===this.clipBottom}},{key:"resetOriginal",value:function(){if(!this.isOriginal()){this._endClip(),this.width=this.originalWidth*this.stage.tableData.scale,this.height=this.originalHeight*this.stage.tableData.scale,this.clipTop=this.clipLeft=this.clipRight=this.clipBottom=0,this._syncPropertiesToData(),this._syncPropertiesToUI();try{c.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_recovery"})}catch(e){}}}},{key:"_syncPropertiesToUI",value:function(){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"_syncPropertiesToUI",this).call(this),this.toolbar.style.left=Math.max(0,this.left+this.width+10)+"px",this.toolbar.style.top=Math.max(0,this.top)+"px",this.isOriginal()?(this.resetBtn.setAttribute("disabled","disabled"),this.resetBtn.dataset.tooltip=""):(this.resetBtn.removeAttribute("disabled"),this.resetBtn.dataset.tooltip="\u6062\u590d\u539f\u56fe")}}]),t}(h.default);t.default=u},1203:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(14)),a=g(i(0)),o=g(i(1)),s=g(i(1204)),r=i(21),l=i(10),h=(i(284),g(i(12)));function g(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){var i=this;(0,a.default)(this,e),this._selectionShow=function(e){e&&e.show&&i._hide()},this.components={},this.stage=t.stage,this.container=t.container,this.left=0,this.top=0,this.width=0,this.height=0,this.clipTop=0,this.clipLeft=0,this.clipRight=0,this.clipBottom=0,this.initStyle(),this.init(),this.initEvent()}return(0,o.default)(e,[{key:"initStyle",value:function(){i(1206)}},{key:"init",value:function(){var e=this,t=document.createElement("div");t.style.left=this.stage.configData.rowHeadWidth+"px",t.style.top=this.stage.configData.colHeadHeight+"px",t.className="frame-board",this.board=t;var i=document.createElement("div");this.frame=i,i.className="frame-box",i.style.position="relative",t.appendChild(i);var n=document.createElement("div");this.shadowImage=n,n.className="frame-shadow-image",n.style.position="absolute",n.style.display="none",n.style.filter="brightness(0.5)",n.style.backgroundSize="100% 100%",i.appendChild(n);var a=document.createElement("div");this.image=a,a.className="frame-image",a.style.position="absolute",a.style.overflow="hidden",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",i.appendChild(a);var o=document.createElement("div");this.tooltip=o,o.className="sheet-image-scale-info",o.style.display="none",t.appendChild(o),this.container.appendChild(t);["top left","top center","top right","middle left","middle right","bottom left","bottom center","bottom right"].forEach(function(t){e.components[t]=new s.default({stage:e.stage,container:i,className:t,move:function(i){e.tooltip.style.display="block",e._change(t,i)},end:function(){e.tooltip.style.display="none",e._syncPropertiesToData()}})})}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventShape.listen("frameShow",function(t){e._show(t),e.stage.event.eventLink.trigger("linkModifyHide")}),this.stage.event.eventTable.listen("scale",function(){e._scale(),e.stage.event.eventMenu.trigger("tableMenuHide")}),this.stage.configData.permissions&&(this.stage.event.eventShape.listen("frameRemove",function(){e.stage.hookFunc.removeImage&&e.stage.hookFunc.removeImage(e.id),e._hide()}),this.stage.event.eventShape.listen("frameMove",function(t){e._frameMove(t),e.stage.event.eventMenu.trigger("tableMenuHide")}),this.stage.event.eventShape.listen("removeImage",function(){e._hide(),e.stage.selectData.change({})}),this.stage.event.eventTable.listen("reset",function(){e._hide()}),this.stage.event.eventTable.listen("tableMove",function(){null==e.id||void 0==e.id||e.hasMove||(e._syncDataToProperties(),e._syncPropertiesToUI())}),this.stage.event.eventShape.listen("updateImage",function(){null==e.id||e.hasMove||h.default.wait(0).run(function(){e._syncDataToProperties(),e._syncPropertiesToUI()})}),window.__core&&__core.event.spreadsheetEvent.listen("imageClip",function(){e._beginClip()}))}},{key:"_scale",value:function(){this.board.style.left=this.stage.configData.rowHeadWidth+"px",this.board.style.top=this.stage.configData.colHeadHeight+"px",this.stage.event.eventMenu.trigger("tableMenuHide"),this.stage.event.eventShape.trigger("frameHide",this.id)}},{key:"_show",value:function(e){this.id&&this._hide();var t=this.stage.selectData,i=this.stage.tableData.shapes[e];this.frame.style.display="block",this.image.style.backgroundImage="url("+(i.needPlaceholder?r.placeholderImageSrc:i.url)+")",this.shadowImage.style.backgroundImage="url("+(i.needPlaceholder?r.placeholderImageSrc:i.url)+")",this.id=e,this._scrollIntoView(),this._syncDataToProperties(),this._syncPropertiesToUI(),this.frameShow=!0,t.pickShape=e,t.isAnyInScreen=!0,this._hide=this._hide.bind(this),this.stage.event.eventSelection.listen("selectionShow",this._selectionShow),document.addEventListener("mousewheel",this._hide),document.addEventListener("DOMMouseScroll",this._hide),this.stage.hookFunc.pickShape&&this.stage.hookFunc.pickShape(e),this.stage.hookFunc.changeFrameShow&&this.stage.hookFunc.changeFrameShow(),this.stage.event.eventSelection.trigger("selectionTo",{x:i.anchor.col,y:i.anchor.row,show:!1}),this.stage.selectionCenter.onSmartSelection&&this.stage.event.eventSmart.trigger("turnOffSmartSelection")}},{key:"_hide",value:function(){this.stage.selectData.pickShape=null,this.frame.style.display="none",this.frameShow=!1,this.stage.event.eventShape.trigger("frameHide",this.id),this.stage.event.eventMenu.trigger("cellToolbarHide"),this.clipMode&&this.stage.event.eventMouse.trigger("mousedragEnd"),this.id=null,this._endClip(),this.stage.event.eventSelection.remove("selectionShow",this._selectionShow),document.removeEventListener("mousewheel",this._hide),document.removeEventListener("DOMMouseScroll",this._hide),this.stage.hookFunc.changeFrameShow&&this.stage.hookFunc.changeFrameShow()}},{key:"_beginClip",value:function(){this.frame.classList.add("clip"),this.shadowImage.style.display="block",this.clipMode=!0}},{key:"_endClip",value:function(){this.frame.classList.remove("clip"),this.shadowImage.style.display="none",this.clipMode=!1}},{key:"_move",value:function(e){if(!e.auto&&!(Math.abs(e.diffX)<1&&Math.abs(e.diffY)<1)){var t=this.stage.areaData;if(this.clipMode)(e.diffX>0&&this.clipLeft>e.diffX||e.diffX<0&&this.clipRight>-e.diffX)&&(this.clipLeft-=e.diffX,this.clipRight+=e.diffX),(e.diffY>0&&this.clipTop>e.diffY||e.diffY<0&&this.clipBottom>-e.diffY)&&(this.clipTop-=e.diffY,this.clipBottom+=e.diffY),this._syncPropertiesToUI();else{this.left+=e.diffX,this.top+=e.diffY;var i=void 0,n=void 0;i=t.col.frozen.length>0?t.col.frozen.offsetX:t.col.flow.offsetX,n=t.row.frozen.length>0?t.row.frozen.offsetY:t.row.flow.offsetY,this.left<-i&&(this.left=-i),this.top<-n&&(this.top=-n),i=t.col.frozen.offsetX+t.col.flow.offsetX,n=t.row.frozen.offsetY+t.row.flow.offsetY;var a=t.col.frozen.totalWidth+t.col.flow.totalWidth,o=t.row.frozen.totalHeight+t.row.flow.totalHeight;this.left>a&&(this.left=a),this.top>o&&(this.top=o),this._syncPropertiesToUI()}}}},{key:"_change",value:function(e,t){var i=t.diffX,n=t.diffY;if(this.clipMode)/top/.test(e)&&(n<0&&-n>this.clipTop&&(n=-this.clipTop),n<0&&-n>this.top&&(n=-this.top),n>0&&n>this.height-1&&(n=this.height-1),this.clipTop+=n,this.top+=n,this.height-=n),/left/.test(e)&&(i<0&&-i>this.clipLeft&&(i=-this.clipLeft),i<0&&-i>this.left&&(i=-this.left),i>0&&i>this.width-1&&(i=this.width-1),this.clipLeft+=i,this.left+=i,this.width-=i),/right/.test(e)&&(i>0&&i>this.clipRight&&(i=this.clipRight),i<0&&-i>this.width-1&&(i=-(this.width-1)),this.clipRight-=i,this.width+=i),/bottom/.test(e)&&(n>0&&n>this.clipBottom&&(n=this.clipBottom),n<0&&-n>this.height-1&&(n=-(this.height-1)),this.clipBottom-=n,this.height+=n),this._syncPropertiesToUI();else{var a=/left/.test(e),o=/top/.test(e),s=this.top,r=this.left,l=this.width,h=this.height;if(/center/.test(e))o?(n<0&&-n>this.top&&(n=-this.top),this.top+=n,this.height-=n):this.height+=n;else if(/middle/.test(e))a?(i<0&&-i>this.left&&(i=-this.left),this.left+=i,this.width-=i):this.width+=i;else{var g=Math.sqrt(this.width*this.width+this.height*this.height)||1,c=this.width/g*(a?-1:1),d=this.height/g*(o?-1:1),u=i*c+n*d;i=u*c,n=u*d;var f=-this.left,v=-this.top,A=a&&i<0?Math.max(0,Math.min(f/i,1)):1,C=o&&n<0?Math.max(0,Math.min(v/n,1)):1,p=Math.min(A,C);i*=p,n*=p,o?(this.top+=n,this.height-=n):this.height+=n,a?(this.left+=i,this.width-=i):this.width+=i,["top left","top right","bottom right","bottom left"].indexOf(e)>-1&&(this.height<=1||this.width<=1)&&(h>=this.height||l>=this.width)&&(this.top=s,this.left=r,this.height=h,this.width=l)}var I=1-this.width;I>0&&(a&&(this.left-=I),this.width+=I);var m=1-this.height;m>0&&(o&&(this.top-=m),this.height+=m),this.clipTop*=this.height/h,this.clipBottom*=this.height/h,this.clipLeft*=this.width/l,this.clipRight*=this.width/l,this._syncPropertiesToUI()}}},{key:"_scrollIntoView",value:function(){var e=this.stage.areaData,t=this.stage.tableData.shapes[this.id],i=e.globalToViewport(t.left,t.top);i.diffX>0&&(e.areaX=t.areaX,this.stage.tableScroll({areaX:t.areaX,diffX:-i.diffX,type:l.TABLE_SCROLL_MODE.IMMEDIATE})),i.diffY>0&&(e.areaY=t.areaY,this.stage.tableScroll({areaY:t.areaY,diffY:-i.diffY,type:l.TABLE_SCROLL_MODE.IMMEDIATE}))}},{key:"_syncDataToProperties",value:function(){var e=this.stage.areaData,t=this.stage.tableData.shapes[this.id];if(t&&void 0!==t.areaX&&void 0!==t.areaY){var i=e.globalToViewport(t.left,t.top),n=e.col[t.areaX].offsetX,a=e.row[t.areaY].offsetY,o=i.left-this.stage.configData.rowHeadWidth-n,s=i.top-this.stage.configData.colHeadHeight-a;this.top=s,this.left=o,this.width=t.width||0,this.height=t.height||0,this.clipTop=t.clipTop||0,this.clipLeft=t.clipLeft||0,this.clipRight=t.clipRight||0,this.clipBottom=t.clipBottom||0,this.originalWidth=t.originalWidth,this.originalHeight=t.originalHeight}}},{key:"_syncPropertiesToUI",value:function(){this.stage.tableData.shapes[this.id];var e=this.width,t=this.height,i=this.left,n=this.top,a=this.clipLeft,o=this.clipTop,s=this.clipRight,r=this.clipBottom;e=Math.floor(e),t=Math.floor(t),i=Math.floor(i),n=Math.floor(n),a=Math.floor(a),o=Math.floor(o),s=Math.floor(s),r=Math.floor(r),this.frame.style.width=e+"px",this.frame.style.height=t+"px",this.frame.style.left=i+"px",this.frame.style.top=n+"px",this.image.style.backgroundPositionX=-a+"px",this.image.style.backgroundPositionY=-o+"px",this.image.style.backgroundSize=a+e+s+"px "+(o+t+r)+"px",this.shadowImage.style.left=-a+"px",this.shadowImage.style.top=-o+"px",this.shadowImage.style.width=a+e+s+"px",this.shadowImage.style.height=o+t+r+"px",this.tooltip.style.left=Math.max(0,i)+"px",this.tooltip.style.top=n>=40?n-40+"px":n+t+10+"px",this.tooltip.innerText="\u5bbd: "+e+"\u3000\u9ad8: "+t}},{key:"_syncPropertiesToData",value:function(){if(null!=this.id){var e=this.stage.areaData,t=this.stage.tableData,i=this.left+this.stage.configData.rowHeadWidth,a=this.top+this.stage.configData.colHeadHeight,o=e.col.getIndex(i),s=e.row.getIndex(a),r=e.viewportToGlobal(i,a),l=r.left-e.col.getRealGlobalLeft(o),h=r.top-e.row.getRealGlobalTop(s),g=t.shapes[this.id];g.width=this.width,g.height=this.height,g.top=r.top,g.left=r.left,g.anchor={col:o,row:s},g.clipTop=this.clipTop,g.clipLeft=this.clipLeft,g.clipRight=this.clipRight,g.clipBottom=this.clipBottom,g.xIndex=o,g.yIndex=s,r.left>=e.col.frozen.totalWidth+this.stage.configData.rowHeadWidth?g.areaX="flow":g.areaX="frozen",r.top>=e.row.frozen.totalHeight+this.stage.configData.colHeadHeight?g.areaY="flow":g.areaY="frozen";var c={id:g.id,type:g.type,url:g.url,offset:{x:l/t.scale,y:h/t.scale},anchor:{col:o,row:s},size:{width:this.width/t.scale,height:this.height/t.scale},clipInfo:{clipTop:this.clipTop/t.scale,clipLeft:this.clipLeft/t.scale,clipRight:this.clipRight/t.scale,clipBottom:this.clipBottom/t.scale}};(0,n.default)(g,c),console.log("updateImage \u6e32\u67d3\u5c42: ",g,"\u6570\u636e\u5c42: ",c),this.stage.hookFunc.updateImage&&this.stage.hookFunc.updateImage(c),this.stage.event.eventSelection.trigger("selectionTo",{x:g.anchor.col,y:g.anchor.row,show:!1})}}}]),e}();t.default=c},1204:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(3)),a=l(i(0)),o=l(i(1)),s=l(i(4)),r=l(i(5));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.stage.configData.permissions&&i.initMouse(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initMouse",value:function(){var e=this;this.element.addEventListener("mousedown",function(t){t.stopPropagation(),e.stage.event.eventMouse.one("mousedrag",function(t){e._move(t)}),e.stage.event.eventMouse.one("mousedragEnd",function(){e.fnMouseup()})})}},{key:"fnMouseup",value:function(){this._end()}}]),t}(l(i(1205)).default);t.default=h},1205:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this._move=t.move,this._end=t.end,this.init(t)}return(0,a.default)(e,[{key:"init",value:function(e){var t=document.createElement("div"),i=void 0,n=e.styles||{};for(i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t.style[i]=n[i]);this.element=t,t.className="drag-elem "+(e.className||""),this.container.appendChild(t)}}]),e}();t.default=s},1206:function(e,t,i){var n=i(1207);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1207:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".frame-board {\n    position: absolute;\n    top: 0;\n    left: 0;\n    -webkit-transform-origin: left top;\n    transform-origin: left top;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n}\n.frame-box {\n    position: absolute;\n    outline: 1px dashed #0096fd;\n    z-index: 100;\n    display: none;\n    cursor: move;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n    -webkit-user-select: none;\n}\n\n/* \u951a\u70b9\u516c\u7528\u6837\u5f0f */\n.frame-box .drag-elem {\n    width: 10px;\n    height: 10px;\n    border-radius: 50%;\n    background-color: #0096fd;\n    border: 2px solid #fff;\n    box-shadow: 0 0 1px rgba(0, 0, 0, 0.4);\n    position: absolute;\n    -webkit-transform: translate(-50%, -50%);\n    transform: translate(-50%, -50%);\n    z-index: 2;\n}\n\n/* \u951a\u70b9\u4f4d\u7f6e */\n.frame-box .drag-elem.top {\n    top: 0%;\n}\n.frame-box .drag-elem.middle {\n    top: 50%;\n}\n.frame-box .drag-elem.bottom {\n    top: 100%;\n}\n.frame-box .drag-elem.left {\n    left: 0%;\n}\n.frame-box .drag-elem.center {\n    left: 50%;\n}\n.frame-box .drag-elem.right {\n    left: 100%;\n}\n\n/* \u951a\u70b9\u9f20\u6807\u6307\u9488\uff0c\u5f53\u56fe\u7247\u5f88\u5c0f\u65f6\uff0c\u91cd\u53e0\u987a\u5e8f\u662f\u53f3\u4e0b>\u5de6\u4e0a>\u5de6\u4e0b>\u53f3\u4e0a>\u4e0a\u4e0b\u5de6\u53f3 */\n.frame-box .drag-elem.top.left,\n.frame-box .drag-elem.bottom.right {\n    cursor: nwse-resize;\n    z-index: 3;\n}\n.frame-box .drag-elem.top.center,\n.frame-box .drag-elem.bottom.center {\n    cursor: ns-resize;\n    z-index: 1;\n}\n.frame-box .drag-elem.top.right,\n.frame-box .drag-elem.bottom.left {\n    cursor: nesw-resize;\n    z-index: 2;\n}\n.frame-box .drag-elem.middle.left,\n.frame-box .drag-elem.middle.right {\n    cursor: ew-resize;\n    z-index: 1;\n}\n\n/* \u88c1\u526a\u6a21\u5f0f */\n.frame-box.clip {\n    border-color: #fff;\n}\n\n/* \u624b\u673a\u7aef\u88c1\u526a\u6a21\u5f0f\u9690\u85cf\u4e0a\u4e0b\u5de6\u53f3\u56db\u4e2a\u951a\u70b9\uff0c\u8fd9\u91cc\u7c97\u7565\u4e00\u4e9b\uff0c\u76f4\u63a5\u7528\u5a92\u4f53\u67e5\u8be2\u5c31\u591f\u4e86 */\n@media screen and (max-width: 600px) {\n    .frame-box.clip .drag-elem.center,\n    .frame-box.clip .drag-elem.middle {\n        display: none;\n    }\n}\n\n/* \u88c1\u526a\u6846\u7684\u6837\u5f0f */\n.frame-box.clip {\n    outline: 1px solid #fff;\n}\n\n/* \u5982\u4f55\u7528 CSS \u4e94\u6bdb\u7279\u6548\u5b9e\u73b0\u88c1\u526a\u72b6\u6001\u7684\u767d\u8272\u53c2\u8003\u7ebf\uff0c\u8fd9\u79cd\u4e1c\u897f\u4e0d\u9700\u8981 JS\n   \u7528 before + after \u4e24\u4e2a div \u5c31\u53ef\u4ee5\u4e86 */\n.frame-box.clip::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    bottom: 0;\n    left: 33.3%;\n    right: 33.3%;\n    outline: 1px solid #fff;\n    z-index: 1;\n    /* \u9f20\u6807\u7a7f\u900f\uff0c\u5426\u5219\u4e0a\u4e0b\u88c1\u526a\u951a\u70b9\u88ab\u76d6\u4f4f */\n    pointer-events: none;\n}\n\n.frame-box.clip::after {\n    content: '';\n    position: absolute;\n    left: 0;\n    right: 0;\n    top: 33.3%;\n    bottom: 33.3%;\n    outline: 1px solid #fff;\n    z-index: 1;\n    /* \u9f20\u6807\u7a7f\u900f\uff0c\u5426\u5219\u5de6\u53f3\u88c1\u526a\u951a\u70b9\u88ab\u76d6\u4f4f */\n    pointer-events: none;\n}\n\n.frame-box.clip .drag-elem {\n    background: none;\n    border: none;\n    border-radius: none;\n    width: 0;\n    height: 0;\n    overflow: visible;\n    position: absolute;\n}\n\n/* \u5982\u4f55\u7528 CSS \u4e94\u6bdb\u7279\u6548\u5b9e\u73b0\u88c1\u526a\u72b6\u6001\u7684\u56db\u4e2a\u624b\u67c4\n   word \u90a3\u8fb9\u4e00\u4e2a\u624b\u67c4\u5c31\u8981\u56db\u4e2a div \u52a0\u4e00\u4e2a\u5bb9\u5668\uff0c\u5176\u5b9e\u4e5f\u662f before + after \u4e24\u4e2a\u5c31\u591f\u4e86 */\n.frame-box.clip .drag-elem::before {\n    content: '';\n    display: block;\n    width: 18px;\n    height: 4px;\n    position: absolute;\n    left: 0px;\n    top: 0px;\n    background: #000;\n    border-right: 2px solid #fff;\n    border-bottom: 2px solid #fff;\n}\n\n.frame-box.clip .drag-elem::after {\n    content: '';\n    display: block;\n    width: 4px;\n    /* \u9ad8\u5ea6\u5c114px\uff0c\u9876\u90e8\u5f80\u4e0b\u4e324px\uff0c\u5426\u5219\u767d\u8272\u9634\u5f71\u4f1a\u6321\u4f4f\u53e6\u4e00\u6761\u817f */\n    height: 14px;\n    position: absolute;\n    left: 0px;\n    top: 4px;\n    background: #000;\n    border-right: 2px solid #fff;\n    border-bottom: 2px solid #fff;\n}\n\n/* \u5b9a\u4e49\u4e86\u5de6\u4e0a\u89d2\uff0c\u5176\u4ed6\u4e09\u4e2a\u89d2\u53ea\u8981\u65cb\u8f6c\u4e00\u4e0b\u5373\u53ef */\n.frame-box.clip .drag-elem.top.right {\n    -webkit-transform: scale(-1, 1);\n    transform: scale(-1, 1);\n}\n\n.frame-box.clip .drag-elem.bottom.left {\n    -webkit-transform: scale(1, -1);\n    transform: scale(1, -1);\n}\n\n/* \u5176\u4e2d\u53f3\u4e0b\u89d2\u8fd9\u4e2a\u65cb\u8f6c 180 \u5ea6\u7684\u60c5\u51b5\uff0c\u540c\u6837\u9002\u7528\u4e8e\u4e2d\u4e0b\u548c\u4e2d\u53f3\u4e24\u4e2a */\n.frame-box.clip .drag-elem.bottom.right,\n.frame-box.clip .drag-elem.middle.right,\n.frame-box.clip .drag-elem.bottom.center {\n    -webkit-transform: scale(-1);\n    transform: scale(-1);\n}\n\n/* \b\u4e2d\u4e0a\u548c\u4e2d\u4e0b\u4e24\u4e2a\uff0c\u53bb\u6389\u7ad6\u7684\uff0c\u5de6\u53f3\u5c45\u4e2d */\n.frame-box.clip .drag-elem.center::before {\n    left: -11px;\n    border-left: 2px solid #fff;\n}\n\n.frame-box.clip .drag-elem.center::after {\n    display: none;\n}\n\n/* \b\u4e2d\u5de6\u548c\u4e2d\u53f3\u4e24\u4e2a\uff0c\u53bb\u6389\u6a2a\u7684\uff0c\u4e0a\u4e0b\u5c45\u4e2d */\n.frame-box.clip .drag-elem.middle::before {\n    display: none;\n}\n\n.frame-box.clip .drag-elem.middle::after {\n    height: 18px;\n    top: -11px;\n    border-top: 2px solid #fff;\n}\n\n/* \u8c03\u6574\u5927\u5c0f\u65f6\uff0c\u663e\u793a\u5bbd\u9ad8\u5c3a\u5bf8\u7684\u63d0\u793a\u6846 */\n.sheet-image-scale-info {\n    position: absolute;\n    background-color: black;\n    width: auto;\n    z-index: 999;\n    height: 30px;\n    line-height: 30px;\n    color: #ffffff;\n    padding-left: 12px;\n    padding-right: 12px;\n    font-size: 14px;\n    text-align: center;\n    opacity: 0.75;\n    border-radius: 2px;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n\n/* PC \u7aef\u88c1\u526a & \u6062\u590d\u539f\u56fe\u5de5\u5177\u680f */\n.frame-image-toolbar {\n    position: absolute;\n    background: #fff;\n    width: 40px;\n    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2);\n    border-radius: 2px;\n    border: 1px solid #eee;\n    display: flex;\n    flex-direction: column;\n    z-index: 998;\n}\n\n.frame-image-toolbar-btn {\n    width: 100%;\n    height: 40px;\n    cursor: pointer;\n    box-sizing: border-box;\n    background-color: #fff;\n    background-size: 14px 14px;\n    background-position: center;\n    background-repeat: no-repeat;\n    border-radius: 1px;\n    border-bottom: 1px solid #eee;\n}\n\n.frame-image-toolbar-btn:not([disabled]):hover {\n    background-color: #f0f0f0;\n}\n\n.frame-image-toolbar-btn:not([disabled]):active {\n    -webkit-filter: brightness(0.9);\n    filter: brightness(0.9);\n}\n\n.frame-image-toolbar-btn[disabled] {\n    opacity: 0.3;\n    cursor: default;\n}\n\n.frame-image-toolbar-btn:last-of-type {\n    border-bottom: 0 none;\n}\n\n.frame-image-toolbar-btn.frame-image-toolbar-btn-crop {\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAHxJREFUSA1jYMAE/4FCIEwTwEQTU/EYOvwtZAH6nlB8EZLHE4BgKUZkBXQPUmTLYWxqpVKs5tDdh6MWwuKVavRokFItKGEGjQYpLCSoRo8GKdWCEmYQqD6kFUCpB2GW0D0OsbmC0hoe5hmsNN19iNUVVBIcrfGpFJAEjAEA+GsLLcMTmbQAAAAASUVORK5CYII=');\n}\n\n.frame-image-toolbar-cropping .frame-image-toolbar-btn.frame-image-toolbar-btn-crop {\n    background-color: #388cf5;\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAQ5JREFUSA3tVlEOwiAMHcolTJbsKF7DI3oNb6LJkp3CzL6FNg8SnBLGF00aipT34Kktw0C2rusk/gw+0VK18FQN6Ueg5oQeMtLhRonP4m98JmuIL+IYSww4i3NuwwOAF38gCKYEc5iD7C6Og5QYcG7iircRlgDt7dGDIy9SBze80m7cBDdSWyTACaNNuvhlTHEs1Yu+L53Jd4bQ9A7amxyatzemOJzf/FfaCVn+KnGXtIqMDNIlZTWqxM0lRfE+wlCPtQZbbQbRUYTaZcCB2CxHiHY0hqpvyYVBhJMj1E4fyVFIGG1LCVn7KPHPCXd8SGoHdwxU4dGkcNzx82+a0g6vLDomHX/mV0Xz/2Fzwg8mA0iydRQaTgAAAABJRU5ErkJggg==');\n}\n\n.frame-image-toolbar-btn.frame-image-toolbar-btn-reset {\n    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAYAAAByDd+UAAAABGdBTUEAALGPC/xhBQAAAhFJREFUSA29ls1LVFEYhx0VUVICN6lRIIEgBCG0VUncVItcuEzatGjdP9CmrQtBCFq1aOdKSBIEFUJ0JUTQByQo9gGSVERQVtTzTPPqzDCO9zpz/cFzz7n3vh/3fNxzTq4hmQYwG4NBOAs90AS7sAGr8ARWoCaN4/0a/ibkDXYTkINU6sXar45E29Sn4Sr0QTu0wTm4BpPwBcJ+jXo3JNIwVp9A5/dwG+y+o9SBwV14B/puwUWoKpPtgQ6zYJC06sRhGYzxFUagH2agRHZjtGyKemPJ23Q3LZg/ApP+gF+wCSWKMbNltSQzqENwB36CSWUd9uVs9KFjdpxu3A9E5Qo8h0gU5QuNoiX3vUH34Fu+dvyL3VkpxtsIOUDFr3DqJ5mN4XdU6WRZgmjhAx1soSuIcuz+5Gv1uSwSxu4dggXYhbx84Vf4U2epUwa3ha6NyjUxS32P4A6wLXS5ylwxSzNPFAlM+KFw45aTuUzoz64u/C+yvZrwWSHF9WxTHUTP6sc/yFChFru6e9+JqJ6Ld/EHuxGcLn5QXK/n9mTcZpgH1+iKO389N2ByNDwEF5SPcB4qapintR4xzhBjDkzmcnYZqsqkcdRIc4hqxe8W7IDJLEchkezeGFOdHYfyY6KT4RLcKLz7TKmtPIUuSC1nb/wyEaxauYL9TcgdlunQF2UOLg7lR/3fPNss8IryMbyEqvoHrw+PHbptiC0AAAAASUVORK5CYII=');\n}\n\n/* \u79fb\u52a8\u7aef\u88c1\u526a\u7f29\u653e\u5de5\u5177\u680f */\n.frame-clip-slider-bar {\n    position: absolute;\n    width: 80vw;\n    max-width: 420px;\n    background: #000;\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    z-index: 999;\n}\n\n.frame-clip-slider-bar .frame-clip-slider-bar-title {\n    color: #fff;\n    font-size: 14px;\n    padding: 0 16px;\n}\n\n.frame-clip-slider-bar .frame-clip-slider-track {\n    flex: 1 1 auto;\n    height: 2px;\n    background: #fff;\n    border-radius: 2px;\n    margin: 0 16px 0 8px;\n}\n\n.frame-clip-slider-bar .drag-elem.frame-clip-slider-knob {\n    width: 16px;\n    height: 16px;\n    margin-top: -7px;\n    margin-left: -7px;\n    background: #fff;\n    position: absolute;\n    border-radius: 16px;\n    z-index: 100006;\n    outline: 1px solid rgba(0, 0, 0, 0.2);\n}\n\n.frame-clip-slider-bar .frame-clip-slider-bar-finish-btn {\n    padding: 8px 16px;\n    background: #0188fb;\n    color: #fff;\n    font-size: 14px;\n}\n\n.frame-clip-slider-bar .frame-clip-slider-bar-finish-btn:active {\n    -webkit-filter: brightness(0.9);\n    filter: brightness(0.9);\n}\n",""])},1208:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(3)),a=h(i(0)),o=h(i(1)),s=h(i(4)),r=h(i(59)),l=h(i(5));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initEvent",value:function(){var e=this;(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initEvent",this).call(this),this.stage.event.eventDimension.listen("dragRowColStart",function(){e.topLeft.selection.selectarea.classList.add("drag-rowcol"),e.topRight.selection.selectarea.classList.add("drag-rowcol"),e.bottomLeft.selection.selectarea.classList.add("drag-rowcol"),e.bottomRight.selection.selectarea.classList.add("drag-rowcol")}),this.stage.event.eventDimension.listen("dragRowColEnd",function(){e.topLeft.selection.selectarea.classList.remove("drag-rowcol"),e.topRight.selection.selectarea.classList.remove("drag-rowcol"),e.bottomLeft.selection.selectarea.classList.remove("drag-rowcol"),e.bottomRight.selection.selectarea.classList.remove("drag-rowcol")})}}]),t}(h(i(1209)).default);t.default=g},1209:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i(1210)),a=d(i(14)),o=d(i(24)),s=d(i(0)),r=d(i(1)),l=i(284),h=d(i(1213)),g=i(21),c=i(10);function d(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,s.default)(this,e),f.call(this),this.stage=t.stage,this.containers=t.containers,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.initEvent(),this.init()}return(0,r.default)(e,[{key:"init",value:function(){this._generate("topLeft"),this._generate("topRight"),this._generate("bottomLeft"),this._generate("bottomRight")}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventSelection.listen("selectionShow",function(t){if(!t||t.show)switch(e.stage.selectData.selectStatus){case c.SELECT_STATUS.NORMAL:e._showActivation(),e._showSelection();break;case c.SELECT_STATUS.FORMULA:e._showFormulaSelection(t);break;default:console.error("unknown selection status")}}),this.stage.event.eventSelection.listen("selectionHide",this._hideSelection),this.stage.event.eventTable.listen("enterInputStatus",function(){e.stage.inputCenter.board.isInCrossSheetFormulaEditingMode()||e.stage.event.eventSelection.trigger("selectionHide",{type:c.SELECT_HIDE_TYPE.INPUT})}),this.stage.event.eventShape.listen("frameShow",function(){e.stage.event.eventSelection.trigger("selectionHide",{type:c.SELECT_HIDE_TYPE.IMAGE_FOCUS})}),this.stage.event.eventSelection.listen("selectionTo",this._toSelection),this.stage.event.eventSelection.listen("selectionMove",this._selectionMove),this.stage.event.eventTable.listen("scale",this._updatePosition),this.stage.event.eventTable.listen("clearTable",function(){e.topLeft.move(),e.topRight.move(),e.bottomLeft.move(),e.bottomRight.move()}),this.stage.event.eventDimension.listen("updateFrozenCol",this._updatePosition),this.stage.event.eventDimension.listen("updateFrozenRow",this._updatePosition),this.stage.event.eventTable.listen("reset",this._updatePosition),this.stage.event.eventFormula.listen("leaveFormula",this._hideFormulaSelection),this.stage.event.eventDimension.listen("setColWidth",this._setColWidth),this.stage.event.eventDimension.listen("setRowHeight",this._setRowHeight),this.stage.event.eventDimension.listen("addCol",this._addCol),this.stage.event.eventDimension.listen("addRow",this._addRow),this.stage.event.eventDimension.listen("hideCol",this._hideCol),this.stage.event.eventDimension.listen("hideRow",this._hideRow),this.stage.event.eventFilter.listen("hideFilterRow",this._hideFilterRow),this.stage.event.eventDimension.listen("showCol",this._showCol),this.stage.event.eventFilter.listen("showFilterRow",this._showRow),this.stage.event.eventDimension.listen("showRow",this._showRow),this.stage.event.eventDimension.listen("removeCol",this._removeCol),this.stage.event.eventDimension.listen("removeRow",this._removeRow),this.stage.event.eventDimension.listen("updateFrozenCol",this._updateFrozenCol),this.stage.event.eventDimension.listen("updateFrozenRow",this._updateFrozenRow),this.stage.event.eventCell.listen("mergeCell",this._mergeCell),this.stage.event.eventCell.listen("splitCell",this._splitCell)}},{key:"_showActivation",value:function(){var e=this.stage.selectData,t=this.stage.tableData;e.active.xIndex<0||e.active.yIndex<0||2===t.tableStatus&&(this.topLeft.showActivation(),this.topRight.showActivation(),this.bottomLeft.showActivation(),this.bottomRight.showActivation(),this.stage.hookFunc._changeActivation())}},{key:"_showSelection",value:function(){2===this.stage.tableData.tableStatus&&(this.topLeft.showSelection(),this.topRight.showSelection(),this.bottomLeft.showSelection(),this.bottomRight.showSelection(),this.stage.hookFunc._changeSelection())}},{key:"_showFormulaSelection",value:function(e){this.topLeft.showFormulaSelection(),this.topRight.showFormulaSelection(),this.bottomLeft.showFormulaSelection(),this.bottomRight.showFormulaSelection(),this.stage.hookFunc._changeSelection(e)}},{key:"_showPoint",value:function(){this.topLeft.showPoint(),this.topRight.showPoint(),this.bottomLeft.showPoint(),this.bottomRight.showPoint()}},{key:"_hidePoint",value:function(){this.topLeft.hidePoint(),this.topRight.hidePoint(),this.bottomLeft.hidePoint(),this.bottomRight.hidePoint()}},{key:"_selectionMoveContinuousAndFinal",value:function(e){var t=this.stage.selectData,i=e.x,n=e.y,a=t.select,o=t.active,s=o.xIndex,r=o.yIndex,h={xRange:[a.xRange[0],a.xRange[1]],yRange:[a.yRange[0],a.yRange[1]],selectRow:a.selectRow,selectCol:a.selectCol,selectAll:a.selectAll},g=this.stage.getRowCount()-1,d=this.stage.getColCount()-1;i>0?(h.xRange[0]=s,h.xRange[1]=d):i<0&&(h.xRange[0]=0,h.xRange[1]=s),n>0?(h.yRange[0]=r,h.yRange[1]=g):n<0&&(h.yRange[0]=0,h.yRange[1]=r),(0,l.aroundEdges)(this.stage.tableData,h,!1),h=this._calcSelect(h),this.stage.makeCellVisiable(s,r),t.change({select:h,type:c.SELECT_SHOW_TYPE.SELECT,show:e.show})}},{key:"_extendSelectionLR",value:function(e,t,i){var n={xRange:[].concat((0,o.default)(e.xRange)),yRange:[].concat((0,o.default)(e.yRange))},a=this.stage.getColCount()-1,s=this.stage.selectData.active;if("L"===i){if(n.xRange[0]=Math.max(0,n.xRange[0]+t),(0,l.aroundEdges)(this.stage.tableData,n,!(t<0)),n.xRange[0]<0||n.xRange[1]<0||n.xRange[0]>n.xRange[1])return this._extendSelectionLR(e,t,"R");this.stage.makeCellVisiable(n.xRange[0],s.yIndex)}else{if(n.xRange[1]=Math.min(a,n.xRange[1]+t),(0,l.aroundEdges)(this.stage.tableData,n,!(t>0)),n.xRange[0]<0||n.xRange[1]<0||n.xRange[0]>n.xRange[1])return this._extendSelectionLR(e,t,"L");this.stage.makeCellVisiable(n.xRange[1],s.yIndex)}return n}},{key:"_extendSelectionTB",value:function(e,t,i){var n={xRange:[].concat((0,o.default)(e.xRange)),yRange:[].concat((0,o.default)(e.yRange))},a=this.stage.getRowCount()-1,s=this.stage.selectData.active;if("T"===i){if(n.yRange[0]=Math.max(0,n.yRange[0]+t),(0,l.aroundEdges)(this.stage.tableData,n,!(t<0)),n.yRange[0]<0||n.yRange[1]<0||n.yRange[0]>n.yRange[1])return this._extendSelectionTB(e,t,"B");this.stage.makeCellVisiable(s.xIndex,n.yRange[0])}else{if(n.yRange[1]=Math.min(a,n.yRange[1]+t),(0,l.aroundEdges)(this.stage.tableData,n,!(t>0)),n.yRange[0]<0||n.yRange[1]<0||n.yRange[0]>n.yRange[1])return this._extendSelectionTB(e,t,"T");this.stage.makeCellVisiable(s.xIndex,n.yRange[1])}return n}},{key:"_calcSelect",value:function(e,t){t||(t=e);var i=this.stage.getRowCount()-1,n=this.stage.getColCount()-1,o=!1,s=!1,r=!1;0===t.xRange[0]&&t.xRange[1]===n&&(o=!0),0===t.yRange[0]&&t.yRange[1]===i&&(s=!0),o&&s&&(r=!0,o=s=!1);var l={};return(0,a.default)(l,e,t,{selectRow:o,selectCol:s,selectAll:r}),l}},{key:"_selectionMoveContinuous",value:function(e){var t=this.stage.selectData,i=e.x,n=e.y,a=t.select,o=t.active,s=o.xIndex,r=o.yIndex,h={xRange:[a.xRange[0],a.xRange[1]],yRange:[a.yRange[0],a.yRange[1]],selectRow:a.selectRow,selectCol:a.selectCol,selectAll:a.selectAll},g=this.stage.getRowCount()-1,d=this.stage.getColCount()-1;if(i>0||i<0){for(var u=!1,f=a.yRange[0];f<=a.yRange[1];f++){var v=this.stage.tableData.getCellDataAtPosition(f,a.xRange[0]);if(v&&(v.merge||v.merged)){u=!0;break}}for(var A=a.yRange[0];A<=a.yRange[1];A++){var C=this.stage.tableData.getCellDataAtPosition(A,a.xRange[1]);if(C&&(C.merge||C.merged)){!0;break}}var p=null;o.xRange[0]===a.xRange[0]&&o.xRange[1]===a.xRange[1]?(i<0?h.xRange[0]=Math.max(0,h.xRange[0]+i):i>0&&(h.xRange[1]=Math.min(d,h.xRange[1]+i)),(0,l.aroundEdges)(this.stage.tableData,h,!1),this.stage.makeCellVisiable(i<0?h.xRange[0]:h.xRange[1],r)):p=o.xRange[0]===a.xRange[0]&&o.xRange[1]<a.xRange[1]?this._extendSelectionLR({xRange:h.xRange,yRange:h.yRange},i,"R"):o.xRange[0]>a.xRange[0]&&o.xRange[1]===a.xRange[1]?this._extendSelectionLR({xRange:h.xRange,yRange:h.yRange},i,"L"):u?this._extendSelectionLR({xRange:h.xRange,yRange:h.yRange},i,"R"):this._extendSelectionLR({xRange:h.xRange,yRange:h.yRange},i,"L"),h=this._calcSelect(h,p)}if(n<0||n>0){for(var I=!1,m=a.xRange[0];m<=a.xRange[1];m++){var y=this.stage.tableData.getCellDataAtPosition(a.yRange[0],m);if(y&&(y.merge||y.merged)){I=!0;break}}for(var w=a.xRange[0];w<=a.xRange[1];w++){var x=this.stage.tableData.getCellDataAtPosition(a.yRange[1],w);if(x&&(x.merge||x.merged)){!0;break}}var b=null;o.yRange[0]===a.yRange[0]&&o.yRange[1]===a.yRange[1]?(n<0?h.yRange[0]=Math.max(0,h.yRange[0]+n):n>0&&(h.yRange[1]=Math.min(g,h.yRange[1]+n)),(0,l.aroundEdges)(this.stage.tableData,h,!1),this.stage.makeCellVisiable(s,n<0?h.yRange[0]:h.yRange[1])):b=o.yRange[0]===a.yRange[0]&&o.yRange[1]<a.yRange[1]?this._extendSelectionTB({xRange:h.xRange,yRange:h.yRange},n,"B"):o.yRange[0]>a.yRange[0]&&o.yRange[1]===a.yRange[1]?this._extendSelectionTB({xRange:h.xRange,yRange:h.yRange},n,"T"):I?this._extendSelectionTB({xRange:h.xRange,yRange:h.yRange},n,"B"):this._extendSelectionTB({xRange:h.xRange,yRange:h.yRange},n,"T"),h=this._calcSelect(h,b)}t.change({select:h,type:c.SELECT_SHOW_TYPE.SELECT,show:e.show})}},{key:"_selectionMoveSingle",value:function(e){var t,i=this.stage.tableData,n=this.stage.selectData,a=e.x,o=e.y,s=n.active.xIndex,r=n.active.yIndex;if(t=i.getCellDataAtPosition(r,s,c.GET_CELLDATA.DEFAULT),a>0)if(e.final)s=i.col.length-1;else for(t.parent&&(s=t.mergeData.xRange[1]);s+=a,!(0,g.isColShow)(i,s););else if(a<0)if(e.final)s=0;else for(t.parent&&(s=t.mergeData.xRange[0]);s+=a,!(0,g.isColShow)(i,s););if(o>0)if(e.final)r=i.row.length-1;else for(t.parent&&(r=t.mergeData.yRange[1]);r+=o,!(0,g.isRowShow)(i,r););else if(o<0)if(e.final)r=0;else for(t.parent&&(r=t.mergeData.yRange[0]);r+=o,!(0,g.isRowShow)(i,r););s<0||s>=i.col.length||r<0||r>=i.row.length||(this._toSelection({x:s,y:r,type:c.SELECT_SHOW_TYPE.SELECT,show:e.show}),this.stage.makeCellVisiable(s,r))}},{key:"_generate",value:function(e){var t=this.stage.areaData,i=this.stage.configData.rowHeadWidth+1,a=this.stage.configData.colHeadHeight+1;switch(e){case"topLeft":this.topLeft=new h.default({container:this.containers[0].visiable,name:e,stage:this.stage,areaX:c.TABLE_AREA.FROZEN,areaY:c.TABLE_AREA.FROZEN}),this.topLeft.startX=t.col.frozen.start,this.topLeft.endX=t.col.frozen.length-1,this.topLeft.startY=t.row.frozen.start,this.topLeft.endY=t.row.frozen.length-1,this.topLeft.distanceX=i,this.topLeft.distanceY=a;break;case"topRight":this.topRight=new h.default({container:this.containers[1].visiable,name:e,stage:this.stage,areaX:c.TABLE_AREA.FLOW,areaY:c.TABLE_AREA.FROZEN}),this.topRight.startX=t.col.flow.start,this.topRight.endX=n.default,this.topRight.startY=t.row.frozen.start,this.topRight.endY=t.row.frozen.length-1,this.topRight.distanceX=t.col.flow.viewStart+(t.col.frozen.length>0?0:2),this.topRight.distanceY=a;break;case"bottomLeft":this.bottomLeft=new h.default({container:this.containers[2].visiable,name:e,stage:this.stage,areaX:c.TABLE_AREA.FROZEN,areaY:c.TABLE_AREA.FLOW}),this.bottomLeft.startX=t.col.frozen.start,this.bottomLeft.endX=t.col.frozen.length-1,this.bottomLeft.startY=t.row.flow.start,this.bottomLeft.endY=n.default,this.bottomLeft.distanceX=i,this.bottomLeft.distanceY=t.row.flow.viewStart+(t.row.frozen.length>0?0:2);break;case"bottomRight":this.bottomRight=new h.default({container:this.containers[3].visiable,name:e,stage:this.stage,areaX:c.TABLE_AREA.FLOW,areaY:c.TABLE_AREA.FLOW}),this.bottomRight.startX=t.col.frozen.length,this.bottomRight.endX=n.default,this.bottomRight.startY=t.row.frozen.length,this.bottomRight.endY=n.default,this.bottomRight.distanceX=t.col.flow.viewStart+(t.col.frozen.length>0?0:2),this.bottomRight.distanceY=t.row.flow.viewStart+(t.row.frozen.length>0?0:2)}}},{key:"isShowWithFormulaSelection",value:function(){return 2===this.stage.tableData.tableStatus||3===this.stage.tableData.tableStatus&&this.stage.selectData.selectStatus===c.SELECT_STATUS.FORMULA}}]),e}(),f=function(){var e=this;this._updatePosition=function(){var t=e.stage.areaData,i=e.stage.configData.rowHeadWidth+1,a=e.stage.configData.colHeadHeight+1;e.topLeft.startX=t.col.frozen.start,e.topLeft.endX=t.col.frozen.length-1,e.topLeft.startY=t.row.frozen.start,e.topLeft.endY=t.row.frozen.length-1,e.topLeft.distanceX=i,e.topLeft.distanceY=a,e.topRight.startX=t.col.flow.start,e.topRight.endX=n.default,e.topRight.startY=t.row.frozen.start,e.topRight.endY=t.row.frozen.length-1,e.topRight.distanceX=t.col.flow.viewStart+(t.col.frozen.length>0?0:2),e.topRight.distanceY=a,e.bottomLeft.startX=t.col.frozen.start,e.bottomLeft.endX=t.col.frozen.length-1,e.bottomLeft.startY=t.row.flow.start,e.bottomLeft.endY=n.default,e.bottomLeft.distanceX=i,e.bottomLeft.distanceY=t.row.flow.viewStart+(t.row.frozen.length>0?0:2),e.bottomRight.startX=t.col.flow.start,e.bottomRight.endX=n.default,e.bottomRight.startY=t.row.flow.start,e.bottomRight.endY=n.default,e.bottomRight.distanceX=t.col.flow.viewStart+(t.col.frozen.length>0?0:2),e.bottomRight.distanceY=t.row.flow.viewStart+(t.row.frozen.length>0?0:2)},this._hideSelection=function(t){e.topLeft.hideSelection(t),e.topRight.hideSelection(t),e.bottomLeft.hideSelection(t),e.bottomRight.hideSelection(t)},this._hideFormulaSelection=function(){e.topLeft.hideFormulaSelection(),e.topRight.hideFormulaSelection(),e.bottomLeft.hideFormulaSelection(),e.bottomRight.hideFormulaSelection()},this._selectionMove=function(t){t.continuous?t.final?e._selectionMoveContinuousAndFinal(t):e._selectionMoveContinuous(t):e._selectionMoveSingle(t)},this._toSelection=function(t){var i,n,a=e.stage.tableData,o=e.stage.selectData,s=t.x,r=t.y,h={xRange:[],yRange:[]};(i=a.getCellDataAtPosition(r,s,c.GET_CELLDATA.DEFAULT)).parent?(h.xRange[0]=i.parent.mergeData.xRange[0],h.xRange[1]=i.parent.mergeData.xRange[1],h.yRange[0]=i.parent.mergeData.yRange[0],h.yRange[1]=i.parent.mergeData.yRange[1]):(h.xRange[0]=h.xRange[1]=s,h.yRange[0]=h.yRange[1]=r),(0,l.filterHide)(a,h,{sideShow:!0,xDir:1,yDir:1}),(0,l.aroundEdges)(e.stage.tableData,h),n={xIndex:h.xRange[0],yIndex:h.yRange[0]},o.change({active:n,select:h,type:t.type,show:t.show});var g=(e.stage.tableData.getCellDataAtPosition(n.yIndex,n.xIndex)||{}).text;e.stage.inputCenter.board.setAriaInfo&&e.stage.inputCenter.board.setAriaInfo(n.xIndex,n.yIndex,g)},this._setColWidth=function(t){var i=e.stage.selectData,n=t.index,a=e.isShowWithFormulaSelection();n<=i.select.xRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._setRowHeight=function(t){var i=e.stage.selectData,n=t.index,a=e.isShowWithFormulaSelection();n<=i.select.yRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._addCol=function(t){e._updatePosition();var i=e.stage.selectData,n=t.index,a=t.amount,o=2===e.stage.tableData.tableStatus,s=[i.select.xRange[0],i.select.xRange[1]],r=[i.active.xIndex,i.active.xIndex];(0,g.rangeInsert)(s,n,a),(0,g.rangeInsert)(r,n,a);var l={xRange:[s[0],s[1]],yRange:[i.select.yRange[0],i.select.yRange[1]],selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll},h={xIndex:r[0],yIndex:i.active.yIndex};i.change({select:l,active:h,type:c.SELECT_SHOW_TYPE.DIMENSION,show:o})},this._addRow=function(t){e._updatePosition();var i=e.stage.selectData,n=t.index,a=t.amount,o=2===e.stage.tableData.tableStatus,s=[i.select.yRange[0],i.select.yRange[1]],r=[i.active.yIndex,i.active.yIndex];(0,g.rangeInsert)(s,n,a),(0,g.rangeInsert)(r,n,a);var l={xRange:[i.select.xRange[0],i.select.xRange[1]],yRange:[s[0],s[1]],selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll},h={xIndex:i.active.xIndex,yIndex:r[0]};i.change({select:l,active:h,type:c.SELECT_SHOW_TYPE.DIMENSION,show:o})},this._removeCol=function(t){e._updatePosition();var i=e.stage.selectData,n=t.range,a=n[0],o=n[1]-a+1,s=2===e.stage.tableData.tableStatus,r=[i.select.xRange[0],i.select.xRange[1]],l=[i.active.xIndex,i.active.xIndex];(0,g.rangeDelete)(r,a,o),(0,g.rangeDelete)(l,a,o);var h=r;h[0]>h[1]&&(h[1]=h[0]+o-1);var d=e.stage.tableData.col.length-1;h[0]=Math.min(h[0],d),h[1]=Math.min(h[1],d);var u={xRange:h,yRange:[i.select.yRange[0],i.select.yRange[1]],selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll},f={xIndex:Math.min(d,l[0]),yIndex:i.active.yIndex};i.change({select:u,active:f,type:c.SELECT_SHOW_TYPE.DIMENSION,show:s})},this._removeRow=function(t){e._updatePosition();var i=e.stage.selectData,n=t.range,a=n[0],o=n[1]-a+1,s=2===e.stage.tableData.tableStatus,r=[i.select.yRange[0],i.select.yRange[1]],l=[i.active.yIndex,i.active.yIndex];(0,g.rangeDelete)(r,a,o),(0,g.rangeDelete)(l,a,o);var h=r;h[0]>h[1]&&(h[1]=h[0]+o-1);var d=e.stage.tableData.row.length-1;h[0]=Math.min(h[0],d),h[1]=Math.min(h[1],d);var u={xRange:[i.select.xRange[0],i.select.xRange[1]],yRange:h,selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll},f={xIndex:i.active.xIndex,yIndex:Math.min(l[0],d)};i.change({select:u,active:f,type:c.SELECT_SHOW_TYPE.DIMENSION,show:s})},this._showCol=function(t){var i=e.stage.selectData,n=t.range,a=e.isShowWithFormulaSelection();n[0]<=i.select.xRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._showRow=function(t){var i=e.stage.selectData,n=t.range,a=e.isShowWithFormulaSelection();n[0]<=i.select.yRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._hideCol=function(t){var i=e.stage.selectData,n=t.range,a=e.isShowWithFormulaSelection();n[0]<=i.select.xRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._hideRow=function(t){var i=e.stage.selectData,n=t.range,a=e.isShowWithFormulaSelection();n[0]<=i.select.yRange[1]&&i.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._hideFilterRow=function(){var t,i=e.stage.tableData,n=e.stage.selectData,a=2===e.stage.tableData.tableStatus,o={xRange:[n.select.xRange[0],n.select.xRange[1]],yRange:[n.select.yRange[0],n.select.yRange[1]]};(0,l.filterHide)(i,o,{sideShow:!0,xDir:1,yDir:1}),(0,l.aroundEdges)(e.stage.tableData,o),t={xIndex:o.xRange[0],yIndex:o.yRange[0]},n.change({active:t,select:o,type:c.SELECT_SHOW_TYPE.DIMENSION,show:a})},this._updateFrozenCol=function(){var t=2===e.stage.tableData.tableStatus;e.stage.selectData.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:t})},this._updateFrozenRow=function(){var t=2===e.stage.tableData.tableStatus;e.stage.selectData.change({type:c.SELECT_SHOW_TYPE.DIMENSION,show:t})},this._mergeCell=function(){var t,i=e.stage.selectData,n=2===e.stage.tableData.tableStatus,a={xRange:[i.select.xRange[0],i.select.xRange[1]],yRange:[i.select.yRange[0],i.select.yRange[1]],selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll};i.select.selectRow||i.select.selectCol||(0,l.aroundEdges)(e.stage.tableData,a),t={xIndex:a.xRange[0],yIndex:a.yRange[0]},i.change({active:t,select:a,type:c.SELECT_SHOW_TYPE.DIMENSION,show:n})},this._splitCell=function(){var t,i=e.stage.selectData,n=2===e.stage.tableData.tableStatus,a={xRange:[i.select.xRange[0],i.select.xRange[1]],yRange:[i.select.yRange[0],i.select.yRange[1]],selectRow:i.select.selectRow,selectCol:i.select.selectCol,selectAll:i.select.selectAll};i.select.selectRow||i.select.selectCol||(0,l.aroundEdges)(e.stage.tableData,a),t={xIndex:a.xRange[0],yIndex:a.yRange[0]},i.change({active:t,select:a,type:c.SELECT_SHOW_TYPE.DIMENSION,show:n})}};t.default=u},1213:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(3)),a=h(i(0)),o=h(i(1)),s=h(i(4)),r=h(i(59)),l=h(i(5));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1222)}},{key:"initEvent",value:function(){var e=this;(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initEvent",this).call(this),this.stage.event.eventInput.listen("inputShow",function(){e.selection.hidePoint()}),this.stage.event.eventInput.listen("inputHide",function(){e.selection.showPoint()}),this.stage.event.eventTable.listen("showSortAreaOverlay",function(t,i){e.sortAreaOverlay&&e.sortAreaOverlay.show(t,i)}),this.stage.event.eventTable.listen("hideSortAreaOverlay",function(){e.sortAreaOverlay&&e.sortAreaOverlay.hide()})}}]),t}(h(i(1214)).default);t.default=g},1214:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(0)),a=g(i(1)),o=g(i(1215)),s=g(i(1216)),r=g(i(1218)),l=g(i(1221)),h=i(10);function g(e){return e&&e.__esModule?e:{default:e}}var c=h.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_PREVIEW,d=h.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_CANCEL_PREVIEW,u=function(){function e(t){(0,n.default)(this,e),this.container=t.container,this.stage=t.stage,this.name=t.name,this.areaX=t.areaX,this.areaY=t.areaY,this.initStyle(),this.init(t),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){var e=document.createElement("div");e.className="select-wrap",this.selectWrap=e;var t=document.createElement("div");t.className="selection-board",this.board=t,this.selectWrap.appendChild(t),this.container.appendChild(e);var i={stage:this.stage,container:t,parent:this,areaX:this.areaX,areaY:this.areaY};this.sortAreaOverlay=new l.default(i),this.selection=new o.default(i),this.activation=new s.default(i),this.formulaSelection=new r.default(i)}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventShape.listen("frameShow",function(){e.activation._hide(),e.selection._hide()}),this.stage.event.eventDimension.listen(c,function(){e.updateFrozenSelectWrapBgColor()}),this.stage.event.eventDimension.listen(d,function(){e.resetFrozenSelectWrapBgColor()}),this.stage.event.eventTable.listen("tableMove",function(t){t.areaX!==e.areaX&&t.areaY!==e.areaY||e.move()}),this.stage.event.eventTable.listen("scale",function(){e.move()})}},{key:"move",value:function(){var e=-this.stage.areaData.col[this.areaX].offsetX,t=-this.stage.areaData.row[this.areaY].offsetY;this.board.style.webkitTransform=this.board.style.transform="translate3d("+e+"px,"+t+"px,0)"}},{key:"showActivation",value:function(){var e=this.stage.selectData.active;e.xIndex<0||(e.xIndex>=this.startX&&e.xIndex<=this.endX&&e.yIndex>=this.startY&&e.yIndex<=this.endY?this.activation._calc():this.activation._hide())}},{key:"showSelection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stage.selectData.select,t=e.xRange[0],i=e.yRange[0],n=e.xRange[1],a=e.yRange[1],o=0;t>=this.startX&&t<=this.endX?o++:n>=this.startX&&n<=this.endX&&o++,i>=this.startY&&i<=this.endY?o++:a>=this.startY&&a<=this.endY&&o++,o>1?this.selection._calc(e):this.selection._hide()}},{key:"showFormulaSelection",value:function(){var e=this.stage.selectData.selectQueue,t=void 0,i=void 0,n=void 0,a=void 0,o=void 0,s=void 0,r=void 0;for(s=0;s<e.length;s++)r=0,i=(t=e[s]).xRange[0],n=t.yRange[0],a=t.xRange[1],o=t.yRange[1],i>=this.startX&&i<=this.endX?r++:a>=this.startX&&a<=this.endX&&r++,n>=this.startY&&n<=this.endY?r++:o>=this.startY&&o<=this.endY&&r++,r>1?this.formulaSelection._calc(s):this.formulaSelection._hide(s)}},{key:"hideSelection",value:function(e){this.activation._hide(),this.selection._hide(),e&&e.type===h.SELECT_HIDE_TYPE.INPUT||this.formulaSelection._hide()}},{key:"hideFormulaSelection",value:function(){this.formulaSelection._hide()}},{key:"updateFrozenSelectWrapBgColor",value:function(){this.areaX!==h.TABLE_AREA.FLOW||this.areaY!==h.TABLE_AREA.FLOW?(this.selectWrap.style.backgroundColor="black",this.selectWrap.style.opacity=.04):this.selectWrap.style.opacity=.04}},{key:"resetFrozenSelectWrapBgColor",value:function(){this.areaX!==h.TABLE_AREA.FLOW||this.areaY!==h.TABLE_AREA.FLOW?(this.selectWrap.style.backgroundColor="",this.selectWrap.style.opacity=1):this.selectWrap.style.opacity=1}}]),e}();t.default=u},1215:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(3)),a=l(i(0)),o=l(i(1)),s=l(i(4)),r=l(i(5));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i._calc=function(){var e=i.stage.areaData,t=i.stage.selectData.select,n=i.stage.selectData.active;i._correctionArea(),i.selectarea=i.areaPool[i.areaPool.length-1].area,i.operPoint=i.areaPool[i.areaPool.length-1].point;var a=!0,o=void 0,s=void 0;t.yRange[0]>=i.parent.startY?(o=t.yRange[0],i.selectarea.style.borderTop=""):(o=i.parent.startY,i.selectarea.style.borderTop="none"),t.yRange[1]<=i.parent.endY?(s=t.yRange[1],i.selectarea.style.borderBottom=""):(s=i.parent.endY,a=!1,i.selectarea.style.borderBottom="none");var r=e.row.getViewportTop(o)-i.parent.distanceY,l=e.row.getViewportTop(s)-i.parent.distanceY;i.posY[0]=r,i.posY[1]=l+i.stage.tableData.row.getHeight(s);var h=void 0,g=void 0;t.xRange[0]>=i.parent.startX?(h=t.xRange[0],i.selectarea.style.borderLeft=""):(h=i.parent.startX,i.selectarea.style.borderLeft="none"),t.xRange[1]<=i.parent.endX?(g=t.xRange[1],i.selectarea.style.borderRight=""):(g=i.parent.endX,a=!1,i.selectarea.style.borderRight="none");var c=e.col.getViewportLeft(h)-i.parent.distanceX,d=e.col.getViewportLeft(g)-i.parent.distanceX;i.posX[0]=c,i.posX[1]=d+i.stage.tableData.col.getWidth(g),i.stage.selectData.select.posX=i.posX,i.stage.selectData.select.posY=i.posY,h===n.xRange[0]&&g===n.xRange[1]&&o===n.yRange[0]&&s===n.yRange[1]?i.selectarea.style.backgroundColor="rgba(0,0,0,0)":i.selectarea.style.backgroundColor="rgba(1, 136, 251, .1)",a?i.showPoint():i.hidePoint(),i._show()},i.cachePool=[],i.areaPool=[],i.init(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){this._addArea(1),this.selectarea=this.areaPool[this.areaPool.length-1].area,this.operPoint=this.areaPool[this.areaPool.length-1].point,this.stage.event.eventTable.listen("permissionChange",this._calc)}},{key:"_addArea",value:function(e){for(var t=void 0,i=void 0,n=void 0,a=void 0;this.cachePool.length>0&&e>0;)a=this.cachePool.pop(),this.areaPool.push(a),this.container.appendChild(a.area),e--;for(n=0;n<e;n++)(t=document.createElement("div")).className="select-area",(i=document.createElement("div")).className="oper-point",t.appendChild(i),this.container.appendChild(t),this.initMouse(t,i),this.areaPool.push({area:t,point:i})}},{key:"_removeArea",value:function(e){var t=void 0,i=void 0;for(i=0;i<e;i++)(t=this.areaPool.pop()).area.style.display="none",t.point.style.display="none",this.container.removeChild(t.area),this.cachePool.push(t)}},{key:"initMouse",value:function(e,t){var i=this;t.addEventListener("mousedown",function(e){e.stopPropagation(),i.stage.event.eventMouse.one("mousedrag",function(e){i.stage.cells.extendContent(e),i.stage.judgeAutoMove(e)}),i.stage.event.eventMouse.one("mousedragEnd",function(){i.stage.event.eventSmart.trigger("smartSelectionEnd"),i.stage.stopAutoMove()})}),e.addEventListener("mousedown",function(e){2===e.button&&e.stopPropagation()}),e.addEventListener("mouseup",function(e){i.stage.hookFunc.__mouseup&&i.stage.hookFunc.__mouseup()})}},{key:"_correctionArea",value:function(){var e=this.stage.selectData.selectIndex,t=this.areaPool.length-1;e>t?(this._addArea(e-t),this.hidePoint(this.areaPool[e-1].operPoint)):e<t&&this._removeArea(t-e)}},{key:"_show",value:function(){var e=this.posX[0],t=this.posX[1]+1,i=this.posY[0],n=t-e,a=this.posY[1]+1-i;e+=this.stage.areaData.col[this.areaX].offsetX,i+=this.stage.areaData.row[this.areaY].offsetY,this.selectarea.style.left=e+"px",this.selectarea.style.top=i+"px",this.selectarea.style.width=n+"px",this.selectarea.style.height=a+"px",this.selectarea.style.display="block"}},{key:"_hide",value:function(){this.selectarea.style.display="none"}},{key:"showPoint",value:function(e){this.stage.configData.permissions?(void 0===e&&(e=this.operPoint),this.operPoint.style.display="block"):this.operPoint.style.display="none"}},{key:"hidePoint",value:function(e){void 0===e&&(e=this.operPoint),this.operPoint.style.display="none"}}]),t}(l(i(678)).default);t.default=h},1216:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(3)),a=r(i(0)),o=r(i(4)),s=r(i(5));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(e){function t(e){return(0,a.default)(this,t),(0,o.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,s.default)(t,e),t}(r(i(1217)).default);t.default=l},1217:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));o(i(166));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.parent=t.parent,this.areaX=t.areaX,this.areaY=t.areaY,this.posX=[],this.posY=[],this.init()}return(0,a.default)(e,[{key:"init",value:function(){var e=document.createElement("div");this.activeArea=e,e.className="active-area",this.container.appendChild(e)}},{key:"_calc",value:function(){var e=this.stage.selectData.active,t=e.xIndex,i=e.yIndex,n=this.stage.cells.getRealPosition(t,i);e.posX[0]=n.posX[0],e.posX[1]=n.posX[1],e.posY[0]=n.posY[0],e.posY[1]=n.posY[1],this.posX[0]=n.posX[0]-this.parent.distanceX,this.posX[1]=n.posX[1]-this.parent.distanceX,this.posY[0]=n.posY[0]-this.parent.distanceY,this.posY[1]=n.posY[1]-this.parent.distanceY,this._show()}},{key:"_show",value:function(){var e=Math.max(0,this.posX[0]),t=this.posX[1],i=Math.max(0,this.posY[0]),n=t-e,a=this.posY[1]-i,o=this.stage.selectData.select,s=this.stage.selectData.active;e+=this.stage.areaData.col[this.areaX].offsetX,i+=this.stage.areaData.row[this.areaY].offsetY,this.activeArea.style.left=e+1+"px",this.activeArea.style.top=i+1+"px",this.activeArea.style.width=n-1+"px",this.activeArea.style.height=a-1+"px",o.xRange[0]===s.xRange[0]&&o.xRange[1]===s.xRange[1]&&o.yRange[0]===s.yRange[0]&&o.yRange[1]===s.yRange[1]?this.activeArea.style.backgroundColor="transparent":this.activeArea.style.backgroundColor="rgba(255,255,255,0.4)",this.activeArea.style.display="block"}},{key:"_hide",value:function(){this.activeArea.style.display="none"}}]),e}();t.default=s},1221:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.parent=t.parent,this.areaX=t.areaX,this.areaY=t.areaY,this.posX=[],this.posY=[],this.init()}return(0,a.default)(e,[{key:"init",value:function(){var e=document.createElement("div");e.className="sort-area-overlay",e.style.position="absolute",e.style.display="none",e.style.backgroundColor=" rgba(0, 0, 0, 0.04)",this.overlay=e,this.container.appendChild(e)}},{key:"show",value:function(e,t){if(this._calc(e,t)){var i=this.posX[0],n=this.posX[1]+1,a=this.posY[0],o=n-i,s=this.posY[1]+1-a;i+=this.stage.areaData.col[this.areaX].offsetX,a+=this.stage.areaData.row[this.areaY].offsetY,this.overlay.style.left=i+"px",this.overlay.style.top=a+"px",this.overlay.style.width=o+"px",this.overlay.style.height=s+"px",this.overlay.style.display="block"}}},{key:"hide",value:function(){this.overlay.style.display="none"}},{key:"_calc",value:function(e,t){var i=this.stage.areaData.col.getAreaName(e[0]),n=this.stage.areaData.col.getAreaName(e[1]);if(i!==this.areaX&&n!==this.areaX)return!1;var a=this.stage.areaData.row.getAreaName(t[0]),o=this.stage.areaData.row.getAreaName(t[1]);if(a!==this.areaY&&o!==this.areaY)return!1;var s=this.stage.areaData,r=this.stage.tableData,l=void 0,h=void 0;l=t[0]>=this.parent.startY?t[0]:this.parent.startY,h=t[1]<=this.parent.endY?t[1]:this.parent.endY;var g=s.row.getViewportTop(l)-this.parent.distanceY,c=s.row.getViewportTop(h)-this.parent.distanceY;this.posY[0]=g,this.posY[1]=c+r.row.getHeight(h);var d=void 0,u=void 0;d=e[0]>=this.parent.startX?e[0]:this.parent.startX,u=e[1]<=this.parent.endX?e[1]:this.parent.endX;var f=s.col.getViewportLeft(d)-this.parent.distanceX,v=s.col.getViewportLeft(u)-this.parent.distanceX;return this.posX[0]=f,this.posX[1]=v+this.stage.tableData.col.getWidth(u),!0}}]),e}();t.default=s},1222:function(e,t,i){var n=i(1223);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1223:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".select-wrap {\n    position: absolute;\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    z-index: 3;\n}\n\n.selection-board {\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 9;\n}\n\n.select-area {\n    display: none;\n    position: absolute;\n    background-color: rgba(1, 136, 251, 0.1);\n    box-sizing: border-box;\n    border: 2px solid #0188fb;\n\n    box-sizing: border-box !important;\n    -webkit-tap-highlight-color: rgba(0, 0, 0, 0);\n    tap-highlight-color: rgba(0, 0, 0, 0);\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n}\n\n.select-area.drag-rowcol::before {\n    content: '';\n    position: absolute;\n    left: -1px;\n    right: -1px;\n    top: -1px;\n    bottom: -1px;\n    background-color: rgba(255, 255, 255, 0.8);\n}\n\n.oper-point {\n    position: absolute;\n    background-color: #0188fb;\n    height: 5px;\n    width: 5px;\n    border: 2px solid rgb(255, 255, 255);\n    display: block;\n    right: -4.5px;\n    bottom: -4.5px;\n    z-index: 10;\n    cursor: crosshair;\n}\n\n.active-area {\n    display: none;\n    position: absolute;\n    box-sizing: border-box;\n    /*border: 2px solid #0188fb;*/\n    -webkit-transform-origin: left top;\n    transform-origin: left top;\n    -webkit-transform: matrix(1, 0, 0, 1, 0, 0);\n    transform: matrix(1, 0, 0, 1, 0, 0);\n    box-sizing: border-box !important;\n    pointer-events: none;\n    -webkit-touch-callout: none;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n}\n\n/* \u62d6\u62fd\u79fb\u52a8\u884c\u5217\u7684\u6837\u5f0f */\n.drag-rowcol {\n    cursor: -webkit-grab;\n    cursor: grab;\n}\n",""])},1224:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i(14)),a=u(i(3)),o=u(i(0)),s=u(i(1)),r=u(i(4)),l=u(i(59)),h=u(i(5)),g=u(i(1225)),c=u(i(1226)),d=i(10);function u(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var i=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return i._boardResize=function(){i.board.resize()},i._show=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!i.stage.configData.forbiddenInput){e&&e.enterToolbarInput?i.stage.tableData.inputStatus=3:e&&e.stockEditAsFormula?i.stage.tableData.inputStatus=2:0===i.stage.tableData.inputStatus&&(i.stage.tableData.inputStatus=1);var t=i.stage.selectData.active.xIndex,a=i.stage.selectData.active.yIndex;if(i.x=t,i.y=a,i.showing){var o=e.editValue;"undefined"!==typeof o&&i.stage.event.eventInput.trigger("inputValueAndCursorChange",{value:o})}else{i.stage.positionCenter.changeSelfData(i.positionCenterKey,{xRange:[t,t],yRange:[a,a]}),i.showing=!0,i.stage.event.eventSelection.listen("selectionShow",i._checkHide);var s=i.getCellData(t,a),r=i.prepareInputBoardData(s,t,a);i.board.cacheCellEditValue=s&&s.editValue||"",e&&"undefined"!==typeof e.editValue?(r.textFormatRuns&&r.textFormatRuns.length>1&&(r.textFormatRuns.length=1),r.mentionDetails=null,i.board.show((0,n.default)({},r,e))):i.board.show((0,n.default)({},e,r)),i.stage.event.eventTable.trigger("enterInputStatus"),i.stage.event.eventTable.listen("tableMove",i.board.move),i.stage.event.eventTable.listen("scale",i.board.scale)}}},i._hide=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};i.stage.positionCenter.changeSelfData(i.positionCenterKey,{xRange:[-1,-1],yRange:[-1,-1]}),i.showing=!1,i.board.hide(e),i.stage.event.eventTable.remove("tableMove",i.board.move),i.stage.event.eventTable.remove("scale",i.board.scale),i.stage.tableData.inputStatus=0,e.showStockResultBoard||(i.stage.event.eventTable.trigger("enterActiveStatus"),i.stage.event.eventFormula.trigger("leaveFormula"),i.stage.event.eventSelection.remove("selectionShow",i._checkHide))},i._checkHide=function(e){e&&e.type!==d.SELECT_SHOW_TYPE.SELECT||i.stage.selectData.selectStatus===d.SELECT_STATUS.NORMAL&&e.show&&i._hide()},i.init(),i.stage.configData.permissions&&i.initEvent(),i.stage.event.eventTable.listen("permissionChange",function(){i.stage.configData.permissions?i.initEvent():i.uninitEvent()}),i}return(0,h.default)(t,e),(0,s.default)(t,[{key:"initEvent",value:function(){(0,l.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"initEvent",this).call(this),this.stage.event.eventDimension.listen("setColWidth",this._boardResize),this.stage.event.eventDimension.listen("setRowHeight",this._boardResize)}},{key:"uninitEvent",value:function(){(0,l.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"uninitEvent",this).call(this),this.stage.event.eventDimension.remove("setColWidth",this._boardResize),this.stage.event.eventDimension.remove("setRowHeight",this._boardResize)}},{key:"init",value:function(){var e=this;this.board=new c.default({container:this.container,stage:this.stage}),this.positionCenterKey=this.stage.positionCenter.add({type:"input",config:{ignoreSet:!1,ignoreAdd:!1,ignoreRemove:!1,ignoreHideShow:!1,ignoreFrozen:!1,listenSetBefore:!0,listenHideShowBefore:!0,removeType:"follow"},selfData:{xRange:[-1,-1],yRange:[-1,-1]},calc:function(t,i,n){if(t.xRange[1]<t.xRange[0]||t.yRange[1]<t.yRange[0])return t.xRange[0]=t.xRange[1]=-1,t.yRange[0]=t.yRange[1]=-1,void e.board.showTooltipCard({type:"CELL_DELETE"});e.board.xIndex=t.xRange[0],e.board.yIndex=t.yRange[0],e.board.move(t,i,n)}})}}]),t}(g.default);t.default=f},1225:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(9)),a=s(i(0)),o=s(i(1));!function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);t.default=e}(i(10));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){var i=this;(0,a.default)(this,e),this._handleInputValueChange=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.type,a=void 0===n?"NORMAL":n,o=t.channelType;"FORMULA"===a&&3===i.stage.tableData.inputStatus&&(i.stage.tableData.inputStatus=2),i.board.valueChange(e,{type:a,channelType:o})},this._handleInputCursorChange=function(e){i.board.cursorChange(e)},this._handleInputValueAndCursorChange=function(e){var t=e.value,n=e.cursor,a=e.type,o=void 0===a?"NORMAL":a,s=e.channelType;"FORMULA"===o&&3===i.stage.tableData.inputStatus&&(i.stage.tableData.inputStatus=2),i.board.valueAndCursorChange(t,n,{channelType:s})},this.checkInputInitValueChange=function(){return 0!==i.stage.tableData.inputStatus&&i.board.checkCellConflictHasOccurred()},this.container=t.container,this.stage=t.stage,this.showing=!1,this.x=-1,this.y=-1}return(0,o.default)(e,[{key:"initEvent",value:function(){this.stage.event.eventShape.listen("frameShow",this._hide),this.stage.event.eventInput.listen("inputHide",this._hide),this.stage.event.eventInput.listen("inputShow",this._show),this.stage.event.eventInput.listen("inputValueChange",this._handleInputValueChange),this.stage.event.eventInput.listen("inputCursorChange",this._handleInputCursorChange),this.stage.event.eventInput.listen("inputValueAndCursorChange",this._handleInputValueAndCursorChange)}},{key:"uninitEvent",value:function(){this.stage.event.eventShape.remove("frameShow",this._hide),this.stage.event.eventInput.remove("inputHide",this._hide),this.stage.event.eventInput.remove("inputShow",this._show),this.stage.event.eventInput.remove("inputValueChange",this._handleInputValueChange),this.stage.event.eventInput.remove("inputCursorChange",this._handleInputCursorChange),this.stage.event.eventInput.remove("inputValueAndCursorChange",this._handleInputValueAndCursorChange)}},{key:"getCellData",value:function(e,t){return this.stage.hookFunc.getCellDataForInputBoard?this.stage.hookFunc.getCellDataForInputBoard(e,t):null}},{key:"prepareInputBoardData",value:function(e,t,i){if(e){var a=e.userEnteredFormat,o=this.stage.tableData.getCellDataAtPosition(i,t),s={textAlgin:o&&o.textAlign,vertialAlgin:o&&o.verticalAlign,backgroundColor:o&&o.backgroundColor,wrapStrategy:a&&a.getWrapStrategy(),textFormat:a&&a.getTextFormat()},r=e.textFormatRuns;if(!r||!r.length)r=[this.stage.hookFunc.generateTextFormatRun&&this.stage.hookFunc.generateTextFormatRun(0,s.textFormat)];var l=null;if(e.mentionDetails)l=(0,n.default)(e.mentionDetails).map(function(t){return e.mentionDetails[t].toObject()});return{editValue:e.editValue||"",renderString:e.renderString||"",cellFormat:s,textFormatRuns:r||null,mentionDetails:l}}return{editValue:"",renderString:"",cellFormat:null,textFormatRuns:null,mentionDetails:null}}}]),e}();t.default=r},1226:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(i(3)),a=w(i(0)),o=w(i(1)),s=w(i(4)),r=w(i(5)),l=w(i(1227)),h=w(i(1228)),g=i(21),c=i(401),d=i(679),u=i(10),f=i(10),v=w(i(12)),A=i(99),C=i(245),p=i(71),I=w(i(8)),m=i(206),y=i(22);function w(e){return e&&e.__esModule?e:{default:e}}var x=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return b.call(i),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1233)}},{key:"init",value:function(){this.board=this.initBoard(this.container),this.hideBoard()}},{key:"initBoard",value:function(e){var t=document.createElement("div");return t.className="table-input-board",this.boardContainer=this.initBoardContainer(t),e.appendChild(t),t}},{key:"initBoardContainer",value:function(e){var t=document.createElement("div");return t.className="table-input-board-container",this.tooltipCard=this.initTooltipCard(t),this.formulaHelpCard=this.initFormulaHelpCard(t),this.alloyRTE=this.initEditor(t),this.initAriaDom(),this.input=this.alloyRTE.input,t.addEventListener("dblclick",function(e){e.stopPropagation()}),e.appendChild(t),t}},{key:"initTooltipCard",value:function(e){var t=document.createElement("div");return t.className="table-input-tooltip-card",e.appendChild(t),t}},{key:"initFormulaHelpCard",value:function(e){var t=this,i=document.createElement("div");return i.id="table-input-formula-card",i.className="table-input-formula-card",i.setAttribute("data-tooltip","\u5f00\u542f\u516c\u5f0f\u5e2e\u52a9"),i.addEventListener("mousedown",function(e){e.preventDefault(),c.formulaHelperStorage.setOpen(),t.checkFormula(),I.default.tdwReport({opername:"doc_excel",module:"function",action:"clk_que"})}),e.appendChild(i),i}},{key:"showFormulaHelpCard",value:function(){this.formulaHelpCard.style.display="block",(0,C.showTooltip)("#table-input-formula-card")}},{key:"hideFormulaHelpCard",value:function(){this.formulaHelpCard.style.display="none"}},{key:"initEditor",value:function(e){var t=this,i=(0,d.calcCellFormatStyles)(),n=(0,d.calcTextFormatStyles)(),a=new h.default({parent:e,className:"table-input-editor",defCellStyles:i,defTextStyles:n,platform:"PC",undoRedoStateChange:this._editorUndoRedoStateChange.bind(this),formatStateChange:this._editorFormatStateChange.bind(this),exitHandler:this._editorExitHandler.bind(this),valueChange:this._editorValueChangeHandler.bind(this),selectionChange:this._editorSelectionChangeHandler.bind(this),blurHandler:this._blurHandler.bind(this),_tdwReport:this.doTdwReport.bind(this),_mentionBlockFuncs:{popMentionList:function(e,i){var n=t.stage.hookFunc.getActiveSheetId(),a=t.stage.tableData.row.getHeight(t.yIndex);t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("addMentionAction",e,a,n,i)},search:function(e){t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("searchMention",e)},control:function(e){t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("keyboardDown",e)},hideMentionList:function(){t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("cancelMentionAction")},showRemindBoard:function(e,i){var n=t.stage.tableData.row.getHeight(t.yIndex);t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("setQuickRemindMenu",{mentionId:e,pos:i,visible:!0,rowHeight:n})},closeRemindBoard:function(){t.stage.hookFunc.triggerMentionEvent&&t.stage.hookFunc.triggerMentionEvent("hideQuickRemindMenu")}}});return a.attachEventToInput("click",function(){2!==t.stage.tableData.inputStatus&&(t.stage.tableData.inputStatus=2)}),a.attachEventToInput("compositionupdate",function(){t.realTimeHeightUp()}),a.attachEventToInput("contextmenu",function(e){e.stopPropagation()}),a.attachEventToInput("paste",function(e){var i="";e&&e.clipboardData&&e.clipboardData.getData&&(i=e.clipboardData.getData("text/plain")),i.trim&&""!==i.trim()&&t.stage.hookFunc.inputPasteValue&&t.stage.hookFunc.inputPasteValue(i)}),v.default.wait(0).run(function(){a.focus()}),a}},{key:"initAriaDom",value:function(){var e=this.alloyRTE;this.focuslink=document.createElement("div"),e.root.appendChild(this.focuslink),this.focuslink.className="aria-hide",this.focuslink.setAttribute("id","alloy-rich-text-editor-aria"),this.focuslink.setAttribute("aria-live","polite"),y.isMac&&(e.input.setAttribute("role","combobox"),e.input.setAttribute("aria-autocomplete","list"),e.input.setAttribute("aria-describedby","alloy-rich-text-editor-aria"),this.focuslink.setAttribute("aria-live","assertive"),this.focuslink.setAttribute("aria-atomic",!0))}},{key:"getHelpInfo",value:function(e){var t=this,i="Ctrl",n="Alt";y.isMac&&(i="Cmd",n="Opt");var a="\n            \u6b22\u8fce\u4f7f\u7528\u817e\u8baf\u6587\u6863\n            \u4f60\u53ef\u4ee5\u4f7f\u7528"+i+"+"+n+"+SHIFT+h\u91cd\u65b0\u542c\u53d6\u5e2e\u52a9\u3002\n            "+i+"+"+n+"+SHIFT+1 \u5207\u6362\u5230\u8868\u683c\u5185\u5bb9\u533a\n            "+i+"+"+n+"+SHIFT+2 \u5207\u6362\u5230\u8868\u683c\u5de5\u5177\u680f\n            "+i+"+"+n+"+SHIFT+3 \u5207\u6362\u5230\u9876\u90e8\u83dc\u5355\u680f\n            "+i+"+"+n+"+SHIFT+4 \u5207\u6362\u5230\u5e95\u90e8\u5de5\u5177\u680f\n            "+i+"+"+n+"+SHIFT+5 \u5207\u6362\u5230\u4fee\u6539\u8868\u683c\u6807\u9898\n            \u6309F2\u8fdb\u5165\u8868\u683c\u7f16\u8f91\u3002\n        ";return!this.hadGet&&(setTimeout(function(){t.hadGet=!0},200),a+="\n                 \u5f53\u524d\u6240\u5728\u5355\u5143\u683c "+e+"\n            ")}},{key:"setAriaInfo",value:function(e,t,i){var n=this.alloyRTE,a=""+(0,m.toColumnName)(e+1)+(t+1),o=this.getHelpInfo(a);o||(o=(i||"")+" "+a),n.input.setAttribute("aria-label",o),y.isMac?(this.focuslink.innerText=o,"alloy-simple-text-editor"===document.activeElement.id&&this.focus()):document.activeElement&&"alloy-simple-text-editor"===document.activeElement.id&&this.focus()}},{key:"resetAriaInfo",value:function(){this.alloyRTE.input.removeAttribute("aria-label")}},{key:"_editorUndoRedoStateChange",value:function(e,t){this.stage.configData.permissions&&this.showing&&this.stage.hookFunc.updateToolbarUndoRedoButtonsStatus&&this.stage.hookFunc.updateToolbarUndoRedoButtonsStatus({canUndo:e,canRedo:t})}},{key:"_transformToFormatObj",value:function(e){return{bold:!(!e||"boolean"!==typeof e.bold)&&e.bold,italic:!(!e||"boolean"!==typeof e.italic)&&e.italic,fontName:e&&"string"===typeof e.fontFamily?e.fontFamily:"Microsoft YaHei",fontSize:e&&"number"===typeof e.fontSize?e.fontSize:10,foreColor:e&&e.color?e.color.toStringRGB():"rgb(0,0,0)",strikeThrough:!(!e||"boolean"!==typeof e.strikethrough)&&e.strikethrough,underline:!(!e||"number"!==typeof e.underline)&&e.underline>0}}},{key:"_editorFormatStateChange",value:function(e){if(3===this.stage.tableData.inputStatus){var t=this.initCellFormat&&this.initCellFormat.textFormat;e=this._transformToFormatObj(t||null)}this.stage.hookFunc.updateToolbarFormatButtonsStatus&&this.stage.hookFunc.updateToolbarFormatButtonsStatus(e)}},{key:"_editorExitHandler",value:function(e){}},{key:"_editorValueChangeHandler",value:function(e){this.checkInputValue(e),this.realTimeHeightUp(),this.stage.event.eventInput.trigger("editorValueChange",e)}},{key:"_editorSelectionChangeHandler",value:function(e){this.checkFormula()}},{key:"_blurHandler",value:function(){this.blurRange=this.alloyRTE.getSelection()}},{key:"handleExitInputStatus",value:function(e){}},{key:"getCurrentRange",value:function(){return 1===this.stage.tableData.inputStatus||2===this.stage.tableData.inputStatus?this.alloyRTE.getSelection():3===this.stage.tableData.inputStatus?this.stage.hookFunc.getInputBoxRange&&this.stage.hookFunc.getInputBoxRange():(console.warn("can not get range!"),{start:0,end:0})}},{key:"checkInputValue",value:function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).channelType;this.checkFormula(e),"SYNC_VALUE"!==t&&this.syncValueToToolbarInputBox(e),/^=/.test(e)||this.isInOriginSheet()||window.__core&&(this.setCrossSheetFormulaEditorCache({editValue:""}),window.__core.event.sheetsBar.trigger("switchSheet",this.crossSheetFormulaEditorCache.originSheetId))}},{key:"checkFormula",value:function(e){var t=e;"undefined"===typeof t&&(t=this.alloyRTE.getText());var i=this.testFormula(t);i.isStock?this.showStock(t):i.isFormula?this.showFormulaDetail(t):this.closeFormulaBoard()}},{key:"hideBoard",value:function(){this.setBoardStyles(this.boardContainer,{left:"-9999px",top:"","min-width":"0px","max-width":"0px","min-height":"0px","max-height":"0px"}),this.alloyRTE.hide()}},{key:"calcInputBoardRect",value:function(){if(void 0===this.xIndex||void 0===this.yIndex||-1===this.xIndex||-1===this.yIndex)return console.warn("warining: xIndex or yIndex is invalid!"),null;var e=this.stage.areaData.col.getViewportLeft(this.xIndex),t=this.stage.areaData.row.getViewportTop(this.yIndex),i=this.stage.areaData.col[this.areaX].viewStart,n=this.stage.areaData.row[this.areaY].viewStart,a=this.getCurrentCell();a.parent&&(a=a.parent,i=this.stage.areaData.col.getArea(a.mergeData.xRange[0]).viewStart,n=this.stage.areaData.row.getArea(a.mergeData.yRange[0]).viewStart);var o=this.stage.tableData.getCellBackgroundWidth(this.yIndex,this.xIndex,!0),s=a.getMaxTextWidth(),r=this.stage.scale,l=12+(this.areaY===u.TABLE_AREA.FLOW?4:0),h=Math.max(o,s),g=this.stage.areaData.col.flow.maxDistance-e-4,c=g;c*r>g&&(c=g/r),h*r>g&&(h=g/r);var d=this.stage.tableData.getCellBackgroundHeight(this.yIndex,this.xIndex,!0),f=this.stage.areaData.row.flow.maxDistance-t-l;return d=Math.min(d,f),{left:Math.max(e,i),top:Math.max(t,n),minWidth:h,maxWidth:c,minHeight:d+1,maxHeight:f}}},{key:"inputBoardMove",value:function(e){var t=this.stage.areaData.col[this.areaX].viewStart-1,i=this.stage.areaData.row[this.areaY].viewStart-1,n=this.stage.areaData.col.getViewportLeft(this.xIndex),a=this.stage.areaData.row.getViewportTop(this.yIndex),o=this.getCurrentCell();o.parent&&(o=o.parent,t=this.stage.areaData.col.getArea(o.mergeData.xRange[0]).viewStart,i=this.stage.areaData.row.getArea(o.mergeData.yRange[0]).viewStart);var s=this.stage.tableData.getCellBackgroundHeight(this.yIndex,this.xIndex,!0),r=this.stage.tableData.getCellBackgroundWidth(this.yIndex,this.xIndex,!0);a<i?s-(i-a)>0?this.setBoardStyles(e,{top:i+"px"}):this.setBoardStyles(e,{top:"-99999px"}):this.setBoardStyles(e,{top:a+"px"});n<t?r-(t-n)>0?this.setBoardStyles(e,{left:t+"px"}):this.setBoardStyles(e,{left:"-99999px"}):this.setBoardStyles(e,{left:n+"px"})}},{key:"_getExtraWidth",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e;for(t?i++:i--;!(0,g.isColShow)(this.stage.tableData,i);)t?i++:i--;return this.stage.tableData.col.getWidth(i,{ignoreHide:!0})}},{key:"_getExtraHeight",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=e;for(t?i++:i--;!(0,g.isRowShow)(this.stage.tableData,i);)t?i++:i--;return this.stage.tableData.row.getHeight(i,{ignoreHide:!0})}},{key:"positionTable",value:function(e){var t=e.cb,i=e.immediately,n=void 0===i||i,a=this.xIndex,o=this.yIndex,s=this.stage.cells.calcCellOffsetToTable([a,a],[o,o]),r=s.diffX,l=s.diffY,h=this.stage.tableData.getCellBackgroundHeight(o,a),g=this.stage.tableData.getCellBackgroundWidth(o,a),c=this.stage.areaData.col.flow.viewWidth,d=0;r>0?g+(d=this._getExtraWidth(a,!0))<c?r+=d:g<=c&&(r+=c/2-g/2):r<0&&(g+(d=this._getExtraWidth(a,!1))<c?r-=d:g<=c&&(r-=c/2-g/2));var f=this.stage.areaData.row.flow.viewHeight,v=0;l>0?h+(v=this._getExtraHeight(o,!0))<f?l+=v:h<=f&&(l+=f/2-h/2):l<0&&(h+(v=this._getExtraHeight(o,!1))<f?l-=v:h<=f&&(l-=f/2-h/2)),isNaN(r)||isNaN(l)||0===r&&0===l?t&&t():this.stage.tableScroll({diffX:-r,diffY:-l,areaX:this.areaX,areaY:this.areaY,type:n?u.TABLE_SCROLL_MODE.IMMEDIATE:u.TABLE_SCROLL_MODE.EASE,animatedEnd:function(){t&&t()}})}},{key:"checkCellConflictHasOccurred",value:function(){var e=this;if(0===this.stage.tableData.inputStatus)return!1;var t=this.xIndex,i=this.yIndex;if(-1===t||-1===i)return!1;var n=this.parseInputBoardInfos(),a=n.text,o=n.textFormatRuns;if(this.inValid&&a&&a.length)return this.stage.hookFunc.doCopyToClipboard?(this.stage.hookFunc.doCopyToClipboard({html:"",plain:a}),this.alloyRTE.focus(),this.alloyRTE.setSelection({start:0,end:0})):console.error("no doCopyToClipboard hookfunc"),(0,p.showToast)("\u8be5\u884c/\u5217\u5df2\u88ab\u534f\u4f5c\u8005\u5220\u9664\u6216\u79fb\u52a8\uff0c\u521a\u521a\u8f93\u5165\u7684\u5185\u5bb9\u5df2\u4e3a\u4f60\u590d\u5236\u5230\u526a\u5207\u677f\u3002",{},{toastType:"typeNotice2",toolToastCloseTime:3e3}),!1;var s="",r=[];try{var l=this.getCellData(t,i);s=l.editValue||"",r=l.textFormatRuns||[]}catch(h){return!1}return a!==this.initEditValue&&this.cacheCellEditValue!==s&&(I.default.tdwReport({opername:"doc_excel_editor",module:"excel_co-edit",action:"co_edit_dialog"}),this.stage.configData.permissions&&(0,A.Custom_Dialog)("\u7f16\u8f91\u8fc7\u7a0b\u4e2d\u6709\u5176\u4ed6\u534f\u4f5c\u8005\u4fee\u6539\u4e86\u6b64\u5355\u5143\u683c\u5185\u5bb9\uff0c\u4f60\u8f93\u5165\u7684\u5185\u5bb9\u5c06\u5408\u5e76\u81f3\u5176\u540e\u9762\uff0c\u53ef\u6839\u636e\u9700\u8981\u8c03\u6574\u5185\u5bb9\u3002",{type:A.DIALOG_TYPE.StandardConfirm,title:"\u63d0\u793a",width:386,body_padding:!0,overlay_close:!1,buttons:[{caption:"\u6211\u77e5\u9053\u4e86"}],onCloseBeforeAnimate:function(t){if(""===t?I.default.tdwReport({opername:"doc_excel_editor",module:"excel_co-edit",action:"co_edit_dialog_cls"}):I.default.tdwReport({opername:"doc_excel_editor",module:"excel_co-edit",action:"co_edit_dialog_clk"}),!e.inValid){var i=e.resolveCellConflictWith(s,r,a,o),n=i.mergedValue,l=i.mergedTextFormatRuns;e.show({editValue:n,cellFormat:e.initCellFormat,textFormatRuns:l}),2!==e.stage.tableData.inputStatus&&(e.stage.tableData.inputStatus=2),e.alloyRTE.collapseToEnd(),e.cacheCellEditValue=s}}}),!0)}}]),t}(l.default),b=function(){var e=this;this.hide=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.discardValue,n=void 0!==i&&i,a=t.isSwitchingSheet,o=void 0!==a&&a,s=t.startSheetName,r=t.endSheetName,l=t.startSheetId,h=t.endSheetId;if(e.showing){e.showing=!1;var g=e.getCurrentText(),c=e.stage.selectData.selectStatus===f.SELECT_STATUS.FORMULA;if(c&&o&&e.setCrossSheetFormulaEditorCache({editValue:g,startSheetName:s,endSheetName:r,startSheetId:l,endSheetId:h,isInCrossSheetFormulaEditingMode:!0,cursorPosition:e.getCurrentRange().start}),n){if(e.stage.hookFunc.afterInput(e.getCurrentText()),!e.isSetHeight&&e.isAutoTextWrap){var d=e.getNewRowHeight();e.stage.setRowHeight(e.yIndex,d,!1)}}else e.setCellDataValue();o&&e.isInOriginSheet()||c&&o||e.resetCrossSheetFormulaEditorCache(),e.resetLayoutVariables(),setTimeout(function(){0===e.stage.tableData.inputStatus&&e.hideBoard()},0),e.alloyRTE.hooks._mentionBlockFuncs.hideMentionList(),e.alloyRTE.hooks._mentionBlockFuncs.closeRemindBoard()}},this.resize=function(){if(e.showing){var t=e.calcInputBoardRect();if(t){var i=4*e.stage.scale,n={};n=e.isAutoTextWrap?{height:t.minHeight-i+"px",width:t.minWidth-i-3+"px"}:{height:t.minHeight-i+"px","min-width":t.minWidth-i-3+"px"},e.alloyRTE.setEditorInputStyles(n),e.alloyRTE.setEitorContainerStyles({"min-width":t.minWidth-i+"px","max-width":t.maxWidth-i+"px","min-height":t.minHeight-i+"px","max-height":t.maxHeight-i+"px"});var a=e.stage.scale;e.setBoardStyles(e.boardContainer,{left:t.left+"px",top:t.top+"px","min-width":t.minWidth+"px","max-width":t.maxWidth+"px","min-height":t.minHeight+"px","max-height":t.maxHeight+"px",transform:"scale("+a+")"})}}},this.move=function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var t=arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=e.stage.areaData.col.flow.offsetX+e.stage.areaData.col.frozen.offsetX,a=e.stage.areaData.row.flow.offsetY+e.stage.areaData.row.frozen.offsetY;if(["set","add","remove","hide","show"].indexOf(t)>=0){var o=0,s=0;if("set"===t)"ROW"===i.type&&i.index<e.yIndex&&(s=i.newHeight-i.oldHeight),"COL"===i.type&&i.index<e.xIndex&&(o=i.newWidth-i.oldWidth);else if("add"===t){if("COL"===i.type&&i.index<=e.xIndex)for(var r=i.index;r<i.index+i.number;r++)o+=e.stage.tableData.col.getWidth(r);if("ROW"===i.type&&i.index<=e.yIndex)for(var l=i.index;l<i.index+i.number;l++)s+=e.stage.tableData.row.getHeight(l)}else if("remove"===t||"hide"===t)"COL"===i.type&&(o=-i.colWidths.reduce(function(e,t){return e+t})),"ROW"===i.type&&(s=-i.rowHeights.reduce(function(e,t){return e+t}));else if("show"===t){if("COL"===i.type)for(var h=i.range[0];h<=i.range[1];h++)o+=e.stage.tableData.col.getWidth(h);if("ROW"===i.type)for(var g=i.range[0];g<=i.range[1];g++)s+=e.stage.tableData.row.getHeight(g)}0!==o&&(o+n>0||(o=0!==n?-n:0)),0!==s&&(s+a>0||(s=0!==a?-a:0)),(o||s)&&e.stage.tableScroll({diffX:o,diffY:s,areaX:e.areaX,areaY:e.areaY}),0!==o&&0!==s||e.resize()}else e.inputBoardMove(e.boardContainer)},this.scale=function(){var t=e.stage.scale;e.setBoardStyles(e.boardContainer,{transform:"scale("+t+")"}),e.resize()}};t.default=x},1227:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=A(i(24)),a=A(i(0)),o=A(i(1)),s=i(21),r=i(679),l=i(44),h=i(10),g=i(10),c=i(48),d=i(68),u=A(i(12)),f=A(i(8)),v=(i(22),i(55));function A(e){return e&&e.__esModule?e:{default:e}}var C=function(){function e(t){(0,a.default)(this,e),this.container=t.container,this.stage=t.stage,this.showing=!1,this.xIndex=-1,this.yIndex=-1,this.areaX="flow",this.areaY="flow",this.inValid=!1,this.distanceX=t.distanceX,this.distanceY=t.distanceY,this.initEditValue="",this.initTextFormatRuns=null,this.forceUpdateValue=!1,this.cacheCellEditValue="",this.alloyRTE=null,this.blurRange=null,this.initStyle(),this.init(),this.resetLayoutVariables(),this.resetCrossSheetFormulaEditorCache(),this.fixCopy()}return(0,o.default)(e,[{key:"fixCopy",value:function(){var e=this,t=0;document.addEventListener("copy",function(i){if(0!==e.stage.tableData.inputStatus){var n=Number(new Date);if(n-t>100){t=n;var a=e.alloyRTE.getSelectedText();a&&a.length&&window.SpreadsheetApp.plugins.copyPaste.doCopyToClipboard({type:d.CopyHTMLType.input,plain:a})}}})}},{key:"resetLayoutVariables",value:function(){this.isMergeCell=!1,this.isAutoTextWrap=!1,this.isSetHeight=!1,this.inputContentHeight=0}},{key:"restoreFocusStateIfNeed",value:function(){!this.alloyRTE.hasFocus()&&this.blurRange&&this.alloyRTE.setSelection(this.blurRange)}},{key:"undo",value:function(){this.alloyRTE.undo()}},{key:"redo",value:function(){this.alloyRTE.redo()}},{key:"hasFocus",value:function(){return this.alloyRTE.hasFocus()}},{key:"focus",value:function(){this.alloyRTE.focus();var e=this.stage.selectData.active;if(e&&e.xIndex&&e.yIndex){var t=e.xIndex,i=e.yIndex,n=(this.stage.tableData.getCellDataAtPosition(i,t)||{}).text;this.stage.inputCenter.board.setAriaInfo&&this.stage.inputCenter.board.setAriaInfo(t,i,n)}}},{key:"blur",value:function(){this.alloyRTE.blur()}},{key:"insertNewLine",value:function(){this.alloyRTE.insertNewLine()}},{key:"format",value:function(e){var t=e.cmd,i=e.value,n=e.range;n&&(2!==this.stage.tableData.inputStatus&&(this.stage.tableData.inputStatus=2),this.alloyRTE.setSelection(n)),this.alloyRTE.format(t,i),this.realTimeHeightUp()}},{key:"doTdwReport",value:function(e){if(!this.alloyRTE.isSelectedAll()){var t=this.alloyRTE.isCollapsed(),i=e&&{fontName:t?"cursor_fontname":"select_part_fontname",foreColor:t?"cursor_fontcolor":"select_part_fontcolor",fontSize:t?"cursor_fontsize":"select_part_fontsize",bold:t?"cursor_b":"select_part_b",italic:t?"cursor_i":"select_part_i",underline:t?"cursor_u":"select_part_u",strikeThrough:t?"cursor_s":"select_part_s"}[e];"string"===typeof i&&f.default.tdwReport({opername:"doc_excel_editor",module:"excel_type",action:i})}}},{key:"showTooltipCard",value:function(e){var t=null;e&&"POSITION"===e.type?t=(0,s.getColName)(this.xIndex)+(this.yIndex+1):e&&"CELL_DELETE"===e.type&&(this.inValid=!0,t="\u5355\u5143\u683c\u5df2\u88ab\u534f\u4f5c\u8005\u5220\u9664\u6216\u79fb\u52a8"),t&&(this.tooltipCard.innerText=t,this.tooltipCard.style.display="block")}},{key:"hideTooltipCard",value:function(){this.tooltipCard.innerText="",this.tooltipCard.style.display="none"}},{key:"getCurrentText",value:function(){return this.alloyRTE.getText()}},{key:"setBoardStyles",value:function(e,t){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)){var n=t[i];e.style[i]=n}}},{key:"getCurrentCell",value:function(){return this.stage.tableData.getCellDataAtPosition(this.yIndex,this.xIndex,h.GET_CELLDATA.DEFAULT)}},{key:"getCellData",value:function(e,t){return this.stage.hookFunc.getCellDataForInputBoard?this.stage.hookFunc.getCellDataForInputBoard(e,t):null}},{key:"getCellRenderText",value:function(){var e=this.getCurrentCell();return e&&e.parent&&(e=e.parent),e&&e.text||""}},{key:"canShowStockResultBoard",value:function(e,t,i){return/^=STOCK\(/.test(e)&&"..."!==t&&"#ERROR!"!==t&&!i}},{key:"getCurrCellTextwrap",value:function(){var e=this.getCurrentCell();return e&&e.parent&&(e=e.parent),e.isAutoTextWrap()}},{key:"getCurrCellIsMergeCell",value:function(){var e=this.getCurrentCell();return!!(e&&e.merge||e&&e.parent&&e.parent.merge)}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,s.isIE)()&&e&&e.cellFormat&&e.cellFormat.textFormat&&(e.cellFormat.textFormat.bold=!1,e.cellFormat.textFormat.italic=!1),this.hideTooltipCard&&this.hideTooltipCard(),this.xIndex="number"===typeof e.xIndex?e.xIndex:this.stage.selectData.active.xIndex,this.yIndex="number"===typeof e.yIndex?e.yIndex:this.stage.selectData.active.yIndex;var t=this.stage.hookFunc.getActiveSheetId();if(this.crossSheetFormulaEditorCache.originSheetName){var i=this.crossSheetFormulaEditorCache.originSheetId===t;this.setBoardStyles(this.boardContainer,{opacity:i?1:0,"pointer-events":i?"auto":"none"})}else this.setCrossSheetFormulaEditorCache({originSheetName:this.stage.hookFunc.getActiveSheetName(),originSheetId:t});this.areaX=this.xIndex<this.stage.areaData.col.flow.start?h.TABLE_AREA.FROZEN:h.TABLE_AREA.FLOW,this.areaY=this.yIndex<this.stage.areaData.row.flow.start?h.TABLE_AREA.FROZEN:h.TABLE_AREA.FLOW,this.inValid=!1,this.isMergeCell=this.getCurrCellIsMergeCell(),this.isAutoTextWrap=this.getCurrCellTextwrap(),this.isSetHeight=!!this.stage.tableData.row.getSetHeight(this.yIndex);var n=this.crossSheetFormulaEditorCache.editValue||e.editValue||"";this.initEditValue=n,this.initTextFormatRuns=e.textFormatRuns||[],this.initCellFormat=e.cellFormat||{},this.forceUpdateValue=e.forceUpdateValue||!1;var a=this.testFormula(n);a.isFormula&&(n=this.filterUnexpectedChars(n));var o=this.getCellRenderText();if(this.showStockResultBoard=this.canShowStockResultBoard(n,o,e.stockEditAsFormula||!1),this.prepareForShow(e&&e.firstCharForQuickInput?e.firstCharForQuickInput:n,e.cellFormat,e.textFormatRuns,e.mentionDetails,e.cursor),this.isInCrossSheetFormulaEditingMode()&&!this.isInOriginSheet()){this.alloyRTE.getSelection();return this.stage.tableData.inputStatus=3,this.stage.selectData.setSelectStatus(g.SELECT_STATUS.FORMULA),void this.showFormulaDetail(n)}a.isStock?(this.showStock(n),this.showStockResultBoard&&this.stage.event.eventInput.trigger("inputHide",{discardValue:!0,showStockResultBoard:!0})):a.isFormula?this.showFormulaDetail(n):this.closeFormulaBoard()}},{key:"prepareForShow",value:function(e,t,i,n,a){this.prepareInputBoxForPC(e,t,i,n,a)}},{key:"prepareInputBoxForPC",value:function(e,t,i,n,a){var o=this,l=(0,r.calcCellFormatStyles)(t),h=(0,r.calcTextFormatStyles)(i),g=1===this.stage.tableData.inputStatus&&"@"===e;this.alloyRTE.show(e,l,h,n,a,g),this.positionTable({cb:function(){o.showing=!0,o.resize()}}),2===this.stage.tableData.inputStatus&&"undefined"===typeof a&&this.alloyRTE.collapseToEnd(),s.isFireFox?u.default.wait(0).run(function(){o.inputContentHeight=o.parseInputContentHeight()}):this.inputContentHeight=this.parseInputContentHeight()}},{key:"prepareInputBoxForMobileAndPad",value:function(e,t,i,n,a){var o=this,s=(0,r.calcCellFormatStyles)(t),l=(0,r.calcTextFormatStyles)(i);this.alloyRTE.show(e,s,l,n,a),this.setBoardStyles(this.inputBox,{"background-color":s["background-color"]}),this.setBoardStyles(this.inputBox,{display:"block",left:"-100px",top:"-100px"}),this.alloyRTE.hasFocus()||(document.activeElement.blur(),this.alloyRTE.focus()),this._tableAutoAdjust=!0,this.positionTable({cb:function(){o._tableAutoAdjust=!1,o.showing=!0,3===o.stage.tableData.tableStatus&&(o.resize(),o.move())}}),1!==this.stage.tableData.inputStatus&&2!==this.stage.tableData.inputStatus||("number"===typeof a?this.alloyRTE.changeCursor(a):this.alloyRTE.collapseToEnd(),this.alloyRTE.scrollToBottom())}},{key:"showStock",value:function(e){var t=e;"undefined"===typeof t&&(t=this.alloyRTE.getText());var i=null;i=this.getCurrentRange(),this.stage.event.eventFormula.trigger("enterFormula"),this.stage.event.eventFormula.trigger("resolveFormula",{value:t,cursor:i?i.start:t.length,isStock:!0,showStockBoard:this.showStockResultBoard})}},{key:"showFormulaDetail",value:function(e){var t=e;"undefined"===typeof t&&(t=this.alloyRTE.getText());var i=this.getCurrentRange();this.stage.event.eventFormula.trigger("enterFormula"),this.stage.event.eventFormula.trigger("resolveFormula",{value:t,cursor:i?i.start:t.length})}},{key:"closeFormulaBoard",value:function(){this.stage.event.eventFormula.trigger("leaveFormula"),this.stage.event.eventFormula.trigger("hideFormula")}},{key:"valueChange",value:function(e,t){var i=this.initCellFormat&&this.initCellFormat.textFormat,n=i&&i.strikethrough||!1,a=!(!i||"number"!==typeof i.underline)&&i.underline>0;this.alloyRTE.changeText(e,n,a),this.checkInputValue(e,t),this.realTimeHeightUp()}},{key:"cursorChange",value:function(e){this.alloyRTE.changeCursor(e),this.checkInputValue(this.alloyRTE.getText())}},{key:"valueAndCursorChange",value:function(e,t,i){if("undefined"===typeof e)e=this.getCurrentText();else{var n=this.initCellFormat&&this.initCellFormat.textFormat,a=n&&n.strikethrough||!1,o=!(!n||"number"!==typeof n.underline)&&n.underline>0;this.alloyRTE.changeText(e,a,o)}"number"===typeof t&&this.alloyRTE.changeCursor(t),this.checkInputValue(e,i),this.realTimeHeightUp(),this.isInOriginSheet()||3===this.stage.tableData.inputStatus||(this.stage.tableData.inputStatus=3)}},{key:"testFormula",value:function(e){var t=e||this.alloyRTE.getText();t=this.filterUnexpectedChars(t);var i=!1,n=window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(this.yIndex,this.xIndex);if(n){var a=(0,v.getExportFormat)(n);a&&(0,c.isTextCell)(a.getNumberFormat())&&(i=!0)}return{isFormula:!i&&/^=$|^=[^=]/.test(t),isStock:/^=STOCK\(/i.test(t)}}},{key:"filterUnexpectedChars",value:function(e){var t=e;return t&&"string"===typeof t&&(t=(t=(t=t.replace(/\r\n$/,"\n")).replace(/\n$/,"")).replace(String.fromCharCode(65279),"")),t}},{key:"setCellDataValue",value:function(){if(!this.inValid){var e=String.fromCharCode(10),t=this.parseInputBoardInfos(),i=t.text,n=t.textFormatRuns,a=t.mentionDetailsMap,o=this.initEditValue!==i,s=!(0,r.checkTextFormatRunsEqual)(this.initTextFormatRuns,n);this.testFormula(i).isFormula&&(n=null,s=!0,a=null),o||s||this.forceUpdateValue||/^=(rand|now)/i.exec(i)?this.stage.hookFunc.setCellData&&this.stage.hookFunc.setCellData(this.xIndex,this.yIndex,i,o,n,s,a):i&&i.indexOf(e)>=0?this.stage.hookFunc.updateCellTextwrapStyleIfNeed&&this.stage.hookFunc.updateCellTextwrapStyleIfNeed(this.xIndex,this.yIndex):this.stage.hookFunc.setCellData&&this.stage.hookFunc.setCellData(this.xIndex,this.yIndex,i,o,n,s,a)}}},{key:"parseInputBoardInfos",value:function(){var e=this,t=this.stage.hookFunc.parse2TextFormat,i=this.stage.hookFunc.parse2TextFormatRuns,n=this.stage.hookFunc.parse2MentionDetailsMap,a=this.alloyRTE.getText();a=this.preproccessTextValue(a);var o=this.alloyRTE.getInputDom(),s=(0,r.parseHtml2TextFormatInfos)(o);console.log("--\u6587\u672c\u6837\u5f0f textFormatInfos --\uff1a",s);var l=(0,r.parseMentionsFromInputDom)(o);console.log("--\u8f93\u5165\u6846 mentions \u4fe1\u606f\uff1a",l);var h=i(s=s.map(function(i){var n=t(i.style,e.initCellFormat.textFormat);if(!n){var a=null;e.initCellFormat.textFormat?a=e.initCellFormat.textFormat:e.stage.hookFunc.generateDefaultTextFormat&&(a=e.stage.hookFunc.generateDefaultTextFormat()),n=a}return{text:i.text,textFormat:n}}))||[];console.log("--\u6587\u672c\u6837\u5f0f textFormatRuns --\uff1a",h);var g=l&&l.length?n(l):null;return console.log("--\u8f93\u5165\u6846 mentionDetailsMap --\uff1a",g),{text:a,textFormatRuns:h,mentionDetailsMap:g}}},{key:"preproccessTextValue",value:function(e){var t=e;return"undefined"===typeof t&&(t=this.alloyRTE.getText()),this.testFormula(t).isFormula&&(t=(0,l.fixRightBracket)(t),t=this.filterUnexpectedChars(t)),t}},{key:"parseInputContentHeight",value:function(){var e=this.alloyRTE.getInputDom();e.appendChild(document.createElement("br")),e.style.left="-10000px",e.style.top="-10000px",e.style.height="",document.body.appendChild(e);var t=e.getBoundingClientRect();return document.body.removeChild(e),t.height}},{key:"realTimeHeightUp",value:function(){if(this.isAutoTextWrap&&!this.isSetHeight&&!this.isMergeCell){var e=this.getCurrentCell(),t=e.merge,i=e.mergeData;if(!0!==t||i.yRange[1]!==i.yRange[0]){var n=this.parseInputContentHeight()+4;if(this.inputContentHeight!==n){var a=this.getNewRowHeight(n);this.inputContentHeight!==a&&(this.stage.setRowHeight(this.yIndex,a,!1),this.inputContentHeight=a,a+=1,this.setBoardStyles(this.boardContainer,{"min-height":a+"px","max-height":a+"px"}),this.alloyRTE.setEitorContainerStyles({"min-height":a-4+"px","max-height":a-4+"px"}),this.alloyRTE.setEditorInputStyles({height:a-4+"px"}))}}}}},{key:"getNewRowHeight",value:function(e){for(var t=[],i=void 0,n=this.stage.tableData,a=0;a<n.col.length;a++)(i=n.getCellDataAtPosition(this.yIndex,a,h.GET_CELLDATA.NORMAL))&&t.push(i.getTextHeight());e&&t.splice(this.xIndex,1,e);var o=Math.max.apply(null,t),s=this.stage.configData.rowHeight;o=Math.max(o,s);var r=void 0,l=this.stage.areaData.row.getViewportTop(this.yIndex),g=12+(this.areaY===h.TABLE_AREA.FLOW?4:0);return r=this.stage.areaData.row.flow.maxDistance-l-g,o=Math.min(o,r)}},{key:"isInCrossSheetFormulaEditingMode",value:function(){return!1}},{key:"isInOriginSheet",value:function(){return!0}},{key:"getOriginSheetId",value:function(){return this.crossSheetFormulaEditorCache.originSheetId}},{key:"setCrossSheetFormulaEditorCache",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0]}},{key:"resetCrossSheetFormulaEditorCache",value:function(){this.crossSheetFormulaEditorCache={originSheetName:"",originSheetId:"",startSheetName:"",startSheetId:"",endSheetName:"",endSheetId:"",editValue:"",isInCrossSheetFormulaEditingMode:!1,cursorPosition:0}}},{key:"syncValueToToolbarInputBox",value:function(e){!this.stage.hookFunc.afterInput||1!==this.stage.tableData.inputStatus&&2!==this.stage.tableData.inputStatus||this.showing&&this.stage.hookFunc.afterInput(e)}},{key:"resolveCellConflictWith",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],s=this.initCellFormat&&this.initCellFormat.textFormat&&this.initCellFormat.textFormat.clone()||null,r=this.stage.hookFunc.generateTextFormatRun&&this.stage.hookFunc.generateTextFormatRun(0,s),l=String.fromCharCode(10);e=t+l+l+a,i&&i.length||(i=[r.clone()]);var h=r.clone();h.setProperties({startIndex:t.length}),o&&o.length||(o=[r.clone()]);var g=t.length+2;return o=o.map(function(e){return e.setProperties({startIndex:e.startIndex+g}),e}),{mergedValue:e,mergedTextFormatRuns:[].concat((0,n.default)(i),[h],(0,n.default)(o))}}}]),e}();t.default=C},1228:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=A(i(24)),a=A(i(0)),o=A(i(1)),s=A(i(680)),r=i(285),l=A(r),h=A(i(681)),g=A(i(682)),c=A(i(684)),d=A(i(1232)),u=A(i(685)),f=i(192),v=A(i(402));function A(e){return e&&e.__esModule?e:{default:e}}var C=function(){function e(t){(0,a.default)(this,e);var i=t.parent||document,n=t.className||"",o=function(){};this.hooks={undoRedoStateChange:t.undoRedoStateChange||o,formatStateChange:t.formatStateChange||o,exitHandler:t.exitHandler||o,valueChange:t.valueChange||o,selectionChange:t.selectionChange||o,blur:t.blurHandler||o,_tdwReport:t._tdwReport||o,_mentionBlockFuncs:t._mentionBlockFuncs||null},this.defEditorStyles=t.defCellStyles||null,this.defTextStyles=t.defTextStyles||null,this.platform=t.platform||"PC",this._initEditor(i,n),this.env=u.default,this.textService=new s.default(this),this.selection=new l.default(this),this.clipboard=new h.default(this),this.formater=new d.default(this),("boolean"!==typeof t.enableMention||t.enableMention)&&(this.mentionBlock=new v.default(this,this.hooks._mentionBlockFuncs)),this.keyBoard=new g.default(this,{bindings:this._getKeyboardDefaultsBinding()}),this.history=new c.default(this,c.default.DEFAULTS),this.currSelection=null,this.currFormat=null,this.setStyles(this.input,this.defEditorStyles),this.initBlurEvent(),this.polyfillSelectionChangeOnMobile(),this.polyfillSelectionChangeOnPC()}return(0,o.default)(e,[{key:"initBlurEvent",value:function(){var e=this;this.attachEventToInput("blur",function(t){e.hooks.blur(t)})}},{key:"polyfillSelectionChangeOnMobile",value:function(){var e=this;"PC"!==this.platform&&document.addEventListener("selectionchange",function(t){(t&&t.target&&t.target.activeElement||document.activeElement)===e.input&&(e.history.updateSelection(),e.selectionChange())})}},{key:"polyfillSelectionChangeOnPC",value:function(){var e=this;"PC"===this.platform&&(this.input.addEventListener("mousedown",function(t){e._mouseDownFlag=!0}),document.addEventListener("mouseup",function(t){document.activeElement===e.input&&e._mouseDownFlag&&(e.history.updateSelection(),e.selectionChange()),e._mouseDownFlag=!1}))}},{key:"attachEventToInput",value:function(e,t){this.input.addEventListener(e,t)}},{key:"_getKeyboardDefaultsBinding",value:function(){return{bold:this.doFormatHandler("bold"),italic:this.doFormatHandler("italic"),underline:this.doFormatHandler("underline"),strikethrough:this.doFormatHandler("strikeThrough")}}},{key:"doFormatHandler",value:function(e){var t=this;return{key:"strikeThrough"===e?"5":e[0],shortKey:!0,handler:function(i,n){return t.format(e)}}}},{key:"_initEditor",value:function(e,t){this.root=document.createElement("div"),this.root.classList.add(t),this.root.setAttribute("spellcheck",!1),this.root.style["overflow-y"]="auto",this.root.style["overflow-x"]="hidden",this.input=document.createElement("div"),this.input.setAttribute("id","alloy-rich-text-editor"),this.input.setAttribute("contenteditable",!0),this.input.style.padding="0px 2px",this.input.style.display="table-cell",this.input.style["white-space"]="pre-wrap",this.input.setAttribute("tabindex","1"),this.input.style["word-break"]="break-word",this.input.style["word-wrap"]="break-word",this.root.appendChild(this.input),e.appendChild(this.root)}},{key:"setEitorContainerStyles",value:function(e){this.setStyles(this.root,e)}},{key:"setEditorInputStyles",value:function(e){this.setStyles(this.input,e)}},{key:"setStyles",value:function(e,t){for(var i in t)if(t.hasOwnProperty(i)){var n=t[i];e.style[i]=n}}},{key:"initEditorContent",value:function(e,t,i){for(var n=this;this.input.firstChild;)this.input.removeChild(this.input.firstChild);var a=this.selection.createFillingCharNode();if(e&&e.length){this._prepareEditorContent(e,t,i).forEach(function(e){var t=document.createDocumentFragment();t.appendChild(e.cloneNode(!0)),n.input.appendChild(t.cloneNode(!0))})}else{var o=this.createSpanWith(t[0].format,this.env.iOS||this.env.safari?"":a);this.input.appendChild(o)}var s=this.input.lastChild;if(!s||"BR"!==s.tagName){var r=document.createElement("br");r.className="extra",this.input.appendChild(r)}}},{key:"_splitTextFormatRunByMentionDetails",value:function(e,t){if(!t||!t.length)return[{pos:e}];var i=[],n=t.filter(function(t){return e[0]<=t.pos[0]&&t.pos[1]<=e[1]});if(n.length>0){for(var a=e[0],o=void 0,s=0;s<n.length;s++)a<(o=n[s]).pos[0]&&i.push({pos:[a,o.pos[0]]}),i.push({pos:o.pos,mention:o}),a=o.pos[1];return a<e[1]&&i.push({pos:[a,e[1]]}),i}return[{pos:e}]}},{key:"_prepareEditorContent",value:function(e,t,i){for(var a=this,o="",s=null,r=null,l=0,h=0,g=[],c=0;c<t.length;c++){s=t[c],r=c+1<t.length?t[c+1]:null,l=s.startIndex,h=r?r.startIndex:e.length,this._splitTextFormatRunByMentionDetails([l,h],i).forEach(function(t){o=e.substring(t.pos[0],t.pos[1]),t.mention?g.push.apply(g,(0,n.default)(a.createMentionWidth(o,s.format,t.mention))):g.push(a.createSpanWith(s.format,o))})}return g}},{key:"createSpanWith",value:function(e,t){var i=document.createElement("span");return"string"===typeof t?i.innerText=t:t.nodeType===Node.TEXT_NODE&&i.appendChild(t),e&&this.setStyles(i,e),i}},{key:"createMentionWidth",value:function(e,t,i){return this.mentionBlock.create(i)}},{key:"show",value:function(e,t,i,n,a){var o=this,s=arguments.length>5&&void 0!==arguments[5]&&arguments[5];this.setStyles(this.input,t),this.initEditorContent(e,i,n),this.focus(),"number"===typeof a?this.selection.collapseToPoint(a):this.env.ie&&this.selection.collapseToEnd(this.getText().length),setTimeout(function(){o.history.save(!0),o.currSelection=o.getSelection(),o.currFormat=o.queryFormats(),o.hooks.formatStateChange(o.currFormat)}),s&&setTimeout(function(){o.mentionBlock.checkWhetherCanTriggerMention()})}},{key:"changeText",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.history.clear();var n={};(t||i)&&(n["text-decoration"]="",n["text-decoration-skip-ink"]="none",t&&(n["text-decoration"]+="line-through"),i&&(n["text-decoration"]+=" underline"));var a=[{startIndex:0,format:n}];this.initEditorContent(e,a),this.valueChange()}},{key:"changeCursor",value:function(e){var t=new r.Range(e,e);this.setSelection(t),this.selectionChange()}},{key:"clearHistory",value:function(){this.history.clear()}},{key:"hide",value:function(){for(this.setEitorContainerStyles({"min-width":"0px","max-width":"0px","min-height":"0px","max-height":"0px"}),this.setEditorInputStyles({height:"",width:"","min-width":"","font-style":"normal","font-weight":"normal"});this.input.firstChild;)this.input.removeChild(this.input.firstChild);this.history.clear(),this.currSelection=null,this.currFormat=null}},{key:"blur",value:function(){this.selection.blur()}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"focus",value:function(){this.selection.focus()}},{key:"undo",value:function(){this.history.undo()}},{key:"redo",value:function(){this.history.redo()}},{key:"collapseToEnd",value:function(){this.selection.collapseToEnd()}},{key:"valueChange",value:function(){var e=this,t=this.getText();setTimeout(function(){e.hooks.valueChange(t),e.selectionChange()})}},{key:"selectionChange",value:function(e){var t="undefined"===typeof e?this.getSelection():e;(!this.currSelection&&t||this.currSelection&&t&&!this.currSelection.equals(t))&&(this.hooks.selectionChange(t),this.currSelection=t,this.formatChange())}},{key:"formatChange",value:function(){var e=this.queryFormats();for(var t in e)if(e.hasOwnProperty(t)&&null===e[t])return;(0,f.isEquivalent)(this.currFormat,e)||(this.hooks.formatStateChange(e),this.currFormat=e)}},{key:"queryFormats",value:function(){return this.formater.queryFormats()}},{key:"format",value:function(e,t){return this.hooks._tdwReport&&this.hooks._tdwReport(e),this.formater.format(e,t)}},{key:"deleteText",value:function(){return this.formater.deleteText()}},{key:"getCurrentState",value:function(){var e=this.getSelection();return{content:this.getContent(),selection:e}}},{key:"updateContent",value:function(e){this.textService.setHTMLContent(e);var t=this.findFillingCharNode(this.input);t&&this.selection.initFillingCharNode(t),this.valueChange()}},{key:"findFillingCharNode",value:function(e){if(e&&e.nodeType===Node.TEXT_NODE){if(e.nodeValue.indexOf(f.FillingChar)>=0)return e}else for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];return this.findFillingCharNode(i)}}},{key:"getInputDom",value:function(){return this.textService.getInputDom()}},{key:"getContent",value:function(){return this.textService.getHTMLContent()}},{key:"getData",value:function(){return this.textService.getData()}},{key:"getRawData",value:function(){return this.textService.getData(!0)}},{key:"getText",value:function(){return this.getData()}},{key:"getRawText",value:function(){return this.getRawData()}},{key:"getSelectedText",value:function(){return this.textService.getSelectedText()}},{key:"getSelection",value:function(){var e=null;try{"PC"!==this.platform&&this.selection.removeFillingCharNode(),e=this.selection.getRange()}catch(n){if(console.error("AlloyEditor get selection error!"),document.getSelection().removeAllRanges(),this.currSelection)this.setSelection(this.currSelection);else{var t=this.getText()||"",i=t&&t.length||0;this.changeCursor(i)}}if(e)return e}},{key:"setSelection",value:function(e){this.focus(),this.selection.setRange(e)}},{key:"isCollapsed",value:function(){return this.selection.isCollapsed()}},{key:"isSelectedAll",value:function(){var e=this.currSelection;e||(e=this.getSelection());var t=this.getText();return!!e&&e.end-e.start>=t.length}},{key:"scrollToBottom",value:function(){var e=this.root;e.scrollTop=e.scrollHeight}},{key:"insertNewLine",value:function(){this.selection.removeFillingCharNode();var e=this.input.lastChild;if(!e||"BR"!==e.nodeName){var t=document.createElement("br");t.className="extra",this.input.appendChild(t)}this.textService.doLineBreak(),this.history.save(!0),this.history.refreshState(),this.selectionChange(),this.valueChange()}}]),e}();t.default=C},1229:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.editor=t}return(0,a.default)(e,[{key:"render",value:function(){}},{key:"createElementFromHTML",value:function(e){var t=document.createElement("div");return t.innerHTML=e.trim(),t.firstChild}}]),e}();t.default=s},1230:function(e,t,i){var n=i(1231);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1231:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,"#alloy-rich-text-editor .alloy-mention-block {\n    display: inline-block;\n    position: relative;\n    width: auto;\n    height: 22px;\n    line-height: 22px;\n    font-size: 10pt;\n    font-style: normal;\n    font-weight: normal;\n    text-decoration: none;\n    color: #000000;\n    background-color: #ffffff;\n    font-family: 'PingFang SC', 'Microsoft YaHei', '\u9ed1\u4f53', '\u5b8b\u4f53', sans-serif;\n    border: 1px solid rgba(0, 0, 0, 0.12);\n    border-radius: 11px;\n    box-sizing: border-box;\n    cursor: pointer;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n    padding-left: 7px;\n    padding-right: 20px;\n    margin-left: 1px;\n    margin-right: 1px;\n    vertical-align: text-bottom;\n    /* mention block \u6700\u5927\u5bbd\u5ea6100px */\n    max-width: 100px;\n    white-space: nowrap;\n}\n#alloy-rich-text-editor .alloy-mention-block:hover {\n    background-color:#f4f4f4;   \n}\n\n#alloy-rich-text-editor .alloy-mention-block:active {\n    background-color:#eaeaea;\n}\n\n.alloy-mention-block::after {\n    content: ' ';\n    display: inline-block;\n    position: absolute;\n    border-width: 5px 4px;\n    border-style: solid;\n    border-color: #c1c1c1 transparent transparent transparent;\n    top: 50%;\n    right: 0%;\n    -webkit-transform: translate(-50%, -25%);\n            transform: translate(-50%, -25%);\n    margin-right: 4px;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n}\n\n.mention-block-content {\n    /* mention block \u5185\u5bb9\u5bbd\u5ea6\u8d85\u8fc7 100px\uff0c\u4ee5\u7701\u7565\u53f7\u663e\u793a */\n    text-overflow: ellipsis;\n    overflow: hidden;\n    white-space: nowrap;\n}\n/* mention \u6574\u4f53\u9ad8\u5ea6\u8fd8\u662f22\uff0c\u901a\u8fc7fake text\u628a\u8f93\u5165\u6846\u7684\u9ad8\u5ea6\u6491\u8d77\u6765\uff0c\u907f\u514d\u51fa\u73b0\u6eda\u52a8\u6761 */\nspan[fake-text='start'] {\n    line-height: 20px;\n}\nspan[fake-text='end'] {\n    line-height: 20px;\n}\n",""])},1232:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(84)),a=r(i(0)),o=r(i(1)),s=i(192);function r(e){return e&&e.__esModule?e:{default:e}}var l=["bold","fontName","fontSize","foreColor","italic","strikeThrough","underline"],h=function(){function e(t){(0,a.default)(this,e),this.editor=t}return(0,o.default)(e,[{key:"deleteText",value:function(){return document.execCommand("delete")}},{key:"fontSize",value:function(e){if(this.editor.selection.isCollapsed()){var t=this.queryFormats(),i=(t.strikeThrough?"line-through ":"")+(t.underline?"underline":""),n=this.editor.createSpanWith({"font-size":e+"pt","font-weight":t.bold?"bold":"normal","font-style":t.italic?"italic":"normal",color:t.foreColor,"font-family":t.fontName,"text-decoration":""===i?"none":i},this.editor.selection.createFillingCharNode()),a=document.getSelection();if(a&&a.rangeCount>0){var o=a.getRangeAt(0);o.insertNode(n),o.setStartAfter(n),o.setStart(n,1),o.setEnd(n,1),o.collapse(!0),a.removeAllRanges(),a.addRange(o),this.editor.selectionChange()}}else{document.execCommand("styleWithCSS",!1,!1),document.execCommand("fontSize",!1,1);for(var s=[].slice.call(this.editor.input.querySelectorAll('FONT[size="1"]')),r=0;r<s.length;r++){var l=s[r];l.removeAttribute("size"),l.style.fontSize=e+"pt",(this.editor.env.ie||this.editor.env.firefox)&&this.removeChildrenStyle(l,"font-size")}}}},{key:"removeChildrenStyle",value:function(e,t,i){if(e){["span","font"].forEach(function(a){var o=e.querySelectorAll(a);(0,n.default)(o).forEach(function(e){t&&""!==e.style[t]&&(e.style[t]=""),i&&e.hasAttribute(i)&&e.removeAttribute(i)})})}}},{key:"format",value:function(e,t){var i=this;this.editor.env.ie&&!this.editor.hasFocus()&&this.editor.currSelection&&(this.editor.focus(),this.editor.setSelection(this.editor.currSelection));var a=!1;if(this.editor.env.firefox||this.editor.env.ie){var o=this.editor.getSelection();this.editor.getText().length<=o.end-o.start&&(a=!0,this.editor.setSelection(o),"fontSize"===e&&this.removeChildrenStyle(this.editor.input,"font-size"))}if(-1!==l.indexOf(e)){if("fontSize"===e)this.fontSize(t);else if(this.editor.env.ie&&this.editor.selection.isCollapsed())this.polyfillFormatForIEWhenCollapsed(e,t);else if(this.editor.env.ie&&"foreColor"===e&&(t=(0,s.rgbaTorgb)(t)),document.execCommand("styleWithCSS",!1,!0),document.execCommand(e,!1,t),a&&this.editor.env.ie){var r=document.getSelection(),h=null;r&&r.rangeCount>0&&(h=r.getRangeAt(0));var g=h&&h.commonAncestorContainer;if(g&&"bold"===e&&this.removeChildrenStyle(g,"font-weight"),g&&"italic"===e&&this.removeChildrenStyle(g,"font-style"),"foreColor"===e){var c=this.editor.input.querySelectorAll('font[color="'+t.replace(/\ /g,"")+'"]');(0,n.default)(c).forEach(function(e){i.removeChildrenStyle(e,"color","color")})}g&&"fontName"===e&&this.removeChildrenStyle(g,"font-family","face")}return this.editor.history.save(!0),this.editor.selection.focus(),this.editor.formatChange(),this.editor.history.refreshState(),!0}}},{key:"parseFormatStyleObj",value:function(e,t){var i={},n=this.queryCommand(e);return"bold"===e?i={"font-weight":n?"normal":"bold"}:"italic"===e?i={"font-style":n?"normal":"italic"}:"fontName"===e?i={"font-family":t}:"foreColor"===e?i={color:t}:"underline"===e?i=n?{}:{"text-decoration":"underline"}:"strikeThrough"===e&&(i=n?{}:{"text-decoration":"line-through"}),i}},{key:"polyfillFormatForIEWhenCollapsed",value:function(e,t){var i=this.editor.createSpanWith(this.parseFormatStyleObj(e,t),this.editor.selection.createFillingCharNode()),n=document.getSelection();if(n&&n.rangeCount>0){var a=n.getRangeAt(0);a.insertNode(i),a.setStartAfter(i),a.setStart(i,1),a.setEnd(i,1),a.collapse(!0),n.removeAllRanges(),n.addRange(a),this.editor.selectionChange()}}},{key:"queryFormats",value:function(){var e=this,t={};return l.forEach(function(i){t[i]=e.queryCommand(i)}),t}},{key:"queryCommand",value:function(e){if("fontSize"===e){var t=this.editor.getSelection();t&&!t.isCollapsed()&&this.editor.env.ie&&this.editor.setSelection(t);var i=document.getSelection(),n=i&&i.rangeCount&&i.getRangeAt(0),a=n.endContainer||n.startContainer;if(t&&!t.isCollapsed()){var o=this.editor.getSelectedText(),r=(0,s.removeFillingCharString)(n.startContainer.textContent||n.startContainer.innerText),l=(0,s.removeFillingCharString)(n.endContainer.textContent||n.endContainer.innerText);o===r?a=n.startContainer:o===l&&(a=n.endContainer)}return a&&a.nodeType===Node.TEXT_NODE&&(a=a.parentNode),this.queryFontSize(a)}var h=void 0;if(this.editor.env.firefox){if(!this.editor.hasFocus()){if(this.editor.focus(),!this.editor.currSelection)return null;this.editor.setSelection(this.editor.currSelection)}var g=document.queryCommandState(e);if("foreColor"===e||"fontName"===e){var c=this.editor.defEditorStyles.color,d=this.editor.defEditorStyles["font-family"];h=(h=document.queryCommandValue(e))||("foreColor"===e?c:d)}else h=g}else"string"===typeof(h=document.queryCommandValue(e))?"true"===h.toLocaleLowerCase()?h=!0:"false"===h.toLocaleLowerCase()&&(h=!1):"number"===typeof h&&(h=(0,s.decimalNumberToRGBColor)(h));return h}},{key:"queryFontSize",value:function(e){if(e&&e.nodeType===Node.TEXT_NODE&&(e=e.parentNode),!e||!(e instanceof Element))return 10;var t=null;window.getComputedStyle?t=window.getComputedStyle(e,null):e.currentStyle&&(t=e.currentStyle);var i=t&&t["font-size"];return this._parseFontsize(i)}},{key:"_extractNumberFromString",value:function(e){var t=/[+-]?\d+(?:\.\d+)?/g.exec(e);return t&&t.length&&Number(t[0])||10}},{key:"_parseFontsize",value:function(e){var t=10;return/pt$/i.test(e)?t=this._extractNumberFromString(e):/px$/i.test(e)&&(t=Math.round(3*this._extractNumberFromString(e)/4)),t}}]),e}();t.default=h},1233:function(e,t,i){var n=i(1234);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1234:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".table-input-board .table-input-editor {\n}\n\n.table-input-board {\n    position: absolute;\n    top: 0;\n    left: 0;\n    z-index: 105;\n    width: 100%;\n}\n\n.table-input-board-container {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: auto;\n    height: auto;\n    border: 2px #5292f7 solid;\n    z-index: 105;\n    background-color: #ffffff;\n    box-sizing: border-box;\n    -webkit-transform-origin: top left;\n            transform-origin: top left;\n}\n\n.table-input-box {\n    background-color: #ffffff;\n    position: absolute;\n    text-align: left;\n    top: -10000px;\n    max-height: 9900px;\n    max-width: 9900px;\n    margin: 0;\n    z-index: 15;\n    resize: none;\n    white-space: pre-wrap;\n    outline: none;\n    /* -webkit-box-shadow: 0 2px 5px rgba(0,0,0,0.4);\n    -moz-box-shadow: 0 2px 5px rgba(0,0,0,0.4);\n    box-shadow: 0 2px 5px rgba(0,0,0,0.4); */\n    word-wrap: keep-all;\n    box-sizing: border-box;\n    padding-left: 1px;\n    padding-right: 2px;\n    /*overflow: auto;*/\n    word-wrap: break-word;\n    overflow-wrap: break-word;\n    /*overflow-x: hidden;*/\n}\n\n.table-input-box::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n    border: 2px #5292f7 solid;\n}\n\n.table-input-box-on-scroll {\n    overflow: scroll;\n    overflow-x: hidden;\n    border: 2px #5292f7 solid;\n}\n\n.table-input-box-on-scroll::before {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    pointer-events: none;\n    border: none;\n}\n\n.table-input-tooltip-card {\n    background-color: #4589eb;\n    border-radius: 1px;\n    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.5);\n    color: white;\n    font-size: 12px;\n    line-height: 14px;\n    padding: 6px 7px 4px 7px;\n    display: none;\n    position: absolute;\n    top: -26px;\n    left: -2px;\n    white-space: nowrap;\n}\n\n.table-input-formula-card {\n    display: none;\n    border-top-left-radius: 2px;\n    border-bottom-left-radius: 2px;\n    box-shadow: 0px 1px 2px rgba(0, 0, 0, 0.5);\n    width: 14px;\n    height: 17px;\n    position: absolute;\n    top: 0px;\n    left: -14px;\n    cursor: pointer;\n    background-position: center;\n    background-repeat: no-repeat;\n    background-size: 7px 9px;\n    background-color: #0188fb;\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAYAAAAJCAYAAAARml2dAAAAAXNSR0IArs4c6QAAAHFJREFUCB1j+P//vzgQrwXiD0D8DIgrGEAAKngQSGsCcToQg4AzSOIUEAdCFTEC2SCdyWBdMAIokATEf4BYBiYG0hkKxN+BOAQuCGIABW4CcSOKIFQiDSghjyIBFBAD4utA7A+TYIIyvgHpq0D8EiYBAHInaFZrZrN4AAAAAElFTkSuQmCC);\n}\n\n.table-input-content {\n    width: 100%;\n    height: 100%;\n    /*margin: 1px auto 0;*/\n    outline: none;\n    cursor: text;\n    -webkit-user-modify: read-write-plaintext-only;\n    /*white-space: pre-wrap;*/\n    /*-webkit-transform: translateZ(0);*/\n    padding: 0px 3px;\n    box-sizing: border-box;\n    overflow-y: auto;\n    overflow-x: hidden;\n}\n\n.table-input-content::-webkit-scrollbar {\n    height: 16px;\n    overflow: visible;\n    width: 16px;\n}\n\n.table-input-content::-webkit-scrollbar-button {\n    height: 0;\n    width: 0;\n}\n\n.table-input-content::-webkit-scrollbar-thumb {\n    background-color: rgba(0, 0, 0, 0.2);\n    background-clip: padding-box;\n    border: solid transparent;\n    border-width: 1px 1px 1px 6px;\n    min-height: 28px;\n    padding: 100px 0 0;\n    box-shadow: inset 1px 1px 0 rgba(0, 0, 0, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.07);\n}\n\n/* @media only screen and (min-device-pixel-ratio: 2) */\n@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n    .table-input-formulacard {\n        background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAASCAYAAABvqT8MAAAAAXNSR0IArs4c6QAAAQpJREFUKBWlkL1KA0EUhbNBO8FeBE06HyGQreyEdDaCnSnyGnmL2KRMFYhYCPa2WkasZJUtLIT8SQghTL67zAw7lwkWOfAx99x75jK7lYqVMeYc+vAGc8jgGa5cxp80b2EBu3RfDtdI/dnkF2cbmiBLxuB0U1zCyTNESzj1myjwJ+CWPboL8mbRqBx2Nf2XYmrMp/QO4AO+4QliOrbNaWwY9Njcstvl6AVDbQikMJMkkvNMZ7xneAnuY3+pG36oC4bymycg+oELnQk8gYEk0QbSYBgzhGSr6DU2l9+qJb84hwc92N/zjCMYwjvc/buRUAecVhSH+lJVNbKSz5MkWZd8vGTrNXShHktsAcjcK1FxeHmnAAAAAElFTkSuQmCC);\n    }\n} /*  endof @media */\n",""])},1235:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(3)),a=l(i(0)),o=l(i(1)),s=l(i(4)),r=l(i(5));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.initStyle(),i.initMouse(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1245)}},{key:"initMouse",value:function(){}}]),t}(l(i(1236)).default);t.default=h},1236:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=l(i(1237)),s=l(i(1241)),r=i(10);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.init()}return(0,a.default)(e,[{key:"init",value:function(){var e=this.stage.areaData,t=document.createElement("div");t.className="x-scroll-board",this.xContainer=t;var i=document.createElement("div");i.className="y-scroll-board",this.yContainer=i,e.col.flow.scroll=new o.default({right:0,area:r.TABLE_AREA.FLOW,stage:this.stage,container:t}),e.row.flow.scroll=new s.default({bottom:0,area:r.TABLE_AREA.FLOW,stage:this.stage,container:i}),this.container.appendChild(t),this.container.appendChild(i)}}]),e}();t.default=h},1237:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i(3)),a=d(i(0)),o=d(i(1)),s=d(i(4)),r=d(i(5)),l=d(i(1238)),h=i(10),g=d(i(12)),c=i(10);function d(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.smooth=!1,i.fnBoxMouseup=function(){i.smooth=!1,document.removeEventListener("mousemove",i.fnBoxMousemove),document.removeEventListener("mouseup",i.fnBoxMouseup)},i.fnBoxMousemove=function(e){var t=e.clientX-i.cacheOffsetX-i.stage.configData.distanceX-i.stage.areaData.col[i.area].viewStart,n=i.stage.areaData.col[i.area].viewWidth-2*c.SCROLL_MARGIN,a=t/n;if(a<0?a=0:a>1&&(a=1),t<=n-i.box.clientWidth?i.box.style.webkitTransform=i.box.style.transform=t>=0?"translateX("+t+"px)":"translateX(0px)":i.box.style.webkitTransform=i.box.style.transform="translateX("+(n-i.box.clientWidth)+"px)",i.stage.scrollToPxInX(a),i.stage.configData.inToastPreview){var o=document.getElementById("preview-scalebar-contanier");o&&o.classList.add("hidden")}},i.fnWrapMousedown=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2],a=arguments[3],o=i.stage.areaData,s=o.col,r=s[i.area],l=(e.clientX-i.stage.configData.distanceX-s[i.area].viewStart)/(s[i.area].viewWidth-2*c.SCROLL_MARGIN),d=r.offsetX/r.maxOffsetX;o.areaX=h.TABLE_AREA.FLOW,o.areaY=h.TABLE_AREA.FLOW,void 0!==a&&a!==l>d||(l>d?(!0===n&&(i.reqAnimId=requestAnimationFrame(function(){return i.fnWrapMousedown(e,t,n,l>d)})),i.stage.scrollOneInX(1)):(!0===n&&(i.reqAnimId=requestAnimationFrame(function(){return i.fnWrapMousedown(e,t,n,l>d)})),i.stage.scrollOneInX(-1)),!0!==n&&(g.default.erase(i.longPressId),g.default.wait(300).run(function(){i.fnWrapMousedown(e,2,!0,l>d)})))},i.longPressId=null,i.reqAnimId=null,i.fnWrapMouseUp=function(e){clearInterval(i.longPressId),cancelAnimationFrame(i.reqAnimId)},i.initMouse(),i.initStyle(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1239)}},{key:"update",value:function(){if(!this.smooth){var e=this.stage.areaData.col[this.area],t=e.offsetX/e.maxOffsetX*this.diffWidth>>0;this.box.style.webkitTransform=this.box.style.transform="translateX("+t+"px)"}}},{key:"initMouse",value:function(){var e=this;this.box.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),e.cacheOffsetX=t.offsetX,e.smooth=!0,e.stage.areaData.areaX=h.TABLE_AREA.FLOW,e.stage.areaData.areaY=h.TABLE_AREA.FLOW,document.addEventListener("mousemove",e.fnBoxMousemove),document.addEventListener("mouseup",e.fnBoxMouseup)})}}]),t}(l.default);t.default=u},1238:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=i(10);i(22);function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){var i=this;(0,n.default)(this,e);var a=t.container,o=document.createElement("div");this.area=t.area,this.stage=t.stage,this.wrap=o,o.className="x-scroll-wrap";var s=document.createElement("div");this.box=s,s.className="x-scroll-box",o.appendChild(s),a.appendChild(o),this.hideTimer=null,this.autoMoveTick=null,this.autoMoveDiff=0,setTimeout(function(){i.calc()},0),this.stage.configData.hideXScroll&&(this.update=function(){}),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("reset",function(){e.calc()})}},{key:"calc",value:function(){var e=this.stage.areaData.col[this.area];if(0!==e.totalWidth){var t=e.viewWidth-2*o.SCROLL_MARGIN;this.wrap.style.left=this.stage.areaData.col[this.area].viewStart+o.SCROLL_MARGIN+"px",this.wrap.style.width=t+"px";var i=e.totalWidth;this.wrap.style.display=i<=t?"none":"block";var n=t/i*t>>0;n=Math.max(20,n),this.box.style.width=n+"px",this.diffWidth=t-n;this.stage.tableData.inputStatus;this.wrap.style.bottom="2px"}else this.hide&&this.hide()}}]),e}();t.default=r},1239:function(e,t,i){var n=i(1240);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1240:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".x-scroll-wrap {\n    position: absolute;\n    height: 12px;\n    padding: 2px 0;\n    bottom: 0px;\n    box-sizing: border-box;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    z-index: 102;\n    /* background-color: #ffffff; */\n}\n\n.x-scroll-box {\n    position: absolute;\n    height: 8px;\n    bottom: 2px;\n    background-color: #b0b0b0;\n    opacity: 0.88;\n    left: 0;\n    border-radius: 5px;\n    transition: background-color, height 0.15s cubic-bezier(0.25, 0.1, 0.25, 0.1);\n    overflow: hidden;\n}\n\n.x-scroll-box:hover {\n    opacity: 0.88;\n    height: 10px;\n    background-color: #888888;\n}\n\n.x-scroll-box:active {\n    opacity: 0.88;\n    height: 10px;\n    background-color: #888888;\n}\n",""])},1241:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(i(3)),a=d(i(0)),o=d(i(1)),s=d(i(4)),r=d(i(5)),l=d(i(1242)),h=i(10),g=d(i(12)),c=i(10);function d(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.smooth=!1,i.fnBoxMouseup=function(){i.smooth=!1,document.removeEventListener("mousemove",i.fnBoxMousemove),document.removeEventListener("mouseup",i.fnBoxMouseup)},i.fnBoxMousemove=function(e){var t=e.clientY-i.cacheOffsetY-i.stage.configData.distanceY-i.stage.areaData.row[i.area].viewStart,n=i.stage.areaData.row[i.area].viewHeight-2*c.SCROLL_MARGIN,a=t/n;a<0?a=0:a>1&&(a=1),t<=n-i.box.clientHeight?i.box.style.webkitTransform=i.box.style.transform=t>=0?"translateY("+t+"px)":"translateY(0px)":i.box.style.webkitTransform=i.box.style.transform="translateY("+(n-i.box.clientHeight)+"px)",i.stage.scrollToPxInY(a)},i.fnWrapMousedown=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments[2],a=arguments[3],o=i.stage.areaData,s=o.row,r=s[i.area],l=(e.clientY-i.stage.configData.distanceY-s[i.area].viewStart)/(s[i.area].viewHeight-2*c.SCROLL_MARGIN),d=r.offsetY/r.maxOffsetY;o.areaX=h.TABLE_AREA.FLOW,o.areaY=h.TABLE_AREA.FLOW,void 0!==a&&a!==l>d||(l>d?(!0===n&&(i.reqAnimId=requestAnimationFrame(function(){return i.fnWrapMousedown(e,t,n,l>d)})),i.stage.scrollOneInY(t)):l<d&&(!0===n&&(i.reqAnimId=requestAnimationFrame(function(){return i.fnWrapMousedown(e,t,n,l>d)})),i.stage.scrollOneInY(-t)),!0!==n&&(g.default.erase(i.longPressId),i.longPressId=g.default.wait(300).run(function(){i.fnWrapMousedown(e,3,!0,l>d)})))},i.longPressId=null,i.reqAnimId=null,i.fnWrapMouseUp=function(e){g.default.erase(i.longPressId),cancelAnimationFrame(i.reqAnimId)},i.initMouse(),i.initStyle(),i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"initStyle",value:function(){i(1243)}},{key:"update",value:function(){if(!this.smooth){var e=this.stage.areaData.row[this.area],t=e.offsetY/e.maxOffsetY*this.diffHeight>>0;this.box.style.webkitTransform=this.box.style.transform="translateY("+t+"px)"}}},{key:"initMouse",value:function(){var e=this;this.box.addEventListener("mousedown",function(t){t.stopPropagation(),t.preventDefault(),e.cacheOffsetY=t.offsetY,e.smooth=!0,e.stage.areaData.areaX=h.TABLE_AREA.FLOW,e.stage.areaData.areaY=h.TABLE_AREA.FLOW,document.addEventListener("mousemove",e.fnBoxMousemove),document.addEventListener("mouseup",e.fnBoxMouseup)})}}]),t}(l.default);t.default=u},1242:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=i(10);i(22);function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){var i=this;(0,n.default)(this,e);var a=t.container,o=document.createElement("div");this.area=t.area,this.stage=t.stage,this.wrap=o,o.className="y-scroll-wrap";var s=document.createElement("div");this.box=s,s.className="y-scroll-box",o.appendChild(s),a.appendChild(o),this.hideTimer=null,this.autoMoveTick=null,this.autoMoveDiff=0,setTimeout(function(){i.calc()},0),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("reset",function(){e.calc()})}},{key:"calc",value:function(){var e=this.stage.areaData.row[this.area];if(0!==e.totalHeight){var t=e.viewHeight-2*o.SCROLL_MARGIN;this.wrap.style.top=this.stage.areaData.row[this.area].viewStart+o.SCROLL_MARGIN+"px",this.wrap.style.height=t+"px";var i=e.totalHeight;this.wrap.style.display=i<=t?"none":"block";var n=t/i*t>>0;n=Math.max(20,n),this.box.style.height=n+"px",this.diffHeight=t-n,this.stage.areaData.col.flow.scroll.calc(),this.stage.areaData.col.flow.scroll.update()}else this.hide&&this.hide()}}]),e}();t.default=r},1243:function(e,t,i){var n=i(1244);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1244:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".y-scroll-wrap {\n    position: absolute;\n    width: 12px;\n    right: 0;\n    padding: 0 2px;\n    box-sizing: border-box;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n    z-index: 102;\n    /* background-color: #ffffff; */\n    transition: right 0.5s ease;\n}\n\n.y-scroll-box {\n    position: absolute;\n    width: 8px;\n    right: 2px;\n    top: 0;\n    border-radius: 5px;\n    background-color: #b0b0b0;\n    opacity: 0.88;\n    transition: background-color, width 0.15s cubic-bezier(0.25, 0.1, 0.25, 0.1);\n}\n\n.y-scroll-box:hover {\n    width: 10px;\n    background-color: #888888;\n}\n\n.y-scroll-box:active {\n    width: 10px;\n    background-color: #888888;\n}\n",""])},1245:function(e,t,i){var n=i(1246);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1246:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".x-scroll-board {\n    position: absolute;\n    bottom: 0;\n    left: 0;\n    right: 0;\n    height: 12px;\n    z-index: 106;\n    /* background-color: #f4f5f8; */\n    /* border-left: 1px solid #d8dade; */\n    cursor: auto;\n}\n\n.y-scroll-board {\n    position: absolute;\n    right: 0;\n    top: 0;\n    bottom: 0;\n    width: 12px;\n    z-index: 106;\n    /* background-color: #f4f5f8; */\n    /* border-top: 1px solid #d8dade; */\n}\n",""])},1247:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));o(i(166));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.topBoard=null,this.bottomBoard=null,this.list=[],this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"initStyle",value:function(){i(1248)}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("reset",function(){e._update()}),this.stage.event.eventTable.listen("scale",function(){e._update()}),this.stage.event.eventDimension.listen("updateFrozenCol",function(){e._update()}),this.stage.event.eventDimension.listen("updateFrozenRow",function(){e._update()})}},{key:"init",value:function(){var e=document.createElement("div");e.style.marginLeft=this.stage.configData.rowHeadWidth+1+"px",e.style.marginTop=this.stage.configData.colHeadHeight+1+"px",e.style.fontSize="0",this.wrap=e,this._initVertical(e),this._update(),this.container.appendChild(e)}},{key:"_update",value:function(){var e=this,t=this.stage.areaData,i=this.stage.configData.rowHeadWidth+1,n=this.stage.configData.colHeadHeight+1;this.wrap.style.marginLeft=i+"px",this.wrap.style.marginTop=n+"px",this.wrap.style.width=this.stage.width-i+"px",this.wrap.style.height=this.stage.height-n+"px",this.topBoard.style.height=t.row.frozen.maxDistance-(this.stage.configData.colHeadHeight+1)+2+"px",this.bottomBoard.style.paddingTop=(t.row.frozen.length>0?this.stage.configData.frozenWidth:0)-2+"px",this.bottomBoard.style.height=t.row.flow.viewHeight+"px";var a=t.col.frozen.viewWidth+"px",o=t.col.flow.viewWidth+"px",s=0;0===t.row.frozen.length||t.row.frozen.viewHeight<=0?this.topBoard.style.display="none":this.topBoard.style.display="block",0!==t.row.frozen.length&&t.row.frozen.viewHeight<=0?this.bottomBoard.style.top="-1px":this.bottomBoard.style.top="0px",this.list.forEach(function(i){s%2===0?(i.parent.style.width=a,0===t.col.frozen.length||t.col.frozen.viewWidth<=0?i.parent.style.display="none":i.parent.style.display="block"):(i.parent.style.marginLeft=(t.col.frozen.length>0?e.stage.configData.frozenWidth-2:0)+"px",i.parent.style.width=o,0!==t.col.frozen.length&&t.col.frozen.viewWidth<=0?i.parent.style.left="-1px":i.parent.style.left="0px"),s++})}},{key:"_initVertical",value:function(e){var t=document.createElement("div"),i=document.createElement("div");t.style.fontSize="0",t.style.position="relative",t.style.overflow="hidden",this.topBoard=t,i.style.fontSize="0",i.style.position="relative",i.style.overflow="hidden",this.bottomBoard=i,this._initHorizontal(t),this._initHorizontal(i),e.appendChild(t),e.appendChild(i)}},{key:"_initHorizontal",value:function(e){var t=document.createElement("div"),i=document.createElement("div");t.className="left-board",i.className="right-board";var n=document.createElement("div");n.className="hidden-board";var a=document.createElement("div");a.className="visiable-board",t.appendChild(n),t.appendChild(a),this.list.push({parent:t,visiable:a,hidden:n}),(n=document.createElement("div")).className="hidden-board",(a=document.createElement("div")).className="visiable-board",i.appendChild(n),i.appendChild(a),this.list.push({parent:i,visiable:a,hidden:n}),e.appendChild(t),e.appendChild(i)}},{key:"_mobileTableMove",value:function(){var e=this,t=this.stage.areaData;this.topBoard.style.height=t.row.frozen.totalHeight-t.row.frozen.offsetY-2+"px",this.bottomBoard.style.paddingTop=(t.row.frozen.length>0?this.stage.configData.frozenWidth:0)+"px",this.bottomBoard.style.height=t.row.flow.viewHeight+"px";var i=t.col.frozen.viewWidth-2+"px",n=t.col.flow.viewWidth+"px",a=0;this.list.forEach(function(o){a%2===0?o.parent.style.width=i:(o.parent.style.width=n,o.parent.style.marginLeft=(t.col.frozen.length>0?e.stage.configData.frozenWidth:0)+"px"),a++})}}]),e}();t.default=s},1248:function(e,t,i){var n=i(1249);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1249:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".left-board,\n.right-board {\n    position: relative;\n    float: left;\n    height: 100%;\n}\n\n.hidden-board {\n    width: 100%;\n    height: 100%;\n    overflow: hidden;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n.visiable-board {\n    width: 100%;\n    height: 100%;\n    overflow: visible;\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n",""])},1250:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(10),s=i(403);r(i(166));function r(e){return e&&e.__esModule?e:{default:e}}o.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_PREVIEW;var l=o.FROZEN_PROVIEW_EVENT_TYPE.SHEET_FREEZE_CANCEL_PREVIEW,h=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.container=t.container,this.board=null,this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"initStyle",value:function(){i(1251)}},{key:"init",value:function(){var e=this;this.board||(this.board=document.createElement("div"),this.board.className="frozen-board",this._addColFrozenLine(),this._addRowFrozenLine(),this.container.appendChild(this.board));var t=[-1,-1],i=[-1,-1],n=this.stage.areaData;n.col.frozen.length>0&&(t=[n.col.frozen.start,n.col.frozen.length]),n.row.frozen.length>0&&(i=[n.row.frozen.start,n.row.frozen.length]),this.frozenPositionCenterKey=this.stage.positionCenter.add({type:o.TABLE_AREA.FROZEN,config:{ignoreSet:!1,ignoreAdd:!0,ignoreRemove:!0,ignoreHideShow:!1,ignoreFrozen:!0},selfData:{xRange:t,yRange:i},calc:function(t,i,n){"hide"!==i&&"show"!==i&&"set"!==i||e.stage.event.eventDimension.trigger("updateFrozenCol",e.stage.tableData.frozen.col),"hide"!==i&&"show"!==i&&"set"!==i||e.stage.event.eventDimension.trigger("updateFrozenRow",e.stage.tableData.frozen.row)}})}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventTable.listen("scale",function(){e._scale()}),this.stage.event.eventDimension.listen("updateFrozenCol",function(){e._update({col:!0})}),this.stage.event.eventDimension.listen("updateFrozenRow",function(){e._update({row:!0})}),this.stage.event.eventTable.listen("clearTable",function(){e._clear()}),this.stage.event.eventDimension.listen(l,function(){e.resetFrozenLineColor()})}},{key:"_scale",value:function(){var e=this.stage.areaData;this.colLine.style.left=e.col.frozen.maxDistance+"px",this.colLine.style.height=this.stage.height+"px",this.rowLine.style.top=e.row.frozen.maxDistance+"px",this.rowLine.style.width=this.stage.width+"px",e.col.frozen.length>0?this.colLine.style.display="block":this.colLine.style.display="none",e.row.frozen.length>0?this.rowLine.style.display="block":this.rowLine.style.display="none"}},{key:"_update",value:function(e){var t=this.stage.areaData;e.col&&(this.colLine.style.left=t.col.frozen.maxDistance+"px",this.colLine.style.height=this.stage.height+"px"),e.row&&(this.rowLine.style.top=t.row.frozen.maxDistance+"px",this.rowLine.style.width=this.stage.width+"px"),t.col.frozen.length>0?this.colLine.style.display="block":this.colLine.style.display="none",t.row.frozen.length>0?this.rowLine.style.display="block":this.rowLine.style.display="none";var i=[-1,-1],n=[-1,-1];t.col.frozen.length>0&&(i=[t.col.frozen.start,t.col.frozen.length]),t.row.frozen.length>0&&(n=[t.row.frozen.start,t.row.frozen.length]),this.stage.positionCenter.changeSelfData(this.frozenPositionCenterKey,{xRange:i,yRange:n})}},{key:"_addColFrozenLine",value:function(){var e=this.stage.areaData,t=document.createElement("div");t.className="frozen-line-col",t.style.left=e.col.frozen.maxDistance+"px",t.style.height=Math.max(this.stage.width,this.stage.height)+"px",t.style.width=this.stage.configData.frozenWidth+"px",e.col.frozen.length>0&&(t.style.display="block"),this.colLine=t,this.board.style.display="block",this.board.appendChild(t)}},{key:"_addRowFrozenLine",value:function(){var e=this.stage.areaData,t=document.createElement("div");t.className="frozen-line-row",t.style.top=e.row.frozen.maxDistance+"px",t.style.width=Math.max(this.stage.width,this.stage.height)+"px",t.style.height=this.stage.configData.frozenWidth+"px",e.row.frozen.length>0&&(t.style.display="block"),this.rowLine=t,this.board.style.display="block",this.board.appendChild(t)}},{key:"_clear",value:function(){this.stage.positionCenter.remove(this.frozenPositionCenterKey),this.container.contains(this.board)&&(this.container.removeChild(this.board),this.board=null)}},{key:"hackUpdate",value:function(){this.colLine&&(this.colLine.style.height=this.stage.tableData.viewportY+"px"),this.rowLine&&(this.rowLine.style.width=this.stage.tableData.viewportX+"px")}},{key:"_mobileTouchmove",value:function(){this._mobileUpdateColLeft(),this._mobileUpdateRowTop()}},{key:"_mobileUpdateColLeft",value:function(){var e=this.stage.areaData;this.colLine&&(this.colLine.style.left=(0,s._getColFrozenLineLeft)(e)+"px")}},{key:"_mobileUpdateRowTop",value:function(){var e=this.stage.areaData;this.rowLine&&(this.rowLine.style.top=(0,s._getRowFrozenLineTop)(e)+"px")}},{key:"resetFrozenLineColor",value:function(){this.colLine.style.backgroundColor="",this.rowLine.style.backgroundColor=""}}]),e}();t.default=h},1251:function(e,t,i){var n=i(1252);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1252:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".frozen-board {\n    top: 0;\n    left: 0;\n    position: absolute;\n    display: none;\n    pointer-events: none;\n    z-index: 100;\n}\n\n.frozen-line-col {\n    top: 0;\n    position: absolute;\n    background-color: #d6d6d6;\n    display: none;\n}\n\n.frozen-line-row {\n    left: 0;\n    position: absolute;\n    background-color: #d6d6d6;\n    display: none;\n}\n",""])},1255:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=i(21),s=i(10),r=l(i(12));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){var i=this;(0,n.default)(this,e),this.initMenus=function(e){if(e){var t=0,n=0;i.menus[t]=[];for(var a=i._seperator(),o=i._nextMenu(),s=i._preMenu(),r=2*i._getMaxScreenWidth(),l=0;l<e.length;l++){var h=e[l];if(h.init){var g=h.init();if(!g.valid)continue;h.text=g.wording,h.width=g.width}else h.text=h.wording;var c=i._getMenuNameWidth(h.text);if(!(n+c<r)){i.menus[t].push(o),n+=o.width;break}if(l!=e.length-1&&n+c+o.width>r){i.menus[t].push(o),n+=o.width;break}i.menus[t].push(h),h.width=c,n+=c,l!=e.length-1&&(i.menus[t].push(a),n+=a.width)}for(i.menuWidth=n,r=n-s.width,t+=1;l<e.length;){n=0;var d=[s];n+=s.width,d.push(a),n+=a.width;for(var u=0;l<e.length;l++){var f=e[l];if(f.init){var v=f.init();if(!v.valid)continue;f.text=v.wording,f.width=v.width}else f.text=f.wording;var A=i._getMenuNameWidth(f.text);if(!(n+A<r))break;d.push(f),f.width=A,n+=A,u+=1,t!=e.length-1&&(d.push(a),n+=a.width)}d.push(o);for(var C=Math.floor((r-n)/u),p=0;p<d.length;p++){var I=d[p];"line"!=I.name&&"pre"!=I.name&&"next"!=I.name&&(p!=d.length-1?(I.width+=C,n-=I.width):I.width=n)}i.menus.push(d)}}},this._showAbsoluteMenu=function(e){var t=i.menuWidth/2,n=i.menuHeight/2,a=i.menuWidth/4,o=i._getMaxScreenWidth(),s=e.xViewport-a-0,r=o-(e.xViewport+a),l=i.stage.configData;if(s>=0&&r>0)i.board.style.left=s-l.rowHeadWidth+"px",i.arrow.style.left="50%";else if(s<0){var h=t+l.rowHeadWidth-o;if(h<0){var g=(e.xViewport-l.rowHeadWidth)/t*100;i.board.style.left="0px",i.arrow.style.left=(g>i.arrawMax?i.arrawMax:g<i.arrawMin?i.arrawMin:g)+"%"}else{var c=h+10>l.rowHeadWidth?-1*(h+10):-1*h,d=(e.xViewport-l.rowHeadWidth-c)/t*100;i.board.style.left=-1*h-10+"px",i.arrow.style.left=(d>i.arrawMax?i.arrawMax:d<i.arrawMin?i.arrawMin:d)+"%"}}else if(r<0){var u=100*(1-(o-e.xViewport-10)/t);i.board.style.left=o-t-l.rowHeadWidth-10+"px",i.arrow.style.left=(u>i.arrawMax?i.arrawMax:u<i.arrawMin?i.arrawMin:u)+"%"}var f=l.colHeadHeight+n;e.yViewport>f?(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-bottom",i.board.style.top=e.yViewport-l.colHeadHeight-n-20+"px"):(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-top",i.board.style.top=e.yViewport+20+"px")},this._showCellMenu=function(e){var t=i.stage.areaData,n=i.stage.tableData,a=t.row.getViewportTop(e.yIndex),s=t.col.getViewportLeft(e.xIndex),r=n.col.getWidth(e.xIndex),l=n.row.getHeight(e.yIndex),h=i.menuWidth,g=i.board.offsetHeight,c=i.stage.configData,d=(i.stage.touchData.currX-s)/r,u=(0,o.findPosition)({left:s,top:a,width:r,height:l},{width:h/2,height:g/2},{x:{min:0,max:i.stage.width},y:{min:c.colHeadHeight,max:i.stage.height}},{yPriority:-1,sourceXPoint:[d],targetXPoint:[.5,.4,.6,.3,.7,.2,.8]});u.yDir>0?(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-top",u.top+=10):(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-bottom",u.top-=10);var f=Math.max(c.rowHeadWidth,s)-c.rowHeadWidth,v=(f+(Math.min(i.stage.width,s+r)-c.rowHeadWidth-f)/2-(u.left-c.rowHeadWidth))/(i.menuWidth/2)*100,A=20/(i.menuWidth/2)*100;v=Math.max(A,v),v=Math.min(100-A,v),i.arrow.style.left=v+"%",i.board.style.top=u.top-c.colHeadHeight+"px",i.board.style.left=u.left-c.rowHeadWidth+"px"},this._showImageMenu=function(e){var t=i.stage.tableData.shapes[e],n=i.stage.areaData,a=n.col[t.areaX].offsetX,s=n.row[t.areaY].offsetY,r=n.globalToViewport(t.left,t.top),l=r.left-a,h=r.top-s,g=t.width,c=t.height,d=i.stage.configData,u=i.menuWidth,f=i.board.offsetHeight,v=(i.stage.touchData.currX-l)/g,A=(0,o.findPosition)({left:l,top:h,width:g,height:c},{width:u/2,height:f/2},{x:{min:d.rowHeadWidth,max:i.stage.width},y:{min:d.colHeadHeight,max:i.stage.height}},{yPriority:-1,sourceXPoint:[v],targetXPoint:[.5,.4,.6,.3,.7,.2,.8]});A.top>i.stage.height-160&&(A.top=20,A.yDir=0),A.yDir>0?(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-top",A.top+=10):(i.arrow.className="cell-toolbar-arrow cell-toolbar-arrow-bottom",A.top-=10),i.arrow.style.left=100*A.xArrow+"%",i.board.style.top=A.top-d.colHeadHeight+"px",i.board.style.left=A.left-d.rowHeadWidth+"px"},this.hide=function(){if(i._clearTimeout(),i.isShow){for(i.board.style.display="none",i.menus=[],i.menuIndex=0,i.menuWidth=0,i.selectCell=!1,i.selectImage=!1;i.list.children[0];)i.list.removeChild(i.list.children[0]);i.isShow=!1,i.stage.event.eventShape.remove("frameShow",i.hide),i.stage.event.eventSelection.remove("selectionShow",i._hideForNormalSelectionShow),i.stage.event.eventTable.remove("tableMove",i._hideForTableMoveHandler),i.stage.event.eventTable.remove("enterInputStatus",i.hide),i.stage.event.eventTable.remove("clearTable",i.hide)}},this._hideForTableMove=function(e){if(e&&e.diffX&&(i._accumulativeX+=e.diffX),e&&e.diffY&&(i._accumulativeY+=e.diffY),!(Math.abs(i._accumulativeX)<15&&Math.abs(i._accumulativeY)<15)){var t=i.stage.selectData,n=i.stage.areaData,a=function(e){return e==s.TABLE_AREA.FROZEN||e==s.TABLE_AREA.FLOW};if(!(e.areaX&&!a(e.areaX)||e.areaY&&!a(e.areaY))){var o=!0;if((t.select.selectCol||t.select.selectRow)&&a(e.areaY)){var r=n.row[e.areaY].offsetY;e.areaY==s.TABLE_AREA.FROZEN?Math.abs(r-i.frozenOffsetY)<i.defaultOffset&&(o=!1):Math.abs(r-i.flowOffsetY)<i.defaultOffset&&(o=!1)}var l=!0;if((t.select.selectCol||t.select.selectRow)&&a(e.areaX)){var h=n.col[e.areaX].offsetX;e.areaX==s.TABLE_AREA.FROZEN?Math.abs(h-i.frozenOffsetX)<i.defaultOffset&&(l=!1):Math.abs(h-i.flowOffsetX)<i.defaultOffset&&(l=!1)}(o||l)&&(i._accumulativeX=0,i._accumulativeY=0,i.hide())}}},this._hideForNormalSelectionShow=function(){var e=i.stage.selectData;e.active.xIndex===i.xIndex&&e.select.xRange[0]===i.xIndex&&e.select.selectCol&&"col"==i.menuType||e.active.yIndex===i.yIndex&&e.select.yRange[0]===i.yIndex&&e.select.selectRow&&"row"==i.menuType||i.hide()},this._hideForSeletionShow=function(){i.hide();var e=i.stage.selectData;e.select.selectRow?r.default.wait(500).run(function(){i.show({xIndex:0,yIndex:e.select.yRange[0],type:"row"})}):e.select.selectCol&&r.default.wait(500).run(function(){i.show({xIndex:e.select.xRange[0],yIndex:0,type:"col"})}),i.stage.event.eventSelection.remove("topBtnTouchEnd",i._hideForSeletionShow),i.stage.event.eventSelection.remove("bottomBtnTouchEnd",i._hideForSeletionShow),i.stage.event.eventSelection.remove("leftBtnTouchEnd",i._hideForSeletionShow),i.stage.event.eventSelection.remove("rightBtnTouchEnd",i._hideForSeletionShow)},this._clearTimeout=function(){i.delayTimeout&&(r.default.erase(i.delayTimeout),i.delayTimeout=null)},this._nextMenu=function(){return{target:"div",width:40,name:"next",validClass:"menu-component-button",invalidClass:"menu-component-button menu-component-button-disable",wording:"",callback:function(){i.list.innerHTML="",i.menuIndex+=1,i._addMenuComponent(),i._moveArrowByLinePos()}}},this._preMenu=function(){return{target:"div",name:"pre",width:40,validClass:"menu-component-button",wording:"",callback:function(){i.list.innerHTML="",i.menuIndex-=1,i._addMenuComponent(),i._moveArrowByLinePos()}}},this._seperator=function(){return{target:"span",width:1,name:"line",validClass:"component-line"}},this._getMenuNameWidth=function(e){return 28*e.length+50},this._getMaxScreenWidth=function(){return(0,o.isPortrait)()?document.body.clientWidth:o.isIphoneX?document.body.clientWidth-43:document.body.clientWidth},this.stage=t.stage,this.container=t.container,this.isShow=!1,this.menus=[],this.menuIndex=0,this.selectCell=!1,this.selectImage=!1,this.menuWidth=0,this.menuHeight=72,this.menuType="normal",this.xIndex=-1,this.yIndex=-1,this.defaultOffset=25,this.arrawMax=90,this.arrawMin=10,this._accumulativeX=0,this._accumulativeY=0,this._hideForTableMoveHandler=this._hideForTableMove.bind(this),this.initStyle(),this.init(),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){var e=document.createElement("div");e.style.marginLeft=this.stage.configData.rowHeadWidth+1+"px",e.style.marginTop=this.stage.configData.colHeadHeight+1+"px",this.wrap=e,e.className="cell-toolbar-wrap",this.container.appendChild(e);var t=document.createElement("div");this.board=t,t.className="cell-toolbar-board";var i=document.createElement("div");this.arrow=i,i.className="cell-toolbar-arrow";var n=document.createElement("div");this.list=n,n.className="cell-toolbar-list",t.appendChild(i),t.appendChild(n),this.wrap.appendChild(t)}},{key:"initStyle",value:function(){i(1256)}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventMenu.listen("cellToolbarShow",function(t){(e.stage.configData.permissions||e.stage.configData.allowCopy)&&(SpreadsheetApp&&SpreadsheetApp.view.discuss&&SpreadsheetApp.view.discuss.isPanelShow()||(t.type!=e.menuType&&e.hide(),e.isShow?e.hide():"boolean"!==typeof t.delayShow||t.delayShow?(e._clearTimeout(),e.delayTimeout=r.default.wait(300).run(function(){e.show(t),e._clearTimeout()})):e.show(t)))}),this.stage.event.eventMenu.listen("cellToolbarHide",function(){e.hide()}),this.stage.event.eventTable.listen("scale",function(){e._scale()})}},{key:"_addMenuComponent",value:function(){var e=void 0,t=void 0,i=this.menus[this.menuIndex],n=void 0,a=void 0,s=this.list;if(i){for(t=0;t<i.length;t++){if(n=i[t],(e=document.createElement(n.target||"div")).className=n.validClass||"menu-component",e.innerText=n.text||null,e.setAttribute("style","width: "+n.width+"px"),n.init?((a=n.init()).valid,e.innerText=a.wording,a.width||(a.valid?n.width:0)||0):(e.className=n.validClass,e.innerText=n.text||null,n.width||0),n.callback)if(this.menuIndex==this.menus.length-1&&"next"==n.name||((0,o.addTap)(e,{preventDefault:!0}),e.addEventListener("tap",n.callback)),"pre"==n.name){var r=document.createElement("div");r.className="cell-toolbar-arrow-button cell-toolbar-arrow-left",e.appendChild(r)}else if("next"==n.name){var l=document.createElement("div");l.className="cell-toolbar-arrow-button cell-toolbar-arrow-right",e.appendChild(l),this.menuIndex==this.menus.length-1&&(e.className=n.invalidClass)}else e.addEventListener("tap",this.hide);s.appendChild(e)}}}},{key:"_scale",value:function(){this.wrap.style.marginLeft=this.stage.configData.rowHeadWidth+1+"px",this.wrap.style.marginTop=this.stage.configData.colHeadHeight+1+"px",this.hide()}},{key:"show",value:function(e){var t=this.stage.areaData,i=this.stage.tableData;this.frozenOffsetX=t.col.frozen.offsetX||0,this.frozenOffsetY=t.row.frozen.offsetY||0,this.flowOffsetX=t.col.flow.offsetX||0,this.flowOffsetY=t.row.flow.offsetY||0;var n=e.xIndex,a=e.yIndex,o=e.xViewport,s=e.yViewport,r=e.type||"normal",l=e.menus;if(this.xIndex=e.xIndex,this.yIndex=e.yIndex,this.menuType=r,this.selectCell=!o&&!s&&"all"!=r&&"col"!=r&&"row"!=r&&"image"!=r,this.selectImage="image"===r,this.list.innerHTML="",this.initMenus(l||this.stage.configData.mobileMenu[r]),this._addMenuComponent(),this.list.style.width=this.menuWidth+"px",this.list.style.height=this.menuHeight+"px",this.board.style.display="block",this.selectCell)this._showCellMenu({xIndex:n,yIndex:a});else if(this.selectImage)this._showImageMenu(e.id);else{if(!o&&!s){var h=t.row.getViewportTop(a);o=t.col.getViewportLeft(n)+i.col.getWidth(a)/2,"col"==this.menuType?s=0:"row"==this.menuType?s=h:"all"==this.menuType&&(o=this.stage.configData.rowHeadWidth+(t.col.frozen.viewWidth+t.col.flow.viewWidth)/2,s=0)}this._showAbsoluteMenu({xViewport:o,yViewport:s})}this.isShow=!0,this._moveArrowByLinePos(),SpreadsheetApp&&SpreadsheetApp.view.canvas&&SpreadsheetApp.view.canvas.pluginsApi.cardCenter.hideAll(),this.stage.event.eventShape.listen("frameShow",this.hide),this.stage.event.eventSelection.listen("selectionShow",this._hideForNormalSelectionShow),this.stage.event.eventTable.listen("tableMove",this._hideForTableMoveHandler),this.stage.event.eventTable.listen("enterInputStatus",this.hide),this.stage.event.eventTable.listen("clearTable",this.hide),this.stage.event.eventSelection.listen("topBtnTouchEnd",this._hideForSeletionShow),this.stage.event.eventSelection.listen("bottomBtnTouchEnd",this._hideForSeletionShow),this.stage.event.eventSelection.listen("leftBtnTouchEnd",this._hideForSeletionShow),this.stage.event.eventSelection.listen("rightBtnTouchEnd",this._hideForSeletionShow),this.stage.event.eventMenu.trigger("cellToolbarTruelyShow")}},{key:"_moveArrowByLinePos",value:function(){var e=Number(this.arrow.style.left.replace("%","")),t=this.board.offsetWidth*e/100,i=t-20,n=t+20,a=0,o=this.menus[this.menuIndex];if(o)for(var s=0;s<o.length;s++){var r=o[s].width;if(1===r){var l=a+r-i,h=n-a;if(l>0&&h>0){var g=l<h?l:-h;return void(this.arrow.style.transform="translateX("+g+"px)")}}a+=r}this.arrow.style.transform=""}}]),e}();t.default=h},1256:function(e,t,i){var n=i(1257);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1257:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".cell-toolbar-wrap {\n    position: absolute;\n    top: 0;\n    left: 0;\n}\n\n.cell-toolbar-board {\n    position: absolute;\n    left: 0;\n    top: 0;\n    display: none;\n    z-index: 105;\n    /* max-width: 800px; */\n    height: 72px;\n    -webkit-transform-origin: left top;\n    transform-origin: left top;\n    -webkit-transform: scale(0.5, 0.5);\n    /*transform: scale(.5, .5);\n    transition: 0.8s;*/\n}\n\n.cell-toolbar-arrow {\n    position: absolute;\n    width: 0;\n    height: 0;\n    margin-left: -20px;\n    border-width: 20px;\n    border-style: solid;\n    border-color: #000000 transparent transparent transparent;\n}\n.cell-toolbar-arrow-top {\n    top: -40px;\n    border-color: transparent transparent #000000 transparent;\n}\n.cell-toolbar-arrow-bottom {\n    top: 72px;\n    border-color: #000000 transparent transparent transparent;\n}\n\n.cell-toolbar-arrow-button {\n    position: absolute;\n    width: 0;\n    height: 0;\n}\n.cell-toolbar-arrow-left {\n    top: 27px;\n    /* left: 18px; */\n    border-right: 16px solid #ffffff;\n    border-top: 9px solid transparent;\n    border-bottom: 9px solid transparent;\n    margin-left: 12px;\n}\n.cell-toolbar-arrow-right {\n    top: 27px;\n    /* left: 20px; */\n    border-left: 16px solid #ffffff;\n    border-top: 9px solid transparent;\n    border-bottom: 9px solid transparent;\n    margin-left: 12px;\n}\n\n.cell-toolbar-list {\n    overflow: hidden;\n    background-color: #000000;\n    border-radius: 16px;\n    font-size: 0;\n}\n\n.menu-component-button {\n    width: 72px;\n    height: 72px;\n    text-align: center;\n    display: inline-block;\n    position: relative;\n    overflow: hidden;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n    vertical-align: top;\n}\n\n.menu-component-button-disable {\n    opacity: 0.5;\n}\n\n/* .cell-toolbar-item {\n    width: 124px;\n    height: 72px;\n    line-height: 72px;\n    text-align: center;\n    color: #ffffff;\n    display: inline-block;\n    font-size: 28px;\n    border-left: 1px solid #ffffff;\n    position: relative;\n    overflow: hidden;\n    -webkit-user-select: none;\n    user-select: none;\n}\n\n.cell-toolbar-item:hover {\n    background-color: #222222;\n}\n\n.cell-toolbar-item:nth-child(1) {\n    border-left: 1px solid transparent;\n} */\n",""])},1258:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(0),o=(n=a)&&n.__esModule?n:{default:n};t.default=function e(t){(0,o.default)(this,e),this.stage=t.stage}},1259:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(0)),a=h(i(1)),o=i(10),s=i(21),r=h(i(8)),l=i(1260);function h(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){var i=this;(0,n.default)(this,e),this.initEvent=function(){i.stage.event.eventMenu.listen("tableMenuShow",i._show),i.stage.event.eventMenu.listen("tableMenuHide",i._hide),i.stage.event.eventMenu.listen("tableMenuToggle",i._toggle),window.__core&&__core.event.spreadsheetEvent.listen("tableMenuToggle",i._toggle),window.addEventListener("compositionstart",function(e){i._keyboardShow&&e.stopImmediatePropagation()},!0)},this._toggle=function(e){i._keyboardShow?i._hide.call(i):i._showWithType.call(i)},this._show=function(){i.stage.blurInput();var e=i.stage.selectData,t=i.stage.configData;i.stage.areaData;if(e.selectStatus!==o.SELECT_STATUS.FORMULA&&(!SpreadsheetApp.view.plugins||SpreadsheetApp.view.plugins.rangeSelectionPanel)&&(!SpreadsheetApp.view.plugins||!SpreadsheetApp.view.plugins.rangeSelectionPanel.onSelecting)){var n=e.pickShape?"image":"all";if(void 0!==t.pcMenu&&void 0!==t.pcMenu[n]){i._keyboardShow&&i._hide(),i._addComponent(i.wrap,n),i.wrap.style.display="block";var a=void 0,r=void 0;if(i._keyboardWithType)if(i.stage.mouseData&&i.stage.mouseData.down)a=i.stage.mouseData.currX,r=i.stage.mouseData.currY;else if(i.stage.touchData&&i.stage.touchData.down)a=i.stage.touchData.currX,r=i.stage.touchData.currY;else{var l=i.stage.selectData.active;a=(l.posX[0]+l.posX[1])/2,r=(l.posY[0]+l.posY[1])/2}else a=i.stage.mouseData.currX,r=i.stage.mouseData.currY;var h=void 0;i.wrap.style.maxHeight="999px";var g=i.wrap.getBoundingClientRect(),c=void 0;return(h=(0,s.findPosition)({left:a,top:r,width:0,height:0},{width:g.width,height:g.height},{x:{min:0,max:i.stage.width},y:{min:0,max:i.stage.height}},{yPriority:1,sourceXPoint:[0],targetXPoint:[0,1]})).yDir<0&&h.top<0&&(c=r-t.colHeadHeight,h.top+=g.height-c,i.wrap.style.maxHeight=c+"px",i.boxWrapper.style.maxHeight=c-16+"px",i.boxWrapper.style.overflowY="auto",i.boxWrapper.style.overflowX="hidden"),h.yDir>0&&h.top+g.height>i.stage.rowHeader.viewHeight&&(c=i.stage.rowHeader.viewHeight-r,i.wrap.style.maxHeight=c+"px",i.boxWrapper.style.maxHeight=c-16+"px",i.boxWrapper.style.overflowY="auto",i.boxWrapper.style.overflowX="hidden"),i.wrap.style.left=h.left+"px",i.wrap.style.top=h.top+"px",document.body.addEventListener("mousedown",i._hide,!1),i.stage.event.eventTable.listen("tableMove",i._hide),i.stage.event.eventTable.listen("clearTable",i._hide),i.stage.event.eventMenu.trigger("tableMenuShowed"),i._keyboardShow=!0,!0}}},this._keydownCb=function(e){switch(e.key){case"UIKeyInputUpArrow":case"ArrowUp":(0,l.dispatch)(l.actions.UP,e);break;case"UIKeyInputDownArrow":case"ArrowDown":(0,l.dispatch)(l.actions.DOWN,e);break;case"Enter":(0,l.dispatch)(l.actions.ENTER,e);break;case"Tab":(0,l.dispatch)(l.actions.TAB,e);break;case"UIKeyInputEscape":case"Escape":e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault(),i._hide();break;default:(0,l.dispatch)(l.actions.DEFAULT,e)}},this._showWithType=function(e){i._keyboardWithType=!0,i._show()&&(0,l.dispatch)("init",i.boxes,i.boxWrapper,i._shortKeys,0),i.stage.eventTable.listen("clearTable",i._hide)},this._hide=function(){for(i.stage.selectData.pickShape?i.stage.blurInput():i.stage.focusInput(),i._keyboardShow&&(0,l.dispatch)(l.actions.REMOVE),i._keyboardWithType=!1,i._keyboardShow=!1,s.mac&&window.removeEventListener("keydown",i._keydownCb),i.wrap.style.display="none";i.wrap.children[0];)i.wrap.removeChild(i.wrap.children[0]);document.body.removeEventListener("mousedown",i._hide,!1),i.stage.event.eventTable.remove("tableMove",i._hide),i.stage.event.eventMenu.trigger("tableMenuHiden"),i.stage.event.eventTable.remove("clearTable",i._hide)},this._hideForTableMove=function(e){i._hide()},this._hideForSelectionShow=function(e){i.stage.selectData;i._hide()},this.stage=t.stage,this.initStyle(),this.init(t),this.initMouse(),(this.stage.configData.permissions||this.stage.configData.allowCopy)&&this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(e){var t=document.createElement("div");t.className="table-menu common-dropdown-outer",this.wrap=t,this.boxWrapper=null,this.boxes=null,this._keyboardShow=!1,this._keyboardWithType=!1,this._shortKeys=!1,e.container.appendChild(t)}},{key:"initStyle",value:function(){i(1261)}},{key:"initMouse",value:function(){this.wrap.addEventListener("contextmenu",function(e){e.preventDefault()}),this.wrap.addEventListener("mousedown",function(e){e.stopPropagation()}),this.wrap.addEventListener("dblclick",function(e){e.preventDefault(),e.stopPropagation()})}},{key:"_addComponent",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"all",n=void 0,a=void 0,o=this.stage.configData.pcMenu[i],s=void 0;if("image"===i)try{r.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu"})}catch(g){}var l=document.createElement("div");this.boxWrapper=l,this.boxes=[],this._shortKeys=[];var h="";for(a=0;a<o.length;a++){if(s=o[a],n=document.createElement("div"),s.init?s.init(n):n.className=s.class,"line"!==s.name||"line"!==h)n.className.indexOf("hidden")<0&&n.className.indexOf("component-hide")<0&&"none"!==n.style.display&&(h=s.name),s.callback&&(n.addEventListener("mousedown",function(e){e.stopPropagation()}),n.addEventListener("click",function(){t._hide(),t.stage.focusInput()}),n.addEventListener("click",s.callback.bind(s))),l.appendChild(n),"none"===n.style.display||n.classList.contains("component-hide")||"line"===s.name||(s.short&&s.short.pad&&this._shortKeys.push({index:this.boxes.length,val:s.short.pad}),this.boxes.push(n))}e.appendChild(l)}},{key:"isShow",value:function(){return"block"===this.wrap.style.display}}]),e}();t.default=g},1260:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dispatch=t.store=t.actions=void 0;var n=s(i(14)),a=s(i(84)),o=i(21);function s(e){return e&&e.__esModule?e:{default:e}}var r=["0","1","2","3","4","5","6","7","8","9"],l=t.actions={INIT:"init",DOWN:"down",UP:"up",TAB:"tab",ENTER:"enter",DEFAULT:"default",REMOVE:"remove"},h=t.store={boxesWrapper:null,active:null,activeIndex:null,boxes:null,inputFocus:!1,shortKeys:null},g=t.dispatch=function(e){for(var t=arguments.length,i=Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];switch(e){case l.INIT:return void function(e,t,i,n){h.boxes=e,h.boxesWrapper=t,h.shortKeys=i,"number"===typeof n&&e.length>n&&d(n)}.apply(null,i);case l.DOWN:return void function(e){var t=A(h.activeIndex)?-1:h.activeIndex;do{if(-1===t&&0===h.activeIndex)break;if(h.activeIndex=A(h.activeIndex)?0:h.activeIndex+1,h.activeIndex>h.boxes.length-1&&(h.activeIndex=0),h.activeIndex===t)break}while(!f(h.boxes[h.activeIndex]));d(h.activeIndex),e&&e.preventDefault&&e.preventDefault()}.apply(null,i);case l.UP:return void function(e){var t=A(h.activeIndex)?h.boxes.length:h.activeIndex;do{if(t===h.boxes.length&&h.activeIndex===h.boxes.length-1)break;if(h.activeIndex=A(h.activeIndex)?h.boxes.length-1:h.activeIndex-1,h.activeIndex<0&&(h.activeIndex=h.boxes.length-1),h.activeIndex===t)break}while(!f(h.boxes[h.activeIndex]));d(h.activeIndex),e&&e.preventDefault&&e.preventDefault()}.apply(null,i);case l.TAB:return void function(e){e&&e.preventDefault&&e.preventDefault();var t=h.active.getElementsByTagName("input");if(t.length){var i=(0,a.default)(t).findIndex(function(e){return e===document.activeElement});i===t.length-1?(t[i].blur(),h.inputFocus=!1):u(h.active,i+1)}}.apply(null,i);case l.ENTER:return void function(e){v(e);var t=void 0;0;o.mac&&(t=new Event("click"));h.boxes[h.activeIndex].dispatchEvent(t)}.apply(null,i);case l.REMOVE:return void function(){(0,n.default)(h,{boxesWrapper:null,active:null,activeIndex:null,boxes:null,inputFocus:!1,shortKeys:null})}.apply(null,i);case l.DEFAULT:return void(i.length&&i[0].key&&r.indexOf(i[0].key)>-1&&!h.inputFocus?function(e){(function(e,t){var i=e.getElementsByTagName("input");if(i.length<=t)return;i[t].value=""})(h.active,0),u(h.active,0)}.apply(null,i):c.apply(null,i))}};function c(e){var t=h.shortKeys.find(function(t){return t.val===e.key});t&&f(h.boxes[t.index])&&(v(e),d(t.index),g(l.ENTER,e))}function d(e){if(e<0||e>h.length-1)throw new RangeError("index out range");h.activeIndex=e,h.active=h.boxes[h.activeIndex],h.boxes.forEach(function(t,i){e===i?t.classList.add("keyboard-active"):t.classList.contains("keyboard-active")&&t.classList.remove("keyboard-active")}),function(e,t){var i=t.offsetHeight,n=t.scrollTop,a=e.offsetHeight,o=e.offsetTop;n>o&&(t.scrollTop=o),i<a+o&&(t.scrollTop=a+o-i)}(h.active,h.boxesWrapper)}function u(e,t){var i=e.getElementsByTagName("input");i.length<=t||(i[t].focus(),h.inputFocus=!0)}function f(e){return e.classList.contains("component-vaild")}function v(e){e&&e.stopPropagation&&e.stopPropagation(),e&&e.preventDefault&&e.preventDefault()}function A(e){return"undefined"===typeof e||null===e}},1261:function(e,t,i){var n=i(1262);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1262:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".table-menu {\n    width: 180px;\n    border: 1px solid #d9d9d9;\n    background-color: #ffffff;\n    position: absolute;\n    z-index: 105;\n    overflow: hidden;\n    top: -9999px;\n    left: -9999px;\n    box-sizing: border-box;\n}\n\n.table-menu::-webkit-scrollbar {\n    height: 16px;\n    overflow: visible;\n    width: 16px;\n}\n\n.table-menu::-webkit-scrollbar-button {\n    height: 0;\n    width: 0;\n}\n\n.table-menu::-webkit-scrollbar-thumb {\n    background-color: rgba(0, 0, 0, 0.2);\n    background-clip: padding-box;\n    border: solid transparent;\n    border-width: 1px 1px 1px 6px;\n    min-height: 28px;\n    padding: 100px 0 0;\n    box-shadow: inset 1px 1px 0 rgba(0, 0, 0, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.07);\n}\n\n.table-menu .keyboard-active {\n    background: #e9e9e9;\n}\n\n.component-pad.menu-component {\n    padding-right: 60px;\n    padding-left: 20px;\n    -webkit-tap-highlight-color: transparent;\n    -webkit-user-select: none;\n    -moz-user-select: none;\n     -ms-user-select: none;\n         user-select: none;\n}\n\n.component-pad .component-pad-short {\n    float: right;\n    margin-right: -60px;\n    padding-right: 10px;\n    font-size: 0.8em;\n    line-height: 28px;\n    background: transparent;\n}\n",""])},1263:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(1)),a=r(i(0)),o=i(10);i(1264);var s=r(i(247));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(e){(e=e||window.event).preventDefault&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),e.returnValue=!1},h=[37,38,39,40],g=function e(){var t=this;(0,a.default)(this,e),this.keydown=function(e){for(var t=h.length;t--;)if(e.keyCode===h[t])return void l(e)},this.wheel=function(e){l(e)},this.disableScroll=function(){window.addEventListener&&(window.addEventListener("DOMMouseScroll",t.wheel,!0),window.addEventListener("wheel",t.wheel,!0),window.addEventListener("mousewheel",t.wheel,!0),window.addEventListener("mousemove",t.wheel,!0)),window.onmousewheel=document.onmousewheel=t.wheel,document.onkeydown=t.keydown,document.getElementsByClassName("y-scroll-box")[0].style.display="none"},this.enableScroll=function(){window.removeEventListener&&(window.removeEventListener("DOMMouseScroll",t.wheel,!0),window.removeEventListener("wheel",t.wheel,!0),window.removeEventListener("mousewheel",t.wheel,!0),window.removeEventListener("mousemove",t.wheel,!0)),window.onmousewheel=document.onmousewheel=document.onkeydown=null,document.getElementsByClassName("y-scroll-box")[0].style.display="block"}},c=function(){function e(t){var i=this;(0,a.default)(this,e),this._show=function(e,t){i.isShow?i._hide():(i.isShow=!0,i.menus=e,i.stage.selectData.selectStatus!==o.SELECT_STATUS.FORMULA&&(i.wrap.innerHTML="",i._addComponent(i.wrap),i.wrap.style.display="block",i.wrap.style.maxHeight="999px",i.wrap.style.left=t.left+5+"px",i.wrap.style.top=t.top+35+"px",i._fixSmartBoardPosition(t),i.stage.event.eventTable.listen("tableMove",i._hide),document.body.addEventListener("mousedown",i._hide,!1),i.stage.event.eventTable.listen("clearTable",i._hide),i.mouseScroll.disableScroll()))},this._hide=function(){for(i.isShow=!1,i.wrap.style.display="none";i.wrap.children[0];)i.wrap.removeChild(i.wrap.children[0]);i.stage.event.eventTable.remove("tableMove",i._hide),document.body.removeEventListener("mousedown",i._hide,!1),i.stage.event.eventTable.remove("clearTable",i._hide),i.mouseScroll.enableScroll()},this.stage=t.stage,this.init(t),this.initMouse(),this.stage.configData.permissions&&this.initEvent()}return(0,n.default)(e,[{key:"init",value:function(e){this.isShow=!1,this.mouseScroll=new g;var t=document.createElement("div");t.className="smart-selection-menu",this.wrap=t,e.container.appendChild(t)}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventSmart.listen("smartSelectionMenuShow",(0,s.default)(function(t,i){e._show(t,i)})),this.stage.event.eventSmart.listen("smartSelectionMenuHide",(0,s.default)(function(){e._hide()}))}},{key:"initMouse",value:function(){this.wrap.addEventListener("contextmenu",function(e){e.preventDefault()}),this.wrap.addEventListener("mousedown",function(e){e.stopPropagation()})}},{key:"_addComponent",value:function(e){for(var t=this,i=0;i<this.menus.length;i++){var n=this.menus[i],a=document.createElement("div");n.init?n.init(a):a.className=n.class,n.callback&&(a.addEventListener("mousedown",function(e){e.stopPropagation()}),a.addEventListener("click",function(){t._hide(),t.stage.focusInput()}),a.addEventListener("click",n.callback.bind(n))),e.appendChild(a)}}},{key:"_fixSmartBoardPosition",value:function(e){if(this.wrap){var t=this.stage.areaData,i=t.stage.height,n=t.stage.width,a=140+e.left>n;146+e.top>i&&(this.wrap.style.top=e.top-146+28-5+"px"),a&&(this.wrap.style.left=e.left-140+"px")}}}]),e}();t.default=c},1264:function(e,t,i){var n=i(1265);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1265:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".smart-selection-menu {\n  width: 140px;\n  border: 1px solid #d9d9d9;\n  background-color: #ffffff;\n  position: absolute;\n  z-index: 105;\n  overflow: hidden;\n  top: -9999px;\n  left: -9999px;\n  /* \u539f\u6765\u7528\u7684\u662f\u83dc\u5355\u7684\u6837\u5f0f\uff0c\u4f1a\u9020\u6210\u4e92\u76f8\u5f71\u54cd\uff0c\u628a\u90a3\u90e8\u5206\u7684\u6837\u5f0f\u62f7\u8d1d\u8fc7\u6765 */\n}\n.smart-selection-menu .menu-component {\n  padding: 0 28px;\n  font-size: 14px;\n  height: 32px;\n  line-height: 32px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.smart-selection-menu .component-vaild {\n  height: 32px;\n  cursor: pointer;\n}\n.smart-selection-menu .component-vaild:hover {\n  background-color: #f5f5f5;\n}\n.smart-selection-menu .component-invaild {\n  height: 32px;\n  color: #999999;\n  cursor: default;\n  pointer-events: none;\n}\n.smart-selection-menu .component-hide {\n  display: none;\n}\n.smart-selection-menu .component-line {\n  height: 1px;\n  width: 100%;\n  margin: 8px 1px;\n  background: rgba(0, 0, 0, 0.04);\n}\n.smart-selection-menu .component-status {\n  font-size: 10px;\n  color: #9B9B9B;\n  line-height: 32px;\n  display: inline-block;\n  position: relative;\n  right: -16px;\n  float: right;\n}\n.smart-selection-menu .menu-component {\n  width: 85px;\n}\n.smart-selection-menu::-webkit-scrollbar {\n  height: 16px;\n  overflow: visible;\n  width: 16px;\n}\n.smart-selection-menu::-webkit-scrollbar-button {\n  height: 0;\n  width: 0;\n}\n.smart-selection-menu::-webkit-scrollbar-thumb {\n  background-color: rgba(0, 0, 0, 0.2);\n  background-clip: padding-box;\n  border: solid transparent;\n  border-width: 1px 1px 1px 6px;\n  min-height: 28px;\n  padding: 100px 0 0;\n  box-shadow: inset 1px 1px 0 rgba(0, 0, 0, 0.1), inset 0 -1px 0 rgba(0, 0, 0, 0.07);\n}\n.component-vaild:hover {\n  background-color: #e9e9e9;\n}\n",""])},1266:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(14)),a=l(i(0)),o=l(i(1)),s=l(i(1267)),r=i(10);function l(e){return e&&e.__esModule?e:{default:e}}var h=l(i(677)).default.Promise,g=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,this.container=t.container,this.containers=t.containers,this.topLeft=null,this.topRight=null,this.bottomLeft=null,this.bottomRight=null,this.global=null,this.positionCenterKeyMap={},this.initEvent(),this.init()}return(0,o.default)(e,[{key:"init",value:function(){this._generate("topLeft"),this._generate("topRight"),this._generate("bottomLeft"),this._generate("bottomRight")}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventShape.listen("frameShow",function(t){e.topLeft.hideImage(t,!0),e.topRight.hideImage(t,!0),e.bottomLeft.hideImage(t,!0),e.bottomRight.hideImage(t,!0)}),this.stage.event.eventShape.listen("frameHide",function(t){e.topLeft.showImage(t,!0),e.topRight.showImage(t,!0),e.bottomLeft.showImage(t,!0),e.bottomRight.showImage(t,!0)}),this.stage.event.eventTable.listen("clearTable",function(){e._clear()}),this.stage.event.eventTable.listen("tableMove",function(t){t.areaX===r.TABLE_AREA.FROZEN?t.areaY===r.TABLE_AREA.FROZEN?(e.topLeft.move(),e.bottomLeft.move(),e.topRight.move()):(e.topLeft.move(),e.bottomLeft.move(),e.bottomRight.move()):t.areaY===r.TABLE_AREA.FROZEN?(e.topLeft.move(),e.topRight.move(),e.bottomRight.move()):(e.topRight.move(),e.bottomRight.move(),e.bottomLeft.move())}),this.stage.event.eventShape.listen("addImage",function(t){e._addImage(t)}),this.stage.event.eventShape.listen("updateImage",function(t){e._updateImage(t)}),this.stage.event.eventShape.listen("removeImage",function(t){e._removeImage(t)}),this.stage.event.eventTable.listen("scale",function(){e._scale(),e.topLeft.move(),e.topRight.move(),e.bottomLeft.move(),e.bottomRight.move()}),this.stage.event.eventTable.listen("reset",function(){e._updatePosition()}),this.stage.event.eventDimension.listen("updateFrozenCol",function(){e._updateFrozen()}),this.stage.event.eventDimension.listen("updateFrozenRow",function(){e._updateFrozen()})}},{key:"_scale",value:function(){this._updatePosition(),this._refresh()}},{key:"_refresh",value:function(){var e=this.stage.areaData,t=this.stage.tableData,i=t.shapes,n=void 0,a=void 0;for(a in i)Object.prototype.hasOwnProperty.call(i,a)&&(n=i[a],this.checkField(n),n.left=e.col.getRealGlobalLeft(n.anchor.col)+n.offset.x*t.scale,n.top=e.row.getRealGlobalTop(n.anchor.row)+n.offset.y*t.scale,n.width=n.size.width*t.scale,n.height=n.size.height*t.scale,n.clipTop=n.clipInfo.clipTop*t.scale,n.clipLeft=n.clipInfo.clipLeft*t.scale,n.clipRight=n.clipInfo.clipRight*t.scale,n.clipBottom=n.clipInfo.clipBottom*t.scale,this.topLeft.update(n),this.topRight.update(n),this.bottomLeft.update(n),this.bottomRight.update(n))}},{key:"checkField",value:function(e){e.offset?(void 0===e.offset.x&&(e.offset.x=0),void 0===e.offset.y&&(e.offset.y=0)):e.offset={x:0,y:0},e.anchor?(void 0===e.anchor.row&&(e.anchor.row=0),void 0===e.anchor.col&&(e.anchor.col=0)):e.anchor={row:0,col:0},e.clipInfo||(e.clipInfo={clipTop:0,clipLeft:0,clipRight:0,clipBottom:0})}},{key:"handleShape",value:function(e,t,i){this.checkField(e);var n=this.stage.areaData,a=this.stage.tableData,o=a.col,s=a.row,l=void 0,h=e.offset.x*a.scale>>0,g=e.offset.y*a.scale>>0,c=e.anchor.col,d=e.anchor.row;h=Math.min(h,o.getWidth(c)),g=Math.min(g,s.getHeight(d)),e.left=n.col.getRealGlobalLeft(c)+h,e.top=n.row.getRealGlobalTop(d)+g,e.left>=n.col.frozen.totalWidth+this.stage.configData.rowHeadWidth?e.areaX=r.TABLE_AREA.FLOW:e.areaX=r.TABLE_AREA.FROZEN,e.top>=n.row.frozen.totalHeight+this.stage.configData.colHeadHeight?e.areaY=r.TABLE_AREA.FLOW:e.areaY=r.TABLE_AREA.FROZEN;var u=e.url||"";if("data"!==u.substring(0,4)){var f=void 0;try{f=u?u.split("?")[1].match(/(^|$)_type=([^&]*)(&|$)/i)[2]:""}catch(v){f=""}f&&-1===["emf","wmf","jpg","jpeg","jfif","jpe","png","bmp","dib","rle","gif","emz","wmz","pcz","cgm","eps","pct","pict","wpg"].indexOf(f)&&(e.needPlaceholder=!0)}-1===e.size.width||-1===e.size.height?((l=new Image).onload=function(){e.size.width=l.width,e.size.height=l.height,e.width=e.size.width*a.scale,e.height=e.size.height*a.scale,e.clipInfo&&(e.clipInfo.clipTop*=a.scale,e.clipInfo.clipLeft*=a.scale,e.clipInfo.clipRight*=a.scale,e.clipInfo.clipBottom*=a.scale),t&&t()},l.onerror=function(){console.warn("\u56fe\u7247\u62c9\u53d6\u5931\u8d25\uff0c\u4f7f\u7528\u5360\u4f4d\u56fe",e.url),e.needPlaceholder=!0,e.size.width=-1===e.size.width?100:e.size.width,e.size.height=-1===e.size.height?78:e.size.height,e.width=e.width||100,e.height=e.height||78,t&&t()},l.src=e.url):(e.width=e.size.width*a.scale,e.height=e.size.height*a.scale,e.clipInfo&&(e.clipTop=e.clipInfo.clipTop*a.scale,e.clipLeft=e.clipInfo.clipLeft*a.scale,e.clipRight=e.clipInfo.clipRight*a.scale,e.clipBottom=e.clipInfo.clipBottom*a.scale),t&&t())}},{key:"_clear",value:function(){var e=this.stage.tableData.shapes,t=void 0,i=void 0;for(i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t=e[i],this.stage.positionCenter.remove(t.positionCenterKey),delete this.positionCenterKeyMap[i]);this.topLeft.clear(),this.topLeft.move(),this.topRight.clear(),this.topRight.move(),this.bottomLeft.clear(),this.bottomLeft.move(),this.bottomRight.clear(),this.bottomRight.move()}},{key:"bindPositionCenter",value:function(e,t){var i=this;e.xRange=[e.anchor.col,e.anchor.col],e.yRange=[e.anchor.row,e.anchor.row],e.positionCenterKey||(this.positionCenterKeyMap[t]&&(this.stage.positionCenter.remove(this.positionCenterKeyMap[t]),delete this.positionCenterKeyMap[t]),e.positionCenterKey=this.stage.positionCenter.add({type:"image",config:{ignoreSet:!1,ignoreAdd:!1,ignoreRemove:!1,ignoreHideShow:!1,ignoreFrozen:!1,listenSetBefore:!0,listenHideShowBefore:!0,removeType:"follow"},selfData:e,calc:function(t,n){t.xRange[1]<t.xRange[0]&&(t.xRange[1]=t.xRange[0]),t.yRange[1]<t.yRange[0]&&(t.yRange[1]=t.yRange[0]),t.xRange[0]!==t.anchor.col||t.yRange[0]!==t.anchor.row?(e.anchor.col=t.xRange[0],e.anchor.row=t.yRange[0],i.handleShape(e),i._updateChildren(e)):"set"!==n&&"hide"!==n&&n!==r.TABLE_AREA.FROZEN&&"show"!==n||(i.handleShape(e),i._updateChildren(e))}}),this.positionCenterKeyMap[t]=e.positionCenterKey)}},{key:"updateAllImage",value:function(){var e=this,t=this.stage.tableData.shapes,i=void 0,n=void 0,a=[];for(n in t)Object.prototype.hasOwnProperty.call(t,n)&&(i=t[n]).url&&a.push(new h(function(t,n){e.handleShape(i,t,n)}));h.all(a).then(function(){for(n in e._checkChildren(),e._addChildren(),t)Object.prototype.hasOwnProperty.call(t,n)&&(i=t[n]).url&&(e.handleShape(i),e._updateChildren(i))}).catch(function(e){console.error(e)})}},{key:"_addImage",value:function(e){var t=this,i=e.shape,n=i.id;i.url&&(this.stage.tableData.shapes[n]=i,new h(function(e,n){t.handleShape(i,e,n)}).then(function(){t.stage.tableData.shapes[n]&&(t.topLeft.add(i),t.topRight.add(i),t.bottomLeft.add(i),t.bottomRight.add(i),t.bindPositionCenter(i,n))}).catch(function(e){console.error(e)}))}},{key:"_updateImage",value:function(e){var t=this,i=e.shape,a=i.id;if(this.stage.tableData.shapes[a]){var o=this.stage.tableData.shapes[a];(0,n.default)(o,i),"undefined"===typeof o.xRange?o.xRange=[o.anchor.col,o.anchor.col]:o.xRange[0]=o.xRange[1]=o.anchor.col,"undefined"===typeof o.yRange?o.yRange=[o.anchor.row,o.anchor.row]:o.yRange[0]=o.yRange[1]=o.anchor.row,new h(function(e,i){t.handleShape(o,e,i)}).then(function(){t.stage.tableData.shapes[a]&&(t.stage.positionCenter.changeSelfData(o.positionCenterKey,o),t.topLeft.update(o),t.topRight.update(o),t.bottomLeft.update(o),t.bottomRight.update(o))}).catch(function(e){console.error(e)})}}},{key:"_removeImage",value:function(e){var t=e.id;this.stage.tableData.shapes[t]&&(this.stage.positionCenter.remove(this.stage.tableData.shapes[t].positionCenterKey),delete this.positionCenterKeyMap[t],delete this.stage.tableData.shapes[t],this.topLeft.remove(t),this.topRight.remove(t),this.bottomLeft.remove(t),this.bottomRight.remove(t))}},{key:"_checkChildren",value:function(){0===this.stage.areaData.col.frozen.length?(this.topLeft.toInValid(),this.bottomLeft.toInValid()):(this.topLeft.toValid(),this.bottomLeft.toValid()),0===this.stage.areaData.row.frozen.length?(this.topLeft.toInValid(),this.topRight.toInValid()):(this.topLeft.toValid(),this.topRight.toValid()),this.bottomRight.toValid()}},{key:"_updateChildren",value:function(e){this.topLeft.update(e),this.topRight.update(e),this.bottomLeft.update(e),this.bottomRight.update(e)}},{key:"_addChildren",value:function(){var e=void 0,t=this.stage.tableData.shapes,i=void 0;for(e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i=t[e],this.topLeft.add(i),this.topRight.add(i),this.bottomLeft.add(i),this.bottomRight.add(i),this.bindPositionCenter(i,e))}},{key:"_updatePosition",value:function(){var e=this.stage.areaData,t=this.stage.configData.rowHeadWidth+1,i=this.stage.configData.colHeadHeight+1;this.topLeft.distanceX=t,this.topLeft.distanceY=i,this.topRight.distanceX=e.col.flow.viewStart+(e.col.frozen.length>0?0:2),this.topRight.distanceY=i,this.bottomLeft.distanceX=t,this.bottomLeft.distanceY=e.row.flow.viewStart+(e.row.frozen.length>0?0:2),this.bottomRight.distanceX=e.col.flow.viewStart+(e.col.frozen.length>0?0:2),this.bottomRight.distanceY=e.row.flow.viewStart+(e.row.frozen.length>0?0:2),this.topLeft.move(),this.topRight.move(),this.bottomLeft.move(),this.bottomRight.move()}},{key:"_updateFrozen",value:function(){this._updatePosition(),this._checkChildren(),this._refresh()}},{key:"_generate",value:function(e){var t=this.stage.areaData,i=this.stage.configData.rowHeadWidth+1,n=this.stage.configData.colHeadHeight+1;switch(e){case"topLeft":this.topLeft=new s.default({container:this.containers[0].hidden,name:e,stage:this.stage,areaX:r.TABLE_AREA.FROZEN,areaY:r.TABLE_AREA.FROZEN,distanceX:i,distanceY:n});break;case"topRight":this.topRight=new s.default({container:this.containers[1].hidden,name:e,stage:this.stage,areaX:r.TABLE_AREA.FLOW,areaY:r.TABLE_AREA.FROZEN,distanceX:t.col.flow.viewStart+(t.col.frozen.length>0?0:2),distanceY:n});break;case"bottomLeft":this.bottomLeft=new s.default({container:this.containers[2].hidden,name:e,stage:this.stage,areaX:r.TABLE_AREA.FROZEN,areaY:r.TABLE_AREA.FLOW,distanceX:i,distanceY:t.row.flow.viewStart+(t.row.frozen.length>0?0:2)});break;case"bottomRight":this.bottomRight=new s.default({container:this.containers[3].hidden,name:e,stage:this.stage,areaX:r.TABLE_AREA.FLOW,areaY:r.TABLE_AREA.FLOW,distanceX:t.col.flow.viewStart+(t.col.frozen.length>0?0:2),distanceY:t.row.flow.viewStart+(t.row.frozen.length>0?0:2)})}}}]),e}();t.default=g},1267:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(9)),a=l(i(31)),o=l(i(0)),s=l(i(1)),r=l(i(1268));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,o.default)(this,e),this.container=t.container,this.stage=t.stage,this.distanceX=t.distanceX,this.distanceY=t.distanceY,this.images={},this.valid=!0,this.areaX=t.areaX,this.areaY=t.areaY,this.initStyle(),this.init(t)}return(0,s.default)(e,[{key:"initStyle",value:function(){i(1270)}},{key:"init",value:function(){var e=this,t=document.createElement("div");t.className="image-wrap";var i=document.createElement("div");i.className="image-board",this.wrap=t,this.board=i,t.appendChild(i),this.container.appendChild(t),this.stage.event.eventShape.one("imageZoom",function(t){e.images[t]&&e.images[t].zoom()}),window.__core&&__core.event.spreadsheetEvent.listen("imageZoom",function(t){e.images[t]&&e.images[t].zoom()})}},{key:"add",value:function(e){if(void 0===this.images[e.id]){var t={id:e.id,url:e.url,width:e.width>>0,height:e.height>>0,left:e.left-this.distanceX-this.stage.areaData.col[this.areaX].shadowX,top:e.top-this.distanceY-this.stage.areaData.row[this.areaY].shadowY,zIndex:e.zIndex>>0,clipTop:e.clipTop,clipLeft:e.clipLeft,clipRight:e.clipRight,clipBottom:e.clipBottom,needPlaceholder:e.needPlaceholder};if(e.previewInsertInfo&&(t.previewInsertInfo=e.previewInsertInfo),this.images[e.id]=new r.default({config:t,container:this.board,id:e.id,parent:this,stage:this.stage}),!e.gettingOriginalSize){e.originalWidth=0,e.originalHeight=0;var i=new Image;i.onload=function(){e.originalWidth=i.naturalWidth,e.originalHeight=i.naturalHeight,e.gettingOriginalSize=!1},i.src=e.url,e.gettingOriginalSize=!0}}else this.update(e)}},{key:"update",value:function(e){var t=e.id,i={left:e.left-this.distanceX-this.stage.areaData.col[this.areaX].shadowX,top:e.top-this.distanceY-this.stage.areaData.row[this.areaY].shadowY,width:e.width>>0,height:e.height>>0,url:e.url,clipTop:e.clipTop,clipLeft:e.clipLeft,clipRight:e.clipRight,clipBottom:e.clipBottom,needPlaceholder:e.needPlaceholder};e.previewInsertInfo&&(i.previewInsertInfo=e.previewInsertInfo);var n=this.images[t];void 0!==n&&n.update(i)}},{key:"remove",value:function(e){var t=this.images[e];t&&(t.destory(),this.board.removeChild(t.wrap),delete this.images[e])}},{key:"move",value:function(){if(this.valid){var e=-this.stage.areaData.col[this.areaX].offsetX,t=-this.stage.areaData.row[this.areaY].offsetY;this.board.style.webkitTransform=this.board.style.transform="translate3d("+e+"px,"+t+"px,0)"}}},{key:"toValid",value:function(){this.valid=!0,this.show()}},{key:"toInValid",value:function(){this.valid=!1,this.hide()}},{key:"hide",value:function(){this.wrap.style.display="none"}},{key:"show",value:function(){this.wrap.style.display="block"}},{key:"hideImage",value:function(e,t){var i=this.images[e];i&&i.hide(t)}},{key:"showImage",value:function(e,t){var i=this.images[e];i&&i.show(t)}},{key:"clear",value:function(){var e=void 0,t=!0,i=!1,o=void 0;try{for(var s,r=(0,a.default)((0,n.default)(this.images));!(t=(s=r.next()).done);t=!0)e=s.value,this.remove(e)}catch(l){i=!0,o=l}finally{try{!t&&r.return&&r.return()}finally{if(i)throw o}}this.hide()}},{key:"zoomByMobile",value:function(e){var t=this,i=0,a=(0,n.default)(this.images).map(function(n,a){return n===e&&(i=a),t.images[n].config.url});a.length>0&&window.mqq&&mqq.invoke("troopNotice","showPicture",{index:i,imageIDs:a})}}]),e}();t.default=h},1268:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(3)),a=c(i(0)),o=c(i(1)),s=c(i(4)),r=c(i(59)),l=c(i(5)),h=c(i(1269)),g=c(i(8));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.initMouse(),i}return(0,l.default)(t,e),(0,o.default)(t,[{key:"initMouse",value:function(){var e=this;this.wrap.addEventListener("mousedown",function(t){t.stopPropagation(),e._active()}),this.wrap.addEventListener("contextmenu",function(t){t.preventDefault(),t.stopPropagation(),e._active()}),this.wrap.addEventListener("dragstart",function(e){e.preventDefault()})}},{key:"zoom",value:function(){(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"zoom",this).call(this);try{g.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_view"})}catch(e){}}}]),t}(h.default);t.default=d},1269:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(9)),a=l(i(0)),o=l(i(1)),s=i(21),r=l(i(7));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,this.config=t.config,this.container=t.container,this.parent=t.parent,this.id=t.id,this.init()}return(0,o.default)(e,[{key:"init",value:function(){var t=this,i=document.createElement("div");i.style.width=this.config.width+"px",i.style.height=this.config.height+"px",i.style.left=this.config.left+"px",i.style.top=this.config.top+"px",i.style.zIndex=this.config.zIndex,i.style.position="absolute",i.style.overflow="hidden",i.className="image-elem",this.config.previewInsertInfo&&(i.style.border=this.config.previewInsertInfo.borderColor,i.setAttribute("recordAuthor",this.config.previewInsertInfo.recordAuthor)),this.wrap=i,this.container.appendChild(i);var n=new Image;this.image=n;var a=this.config.url;a&&e.imagesToLoad++,this.config.needPlaceholder?(n.src=s.placeholderImageSrc,e.successImageToReport--,e.failImageToReport++):n.src=this.config.url,n.style.position="absolute",n.style.top=-this.config.clipTop+"px",n.style.left=-this.config.clipLeft+"px",n.style.width=this.config.clipLeft+this.config.width+this.config.clipRight+"px",n.style.height=this.config.clipTop+this.config.height+this.config.clipBottom+"px",n.onload=function(){i.appendChild(n),a&&(e.successImageToReport++,e.imagesToLoad--,0==e.imagesToLoad&&(tdwReport({opername:"doc_edit",module:"pic_loading_excel",action:"load_error",obj1:e.successImageToReport/4>>0,obj2:e.failImageToReport/4>>0}),e.successImageToReport=0,e.failImageToReport=0))},n.onerror=function(){a&&(t.image.src=s.placeholderImageSrc,e.successImageToReport--,e.failImageToReport++)},this.frameShow=!1,this.filterDisplay()}},{key:"initRecordHover",value:function(){var e=this;$(this.wrap).on("mouseover",function(){var t={tableImage:e,author:e.wrap.getAttribute("recordAuthor"),hover:!0};e.stage.event.eventRecord.trigger("recordviewImageHover",t)}),$(this.wrap).on("mouseout",function(){e.stage.event.eventRecord.trigger("recordviewImageHover",{hover:!1})}),$(this.wrap).on("mousemove",function(t){if(!window.recordHoverTipShow){var i={tableImage:e,author:e.wrap.getAttribute("recordAuthor"),hover:!0};e.stage.event.eventRecord.trigger("recordviewImageHover",i)}t.preventDefault(),t.stopPropagation()})}},{key:"update",value:function(e){this.config.url!==e.url&&(this.config.url=e.url,this.image.src=e.url),e.previewInsertInfo&&(this.wrap.style.border=e.previewInsertInfo.borderColor,this.wrap.setAttribute("recordAuthor",e.previewInsertInfo.recordAuthor),this.initRecordHover()),this.config.width=e.width,this.wrap.style.width=e.width+"px",this.config.height=e.height,this.wrap.style.height=e.height+"px",this.config.left=e.left,this.wrap.style.left=e.left+"px",this.config.top=e.top,this.wrap.style.top=e.top+"px",this.image.style.position="absolute",this.config.clipTop=e.clipTop,this.config.clipLeft=e.clipLeft,this.config.clipRight=e.clipRight,this.config.clipBottom=e.clipBottom,this.image.style.top=-this.config.clipTop+"px",this.image.style.left=-this.config.clipLeft+"px",this.image.style.width=this.config.clipLeft+this.config.width+this.config.clipRight+"px",this.image.style.height=this.config.clipTop+this.config.height+this.config.clipBottom+"px",this.filterDisplay()}},{key:"hide",value:function(e){e&&(this.frameShow=!0),this.wrap.style.display="none"}},{key:"show",value:function(e){e&&(this.frameShow=!1),this.wrap.style.display="block"}},{key:"filterDisplay",value:function(){if(!this.frameShow){var e=this.stage.tableData.shapes&&this.stage.tableData.shapes[this.id];e&&!(0,s.isRowShow)(this.stage.tableData,e.anchor.row)?this.hide():this.show()}}},{key:"_active",value:function(){this.stage.event.eventShape.trigger("frameShow",this.id),this.stage.event.eventTable.trigger("enterActiveStatus"),this.stage.event.eventMenu.trigger("tableMenuHide")}},{key:"zoom",value:function(){var e=this,t=(0,n.default)(this.stage.tableData.shapes).map(function(t){return e.stage.tableData.shapes[t].url}),i=(0,n.default)(this.stage.tableData.shapes).map(function(t){return e.stage.tableData.shapes[t].id}).indexOf(this.id);r.default.window.CoreSheet&&r.default.window.CoreSheet.util.viewImage(t,i)}},{key:"destory",value:function(){}}]),e}();h.imagesToLoad=0,h.successImageToReport=0,h.failImageToReport=0,t.default=h},1270:function(e,t,i){var n=i(1271);"string"===typeof n&&(n=[[e.i,n,""]]);var a={hmr:!0,transform:void 0,insertInto:void 0};i(37)(n,a);n.locals&&(e.exports=n.locals)},1271:function(e,t,i){(e.exports=i(36)(!1)).push([e.i,".image-wrap {\n    position: absolute;\n    left: 0;\n    top: 0;\n    -webkit-transform-origin: left top;\n    transform-origin: left top;\n}\n\n.image-board {\n    position: absolute;\n    left: 0;\n    top: 0;\n    z-index: 9;\n}\n\n.image-elem {\n    position: absolute;\n    box-sizing: border-box;\n}\n\n.image-elem img {\n    width: 100%;\n    height: 100%;\n    -webkit-user-select: none;\n       -moz-user-select: none;\n        -ms-user-select: none;\n            user-select: none;\n}\n",""])},1272:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));i(21),i(10);function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.ctx=this.stage.ctx,this.filter={},this.init(),this.initEvent()}return(0,a.default)(e,[{key:"init",value:function(){var e=this;this.positionCenterKey=this.stage.positionCenter.add({type:"filter",config:{ignoreSet:!0,ignoreAdd:!1,ignoreRemove:!1,ignoreHideShow:!1,ignoreFrozen:!0},selfData:this.stage.tableData.filter.range||{},calc:function(){e._calc()}})}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventFilter.listen("doFilter",function(){e._doFilter()}),this.stage.event.eventFilter.listen("closeFilter",function(){e._closeFilter()})}},{key:"_doFilter",value:function(){var e=this.stage.tableData;if(void 0!==e.filter.range){var t,i,n=this.stage.areaData,a=e.filter.range,o=a.xRange[0],s=a.yRange[0],r=a.xRange[1],l=a.yRange[1],h=this.stage.configData.filter.rangeBorderColor,g=e.col,c=e.row,d=void 0,u=0,f=0;for(this.stage.positionCenter.changeSelfData(this.positionCenterKey,a),d=o;d<=r;d++)u+=g.getWidth(d);for(d=s;d<=l;d++)f+=c.getHeight(d);t=n.col.getGlobalLeft(o)+n.col.flow.shadowX||0,i=n.row.getGlobalTop(s),this.filter={width:u,height:f,left:t,top:i,color:h}}}},{key:"_closeFilter",value:function(){this.stage.positionCenter.changeSelfData(this.positionCenterKey,{}),delete this.filter}},{key:"_calc",value:function(){var e=this.stage.tableData,t=e.filter.range;if(void 0!==t&&void 0!==t.xRange&&void 0!==t.xRange[0])if(t.xRange[1]<t.xRange[0]||t.yRange[1]<t.yRange[0])this.stage.positionCenter.changeSelfData(this.positionCenterKey,{});else;else this.stage.positionCenter.changeSelfData(this.positionCenterKey,{})}},{key:"_scale",value:function(){this.stage.tableData.filter.open&&this._calc()}},{key:"renderBorder",value:function(e,t){}}]),e}();t.default=s},1273:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(25)),a=g(i(9)),o=g(i(14)),s=g(i(0)),r=g(i(1)),l=i(21),h=i(10);function g(e){return e&&e.__esModule?e:{default:e}}var c={ignoreSet:{row:!0,column:!0},ignoreAdd:{row:!1,column:!1},ignoreRemove:{row:!1,column:!1},ignoreHideShow:{row:!1,column:!1},ignoreFrozen:{row:!1,column:!1},ignoreMerge:!1,removeType:"follow"},d=function(){function e(t){(0,s.default)(this,e),this.stage=t.stage,this.queue=[],this.addIndex=0,this.init(),this.keyMap={}}return(0,r.default)(e,[{key:"run",value:function(){this.initEvent()}},{key:"init",value:function(){}},{key:"initEvent",value:function(){var e=this;this.stage.event.eventDimension.listen("setColWidth",function(t){e._setColWidth(t)}),this.stage.event.eventDimension.listen("setRowHeight",function(t){e._setRowHeight(t)}),this.stage.event.eventDimension.listen("addCol",function(t){e._addCol(t)}),this.stage.event.eventDimension.listen("addRow",function(t){e._addRow(t)}),this.stage.event.eventDimension.listen("removeCol",function(t){e._removeCol(t)}),this.stage.event.eventDimension.listen("removeRow",function(t){e._removeRow(t)}),this.stage.event.eventDimension.listen("hideCol",function(t){e._hideCol(t)}),this.stage.event.eventDimension.listen("hideRow",function(t){e._hideRow(t)}),this.stage.event.eventDimension.listen("showCol",function(t){e._showCol(t)}),this.stage.event.eventDimension.listen("showRow",function(t){e._showRow(t)}),this.stage.event.eventFilter.listen("hideFilterRow",function(t){e._hideRow(t)}),this.stage.event.eventFilter.listen("showFilterRow",function(t){e._showRow(t)}),this.stage.event.eventDimension.listen("updateFrozenCol",function(){e._updateFrozenCol()}),this.stage.event.eventDimension.listen("updateFrozenRow",function(){e._updateFrozenRow()}),this.stage.event.eventCell.listen("mergeCell",function(t){e._mergeCell(t)}),this.stage.event.eventCell.listen("splitCell",function(t){e._splitCell(t)})}},{key:"_setColWidth",value:function(e){var t=e.index,i=void 0,n=void 0,a=void 0,o=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreSet.column&&(o=!1,void 0!==(a=n.selfData).xRange&&a.xRange[0]>=0&&((0,l.isCrossRange)([t,t],a.xRange)?o=!0:a.xRange[0]>t&&n.config.listenSetBefore&&(o=!0)),o&&n.calc(a,"set",e))}},{key:"_setRowHeight",value:function(e){var t=e.index,i=void 0,n=void 0,a=void 0,o=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreSet.row&&(o=!1,void 0!==(a=n.selfData).yRange&&a.yRange[0]>=0&&((0,l.isCrossRange)([t,t],a.yRange)?o=!0:a.yRange[0]>t&&n.config.listenSetBefore&&(o=!0)),o&&n.calc(a,"set",e))}},{key:"_addCol",value:function(e){var t=e.index,i=e.amount,n=void 0,a=void 0,o=void 0,s=void 0;for(n=this.queue.length-1;n>=0;n--)(a=this.queue[n])&&!a.config.ignoreAdd.column&&(s=!1,void 0!==(o=a.selfData).xRange&&o.xRange[0]>=0&&(0,l.rangeInsert)(o.xRange,t,i)&&(s=!0),s&&a.calc(o,"add",e))}},{key:"_addRow",value:function(e){var t=e.index,i=e.amount,n=void 0,a=void 0,o=void 0,s=void 0;for(n=this.queue.length-1;n>=0;n--)(a=this.queue[n])&&!a.config.ignoreAdd.row&&(s=!1,void 0!==(o=a.selfData).yRange&&o.yRange[0]>=0&&(0,l.rangeInsert)(o.yRange,t,i)&&(s=!0),s&&a.calc(o,"add",e))}},{key:"_removeCol",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0,r=this.queue.length-1;for(e.type="col",i=r;i>=0;i--)if((n=this.queue[i])&&!n.config.ignoreRemove.column){if(s=!1,void 0!==(a=n.selfData).xRange&&a.xRange[0]>=0)if("fixed"===n.config.removeType)a.xRange[1]>=t[0]&&(s=!0);else{if("follow"!==n.config.removeType)throw"unknown positionCenter config removeType"+n.config.removeType;(0,l.rangeDelete)(a.xRange,t[0],t[1]-t[0]+1)&&(s=!0)}s&&n.calc(a,"remove",(0,o.default)({},e,{type:"COL"}))}}},{key:"_removeRow",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0,r=this.queue.length-1;for(e.type="row",i=r;i>=0;i--)if((n=this.queue[i])&&!n.config.ignoreRemove.row){if(s=!1,void 0!==(a=n.selfData).yRange&&a.yRange[0]>=0)if("fixed"===n.config.removeType)a.yRange[1]>=t[0]&&(s=!0);else{if("follow"!==n.config.removeType)throw"unknown positionCenter config removeType"+n.config.removeType;(0,l.rangeDelete)(a.yRange,t[0],t[1]-t[0]+1)&&(s=!0)}s&&n.calc(a,"remove",(0,o.default)({},e,{type:"ROW"}))}}},{key:"_hideCol",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreHideShow.column&&(s=!1,void 0!==(a=n.selfData).xRange&&a.xRange[0]>=0&&((0,l.isCrossRange)(t,a.xRange)?s=!0:a.xRange[0]>t[0]&&n.config.listenHideShowBefore&&(s=!0)),s&&n.calc(a,"hide",(0,o.default)({},e,{type:"COL"})))}},{key:"_hideRow",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreHideShow.row&&(s=!1,void 0!==(a=n.selfData).yRange&&a.yRange[0]>=0&&((0,l.isCrossRange)(t,a.yRange)?s=!0:a.yRange[0]>t[0]&&n.config.listenHideShowBefore&&(s=!0)),s&&n.calc(a,"hide",(0,o.default)({},e,{type:"ROW"})))}},{key:"_showCol",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreHideShow.column&&(s=!1,void 0!==(a=n.selfData).xRange&&a.xRange[0]>=0&&((0,l.isCrossRange)(t,a.xRange)?s=!0:a.xRange[0]>t[0]&&n.config.listenHideShowBefore&&(s=!0)),s&&n.calc(a,"show",(0,o.default)({},e,{type:"COL"})))}},{key:"_showRow",value:function(e){var t=e.range,i=void 0,n=void 0,a=void 0,s=void 0;for(i=this.queue.length-1;i>=0;i--)(n=this.queue[i])&&!n.config.ignoreHideShow.row&&(s=!1,void 0!==(a=n.selfData).yRange&&a.yRange[0]>=0&&((0,l.isCrossRange)(t,a.yRange)?s=!0:a.yRange[0]>t[0]&&n.config.listenHideShowBefore&&(s=!0)),s&&n.calc(a,"show",(0,o.default)({},e,{type:"ROW"})))}},{key:"_updateFrozenCol",value:function(){var e=void 0,t=void 0,i=void 0,n=void 0;for(e=this.queue.length-1;e>=0;e--)(t=this.queue[e])&&!t.config.ignoreFrozen.column&&(n=!1,void 0!==(i=t.selfData).xRange&&i.xRange[0]>=0&&(n=!0),n&&t.calc(i,h.TABLE_AREA.FROZEN))}},{key:"_updateFrozenRow",value:function(){var e=void 0,t=void 0,i=void 0,n=void 0;for(e=this.queue.length-1;e>=0;e--)(t=this.queue[e])&&!t.config.ignoreFrozen.row&&(n=!1,void 0!==(i=t.selfData).yRange&&i.yRange[0]>=0&&(n=!0),n&&t.calc(i,h.TABLE_AREA.FROZEN))}},{key:"_mergeCell",value:function(e){var t=e.x,i=e.y,n=void 0,a=void 0,o=void 0,s=void 0,r=[t,t+e.w-1],h=[i,i+e.h-1];for(n=this.queue.length-1;n>=0;n--)(a=this.queue[n])&&!a.config.ignoreMerge&&(s=!1,void 0!==(o=a.selfData).yIndex&&o.yIndex>=0&&void 0!==o.xIndex&&o.xIndex>=0&&(0,l.isInRange)(o.xIndex,r)&&(0,l.isInRange)(o.yIndex,h)&&(o.xIndex=t,o.yIndex=i,s=!0),void 0!==o.yRange&&o.yRange[0]>=0&&void 0!==o.xRange&&o.xRange[0]>=0&&((0,l.isInRange)(o.xRange[0],r)&&(0,l.isInRange)(o.yRange[0],h)&&(o.xRange[0]=t,o.yRange[0]=i,s=!0),(0,l.isInRange)(o.xRange[1],r)&&(0,l.isInRange)(o.yRange[1],h)&&(o.xRange[1]=r[1],o.yRange[1]=h[1],s=!0)),s&&a.calc(o,"merge"))}},{key:"_splitCell",value:function(e){var t=e.x,i=e.y,n=void 0,a=void 0,o=void 0,s=void 0,r=[t,t+e.w-1],h=[i,i+e.h-1];for(n=this.queue.length-1;n>=0;n--)(a=this.queue[n])&&!a.config.ignoreMerge&&(s=!1,void 0!==(o=a.selfData).yIndex&&o.yIndex>=0&&void 0!==o.xIndex&&o.xIndex>=0&&(o.xIndex=t,o.yIndex=i,s=!0),void 0!==o.yRange&&o.yRange[0]>=0&&void 0!==o.xRange&&o.xRange[0]>=0&&((0,l.isInRange)(o.xRange[0],r)&&(0,l.isInRange)(o.yRange[0],h)&&(o.xRange[0]=t,o.yRange[0]=i,s=!0),(0,l.isInRange)(o.xRange[1],r)&&(0,l.isInRange)(o.yRange[1],h)&&(o.xRange[1]=r[1],o.yRange[1]=h[1],s=!0)),s&&a.calc(o,"merge"))}},{key:"add",value:function(e){var t=function(){var e=(new Date).getTime(),t=void 0;return"xxxxxxxx-xxxx-4xxx-yxxx".replace(/[xy]/g,function(i){return t=(e+16*Math.random())%16|0,e=Math.floor(e/16),("x"==i?t:3&t|8).toString(16)})}();e.key=t;var i=e.selfData;return void 0!==i.xRange&&(i.xRange[0]=parseInt(i.xRange[0]),i.xRange[1]=parseInt(i.xRange[1])),void 0!==i.yRange&&(i.yRange[0]=parseInt(i.yRange[0]),i.yRange[1]=parseInt(i.yRange[1])),this.handleConfig(e),this.queue.push(e),this.keyMap[t]=this.queue.length-1,this.addIndex++,this.addIndex>30&&(this._clear(),this.addIndex=0),t}},{key:"handleConfig",value:function(e){var t=void 0,i=void 0;e.config&&0!==(0,a.default)(e.config).length?("boolean"===(0,n.default)(e.config.ignoreSet)?(i={row:t=e.config.ignoreSet,column:t},e.config.ignoreSet=i):void 0===e.config.ignoreSet&&(e.config.ignoreSet=c.ignoreSet),"boolean"===(0,n.default)(e.config.ignoreAdd)?(i={row:t=e.config.ignoreAdd,column:t},e.config.ignoreAdd=i):void 0===e.config.ignoreAdd&&(e.config.ignoreAdd=c.ignoreAdd),"boolean"===(0,n.default)(e.config.ignoreRemove)?(i={row:t=e.config.ignoreRemove,column:t},e.config.ignoreRemove=i):void 0===e.config.ignoreRemove&&(e.config.ignoreRemove=c.ignoreRemove),"boolean"===(0,n.default)(e.config.ignoreHideShow)?(i={row:t=e.config.ignoreHideShow,column:t},e.config.ignoreHideShow=i):void 0===e.config.ignoreHideShow&&(e.config.ignoreHideShow=c.ignoreHideShow),"boolean"===(0,n.default)(e.config.ignoreFrozen)?(i={row:t=e.config.ignoreFrozen,column:t},e.config.ignoreFrozen=i):void 0===e.config.ignoreFrozen&&(e.config.ignoreFrozen=c.ignoreFrozen),void 0===e.config.ignoreMerge&&(e.config.ignoreMerge=c.ignoreMerge),void 0===e.config.removeType&&(e.config.removeType="follow")):e.config=c}},{key:"remove",value:function(e){var t=this.keyMap[e];void 0!==t&&(delete this.keyMap[e],delete this.queue[t])}},{key:"changeSelfData",value:function(e,t){var i=this.keyMap[e];this.queue[i].selfData=t}},{key:"_clear",value:function(){var e=void 0,t=void 0;for(e=0;e<this.queue.length;e++)(t=this.queue[e])||(this.queue.splice(e,1),e--);for(e=0;e<this.queue.length;e++)t=this.queue[e],this.keyMap[t.key]=e}}]),e}();t.default=d},1274:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(i(154)),a=u(i(0)),o=u(i(1)),s=i(10),r=u(i(1275)),l=u(i(686)),h=i(21),g=u(i(1276)),c=u(i(1277)),d=u(i(404));function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,void 0===t.config&&(t.config={}),this.scale=t.config.scale||1,this.tableStatus=0,this.inputStatus=0,this.locking=!1,this.adjustHeightSign=!1,this.adjustHeightLine=(0,n.default)(null),this.data=[],this.defaultCell=new r.default({stage:this.stage}),this.hideRowMap={},this.hideColMap={},this.shapes={},this.filter={range:{xRange:[],yRange:[]},states:{},hide:[],open:!1},this.filterHideRowMap={},this.col=new g.default(t),this.row=new c.default(t),this.viewportY=0,this.viewportX=0,this.renderSeq=0,this.selectionChanged=!1,this.hideGridlines=!1}return(0,o.default)(e,[{key:"init",value:function(e){this.shapes=e.shapes,this.merge=e.merge,this.col.update(e.colWidths),this.row.update(e.rowHeights),this.data=e.data,e.frozen&&(e.frozen.row>e.rowHeights.length&&(e.frozen.row=e.rowHeights.length),e.frozen.col>e.colWidths.length&&(e.frozen.col=e.colWidths.length)),this.frozen=e.frozen||{col:0,row:0},this.hideGridlines=!!e.hideGridlines}},{key:"transformData",value:function(e,t){!this.data[e]||!this.data[e][t]||this.data[e][t]instanceof d.default||(this.data[e][t]=(0,l.default)(this.data[e][t],this.stage))}},{key:"getCellDataAtPosition",value:function(e,t){switch(arguments.length>2&&void 0!==arguments[2]?arguments[2]:s.GET_CELLDATA.NORMAL){case s.GET_CELLDATA.NORMAL:return this.data[e]&&this.data[e][t]?(this.transformData(e,t),this.data[e][t]):null;case s.GET_CELLDATA.DEFAULT:return this.data[e]&&this.data[e][t]?(this.transformData(e,t),this.data[e][t]):this.defaultCell;case s.GET_CELLDATA.FILL:return this.data[e]?(this.data[e][t]||(this.data[e][t]=(0,l.default)({},this.stage)),this.transformData(e,t),this.data[e][t]):(this.data[e]=[],this.data[e][t]=(0,l.default)({},this.stage),this.transformData(e,t),this.data[e][t])}}},{key:"destroyCellDataAtPosition",value:function(e,t){this.getCellDataAtPosition(e,t,s.GET_CELLDATA.NORMAL)&&(this.data[e][t]=null)}},{key:"getCellBackgroundWidth",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getCellDataAtPosition(e,t,s.GET_CELLDATA.NORMAL);return n&&n.parent&&n.parent.mergeData&&n.parent.mergeData.xRange?this.col.getRangeWidth(n.parent.mergeData.xRange,{ignoreScale:i}):this.col.getWidth(t,{ignoreScale:i})}},{key:"getCellBackgroundHeight",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],n=this.getCellDataAtPosition(e,t,s.GET_CELLDATA.NORMAL);return n&&n.parent&&n.parent.mergeData&&n.parent.mergeData.yRange?this.row.getRangeHeight(n.parent.mergeData.yRange,{ignoreScale:i}):this.row.getHeight(e,{ignoreScale:i})}},{key:"getCellBorderWidth",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.col.getWidth(t,{ignoreScale:i})}},{key:"getCellBorderHeight",value:function(e,t){var i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.row.getHeight(e,{ignoreScale:i})}},{key:"cellHasFilterHeader",value:function(e,t){if(!this.filter.open)return!1;var i=this.filter.range.xRange;return e===this.filter.range.yRange[0]&&!!(0,h.isInRange)(t,i)}}]),e}();t.default=f},1275:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(3)),a=g(i(0)),o=g(i(1)),s=g(i(4)),r=g(i(5)),l=g(i(404)),h=i(33);function g(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,r.default)(t,e),(0,o.default)(t,[{key:"getLineHeight",value:function(){return 19}},{key:"getFontSize",value:function(e){return(e?this.stage.tableData.scale:1)*this.stage.configData.styles.fontSize}},{key:"getMaxTextWidth",value:function(){return 0}},{key:"render",value:function(e,t,i,n,a){this._renderBackground(e,t,i,n,a)}},{key:"renderBorder",value:function(e,t,i,n,a){this.stage.renders.borderRender.calcDefaultTableCellBorder(t,i,n,a)}},{key:"paddingLeft",set:function(e){},get:function(){return 4*this.stage.tableData.scale>>0}},{key:"paddingRight",set:function(e){},get:function(){return 4*this.stage.tableData.scale>>0}},{key:"text",set:function(e){},get:function(){return null}},{key:"paragraph",set:function(e){},get:function(){return[]}},{key:"defaultFontSize",set:function(e){},get:function(){return this.stage.configData.styles.fontSize}},{key:"color",set:function(e){},get:function(){return this.stage.configData.styles.color}},{key:"backgroundColor",set:function(e){},get:function(){return this.stage.configData.styles.backgroundColor}},{key:"fontFamily",set:function(e){},get:function(){return null}},{key:"fontItalic",set:function(e){},get:function(){return null}},{key:"fontBold",set:function(e){},get:function(){return null}},{key:"fontBottomLine",set:function(e){},get:function(){return null}},{key:"fontMiddleLine",set:function(e){},get:function(){return null}},{key:"recordAuthor",set:function(e){},get:function(){return null}},{key:"borderColor",set:function(e){},get:function(){return[h.GRIDLINE_BORDER_COLOR,h.GRIDLINE_BORDER_COLOR,h.GRIDLINE_BORDER_COLOR,h.GRIDLINE_BORDER_COLOR]}},{key:"borderStyle",set:function(e){},get:function(){return[null,null,null,null]}},{key:"borderTopShow",set:function(e){},get:function(){return!1}},{key:"borderLeftShow",set:function(e){},get:function(){return!1}},{key:"borderBottomShow",set:function(e){},get:function(){return!0}},{key:"borderRightShow",set:function(e){},get:function(){return!0}},{key:"renderSeq",set:function(e){},get:function(){return 0}},{key:"textWrap",set:function(e){},get:function(){return this.stage.configData.styles.textWrap}},{key:"textAlign",set:function(e){},get:function(){return this.stage.configData.styles.textAlign}},{key:"verticalAlign",set:function(e){},get:function(){return this.stage.configData.styles.verticalAlign}}]),t}(l.default);t.default=c},1276:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=i(21);function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,n.default)(this,e),l.call(this),this.stage=t.stage,this.widths=[],this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){this.stage.event.eventDimension.listen("updateFrozenCol",this._updateFrozenCol),this.stage.event.eventDimension.listen("setColWidth",this._setColWidth),this.stage.event.eventDimension.listen("addCol",this._addCol),this.stage.event.eventDimension.listen("hideCol",this._hideCol),this.stage.event.eventDimension.listen("showCol",this._showCol),this.stage.event.eventDimension.listen("removeCol",this._removeCol)}},{key:"_checkContent",value:function(){var e=void 0,t=void 0;if(this.length>o.colName.length){for(e=o.colName.length,t=0;t<26;t++)o.colName.push((0,o.colIndexToName)(e+t));this._checkContent()}}},{key:"update",value:function(e){this.widths=e,this._checkContent()}},{key:"length",get:function(){return this.widths.length},set:function(e){console.error("can't set length")}}]),e}(),l=function(){var e=this;this._updateFrozenCol=function(t){e.stage.tableData.frozen.col=t},this._setColWidth=function(t){var i=t.newWidth>>0,n=t.index>>0,a=e.stage.tableData;a.hideColMap[n]?a.hideColMap[n].width=i:e.widths[n]=i},this._showCol=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0,r=void 0;for(r=a;r<=o;r++)void 0!==n.hideColMap[r]?(s=n.hideColMap[r].width,e.widths[r]=s,delete n.hideColMap[r]):console.warn(r," \u5217\u5df2\u7ecf\u5c55\u793a")},this._hideCol=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0,r=void 0;for(r=a;r<=o;r++)void 0===n.hideColMap[r]?(s=e.widths[r],n.hideColMap[r]={width:s},e.widths[r]=0):console.warn(r," \u5217\u5df2\u7ecf\u9690\u85cf")},this._removeCol=function(t){var i=t.range,n=i[0],a=i[1]-n+1;e.widths.splice(n,a),e.stage.tableData.hideColMap=(0,o.mapDelete)(e.stage.tableData.hideColMap,n,a)},this._addCol=function(t){var i=t.index,n=t.amount,a=void 0;for(a=0;a<n;a++)e.widths.splice(i,0,null);e.stage.tableData.hideColMap=(0,o.mapInsert)(e.stage.tableData.hideColMap,i,n),e._checkContent()},this.getWidth=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.ignoreScale,a=void 0!==n&&n,o=i.ignoreHide,s=void 0===o||o,r=void 0;return null!==(r=t>=e.widths.length?0:s?e.widths[t]:e.stage.tableData.hideColMap[t]?e.stage.tableData.hideColMap[t].width:e.widths[t])&&void 0!==r||(r=e.stage.configData.colWidth),r*(a?1:e.stage.tableData.scale)>>0},this.getRangeWidth=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,a=0;for(n=t[0];n<=t[1];n++)a+=e.getWidth(n,i);return a}};t.default=r},1277:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(21),s=i(21);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),h.call(this),this.stage=t.stage,this.heights=[],this.setHeights=[],this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventDimension.listen("updateFrozenRow",this._updateFrozenRow),this.stage.event.eventDimension.listen("setRowHeight",this._setRowHeight),this.stage.event.eventDimension.listen("addRow",this._addRow),this.stage.event.eventDimension.listen("hideRow",this._hideRow),this.stage.event.eventDimension.listen("showRow",this._showRow),this.stage.event.eventDimension.listen("removeRow",this._removeRow),this.stage.event.eventFilter.listen("hideFilterRow",this._hideFilterRow),this.stage.event.eventFilter.listen("showFilterRow",this._showFilterRow),this.stage.event.eventTable.listen("clearTable",function(){e._clear()})}},{key:"update",value:function(e){this.setHeights=e;var t=void 0,i=void 0;for(t=0;t<e.length;t++)i=e[t],(0,s.isUndefined)(i)||(0,s.isNull)(i)||(this.heights[t]=i);this.heights.length=e.length}},{key:"updateHeights",value:function(e){var t=void 0,i=void 0;for(t=0;t<e.length;t++)i=e[t],this.heights[t]=i;this.heights.length=e.length}},{key:"_clear",value:function(){this.heights=[],this.setHeights=[]}},{key:"length",get:function(){return this.heights.length},set:function(e){console.error("can't set length")}}]),e}(),h=function(){var e=this;this._updateFrozenRow=function(t){e.stage.tableData.frozen.row=t},this._setRowHeight=function(t){var i=t.newHeight,n=t.index>>0,a=e.stage.tableData;t.user&&(e.setHeights[n]=i,a.hideRowMap[n]&&(a.hideRowMap[n].setHeight=i),a.filterHideRowMap[n]&&(a.filterHideRowMap[n].setHeight=i)),void 0!==i&&null!==i||(i=e.stage.configData.rowHeight),a.hideRowMap[n]?a.hideRowMap[n].height=i:a.filterHideRowMap[n]?a.filterHideRowMap[n].height=i:e.heights[n]=i},this._showRow=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0;for(s=a;s<=o;s++)void 0!==n.hideRowMap[s]?(void 0===n.filterHideRowMap[s]&&(e.heights[s]=n.hideRowMap[s].height,e.setHeights[s]=n.hideRowMap[s].setHeight),delete n.hideRowMap[s]):console.warn(s," \u884c\u5df2\u7ecf\u5c55\u793a")},this._hideRow=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0;for(s=a;s<=o;s++)void 0===n.hideRowMap[s]?(n.filterHideRowMap[s]?n.hideRowMap[s]={height:n.filterHideRowMap[s].height,setHeight:n.filterHideRowMap[s].setHeight}:n.hideRowMap[s]={height:e.heights[s],setHeight:e.setHeights[s]},e.heights[s]=e.setHeights[s]=0):console.warn(s," \u884c\u5df2\u7ecf\u9690\u85cf\u4e86")},this._removeRow=function(t){var i=t.range,n=i[0],a=i[1]-n+1;e.heights.splice(n,a),e.setHeights.splice(n,a),e.stage.tableData.hideRowMap=(0,o.mapDelete)(e.stage.tableData.hideRowMap,n,a),e.stage.tableData.filterHideRowMap=(0,o.mapDelete)(e.stage.tableData.filterHideRowMap,n,a)},this._addRow=function(t){var i=t.index,n=t.amount,a=void 0;for(a=0;a<n;a++)e.heights.splice(i,0,e.stage.configData.rowHeight),e.setHeights.splice(i,0,void 0);e.stage.tableData.hideRowMap=(0,o.mapInsert)(e.stage.tableData.hideRowMap,i,n),e.stage.tableData.filterHideRowMap=(0,o.mapInsert)(e.stage.tableData.filterHideRowMap,i,n)},this._hideFilterRow=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0;for(s=a;s<=o;s++)void 0===n.filterHideRowMap[s]?(n.hideRowMap[s]?n.filterHideRowMap[s]={height:n.hideRowMap[s].height,setHeight:n.hideRowMap[s].setHeight}:n.filterHideRowMap[s]={height:e.heights[s],setHeight:e.setHeights[s]},e.heights[s]=e.setHeights[s]=0):console.warn(s," \u884c\u5df2\u7ecf\u88ab\u7b5b\u9009\u9690\u85cf\u4e86")},this._showFilterRow=function(t){var i=t.range,n=e.stage.tableData,a=i[0],o=i[1],s=void 0;for(s=a;s<=o;s++)void 0!==n.filterHideRowMap[s]?(void 0===n.hideRowMap[s]&&(e.heights[s]=n.filterHideRowMap[s].height,e.setHeights[s]=n.filterHideRowMap[s].setHeight),delete n.filterHideRowMap[s]):console.warn(s," \u884c\u6ca1\u6709\u88ab\u7b5b\u9009")},this.getHeight=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.ignoreScale,a=void 0!==n&&n,o=i.ignoreHide,s=void 0===o||o,r=void 0;return null!==(r=t>=e.heights.length?0:s?e.heights[t]:e.stage.tableData.hideRowMap[t]?e.stage.tableData.hideRowMap[t].height:e.stage.tableData.filterHideRowMap[t]?e.stage.tableData.filterHideRowMap[t].height:e.heights[t])&&void 0!==r||(r=e.stage.configData.rowHeight),Math.ceil(r*(a?1:e.stage.tableData.scale))},this.getRangeHeight=function(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,a=0;for(n=t[0];n<=t[1];n++)a+=e.getHeight(n,i);return a},this.getSetHeight=function(t){var i=e.setHeights[t];return(i=parseInt(i)||0)<22?null:i}};t.default=l},1278:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=i(10),s=l(i(1279)),r=l(i(1282));function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.col=new s.default(t),this.row=new r.default(t),this.areaX=o.TABLE_AREA.FLOW,this.areaY=o.TABLE_AREA.FLOW}return(0,a.default)(e,[{key:"init",value:function(e){this.col.update(e),this.row.update(e)}},{key:"switchArea",value:function(e){var t=e.x-this.stage.configData.rowHeadWidth,i=e.y-this.stage.configData.colHeadHeight;t>0&&t<this.col.frozen.viewWidth?this.areaX=o.TABLE_AREA.FROZEN:this.areaX=o.TABLE_AREA.FLOW,i>0&&i<this.row.frozen.viewHeight?this.areaY=o.TABLE_AREA.FROZEN:this.areaY=o.TABLE_AREA.FLOW}},{key:"makeVisiable",value:function(e){var t=e.row,i=e.col;isNaN(t)||(t<this.row.frozen.length?this.areaY=o.TABLE_AREA.FROZEN:this.areaY=o.TABLE_AREA.FLOW),isNaN(i)||(i<this.col.frozen.length?this.areaX=o.TABLE_AREA.FROZEN:this.areaX=o.TABLE_AREA.FLOW)}},{key:"calcIndex",value:function(){this.row.calcFlow(),this.row.calcFrozen(),this.col.calcFlow(),this.col.calcFrozen()}},{key:"globalToViewport",value:function(e,t){var i=0,n=0;return e>this.col.frozen.totalWidth?e-=this.col.flow.shadowX:e>this.col.frozen.viewWidth+this.col.frozen.offsetX&&(i=e-this.col.frozen.viewWidth-this.col.frozen.offsetX),t>this.row.frozen.totalHeight?t-=this.row.flow.shadowY:t>this.row.frozen.viewHeight+this.row.frozen.offsetY&&(n=t-this.row.frozen.viewHeight-this.row.frozen.offsetY),{left:e,top:t,diffX:i,diffY:n}}},{key:"viewportToGlobal",value:function(e,t){return e>this.col.frozen.maxDistance||0===this.col.frozen.length?(e+=this.col.flow.shadowX,e+=this.col.flow.offsetX):e+=this.col.frozen.offsetX,t>this.row.frozen.maxDistance||0===this.row.frozen.length?(t+=this.row.flow.shadowY,t+=this.row.flow.offsetY):t+=this.row.frozen.offsetY,{left:e,top:t}}}]),e}();t.default=h},1279:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(0)),a=h(i(1)),o=h(i(1280)),s=h(i(1281)),r=i(10),l=i(21);function h(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){(0,n.default)(this,e),c.call(this),this.stage=t.stage,this.globalLeft=[],this.frozen=new o.default(t),this.flow=new s.default(t),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){this.stage.event.eventTable.listen("scale",this._scale),this.stage.event.eventDimension.listen("updateFrozenCol",this._updateFrozenCol),this.stage.event.eventDimension.listen("setColWidth",this._setColWidth),this.stage.event.eventDimension.listen("showCol",this._showCol),this.stage.event.eventDimension.listen("hideCol",this._hideCol),this.stage.event.eventDimension.listen("addCol",this._addCol),this.stage.event.eventDimension.listen("removeCol",this._removeCol)}},{key:"getArea",value:function(e){return e<this.flow.start?this[r.TABLE_AREA.FROZEN]:this[r.TABLE_AREA.FLOW]}},{key:"getAreaName",value:function(e){return e<this.flow.start?r.TABLE_AREA.FROZEN:r.TABLE_AREA.FLOW}},{key:"update",value:function(){this.frozen.length=this.stage.tableData.frozen.col||0,0===this.stage.tableData.frozen.col&&(this.frozen.offsetX=0),this.updateTotalWidth(),this.updateGlobalLeft(),this.frozen.updateMaxOffsetX(),this.flow.updateMaxOffsetX()}},{key:"updateTotalWidth",value:function(){var e=this.stage.tableData,t=void 0,i=void 0;for(this.frozen.totalWidth=0,this.flow.totalWidth=0,i=0;i<e.col.length;i++)t=e.col.getWidth(i),i<this.frozen.length?this.frozen.totalWidth+=t:this.flow.totalWidth+=t}},{key:"updateGlobalLeft",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.stage.tableData,i=void 0,n=void 0,a=t.col.length;for(e<0&&(console.error("invalid start in updateGlobalLeft"),e=Math.max(0,e)),0===e?this.globalLeft[0]=n=this.stage.configData.rowHeadWidth:(e--,n=this.globalLeft[e]),i=e+1;i<a;i++)i===this.frozen.length?n=this.frozen.maxDistance+this.stage.configData.frozenWidth:n+=t.col.getWidth(i-1),this.globalLeft[i]=n}},{key:"isInAutoMove",value:function(e){var t=e.autoMoveThreshold||8;if(void 0===e.x||null===e.x)return 0;if(e.x<this.frozen.maxDistance&&this.frozen.length>0){if(e.x<this.frozen.viewStart+t)return 1;if(e.x>this.frozen.maxDistance-t)return 2;if(this.stage.selectData.select.xRange[1]>this.frozen.to)return 3}else{if(e.x<this.flow.viewStart+t)return 3;if(e.x>this.flow.maxDistance-t)return 4}return 0}},{key:"getViewportLeft",value:function(e){void 0===e&&console.error("index undefined");var t=this.stage.tableData,i=!1;e>=t.col.length&&(e=t.col.length-1,i=!0);var n=this.globalLeft[e],a=this.getArea(e),o=n-(a.visualOffsetX||a.offsetX)>>0;return i&&(o+=t.col.getWidth(e,{ignoreScale:!1})),o}},{key:"getIndex",value:function(e){var t=void 0,i=void 0,n=void 0,a=void 0;if(e<this.stage.configData.rowHeadWidth){for(this.frozen.length>0?(i=this.frozen.from,e+=this.frozen.offsetX):(i=this.flow.from,e+=this.flow.visualOffsetX||this.flow.offsetX),t=this.globalLeft[i]||0;i>0;i--){if(a=this.globalLeft[i-1]||0,t>=e&&a<=e)return i-1;t=a}return 0}if(this.frozen.length>0&&e<this.flow.viewStart?(i=this.frozen.from,n=this.frozen.to,e+=this.frozen.offsetX):(i=this.flow.from,n=this.flow.to,e+=this.flow.visualOffsetX||this.flow.offsetX),t=this.getGlobalLeft(i),i>n)return-1;if(e<=t)return i;for(;i<=n;i++){if(a=this.globalLeft[i+1]||1e4,e>=t&&e<=a)return i;t=a}return i-1}},{key:"getRealGlobalLeft",value:function(e){if(void 0!==e){var t=this.globalLeft[e];return t+=this.getArea(e).shadowX}console.error("index undefined in getRealGlobalLeft")}},{key:"getGlobalLeft",value:function(e){if(void 0!==e)return e>=this.globalLeft.length?this.getArea(e).totalWidth:this.globalLeft[e];console.error("index undefined in getGlobalLeft")}},{key:"calcFrozen",value:function(){if(0!==this.frozen.length){for(var e=this.stage.tableData,t=0,i=this.frozen.length,n=void 0,a=this.getViewportLeft(t),o=this.frozen.maxDistance,s=!1,r=this.frozen.viewStart;t<i&&(n=e.col.getWidth(t),!(a>o));t++)r>=(a+=n)||s||(this.frozen.from=t,s=!0);this.frozen.to=t-1}}},{key:"calcFlow",value:function(){for(var e=this.stage.tableData,t=this.flow.start,i=e.col.length,n=void 0,a=this.getViewportLeft(t),o=this.flow.maxDistance,s=!1,r=this.flow.viewStart;t<i&&(n=e.col.getWidth(t),!(a>o));t++)r>=(a+=n)-1||s||(this.flow.from=t,s=!0);this.flow.to=t-1}}]),e}(),c=function(){var e=this;this._scale=function(){e.update()},this._updateFrozenCol=function(){e.update()},this._setColWidth=function(t){var i=t.newWidth>>0,n=t.oldWidth>>0,a=t.index>>0,o=void 0,s=e.getArea(a),r=e.stage.tableData;o=(0,l.isColShow)(r,a)?Math.floor(i*r.scale)-Math.floor(n*r.scale):0,s.totalWidth+=o,e.updateGlobalLeft(a+1),e.frozen.updateMaxOffsetX(),e.flow.updateMaxOffsetX()},this._showCol=function(t){var i=t.range,n=void 0,a=void 0,o=e.stage.tableData,s=i[0],r=i[1],l=void 0;for(l=s;l<=r;l++)a=e.getArea(l),n=o.col.getWidth(l),a.totalWidth+=n;e.updateGlobalLeft(s+1),e.frozen.updateMaxOffsetX(),e.flow.updateMaxOffsetX()},this._hideCol=function(t){var i=t.range,n=void 0,a=void 0,o=e.stage.tableData,s=i[0],r=i[1],l=void 0;for(l=s;l<=r;l++)a=e.getArea(l),n=o.col.getWidth(l,{ignoreHide:!1}),a.totalWidth-=n;e.updateGlobalLeft(s+1),e.frozen.updateMaxOffsetX(),e.flow.updateMaxOffsetX()},this._removeCol=function(t){var i=t.range,n=i[0],a=i[1],o=a-n+1;if(e.globalLeft.splice(n,o),n<e.frozen.length){var s=Math.min(e.frozen.length-1,a)-n+1;e.frozen.length=Math.max(0,n-1,e.frozen.length-s),e.stage.tableData.frozen.col=e.frozen.length,e.stage.event.eventDimension.trigger("updateFrozenCol",e.stage.tableData.frozen.col)}e.updateTotalWidth(),e.updateGlobalLeft(n),e.frozen.updateMaxOffsetX(),e.flow.updateMaxOffsetX()},this._addCol=function(t){var i=t.index,n=t.amount;i<e.frozen.length&&(e.frozen.length+=n,e.stage.tableData.frozen.col=e.frozen.length,e.stage.event.eventDimension.trigger("updateFrozenCol",e.stage.tableData.frozen.col)),e.updateTotalWidth(),e.updateGlobalLeft(i),e.frozen.updateMaxOffsetX(),e.flow.updateMaxOffsetX()}};t.default=g},1280:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(10),s=i(166);r(s);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.length=0,this.totalWidth=0,this.from=0,this.to=0,this.maxOffsetX=0,this._offsetX=0,this.defaultOffsetX=0,this.scroll=null,this.needOffsetX=0}return(0,a.default)(e,[{key:"updateMaxOffsetX",value:function(){this.maxOffsetX=this.totalWidth-this.maxDistance+this.viewStart,this.maxOffsetX<0&&(this.maxOffsetX=0),this.offsetX>this.maxOffsetX&&(this.offsetX=this.maxOffsetX),this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update()}},{key:"start",get:function(){return 0},set:function(e){console.error("can't set start")}},{key:"viewStart",get:function(){return this.stage.configData.rowHeadWidth-1},set:function(e){console.error("can't set viewStart")}},{key:"viewWidth",get:function(){return this.maxDistance-this.viewStart},set:function(e){console.error("can't set viewWidth")}},{key:"maxDistance",get:function(){return this.viewStart+this.totalWidth},set:function(e){console.error("can't set maxDistance")}},{key:"offsetX",get:function(){return this._offsetX},set:function(e){if(this._offsetX!==e){var t=e-this._offsetX;this._offsetX=e,this.scroll&&this.scroll.update(),this.stage.event.eventTable.trigger("tableMove",{areaX:o.TABLE_AREA.FROZEN,diffX:t})}}},{key:"shadowX",get:function(){return 0},set:function(e){console.error("can't set shadowX")}}]),e}();t.default=l},1281:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=(s(i(166)),i(403),i(10));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.totalWidth=0,this.from=0,this.to=0,this.maxOffsetX=0,this._offsetX=0,this.defaultOffsetX=0,this.scroll=null,this._needOffsetX=0,this.correctMaxOffsetX=0}return(0,a.default)(e,[{key:"updateMaxOffsetX",value:function(){var e=this.totalWidth;this.maxOffsetX=e+this.stage.areaData.col.flow.viewStart+o.ADD_COL_WIDTH-this.stage.width,this.maxOffsetX<0&&(this.maxOffsetX=0),this.offsetX>this.maxOffsetX&&(this.correctMaxOffsetX=this.offsetX-this.maxOffsetX,this.offsetX=this.maxOffsetX),this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update()}},{key:"length",get:function(){return this.stage.tableData.col.length-this.stage.areaData.col.frozen.length},set:function(e){console.error("can't set length in areaDataRowFlow")}},{key:"start",get:function(){return this.stage.areaData.col.frozen.length},set:function(e){console.error("can't set start")}},{key:"viewStart",get:function(){if(this.stage.areaData.col.frozen.length>0){this.stage.areaData;return this.stage.areaData.col.frozen.maxDistance+this.stage.configData.frozenWidth}return this.stage.areaData.col.frozen.maxDistance},set:function(e){console.error("can't set viewStart")}},{key:"viewWidth",get:function(){this.stage.areaData;return this.maxDistance-this.viewStart},set:function(e){console.error("can't set viewWidth")}},{key:"maxDistance",get:function(){return this.stage.width},set:function(e){console.error("can't set maxDistance")}},{key:"needOffsetX",get:function(){return this._needOffsetX},set:function(e){this._needOffsetX=e}},{key:"offsetX",get:function(){return this._offsetX},set:function(e){if(this._offsetX!==e){var t=e-this._offsetX;this._offsetX=e,this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update(),this.stage.event.eventTable.trigger("tableMove",{areaX:o.TABLE_AREA.FLOW,diffX:t})}}},{key:"visualOffsetX",get:function(){return this._offsetX}},{key:"shadowX",get:function(){return this.stage.areaData.col.frozen.totalWidth-this.stage.areaData.col.frozen.viewWidth},set:function(e){console.error("can't set shadowX")}}]),e}();t.default=r},1282:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(0)),a=h(i(1)),o=h(i(1283)),s=h(i(1284)),r=i(21),l=i(10);function h(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){(0,n.default)(this,e),c.call(this),this.stage=t.stage,this.globalTop=[],this.frozen=new o.default(t),this.flow=new s.default(t),this.initEvent()}return(0,a.default)(e,[{key:"initEvent",value:function(){this.stage.event.eventTable.listen("scale",this._scale),this.stage.event.eventDimension.listen("updateFrozenRow",this._updateFrozenRow),this.stage.event.eventDimension.listen("setRowHeight",this._setRowHeight),this.stage.event.eventDimension.listen("showRow",this._showRow),this.stage.event.eventDimension.listen("hideRow",this._hideRow),this.stage.event.eventDimension.listen("addRow",this._addRow),this.stage.event.eventDimension.listen("removeRow",this._removeRow),this.stage.event.eventFilter.listen("hideFilterRow",this._hideRow),this.stage.event.eventFilter.listen("showFilterRow",this._showRow)}},{key:"getArea",value:function(e){return e<this.flow.start?this[l.TABLE_AREA.FROZEN]:this[l.TABLE_AREA.FLOW]}},{key:"getAreaName",value:function(e){return e<this.flow.start?l.TABLE_AREA.FROZEN:l.TABLE_AREA.FLOW}},{key:"update",value:function(){this.frozen.length=this.stage.tableData.frozen.row||0,0===this.stage.tableData.frozen.row&&(this.frozen.offsetX=0),this.updateTotalHeight(),this.updateGlobalTop(),this.frozen.updateMaxOffsetY(),this.flow.updateMaxOffsetY()}},{key:"updateTotalHeight",value:function(){var e=this.stage.tableData,t=void 0,i=void 0;for(this.frozen.totalHeight=0,this.flow.totalHeight=0,i=0;i<e.row.length;i++)t=e.row.getHeight(i),i<this.frozen.length?this.frozen.totalHeight+=t:this.flow.totalHeight+=t}},{key:"updateGlobalTop",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=this.stage.tableData,i=void 0,n=0,a=t.row.length;for(e<0&&(console.error("invalid start in updateGlobalTop"),e=Math.max(0,e)),0===e?this.globalTop[0]=n=this.stage.configData.colHeadHeight:(e--,n=this.globalTop[e]),i=e+1;i<a;i++)i===this.frozen.length?n=this.frozen.maxDistance+this.stage.configData.frozenWidth:n+=t.row.getHeight(i-1),this.globalTop[i]=n}},{key:"isInAutoMove",value:function(e){var t=e.autoMoveThreshold||8;if(void 0===e.y||null===e.y)return 0;if(e.y<this.frozen.maxDistance&&this.frozen.length>0){if(e.y<this.frozen.viewStart+t)return 1;if(e.y>this.frozen.maxDistance-t)return 2;if(this.stage.selectData.select.yRange[1]>this.frozen.to)return 3}else{if(e.y<this.flow.viewStart+t)return 3;if(e.y>this.flow.maxAutoMove-t)return 4}return 0}},{key:"getViewportTop",value:function(e){void 0===e&&console.error("index undefined");var t=this.stage.tableData,i=!1;e>=t.row.length&&(e=t.row.length-1,i=!0);var n=this.globalTop[e],a=this.getArea(e),o=n-(a.visualOffsetY||a.offsetY)>>0;return i&&(o+=t.row.getHeight(e,{ignoreScale:!1})),o}},{key:"getIndex",value:function(e){var t=void 0,i=void 0,n=void 0,a=void 0;if(e<this.stage.configData.colHeadHeight){for(this.frozen.length>0?(i=this.frozen.from,e+=this.frozen.offsetX):(i=this.flow.from,e+=this.flow.visualOffsetY||this.flow.offsetY),t=this.globalTop[i]||0;i>0;i--){if(a=this.globalTop[i-1]||0,t>=e&&a<=e)return i-1;t=a}return 0}if(this.frozen.length>0&&e<this.flow.viewStart?(i=this.frozen.from,n=this.frozen.to,e+=this.frozen.offsetY):(i=this.flow.from,n=this.flow.to,e+=this.flow.visualOffsetY||this.flow.offsetY),t=this.getGlobalTop(i),i>n)return-1;if(e<=t)return i;for(;i<=n;i++){if(a=this.globalTop[i+1]||1e4,e>=t&&e<=a)return i;t=a}return i-1}},{key:"getRealGlobalTop",value:function(e){if(void 0!==e){var t=this.globalTop[e];return t+=this.getArea(e).shadowY}console.error("index undefined in getRealGlobalTop")}},{key:"getGlobalTop",value:function(e){if(void 0!==e)return e>=this.globalTop.length?this.getArea(e).totalHeight:this.globalTop[e];console.error("index undefined in getGlobalTop")}},{key:"calcFrozen",value:function(){if(0!==this.frozen.length){for(var e=this.stage.tableData,t=0,i=this.frozen.length,n=void 0,a=this.getViewportTop(t),o=this.frozen.maxDistance,s=!1,r=this.frozen.viewStart;t<i&&(n=e.row.getHeight(t),!(a>o));t++)r>=(a+=n)||s||(this.frozen.from=t,s=!0);this.frozen.to=t-1}}},{key:"calcFlow",value:function(){for(var e=this.stage.tableData,t=this.flow.start,i=e.row.length,n=void 0,a=this.getViewportTop(t),o=this.flow.maxDistance,s=!1,r=this.flow.viewStart;t<i&&(n=e.row.getHeight(t),!(a>o));t++)r>=(a+=n)-1||s||(this.flow.from=t,s=!0);this.flow.to=t-1}},{key:"calcRownum",value:function(e,t){for(var i=this.stage.tableData,n=0,a=t,o=i.row.length;a<o&&e>0;a++)n+=1,e-=i.row.getHeight(a);return{start:t,end:t+n}}}]),e}(),c=function(){var e=this;this._scale=function(){e.update()},this._updateFrozenRow=function(){e.update()},this._setRowHeight=function(t){var i=e.stage.tableData,n=t.newHeight,a=t.oldHeight,o=t.index>>0;void 0!==n&&null!==n||(n=i.row.getHeight(o)),void 0!==a&&null!==a||(a=e.stage.configData.rowHeight);var s=void 0,l=e.getArea(o);s=(0,r.isRowShow)(i,o)?Math.floor(n*i.scale)-Math.floor(a*i.scale):0,l.totalHeight+=s,e.updateGlobalTop(o+1),e.frozen.updateMaxOffsetY(),e.flow.updateMaxOffsetY()},this._showRow=function(t){var i=t.range,n=void 0,a=void 0,o=e.stage.tableData,s=i[0],r=i[1],l=void 0;for(l=s;l<=r;l++)a=e.getArea(l),n=o.row.getHeight(l),a.totalHeight+=n;e.updateGlobalTop(s+1),e.frozen.updateMaxOffsetY(),e.flow.updateMaxOffsetY()},this._hideRow=function(t){var i=t.range,n=void 0,a=void 0,o=e.stage.tableData,s=i[0],r=i[1],l=void 0;for(l=s;l<=r;l++)a=e.getArea(l),n=o.row.getHeight(l,{ignoreHide:!1}),a.totalHeight-=n;e.updateGlobalTop(s+1),e.frozen.updateMaxOffsetY(),e.flow.updateMaxOffsetY()},this._removeRow=function(t){var i=t.range,n=i[0],a=i[1],o=a-n+1;if(e.globalTop.splice(n,o),n<e.frozen.length){var s=Math.min(e.frozen.length-1,a)-n+1;e.frozen.length=Math.max(0,n-1,e.frozen.length-s),e.stage.tableData.frozen.row=e.frozen.length,e.stage.event.eventDimension.trigger("updateFrozenRow",e.stage.tableData.frozen.row)}e.updateTotalHeight(),e.updateGlobalTop(n),e.frozen.updateMaxOffsetY(),e.flow.updateMaxOffsetY()},this._addRow=function(t){var i=t.index,n=t.amount;i<e.frozen.length&&(e.frozen.length+=n,e.stage.tableData.frozen.row=e.frozen.length,e.stage.event.eventDimension.trigger("updateFrozenRow",e.stage.tableData.frozen.row)),e.updateTotalHeight(),e.updateGlobalTop(i),e.frozen.updateMaxOffsetY(),e.flow.updateMaxOffsetY()}};t.default=g},1283:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(10),s=i(166);r(s);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.length=0,this.totalHeight=0,this.from=0,this.to=0,this.maxOffsetY=0,this._offsetY=0,this.defaultOffsetY=0,this.shadowY=0,this.scroll=null,this.needOffsetY=0}return(0,a.default)(e,[{key:"updateMaxOffsetY",value:function(){this.maxOffsetY=this.totalHeight-this.maxDistance+this.viewStart,this.maxOffsetY<0&&(this.maxOffsetY=0),this.offsetY>this.maxOffsetY&&(this.offsetY=this.maxOffsetY),this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update()}},{key:"start",get:function(){return 0},set:function(e){console.error("can't set start")}},{key:"viewStart",get:function(){return this.stage.configData.colHeadHeight-1},set:function(e){console.error("can't set viewStart")}},{key:"viewHeight",get:function(){return this.maxDistance-this.viewStart},set:function(e){console.error("can't set viewWidth")}},{key:"maxDistance",get:function(){return this.viewStart+this.totalHeight},set:function(e){console.error("can't set maxDistance")}},{key:"offsetY",get:function(){return this._offsetY},set:function(e){if(this._offsetY!==e){var t=e-this._offsetY;this._offsetY=e,this.scroll&&this.scroll.update(),this.stage.event.eventTable.trigger("tableMove",{areaY:o.TABLE_AREA.FROZEN,diffY:t})}}}]),e}();t.default=l},1284:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=i(10);s(i(166)),i(403);function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.totalHeight=0,this.from=0,this.to=0,this.maxOffsetY=0,this._offsetY=0,this.defaultOffsetY=0,this.scroll=null,this.maxAutoMove=0,this._needOffsetY=0,this.correctMaxOffsetY=0}return(0,a.default)(e,[{key:"updateMaxOffsetY",value:function(){this.maxOffsetY=this.totalHeight+this.stage.areaData.row.flow.viewStart+o.ADD_ROW_HEIGHT-this.stage.height,this.maxOffsetY<0&&(this.maxOffsetY=0),this.offsetY>this.maxOffsetY&&(this.correctMaxOffsetY=this.offsetY-this.maxOffsetY,this.offsetY=this.maxOffsetY),this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update()}},{key:"length",get:function(){return this.stage.tableData.row.length-this.stage.areaData.row.frozen.length},set:function(e){console.error("can't set length in areaDataRowFlow")}},{key:"start",get:function(){return this.stage.areaData.row.frozen.length},set:function(e){console.error("can't set start")}},{key:"viewStart",get:function(){if(this.stage.areaData.row.frozen.length>0){this.stage.areaData;return this.stage.areaData.row.frozen.maxDistance+this.stage.configData.frozenWidth}return this.stage.areaData.row.frozen.maxDistance},set:function(e){console.error("can't set viewStart")}},{key:"viewHeight",get:function(){this.stage.areaData;return this.maxDistance-this.viewStart},set:function(e){console.error("can't set viewWidth")}},{key:"maxDistance",get:function(){return this.stage.height},set:function(e){console.error("can't set maxDistance")}},{key:"needOffsetY",get:function(){return this._needOffsetY},set:function(e){this._needOffsetY=e,e=0,this.maxAutoMove=this.maxDistance-e}},{key:"offsetY",get:function(){return this._offsetY},set:function(e){if(this._offsetY!==e){var t=e-this._offsetY;this._offsetY=e,this.scroll&&this.scroll.calc(),this.scroll&&this.scroll.update(),this.stage.event.eventTable.trigger("tableMove",{areaY:o.TABLE_AREA.FLOW,diffY:t})}}},{key:"visualOffsetY",get:function(){return this._offsetY}},{key:"shadowY",get:function(){return this.stage.areaData.row.frozen.totalHeight-this.stage.areaData.row.frozen.viewHeight},set:function(e){console.error("can't set shadowY")}}]),e}();t.default=r},1285:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(0)),a=l(i(1)),o=i(10),s=i(33),r=i(249);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.defaultDevicePixelRatio=window.devicePixelRatio,this.tableHeaderColor={0:"#FAFAFA",100:"#E1E1E1",200:"#C2C2C2",1:"#DBEBF9",101:"#A1D1F9",201:"#6EBAFB"};var i=void 0,a=void 0;i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0BAMAAAA3VgbYAAAAFVBMVEUAAAA1OkE1OkE1OkE1OkE1OkE1OkHXsFQXAAAABnRSTlMAIOzFjk0JxwpWAAAAi0lEQVR4Xu3PMQ6DMBBE0Y0CfcIJQuOaihoa11QcwMDc/wiAhEawIxqUKA2/9Fi2nv28uwBX4gTp6nT+1396YtfnfGoO0yOADXasByvdlAHte6kAOnPVmGwpYhRAgfQyy4FKpvVwuyBFjHxW1V1GlKeVPVGeNgSihEaU0ogSGlFKI0qLRCmtsa92NwNixkyyKXp1RQAAAABJRU5ErkJggg==",(a=new Image).src=i,this.filterReadyBlack=a,i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0BAMAAAA3VgbYAAAAElBMVEUAAAA1OkE1OkE1OkE1OkE1OkE5TdtrAAAABXRSTlMAmFMby3Hlj7EAAAB+SURBVHhe7dAhDgIxGAXh4YcD1OBr6jH4NXuAAr3/VRBr5g+pIRiSjn3my+NHra4j1TVd8rRpOufphmpeHrjwVGcQIwwxwhAjMqQAnA6EIw5YE0KQCiGEIU+4C2HIC3YhMsQIF3riE2IEGWIEGWJEbgz+eOrzqTCrM63wRas31CE0XJg4DZQAAAAASUVORK5CYII=",(a=new Image).src=i,this.filterDoneBlack=a,i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0BAMAAAA3VgbYAAAAFVBMVEUAAAD///////////////////////9Iz20EAAAABnRSTlMAIOzFjk0JxwpWAAAAi0lEQVR4Xu3PMQ6DMBBE0Y0CfcIJQuOaihoa11QcwMDc/wiAhEawIxqUKA2/9Fi2nv28uwBX4gTp6nT+1396YtfnfGoO0yOADXasByvdlAHte6kAOnPVmGwpYhRAgfQyy4FKpvVwuyBFjHxW1V1GlKeVPVGeNgSihEaU0ogSGlFKI0qLRCmtsa92NwNixkyyKXp1RQAAAABJRU5ErkJggg==",(a=new Image).src=i,this.filterReadyWhite=a,i="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAA0BAMAAAA3VgbYAAAAGFBMVEUAAAD///////////////////////////8jfp1fAAAAB3RSTlMAcaAby+s8bTpUNQAAAIRJREFUeF7t0asOwlAQBuHhEvRxWBy2ph7HAyCwuOpDCvv6SGZD1hAMScf+5ssuP2rpGKm7pm2eTpo2Vy+PATV5euJWnloFMcIQIwwxIkMOAOs3QpAOsBdCkBvshDDkAqMQhsxwFiJDhPi8SCtfY0SGGJEhEQNFEfzx1OupUdUpa3zR0gvRkkhmWmddVAAAAABJRU5ErkJggg==",(a=new Image).src=i,this.filterDoneWhite=a,this.hideTriangle=[7,4,5];this.hideLeftIcon=new Image,this.hideLeftIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAOCAYAAAFlUW0AAAAKQ2lDQ1BJQ0MgcHJvZmlsZQAAeNqdU3dYk/cWPt/3ZQ9WQtjwsZdsgQAiI6wIyBBZohCSAGGEEBJAxYWIClYUFRGcSFXEgtUKSJ2I4qAouGdBiohai1VcOO4f3Ke1fXrv7e371/u855zn/M55zw+AERImkeaiagA5UoU8Otgfj09IxMm9gAIVSOAEIBDmy8JnBcUAAPADeXh+dLA//AGvbwACAHDVLiQSx+H/g7pQJlcAIJEA4CIS5wsBkFIAyC5UyBQAyBgAsFOzZAoAlAAAbHl8QiIAqg0A7PRJPgUA2KmT3BcA2KIcqQgAjQEAmShHJAJAuwBgVYFSLALAwgCgrEAiLgTArgGAWbYyRwKAvQUAdo5YkA9AYACAmUIszAAgOAIAQx4TzQMgTAOgMNK/4KlfcIW4SAEAwMuVzZdL0jMUuJXQGnfy8ODiIeLCbLFCYRcpEGYJ5CKcl5sjE0jnA0zODAAAGvnRwf44P5Dn5uTh5mbnbO/0xaL+a/BvIj4h8d/+vIwCBAAQTs/v2l/l5dYDcMcBsHW/a6lbANpWAGjf+V0z2wmgWgrQevmLeTj8QB6eoVDIPB0cCgsL7SViob0w44s+/zPhb+CLfvb8QB7+23rwAHGaQJmtwKOD/XFhbnauUo7nywRCMW735yP+x4V//Y4p0eI0sVwsFYrxWIm4UCJNx3m5UpFEIcmV4hLpfzLxH5b9CZN3DQCshk/ATrYHtctswH7uAQKLDljSdgBAfvMtjBoLkQAQZzQyefcAAJO/+Y9AKwEAzZek4wAAvOgYXKiUF0zGCAAARKCBKrBBBwzBFKzADpzBHbzAFwJhBkRADCTAPBBCBuSAHAqhGJZBGVTAOtgEtbADGqARmuEQtMExOA3n4BJcgetwFwZgGJ7CGLyGCQRByAgTYSE6iBFijtgizggXmY4EImFINJKApCDpiBRRIsXIcqQCqUJqkV1II/ItchQ5jVxA+pDbyCAyivyKvEcxlIGyUQPUAnVAuagfGorGoHPRdDQPXYCWomvRGrQePYC2oqfRS+h1dAB9io5jgNExDmaM2WFcjIdFYIlYGibHFmPlWDVWjzVjHVg3dhUbwJ5h7wgkAouAE+wIXoQQwmyCkJBHWExYQ6gl7CO0EroIVwmDhDHCJyKTqE+0JXoS+cR4YjqxkFhGrCbuIR4hniVeJw4TX5NIJA7JkuROCiElkDJJC0lrSNtILaRTpD7SEGmcTCbrkG3J3uQIsoCsIJeRt5APkE+S+8nD5LcUOsWI4kwJoiRSpJQSSjVlP+UEpZ8yQpmgqlHNqZ7UCKqIOp9aSW2gdlAvU4epEzR1miXNmxZDy6Qto9XQmmlnafdoL+l0ugndgx5Fl9CX0mvoB+nn6YP0dwwNhg2Dx0hiKBlrGXsZpxi3GS+ZTKYF05eZyFQw1zIbmWeYD5hvVVgq9ip8FZHKEpU6lVaVfpXnqlRVc1U/1XmqC1SrVQ+rXlZ9pkZVs1DjqQnUFqvVqR1Vu6k2rs5Sd1KPUM9RX6O+X/2C+mMNsoaFRqCGSKNUY7fGGY0hFsYyZfFYQtZyVgPrLGuYTWJbsvnsTHYF+xt2L3tMU0NzqmasZpFmneZxzQEOxrHg8DnZnErOIc4NznstAy0/LbHWaq1mrX6tN9p62r7aYu1y7Rbt69rvdXCdQJ0snfU6bTr3dQm6NrpRuoW623XP6j7TY+t56Qn1yvUO6d3RR/Vt9KP1F+rv1u/RHzcwNAg2kBlsMThj8MyQY+hrmGm40fCE4agRy2i6kcRoo9FJoye4Ju6HZ+M1eBc+ZqxvHGKsNN5l3Gs8YWJpMtukxKTF5L4pzZRrmma60bTTdMzMyCzcrNisyeyOOdWca55hvtm82/yNhaVFnMVKizaLx5balnzLBZZNlvesmFY+VnlW9VbXrEnWXOss623WV2xQG1ebDJs6m8u2qK2brcR2m23fFOIUjynSKfVTbtox7PzsCuya7AbtOfZh9iX2bfbPHcwcEh3WO3Q7fHJ0dcx2bHC866ThNMOpxKnD6VdnG2ehc53zNRemS5DLEpd2lxdTbaeKp26fesuV5RruutK10/Wjm7ub3K3ZbdTdzD3Ffav7TS6bG8ldwz3vQfTw91jicczjnaebp8LzkOcvXnZeWV77vR5Ps5wmntYwbcjbxFvgvct7YDo+PWX6zukDPsY+Ap96n4e+pr4i3z2+I37Wfpl+B/ye+zv6y/2P+L/hefIW8U4FYAHBAeUBvYEagbMDawMfBJkEpQc1BY0FuwYvDD4VQgwJDVkfcpNvwBfyG/ljM9xnLJrRFcoInRVaG/owzCZMHtYRjobPCN8Qfm+m+UzpzLYIiOBHbIi4H2kZmRf5fRQpKjKqLupRtFN0cXT3LNas5Fn7Z72O8Y+pjLk722q2cnZnrGpsUmxj7Ju4gLiquIF4h/hF8ZcSdBMkCe2J5MTYxD2J43MC52yaM5zkmlSWdGOu5dyiuRfm6c7Lnnc8WTVZkHw4hZgSl7I/5YMgQlAvGE/lp25NHRPyhJuFT0W+oo2iUbG3uEo8kuadVpX2ON07fUP6aIZPRnXGMwlPUit5kRmSuSPzTVZE1t6sz9lx2S05lJyUnKNSDWmWtCvXMLcot09mKyuTDeR55m3KG5OHyvfkI/lz89sVbIVM0aO0Uq5QDhZML6greFsYW3i4SL1IWtQz32b+6vkjC4IWfL2QsFC4sLPYuHhZ8eAiv0W7FiOLUxd3LjFdUrpkeGnw0n3LaMuylv1Q4lhSVfJqedzyjlKD0qWlQyuCVzSVqZTJy26u9Fq5YxVhlWRV72qX1VtWfyoXlV+scKyorviwRrjm4ldOX9V89Xlt2treSrfK7etI66Trbqz3Wb+vSr1qQdXQhvANrRvxjeUbX21K3nShemr1js20zcrNAzVhNe1bzLas2/KhNqP2ep1/XctW/a2rt77ZJtrWv913e/MOgx0VO97vlOy8tSt4V2u9RX31btLugt2PGmIbur/mft24R3dPxZ6Pe6V7B/ZF7+tqdG9s3K+/v7IJbVI2jR5IOnDlm4Bv2pvtmne1cFoqDsJB5cEn36Z8e+NQ6KHOw9zDzd+Zf7f1COtIeSvSOr91rC2jbaA9ob3v6IyjnR1eHUe+t/9+7zHjY3XHNY9XnqCdKD3x+eSCk+OnZKeenU4/PdSZ3Hn3TPyZa11RXb1nQ8+ePxd07ky3X/fJ897nj13wvHD0Ivdi2yW3S609rj1HfnD94UivW2/rZffL7Vc8rnT0Tes70e/Tf/pqwNVz1/jXLl2feb3vxuwbt24m3Ry4Jbr1+Hb27Rd3Cu5M3F16j3iv/L7a/eoH+g/qf7T+sWXAbeD4YMBgz8NZD+8OCYee/pT/04fh0kfMR9UjRiONj50fHxsNGr3yZM6T4aeypxPPyn5W/3nrc6vn3/3i+0vPWPzY8Av5i8+/rnmp83Lvq6mvOscjxx+8znk98ab8rc7bfe+477rfx70fmSj8QP5Q89H6Y8en0E/3Pud8/vwv94Tz+4A5JREAAAAZdEVYdFNvZnR3YXJlAEFkb2JlIEltYWdlUmVhZHlxyWU8AAADJmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4gPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPiA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPiA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIiB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RTIyQTE0OTgzQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RTIyQTE0OTkzQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDpFMjJBMTQ5NjNCMEUxMUU4QkI4MEVCQzAxQzgyNjc5RCIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDpFMjJBMTQ5NzNCMEUxMUU4QkI4MEVCQzAxQzgyNjc5RCIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pu5GDPIAAAB7SURBVHjaYrC2dWVgYgACgABigLH+AwQQI4gFYkDEGRgYAQIIReQ/iAWTAjMYQQyAAIKpYYApYYEx0JUywgQAAghZC4qFDOjW/Ec2A6uhKAIMyILIhoIFAQIM3VoGdFtZcEnAAAsuCWQF/xnwAIywwKYA2dWM+BRgVQgAp+ATYMROi5sAAAAASUVORK5CYII=";this.hideRightIcon=new Image,this.hideRightIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAOCAYAAAASVl2WAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAACHDwAAjA8AAP1SAACBQAAAfXkAAOmLAAA85QAAGcxzPIV3AAAKL2lDQ1BJQ0MgcHJvZmlsZQAASMedlndUVNcWh8+9d3qhzTDSGXqTLjCA9C4gHQRRGGYGGMoAwwxNbIioQEQREQFFkKCAAaOhSKyIYiEoqGAPSBBQYjCKqKhkRtZKfHl57+Xl98e939pn73P32XuftS4AJE8fLi8FlgIgmSfgB3o401eFR9Cx/QAGeIABpgAwWempvkHuwUAkLzcXerrICfyL3gwBSPy+ZejpT6eD/0/SrFS+AADIX8TmbE46S8T5Ik7KFKSK7TMipsYkihlGiZkvSlDEcmKOW+Sln30W2VHM7GQeW8TinFPZyWwx94h4e4aQI2LER8QFGVxOpohvi1gzSZjMFfFbcWwyh5kOAIoktgs4rHgRm4iYxA8OdBHxcgBwpLgvOOYLFnCyBOJDuaSkZvO5cfECui5Lj25qbc2ge3IykzgCgaE/k5XI5LPpLinJqUxeNgCLZ/4sGXFt6aIiW5paW1oamhmZflGo/7r4NyXu7SK9CvjcM4jW94ftr/xS6gBgzIpqs+sPW8x+ADq2AiB3/w+b5iEAJEV9a7/xxXlo4nmJFwhSbYyNMzMzjbgclpG4oL/rfzr8DX3xPSPxdr+Xh+7KiWUKkwR0cd1YKUkpQj49PZXJ4tAN/zzE/zjwr/NYGsiJ5fA5PFFEqGjKuLw4Ubt5bK6Am8Kjc3n/qYn/MOxPWpxrkSj1nwA1yghI3aAC5Oc+gKIQARJ5UNz13/vmgw8F4psXpjqxOPefBf37rnCJ+JHOjfsc5xIYTGcJ+RmLa+JrCdCAACQBFcgDFaABdIEhMANWwBY4AjewAviBYBAO1gIWiAfJgA8yQS7YDApAEdgF9oJKUAPqQSNoASdABzgNLoDL4Dq4Ce6AB2AEjIPnYAa8AfMQBGEhMkSB5CFVSAsygMwgBmQPuUE+UCAUDkVDcRAPEkK50BaoCCqFKqFaqBH6FjoFXYCuQgPQPWgUmoJ+hd7DCEyCqbAyrA0bwwzYCfaGg+E1cBycBufA+fBOuAKug4/B7fAF+Dp8Bx6Bn8OzCECICA1RQwwRBuKC+CERSCzCRzYghUg5Uoe0IF1IL3ILGUGmkXcoDIqCoqMMUbYoT1QIioVKQ21AFaMqUUdR7age1C3UKGoG9QlNRiuhDdA2aC/0KnQcOhNdgC5HN6Db0JfQd9Dj6DcYDIaG0cFYYTwx4ZgEzDpMMeYAphVzHjOAGcPMYrFYeawB1g7rh2ViBdgC7H7sMew57CB2HPsWR8Sp4sxw7rgIHA+XhyvHNeHO4gZxE7h5vBReC2+D98Oz8dn4Enw9vgt/Az+OnydIE3QIdoRgQgJhM6GC0EK4RHhIeEUkEtWJ1sQAIpe4iVhBPE68QhwlviPJkPRJLqRIkpC0k3SEdJ50j/SKTCZrkx3JEWQBeSe5kXyR/Jj8VoIiYSThJcGW2ChRJdEuMSjxQhIvqSXpJLlWMkeyXPKk5A3JaSm8lLaUixRTaoNUldQpqWGpWWmKtKm0n3SydLF0k/RV6UkZrIy2jJsMWyZf5rDMRZkxCkLRoLhQWJQtlHrKJco4FUPVoXpRE6hF1G+o/dQZWRnZZbKhslmyVbJnZEdoCE2b5kVLopXQTtCGaO+XKC9xWsJZsmNJy5LBJXNyinKOchy5QrlWuTty7+Xp8m7yifK75TvkHymgFPQVAhQyFQ4qXFKYVqQq2iqyFAsVTyjeV4KV9JUCldYpHVbqU5pVVlH2UE5V3q98UXlahabiqJKgUqZyVmVKlaJqr8pVLVM9p/qMLkt3oifRK+g99Bk1JTVPNaFarVq/2ry6jnqIep56q/ojDYIGQyNWo0yjW2NGU1XTVzNXs1nzvhZei6EVr7VPq1drTltHO0x7m3aH9qSOnI6XTo5Os85DXbKug26abp3ubT2MHkMvUe+A3k19WN9CP16/Sv+GAWxgacA1OGAwsBS91Hopb2nd0mFDkqGTYYZhs+GoEc3IxyjPqMPohbGmcYTxbuNe408mFiZJJvUmD0xlTFeY5pl2mf5qpm/GMqsyu21ONnc332jeaf5ymcEyzrKDy+5aUCx8LbZZdFt8tLSy5Fu2WE5ZaVpFW1VbDTOoDH9GMeOKNdra2Xqj9WnrdzaWNgKbEza/2BraJto22U4u11nOWV6/fMxO3Y5pV2s3Yk+3j7Y/ZD/ioObAdKhzeOKo4ch2bHCccNJzSnA65vTC2cSZ79zmPOdi47Le5bwr4urhWuja7ybjFuJW6fbYXd09zr3ZfcbDwmOdx3lPtKe3527PYS9lL5ZXo9fMCqsV61f0eJO8g7wrvZ/46Pvwfbp8Yd8Vvnt8H67UWslb2eEH/Lz89vg98tfxT/P/PgAT4B9QFfA00DQwN7A3iBIUFdQU9CbYObgk+EGIbogwpDtUMjQytDF0Lsw1rDRsZJXxqvWrrocrhHPDOyOwEaERDRGzq91W7109HmkRWRA5tEZnTdaaq2sV1iatPRMlGcWMOhmNjg6Lbor+wPRj1jFnY7xiqmNmWC6sfaznbEd2GXuKY8cp5UzE2sWWxk7G2cXtiZuKd4gvj5/munAruS8TPBNqEuYS/RKPJC4khSW1JuOSo5NP8WR4ibyeFJWUrJSBVIPUgtSRNJu0vWkzfG9+QzqUvia9U0AV/Uz1CXWFW4WjGfYZVRlvM0MzT2ZJZ/Gy+rL1s3dkT+S453y9DrWOta47Vy13c+7oeqf1tRugDTEbujdqbMzfOL7JY9PRzYTNiZt/yDPJK817vSVsS1e+cv6m/LGtHlubCyQK+AXD22y31WxHbedu799hvmP/jk+F7MJrRSZF5UUfilnF174y/ariq4WdsTv7SyxLDu7C7OLtGtrtsPtoqXRpTunYHt897WX0ssKy13uj9l4tX1Zes4+wT7hvpMKnonO/5v5d+z9UxlfeqXKuaq1Wqt5RPXeAfWDwoOPBlhrlmqKa94e4h+7WetS212nXlR/GHM44/LQ+tL73a8bXjQ0KDUUNH4/wjowcDTza02jV2Nik1FTSDDcLm6eORR67+Y3rN50thi21rbTWouPguPD4s2+jvx064X2i+yTjZMt3Wt9Vt1HaCtuh9uz2mY74jpHO8M6BUytOdXfZdrV9b/T9kdNqp6vOyJ4pOUs4m3924VzOudnzqeenL8RdGOuO6n5wcdXF2z0BPf2XvC9duex++WKvU++5K3ZXTl+1uXrqGuNax3XL6+19Fn1tP1j80NZv2d9+w+pG503rm10DywfODjoMXrjleuvyba/b1++svDMwFDJ0dzhyeOQu++7kvaR7L+9n3J9/sOkh+mHhI6lH5Y+VHtf9qPdj64jlyJlR19G+J0FPHoyxxp7/lP7Th/H8p+Sn5ROqE42TZpOnp9ynbj5b/Wz8eerz+emCn6V/rn6h++K7Xxx/6ZtZNTP+kv9y4dfiV/Kvjrxe9rp71n/28ZvkN/NzhW/l3x59x3jX+z7s/cR85gfsh4qPeh+7Pnl/eriQvLDwG/eE8/vMO7xsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkUyMkExNDk4M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkUyMkExNDk5M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTIyQTE0OTYzQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTIyQTE0OTczQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7uRgzyAAAAQ0lEQVQoU2O0tnX9zwABjFAaBTBBaZwAWQHIJJhpcECSCTCAYhJZJsAA2CSKTACFCyNZJoB1Qpgk+gJFJwwQMIGBAQBsjgfZZF1fUwAAAABJRU5ErkJggg==";this.hideTopIcon=new Image,this.hideTopIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAICAYAAADJEc7MAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAACHDwAAjA8AAP1SAACBQAAAfXkAAOmLAAA85QAAGcxzPIV3AAAKL2lDQ1BJQ0MgcHJvZmlsZQAASMedlndUVNcWh8+9d3qhzTDSGXqTLjCA9C4gHQRRGGYGGMoAwwxNbIioQEQREQFFkKCAAaOhSKyIYiEoqGAPSBBQYjCKqKhkRtZKfHl57+Xl98e939pn73P32XuftS4AJE8fLi8FlgIgmSfgB3o401eFR9Cx/QAGeIABpgAwWempvkHuwUAkLzcXerrICfyL3gwBSPy+ZejpT6eD/0/SrFS+AADIX8TmbE46S8T5Ik7KFKSK7TMipsYkihlGiZkvSlDEcmKOW+Sln30W2VHM7GQeW8TinFPZyWwx94h4e4aQI2LER8QFGVxOpohvi1gzSZjMFfFbcWwyh5kOAIoktgs4rHgRm4iYxA8OdBHxcgBwpLgvOOYLFnCyBOJDuaSkZvO5cfECui5Lj25qbc2ge3IykzgCgaE/k5XI5LPpLinJqUxeNgCLZ/4sGXFt6aIiW5paW1oamhmZflGo/7r4NyXu7SK9CvjcM4jW94ftr/xS6gBgzIpqs+sPW8x+ADq2AiB3/w+b5iEAJEV9a7/xxXlo4nmJFwhSbYyNMzMzjbgclpG4oL/rfzr8DX3xPSPxdr+Xh+7KiWUKkwR0cd1YKUkpQj49PZXJ4tAN/zzE/zjwr/NYGsiJ5fA5PFFEqGjKuLw4Ubt5bK6Am8Kjc3n/qYn/MOxPWpxrkSj1nwA1yghI3aAC5Oc+gKIQARJ5UNz13/vmgw8F4psXpjqxOPefBf37rnCJ+JHOjfsc5xIYTGcJ+RmLa+JrCdCAACQBFcgDFaABdIEhMANWwBY4AjewAviBYBAO1gIWiAfJgA8yQS7YDApAEdgF9oJKUAPqQSNoASdABzgNLoDL4Dq4Ce6AB2AEjIPnYAa8AfMQBGEhMkSB5CFVSAsygMwgBmQPuUE+UCAUDkVDcRAPEkK50BaoCCqFKqFaqBH6FjoFXYCuQgPQPWgUmoJ+hd7DCEyCqbAyrA0bwwzYCfaGg+E1cBycBufA+fBOuAKug4/B7fAF+Dp8Bx6Bn8OzCECICA1RQwwRBuKC+CERSCzCRzYghUg5Uoe0IF1IL3ILGUGmkXcoDIqCoqMMUbYoT1QIioVKQ21AFaMqUUdR7age1C3UKGoG9QlNRiuhDdA2aC/0KnQcOhNdgC5HN6Db0JfQd9Dj6DcYDIaG0cFYYTwx4ZgEzDpMMeYAphVzHjOAGcPMYrFYeawB1g7rh2ViBdgC7H7sMew57CB2HPsWR8Sp4sxw7rgIHA+XhyvHNeHO4gZxE7h5vBReC2+D98Oz8dn4Enw9vgt/Az+OnydIE3QIdoRgQgJhM6GC0EK4RHhIeEUkEtWJ1sQAIpe4iVhBPE68QhwlviPJkPRJLqRIkpC0k3SEdJ50j/SKTCZrkx3JEWQBeSe5kXyR/Jj8VoIiYSThJcGW2ChRJdEuMSjxQhIvqSXpJLlWMkeyXPKk5A3JaSm8lLaUixRTaoNUldQpqWGpWWmKtKm0n3SydLF0k/RV6UkZrIy2jJsMWyZf5rDMRZkxCkLRoLhQWJQtlHrKJco4FUPVoXpRE6hF1G+o/dQZWRnZZbKhslmyVbJnZEdoCE2b5kVLopXQTtCGaO+XKC9xWsJZsmNJy5LBJXNyinKOchy5QrlWuTty7+Xp8m7yifK75TvkHymgFPQVAhQyFQ4qXFKYVqQq2iqyFAsVTyjeV4KV9JUCldYpHVbqU5pVVlH2UE5V3q98UXlahabiqJKgUqZyVmVKlaJqr8pVLVM9p/qMLkt3oifRK+g99Bk1JTVPNaFarVq/2ry6jnqIep56q/ojDYIGQyNWo0yjW2NGU1XTVzNXs1nzvhZei6EVr7VPq1drTltHO0x7m3aH9qSOnI6XTo5Os85DXbKug26abp3ubT2MHkMvUe+A3k19WN9CP16/Sv+GAWxgacA1OGAwsBS91Hopb2nd0mFDkqGTYYZhs+GoEc3IxyjPqMPohbGmcYTxbuNe408mFiZJJvUmD0xlTFeY5pl2mf5qpm/GMqsyu21ONnc332jeaf5ymcEyzrKDy+5aUCx8LbZZdFt8tLSy5Fu2WE5ZaVpFW1VbDTOoDH9GMeOKNdra2Xqj9WnrdzaWNgKbEza/2BraJto22U4u11nOWV6/fMxO3Y5pV2s3Yk+3j7Y/ZD/ioObAdKhzeOKo4ch2bHCccNJzSnA65vTC2cSZ79zmPOdi47Le5bwr4urhWuja7ybjFuJW6fbYXd09zr3ZfcbDwmOdx3lPtKe3527PYS9lL5ZXo9fMCqsV61f0eJO8g7wrvZ/46Pvwfbp8Yd8Vvnt8H67UWslb2eEH/Lz89vg98tfxT/P/PgAT4B9QFfA00DQwN7A3iBIUFdQU9CbYObgk+EGIbogwpDtUMjQytDF0Lsw1rDRsZJXxqvWrrocrhHPDOyOwEaERDRGzq91W7109HmkRWRA5tEZnTdaaq2sV1iatPRMlGcWMOhmNjg6Lbor+wPRj1jFnY7xiqmNmWC6sfaznbEd2GXuKY8cp5UzE2sWWxk7G2cXtiZuKd4gvj5/munAruS8TPBNqEuYS/RKPJC4khSW1JuOSo5NP8WR4ibyeFJWUrJSBVIPUgtSRNJu0vWkzfG9+QzqUvia9U0AV/Uz1CXWFW4WjGfYZVRlvM0MzT2ZJZ/Gy+rL1s3dkT+S453y9DrWOta47Vy13c+7oeqf1tRugDTEbujdqbMzfOL7JY9PRzYTNiZt/yDPJK817vSVsS1e+cv6m/LGtHlubCyQK+AXD22y31WxHbedu799hvmP/jk+F7MJrRSZF5UUfilnF174y/ariq4WdsTv7SyxLDu7C7OLtGtrtsPtoqXRpTunYHt897WX0ssKy13uj9l4tX1Zes4+wT7hvpMKnonO/5v5d+z9UxlfeqXKuaq1Wqt5RPXeAfWDwoOPBlhrlmqKa94e4h+7WetS212nXlR/GHM44/LQ+tL73a8bXjQ0KDUUNH4/wjowcDTza02jV2Nik1FTSDDcLm6eORR67+Y3rN50thi21rbTWouPguPD4s2+jvx064X2i+yTjZMt3Wt9Vt1HaCtuh9uz2mY74jpHO8M6BUytOdXfZdrV9b/T9kdNqp6vOyJ4pOUs4m3924VzOudnzqeenL8RdGOuO6n5wcdXF2z0BPf2XvC9duex++WKvU++5K3ZXTl+1uXrqGuNax3XL6+19Fn1tP1j80NZv2d9+w+pG503rm10DywfODjoMXrjleuvyba/b1++svDMwFDJ0dzhyeOQu++7kvaR7L+9n3J9/sOkh+mHhI6lH5Y+VHtf9qPdj64jlyJlR19G+J0FPHoyxxp7/lP7Th/H8p+Sn5ROqE42TZpOnp9ynbj5b/Wz8eerz+emCn6V/rn6h++K7Xxx/6ZtZNTP+kv9y4dfiV/Kvjrxe9rp71n/28ZvkN/NzhW/l3x59x3jX+z7s/cR85gfsh4qPeh+7Pnl/eriQvLDwG/eE8/vMO7xsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkUyMkExNDk4M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkUyMkExNDk5M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTIyQTE0OTYzQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTIyQTE0OTczQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7uRgzyAAAAO0lEQVQoU2O0tnVlwAH+Q2lGKI0CmKA0yQCbRpBNMNtAAJ0PBlSxEavJSABFniIbCdmEDsDqybSRgQEASpANwUW9eBwAAAAASUVORK5CYII=";this.hideBottomIcon=new Image,this.hideBottomIcon.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAA4AAAAICAYAAADJEc7MAAAABGdBTUEAALGOfPtRkwAAACBjSFJNAACHDwAAjA8AAP1SAACBQAAAfXkAAOmLAAA85QAAGcxzPIV3AAAKL2lDQ1BJQ0MgcHJvZmlsZQAASMedlndUVNcWh8+9d3qhzTDSGXqTLjCA9C4gHQRRGGYGGMoAwwxNbIioQEQREQFFkKCAAaOhSKyIYiEoqGAPSBBQYjCKqKhkRtZKfHl57+Xl98e939pn73P32XuftS4AJE8fLi8FlgIgmSfgB3o401eFR9Cx/QAGeIABpgAwWempvkHuwUAkLzcXerrICfyL3gwBSPy+ZejpT6eD/0/SrFS+AADIX8TmbE46S8T5Ik7KFKSK7TMipsYkihlGiZkvSlDEcmKOW+Sln30W2VHM7GQeW8TinFPZyWwx94h4e4aQI2LER8QFGVxOpohvi1gzSZjMFfFbcWwyh5kOAIoktgs4rHgRm4iYxA8OdBHxcgBwpLgvOOYLFnCyBOJDuaSkZvO5cfECui5Lj25qbc2ge3IykzgCgaE/k5XI5LPpLinJqUxeNgCLZ/4sGXFt6aIiW5paW1oamhmZflGo/7r4NyXu7SK9CvjcM4jW94ftr/xS6gBgzIpqs+sPW8x+ADq2AiB3/w+b5iEAJEV9a7/xxXlo4nmJFwhSbYyNMzMzjbgclpG4oL/rfzr8DX3xPSPxdr+Xh+7KiWUKkwR0cd1YKUkpQj49PZXJ4tAN/zzE/zjwr/NYGsiJ5fA5PFFEqGjKuLw4Ubt5bK6Am8Kjc3n/qYn/MOxPWpxrkSj1nwA1yghI3aAC5Oc+gKIQARJ5UNz13/vmgw8F4psXpjqxOPefBf37rnCJ+JHOjfsc5xIYTGcJ+RmLa+JrCdCAACQBFcgDFaABdIEhMANWwBY4AjewAviBYBAO1gIWiAfJgA8yQS7YDApAEdgF9oJKUAPqQSNoASdABzgNLoDL4Dq4Ce6AB2AEjIPnYAa8AfMQBGEhMkSB5CFVSAsygMwgBmQPuUE+UCAUDkVDcRAPEkK50BaoCCqFKqFaqBH6FjoFXYCuQgPQPWgUmoJ+hd7DCEyCqbAyrA0bwwzYCfaGg+E1cBycBufA+fBOuAKug4/B7fAF+Dp8Bx6Bn8OzCECICA1RQwwRBuKC+CERSCzCRzYghUg5Uoe0IF1IL3ILGUGmkXcoDIqCoqMMUbYoT1QIioVKQ21AFaMqUUdR7age1C3UKGoG9QlNRiuhDdA2aC/0KnQcOhNdgC5HN6Db0JfQd9Dj6DcYDIaG0cFYYTwx4ZgEzDpMMeYAphVzHjOAGcPMYrFYeawB1g7rh2ViBdgC7H7sMew57CB2HPsWR8Sp4sxw7rgIHA+XhyvHNeHO4gZxE7h5vBReC2+D98Oz8dn4Enw9vgt/Az+OnydIE3QIdoRgQgJhM6GC0EK4RHhIeEUkEtWJ1sQAIpe4iVhBPE68QhwlviPJkPRJLqRIkpC0k3SEdJ50j/SKTCZrkx3JEWQBeSe5kXyR/Jj8VoIiYSThJcGW2ChRJdEuMSjxQhIvqSXpJLlWMkeyXPKk5A3JaSm8lLaUixRTaoNUldQpqWGpWWmKtKm0n3SydLF0k/RV6UkZrIy2jJsMWyZf5rDMRZkxCkLRoLhQWJQtlHrKJco4FUPVoXpRE6hF1G+o/dQZWRnZZbKhslmyVbJnZEdoCE2b5kVLopXQTtCGaO+XKC9xWsJZsmNJy5LBJXNyinKOchy5QrlWuTty7+Xp8m7yifK75TvkHymgFPQVAhQyFQ4qXFKYVqQq2iqyFAsVTyjeV4KV9JUCldYpHVbqU5pVVlH2UE5V3q98UXlahabiqJKgUqZyVmVKlaJqr8pVLVM9p/qMLkt3oifRK+g99Bk1JTVPNaFarVq/2ry6jnqIep56q/ojDYIGQyNWo0yjW2NGU1XTVzNXs1nzvhZei6EVr7VPq1drTltHO0x7m3aH9qSOnI6XTo5Os85DXbKug26abp3ubT2MHkMvUe+A3k19WN9CP16/Sv+GAWxgacA1OGAwsBS91Hopb2nd0mFDkqGTYYZhs+GoEc3IxyjPqMPohbGmcYTxbuNe408mFiZJJvUmD0xlTFeY5pl2mf5qpm/GMqsyu21ONnc332jeaf5ymcEyzrKDy+5aUCx8LbZZdFt8tLSy5Fu2WE5ZaVpFW1VbDTOoDH9GMeOKNdra2Xqj9WnrdzaWNgKbEza/2BraJto22U4u11nOWV6/fMxO3Y5pV2s3Yk+3j7Y/ZD/ioObAdKhzeOKo4ch2bHCccNJzSnA65vTC2cSZ79zmPOdi47Le5bwr4urhWuja7ybjFuJW6fbYXd09zr3ZfcbDwmOdx3lPtKe3527PYS9lL5ZXo9fMCqsV61f0eJO8g7wrvZ/46Pvwfbp8Yd8Vvnt8H67UWslb2eEH/Lz89vg98tfxT/P/PgAT4B9QFfA00DQwN7A3iBIUFdQU9CbYObgk+EGIbogwpDtUMjQytDF0Lsw1rDRsZJXxqvWrrocrhHPDOyOwEaERDRGzq91W7109HmkRWRA5tEZnTdaaq2sV1iatPRMlGcWMOhmNjg6Lbor+wPRj1jFnY7xiqmNmWC6sfaznbEd2GXuKY8cp5UzE2sWWxk7G2cXtiZuKd4gvj5/munAruS8TPBNqEuYS/RKPJC4khSW1JuOSo5NP8WR4ibyeFJWUrJSBVIPUgtSRNJu0vWkzfG9+QzqUvia9U0AV/Uz1CXWFW4WjGfYZVRlvM0MzT2ZJZ/Gy+rL1s3dkT+S453y9DrWOta47Vy13c+7oeqf1tRugDTEbujdqbMzfOL7JY9PRzYTNiZt/yDPJK817vSVsS1e+cv6m/LGtHlubCyQK+AXD22y31WxHbedu799hvmP/jk+F7MJrRSZF5UUfilnF174y/ariq4WdsTv7SyxLDu7C7OLtGtrtsPtoqXRpTunYHt897WX0ssKy13uj9l4tX1Zes4+wT7hvpMKnonO/5v5d+z9UxlfeqXKuaq1Wqt5RPXeAfWDwoOPBlhrlmqKa94e4h+7WetS212nXlR/GHM44/LQ+tL73a8bXjQ0KDUUNH4/wjowcDTza02jV2Nik1FTSDDcLm6eORR67+Y3rN50thi21rbTWouPguPD4s2+jvx064X2i+yTjZMt3Wt9Vt1HaCtuh9uz2mY74jpHO8M6BUytOdXfZdrV9b/T9kdNqp6vOyJ4pOUs4m3924VzOudnzqeenL8RdGOuO6n5wcdXF2z0BPf2XvC9duex++WKvU++5K3ZXTl+1uXrqGuNax3XL6+19Fn1tP1j80NZv2d9+w+pG503rm10DywfODjoMXrjleuvyba/b1++svDMwFDJ0dzhyeOQu++7kvaR7L+9n3J9/sOkh+mHhI6lH5Y+VHtf9qPdj64jlyJlR19G+J0FPHoyxxp7/lP7Th/H8p+Sn5ROqE42TZpOnp9ynbj5b/Wz8eerz+emCn6V/rn6h++K7Xxx/6ZtZNTP+kv9y4dfiV/Kvjrxe9rp71n/28ZvkN/NzhW/l3x59x3jX+z7s/cR85gfsh4qPeh+7Pnl/eriQvLDwG/eE8/vMO7xsAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIiB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOkUyMkExNDk4M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIiB4bXBNTTpEb2N1bWVudElEPSJ4bXAuZGlkOkUyMkExNDk5M0IwRTExRThCQjgwRUJDMDFDODI2NzlEIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6RTIyQTE0OTYzQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6RTIyQTE0OTczQjBFMTFFOEJCODBFQkMwMUM4MjY3OUQiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz7uRgzyAAAAM0lEQVQoU2O0tnX9z0AGYILSJAOQRkYoJhaA1VNkIwwQshlFnio2wgC6zeh8MCDTRgYGACrdAdg2+RuyAAAAAElFTkSuQmCC",this.formulaColor=["#f7981d","#7e3794","#11a9cc","#a61d4c","#4285f4","#f4b400","#65b045","#795548","#999999","#f1ca3a","#3f5ca9","#c3d03f"],this.assign(t)}return(0,a.default)(e,[{key:"assign",value:function(e){this.record_preview=void 0!==e.record_preview&&e.record_preview,this.colWidth=void 0!==e.colWidth?e.colWidth:107,this.rowHeight=void 0!==e.rowHeight?e.rowHeight:28,this._colHeadHeight=void 0!==e.colHeadHeight?e.colHeadHeight:25,this._rowHeadWidth=void 0!==e.rowHeadWidth?e.rowHeadWidth:30,this.distanceX=void 0!==e.distanceX?e.distanceX:0,this.distanceY=void 0!==e.distanceY?e.distanceY:0,this.ptFontSize=void 0===e.ptFontSize||e.ptFontSize,this.navHeight=void 0!==e.navHeight?e.navHeight:80,this.frozenWidth=void 0!==e.frozenWidth?e.frozenWidth:3,this.bottomLineOffset=void 0!==e.bottomLineOffset?e.bottomLineOffset:2,void 0===e.filter&&(e.filter={}),this.filter={rangeBorderColor:void 0!==e.filter.rangeBorderColor?e.filter.rangeBorderColor:"#00c425",iconWidth:void 0!==e.filter.iconWidth?e.filter.iconWidth:18},this.autoMoveSpeed=void 0!==e.autoMoveSpeed?e.autoMoveSpeed:5,this.multiSelection=!1,void 0===e.styles&&(e.styles={}),this.styles={borderColor:void 0!==e.styles.borderColor?e.styles.borderColor:s.GRIDLINE_BORDER_COLOR,borderStyle:void 0!==e.styles.borderStyle?e.styles.borderStyle:s.GRIDLINE_BORDER_STYLE,fontSize:void 0!==e.styles.fontSize?e.styles.fontSize:10,fontFamily:void 0!==e.styles.fontFamily?e.styles.fontFamily:"\u5fae\u8f6f\u96c5\u9ed1",fontItalic:void 0!==e.styles.fontItalic&&e.styles.fontItalic,fontBold:void 0!==e.styles.fontBold&&e.styles.fontBold,fontBottomLine:void 0!==e.styles.fontBottomLine&&e.styles.fontBottomLine,fontMiddleLine:void 0!==e.styles.fontMiddleLine&&e.styles.fontMiddleLine,color:void 0!==e.styles.color?e.styles.color:"#000000",backgroundColor:void 0!==e.styles.backgroundColor?e.styles.backgroundColor:"#ffffff",textWrap:void 0!==e.styles.textWrap?e.styles.textWrap:o.TEXT_WRAP.NOWRAP,textAlign:void 0!==e.styles.textAlign?e.styles.textAlign:o.TEXT_ALIGN.LEFT,verticalAlign:void 0!==e.styles.verticalAlign?e.styles.verticalAlign:o.VERTICAL_ALIGN.MIDDLE,recordAuthor:void 0!==e.styles.recordAuthor?e.styles.recordAuthor:null,textFormats:void 0!==e.styles.textFormats?e.styles.textFormats:[{startIndex:0,format:null}]},this.copyFrameColor=void 0!==e.copyFrameColor?e.copyFrameColor:"#00a4ff",this.searchCellColor=void 0!==e.searchCellColor?e.searchCellColor:"#fff1b8",e.openUrl&&(this.openUrl=e.openUrl),this.mobileMenu=void 0!==e.mobileMenu?e.mobileMenu:{},this.pcMenu=void 0!==e.pcMenu?e.pcMenu:{},this.shortcutKeys=void 0!==e.shortcutKeys?e.shortcutKeys:{},this.permissions=void 0!==e.permissions&&e.permissions,this.allowCopy=void 0!==e.allowCopy&&e.allowCopy,this.inToastPreview=void 0!==e.inToastPreview&&e.inToastPreview}},{key:"openUrl",value:function(e){/^(mailto:(\/\/)?)?([a-z\u00a1-\uffff0-9_\-\.])+\@([a-z\u00a1-\uffff0-9_\-\.])+\.([a-z]{2,})$/i.test(e)?e=e.replace(/^(mailto:(\/\/)?)?/i,"mailto:"):/^(https?|ftp|file)\:\/\//i.test(e)||(e=/^(docs.qq.com)/i.test(e)?"https://"+e:"http://"+e);var t=void 0;t=window.clientVars?"https://docs.qq.com/scenario/link.html?url="+encodeURIComponent(e)+"&pid="+clientVars.globalPadId+"&cid="+clientVars.creatorId:e,(0,r.tencentDocOpenUrl)(t,"_blank")}},{key:"colHeadHeight",set:function(e){console.error("can't set colHeadHeight")},get:function(){return this._colHeadHeight*this.stage.tableData.scale>>0}},{key:"rowHeadWidth",set:function(e){console.error("can't set rowHeadWidth")},get:function(){return this._rowHeadWidth*this.stage.tableData.scale>>0}}]),e}();t.default=h},1286:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(14)),a=s(i(0)),o=s(i(1));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,(0,n.default)(this,t.hooks),this.cacheActivationX=-1,this.cacheActivationY=-1,this.cacheSelectionX=[-1,-1],this.cacheSelectionY=[-1,-1]}return(0,o.default)(e,[{key:"_changeSelection",value:function(e){var t=this.stage.selectData.select;this.cacheSelectionX[0]===t.xRange[0]&&this.cacheSelectionX[1]===t.xRange[1]&&this.cacheSelectionY[0]===t.yRange[0]&&this.cacheSelectionY[1]===t.yRange[1]||(this.cacheSelectionX[0]=t.xRange[0],this.cacheSelectionX[1]=t.xRange[1],this.cacheSelectionY[0]=t.yRange[0],this.cacheSelectionY[1]=t.yRange[1],this.stage.event.eventSelection.trigger("selectionChange",e),this.changeSelection&&this.changeSelection()),this.selectionShow&&this.selectionShow()}},{key:"_changeActivation",value:function(){var e=this.stage.selectData.active;this.cacheActivationX===e.xIndex&&this.cacheActivationY===e.yIndex||(this.cacheActivationX=e.xIndex,this.cacheActivationY=e.yIndex,this.changeActivation&&this.changeActivation(e.xIndex,e.yIndex),this.stage.event.eventSmart.trigger("turnOffSmartSelection"),this.stage.event.eventSmart.trigger("hideSmartSelectionTips"))}}]),e}();t.default=r},1287:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1288));function o(e){return e&&e.__esModule?e:{default:e}}var s=0;t.default=function e(t){(0,n.default)(this,e),this.stage=t.stage,s++,this.eventCell=a.default.create("cell"+s),this.eventCopy=a.default.create("copy"+s),this.eventDimension=a.default.create("dimension"+s),this.eventFilter=a.default.create("filter"+s),this.eventFormula=a.default.create("formula"+s),this.eventInput=a.default.create("input"+s),this.eventLink=a.default.create("link"+s),this.eventMenu=a.default.create("menu"+s),this.eventMouse=a.default.create("mouse"+s),this.eventTouch=a.default.create("touch"+s),this.eventRecord=a.default.create("record"+s),this.eventSelection=a.default.create("selection"+s),this.eventShape=a.default.create("shape"+s),this.eventSmart=a.default.create("smart"+s),this.eventTable=a.default.create("table"+s),this.eventCommon=a.default.create("common"+s)}},1288:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});i(1289);var n=function(){Array.prototype.slice;var e,t,i,n=Array.prototype.shift,a=Array.prototype.unshift,o={},s=function(e,t){for(var i=void 0,n=e.length,a=0;a<e.length;a++){var o=e[a];void 0!==o&&(i=t.call(o,a,o),n>e.length&&(a--,n--))}return i};return e=function(e,t,i){i[e]||(i[e]=[]),i[e].push(t)},i=function(e,t,i){if(t[e])if(i)for(var n=t[e].length-1;n>=0;n--)t[e][n]===i&&t[e].splice(n,1);else t[e]=[]},t=function(){var e=n.call(arguments),t=n.call(arguments),i=arguments,a=this,o=e[t];if(o&&o.length)return s(o,function(){return this.apply(a,i)})},{create:function(n){var r={},l=[],h={listen:function(t,i,n){e(t,i,r),null!==l&&("last"===n?l.length&&l.pop()():s(l,function(){this()}),l=null)},one:function(e,t,n){i(e,r),this.listen(e,t,n)},remove:function(e,t){i(e,r,t)},trigger:function(){var e,i,n=this;return a.call(arguments,r),i=arguments,e=function(){return t.apply(n,i)},l?l.push(e):e()}};return(n=n||"default")?o[n]?o[n]:o[n]=h:h},one:function(e,t,i){this.create().one(e,t,i)},remove:function(e,t){this.create().remove(e,t)},listen:function(e,t,i){this.create().listen(e,t,i)},trigger:function(){this.create().trigger.apply(this,arguments)}}}();t.default=n},1289:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.mark=void 0,t.measure=void 0},1290:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(14)),a=s(i(0)),o=s(i(1));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){var i=this;(0,a.default)(this,e),this._scale=function(){i.wrap.style.marginLeft=i.stage.configData.rowHeadWidth+"px",i.wrap.style.marginTop=i.stage.configData.colHeadHeight+"px",i.wrap.style.width=i.stage.bodyWidth+"px",i.wrap.style.height=i.stage.bodyHeight+"px"},this.stage=t.stage,this.container=this.stage.container,this.init(),this.initEvent()}return(0,o.default)(e,[{key:"init",value:function(){var e=document.createElement("div");e.className="excel-ui-plugin-container",this.wrap=e,(0,n.default)(e.style,{marginLeft:this.stage.configData.rowHeadWidth+"px",marginTop:this.stage.configData.colHeadHeight+"px",width:this.stage.bodyWidth+"px",height:this.stage.bodyHeight+"px",position:"absolute",top:0,left:0,zIndex:102,pointerEvents:"none",overflow:"hidden"}),this.container.parentElement.appendChild(e)}},{key:"initEvent",value:function(){this.stage.event.eventTable.listen("scale",this._scale)}},{key:"append",value:function(e){this.wrap.appendChild(e)}},{key:"remove",value:function(e){this.wrap.contains(e)&&this.wrap.removeChild(e)}}]),e}();t.default=r},1291:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(14)),a=s(i(0)),o=s(i(1));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,this.container=this.stage.container,this.init()}return(0,o.default)(e,[{key:"init",value:function(){var e=document.createElement("div");this.wrap=e,(0,n.default)(e.style,{position:"absolute",top:0,left:0,width:"100%",height:"100%",pointerEvents:"none"}),this.container.appendChild(e)}},{key:"append",value:function(e){this.wrap.appendChild(e)}},{key:"remove",value:function(e){this.wrap.contains(e)&&this.wrap.removeChild(e)}}]),e}();t.default=r},1292:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";e=e.toUpperCase(),i=i.trim();var f=e.length;if(!i||-1===t||"="!==i.charAt(0))return w(f+2,"="+e+"()");var v=0,A="",C=l(t,i),m=C.front,x=C.behind,b=h(m,x),R=b.leftChar,E=b.rightChar;if(u(m,x))return m=g(m),x=g(x,!0),A=""+m+e+"()"+x,v=m.length+f+1,w(v,A);if(!o.indexOf(R))return A=""+m+e+"()+"+x,v=m.length+f+1,w(v,A);if(!o.indexOf(E))return A=m+"+"+e+"()"+x,v=m.length+f+2,w(v,A);if(!R&&"="===E)return w(v=f+2,A="="+e+"()"+i);if(~n.indexOf(R)&&~a.indexOf(E))return A=""+m+e+"()"+x,v=m.length+f+1,w(v,A);if(~a.indexOf(R))return A=m+"+"+e+"()"+x,v=m.length+f+2,w(v,A);if(d(x))return s(R)?~n.indexOf(E)?(v=m.length+1,w(v,A=m+"()+"+e+x)):(m=c(m),x=c(x,!0),A=""+m+e+x,v=m.length+f,w(v,A)):(A=""+m+e+"()+"+x,v=m.length+f+1,w(v,A));if(p(m,x))return m=I(m),x=I(x,!0),A=""+m+e+"()"+x,v=m.length+f+1,w(v,A);if(r(x))return m=y(m),x=y(x,!0),A=""+m+e+"()"+x,v=m.length+f+1,w(v,A);return w(f+2,"="+e+"()")};var n=["(","\uff08"],a=[")","\uff09"],o=["+","-","*","/"],s=function(e){return 1===e.length&&/[A-Z]/i.test(e)},r=function(e){return/\+|\-|\*|\//.test(e)},l=function(e,t){return{front:t.substr(0,e),behind:t.substr(e,t.length)}},h=function(e,t){return e=e.trim(),t=t.trim(),{leftChar:e?e[e.length-1]:"",rightChar:t?t[0]:""}},g=function(e,t){if(t){for(;'"'!==e[0];)e=e.substr(1);'"'===e.charAt(0)&&(e=e.substr(1))}else{for(;'"'!==e[e.length-1];)e=e.substring(e.length-1,-1);'"'===e[e.length-1]&&(e=e.substring(e.length-1,-1))}return e},c=function(e,t){if(t)for(;void 0!==e[0]&&s(e[0]);)e=e.substr(1);else for(;void 0!==e[e.length-1]&&s(e[e.length-1]);)e=e.substring(e.length-1,-1);return e},d=function(e){if(!e)return!1;for(var t=!0,i=0;i<e.length;i++){var a=e[i];if(~n.indexOf(a))break;if(!s(a)&&" "!==a){t=!1;break}}return t},u=function(e,t){for(var i=e.length,n=e+t,a=[],o=n.indexOf('"');o>-1;)a.push(o),o=n.indexOf('"',o+1);if(!a.length||a.length%2)return!1;for(var s=!1,r=0;r<a.length;r+=2){var l=a[r],h=a[r+1];if(i>l&&i<=h){s=!0;break}}return s},f=a,v=n,A=["(",",","\uff08","\uff0c"],C=[",",")","\uff0c","\uff09"],p=function(e,t){for(var i=!1,n=!1,a=e.length-1;a>0;a--){var o=e[a];if(~f.indexOf(o)){n=!0;break}if(~A.indexOf(o)){i=!0;break}}if(n||!i)return!1;for(var s=!1,r=!1,l=0;l<t.length;l++){var h=t[l];if(~v.indexOf(h)){r=!0;break}if(~C.indexOf(h)){s=!0;break}}return!(r||!s)},I=function(e,t){if(t)for(;void 0!==e[0]&&!~C.indexOf(e[0]);)e=e.substr(1);else for(;void 0!==e[e.length-1]&&!~A.indexOf(e[e.length-1]);)e=e.substring(e.length-1,-1);return e},m=o.concat(["="]),y=function(e,t){if(t)for(;void 0!==e[0]&&!~m.indexOf(e[0]);)e=e.substr(1);else for(;void 0!==e[e.length-1]&&!~m.indexOf(e[e.length-1]);)e=e.substring(e.length-1,-1);return e},w=function(e,t){return{curpos:e,value:t}}},1293:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(i(9)),a=v(i(24)),o=v(i(3)),s=v(i(0)),r=v(i(1)),l=v(i(4)),h=v(i(5)),g=v(i(287)),c=v(i(399)),d=i(33),u=i(10),f=i(21);function v(e){return e&&e.__esModule?e:{default:e}}var A=function(e){function t(e){(0,s.default)(this,t);var i=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return i._renderInfos={},i._customRenderInfos={},i}return(0,h.default)(t,e),(0,r.default)(t,[{key:"collect",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=this._preproccessBorderProps(e),o=n.style,s=n.color;if(o!==d.BORDER_STYLE.NONE){var r=this._toHash(o,s);if(i){var l,h=this._customRenderInfos;h.hasOwnProperty(r)||(h[r]=[]),(l=h[r]).push.apply(l,(0,a.default)(t))}else{var g,c=this._renderInfos;c.hasOwnProperty(r)||(c[r]=[]),(g=c[r]).push.apply(g,(0,a.default)(t))}}}},{key:"_preproccessBorderProps",value:function(e){var t=this.stage.tableData.hideGridlines,i=e.style,n=e.color;return null!==i&&void 0!==i||(i=t?d.BORDER_STYLE.NONE:null),null!==n&&void 0!==n||(n=d.GRIDLINE_BORDER_COLOR),{style:i,color:n}}},{key:"_toHash",value:function(e,t){return e+"-"+t}},{key:"clear",value:function(){this.clearRenderInfos()}},{key:"clearRenderInfos",value:function(){this._renderInfos={},this._customRenderInfos={}}},{key:"_restoreRenderContext",value:function(){this.ctx.lineWidth=1,this.ctx.setLineDash([])}},{key:"calcTableCellBorder",value:function(e,t,i,n,a){var o=this.stage.tableData.col.getWidth(i),s=this.stage.tableData.row.getHeight(n);this.calcTopOrBottomBorder(!0,e,t,i,n,o,s,a),this.calcTopOrBottomBorder(!1,e,t,i,n,o,s,a),this.calcLeftOrRightBorder(!0,e,t,i,n,o,s,a),this.calcLeftOrRightBorder(!1,e,t,i,n,o,s,a)}},{key:"calcDefaultTableCellBorder",value:function(e,t,i,n){if(!this.stage.tableData.hideGridlines){var a=this.stage.tableData,o=a.col.getWidth(i),s=a.row.getHeight(n),r=(0,f.findNextShowCol)(a,i,1),l=(0,f.findNextShowRow)(a,n,1),h=a.getCellDataAtPosition(n,r,u.GET_CELLDATA.NORMAL);h&&h.borderLeftShow||this.calcSingleVerticalBorderLine(d.BORDER_TYPE.RIGHT,{style:null,color:d.GRIDLINE_BORDER_COLOR},e+o,t,i,n,s);var g=a.getCellDataAtPosition(l,i,u.GET_CELLDATA.NORMAL);g&&g.borderTopShow||this.calcSingelHorizontalBorderLine(d.BORDER_TYPE.BOTTOM,{style:null,color:d.GRIDLINE_BORDER_COLOR},e,t+s,i,n,o)}}},{key:"calcTableMergeCellBorder",value:function(e,t,i,n,a){var o,s,r=this.stage.tableData,l=this.stage.areaData,h=a.mergeData.xRange,g=a.mergeData.yRange,c=void 0,d=void 0;o=l.col.getViewportLeft(h[0]),s=l.row.getViewportTop(g[0]);var f=void 0,v=void 0,A=void 0,C=void 0;for(c=o,d=l.row.getViewportTop(g[1]),f=h[0];f<=h[1];f++)A=r.col.getWidth(f),v=r.getCellDataAtPosition(g[0],f,u.GET_CELLDATA.NORMAL),C=r.row.getHeight(g[0]),this.calcTopOrBottomBorder(!0,c,s,f,g[0],A,C,this._toCellBorderInfo(v)),v=r.getCellDataAtPosition(g[1],f,u.GET_CELLDATA.NORMAL),C=r.row.getHeight(g[1]),this.calcTopOrBottomBorder(!1,c,d,f,g[1],A,C,this._toCellBorderInfo(v)),f<h[1]&&(c+=r.col.getWidth(f));for(c=l.col.getViewportLeft(h[1]),d=s,f=g[0];f<=g[1];f++)C=r.row.getHeight(f),v=r.getCellDataAtPosition(f,h[0],u.GET_CELLDATA.NORMAL),A=r.col.getWidth(h[0]),this.calcLeftOrRightBorder(!0,o,d,h[0],f,A,C,this._toCellBorderInfo(v)),v=r.getCellDataAtPosition(f,h[1],u.GET_CELLDATA.NORMAL),A=r.col.getWidth(h[1]),this.calcLeftOrRightBorder(!1,c,d,h[1],f,A,C,this._toCellBorderInfo(v)),f<g[1]&&(d+=r.row.getHeight(f))}},{key:"_toCellBorderInfo",value:function(e){return e||console.warn("error: cell is null!"),{styles:e.borderStyle,colors:e.borderColor,shows:[e.borderTopShow,e.borderRightShow,e.borderBottomShow,e.borderLeftShow]}}},{key:"calcTopOrBottomBorder",value:function(e,t,i,n,a,o,s,r){var l=e?0:2;if(r.shows[l]){var h=r.styles[l],g=r.colors[l],c=e?d.BORDER_TYPE.TOP:d.BORDER_TYPE.BOTTOM;h===d.BORDER_STYLE.DOUBLE?this.calcDoubleHorizontalBorderLine(c,{style:h,color:g},t,e?i:i+s,n,a,o):this.calcSingelHorizontalBorderLine(c,{style:h,color:g},t,e?i:i+s,n,a,o)}}},{key:"calcLeftOrRightBorder",value:function(e,t,i,n,a,o,s,r){var l=e?3:1;if(r.shows[l]){var h=r.styles[l],g=r.colors[l],c=e?d.BORDER_TYPE.LEFT:d.BORDER_TYPE.RIGHT;h===d.BORDER_STYLE.DOUBLE?this.calcDoubleVerticalBorderLine(c,{style:h,color:g},e?t:t+o,i,n,a,s):this.calcSingleVerticalBorderLine(c,{style:h,color:g},e?t:t+o,i,n,a,s)}}},{key:"calcDoubleHorizontalBorderLine",value:function(e,t,i,n,a,o,s){var r={x:i-=.5,y:n-1},l={x:i+(s+=1),y:n-1},h={x:i,y:n+1},g={x:i+s,y:n+1},c=e===d.BORDER_TYPE.TOP?h:r,u=e===d.BORDER_TYPE.TOP?g:l,f=e===d.BORDER_TYPE.TOP?r:h,v=e===d.BORDER_TYPE.TOP?l:g,A=void 0,C=void 0;e===d.BORDER_TYPE.TOP?(A=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.RIGHT),C=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.RIGHT)):(A=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.RIGHT),C=this.getCellBorderStyle(o+1,a-1,d.BORDER_TYPE.RIGHT)),A===d.BORDER_STYLE.DOUBLE&&C===d.BORDER_STYLE.DOUBLE?(c.x+=1,f.x+=1):A!==d.BORDER_STYLE.DOUBLE&&C===d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.TOP?(c.x+=1,f.x-=1):(c.x-=1,f.x+=1):A===d.BORDER_STYLE.DOUBLE&&C!==d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.TOP?(c.x-=1,f.x+=1):(c.x+=1,f.x-=1):A===d.BORDER_STYLE.NONE&&C===d.BORDER_STYLE.NONE||(c.x+=1,f.x+=1);var p=void 0,I=void 0;e===d.BORDER_TYPE.TOP?(p=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.RIGHT),I=this.getCellBorderStyle(o,a,d.BORDER_TYPE.RIGHT)):(p=this.getCellBorderStyle(o,a,d.BORDER_TYPE.RIGHT),I=this.getCellBorderStyle(o+1,a,d.BORDER_TYPE.RIGHT)),p===d.BORDER_STYLE.DOUBLE&&I===d.BORDER_STYLE.DOUBLE?(u.x-=1,v.x-=1):p!==d.BORDER_STYLE.DOUBLE&&I===d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.TOP?(u.x-=1,v.x+=1):(u.x+=1,v.x-=1):p===d.BORDER_STYLE.DOUBLE&&I!==d.BORDER_STYLE.DOUBLE&&(e===d.BORDER_TYPE.TOP?(u.x+=1,v.x-=1):(u.x-=1,v.x+=1)),this.collect(t,[[c.x,c.y,u.x,u.y],[f.x,f.y,v.x,v.y]])}},{key:"calcDoubleVerticalBorderLine",value:function(e,t,i,n,a,o,s){var r={x:i-1,y:n-=.5},l={x:i-1,y:n+(s+=1)},h={x:i+1,y:n},g={x:i+1,y:n+s},c=e===d.BORDER_TYPE.LEFT?h:r,u=e===d.BORDER_TYPE.LEFT?g:l,f=e===d.BORDER_TYPE.LEFT?r:h,v=e===d.BORDER_TYPE.LEFT?l:g,A=void 0,C=void 0;e===d.BORDER_TYPE.LEFT?(A=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.BOTTOM),C=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.BOTTOM)):(A=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.BOTTOM),C=this.getCellBorderStyle(o-1,a+1,d.BORDER_TYPE.BOTTOM)),A===d.BORDER_STYLE.DOUBLE&&C===d.BORDER_STYLE.DOUBLE?(c.y+=1,f.y+=1):A!==d.BORDER_STYLE.DOUBLE&&C===d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.LEFT?(c.y+=1,f.y-=1):(c.y-=1,f.y+=1):A===d.BORDER_STYLE.DOUBLE&&C!==d.BORDER_STYLE.DOUBLE&&(e===d.BORDER_TYPE.LEFT?(c.y-=1,f.y+=1):(c.y+=1,f.y-=1));var p=void 0,I=void 0;e===d.BORDER_TYPE.LEFT?(p=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.BOTTOM),I=this.getCellBorderStyle(o,a,d.BORDER_TYPE.BOTTOM)):(p=this.getCellBorderStyle(o,a,d.BORDER_TYPE.BOTTOM),I=this.getCellBorderStyle(o,a+1,d.BORDER_TYPE.BOTTOM)),p===d.BORDER_STYLE.DOUBLE&&I===d.BORDER_STYLE.DOUBLE?(u.y-=1,v.y-=1):p!==d.BORDER_STYLE.DOUBLE&&I===d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.LEFT?(u.y-=1,v.y+=1):(u.y+=1,v.y-=1):p===d.BORDER_STYLE.DOUBLE&&I!==d.BORDER_STYLE.DOUBLE?e===d.BORDER_TYPE.LEFT?(u.y+=1,v.y-=1):(u.y-=1,v.y+=1):p===d.BORDER_STYLE.NONE&&I===d.BORDER_STYLE.NONE||(u.y-=1,v.y-=1),this.collect(t,[[c.x,c.y,u.x,u.y],[f.x,f.y,v.x,v.y]])}},{key:"calcSingelHorizontalBorderLine",value:function(e,t,i,n,a,o,s){var r={x:i-=.5,y:n},l={x:i+(s+=1),y:n},h=void 0,g=void 0,c=void 0;e===d.BORDER_TYPE.TOP?(h=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.BOTTOM),g=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.RIGHT),c=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.RIGHT)):(h=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.BOTTOM),g=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.RIGHT),c=this.getCellBorderStyle(o+1,a-1,d.BORDER_TYPE.RIGHT));var u=0;h===d.BORDER_STYLE.DOUBLE&&(u+=1),g===d.BORDER_STYLE.DOUBLE&&(u+=1),c===d.BORDER_STYLE.DOUBLE&&(u+=1),g!==d.BORDER_STYLE.DOUBLE&&c!==d.BORDER_STYLE.DOUBLE||1!==u?u>1&&(r.x+=1):r.x-=1;var f=void 0,v=void 0,A=void 0;e===d.BORDER_TYPE.TOP?(f=this.getCellBorderStyle(o-1,a+1,d.BORDER_TYPE.BOTTOM),v=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.RIGHT),A=this.getCellBorderStyle(o,a,d.BORDER_TYPE.RIGHT)):(f=this.getCellBorderStyle(o,a+1,d.BORDER_TYPE.BOTTOM),v=this.getCellBorderStyle(o,a,d.BORDER_TYPE.RIGHT),A=this.getCellBorderStyle(o+1,a,d.BORDER_TYPE.RIGHT)),u=0,f===d.BORDER_STYLE.DOUBLE&&(u+=1),v===d.BORDER_STYLE.DOUBLE&&(u+=1),A===d.BORDER_STYLE.DOUBLE&&(u+=1),v!==d.BORDER_STYLE.DOUBLE&&A!==d.BORDER_STYLE.DOUBLE||1!==u?u>1&&(l.x-=1):l.x+=1,this.collect(t,[[r.x,r.y,l.x,l.y]])}},{key:"calcSingleVerticalBorderLine",value:function(e,t,i,n,a,o,s){var r={x:i,y:n-=.5},l={x:i,y:n+(s+=1)},h=void 0,g=void 0,c=void 0;e===d.BORDER_TYPE.RIGHT?(h=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.RIGHT),g=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.BOTTOM),c=this.getCellBorderStyle(o-1,a+1,d.BORDER_TYPE.BOTTOM)):(h=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.RIGHT),g=this.getCellBorderStyle(o-1,a-1,d.BORDER_TYPE.BOTTOM),c=this.getCellBorderStyle(o-1,a,d.BORDER_TYPE.BOTTOM));var u=0;h===d.BORDER_STYLE.DOUBLE&&(u+=1),g===d.BORDER_STYLE.DOUBLE&&(u+=1),c===d.BORDER_STYLE.DOUBLE&&(u+=1),g!==d.BORDER_STYLE.DOUBLE&&c!==d.BORDER_STYLE.DOUBLE||1!==u?u>1&&(r.y+=1):r.y-=1;var f=void 0,v=void 0,A=void 0;e===d.BORDER_TYPE.RIGHT?(f=this.getCellBorderStyle(o+1,a,d.BORDER_TYPE.RIGHT),v=this.getCellBorderStyle(o,a,d.BORDER_TYPE.BOTTOM),A=this.getCellBorderStyle(o,a+1,d.BORDER_TYPE.BOTTOM)):(f=this.getCellBorderStyle(o+1,a-1,d.BORDER_TYPE.RIGHT),v=this.getCellBorderStyle(o,a-1,d.BORDER_TYPE.BOTTOM),A=this.getCellBorderStyle(o,a,d.BORDER_TYPE.BOTTOM)),u=0,f===d.BORDER_STYLE.DOUBLE&&(u+=1),v===d.BORDER_STYLE.DOUBLE&&(u+=1),A===d.BORDER_STYLE.DOUBLE&&(u+=1),v!==d.BORDER_STYLE.DOUBLE&&A!==d.BORDER_STYLE.DOUBLE||1!==u?u>1&&(l.y-=1):l.y+=1,this.collect(t,[[r.x,r.y,l.x,l.y]])}},{key:"getCellBorderStyle",value:function(e,t,i){if(i!==d.BORDER_TYPE.RIGHT&&i!==d.BORDER_TYPE.BOTTOM)return console.error("\u76ee\u524d\u652f\u6301\u83b7\u53d6\u5355\u5143\u683c\u53f3\uff0c\u4e0b\u8fb9\u6846\u7ebf\u6837\u5f0f"),d.BORDER_STYLE.NONE;var n=this.stage.tableData,a=this.stage.getColCount(),o=this.stage.getRowCount();if(e<0||e>o-1||t<0||t>a-1)return d.BORDER_STYLE.NONE;var s=n.getCellDataAtPosition(e,t,u.GET_CELLDATA.NORMAL);if(s&&(s.merge||s.merged)){var r=s.parent;if(!r)return d.BORDER_STYLE.NONE;var l=r.mergeData.xRange,h=r.mergeData.yRange;if(i===d.BORDER_TYPE.RIGHT&&t<l[1]||i===d.BORDER_TYPE.BOTTOM&&e<h[1])return d.BORDER_STYLE.NONE}var g=void 0;if(i===d.BORDER_TYPE.RIGHT){var c=void 0;return s?s.borderRightShow?c=(0,f.isUndefinedOrNull)(s.borderStyle[1])?d.BORDER_STYLE.NONE:s.borderStyle[1]:(g=n.getCellDataAtPosition(e,t+1,u.GET_CELLDATA.DEFAULT),c=(0,f.isUndefinedOrNull)(g.borderStyle[3])?d.BORDER_STYLE.NONE:g.borderStyle[3]):c=(g=n.getCellDataAtPosition(e,t+1,u.GET_CELLDATA.NORMAL))&&g.borderLeftShow?(0,f.isUndefinedOrNull)(g.borderStyle[3])?d.BORDER_STYLE.NONE:g.borderStyle[3]:d.BORDER_STYLE.NONE,s=null,g=null,c}if(i===d.BORDER_TYPE.BOTTOM){var v=void 0;return s?s.borderBottomShow?v=(0,f.isUndefinedOrNull)(s.borderStyle[2])?d.BORDER_STYLE.NONE:s.borderStyle[2]:(g=n.getCellDataAtPosition(e+1,t,u.GET_CELLDATA.DEFAULT),v=(0,f.isUndefinedOrNull)(g.borderStyle[0])?d.BORDER_STYLE.NONE:g.borderStyle[0]):v=(g=n.getCellDataAtPosition(e+1,t,u.GET_CELLDATA.NORMAL))&&g.borderTopShow?(0,f.isUndefinedOrNull)(g.borderStyle[0])?d.BORDER_STYLE.NONE:g.borderStyle[0]:d.BORDER_STYLE.NONE,s=null,g=null,v}return d.BORDER_STYLE.NONE}},{key:"render",value:function(){var e=(0,n.default)(this._renderInfos);if(e&&e.length){var t=this.sortBorderStylesToBorderProps(this._renderInfos);this.renderBorderWithBorderProps(t,this._renderInfos),this._customRenderInfos&&(t=this.transformBorderStylesToBorderProps(this._customRenderInfos),this.renderBorderWithBorderProps(t,this._customRenderInfos)),this._restoreRenderContext()}}},{key:"renderBorderWithBorderProps",value:function(e,t){var i=this,n=void 0,a=void 0;e.reverse().forEach(function(e){a=e.getHash(),n=t[a],i._prepareRenderContext(e),n.forEach(i._renderBorderLine.bind(i))}),this.clear()}},{key:"_prepareRenderContext",value:function(e){this.ctx.strokeStyle=e.getBorderColor(),this.ctx.lineWidth=e.getBorderWidth(),this.ctx.setLineDash(e.getDashSegments())}},{key:"_renderBorderLine",value:function(e){this.ctx.beginPath(),this.ctx.moveTo(e[0],e[1]),this.ctx.lineTo(e[2],e[3]),this.ctx.stroke()}},{key:"sortBorderStylesToBorderProps",value:function(e){return this.transformBorderStylesToBorderProps(e).sort(function(e,t){return e.compare(t)})}},{key:"transformBorderStylesToBorderProps",value:function(e){var t=(0,n.default)(e);return t&&t.length?t.map(function(e){return c.default.fromHash(e)}):[]}}]),t}(g.default);t.default=A},1294:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(9)),a=f(i(3)),o=f(i(0)),s=f(i(1)),r=f(i(4)),l=f(i(5)),h=f(i(287)),g=f(i(664)),c=i(205),d=f(c),u=i(10);function f(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var i=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return i._renderInfos={},i}return(0,l.default)(t,e),(0,s.default)(t,[{key:"collect",value:function(e,t){var i=e.getHash();this._renderInfos.hasOwnProperty(i)||(this._renderInfos[i]=[]),this._renderInfos[i].push(t)}},{key:"clear",value:function(){this._renderInfos={}}},{key:"calcTableCellRichText",value:function(e,t,i,n,a){var o=this;if(e){var s=this.stage.tableData,r=this.stage.configData,l=s.scale||1,h=s.getCellBackgroundWidth(a,n,!1),g=s.getCellBackgroundHeight(a,n,!1),f=e.getMaxTextWidth()*l,v=e.getTextHeight()*l,A=void 0;e.merge&&(f>h||v>g)?A=[t,i,h,g]:g<v||e.covers?(e.covers&&e.covers.length&&e.covers.forEach(function(e,t){h+=s.getCellBackgroundWidth(a,n+t+1,!1)}),A=[t,i,h,g]):e.textWrap==u.TEXT_WRAP.NORMAL&&f>h&&(A=[t,i,h,g]);var C=void 0,p=void 0,I=void 0,m=void 0;e.lines.forEach(function(e){C=e.offsetX,p=e.offsetY;var n=t+C*l,a=i+p*l,s=void 0,h=void 0;a-3*e.getLineHeight()/4*l>>0<i+g&&e.segments.forEach(function(e){if(s=Math.round(e.size.width),h=Math.round(e.size.height),e.fontProp.underline){var t=Math.round(r.bottomLineOffset*l);I=[n,a+t,n+s*l,a+t]}else I=void 0;if(e.fontProp.strikethrough){var g=Math.round(e.size.height/4*l);m=[n,a-g,n+s*l,a-g]}else m=void 0;if(e instanceof d.default){o.collect(e.fontProp,{clipInfo:A,textInfo:[e.text,c.MentionOuterPadding*l+n+c.MentionInnerLeftRightPadding*l,i+(p-c.MentionOuterPadding)*l],underlineInfo:void 0,strikethroughInfo:void 0});var u=Math.round(a-.75*h*l)+c.MentionOuterPadding,f=u-c.MentionOuterPadding+(h-c.MentionTriangleHeight)/2*l;o.stage.renders.mentionRender.collect({clipInfo:A,borderInfo:[c.MentionOuterPadding*l+n,u,(s-2*c.MentionOuterPadding)*l,(h-2*c.MentionOuterPadding)*l],triangleInfo:[n+(s-c.MentionOuterPadding-c.MentionInnerLeftRightPadding-c.MentionTriangleWidth)*l,f],mentionStatus:e.mentionStatus})}else o.collect(e.fontProp,{clipInfo:A,textInfo:[e.text,n,a],underlineInfo:I,strikethroughInfo:m});n+=s*l})})}}},{key:"render",value:function(){var e=this,t=(0,n.default)(this._renderInfos);if(t&&t.length){var i=t.map(function(e){return g.default.fromHash(e)}),a=void 0,o=void 0;i.forEach(function(t){a=t.getHash(),o=e._renderInfos[a],e._prepareRenderContext(t),o&&o.forEach(e._renderUnderlineAndStrikethrough.bind(e)),o&&o.forEach(e._renderRichText.bind(e))}),this.clear()}}},{key:"_prepareRenderContext",value:function(e){var t=this.stage.tableData.scale;this.ctx.font=e.getStyle(!0,t),this.ctx.fillStyle=e.color,this.ctx.strokeStyle=e.color,this.ctx.lineWidth=Math.max(1,Math.ceil(e.fontSize/15*t))}},{key:"_renderRichText",value:function(e){e.clipInfo&&(this.ctx.save(),this.ctx.rect(e.clipInfo[0],e.clipInfo[1],e.clipInfo[2],e.clipInfo[3]),this.ctx.clip()),this.ctx.beginPath(),this.ctx.fillText(e.textInfo[0]+"",Number(e.textInfo[1]),Number(e.textInfo[2])),e.clipInfo&&this.ctx.restore()}},{key:"_renderUnderlineAndStrikethrough",value:function(e){(e.underlineInfo||e.strikethroughInfo)&&(e.clipInfo&&(this.ctx.save(),this.ctx.rect(e.clipInfo[0],e.clipInfo[1],e.clipInfo[2],e.clipInfo[3]),this.ctx.clip()),e.underlineInfo&&this._renderLine(e.underlineInfo[0],e.underlineInfo[1],e.underlineInfo[2],e.underlineInfo[3]),e.strikethroughInfo&&this._renderLine(e.strikethroughInfo[0],e.strikethroughInfo[1],e.strikethroughInfo[2],e.strikethroughInfo[3]),e.clipInfo&&this.ctx.restore())}},{key:"_renderLine",value:function(e,t,i,n){this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(i,n),this.ctx.stroke()}}]),t}(h.default);t.default=v},1295:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(3)),a=g(i(0)),o=g(i(1)),s=g(i(4)),r=g(i(5)),l=g(i(287)),h=i(205);function g(e){return e&&e.__esModule?e:{default:e}}var c=[0,0,h.MentionTriangleWidth,0,h.MentionTriangleWidth/2,h.MentionTriangleHeight],d=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i._renderInfos=[],i}return(0,r.default)(t,e),(0,o.default)(t,[{key:"collect",value:function(e){this._renderInfos.push(e)}},{key:"clear",value:function(){this._renderInfos=[]}},{key:"render",value:function(){this._renderInfos.length&&(this.renderTriangle(),this.renderRoundedRect(),this.clear())}},{key:"renderTriangle",value:function(){var e=this;this.ctx.fillStyle="#c1c1c1",this._renderInfos.forEach(function(t){e.drawTriangle(t.clipInfo||null,t.triangleInfo)})}},{key:"renderRoundedRect",value:function(){var e=this;this.ctx.lineWidth=1,this.ctx.strokeStyle="#e0e0e0";var t=this.stage.tableData.scale;this._renderInfos.forEach(function(i){e.drawRoundedRect(i.clipInfo||null,i.borderInfo,h.MentinoRadius*t,i.mentionStatus)})}},{key:"drawTriangle",value:function(e,t){e&&(this.ctx.save(),this.ctx.rect(e[0],e[1],e[2],e[3]),this.ctx.clip());var i=this.stage.tableData.scale,n=c.map(function(e,n){return e*i+t[n%2]});this.ctx.beginPath(),this.ctx.moveTo(n[0],n[1]),this.ctx.lineTo(n[2],n[3]),this.ctx.lineTo(n[4],n[5]),this.ctx.closePath(),this.ctx.fill(),e&&this.ctx.restore()}},{key:"drawRoundedRect",value:function(e,t,i,n){e&&(this.ctx.save(),this.ctx.rect(e[0],e[1],e[2],e[3]),this.ctx.clip());var a=[t[0]+i,t[1]],o=[t[0]+t[2],t[1]],s=[t[0]+t[2],t[1]+t[3]],r=[t[0],t[1]+t[3]],l=[t[0],t[1]];this.ctx.beginPath(),this.ctx.moveTo(a[0],a[1]),this.ctx.arcTo(o[0],o[1],s[0],s[1],i),this.ctx.arcTo(s[0],s[1],r[0],r[1],i),this.ctx.arcTo(r[0],r[1],l[0],l[1],i),this.ctx.arcTo(l[0],l[1],a[0],a[1],i),this.ctx.stroke();var g=void 0;g=n===h.MENTION_STATUS.HIGHTLIGHT?"#fff4c4":n===h.MENTION_STATUS.HOVER?"#f4f4f4":"#ffffff",this.ctx.fillStyle=g,this.ctx.fill(),e&&this.ctx.restore()}}]),t}(l.default);t.default=d},1296:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(9)),a=h(i(3)),o=h(i(0)),s=h(i(1)),r=h(i(4)),l=h(i(5));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var i=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return i._renderInfos={},i}return(0,l.default)(t,e),(0,s.default)(t,[{key:"collect",value:function(e,t){this._renderInfos.hasOwnProperty(e)||(this._renderInfos[e]=[]),this._renderInfos[e].push(t)}},{key:"clear",value:function(){this._renderInfos={}}},{key:"calcTableCellBackground",value:function(e,t,i,n,a){var o=this.stage.tableData,s=[t,i,o.getCellBackgroundWidth(a,n,!1)+.5,o.getCellBackgroundHeight(a,n,!1)];this.collect(e,s)}},{key:"render",value:function(){var e=this,t=(0,n.default)(this._renderInfos);if(t&&t.length){var i=void 0;t.forEach(function(t){i=e._renderInfos[t],e._prepareRenderContext(t),i&&i.forEach(e._renderBackground.bind(e))}),this.clear()}}},{key:"_prepareRenderContext",value:function(e){this.ctx.fillStyle=e}},{key:"_renderBackground",value:function(e){this.ctx.beginPath(),this.ctx.rect(e[0],e[1],e[2],e[3]),this.ctx.fill()}}]),t}(h(i(287)).default);t.default=g},1297:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(24)),a=c(i(0)),o=c(i(1)),s=i(386),r=c(s),l=c(i(1298)),h=c(i(1299)),g=c(i(205));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){(0,a.default)(this,e),this.segmentMeasurer=new h.default}return(0,o.default)(e,[{key:"nonAutoWrapLine",value:function(e){var t=this,i=new l.default,n=void 0;return e.forEach(function(e){e=e.replaceLineFeed2Space(),n=t.segmentMeasurer.measure(e),e.setSize(n),i.addSegment(e)}),i.excludeEmptySegment(),[i]}},{key:"autoWrapLine",value:function(e,t){var i=this,n=[];n=this.splitLinesByLineFeed(e);for(var a=void 0,o=0;o<n.length;o++)a=this.checkLineByLineWidth(n[o],t),n[o]=a.resultLine,a.exceedSegments.length>0&&n.splice(o+1,0,new l.default(a.exceedSegments));return n.forEach(function(e){if(e.excludeEmptySegment(),!e.isEmpty()){var t=e.lastSegment();t.rightTrim()&&t.setSize(i.segmentMeasurer.measure(t))}}),n}},{key:"splitLinesByLineFeed",value:function(e){var t=[new l.default];return e.forEach(function(e){e.containLineFeed()?e.splitByLineFeed().forEach(function(e,i){i>0&&t.push(new l.default),t[t.length-1].addSegment(e)}):t[t.length-1].addSegment(e)}),t}},{key:"checkLineByLineWidth",value:function(e,t){for(var i=new l.default,a=[],o=e.segments,s=void 0,r=0,h=0;h<o.length;h++){if(s=o[h],!o[h].size||!o[h].size.width&&!o[h].size.height){s.setSize(this.segmentMeasurer.measure(s));var c=3*t;if(!(s instanceof g.default)&&s.size.width>c&&void 0===s.wordType){var d=this.preSplitSegment(s);d.length>1&&(o.splice.apply(o,[h,1].concat((0,n.default)(d))),s=o[h])}}if((r+=s.size.width)>t){var u,f=t-(r-s.size.width),v=void 0,A=this.beforeSplitSegmentCb(s,t,i.isEmpty());if((v=A.break?A.result:s.softSplit(this.segmentMeasurer,f,i.isEmpty())).frontSegment&&!v.frontSegment.isEmpty()&&(v.frontSegment.setSize(this.segmentMeasurer.measure(v.frontSegment)),i.addSegment(v.frontSegment)),v.backSegment&&!v.backSegment.isEmpty()&&(v.backSegment.setSize(this.segmentMeasurer.measure(v.backSegment)),a.push(v.backSegment)),h+1<o.length)(u=a).push.apply(u,(0,n.default)(o.slice(h+1,o.length)));var C=this.afterSplitSegmentCb({resultLine:i,exceedSegments:a});i=C.resultLine,a=C.exceedSegments;break}i.addSegment(s)}return{resultLine:i,exceedSegments:a}}},{key:"preSplitSegment",value:function(e){var t=this,i=[],n=e.text,a=void 0;return n.split(s.RuleRegExp).filter(function(e){return!!e}).forEach(function(n){(a=new r.default(n,e.fontProp)).setSize(t.segmentMeasurer.measure(a)),a.setWordType(a.detectWordType(n)),i.push(a)}),i}},{key:"beforeSplitSegmentCb",value:function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=!1,a=null,o=null;e instanceof g.default&&(n=!0,i?e.size.width>t?(a=e.hardSplit(this.segmentMeasurer,t).frontSegment,o=null):(a=e,o=null):(a=null,o=e));return{result:{frontSegment:a,backSegment:o},break:n}}},{key:"afterSplitSegmentCb",value:function(e){e.resultLine.lastSegment(),e.exceedSegments[e.exceedSegments.length-1];return e}}]),e}();t.default=d},1298:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(24)),a=s(i(0)),o=s(i(1));function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];(0,a.default)(this,e),this.segments=t}return(0,o.default)(e,[{key:"setOffsetX",value:function(e){this.offsetX=e}},{key:"setOffsetY",value:function(e){this.offsetY=e}},{key:"isEmpty",value:function(){return!this.segments.length}},{key:"lastSegment",value:function(){return this.segments[this.segments.length-1]}},{key:"addSegment",value:function(e){var t,i,a=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e instanceof Array?a?(t=this.segments).push.apply(t,(0,n.default)(e)):(i=this.segments).unshift.apply(i,(0,n.default)(e)):a?this.segments.push(e):this.segments.unshift(e)}},{key:"excludeEmptySegment",value:function(){1===this.segments.length&&this.segments[0].isEmpty()||(this.segments=this.segments.filter(function(e){return!e.isEmpty()}))}},{key:"getLineWidth",value:function(){return this.isEmpty()?0:this.segments.map(function(e){return e.size.width}).reduce(function(e,t){return t+e},0)}},{key:"getLineHeight",value:function(){if(this.isEmpty())return 19;var e=this.segments.map(function(e){return e.size.height});return Math.max.apply(Math,(0,n.default)(e))}},{key:"getLineText",value:function(){return this.segments.map(function(e){return e.text}).join("")}}]),e}();t.default=r},1299:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){(0,n.default)(this,e),this.measureCtx=this.prepareMeasureCtx(),this.measureDom=this.prepareMeasureDom(),this.cacheWidth={},this.cacheHeight={},this.measureCtx||console.error("ERROR:SegmentMeasurer - cannot get measureCtx!")}return(0,a.default)(e,[{key:"prepareMeasureCtx",value:function(){var e=document.createElement("canvas");return e.width=1,e.height=500,e.dir="ltr",e.getContext("2d")}},{key:"prepareMeasureDom",value:function(){var e=document.createElement("div");e.style.height="0px",e.style.overflow="hidden";var t=document.createElement("div");return t.style.whiteSpace="nowrap",t.style.wordWrap="normal",t.style.wordBreak="keep-all",t.innerText="fg\u6211",e.appendChild(t),document.body.appendChild(e),t}},{key:"measure",value:function(e){var t=this.getHeightByFontProp(e.fontProp),i=this.getTextWidthByFontProp(e.text,e.fontProp);return{width:this._toFixed2(i),height:this._toFixed2(t)}}},{key:"measureSpecifiedTextWidth",value:function(e,t){var i=this.getTextWidthByFontProp(e,t);return this._toFixed2(i)}},{key:"getHeightByFontProp",value:function(e){var t=0,i=e.getFontHeightHash();return void 0===this.cacheHeight[i]?(t=this._calcHeightByFontProp(e),this.cacheHeight[i]=t):t=this.cacheHeight[i],t}},{key:"_calcHeightByFontProp",value:function(e){var t=0;this.measureDom.style.fontFamily=e.fontFamily,this.measureDom.style.fontSize=e.fontSize+"pt";var i=this.measureDom.getBoundingClientRect();return t=Math.max(i.height,e.fontSize),t=this._toFixed2(t)}},{key:"hasEmoji",value:function(e){return!!e.match(["\ud83c[\udf00-\udfff]","\ud83d[\udc00-\ude4f]","\ud83d[\ude80-\udeff]"].join("|"))}},{key:"getTextWidthByFontProp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1],i=0;if(this.hasEmoji(e))i=this._calcTextWidthByFontProp(e,t);else for(var n=0;n<e.length;n++)i+=this.getCharWidthByFontProp(e[n],t);return i}},{key:"getCharWidthByFontProp",value:function(e,t){var i=0,n=t.getFontWidthHash();return void 0===this.cacheWidth[n]&&(this.cacheWidth[n]={}),void 0===this.cacheWidth[n][e]?(i=this._calcTextWidthByFontProp(e,t),this.cacheWidth[n][e]=i):i=this.cacheWidth[n][e],i}},{key:"_calcTextWidthByFontProp",value:function(e,t){var i=0;return this.measureCtx?(this.measureCtx.font=t.getStyle(),i=this.measureCtx.measureText(e).width):console.log("ERROR:SegmentMeasurer - cannot find measureCtx!"),i=this._toFixed2(i)}},{key:"_toFixed2",value:function(e){return"number"!==typeof e?(console.error("x is not a number"),0):Math.round(100*e)/100}}]),e}();t.default=s},1300:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(0)),a=c(i(1)),o=c(i(202)),s=i(1301),r=i(1302),l=i(21),h=i(10),g=c(i(8));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.stage.keymaster=o.default,this.currNs=null,this.formerCurrNs=null,this.initEvent(),this.initKeyboard()}return(0,a.default)(e,[{key:"initEvent",value:function(){var e=this;this.stage.event.eventMenu.listen("tableMenuShowed",function(t){e.formerCurrNs=e.currNs,e.currNs="menu",o.default.key.setScope(e.currNs)}),this.stage.event.eventMenu.listen("tableMenuHiden",function(t){"menu"===e.currNs&&(e.currNs=e.formerCurrNs||"cell",o.default.key.setScope(e.currNs),e.formerCurrNs=null)}),this.stage.event.eventSelection.listen("selectionShow",function(t){t&&t.show&&e._enterCellNs()}),this.stage.event.eventSelection.listen("selectionMove",function(){e._enterCellNs()}),this.stage.event.eventShape.listen("frameShow",function(){e._enterShapeNs()}),this.stage.event.eventInput.listen("inputShow",function(){e._enterInputNs(),e.stage.event.eventFormula.trigger("formulaErrorBoradHide")})}},{key:"initKeyboard",value:function(){this.initNsAll(),this.initNsCell(),this.initNsInput(),this.initNsShape()}},{key:"initNsAll",value:function(){var e=this.stage.configData.shortcutKeys.all;e&&e.length>0&&e.forEach(function(e){o.default.key(e.key,function(t){e.callback(t)})})}},{key:"initNsCell",value:function(){var e=this;o.default.key("ctrl+a, command+a","cell",function(t){e.isCursorEmpty()&&(t.preventDefault(),e.stage.selectAll())}),this.stage.configData.permissions&&((l.isFireFox||l.isSafari||l.isIE)&&this.stage.input.addEventListener("compositionstart",function(t){e.isCursorEmpty()&&e._onkeydown(t,"compositionstart")}),this.stage.input.addEventListener("keydown",function(t){e.isCursorEmpty()&&e._onkeydown(t,"keydown")})),this.stage.configData.permissions&&o.default.key("delete,backspace","cell",function(){e.isCursorEmpty()&&0===e.stage.tableData.inputStatus&&(e.stage.hookFunc.emptyCell&&e.stage.hookFunc.emptyCell(),e.stage.hookFunc.afterInput&&e.stage.hookFunc.afterInput(""))});var t=this.stage.configData.shortcutKeys.selection;t&&t.length>0&&t.forEach(function(t){o.default.key(t.key,"cell",function(i){e.isCursorEmpty()&&t.callback(i)})}),this.stage.configData.shortcutKeys.menu&&this.stage.configData.shortcutKeys.menu.forEach(function(e){o.default.key(e.key,"menu",function(t){return e.callback(t)})})}},{key:"initNsInput",value:function(){var e=this;o.default.key("enter","input",function(t){t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0),o.default.key.alt||o.default.key.command||o.default.key.ctrl||e._switchBackToOriginSheetIfNeeded(function(){e.stage.inputCenter.checkInputInitValueChange()||(e.stage.event.eventInput.trigger("inputHide"),o.default.key.shift?e.stage.event.eventSelection.trigger("selectionMove",{x:0,y:-1}):e.stage.event.eventSelection.trigger("selectionMove",{x:0,y:1}))})});var t=function(){g.default.tdwReport({opername:"doc_excel_editor",module:"excel_type",action:"type_direction_key"})};o.default.key("up","input",function(i){2!==e.stage.tableData.inputStatus&&3!==e.stage.tableData.inputStatus&&e._switchBackToOriginSheetIfNeeded(function(){e.stage.inputCenter.checkInputInitValueChange()||(e.stage.event.eventSelection.trigger("selectionMove",{x:0,y:-1}),e.stage.event.eventInput.trigger("inputHide"),t())})}),o.default.key("down","input",function(i){2!==e.stage.tableData.inputStatus&&3!==e.stage.tableData.inputStatus&&e._switchBackToOriginSheetIfNeeded(function(){e.stage.inputCenter.checkInputInitValueChange()||(e.stage.event.eventSelection.trigger("selectionMove",{x:0,y:1}),e.stage.event.eventInput.trigger("inputHide"),t())})}),o.default.key("left","input",function(i){2!==e.stage.tableData.inputStatus&&3!==e.stage.tableData.inputStatus&&e._switchBackToOriginSheetIfNeeded(function(){e.stage.inputCenter.checkInputInitValueChange()||(e.stage.event.eventSelection.trigger("selectionMove",{x:-1,y:0}),e.stage.event.eventInput.trigger("inputHide"),t())})}),o.default.key("right","input",function(i){2!==e.stage.tableData.inputStatus&&3!==e.stage.tableData.inputStatus&&(e.stage.inputCenter.checkInputInitValueChange()||e._switchBackToOriginSheetIfNeeded(function(){e.stage.event.eventSelection.trigger("selectionMove",{x:1,y:0}),e.stage.event.eventInput.trigger("inputHide"),t()}))}),o.default.key("tab","input",function(t){t&&t.preventDefault&&t.preventDefault(),e._switchBackToOriginSheetIfNeeded(function(){if(!e.stage.inputCenter.checkInputInitValueChange()){var t={};t=o.default.key.shift?{x:-1,y:0}:{x:1,y:0},e.stage.event.eventSelection.trigger("selectionMove",t),e.stage.event.eventInput.trigger("inputHide")}})}),o.default.key("esc",function(){e._switchBackToOriginSheetIfNeeded(function(){e.stage.tableData.inputStatus>0&&(e.stage.event.eventInput.trigger("inputHide",{discardValue:!0}),e.stage.event.eventSelection.trigger("selectionMove",{x:0,y:0}))})})}},{key:"initNsShape",value:function(){var e=this;o.default.key("up","shape",function(){e.stage.event.eventShape.trigger("frameMove",{x:0,y:-10})}),o.default.key("down","shape",function(){e.stage.event.eventShape.trigger("frameMove",{x:0,y:10})}),o.default.key("left","shape",function(){e.stage.event.eventShape.trigger("frameMove",{x:-10,y:0})}),o.default.key("right","shape",function(){e.stage.event.eventShape.trigger("frameMove",{x:10,y:0})}),o.default.key("delete,backspace","shape",function(){e.stage.event.eventShape.trigger("frameRemove"),e.stage.inputCenter.board.focus(),g.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_del"})});var t=this.stage.configData.shortcutKeys.shape;t&&t.length>0&&t.forEach(function(e){o.default.key(e.key,"shape",function(t){e.callback(t)})})}},{key:"_enterCellNs",value:function(){this.stage.selectData.selectStatus!==h.SELECT_STATUS.FORMULA&&"cell"!==this.currNs&&(this.currNs="cell",o.default.key.setScope("cell"))}},{key:"_enterShapeNs",value:function(){"shape"!==this.currNs&&(this.currNs="shape",o.default.key.setScope("shape"))}},{key:"_enterInputNs",value:function(){"input"!==this.currNs&&(this.currNs="input",o.default.key.setScope("input"))}},{key:"_onPadKeyup",value:function(e){(0,r.padKeyUp)(e)}},{key:"_needScrollForIpad",value:function(){var e=this.stage.inputCenter.board.xIndex,t=this.stage.inputCenter.board.yIndex,i=this.stage.tableData.getCellBackgroundWidth(t,e,!0),n=this.stage.tableData.getCellBackgroundHeight(t,e,!0),a=this.stage.areaData.col.flow.maxDistance,o=this.stage.areaData.row.flow.maxDistance;return!(i>a||n>o)}},{key:"_onkeydown",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"keydown";if(this.stage.configData.permissions)if("cell"===this.currNs){if(!((0,r.isMetaKeyByEvent)(e)||o.default.key.ctrl||o.default.key.command||e.metaKey||e.ctrlKey||e.altKey&&(18===e.keyCode||229===e.keyCode)||e.shiftKey&&(16===e.keyCode||229===e.keyCode&&"Process"!==e.key)||"CapsLock"===e.key||l.isSafari&&("Unidentified"===e.code||"Unidentified"===e.key))&&!(0,s.judgeShortcut)("pad",e)&&0===this.stage.tableData.inputStatus){this.stage.tableData.inputStatus=1;var n=null,a=!1;(l.isSafari&&"compositionstart"!==i||l.mac&&l.isFireFox&&"boolean"===typeof e.isComposing&&!e.isComposing&&"Process"!==e.key)&&("string"===typeof e.key||"number"===typeof e.key?(n=String(e.key),a=!0,e.preventDefault()):(n=null,a=!1)),this.stage.cells._makeCellVisiableByCell({x:this.stage.selectData.active.xIndex,y:this.stage.selectData.active.yIndex},function(){t.stage.event.eventInput.trigger("inputShow",{editValue:"",firstCharForQuickInput:n}),a&&t.stage.inputCenter.board.alloyRTE.changeCursor(n.length||1)})}}else this._scrolling||(this._scrolling=!0,this.stage.cells._makeCellVisiableByCell({x:this.stage.inputCenter.board.xIndex,y:this.stage.inputCenter.board.yIndex},function(){t._scrolling=!1}))}},{key:"isCursorEmpty",value:function(){return document.activeElement===this.stage.input||!(!document.activeElement||"CopyPasteDiv"!==document.activeElement.getAttribute("id")||window.showOfflineData||window.isRecordPreviewShowing)&&!1===this.stage.tableData.locking}},{key:"_switchBackToOriginSheetIfNeeded",value:function(e){var t=this;if(this.stage.inputCenter.board.isInOriginSheet())e();else{var i=this.stage.inputCenter.board.getOriginSheetId(),n=this.stage.hookFunc.getActiveSheetId();window.__core&&window.__core.event.sheetsBar.trigger("switchSheet",i,n,{onSuccess:function(){e&&e()},onFail:function(){t._switchBackToOriginSheetIfNeeded(e)}})}}}]),e}();t.default=d},1301:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.judgeShortcut=void 0;var n,a=i(9),o=(n=a)&&n.__esModule?n:{default:n};var s={pad:{"shift+space":function(e){return" "===e.key&&e.shiftKey&&!e.altKey&&!e.ctrlKey},"ctrl+shift+[=, -]":function(e){return("="===e.key||189===Number(e.keyCode))&&e.shiftKey&&e.ctrlKey},"ctrl+[l, m, r]":function(e){var t=Number(e.keyCode);return(76===t||77===t||82===t)&&e.ctrlKey&&!e.shiftKey&&!e.metaKey}},pc:{},app:{"shift+space":function(e){return" "===e.key&&e.shiftKey&&!e.altKey&&!e.ctrlKey},"ctrl+shift+[=, -]":function(e){return("="===e.key||189===Number(e.keyCode))&&e.shiftKey&&e.ctrlKey},"ctrl+[l, m, r]":function(e){var t=Number(e.keyCode);return(76===t||77===t||82===t)&&e.ctrlKey&&!e.shiftKey&&!e.metaKey},"[ctrl]+shift+[up, down, left, right]":function(e){return 0===e.keyCode&&e.shiftKey&&!e.metaKey&&!e.altKey},"command+option+[up, down, left, right]":function(e){return 0===e.keyCode&&!e.shiftKey&&e.altKey&&e.metaKey&&!e.ctrlKey}},mac:{}};t.judgeShortcut=function(e,t){return!!(0,o.default)(s[e]).find(function(i){return s[e][i](t)})}},1302:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KEY_CODES=void 0;var n,a=i(9),o=(n=a)&&n.__esModule?n:{default:n};t.isPrintableChar=function(e){return 32==e||e>=48&&e<=57||e>=96&&e<=111||e>=186&&e<=192||e>=219&&e<=222||e>=226||e>=65&&e<=90},t.padKeyUp=function(e){g(e)},t.isMetaKeyByEvent=function(e){var t=e.keyCode;return s.pad&&(t=function(e){if(0!==e.keyCode)return e.keyCode;switch(e.key){case"UIKeyInputRightArrow":return 39;case"UIKeyInputLeftArrow":return 37;case"UIKeyInputUpArrow":return 38;case"UIKeyInputDownArrow":return 40;case"UIKeyInputEscape":return 27}return function(e){var t=(0,o.default)(l).map(function(e){return{key:e,val:l[e]}}).find(function(t){var i=t.key,n=t.val;return e[i]&&!n||!e[i]&&n});return g(e),t?h[t.key]:e.keyCode}(e)||e.keyCode}(e)),c(t)},t.isMetaKey=c;var s=i(21);var r=t.KEY_CODES={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,S:83,V:86,Y:89,Z:90,F:70,H:72,SCRLK:144,NUMLK:145};var l={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1},h={shiftKey:16,ctrlKey:17,altKey:18,metaKey:91};function g(e){(0,o.default)(l).forEach(function(t){l[t]=!!e[t]})}function c(e){return-1!==[r.ARROW_DOWN,r.ARROW_UP,r.ARROW_LEFT,r.ARROW_RIGHT,r.HOME,r.END,r.DELETE,r.BACKSPACE,r.F1,r.F2,r.F3,r.F4,r.F5,r.F6,r.F7,r.F8,r.F9,r.F10,r.F11,r.F12,r.TAB,r.PAGE_DOWN,r.PAGE_UP,r.ENTER,r.ESCAPE,r.SHIFT,r.CAPS_LOCK,r.ALT,r.COMMAND_LEFT,r.CONTROL_LEFT,r.COMMAND_RIGHT,r.SCRLK,r.NUMLK].indexOf(e)}},1303:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(i(0)),a=s(i(1)),o=i(10);function s(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,n.default)(this,e),void 0!==t.alloyExcel?(this.stage=t.alloyExcel,this._hooks={}):console.error("AlloyExcelPlugin arguments error!!!")}return(0,a.default)(e,[{key:"addHook",value:function(e,t){switch(this._hooks[e]&&this.removeHook(e),e){case o.PLUGIN_HOOK.BEFORE_RENDER:this.stage.event.eventTable.listen("beforeRender",t);break;case o.PLUGIN_HOOK.AFTER_RENDER:this.stage.event.eventTable.listen("afterRender",t);break;case o.PLUGIN_HOOK.SELECTION_SHOW:this.stage.event.eventSelection.listen("selectionShow",t);break;case o.PLUGIN_HOOK.TABLE_MOVE:this.stage.event.eventTable.listen("tableMove",t);break;case o.PLUGIN_HOOK.ENTER_INPUT_STATUS:this.stage.event.eventTable.listen("enterInputStatus",t);break;case o.PLUGIN_HOOK.TABLE_MENU:this.stage.event.eventMenu.listen("tableMenuShow",t);break;case o.PLUGIN_HOOK.SCALE:this.stage.event.eventTable.listen("scale",t);break;default:return void console.warn("unsupport hook in alloyExcelPlugin")}this._hooks[e]=t}},{key:"removeHook",value:function(e){var t=this._hooks[e];if(void 0!==t){switch(e){case o.PLUGIN_HOOK.BEFORE_RENDER:this.stage.event.eventTable.remove("beforeRender",t);break;case o.PLUGIN_HOOK.AFTER_RENDER:this.stage.event.eventTable.remove("afterRender",t);break;case o.PLUGIN_HOOK.SELECTION_SHOW:this.stage.event.eventSelection.remove("selectionShow",t);break;case o.PLUGIN_HOOK.TABLE_MOVE:this.stage.event.eventTable.remove("tableMove",t);break;case o.PLUGIN_HOOK.ENTER_INPUT_STATUS:this.stage.event.eventTable.remove("enterInputStatus",t);break;case o.PLUGIN_HOOK.TABLE_MENU:this.stage.event.eventTable.remove("tableMenuShow",t);break;case o.PLUGIN_HOOK.SCALE:this.stage.event.eventTable.remove("scale",t);break;default:return void console.warn("unsupport hook in alloyExcelPlugin")}delete this._hooks[e]}else console.warn("remove a undefined hook in alloyExcelPlugin")}},{key:"removeAllHook",value:function(){var e=void 0;for(e in this._hooks)Object.prototype.hasOwnProperty.call(this._hooks,e)&&this.removeHook(e)}}]),e}();t.default=r},1304:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(3)),a=c(i(0)),o=c(i(1)),s=c(i(4)),r=c(i(59)),l=c(i(5)),h=c(i(687)),g=i(10);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){switch(/String/.test(Object.prototype.toString.call(this.dom))&&(this.dom=function(e){var t=document.createElement("div");return t.innerHTML=e,t.childNodes}(this.dom)),this.locateType){case g.PLUGIN_LOCATE_TYPE.GLOBAL:this.stage.pluginGlobalBoard.append(this.dom);break;case g.PLUGIN_LOCATE_TYPE.BODY:this.stage.pluginBodyBoard.append(this.dom);break;default:console.error("unknown locateType: ",this.locateType)}}},{key:"destroy",value:function(){switch(this._removeStopPropagation(this.stopPropagationSlots),this.locateType){case g.PLUGIN_LOCATE_TYPE.GLOBAL:this.stage.pluginGlobalBoard.remove(this.dom);break;case g.PLUGIN_LOCATE_TYPE.BODY:this.stage.pluginBodyBoard.remove(this.dom)}(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"removeAllHook",this).call(this)}},{key:"_addStopPropagation",value:function(e){var t=void 0;for(t=0;e>0;e>>=1,t++)if(1===(1&e))switch(t){case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_DOWN:this.dom.addEventListener("mousedown",u);break;case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_UP:this.dom.addEventListener("mouseup",u);break;case g.PLUGIN_EVENT_STOP.SLOT_CLICK:this.dom.addEventListener("click",u);break;case g.PLUGIN_EVENT_STOP.SLOT_DBLCLICK:this.dom.addEventListener("dblclick",u);break;case g.PLUGIN_EVENT_STOP.SLOT_CONTEXTMENU:this.dom.addEventListener("contextmenu",u);break;case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_MOVE:this.dom.addEventListener("mousemove",u)}}},{key:"_removeStopPropagation",value:function(e){var t=void 0;for(t=0;e>0;e>>=1,t++)if(1===(1&e))switch(t){case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_DOWN:this.dom.removeEventListener("mousedown",u);break;case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_UP:this.dom.removeEventListener("mouseup",u);break;case g.PLUGIN_EVENT_STOP.SLOT_CLICK:this.dom.removeEventListener("click",u);break;case g.PLUGIN_EVENT_STOP.SLOT_DBLCLICK:this.dom.removeEventListener("dblclick",u);break;case g.PLUGIN_EVENT_STOP.SLOT_CONTEXTMENU:this.dom.removeEventListener("contextmenu",u);break;case g.PLUGIN_EVENT_STOP.SLOT_MOUSE_MOVE:this.dom.removeEventListener("mousemove",u)}}},{key:"changeStopPropagationSlots",value:function(e){if(void 0!==e&&e!==this.stopPropagationSlots){var t=void 0;t=this.stopPropagationSlots&(g.PLUGIN_EVENT_STOP.SLOT_ALL^e),this._removeStopPropagation(t),t=e^this.stopPropagationSlots^t,this._addStopPropagation(t)}}}]),t}(h.default);function u(e){e.stopPropagation()}t.default=d},1305:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(i(3)),a=h(i(0)),o=h(i(1)),s=h(i(4)),r=h(i(59)),l=h(i(5));function h(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,a.default)(this,t);var i=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return i.lastCell={x:-1,y:-1},i.mouseMoveOffsetY=0,i.button=null,i}return(0,l.default)(t,e),(0,o.default)(t,[{key:"mousedown",value:function(e){var i=e.clientX-this.stage.configData.distanceX,a=e.clientY-this.stage.configData.distanceY;this.button=e.button,(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"start",this).call(this,i,a)}},{key:"mousemove",value:function(e){var i=e.clientX-this.stage.configData.distanceX,a=e.clientY-this.stage.configData.distanceY;(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"move",this).call(this,i,a)}},{key:"mouseup",value:function(e){var i=e.clientX-this.stage.configData.distanceX,a=e.clientY-this.stage.configData.distanceY;this.button=null,(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"end",this).call(this,i,a)}}]),t}(h(i(1306)).default);t.default=g},1306:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.startX=0,this.startY=0,this.currX=0,this.currY=0,this._globalX=0,this._globalY=0,this.diffX=0,this.diffY=0,this.startTime=0,this.endTime=0,this.protect=0,this.response=[],this.stopSelect=!1}return(0,a.default)(e,[{key:"start",value:function(e,t){this.response.length=0,this.stopSelect=!1,this.startX=e,this.startY=t,this.currX=e,this.currY=t,this._globalX=e+this.stage.configData.distanceX,this._globalY=t+this.stage.configData.distanceY,this.down=!0,this.startTime=Date.now()}},{key:"move",value:function(e,t){this.protect=Date.now(),this.move=!0;var i=e+this.stage.configData.distanceX,n=t+this.stage.configData.distanceY;this.diffX=i-this._globalX,this.diffY=n-this._globalY,this.currX=e,this.currY=t,this._globalX=i,this._globalY=n}},{key:"end",value:function(e,t){this.currX=e,this.currY=t,this.down=!1,this.move=!1,this.endTime=Date.now()}}]),e}();t.default=s},1307:function(e,t,i){"use strict";CanvasRenderingContext2D.prototype.roundRect=function(e,t,i,n,a){return i<2*a&&(a=i/2),n<2*a&&(a=n/2),this.beginPath(),this.moveTo(e+a,t),this.arcTo(e+i,t,e+i,t+n,a),this.arcTo(e+i,t+n,e,t+n,a),this.arcTo(e,t+n,e,t,a),this.arcTo(e,t,e+i,t,a),this.closePath(),this},CanvasRenderingContext2D.prototype.setLineDash||(CanvasRenderingContext2D.prototype.setLineDash=function(){})},1412:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(i(0)),a=c(i(1)),o=c(i(680)),s=c(i(285)),r=c(i(681)),l=c(i(682)),h=c(i(684)),g=c(i(685));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,n.default)(this,e);var i=t.parent||document,a=t.className||"";this._initEditor(i,a);var c=function(){};this.hooks={undoRedoStateChange:t.undoRedoStateChange||c,exitHandler:t.exitHandler||c,valueChange:t.valueChange||c,selectionChange:t.selectionChange||c,blur:t.blurHandler||c},this.platform=t.platform||"PC",this.env=g.default,this.textService=new o.default(this),this.selection=new s.default(this),this.clipboard=new r.default(this),this.keyBoard=new l.default(this),this.history=new h.default(this,h.default.DEFAULTS)}return(0,a.default)(e,[{key:"attachEventToInput",value:function(e,t){this.input.addEventListener(e,t)}},{key:"clear",value:function(){this.setText(""),this.history.clear()}},{key:"hasFocus",value:function(){return this.selection.hasFocus()}},{key:"focus",value:function(){this.selection.focus()}},{key:"blur",value:function(){this.selection.blur()}},{key:"save",value:function(){this.history.save()}},{key:"setText",value:function(e){this.textService.setData(e||"")}},{key:"getText",value:function(){return this.getData()}},{key:"getData",value:function(){return this.textService.getData()}},{key:"getContent",value:function(){return this.textService.getTextContent()}},{key:"getSelection",value:function(){return this.selection.getRange()}},{key:"setSelection",value:function(e){this.focus(),this.selection.setRange(e)}},{key:"_initEditor",value:function(e,t){this.input=document.createElement("div"),this.input.classList.add(t),this.input.setAttribute("id","alloy-simple-text-editor"),this.input.setAttribute("contenteditable",!0),this.input.style["white-space"]="pre-wrap",this.input.setAttribute("tabindex",1),e.appendChild(this.input)}},{key:"updateContent",value:function(e){this.textService.setTextContent(e),this.valueChange()}},{key:"getCurrentState",value:function(){var e=this.getSelection();return{content:this.getText(),selection:e}}},{key:"selectionChange",value:function(){}},{key:"valueChange",value:function(){var e=this.getText();this.selectionChange(),this.hooks.valueChange(e)}},{key:"insertNewLine",value:function(){this.selection.removeFillingCharNode();var e=this.input.lastChild;if(!e||"BR"!==e.nodeName){var t=document.createElement("br");t.className="extra",this.input.appendChild(t)}this.textService.doLineBreak(),this.history.save(!0),this.history.refreshState(),this.selectionChange(),this.valueChange()}}]),e}();t.default=d},166:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={mode:(t.MODE_FROZEN_MOBILE={GOOGLE:0,SHIMO:1}).SHIMO,leftMargin:100};t.default=n},192:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rgbaTorgb=t.decimalNumberToRGBColor=t.isEquivalent=t.removeFillingCharString=t.createFillingCharNode=t.createText=t.FillingCharRegExp=t.FillingCharLength=t.FillingChar=t.SHORTKEY=void 0;var n,a=i(248),o=(n=a)&&n.__esModule?n:{default:n};var s=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",r="\ufeff",l=r.length,h=new RegExp(r+"( )?","g");function g(e,t){t=t||document;var i=null;return"string"===typeof e&&(i=t.createTextNode(e)),i}t.SHORTKEY=s,t.FillingChar=r,t.FillingCharLength=l,t.FillingCharRegExp=h,t.createText=g,t.createFillingCharNode=function(){return g(r)},t.removeFillingCharString=function(e){return e=e||"",arguments.length>1&&void 0!==arguments[1]&&arguments[1]?e.replace(h,function(e,t){return t?"\xa0":""}):e.replace(r,"")},t.isEquivalent=function(e,t){if(e&&t){var i=(0,o.default)(e),n=(0,o.default)(t);if(i.length!=n.length)return!1;for(var a=0;a<i.length;a++){var s=i[a];if(e[s]!==t[s])return!1}return!0}return!1},t.decimalNumberToRGBColor=function(e){var t=function(e){return[255&e,(65280&e)>>8,(16711680&e)>>16]}(e);return"rgb("+t[0]+","+t[1]+","+t[2]+")"},t.rgbaTorgb=function(e){if("string"!==typeof e)return e;var t=e.match(/^rgba?[\s+]?\([\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?,[\s+]?(\d+)[\s+]?/i);return t&&4===t.length?"rgb("+t[1]+", "+t[2]+", "+t[3]+")":e}},202:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(9),o=((n=a)&&n.__esModule,i(21));i(22);var s=function(){var e={},t=void 0,i={},n={16:!1,18:!1,17:!1,91:!1},a="all",s={"\u21e7":16,shift:16,"\u2325":18,alt:18,option:18,"\u2303":17,ctrl:17,control:17,"\u2318":91,command:91},r={backspace:8,tab:9,clear:12,enter:13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,home:36,end:35,pageup:33,pagedown:34,",":188,".":190,"/":191,"`":192,"-":189,"+":187,"=":187,";":186,"'":222,"[":219,"]":221,"\\":220,ctrl:17,command:91,NumpadAdd:107,NumpadSubtract:109,Numpad0:45,F11:122},l=function(e){return r[e]||e.toUpperCase().charCodeAt(0)},h=[],g=[];for(t=1;t<20;t++)r["f"+t]=111+t;function c(e,t){for(var i=e.length;i--;)if(e[i]===t)return i;return-1}function d(e,t){if(e.length!=t.length)return!1;for(var i=0;i<e.length;i++)if(e[i]!==t[i])return!1;return!0}var u={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey"};function f(e){for(t in n)n[t]=e[u[t]]}function v(e,t,n){var a=void 0,o=void 0;a=C(e),void 0===n&&(n=t,t="all");for(var s=0;s<a.length;s++)o=[],(e=a[s].split("+")).length>1&&(o=p(e),e=[e[e.length-1]]),(e=e.length>0&&l(e[0]))in i||(i[e]=[]),i[e].push({shortcut:a[s],scope:t,method:n,key:a[s],mods:o})}for(t in s)v[t]=!1;function A(){return a||"all"}function C(e){var t=void 0;return""==(t=(e=e.replace(/\s/g,"")).split(","))[t.length-1]&&(t[t.length-2]+=","),t}function p(e){for(var t=e.slice(0,e.length-1),i=0;i<t.length;i++)t[i]=s[t[i]];return t}function I(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent&&e.attachEvent("on"+t,function(){i(window.event)})}I(document,"keydown",function(e){!function(e){var t,a=void 0,r=void 0,g=void 0,d=void 0,C=void 0;if(a=e.keyCode,-1==c(h,a)&&h.push(a),o.isSafari&&229==e.keyCode)for(g in n)if(e[u[g]]){a=Number(g);break}if(o.isSafari&&"+"===e.key&&(a=187),o.isFireFox&&"="===e.key&&(a=l(e.key)),o.isFireFox&&"-"===e.key&&(a=l(e.key)),o.isFireFox&&";"===e.key&&(a=l(e.key)),93!=a&&224!=a||(a=91),a in n){for(g in s)s[g]==a&&(v[g]=!0);if(n[a])return;n[a]=!0}var p=e.altKey||e.shiftKey||e.metaKey||e.ctrlKey;if((!document.activeElement||"alloy-rich-text-editor"===document.activeElement.id||p||9!==a&&37!==a&&39!==a)&&(f(e),v.filter.call(this,e)&&a in i))for(t=A(),d=0;d<i[a].length;d++)if((r=i[a][d]).scope==t||"all"==r.scope){for(g in C=r.mods.length>0,n)(!n[g]&&c(r.mods,Number(g))>-1||n[g]&&-1==c(r.mods,Number(g)))&&(C=!1);(0==r.mods.length||C)&&!1===r.method(e,r)&&(e.preventDefault?e.preventDefault():e.returnValue=!1,e.stopPropagation&&e.stopPropagation(),e.cancelBubble&&(e.cancelBubble=!0))}}(e)}),I(document,"keyup",function(e){var t=e.keyCode,i=void 0,a=c(h,t);for(i in a>=0&&h.splice(a,1),93!=t&&224!=t||(t=91),t in n?n[t]=!1:f(e),s)v[i]=n[s[i]]}),I(window,"focus",function(){for(t in n)n[t]=!1;for(t in s)v[t]=!1});var m=e.key;return e.key=v,e.key.setScope=function(e){a=e||"all"},e.key.getScope=A,e.key.deleteScope=function(e){var t=void 0,n=void 0,a=void 0;for(t in i)for(n=i[t],a=0;a<n.length;)n[a].scope===e?n.splice(a,1):a++},e.key.filter=function(e){var t=(e.target||e.srcElement).tagName,i=e.target.getAttribute("id");return"CopyPasteDiv"===i||g.indexOf(i)>=0||!("INPUT"==t||"SELECT"==t||"TEXTAREA"==t)},e.key.addNotFilter=function(e){-1===g.indexOf(e)&&g.push(e)},e.key.isPressed=function(e){return"string"===typeof e&&(e=l(e)),-1!=c(h,e)},e.key.getPressedKeyCodes=function(){return h.slice(0)},e.key.noConflict=function(){var t=e.key;return e.key=m,t},e.key.unbind=function(e,t){var n=void 0,a=void 0,o=[],s=void 0,r=void 0,h=void 0;for(n=C(e),r=0;r<n.length;r++){if((a=n[r].split("+")).length>1&&(o=p(a)),e=a[a.length-1],e=l(e),void 0===t&&(t=A()),!i[e])return;for(s=0;s<i[e].length;s++)(h=i[e][s]).scope===t&&d(h.mods,o)&&(i[e][s]={})}},e}();t.default=s},205:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MentionLabelAndTrianglePadding=t.MentionTriangleHeight=t.MentionTriangleWidth=t.MentionInnerLeftRightPadding=t.MentionOuterPadding=t.MentinoRadius=t.MentionHeight=t.MENTION_STATUS=void 0;var n=h(i(3)),a=h(i(0)),o=h(i(1)),s=h(i(4)),r=h(i(5)),l=h(i(386));function h(e){return e&&e.__esModule?e:{default:e}}var g=t.MENTION_STATUS=void 0;!function(e){e[e.HIGHTLIGHT=0]="HIGHTLIGHT",e[e.NORMAL=1]="NORMAL",e[e.HOVER=2]="HOVER"}(g||(t.MENTION_STATUS=g={}));var c=function(e){function t(e,i,o,r){(0,a.default)(this,t);var l=(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,i));return l.mentionInfo=o,l.mentionStatus=r||g.NORMAL,l}return(0,r.default)(t,e),(0,o.default)(t,[{key:"setSize",value:function(e){this.size.width=18+e.width+4+8,this.size.height=24}},{key:"clone",value:function(){return new t(this.text,this.fontProp,this.mentionInfo)}},{key:"setMentionSegmentStatus",value:function(e){this.mentionStatus=e}}]),t}(l.default);t.default=c,t.MentionHeight=22,t.MentinoRadius=11,t.MentionOuterPadding=1,t.MentionInnerLeftRightPadding=8,t.MentionTriangleWidth=8,t.MentionTriangleHeight=5,t.MentionLabelAndTrianglePadding=4},21:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=t.supportsPassive=t.isIphoneX=t.getSoftKeyboardHeight=t.macCmdAndWinCtrl=t.placeholderImageSrc=t.isElement=t.Linear=t.findNextShowCol=t.findNextShowRow=t.isColShow=t.isRowShow=t.isNumber=t.isUndefinedOrNull=t.isNull=t.isUndefined=t.isString=t.binarySearch=t.CTRL=t.getRangeName=t.getColIndex=t.getColName=t.colIndexToName=t.colName=t.getCursorPosition=t.setEditorCursorPosition=t.setCursorPosition=t.keepLastIndex=t.formatChinese=t.safeStr=t.getElementTop=t.checkPadType=t.checkIsIphoneX=t.isPortrait=t.isEdge=t.isFireFox=t.isSafari=t.isIE=t.px2pt=t.pt2px=t.lengthRangeToArray=t.pad=t.chrome=t.mac=t.android=t.ios=t.addTap=t.checkIsIn=t.arrayToRange=t.mapDelete=t.mapInsert=t.rangeDelete=t.rangeInsert=t.isCrossRange=t.isInRange=t.ease=t.findPosition=void 0;var n=r(i(25)),a=r(i(202)),o=i(200),s=r(i(12));function r(e){return e&&e.__esModule?e:{default:e}}var l=navigator.userAgent,h=l.match(/((iPhone\sOS)\s([\d_]+))|iPad/),g=l.match(/(Android)\s+([\d.]+)/),c=l.match(/Mac\sOS\sX/i),d=/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor),u=!!navigator.userAgent.match(/iPad/i),f=document.createElement("div");f.style.width="1in",f.style.height="hidden",document.body.appendChild(f);var v=f.offsetWidth;document.body.removeChild(f);var A=c?"command":"ctrl",C=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];function p(e){return C[e]}var I=function(){var e=void 0,t=void 0,i=void 0;function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments[1];for(var i in t=t||{"\uff1d":"=","\uff0c":",","\uff08":"(","\uff09":")"})if({}.hasOwnProperty.call(t,i)){var n=new RegExp(i,"g");e=e.replace(n,t[i])}return e}return function(a,o){return e===a&&i===o||(e=a,i=o,t=a.replace(/([^"]*)("[^"]*"|\s?)([^"]*)/g,function(e,t,i,a){return(t=n(t,o))+i+(a=n(a,o))})),t}}();function m(){return-1!==navigator.userAgent.indexOf("msie")||-1!==navigator.userAgent.indexOf("rv:11")||!!window.ActiveXObject||"ActiveXObject"in window}var y=-1!==navigator.userAgent.indexOf("Mac")&&-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome"),w=navigator.userAgent.indexOf("Firefox")>-1,x=navigator.userAgent.indexOf("Edge")>-1;function b(e,t,i,n,a){var o=t.width*a*i,s=t.width*a*(1-i);return void 0!==i&&(!(e-o<n.min)&&!(e+s>n.max))}function R(e,t,i){return e-t>=i}function E(e,t,i){return e+t<=i}function _(){return!(!navigator.userAgent.match(/(iPhone)/)||!(812==screen.availHeight&&375==screen.availWidth||375==screen.availHeight&&812==screen.availWidth))}window.__count=0;var D=_();var T=function(){var e=function(){if(navigator.userAgent.match(/(iPad)/)){if(1366==screen.availHeight&&screen.availWidth>=1004||screen.availHeight>=1004&&1366==screen.availWidth)return"PADPRO";if(768==screen.availHeight&&1024==screen.availWidth||1024==screen.availHeight&&768==screen.availWidth)return"PAD"}};return e.PADPRO="PADPRO",e.PAD="PAD",e}();function S(){if("number"===typeof window.orientation)return window.orientation/90%2===0;try{var e=window.screen.orientation.angle;if("number"===typeof e)return e/90%2===0}catch(t){}return!0}function k(e){return"[object Undefined]"===Object.prototype.toString.call(e)}function L(e){return"[object Null]"===Object.prototype.toString.call(e)}function M(e,t){return!e||!(e.hideRowMap&&e.hideRowMap[t]||e.filterHideRowMap&&e.filterHideRowMap[t])}function O(e,t){return!(e&&e.hideColMap&&e.hideColMap[t])}var F=!1;try{var H=Object.defineProperty({},"passive",{get:function(){t.supportsPassive=F=!0}});window.addEventListener("test",null,H),window.removeEventListener("test",null,H)}catch(B){}t.findPosition=function(e,t,i,n){var a=void 0,o=void 0,s=void 0,r=void 0,l=void 0;void 0===n.sourceXPoint&&(n.sourceXPoint=[.5]),void 0===n.targetXPoint&&(n.targetXPoint=[.2,.3,.4,.5,.6,.7,.8]),void 0===n.scale&&(n.scale=1);for(var h=!1,g=n.sourceXPoint[0],c=void 0,d=-1,u=e.left+g*e.width;!h&&d<=n.targetXPoint.length;)d++,h=b(u,t,c=n.targetXPoint[d],i.x,n.scale);return h?(l=c,a=e.left+e.width*n.sourceXPoint[0]-c*t.width,r=0):g>.8?e.left+e.width>=i.x.max?(a=i.x.max-t.width,l=.8,r=1):(a=i.x.min,l=.2,r=-1):g<.2?e.left<=i.x.min?(a=i.x.min,l=.2,r=-1):(a=i.x.max-t.width,l=.8,r=1):Math.abs(e.left)-i.x.min<i.x.max-Math.abs(e.left)?(a=i.x.min,l=.2,r=-1):(a=i.x.max-t.width,l=.8,r=1),void 0===n.yPriority&&(n.yPriority=-1),h=!1,n.yPriority<0&&((h=R(e.top,t.height,i.y.min))?(o=e.top-t.height-4,s=-1):(h=E(e.top+e.height,t.height,i.y.max))?(o=e.top+e.height+4,s=1):e.top>i.y.max/2?(o=e.top-t.height-4,s=-1):(o=e.top+e.height+4,s=1)),n.yPriority>0&&((h=E(e.top+e.height,t.height,i.y.max))?(o=e.top+e.height+4,s=1):(h=R(e.top,t.height,i.y.min))?(o=e.top-t.height-4,s=-1):e.top>i.y.max/2?(o=e.top-t.height-4,s=-1):(o=e.top+e.height+4,s=1)),{left:a,top:o,yDir:s,xDir:r,xArrow:l}},t.ease=function(e){return Math.sqrt(1-Math.pow(e-1,2))},t.isInRange=function(e,t){var i=t[0],n=t[1];return e>=i&&e<=n},t.isCrossRange=function(e,t){return e[0]>=t[0]&&e[0]<=t[1]||t[0]>=e[0]&&t[0]<=e[1]},t.rangeInsert=function(e,t,i){var n=!1;return e[0]>=t?(e[0]+=i,e[1]+=i,n=!0):e[1]>=t&&(e[1]+=i,n=!0),n},t.rangeDelete=function(e,t,i){var n=!1;return t<=e[0]?(e[0]=Math.max(t,e[0]-i),e[1]=e[1]-i,n=!0):t<=e[1]&&(e[1]=Math.max(t-1,e[1]-i),n=!0),n},t.mapInsert=function(e,t,i){var n={},a=void 0,o=void 0;for(a in e)isNaN(a)||((o=parseInt(a))>=t&&(o+=i),n[o]=e[a]);return n},t.mapDelete=function(e,t,i){var n={},a=void 0,o=void 0;for(a in e)if(!isNaN(a)){if((o=parseInt(a))>=t){if(a<=t+i-1)continue;o-=i}n[o]=e[a]}return n},t.arrayToRange=function(e){var t=[],i=void 0,n=e[0];if(0===e.length)return t;for(i=1;i<=e.length;i++){if(i===e.length){t.push([+n,+e[i-1]]);break}e[i]-e[i-1]===1||(t.push([+n,+e[i-1]]),n=e[i])}return t},t.checkIsIn=function(e,t){return e.x>t[0]&&e.y>t[1]&&e.x<t[0]+t[2]&&e.y<t[1]+t[3]},t.addTap=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.addEventListener("touchstart",function(t){var i=t.touches[0];this.touchX=i.clientX,this.touchY=i.clientY,this.touchT=Date.now(),this.longTapTick=s.default.wait(500).run(function(){if(e.onLongTap)e.onLongTap();else{var t=document.createEvent("HTMLEvents");t.initEvent("longTap",!1,!0),e.dispatchEvent(t)}})}),e.addEventListener("touchmove",function(e){e.preventDefault();var t=e.touches[0],i=parseInt(t.clientX),n=parseInt(t.clientY);(Math.abs(n-this.touchY)>30||Math.abs(i-this.touchX)>30)&&s.default.erase(this.longTapTick)}),e.addEventListener("touchend",function(i){var n=i.changedTouches[0],a=n.clientX,o=n.clientY;if(s.default.erase(this.longTapTick),!(void 0===this.touchT||Math.abs(o-this.touchY)>30||Math.abs(a-this.touchX)>30)&&!(i.touches.length>0)){if(Date.now()<=this.touchT+250)if(e.ontap)e.ontap();else{var r=document.createEvent("HTMLEvents");r.initEvent("tap",!1,!0),r.x=a,r.y=o,r.originEvent=i,e.dispatchEvent(r)}t.preventDefault&&i.preventDefault(),t.stopPropagation&&i.stopPropagation()}})},t.ios=h,t.android=g,t.mac=c,t.chrome=d,t.pad=u,t.lengthRangeToArray=function(e){for(var t=[],i=0,n=void 0,a=e.length,o=void 0;i<a;i++)if("string"===typeof(o=e[i]))t.push(+o);else if("number"===typeof o)t.push(o);else for(n=0;n<o[1];n++)t.push(o[0]+n);return t},t.pt2px=function(e){return Math.round(e*v/72)},t.px2pt=function(e){return Math.round(72*e/v)},t.isIE=m,t.isSafari=y,t.isFireFox=w,t.isEdge=x,t.isPortrait=S,t.checkIsIphoneX=_,t.checkPadType=T,t.getElementTop=function(e){for(var t=e.offsetTop,i=e.offsetParent;null!==i;)t+=i.offsetTop,i=i.offsetParent;return t},t.safeStr=function(e){return e.replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")},t.formatChinese=I,t.keepLastIndex=function(e,t,i){var n=void 0,a=void 0;if(window.getSelection){if(e.focus(),n=window.getSelection(),t){if(y){if(a=document.createRange(),0===e.innerText.length)return;return a.setStart(e.childNodes[0],e.innerText.length),a.collapse(!0),n.removeAllRanges(),void n.addRange(a)}if(n.selectAllChildren(t),1===t.innerText.length&&65279===t.innerText.charCodeAt(0))return void n.collapseToStart()}else{if(y)return;n.selectAllChildren(e)}try{n.collapseToEnd()}catch(B){console.log(B)}}else document.selection&&((a=document.selection.createRange()).moveToElementText(e),a.collapse(!1),a.select())},t.setCursorPosition=function(e,t){if(e.setSelectionRange)e.focus(),e.setSelectionRange(t,t);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",t),i.moveStart("character",t),i.select()}},t.setEditorCursorPosition=function(e,t,i){var n=null,a=t;if(i&&"normal"===i.textWrap){for(var o=e.childNodes,s=o.length-1;s>=0;s--)if("#text"===o[s].nodeName){a=(n=o[s]).length;break}}else e.childNodes&&e.childNodes[0]&&"#text"===e.childNodes[0].nodeName&&(n=e.childNodes[0],a=Math.min(n.length,t));if(n){var r=window.getSelection(),l=document.createRange();try{l.setStart(n,a)}catch(B){a-=1,l.setStart(n,a)}l.setEnd(n,a),r.removeAllRanges(),r.addRange(l)}},t.getCursorPosition=function(){var e=void 0,t=void 0,i=void 0,n=void 0,a=void 0,o=void 0,s=void 0;if(window.getSelection){for(a=t=(e=window.getSelection()).focusNode,i=e.anchorOffset,t&&t.nodeValue&&65279===t.nodeValue.charCodeAt(0)&&(i=(i-=1)>=0?i:0);a&&(1!==a.nodeType||!a.hasAttribute("contenteditable"));)a=a.parentNode;if(!a)return 0;for(n=s=0,o=a.childNodes;o[s]!==t&&void 0!==o[s];)3===o[s]&&(n+=o[s].nodeValue.length),s++;n+=i}return n||0},t.colName=C,t.colIndexToName=function(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()},t.getColName=p,t.getColIndex=function(e){return C.indexOf(e)},t.getRangeName=function(e){var t=e.xRange,i=e.yRange,n=e.selectRow,a=e.selectCol,o=e.selectAll;return[(n||o?"":p(t[0]))+(a&&!o?"":parseInt(i[0],10)+1),(n||o?"":p(t[1]))+(a&&!o?"":parseInt(i[1],10)+1)]},t.CTRL=A,t.binarySearch=function(e,t){for(var i=0,n=t.length-1;i<=n;){var a=parseInt(i+(n-i)/2);if(e===t[a])return a;e>t[a]?i=a+1:n=a-1}return i},t.isString=function(e){return"[object String]"===Object.prototype.toString.call(e)},t.isUndefined=k,t.isNull=L,t.isUndefinedOrNull=function(e){return k(e)||L(e)},t.isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)},t.isRowShow=M,t.isColShow=O,t.findNextShowRow=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.row.length,a=void 0;if(t=Math.max(-1,t),t=Math.min(n,t),i>0)a=function(){return t<n-1};else{if(!(i<0))return void console.warn("invalid arguments in findNextShowRow");a=function(){return t>0}}if(e)for(;a();)if(M(e,t+=i))return t;return null},t.findNextShowCol=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,n=e.col.length,a=void 0;if(t=Math.max(-1,t),t=Math.min(n,t),i>0?a=function(){return t<n-1}:i<0?a=function(){return t>0}:console.warn("invalid arguments in findNextShowCol"),e)for(;a();)if(O(e,t+=i))return t;return null},t.Linear=function(e,t,i,n,a){if(e!=t&&"number"==typeof e){t=t||0,i=i||2;var o=5;(m()||w)&&(i/=2,o*=2);var s=e;!function r(){s+=(t-e)/i,Math.abs(s)>Math.abs(t)-o?a(t):(n(s),requestAnimationFrame(r))}()}},t.isElement=function(e){try{return e instanceof HTMLElement}catch(B){return"object"===("undefined"===typeof e?"undefined":(0,n.default)(e))&&1===e.nodeType&&"object"===(0,n.default)(e.style)&&"object"===(0,n.default)(e.ownerDocument)}},t.placeholderImageSrc="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAACcCAMAAAANmRRNAAAAV1BMVEW7u7u7u7u7u7sAAAD///+7u7v9/f2+vr74+PjDw8POzs7o6OjR0dHz8/P6+vrw8PDf39/IyMji4uL19fXk5OTV1dXAwMDt7e3FxcXT09Pc3NzKysrZ2dlJiXC2AAAABHRSTlPxrSYAnzdaTwAABDJJREFUeNrs2A2OmzAQhmGSnc82xkCA8Jvc/5ytqiqKgHYhjGGs5bnBq8HInujreongnaORJxhFl+tXdI2wg4JGjAan3xkX7CGmsRqsLlGEXSgaqcBqrw4YGuvBaq+QnMZSMNovJKEJBz77hZQ0kYPPfiEDTVmw2S+kJ78jeQ+hAJ0h0pwh0pwh0pwh0pwh0pwh0pwh0pwh0pwh0vzYEHOzsdadvVUky7oQ0+OlNyTJqpBE441OSJA1ISVGSpJjRUiCCUEzWR5iNCa0nHOyPKTHDEdSLA4xmCVmJItDbph1I26qLr2GWMyy7B09MPgMiTEr5u5wAFArfyEaszRzh8UfToUdkj3w1yML+dPKCrwUJtzDbgq86apQf7+mGw079RJSYVZFXKoYI03uI4Sc3ytKGmNCt+FdGtMGc+6hXePzBvNKnw8r/pPeavzLENJT99Uxp1Y+lg8OL84Qk0Tjf5zytQ4CYs510B3fsCqIBd0d3ypMACElFuiM+JAbFolT4SFPLNTkokNqLKZbuSGqxwo6kRqiHNYpZYYoi7UGiSHKYr1aiQvJHviEU8JCsgKfsUpUiOnwqSITFLKhA+iMmJAqxhZxKiQkbbBNk4sI2dwB6FZASK6xnU4OD2k1WJTrQsR2AMOhIYkGm6c6LuQOTk4dFVKClz0opAI3lhBDaz1Fhvxq72ySG4TBGJp2Ihvnh4TGIQRy/3N2kUU6Ax5QR+bzgneDt9AAEuBL+yI9XFuiyMPTG3IEyhM5eoDdkAcApYlEvDkQJme8KUnk0w4ONV9hoRiRFz4sXsOdx4ciRNwdfwm3f10M7UVGrdrCNbzBPHoRoo1auIZfQKATYVqcZWv4EwQ6EbL9mF9Faw8CnQjdfkRJ1PUi5KiP2cW9A4FQhH5Kndn1HyDQivBPqXeXFjlBgEgkYo5T0qQCgVyET+shZXKFAI1Ij3mSt5AuQIBCxN2xhNQt5BEcehF+tAw3xd9b9CL82BfOivJEL8KPfe3IpIcAgUgDCl9pyhO9CDh6UdStRdpaU56Yi1xF5Ym1SHCantRc5EdUnliLBKfpSc1Foqg8sRZpnKZ0MBc57ke4DjzWIsNkd+3BYi7yEM0i5iJR1M2Zi/jzlAcfE3MRdG4viYm5CJ6intFcBLHgXgsEqZjUARzmIujqSZNLAW08OE6imJiL4EcUE3MRf9HExFwEodasiOYiOImqbHOR1Hx1AIm5CFQxMRdRxcRcBAdRTMxFcBV9xWMukohJFUBiLhIqzVBtLpKaRnuQmIugn47JABJzkUSrUrVgmRcx/1Y3yfbnzE2kGDaR0thESmMTKY1NpDTGInr8bb/em3U5RdC41b6NQVYR3CdFXAM9eUVwnDS5ecjJLOLPa8Ukr8iqMdnlNFkxJrvcx9HGlbbrr7wHBCdjEqFl9539yObO5X7F431k8y/KRTTv64XxkAAAAABJRU5ErkJggg==",t.macCmdAndWinCtrl=function(){return a.default.key.command||a.default.key.ctrl&&!c},t.getSoftKeyboardHeight=function(){if(g)return window.innerHeight/2;var e=void 0;u?(e=S()?370:450,(0,o.inWhichSplitView)()<.66&&(e+=44),document.body.offsetHeight-window.innerHeight>300&&(e=50)):(e=35,S()&&_()&&(e=40),e+=window.innerHeight/2);return e},t.isIphoneX=D,t.supportsPassive=F,t.debounce=function(e,t){var i=null;return function(){var n=this,a=arguments;i&&(clearTimeout(i),i=null),i=setTimeout(function(){e.apply(n,a)},t)}}},243:function(e,t,i){"use strict";var n,a=i(1156),o=(n=a)&&n.__esModule?n:{default:n};i(1307);var s=void 0;"undefined"!==typeof window&&window.AlloyExcel?s=window.AlloyExcel:("undefined"!==typeof window&&(window.AlloyExcel=o.default),s=o.default),e.exports=s},284:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.filterHide=t.aroundEdges=void 0;var n=l(i(107)),a=l(i(0)),o=l(i(1)),s=i(10),r=i(21);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage,this.cachePool=[],this.selectQueue=[this._getOne()],this.selectIndex=0,this.selectStatus=s.SELECT_STATUS.NORMAL,this._cacheActiveIndex={xIndex:-1,yIndex:-1},this.active={get xIndex(){return this.xRange[0]},set xIndex(e){console.error("can't set xIndex, please set xRange")},get yIndex(){return this.yRange[0]},set yIndex(e){console.error("can't set yIndex, please set yRange")},xRange:[],yRange:[],posX:[],posY:[]},this.pickShape=null,this.isAnyInScreen=!1}return(0,o.default)(e,[{key:"setSelectStatus",value:function(e){this.selectStatus!==e&&(this.selectStatus=e,e===s.SELECT_STATUS.NORMAL?this._setActive(this._cacheActiveIndex):e===s.SELECT_STATUS.FORMULA&&(this._cacheActiveIndex={xIndex:this.active.xIndex,yIndex:this.active.yIndex}))}},{key:"_getOne",value:function(){var e=this,t={xRange:[],yRange:[],selectCol:!1,selectRow:!1,selectAll:!1,posX:[],posY:[]};return[{property:"selectAllRow",get:function(){var i=e.stage.tableData;return 0===t.yRange[0]&&t.yRange[1]===i.row.length-1}},{property:"selectAllCol",get:function(){var i=e.stage.tableData;return 0===t.xRange[0]&&t.xRange[1]===i.col.length-1}}].forEach(function(e){(0,n.default)(t,e.property,{get:e.get,set:function(){},enumerable:!0,configurable:!0})}),t}},{key:"getSelectQueue",value:function(){return this.selectQueue}},{key:"addSelect",value:function(){var e=void 0;this.stage.configData.multiSelection||this.selectStatus!==s.SELECT_STATUS.NORMAL?(this.cachePool.length>0?((e=this.cachePool.shift()).xRange[0]=-1,e.xRange[1]=-1,e.yRange[0]=-1,e.yRange[1]=-1,e.selectCol=!1,e.selectRow=!1,e.selectAll=!1):e=this._getOne(),this.selectQueue.push(e),this.selectIndex=this.selectQueue.length-1):console.error("can't add select in default select status, check multiSelection in config")}},{key:"toggleSelect",value:function(e){this.selectIndex=e}},{key:"removeSelect",value:function(){if(this.stage.configData.multiSelection||this.selectStatus!==s.SELECT_STATUS.NORMAL){var e=this.selectQueue.pop();this.cachePool.push(e),this.selectIndex=Math.min(this.selectIndex,this.selectQueue.length-1)}else console.error("can't remove select in default select status, check multiSelection in config")}},{key:"resetSelect",value:function(){var e=void 0;if(this.selectStatus!==s.SELECT_STATUS.FORMULA){for(;this.selectQueue.length>1;)e=this.selectQueue.pop(),this.cachePool.push(e);this.selectIndex=0}}},{key:"_setSelectQueue",value:function(e){var t=e.length-this.selectQueue.length;if(t>0)for(;t>0;)this.addSelect(),t--;else if(t<0)for(;t<0;)this.removeSelect(),t++;for(t=0;t<e.length;t++)this._setSelect(t,e[t]);0===this.selectQueue.length&&this.addSelect()}},{key:"_setSelect",value:function(e,t){var i=this.selectQueue[e],n=!1;return t.sheetIds&&(i.sheetIds=t.sheetIds),i.xRange[0]===t.xRange[0]&&i.xRange[1]===t.xRange[1]&&i.yRange[0]===t.yRange[0]&&i.yRange[1]===t.yRange[1]||(i.xRange[0]=t.xRange[0],i.xRange[1]=t.xRange[1],i.yRange[0]=t.yRange[0],i.yRange[1]=t.yRange[1],this._correction(i),n=!0),t.selectCol?i.selectCol||(i.selectCol=!0,i.selectRow=!1,i.selectAll=!1,n=!0):t.selectRow?i.selectRow||(i.selectRow=!0,i.selectCol=!1,i.selectAll=!1,n=!0):t.selectAll?i.selectAll||(i.selectAll=!0,i.selectCol=!1,i.selectRow=!1,n=!0):i.selectCol|i.selectRow|i.selectAll&&(i.selectRow=!1,i.selectCol=!1,i.selectAll=!1,n=!0),n}},{key:"_setActive",value:function(e){var t=this.stage.tableData,i=this.active,n=e.xIndex,a=e.yIndex,o=t.getCellDataAtPosition(a,n,s.GET_CELLDATA.DEFAULT),r=void 0,l=void 0;if(o.parent){var h=o.parent.mergeData;r=[h.xRange[0],h.xRange[1]],l=[h.yRange[0],h.yRange[1]]}else r=[n,n],l=[a,a];return(i.xRange[0]!==r[0]||i.xRange[1]!==r[1]||i.yRange[0]!==l[0]||i.yRange[1]!==l[1])&&(i.xRange[0]=r[0],i.xRange[1]=r[1],i.yRange[0]=l[0],i.yRange[1]=l[1],this._correction(i),!0)}},{key:"_correction",value:function(e){var t=!1,i=this.stage.tableData;e.xRange[0]<0&&(e.xRange[0]=-1),e.yRange[0]<0&&(e.yRange[0]=-1),e.xRange[1]>i.col.length-1&&(t=!0,e.xRange[1]=i.col.length-1),e.yRange[1]>i.row.length-1&&(t=!0,e.yRange[1]=i.row.length-1),t&&console.error("selectData error!!!")}},{key:"change",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.active,i=e.selectQueue,n=e.select,a=!1,o=!1;t&&(a=this._setActive(t)),n&&(o=this._setSelect(this.selectIndex,n)),i&&(o=!0,this._setSelectQueue(i)),this.stage.event.eventSelection.trigger("selectionShow",{activeChange:a,selectChange:o,type:e.type||s.SELECT_SHOW_TYPE.SELECT,show:void 0===e.show||e.show})}},{key:"clear",value:function(){}},{key:"select",get:function(){return this.selectQueue[this.selectIndex]},set:function(e){console.error("can't set select")}}]),e}();t.default=h,t.aroundEdges=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=void 0,a=void 0,o=void 0,r=void 0,l=void 0,h=void 0,g=void 0,c=void 0,d=void 0;for(o=t.xRange[0],l=t.xRange[1],r=t.yRange[0],h=t.yRange[1],n=r;n<=h;n++){for(d=!1,g=n===r||n===h?1:Math.max(l-o,1),a=o;a<=l;a+=g)if((c=e.getCellDataAtPosition(n,a,s.GET_CELLDATA.NORMAL))&&c.parent)if(i){if((c=c.parent).mergeData.xRange[1]>l){l=c.mergeData.xRange[0]-1,d=!0;break}if(c.mergeData.yRange[1]>h){h=c.mergeData.yRange[0]-1,d=!0;break}if(c.mergeData.xRange[0]<o){o=c.mergeData.xRange[1]+1,d=!0;break}if(c.mergeData.yRange[0]<r){r=c.mergeData.yRange[1]+1,d=!0;break}}else if((c=c.parent).mergeData.yRange[1]>h&&(h=c.mergeData.yRange[1]),c.mergeData.yRange[0]<r&&(n=r=c.mergeData.yRange[0],d=!0),c.mergeData.xRange[1]>l&&(l=c.mergeData.xRange[1],d=!0),c.mergeData.xRange[0]<o&&(o=c.mergeData.xRange[0],d=!0),d)break;d&&(n=r-1)}t.xRange[0]=o,t.xRange[1]=l,t.yRange[0]=r,t.yRange[1]=h},t.filterHide=function(e,t){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=t.xRange,a=t.yRange,o=!1,s=!1,l=void 0,h=void 0;i.sideShow&&(null!==(l=(0,r.isRowShow)(e,a[0])?a[0]:(0,r.findNextShowRow)(e,a[0],1))&&l<=a[1]?(a[0]=l,a[1]=(0,r.findNextShowRow)(e,a[1]+1,-1)):s=!0,null!==(h=(0,r.isColShow)(e,n[0])?n[0]:(0,r.findNextShowCol)(e,n[0],1))&&h<=n[1]?(n[0]=h,n[1]=(0,r.findNextShowCol)(e,n[1]+1,-1)):o=!0),s&&i.yDir&&null!==(l=(0,r.findNextShowRow)(e,a[0],i.yDir))&&(a[0]=a[1]=l),o&&i.xDir&&null!==(h=(0,r.findNextShowCol)(e,n[0],i.xDir))&&(n[0]=n[1]=h)}},285:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Range=void 0;var n=r(i(0)),a=r(i(1)),o=i(192),s=i(402);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,i){(0,n.default)(this,e),t=Math.max(0,t),i=Math.max(0,i),this.start=Math.min(t,i),this.end=Math.max(t,i)}return(0,a.default)(e,[{key:"equals",value:function(e){return!("number"!==typeof e.start||e.start!==this.start||"number"!==typeof e.end||e.end!==this.end)}},{key:"isCollapsed",value:function(){return this.start===this.end}}]),e}(),h=function(){function e(t){(0,n.default)(this,e),this.editor=t,this.root=this.editor.input,this.currentFillingCharNode=null,this.polyfillIfNeed()}return(0,a.default)(e,[{key:"polyfillIfNeed",value:function(){window.Range.prototype.intersectsNode||(window.Range.prototype.intersectsNode=function(e){var t=document.createRange();t.selectNode(e);var i=!1;try{i=0>this.compareBoundaryPoints(window.Range.END_TO_START,t)&&0<this.compareBoundaryPoints(window.Range.START_TO_END,t)}catch(n){console.warn("IE polyfill intersectsNode error: ",n)}return i})}},{key:"initFillingCharNode",value:function(e){this.currentFillingCharNode=e}},{key:"createFillingCharNode",value:function(){return this.removeFillingCharNode(),this.currentFillingCharNode=(0,o.createFillingCharNode)()}},{key:"removeFillingCharNode",value:function(){if((!this.editor.mentionBlock||!this.editor.mentionBlock.enteringMention||"MOBILE"!==!this.editor.platform)&&this.currentFillingCharNode){var e=this.currentFillingCharNode;this.currentFillingCharNode=null;var t=document.getSelection(),i=t&&t.rangeCount&&t.getRangeAt(0),n=e.nodeValue.indexOf(o.FillingChar),a=null;e.length>o.FillingCharLength&&i&&i.intersectsNode(e)&&(a=this.createNativeSelectionBookmark(t),t.anchorNode==e&&t.anchorOffset>n&&(a[0].offset-=o.FillingCharLength),t.focusNode==e&&t.focusOffset>n&&(a[1].offset-=o.FillingCharLength));try{e.nodeValue=(0,o.removeFillingCharString)(e.nodeValue,!0)}catch(s){console.error("AlloyRTE selection error: ",s)}a&&this.moveNativeSelectionToBookmark(document,a)}}},{key:"createNativeSelectionBookmark",value:function(e){return[{node:e.anchorNode,offset:e.anchorOffset},{node:e.focusNode,offset:e.focusOffset}]}},{key:"moveNativeSelectionToBookmark",value:function(e,t){var i=e.getSelection(),n=e.createRange();n.setStart(t[0].node,t[0].offset),i.extend||n.setEnd(t[1].node,t[1].offset),n.collapse(!0),i.removeAllRanges(),i.addRange(n),i.extend&&i.extend(t[1].node,t[1].offset)}},{key:"isCollapsed",value:function(){var e=document.getSelection();return!e||e.rangeCount<=0?null:e.getRangeAt(0).collapsed}},{key:"hasFocus",value:function(){var e=document.activeElement===this.root||g(this.root,document.activeElement),t=document.getSelection(),i=t&&t.rangeCount>0;return e&&i}},{key:"focus",value:function(){if(!this.hasFocus()){this.root.focus();var e=document.getSelection();e&&e.rangeCount||e.selectAllChildren(this.editor.input)}}},{key:"blur",value:function(){this.root.blur()}},{key:"getRange",value:function(){var e=document.getSelection();if(!e||e.rangeCount<=0)return null;var t=0,i=0,n=0,a=!1,o={};if(e.rangeCount>0){var r=e.getRangeAt(0),h=this.normalizeNativeRange(r);try{!function e(r,l){if(r&&l)if(r.nodeType===Node.TEXT_NODE||"BR"===r.tagName){if(a||r!=l.start.node||(i=t+l.start.offset,a=!0),a&&r==l.end.node)throw n=t+l.end.offset,o;r.nodeType===Node.TEXT_NODE?t+=r.length:t+=1}else if(r&&r.className===s.AlloyMentionBlockIdentifier){var h=r.textContent.trim().length;if(a||r!==l.start.node||(i=t+(l.start.offset<h/2?0:h),a=!0),a&&r===l.end.node)throw n=t+(l.end.offset<h/2?0:h),o;t+=h}else for(var g=0;g<r.childNodes.length;g++)e(r.childNodes[g],l)}(this.root,h)}catch(g){if(g!=o)throw g}}return new l(i,n)}},{key:"normalizeNativeRange",value:function(e){if(!g(this.editor.input,e.startContainer)||!e.collapsed&&!g(this.editor.input,e.endContainer))return null;var t={start:{node:e.startContainer,offset:e.startOffset},end:{node:e.endContainer,offset:e.endOffset},native:e};return[t.start,t.end].forEach(function(e){var t=e.node,i=e.offset;if(t&&t.className===s.AlloyMentionBlockIdentifier);else for(;!(t instanceof Text)&&t.childNodes.length>0;)if(t.childNodes.length>i)t=t.childNodes[i],i=0;else{if(t.childNodes.length!==i)break;i=(t=t.lastChild)instanceof Text?t.data.length:t.childNodes.length>0?t.childNodes.length:t.childNodes.length+1}e.node=t,e.offset=i}),t}},{key:"setRange",value:function(e){if(e){var t=document.createRange();if(0===e.start&&0===e.end)return t.setStart(this.root,0),t.setEnd(this.root,0),void r(t);var i={},n=0,a=!1;try{!function o(r){if(r)if(r.nodeType===Node.TEXT_NODE||"BR"===r.tagName){var l="BR"===r.tagName?1:r.length,h=n+l;if(!a&&e.start>=n&&e.start<=h&&("BR"===r.tagName?t.setStartAfter(r):t.setStart(r,e.start-n),a=!0),a&&e.end>=n&&e.end<=h)throw"BR"===r.tagName?t.setEndAfter(r):t.setEnd(r,e.end-n),i;n=h}else if(r&&r.className===s.AlloyMentionBlockIdentifier){var g=r.textContent.trim().length;if(!a&&n<e.start&&e.start<n+g&&(e.start<n+g/2?t.setStart(r,0):t.setStart(r,g),a=!0),a&&n<e.end&&e.end<n+g)throw e.end<n+g/2?t.setEnd(r,0):t.setEnd(r,g),i;n+=g}else for(var c=0;c<r.childNodes.length;c++)o(r.childNodes[c])}(this.root)}catch(l){if(l!==i){var o=this.editor.getText().length;throw this.collapseToPoint(o),l}r(t)}}function r(e){var t=document.getSelection();t.removeAllRanges(),t.addRange(e)}}},{key:"collapseToEnd",value:function(e){"undefined"===typeof e&&(e=this.editor.getRawText().length),this.setRange(new l(e,e))}},{key:"collapseToPoint",value:function(e){var t=this.editor.getText().length;e<0&&(e=0),e>t&&(e=t),this.setRange(new l(e,e))}}]),e}();function g(e,t){try{t.parentNode}catch(i){return!1}return function(e,t){for(var i=t;null!=i;){if(i==e)return!0;i=i.parentNode}return!1}(e,t)}t.default=h,t.Range=l},287:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.stage=t.stage,this.ctx=t.ctx}return(0,a.default)(e,[{key:"collect",value:function(e,t){}},{key:"clear",value:function(){}},{key:"render",value:function(){}}]),e}();t.default=s},386:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RuleRegExp=t.WORD_TYPE=void 0;var n,a=r(i(24)),o=r(i(0)),s=r(i(1));function r(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.ZH=1]="ZH",e[e.COMBINATION=2]="COMBINATION",e[e.SPACE=3]="SPACE",e[e.OTHER=4]="OTHER"}(n||(t.WORD_TYPE=n={}));var l=String.fromCharCode(10),h={text:""},g=new RegExp(/\s+/),c=new RegExp(/[\u4E00-\u9FA5]+/),d=new RegExp(/[a-zA-Z0-9\`\~\!\@\#\$\%\^\&\*\(\)\+\=\[\]\{\}\\\|\;\:\'\"\,\.\/\<\>\?\_]+/),u=new RegExp("("+c.source+")|("+d.source+")"),f=function(){function e(t,i,n){(0,o.default)(this,e),this.text=t,this.fontProp=i,this.size={width:0,height:0},this.wordType=n}return(0,s.default)(e,[{key:"setSize",value:function(e){this.size=e}},{key:"setWordType",value:function(e){this.wordType=e}},{key:"isEmpty",value:function(){return!this.text}},{key:"clone",value:function(){return new e(this.text,this.fontProp)}},{key:"rightTrim",value:function(){var e=/\s$/.test(this.text);return e&&(this.text=this.text.replace(/\s+$/,"")),e}},{key:"containLineFeed",value:function(){return this.text&&/\n/.test(this.text)}},{key:"splitByLineFeed",value:function(){var t=this;return this.containLineFeed()?this.text.split(l).map(function(i){return new e(i,t.fontProp)}):[this]}},{key:"replaceLineFeed2Space",value:function(){return this.containLineFeed()&&(this.text=this.text.replace(/\n/g," ")),this}},{key:"softSplit",value:function(t,i){var o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],s=[];s=void 0!==this.wordType?[{text:this.text,type:this.wordType}]:this.splitWordByRule({text:this.text});for(var r=[],l=[],h=0,g=void 0,c=void 0,d=0;d<s.length;d++){if(g=s[d],!(h+(c=t.measureSpecifiedTextWidth(g.text,this.fontProp))<=i||h+c>i&&g.type===n.SPACE)){var u=i-h;if(u>0){var f=this.splitWordByWidth(t,this.fontProp,g,u,o&&!r.length);r.push(f[0]),l.push(f[1]),d+1<s.length&&l.push.apply(l,(0,a.default)(s.slice(d+1,s.length)))}else d<s.length&&l.push.apply(l,(0,a.default)(s.slice(d,s.length)));break}r.push(g),h+=c}var v=r.map(function(e){return e.text}).join(""),A=l.map(function(e){return e.text}).join("");return this.text=v,{frontSegment:this,backSegment:new e(A,this.fontProp,this.wordType)}}},{key:"detectWordType",value:function(e){return d.test(e)?n.COMBINATION:g.test(e)?n.SPACE:c.test(e)?n.ZH:n.OTHER}},{key:"splitWordByRule",value:function(e){var t=this;return e.text.split(u).filter(function(e){return!!e}).map(function(e){return{text:e,type:t.detectWordType(e)}})}},{key:"splitWordByWidth",value:function(e,t,i,a){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4];if(i.type===n.SPACE)return[i,h];if(i.type===n.COMBINATION&&!o)return[h,i];var s=this.cuttingSpecifiedWidthTextBinary(e,i.text,t,0,i.text.length,a,o),r=i.text.slice(s.length,i.text.length);return[{text:s,type:i.type},{text:r,type:i.type}]}},{key:"hardSplit",value:function(t,i){var n=this.cuttingSpecifiedWidthTextBinary(t,this.text,this.fontProp,0,this.text.length,i),a=this.text.slice(n.length,this.text.length);this.text=n,this.size.width=t.measureSpecifiedTextWidth(n,this.fontProp);var o=new e(a,this.fontProp),s=t.measureSpecifiedTextWidth(a,this.fontProp),r=this.size.height;return o.setSize({width:s,height:r}),{frontSegment:this,backSegment:o}}},{key:"cuttingSpecifiedWidthTextBinary",value:function(e,t,i,n,a,o){var s=!(arguments.length>6&&void 0!==arguments[6])||arguments[6],r=t.substr(0,a),l=e.measureSpecifiedTextWidth(r,i);if(0===l||l<=o&&a>=t.length||l>o&&1===r.length&&s)return r;var h=l/r.length*3;if(l<=o&&o-l<h){for(var g=a+1;g<t.length;g++){var c=t.substr(0,g),d=e.measureSpecifiedTextWidth(c,i);if(d>o)break;r=c,l=d}return r}return l>o?this.cuttingSpecifiedWidthTextBinary(e,t,i,n,Math.floor((n+a)/2),o,s):this.cuttingSpecifiedWidthTextBinary(e,t,i,a,Math.floor((a+t.length)/2),o,s)}}]),e}();t.default=f,t.WORD_TYPE=n,t.RuleRegExp=u},399:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(33),s=i(155);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,i,a){(0,n.default)(this,e),this.isGridline=!1,null!==t&&void 0!==t||(t=a?o.BORDER_STYLE.NONE:o.GRIDLINE_BORDER_STYLE,this.isGridline=!0),this.style=t,this.color=i||o.GRIDLINE_BORDER_COLOR}return(0,a.default)(e,[{key:"getHash",value:function(){return this.isGridline?"null-"+this.color:this.style+"-"+this.color}},{key:"isEmpty",value:function(){return this.style===o.BORDER_STYLE.NONE}},{key:"getIsGridline",value:function(){return this.isGridline}},{key:"getBorderStyle",value:function(){return this.style}},{key:"getBorderColor",value:function(){return this.color}},{key:"getBorderWidth",value:function(){var e=o.BORDER_WIDTH.NONE;switch(this.style){case o.BORDER_STYLE.THIN:case o.BORDER_STYLE.DASH_DOT:case o.BORDER_STYLE.DASH_DOT_DOT:case o.BORDER_STYLE.DASHED:case o.BORDER_STYLE.DOTTED:case o.BORDER_STYLE.HAIR:case o.BORDER_STYLE.DOUBLE:e=o.BORDER_WIDTH.THIN;break;case o.BORDER_STYLE.MEDIUM:case o.BORDER_STYLE.MEDIUM_DASHED:case o.BORDER_STYLE.MEDIUM_DASH_DOT:case o.BORDER_STYLE.MEDIUM_DASH_DOT_DOT:case o.BORDER_STYLE.SLANTED_DASH_DOT:e=o.BORDER_WIDTH.MEDIUM;break;case o.BORDER_STYLE.THICK:e=o.BORDER_WIDTH.THICK;break;case o.BORDER_STYLE.NONE:default:e=o.BORDER_WIDTH.NONE}return e}},{key:"getDashSegments",value:function(){var e;switch(this.style){case o.BORDER_STYLE.HAIR:e=[1,1];break;case o.BORDER_STYLE.DOTTED:e=[2,2];break;case o.BORDER_STYLE.DASH_DOT_DOT:case o.BORDER_STYLE.MEDIUM_DASH_DOT_DOT:e=[3,3,3,3,9,3];break;case o.BORDER_STYLE.DASH_DOT:case o.BORDER_STYLE.MEDIUM_DASH_DOT:case o.BORDER_STYLE.SLANTED_DASH_DOT:e=[3,3,9,3];break;case o.BORDER_STYLE.DASHED:e=[3,3];break;case o.BORDER_STYLE.MEDIUM_DASHED:e=[9,3];break;case o.BORDER_STYLE.NONE:case o.BORDER_STYLE.THIN:case o.BORDER_STYLE.MEDIUM:case o.BORDER_STYLE.THICK:case o.BORDER_STYLE.DOUBLE:default:e=[]}return e}},{key:"getStylePriority",value:function(){return this.isGridline?-1:o.BORDER_STYLE_PRIORITY[this.style]}},{key:"compare",value:function(e){var t=this.compareBorderStylePriority(e);return 0===t?this.compareBorderColorPriority(e):t}},{key:"compareBorderStylePriority",value:function(e){return e?this.getStylePriority()-e.getStylePriority():1}},{key:"compareBorderColorPriority",value:function(e){return e?(0,s.compareColor)(this.color,e.color):1}}],[{key:"fromHash",value:function(t){var i=t.split("-"),n=i[0],a=i[1];return new e("null"===n?null:Number(n),a)}},{key:"fromBorder",value:function(t,i){return new e(t.style,t.color?t.color.toHex():null,i)}}]),e}();t.default=l},402:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.AlloyMentionBlockIdentifier=t.BlockFakeText=void 0;var n=d(i(16)),a=d(i(84)),o=d(i(3)),s=d(i(0)),r=d(i(1)),l=d(i(4)),h=d(i(5)),g=d(i(1229)),c=i(285);function d(e){return e&&e.__esModule?e:{default:e}}var u=String.fromCharCode(8203),f="alloy-mention-block",v=function(e){function t(e,i){(0,s.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e));return n.clickOrTapHandle=function(e){n.enteringMention&&n.triggerEndMention();var t=e.target&&e.target.closest(".alloy-mention-block");if(t){var i=null;try{i=JSON.parse(t.dataset.mentionDetail)}catch(s){console.error("JSON Parse MentionDetail error!")}if(i){var a=t.getBoundingClientRect(),o={x:a.x||a.left,y:(a.y||a.top)+a.height};n.mentionBlockFuncs.closeRemindBoard&&n.mentionBlockFuncs.closeRemindBoard(),n.mentionBlockFuncs.showRemindBoard&&n.mentionBlockFuncs.showRemindBoard(i.mentionId,o)}}else n.mentionBlockFuncs.closeRemindBoard&&n.mentionBlockFuncs.closeRemindBoard()},n.mentionBlockFuncs=i||{},n.initStyle(),n.initMentionBlockEvents(),n.resetVars(),n.polyfillForClosest(),n}return(0,h.default)(t,e),(0,r.default)(t,[{key:"polyfillForClosest",value:function(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.webkitMatchesSelector),Element.prototype.closest||(Element.prototype.closest=function(e){var t=this;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null})}},{key:"resetVars",value:function(){this.enteringMention=!1,this.mentionStartIndex=0,this.isComposing=!1}},{key:"initStyle",value:function(){i(1230)}},{key:"initMentionBlockEvents",value:function(){var e=this;if(this.editor.input.addEventListener("keydown",function(t){var i=e.editor.getRawText(),n=e.editor.getSelection();if(!t||8!==t.keyCode&&46!==t.keyCode)if(37===t.keyCode){if(n.start>0){var a=i[n.start-1],o=i[n.end-1];if(a===u){var s=e.findMentionBlockBeforePos(n.start);s&&(t.shiftKey?e.editor.setSelection(new c.Range(n.start-(s.innerText.trim().length+2),n.end)):e.editor.changeCursor(n.start-(s.innerText.trim().length+2)),t.preventDefault(),t.stopImmediatePropagation())}else if(o===u&&t.shiftKey){var r=e.findMentionBlockBeforePos(n.end);r&&(e.editor.setSelection(new c.Range(n.start,n.end-(r.innerText.trim().length+2))),t.preventDefault(),t.stopImmediatePropagation())}}e.enteringMention&&(console.log("--entering mention press left"),e.mentionBlockFuncs.control&&e.mentionBlockFuncs.control("UP"),t.preventDefault(),t.stopImmediatePropagation())}else if(39===t.keyCode){if(n.end<i.length){var l=i[n.end],h=i[n.start];if(l===u){var g=e.findMentionBlockAfterPos(n.end);g&&(t.shiftKey?e.editor.setSelection(new c.Range(n.start,n.end+(g.innerText.trim().length+2))):e.editor.changeCursor(n.end+(g.innerText.trim().length+2)),t.preventDefault(),t.stopImmediatePropagation())}else if(h===u&&t.shiftKey){var d=e.findMentionBlockAfterPos(n.start);d&&(e.editor.setSelection(new c.Range(n.start+(d.innerText.trim().length+2),n.end)),t.preventDefault(),t.stopImmediatePropagation())}}e.enteringMention&&(console.log("--entering mention press right"),e.mentionBlockFuncs.control&&e.mentionBlockFuncs.control("DOWN"),t.preventDefault(),t.stopImmediatePropagation())}else e.editor.env.isPcTencentDocApp&&t.shiftKey&&"@"===t.key||t.shiftKey&&"Process"===t.key&&"Digit2"===t.code?setTimeout(function(){e.checkWhetherCanTriggerMention()}):t&&50===t.keyCode&&"U+0040"===t.keyIdentifier?setTimeout(function(){e.checkWhetherCanTriggerMention()}):e.enteringMention&&(27===t.keyCode?(console.log("--entering mention press esc"),e.triggerEndMention(),t.preventDefault(),t.stopImmediatePropagation()):38===t.keyCode||40===t.keyCode?(console.log("--entering mention press up/down"),e.mentionBlockFuncs.control&&e.mentionBlockFuncs.control(38===t.keyCode?"UP":"DOWN"),t.preventDefault(),t.stopImmediatePropagation()):9===t.keyCode||13==t.keyCode?(e.mentionBlockFuncs.control&&e.mentionBlockFuncs.control("SELECT"),t.preventDefault(),t.stopImmediatePropagation()):e.triggerMentionListSearch()),e.mentionBlockFuncs.closeRemindBoard&&e.mentionBlockFuncs.closeRemindBoard();else if(n.start===n.end){var f=void 0,v=void 0;8===t.keyCode?(f=i[n.start-1])===u&&(v=e.findMentionBlockBeforePos(n.start)):(f=i[n.start])===u&&(v=e.findMentionBlockAfterPos(n.start)),v?(v.previousSibling&&v.previousSibling.remove(),v.nextSibling&&v.nextSibling.remove(),v.remove(),t.preventDefault()):e.enteringMention&&("@"===f?(e.triggerEndMention(),console.log("=delete mention @")):e.triggerMentionListSearch())}}),this.editor.input.addEventListener(this.editor.env.ie?"keypress":"input",function(t){t&&"@"===(t.data||t.key)&&(e.editor.env.ie?setTimeout(function(){e.checkWhetherCanTriggerMention()}):e.checkWhetherCanTriggerMention()),!e.isComposing&&e.editor.currSelection&&(e.ensureFakeTextSpanFineHandler&&clearTimeout(e.ensureFakeTextSpanFineHandler),e.ensureFakeTextSpanFineHandler=setTimeout(function(){var t=e.editor.getSelection();e.ensureFakeTextSpanFine(),e.editor.setSelection(t)},100))}),this.isComposing=!1,this.editor.input.addEventListener("compositionstart",function(t){e.editor.env.ie&&(e.specialStartSelForIE=e.editor.getSelection()),e.isComposing=!0}),this.editor.input.addEventListener("compositionend",function(t){if(e.isComposing=!1,e.enteringMention)e.triggerMentionListSearch();else if(e.editor.env.ie){var i=e.editor.getSelection();if(e.specialStartSelForIE&&e.specialStartSelForIE.start===e.specialStartSelForIE.end&&i&&i.start===i.end&&e.specialStartSelForIE.start+1===i.start)"@"===e.editor.getRawText()[i.start-1]&&setTimeout(function(){e.checkWhetherCanTriggerMention()})}}),this.editor.input.addEventListener("click",function(t){e.clickOrTapHandle(t)}),this.editor.env.iOS){var t=this;this.editor.input.addEventListener("touchstart",function(e){var t=e.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()}),this.editor.input.addEventListener("touchend",function(e){var i=e.changedTouches[0],n=i.clientX,a=i.clientY;void 0===this.touchT||Date.now()>this.touchT+250||Math.abs(a-this.touchY)>30||Math.abs(n-this.touchX)>30||t.clickOrTapHandle(e)})}}},{key:"checkWhetherCanTriggerMention",value:function(){var e=this.editor.getSelection(),t=!0;if("PC"!==this.editor.platform){var i=this.editor.getText();t=!/^=$|^=[^=]/.test(i)}t&&this.triggerEnteringMention(e.start)}},{key:"getMentionListPosition",value:function(){var e=this.getNativeRange();if(e){var t=e.getClientRects();if(t&&t.length){var i=t[0];return{x:i.x||i.left,y:(i.y||i.top)+i.height}}}var n=this.editor.root.getBoundingClientRect();return{x:n.x||n.left,y:(n.y||n.top)+n.height}}},{key:"triggerEnteringMention",value:function(e){var t=this;this.enteringMention=!0,this.mentionStartIndex=e,this.editor.history.lock(),console.log("=entering mention");var i=this.getMentionListPosition();i?this.mentionBlockFuncs.popMentionList&&this.mentionBlockFuncs.popMentionList(i,function(e){console.log("====select: ",e),"MOBILE"===t.editor.platform||"PAD"===t.editor.platform&&!t.editor.hasFocus()?t.mentionBlockFuncs.showAndRestoreInput&&t.mentionBlockFuncs.showAndRestoreInput():(t.editor.focus(),t.editor.currSelection&&t.editor.setSelection(t.editor.currSelection),t.prepareForInsertMention()),e.forEach(function(e){t.insertMention(t._toMentionDetail(e))}),t.triggerEndMention()}):console.error("Error: can not find pos!")}},{key:"_toMentionDetail",value:function(e){return{type:e.mentionType||0,sheetId:e.targetId,mentionId:e.mentionId,text:"@"+(e.mark||e.nick||""),userId:e.uid}}},{key:"triggerMentionListSearch",value:function(){var e=this;"MOBILE"!==this.editor.platform&&(this.isComposing||setTimeout(function(){var t=e.editor.getRawText(),i=e.editor.getSelection(),n=t.substring(e.mentionStartIndex,i.end);n.length>24&&e.triggerEndMention(),e.mentionBlockFuncs.search&&e.mentionBlockFuncs.search(n),console.log("=searching mention: ",n)}))}},{key:"triggerEndMention",value:function(){this.resetVars(),this.editor.history.unlock(),this.editor.selection.removeFillingCharNode(),this.mentionBlockFuncs.hideMentionList&&this.mentionBlockFuncs.hideMentionList()}},{key:"getNativeRange",value:function(){var e=document.getSelection();return e&&e.rangeCount&&e.getRangeAt(0)||null}},{key:"prepareForInsertMention",value:function(){var e=null,t=this.editor.getSelection().start;this.mentionStartIndex<=t&&(this.editor.setSelection(new c.Range(Math.max(0,this.mentionStartIndex-1),t)),(e=this.getNativeRange())&&e.deleteContents())}},{key:"insertMention",value:function(e){var t=null,i=this.create(e);if((t=this.getNativeRange())&&(i.forEach(function(e){t.insertNode(e),t.collapse(!1)}),this.editor.env.safari)){var n=document.createRange(),a=i[i.length-1];n.setStartAfter(a),n.setEndAfter(a);var o=document.getSelection();o.removeAllRanges(),o.addRange(n)}this.editor.valueChange()}},{key:"ensureFakeTextSpanFine",value:function(){var e=document.querySelectorAll("."+f);(0,a.default)(e).forEach(function(e){var t=e.previousSibling,i=e.nextSibling;if(t){var n=t.innerText.trim();if(n&&n.length>1){t.innerText=n.replace(u,""),t.removeAttribute("fake-text");var a=document.createElement("span");a.setAttribute("fake-text","start"),a.innerText=u,e.parentNode.insertBefore(a,e)}}if(i){var o=i.innerText.trim();if(o&&o.length>1){i.innerText=o.replace(u,""),i.removeAttribute("fake-text");var s=document.createElement("span");s.setAttribute("fake-text","end"),s.innerText=u,e.parentNode.insertBefore(s,i)}}})}},{key:"findMentionBlockBeforePos",value:function(e){var t=0,i=null;return function e(n,a){if(n.nodeType===Node.TEXT_NODE||"BR"===n.tagName)n.nodeType===Node.TEXT_NODE?t+=n.length:t+=1;else if(n&&n.className===f){var o=n.textContent.trim().length;t+o+1===a&&(i=n),t+=o}else for(var s=0;s<n.childNodes.length;s++)e(n.childNodes[s],a)}(this.editor.input,e),i}},{key:"findMentionBlockAfterPos",value:function(e){var t=0,i=null;return function e(n,a){if(n.nodeType===Node.TEXT_NODE||"BR"===n.tagName)n.nodeType===Node.TEXT_NODE?t+=n.length:t+=1;else if(n&&n.className===f){var o=n.textContent.trim().length;a+1===t&&(i=n),t+=o}else for(var s=0;s<n.childNodes.length;s++)e(n.childNodes[s],a)}(this.editor.input,e),i}},{key:"create",value:function(e){return[this.createFakeText("start"),this.createMentionBlock(e),this.createFakeText("end")]}},{key:"createFakeText",value:function(e){var t=document.createElement("span");t.setAttribute("fake-text",e);var i=document.createTextNode(u);return t.appendChild(i),t}},{key:"createMentionBlock",value:function(e){var t=e.text||"",i=null,a="\n            <span class="+f+'>\n                <div class="mention-block-content" contenteditable="false">\n                    <span>'+t+"</span>\n                </div>\n            </span>";return(i=this.createElementFromHTML(a)).setAttribute("data-mention-detail",(0,n.default)(e)),i}}]),t}(g.default);t.default=v,t.BlockFakeText=u,t.AlloyMentionBlockIdentifier=f},403:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t._getColFrozenLineLeft=function(e){return e.col.frozen.maxDistance},t._getRowFrozenLineTop=function(e){return e.row.frozen.maxDistance}},404:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(24)),a=r(i(0)),o=r(i(1)),s=i(10);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,a.default)(this,e),this.stage=t.stage;var i=this.stage.configData;this.text=t.text,this.segments=t.segments||[],this.lines=[],this.backgroundColor=t.backgroundColor||i.styles.backgroundColor,this.recordAuthor=t.recordAuthor||null,this.validationListHeader=t.validationListHeader||null,this.borderColor=t.borderColor||[null,null,null,null],this.borderStyle=t.borderStyle||[null,null,null,null],this.borderTopShow=!1,this.borderLeftShow=!1,this.borderBottomShow=!0,this.borderRightShow=!0,this.renderSeq=0,this.textWrap=t.textWrap||i.styles.textWrap,this.textAlign=t.textAlign||i.styles.text,this.verticalAlign=t.verticalAlign||i.styles.verticalAlign,this.setLink(t.link),this._paddingLeft=4,this._paddingRight=4,this.setStyle(t.style)}return(0,o.default)(e,[{key:"getLineHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return this.lines[e].getLineHeight()}},{key:"getMaxTextWidth",value:function(){if(this.lines&&this.lines.length){var e=this.lines.map(function(e){return e.getLineWidth()});return Math.max.apply(Math,(0,n.default)(e))+this.paddingLeft+this.paddingRight}return 0}},{key:"getTextHeight",value:function(){return this.lines.map(function(e){return e.getLineHeight()}).reduce(function(e,t){return e+t},0)}},{key:"getBackgroundColor",value:function(){return this.coverColor?this.coverColor:this.backgroundColor}},{key:"calcTextAlign",value:function(e,t){if(""!==this.text)for(var i=void 0,n=void 0,a=void 0,o=0;o<this.lines.length;o++){switch(a=this.lines[o].getLineWidth(),this.textAlign){case s.TEXT_ALIGN.CENTER:n=4+this._paddingLeft,i=this._paddingLeft+(this.stage.tableData.getCellBackgroundWidth(t,e)-n-a)/2>>0;break;case s.TEXT_ALIGN.RIGHT:n=this._paddingRight,i=this.stage.tableData.getCellBackgroundWidth(t,e)-n-a>>0;break;case s.TEXT_ALIGN.LEFT:default:i=this._paddingLeft}i<this._paddingLeft&&(i=this._paddingLeft),this.lines[o].setOffsetX(i>>0)}}},{key:"calcVerticalAlign",value:function(e,t){if(""!==this.text){var i=this.stage.configData,n=void 0,a=this.getTextHeight(),o=this.verticalAlign||i.styles.verticalAlign;switch((a>=this.stage.tableData.getCellBackgroundHeight(t,e)&&this.merge||a>this.stage.tableData.getCellBackgroundHeight(t,e)&&this.textWrap===s.TEXT_WRAP.NORMAL)&&(o=s.VERTICAL_ALIGN.TOP),o){case s.VERTICAL_ALIGN.MIDDLE:n=(this.stage.tableData.getCellBackgroundHeight(t,e)-a)/2;break;case s.VERTICAL_ALIGN.TOP:n=0;break;case s.VERTICAL_ALIGN.BOTTOM:n=this.stage.tableData.getCellBackgroundHeight(t,e)-a;break;default:console.error("verticalAlign: ",this.verticalAlign)}for(var r=void 0,l=n,h=0;h<this.lines.length;h++)r=this.lines[h].getLineHeight(),this.lines[h].setOffsetY(Math.round(100*(l+3*r/4))/100),l+=r>>0}}},{key:"setText",value:function(e){void 0!==e&&(null===e||""===e?this.text="":(/String/.test(Object.prototype.toString.call(e))?e=e.replace(String.fromCharCode(65279),""):/Number/.test(Object.prototype.toString.call(e))&&(e=e.toString()),this.text=e),this.link&&(this.link.text=this.text))}},{key:"setSegments",value:function(e){this.segments=e}},{key:"setBackgroundColor",value:function(e){null===e&&(e=this.stage.configData.styles.backgroundColor),this.backgroundColor!==e&&(this.backgroundColor=e)}},{key:"setTextAlign",value:function(e){null===e&&(e=this.stage.configData.styles.textAlign),s.TEXT_ALIGN.LEFT===e||s.TEXT_ALIGN.CENTER===e||s.TEXT_ALIGN.RIGHT===e?this.textAlign=e:console.error("invalid argument in set textAlign")}},{key:"setVerticalAlign",value:function(e){null===e&&(e=this.stage.configData.styles.verticalAlign),s.VERTICAL_ALIGN.TOP===e||s.VERTICAL_ALIGN.MIDDLE===e||s.VERTICAL_ALIGN.BOTTOM===e?this.verticalAlign=e:console.error("invalid argument in set verticalAlign")}},{key:"setTextWrap",value:function(e){null===e&&(e=this.stage.configData.styles.textWrap),s.TEXT_WRAP.NORMAL===e||s.TEXT_WRAP.NOWRAP===e?this.textWrap=e:console.error("invalid argument in set textWrap")}},{key:"isAutoTextWrap",value:function(){return this.textWrap&&this.textWrap===s.TEXT_WRAP.NORMAL}},{key:"setStyle",value:function(e){e&&(void 0!==e.paddingLeft&&(this._paddingLeft=e.paddingLeft),void 0!==e.paddingRight&&(this._paddingRight=e.paddingRight))}},{key:"setLink",value:function(e){void 0!==e&&(null===e?this.link=null:(this.link=e,this.text!==e.text&&(this.text=e.text)))}},{key:"handleCellLines",value:function(e,t){var i=this.stage.tableData,a=0;if(this.merge||this.merged){var o=this.parent,r=Math.min.apply(Math,(0,n.default)(o.mergeData.xRange)),l=Math.min.apply(Math,(0,n.default)(o.mergeData.yRange));a=Math.floor(this.stage.tableData.getCellBackgroundWidth(l,r,!0)-o._paddingLeft-o._paddingRight)}else a=Math.floor(i.col.getWidth(e,{ignoreScale:!0,ignoreHide:!1})-this._paddingLeft-this._paddingRight);if(a<=0)console.log("Error handleCellLines: maxWidth <= 0!!!");else{var h=this.segments.map(function(e){return e.clone()});this.textWrap===s.TEXT_WRAP.NORMAL?this.lines=this.stage.lineEngine.autoWrapLine(h,a):this.lines=this.stage.lineEngine.nonAutoWrapLine(h)}}},{key:"render",value:function(e,t,i,n,a){this.merged||this.merge?this._renderMerge(e,t,i,n,a):isNaN(this.upperX)?this.covers?this._renderOvercast(e,t,i,n,a):(null!==this.text&&""!==this.text&&this._renderText(e,t,i,n,a),this._renderBackground(e,t,i,n,a)):this._renderHidden(e,t,i,n,a)}},{key:"_renderHidden",value:function(e,t,i,n,a){var o=void 0,r=void 0,l=n+this.upperX,h=a,g=this.stage.tableData.getCellDataAtPosition(h,l,s.GET_CELLDATA.NORMAL);g.renderSeq<this.stage.tableData.renderSeq&&(o=this.stage.areaData.col.getViewportLeft(l),r=this.stage.areaData.row.getViewportTop(h),g.render(e,o,r,l,h)),this._renderBackground(e,t,i,n,a)}},{key:"_renderOvercast",value:function(e,t,i,n,a){this.renderSeq>=this.stage.tableData.renderSeq||(this.renderSeq=this.stage.tableData.renderSeq,this._renderText(e,t,i,n,a),this._renderBackground(e,t,i,n,a))}},{key:"_renderMerge",value:function(e,t,i,n,a){var o=this.parent;if(o){var s,r;if(o.renderSeq!==this.stage.tableData.renderSeq){o.renderSeq=this.stage.tableData.renderSeq;var l=o.mergeData.xRange[0],h=o.mergeData.yRange[0];s=t-this.stage.tableData.col.getRangeWidth([l,n-1]),r=i-this.stage.tableData.row.getRangeHeight([h,a-1]),o._renderText(e,s,r,n,a),o._renderBackground(e,s,r,n,a)}}}},{key:"renderBorder",value:function(e,t,i,n,a){if(this.parent){var o=this.stage.tableData;if(this.parent.renderBorderSeq===o.renderSeq)return;this.stage.renders.borderRender.calcTableMergeCellBorder(t,i,n,a,this.parent),this.parent.renderBorderSeq=o.renderSeq}else this.stage.renders.borderRender.calcTableCellBorder(t,i,n,a,{styles:this.borderStyle,colors:this.borderColor,shows:[this.borderTopShow,this.borderRightShow,this.borderBottomShow,this.borderLeftShow]})}},{key:"_renderBackground",value:function(e,t,i,n,a){this.stage.renders.backgroundRender.calcTableCellBackground(this.getBackgroundColor(),t,i,n,a)}},{key:"_renderText",value:function(e,t,i,n,a){this.stage.renders.richTextRender.calcTableCellRichText(this,t,i,n,a)}},{key:"getColor",value:function(){return this.segments[0]&&this.segments[0].fontProp?this.segments[0].fontProp.color:this.stage.configData.styles.color}},{key:"getFontItalic",value:function(){return!(!this.segments[0]||!this.segments[0].fontProp)&&this.segments[0].fontProp.italic}},{key:"getFontBold",value:function(){return!(!this.segments[0]||!this.segments[0].fontProp)&&this.segments[0].fontProp.bold}},{key:"getFontMiddleLine",value:function(){return!(!this.segments[0]||!this.segments[0].fontProp)&&this.segments[0].fontProp.strikethrough}},{key:"getFontBottomLine",value:function(){return!(!this.segments[0]||!this.segments[0].fontProp)&&this.segments[0].fontProp.underline}},{key:"getFontFamily",value:function(){return this.segments[0]&&this.segments[0].fontProp?this.segments[0].fontProp.fontFamily:null}},{key:"getFontSize",value:function(){return this.segments[0]&&this.segments[0].fontProp?this.segments[0].fontProp.fontSize:this.stage.configData.styles.fontSize}},{key:"paddingLeft",set:function(e){this._paddingLeft=e},get:function(){return this._paddingLeft*this.stage.tableData.scale>>0}},{key:"paddingRight",set:function(e){this._paddingRight=e},get:function(){return this._paddingRight*this.stage.tableData.scale>>0}}]),e}();t.default=l},664:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(i(0)),a=r(i(1)),o=i(665),s=i(33);function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this._style=void 0,this._hash=void 0,this.color=t.color||s.DEFAULT_CELL_FORMAT_LITERAL.color,this.fontFamily=t.fontFamily?this.polyfillFontFamilyIfNeed(t.fontFamily):s.DEFAULT_CELL_FORMAT_LITERAL.fontFamily,this.fontSize=t.fontSize||s.DEFAULT_CELL_FORMAT_LITERAL.fontSize,this.bold=!!t.bold,this.italic=!!t.italic,this.strikethrough=!!t.strikethrough,this.underline=!!t.underline}return(0,a.default)(e,[{key:"polyfillFontFamilyIfNeed",value:function(e){return e&&e.replace&&(e=e.replace(/[\uff08|()].*?[\uff09|)]/g,"")),e=(0,o.polyfillFontFamily)(e)}},{key:"getHash",value:function(){return this._hash||(this._hash=this._toHash()),this._hash}},{key:"_toHash",value:function(){var e=this.color+"&"+this.fontFamily+"&"+this.fontSize;return this.bold&&(e+="&b"),this.italic&&(e+="&i"),this.strikethrough&&(e+="&s"),this.underline&&(e+="&u"),e}},{key:"getFontHeightHash",value:function(){return this.fontFamily+"-"+this.fontSize}},{key:"getFontWidthHash",value:function(){return this._style||(this._style=this._toStyle()),this._style}},{key:"getStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1];return this._style||(this._style=this._toStyle(e,t)),this._style}},{key:"_toStyle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments[1],i="";return this.italic&&(i+="italic"),this.bold&&(i+=" bold"),i+=" "+this.fontSize*(e&&t||1)+"pt "+this.fontFamily}}],[{key:"fromHash",value:function(t){var i=t.split("&"),n=i.slice(3,i.length);return new e({color:i[0],fontFamily:i[1],fontSize:Number(i[2]),bold:!!(n&&n.indexOf("b")>=0),italic:!!(n&&n.indexOf("i")>=0),strikethrough:!!(n&&n.indexOf("s")>=0),underline:!!(n&&n.indexOf("u")>=0)})}},{key:"fromTextFormat",value:function(t){return new e({color:t&&t.color?t.color.toHex():s.DEFAULT_CELL_FORMAT_LITERAL.color,fontFamily:t&&t.fontFamily||s.DEFAULT_CELL_FORMAT_LITERAL.fontFamily,fontSize:t&&t.fontSize||s.DEFAULT_CELL_FORMAT_LITERAL.fontSize,bold:t&&t.bold||s.DEFAULT_CELL_FORMAT_LITERAL.bold,italic:t&&t.italic||s.DEFAULT_CELL_FORMAT_LITERAL.italic,strikethrough:t&&t.strikethrough||s.DEFAULT_CELL_FORMAT_LITERAL.strikethrough,underline:!(!t||!t.underline)})}}]),e}();t.default=l},676:function(e,t,i){"use strict";var n=o(i(25)),a=o(i(312));function o(e){return e&&e.__esModule?e:{default:e}}!function(){Date.now||(Date.now=function(){return(new Date).getTime()});for(var e=["webkit","moz"],t=0;t<e.length&&!window.requestAnimationFrame;++t){var i=e[t];window.requestAnimationFrame=window[i+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i+"CancelAnimationFrame"]||window[i+"CancelRequestAnimationFrame"]}if(/iP(ad|hone|od).*OS 6/.test(window.navigator.userAgent)||!window.requestAnimationFrame||!window.cancelAnimationFrame){var n=0;window.requestAnimationFrame=function(e){var t=Date.now(),i=Math.max(n+16,t);return setTimeout(function(){e(n=i)},i-t)},window.cancelAnimationFrame=clearTimeout}}(),function(){function i(e,t,i){e.addEventListener(t,i,!1)}function o(e){return Math.sqrt(1-Math.pow(e-1,2))}function s(e){return 1-Math.sqrt(1-e*e)}var r=function(e){this.reverse=this._getValue(e.reverse,!1),this.element="string"===typeof e.touch?document.querySelector(e.touch):e.touch,this.target=this._getValue(e.target,this.element),this.vertical=this._getValue(e.vertical,!0),this.property=e.property,this.tickID=0,this.initialValue=this._getValue(e.initialValue,this.target[this.property]),this.target[this.property]=this.initialValue,this.fixed=this._getValue(e.fixed,!1),this.sensitivity=this._getValue(e.sensitivity,1),this.moveFactor=this._getValue(e.moveFactor,1),this.factor=this._getValue(e.factor,1),this.outFactor=this._getValue(e.outFactor,.3),this.min=function(){if(void 0!==e.min&&null!==open.min)return"function"===typeof e.min?e.min():e.min},this.max=function(){if(void 0!==e.max&&null!==open.max)return"function"===typeof e.max?e.max():e.max},this.deceleration=this._getValue(e.deceleration,6e-4),this.maxRegion=this._getValue(e.maxRegion,600),this.springMaxRegion=this._getValue(e.springMaxRegion,60),this.maxSpeed=e.maxSpeed,this.hasMaxSpeed=!(void 0===this.maxSpeed),this.lockDirection=this._getValue(e.lockDirection,!0);var t=function(){};this.change=e.change||t,this.touchEnd=e.touchEnd||t,this.touchStart=e.touchStart||t,this.touchMove=e.touchMove||t,this.touchCancel=e.touchCancel||t,this.reboundEnd=e.reboundEnd||t,this.animationEnd=e.animationEnd||t,this.correctionEnd=e.correctionEnd||t,this.tap=e.tap||t,this.pressMove=e.pressMove||t,this.shouldRebound=e.shouldRebound||function(){return!0},this.preventDefault=this._getValue(e.preventDefault,!0),this.preventDefaultException={tagName:/^(INPUT|TEXTAREA|BUTTON|SELECT)$/},this.hasMin=!(void 0===this.min()),this.hasMax=!(void 0===this.max()),this.isTouchStart=!1,this.step=e.step,this.inertia=this._getValue(e.inertia,!0),this._calculateIndex(),this.eventTarget=window,e.bindSelf&&(this.eventTarget=this.element),this._moveHandler=this._move.bind(this),i(this.element,"touchstart",this._start.bind(this)),i(this.eventTarget,"touchend",this._end.bind(this)),i(this.eventTarget,"touchcancel",this._cancel.bind(this)),this.eventTarget.addEventListener("touchmove",this._moveHandler,{passive:!1,capture:!1}),this.x1=this.x2=this.y1=this.y2=null};r.prototype={isAtMax:function(){return this.hasMax&&this.target[this.property]>=this.max()},isAtMin:function(){return this.hasMin&&this.target[this.property]<=this.min()},_getValue:function(e,t){return void 0===e?t:e},stop:function(){cancelAnimationFrame(this.tickID),this._calculateIndex()},_start:function(e){this.isTouchStart=!0,this.touchStart.call(this,e,this.target[this.property]),cancelAnimationFrame(this.tickID),this._calculateIndex(),this.startTime=(new Date).getTime(),this.x1=this.preX=e.touches[0].pageX,this.y1=this.preY=e.touches[0].pageY,this.start=this.vertical?this.preY:this.preX,this._firstTouchMove=!0,this._preventMove=!1},_move:function(e){if(this.isTouchStart){var t=e.touches.length,i=e.touches[0].pageX,n=e.touches[0].pageY;if(this._firstTouchMove&&this.lockDirection){var a=Math.abs(i-this.x1)-Math.abs(n-this.y1);a>0&&this.vertical?this._preventMove=!0:a<0&&!this.vertical&&(this._preventMove=!0),this._firstTouchMove=!1}if(!this._preventMove){var o=(this.vertical?n-this.preY:i-this.preX)*this.sensitivity,s=this.moveFactor;this.isAtMax()&&o>0?s=this.outFactor:this.isAtMin()&&o<0&&(s=this.outFactor),o*=s,this.preX=i,this.preY=n,this.fixed||(this.target[this.property]+=this.reverse?-o:o),this.change.call(this,this.target[this.property]);var r=(new Date).getTime();r-this.startTime>300&&(this.startTime=r,this.start=this.vertical?this.preY:this.preX),this.touchMove.call(this,e,this.target[this.property])}this.preventDefault&&!function(e,t){for(var i in t)if(t[i].test(e[i]))return!0;return!1}(e.target,this.preventDefaultException)&&e.preventDefault(),1===t&&(null!==this.x2?(e.deltaX=i-this.x2,e.deltaY=n-this.y2):(e.deltaX=0,e.deltaY=0),this.pressMove.call(this,e,this.target[this.property])),this.x2=i,this.y2=n}},_cancel:function(e){var t=this.target[this.property];this.touchCancel.call(this,e,t),this._end(e)},to:function(e,t,i){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){};this._to(e,this._getValue(t,600),i||o,this.change,function(e){this._calculateIndex(),this.reboundEnd.call(this,e),this.animationEnd.call(this,e),n.call(this,e)}.bind(this))},_calculateIndex:function(){this.hasMax&&this.hasMin&&(this.currentPage=Math.round((this.max()-this.target[this.property])/this.step))},_end:function(e){if(this.isTouchStart){this.isTouchStart=!1;var t=this,i=this.target[this.property],n=Math.abs(e.changedTouches[0].pageX-this.x1)<30&&Math.abs(e.changedTouches[0].pageY-this.y1)<30;if(i=(0,a.default)(i)?this.initialValue:i,n&&this.tap.call(this,e,i),!1===this.touchEnd.call(this,e,i,this.currentPage))return;if(this.hasMax&&i>this.max()){if(!this.shouldRebound(i))return;this._to(this.max(),200,o,this.change,function(e){this.reboundEnd.call(this,e),this.animationEnd.call(this,e)}.bind(this))}else if(this.hasMin&&i<this.min()){if(!this.shouldRebound(i))return;this._to(this.min(),200,o,this.change,function(e){this.reboundEnd.call(this,e),this.animationEnd.call(this,e)}.bind(this))}else if(!this.inertia||n||this._preventMove||this.fixed)t._correction();else{var r=(new Date).getTime()-this.startTime;if(r<300){var l=((this.vertical?e.changedTouches[0].pageY:e.changedTouches[0].pageX)-this.start)*this.sensitivity,h=Math.abs(l)/r,g=this.factor*h;this.hasMaxSpeed&&g>this.maxSpeed&&(g=this.maxSpeed);var c=l<0?-1:1;this.reverse&&(c=-c);var d=i+g*g/(2*this.deceleration)*c,u=1;d<this.min()?d<this.min()-this.maxRegion?(u=s((i-this.min()+this.springMaxRegion)/(i-d)),d=this.min()-this.springMaxRegion):(u=s((i-this.min()+this.springMaxRegion*(this.min()-d)/this.maxRegion)/(i-d)),d=this.min()-this.springMaxRegion*(this.min()-d)/this.maxRegion):d>this.max()&&(d>this.max()+this.maxRegion?(u=s((this.max()+this.springMaxRegion-i)/(d-i)),d=this.max()+this.springMaxRegion):(u=s((this.max()+this.springMaxRegion*(d-this.max())/this.maxRegion-i)/(d-i)),d=this.max()+this.springMaxRegion*(d-this.max())/this.maxRegion));var f=Math.round(h/t.deceleration)*u;t._to(Math.round(d),f,o,t.change,function(e){if(t.hasMax&&t.target[t.property]>t.max()){if(!this.shouldRebound(t.target[t.property]))return;cancelAnimationFrame(t.tickID),t._to(t.max(),600,o,t.change,t.animationEnd)}else if(t.hasMin&&t.target[t.property]<t.min()){if(!this.shouldRebound(t.target[t.property]))return;cancelAnimationFrame(t.tickID),t._to(t.min(),600,o,t.change,t.animationEnd)}else t.step?t._correction():t.animationEnd.call(t,e);t.change.call(this,e)})}else t._correction()}}this.x1=this.x2=this.y1=this.y2=null},_to:function(e,t,i,n,a){var o=this.target,s=this.property,r=o[s],l=e-r,h=new Date,g=this;!function c(){var d=new Date-h;if(d>=t)return o[s]=e,n&&n.call(g,e),void(a&&a.call(g,e));o[s]=l*i(d/t)+r,g.tickID=requestAnimationFrame(c),n&&n.call(g,o[s])}()},_correction:function(){if(void 0!==this.step){var e=this.target[this.property],t=Math.floor(Math.abs(e/this.step)),i=e%this.step;Math.abs(i)>this.step/2?this._to((e<0?-1:1)*(t+1)*this.step,400,o,this.change,function(e){this._calculateIndex(),this.correctionEnd.call(this,e),this.animationEnd.call(this,e)}.bind(this)):this._to((e<0?-1:1)*t*this.step,400,o,this.change,function(e){this._calculateIndex(),this.correctionEnd.call(this,e),this.animationEnd.call(this,e)}.bind(this))}}},"object"===(0,n.default)(t)?e.exports=r:window.AlloyTouch=r}()},678:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(0),o=(n=a)&&n.__esModule?n:{default:n};t.default=function e(t){(0,o.default)(this,e),this.stage=t.stage,this.container=t.container,this.parent=t.parent,this.areaX=t.areaX,this.areaY=t.areaY,this.posX=[],this.posY=[]}},679:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.calcTextFormatStyles=t.calcCellFormatStyles=t.checkTextFormatRunsEqual=t.parseMentionsFromInputDom=t.parseHtml2TextFormatInfos=t.securityCheck=void 0;var n=h(i(25)),a=h(i(248)),o=h(i(14)),s=h(i(84)),r=i(665),l=i(10);function h(e){return e&&e.__esModule?e:{default:e}}function g(e){return e?(e=c(e,"script"),e=c(e,"iframe")):e}function c(e,t){if(!e||!t)return e;for(var i=void 0,n=e,a=100;a--;){if((i=d(n,t))===n)return i;n=i}return 0==a?"":i}function d(e,t){if(!t)return e;var i=e.indexOf("<"+t);if(-1!=i){var n=e.indexOf("</"+t);if(-1!=n)return e.substring(0,i)+e.substring(n+t.length+3)}return e}function u(e,t){if(e&&t){var i=(0,a.default)(e),o=(0,a.default)(t);if(i.length!==o.length)return!1;for(var s=0;s<i.length;s++){var r=i[s];if(null!==e[r]&&null!==t[r]&&"object"===(0,n.default)(e[r])&&"object"===(0,n.default)(t[r]))u(e[r],t[r]);else if(e[r]!==t[r])return!1}return!0}return!1}function f(e){if(!e||!e.length||1===e.length&&!e[0].format)return!0}function v(e){var t={"font-family":'"Microsoft YaHei","\u5fae\u8f6f\u96c5\u9ed1"',"font-size":"10pt",color:"rgba(0, 0, 0, 1)","font-weight":"normal","font-style":"normal","text-decoration":"none","text-decoration-skip-ink":"none"};if(!e)return t;var i=t;if(e.bold&&(i["font-weight"]="bold"),e.italic&&(i["font-style"]="italic"),"number"===typeof e.fontSize&&(i["font-size"]=e.fontSize+"pt"),e.fontFamily){var n=e.fontFamily;i["font-family"]=(0,r.polyfillFontFamily)(n)}return e.color&&(i.color=e.color.toStringRGBA()),(e.strikethrough||e.underline)&&(i["text-decoration"]="",e.strikethrough&&(i["text-decoration"]+="line-through"),e.underline&&(i["text-decoration"]+=" underline",2===e.underline&&console.warn("warning: \u6682\u65f6\u4e0d\u652f\u6301\u53cc\u4e0b\u5212\u7ebf\uff01\u5904\u7406\u6210\u5355\u4e0b\u5212\u7ebf\u4e86\u3002"))),i}t.securityCheck=g,t.parseHtml2TextFormatInfos=function(e){var t=null;if("string"===typeof e?(e=g(e),t=(new DOMParser).parseFromString(e,"text/html").getElementById("alloy-rich-text-editor")):e instanceof HTMLElement&&"alloy-rich-text-editor"===e.id?t=e:console.warn("warning: html is invalid!"),!t||!t.children)return null;document.queryCommandSupported("styleWithCss")||function(e){if(e){var t={strong:{prop:"font-weight",value:"bold"},em:{prop:"font-style",value:"italic"},u:{prop:"text-decoration-line",value:"underline"},strike:{prop:"text-decoration-line",value:"line-through"}};for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i))for(var n=t[i],a=[].slice.call(e.querySelectorAll(i)),o=0;o<a.length;o++){var s=a[o];s.setAttribute("style",n.prop+": "+n.value+";")}for(var r=[].slice.call(e.querySelectorAll("font[face]")),l=0;l<r.length;l++){var h=r[l];h.style["font-family"]=h.getAttribute("face")}for(var g=[].slice.call(e.querySelectorAll("font[color]")),c=0;c<g.length;c++){var d=g[c];d.style.color=d.getAttribute("color")}}}(t);var i=(0,s.default)(t.childNodes).map(function(e){return function e(t,i,n){if(t&&t.style&&(0,o.default)(i,function(e){var t={};if(e&&e.style){var i=e.style,n=i.getPropertyValue("color")||i.color;n&&(t.color=n);var a=i.getPropertyValue("font-family")||i["font-family"];a&&(a.indexOf(",")>-1&&(a=a.split(",")[0]),t.fontFamily=a.replace(/"|'/g,""));var o=i.getPropertyValue("font-size")||i["font-size"];o&&(t.fontSize=o);var s=i.getPropertyValue("font-weight")||i["font-weight"];s&&(t.bold="bold"===s);var r=i.getPropertyValue("font-style")||i["ont-style"];r&&(t.italic="italic"===r);var l=i.getPropertyValue("text-decoration-line")||i.getPropertyValue("text-decoration")||i["text-decoration-line"]||i["text-decoration"];l&&l.indexOf("line-through")>=0&&(t.strikethrough=!0),(l&&l.indexOf("underline")>=0||e.tagName&&"U"===e.tagName.toUpperCase())&&(t.underline=1)}return t}(t)),"BR"===t.nodeName)n.push({text:String.fromCharCode(10),style:(0,o.default)({},i)});else if(t.nodeType===Node.TEXT_NODE)n.push({text:t.textContent,style:(0,o.default)({},i)});else if(t&&t.className===l.AlloyMentionBlockIdentifier)n.push({text:t.textContent.trim(),style:{bold:!1,color:"rgb(0, 0, 0)",fontFamily:"Microsoft YaHei",fontSize:"10pt",italic:!1}});else for(var a=0;a<t.childNodes.length;a++){var s=t.childNodes[a];e(s,(0,o.default)({},i),n)}return n}(e,{},[])}).reduce(function(e,t){return e.concat(t)},[]).filter(function(e){return!(!e.text||""===e.text)});return i=function(e){if(!e||e.length<=1)return e;var t=0,i=void 0,n=void 0;for(String.fromCharCode(10);t<e.length-1;)i=e[t],n=e[t+1],u(i.style,n.style)?(i.text+=n.text,e.splice(t+1,1)):t++;return e}(i)},t.parseMentionsFromInputDom=function(e){if(!e||!e.children)return null;if(!e.querySelector("."+l.AlloyMentionBlockIdentifier))return null;var t=0,i=[];return function e(n){if(n.nodeType===Node.TEXT_NODE||"BR"===n.tagName)n.nodeType===Node.TEXT_NODE?t+=n.length:t+=1;else if(n&&n.className===l.AlloyMentionBlockIdentifier){var a=null;try{a=JSON.parse(n.dataset.mentionDetail)}catch(h){console.error("JSON Parse MentionDetail error!")}if(a){var o=a.text.trim(),s=[t,t+o.length];a.pos=s,i.push(a),t+=o.length}else t+=n.textContent.trim().length}else for(var r=0;r<n.childNodes.length;r++)e(n.childNodes[r])}(e),i},t.checkTextFormatRunsEqual=function(e,t){if(f(e)&&f(t))return!0;if(e&&t){if(e.length!==t.length)return!1;for(var i=0;i<e.length;i++){var n=e[i],a=t[i];if(!n.equal(a))return!1}return!0}return!1},t.calcCellFormatStyles=function(e){var t={"background-color":"rgba(255, 255, 255, 1)","text-align":"left","vertical-align":"middle","text-decoration-skip-ink":"none"},i=v();if(e){var n=t,a=i;return"string"===typeof e.backgroundColor?n["background-color"]=e.backgroundColor:e.backgroundColor&&e.backgroundColor.toStringRGB&&(n["background-color"]=e.backgroundColor.toStringRGB()),e.textAlgin&&(n["text-align"]=e.textAlgin),e.vertialAlgin&&(n["vertical-align"]=e.vertialAlgin),"normal"===e.wrapStrategy&&(n["word-wrap"]="break-word",n["word-break"]="break-all"),e.textFormat&&(delete(a=v(e.textFormat))["text-decoration-line"],delete a["text-decoration"]),(0,o.default)({},n,a)}return(0,o.default)({},t,i)},t.calcTextFormatStyles=function(e){return e instanceof Array&&e.length>0?e.map(function(e){return{startIndex:e.startIndex,format:v(e.format)}}):[{startIndex:0,format:v()}]}},680:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(i(84)),a=l(i(0)),o=l(i(1)),s=i(192),r=i(402);function l(e){return e&&e.__esModule?e:{default:e}}var h=function(){function e(t){(0,a.default)(this,e),this.editor=t}return(0,o.default)(e,[{key:"getInputDom",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.editor.input.cloneNode(!0),i=t.querySelectorAll("br.extra");return(0,n.default)(i).forEach(function(e){e&&e.parentNode&&e.parentNode.removeChild(e)}),e||this._recursiveRemoveHelpingChar(t),t}},{key:"getSelectedText",value:function(){var e=this.editor.getSelection(),t=this.getData(!0),i="";return e&&!e.isCollapsed()&&(i=t&&t.substring(e.start,e.end),i=(i=(0,s.removeFillingCharString)(i)).replace(r.BlockFakeText,"")),i}},{key:"setData",value:function(e){this.editor.input.innerText=e||"";var t=document.createElement("br");t.className="extra",this.editor.input.appendChild(t)}},{key:"getData",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.getInputDom(e);return this._polyfillGetData(t)}},{key:"getHTMLContent",value:function(){return this.editor.input.innerHTML}},{key:"getTextContent",value:function(){return this.editor.input.innerText}},{key:"setHTMLContent",value:function(e){this.editor.input.innerHTML=e}},{key:"setTextContent",value:function(e){this.editor.input.innerText=e}},{key:"doLineBreak",value:function(){var e,t;if(window.getSelection){if((e=window.getSelection()).getRangeAt&&e.rangeCount){(t=e.getRangeAt(0)).deleteContents();var i=document.createElement("div");i.innerHTML="<br>";for(var n,a,o=document.createDocumentFragment();n=i.firstChild;)a=o.appendChild(n);o.firstChild;t.insertNode(o),a&&((t=t.cloneRange()).setStartAfter(a),t.collapse(!0),e.removeAllRanges(),e.addRange(t),"PC"!==this.editor.platform||this.editor.env.ie?"PC"!==this.editor.platform&&this.editor.scrollToBottom():a.scrollIntoViewIfNeeded?a.scrollIntoViewIfNeeded():a.scrollIntoView&&(a.scrollIntoView(),document.body.scrollTop=0))}}else if((e=document.selection)&&"Control"!=e.type){e.createRange().collapse(!0),e.createRange().pasteHTML("<br>")}}},{key:"_recursiveRemoveHelpingChar",value:function(e){if(e.nodeType===Node.TEXT_NODE)e.textContent=(0,s.removeFillingCharString)(e.textContent),e.textContent=e.textContent.replace(r.BlockFakeText,"");else for(var t=0;t<e.childNodes.length;t++){var i=e.childNodes[t];this._recursiveRemoveHelpingChar(i)}}},{key:"_polyfillGetData",value:function(e){return this._recursiveParseNodeInnerTextString(e)}},{key:"_recursiveParseNodeInnerTextString",value:function(e){if(e.nodeType===Node.TEXT_NODE)return e.textContent;if(e.nodeName&&"BR"===e.nodeName.toUpperCase())return String.fromCharCode(10);if(e&&e.className===r.AlloyMentionBlockIdentifier)return e.textContent.trim();for(var t="",i=0;i<e.childNodes.length;i++){var n=e.childNodes[i];t+=this._recursiveParseNodeInnerTextString(n)}return t}}]),e}();t.default=h},681:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(i(0)),a=o(i(1));function o(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.editor=t,this.handleCopy(),this.handlePaste()}return(0,a.default)(e,[{key:"handleCopy",value:function(){var e=this,t=this.editor.input;this.editor.env.ie&&t.addEventListener("copy",function(t){window.clipboardData&&window.clipboardData.setData("Text",e.editor.getText()),t.preventDefault()})}},{key:"handlePaste",value:function(){var e=this;this.editor.input.addEventListener("paste",function(t){t.preventDefault();var i="";if(t&&t.clipboardData||t&&t.originalEvent&&t.originalEvent.clipboardData?i=(t.originalEvent||t).clipboardData.getData("text/plain"):window.clipboardData&&(i=window.clipboardData.getData("Text")),0!==i.length){var n=document.createTextNode(i),a=document.getSelection();if(a&&a.rangeCount){var o=a.getRangeAt(0);o.deleteContents(),o.insertNode(n),(o=o.cloneRange()).setStartAfter(n),o.setEndAfter(n),a.removeAllRanges(),a.addRange(o)}e.editor.valueChange()}})}}]),e}();t.default=s},682:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(i(25)),a=f(i(14)),o=f(i(9)),s=f(i(3)),r=f(i(0)),l=f(i(1)),h=f(i(4)),g=f(i(5)),c=f(i(683)),d=i(285),u=i(192);function f(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,i){(0,r.default)(this,t);var n=(0,h.default)(this,(t.__proto__||(0,s.default)(t)).call(this,e,i));return n.bindings={},n.options&&n.options.bindings&&(0,o.default)(n.options.bindings).forEach(function(e){n.options.bindings[e]&&n.addBinding(n.options.bindings[e])}),n.handlePCEnterKeys(),n.addBinding({key:"Tab"},function(){return console.log("---\u8f93\u5165 tab \u8981\u9000\u51fa\u7f16\u8f91\u6001\uff0c\u9009\u533a\u5f80\u53f3\u8d70"),n.editor.hooks.exitHandler({move:"RIGHT"}),!0}),n.addBinding({key:"Escape"},function(){return console.log("---\u8f93\u5165 esc \u8981\u9000\u51fa\u7f16\u8f91\u6001\uff0c\u9009\u533a\u4fdd\u6301\u5728\u5f53\u524d\u5355\u5143\u683c"),n.editor.hooks.exitHandler({move:"ORIGIN"}),!0}),n.handleNavigationKeys(),n.listen(),n}return(0,g.default)(t,e),(0,l.default)(t,[{key:"handlePCEnterKeys",value:function(){var e=this;this.addBinding({key:"Enter",shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},function(t){return console.log("----\u9000\u51fa\u8f93\u5165\u6846\uff0c\u9009\u533a\u5f80\u4e0b\u8d70---"),e.editor.hooks.exitHandler({move:"DOWN"}),!0}),this.addBinding({key:"Enter",shiftKey:!0},function(t){return console.log("---\u9000\u51fa\u8f93\u5165\u6846\uff0c\u9009\u533a\u5f80\u4e0a\u8d70----"),e.editor.hooks.exitHandler({move:"UP"}),!0}),this.addBinding({key:"Enter",metaKey:!0},this.handleEnterNewLine.bind(this)),this.addBinding({key:"Enter",altKey:!0},this.handleEnterNewLine.bind(this)),this.addBinding({key:"Enter",ctrlKey:!0},this.handleEnterNewLine.bind(this)),this.addBinding({key:"a",shortKey:!0},function(){var t=e.editor.getText();e.editor.selectionChange(new d.Range(0,t.length))})}},{key:"handleMobileEnterKeys",value:function(){var e=this;this.addBinding({key:"Enter",shiftKey:!1,ctrlKey:!1,altKey:!1,metaKey:!1},function(t){return e.handleEnterNewLine()})}},{key:"handleEnterNewLine",value:function(){return console.log("----\u8f93\u5165\u6362\u884c---"),this.editor.insertNewLine(),!0}},{key:"handleNavigationKeys",value:function(){this.addBinding({key:"ArrowRight"},this.handleNavigation.bind(this)),this.addBinding({key:"ArrowLeft"},this.handleNavigation.bind(this)),this.addBinding({key:"ArrowUp"},this.handleNavigation.bind(this)),this.addBinding({key:"ArrowDown"},this.handleNavigation.bind(this))}},{key:"handleNavigation",value:function(e){var t=e.substring("Arrow".length,e.length);return this.editor.hooks.exitHandler({move:t.toUpperCase(),fromNavigationKey:!0}),!1}},{key:"addBinding",value:function(e){var t=this,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=function(e){e="string"===typeof e||"number"===typeof e?{key:e}:"object"===("undefined"===typeof e?"undefined":(0,n.default)(e))?(0,a.default)({},e):null;e&&e.hasOwnProperty("shortKey")&&(e[u.SHORTKEY]=e.shortKey,delete e.shortKey);return e}(e);s?("function"===typeof i&&(i={handler:i}),"function"===typeof o&&(o={handler:o}),("[object Array]"===Object.prototype.toString.call(s.key)?s.key:[s.key]).forEach(function(e){var n=(0,a.default)({},s,{key:e},i,o);t.bindings[n.key]=t.bindings[n.key]||[],t.bindings[n.key].push(n)})):console.warn("Attempted to add invalid keyboard binding",s)}},{key:"listen",value:function(){var e=this;this.editor.input.addEventListener("keydown",function(t){if(!t||!t.defaultPrevented){var i=(e.bindings[t.key]||[]).concat(e.bindings[t.which]||[]).concat(e.bindings[t.keyIdentifier]||[]).filter(function(i){return e.match(t,i)});if(0!==i.length)i.some(function(t){return t.handler.call(e,t.key)})&&t.preventDefault()}})}},{key:"match",value:function(e,t){return!["altKey","ctrlKey","metaKey","shiftKey"].some(function(i){return null!==t[i]&&!!t[i]!==e[i]})&&(t.key===e.key||t.key===e.which||t.key===e.keyIdentifier)}}]),t}(c.default);t.default=v},683:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(0),o=(n=a)&&n.__esModule?n:{default:n};var s=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,o.default)(this,e),this.editor=t,this.options=i};s.DEFAULTS={},t.default=s},684:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.HistoryState=void 0;var n=g(i(3)),a=g(i(4)),o=g(i(5)),s=g(i(0)),r=g(i(1)),l=g(i(683)),h=i(192);function g(e){return e&&e.__esModule?e:{default:e}}var c=0,d=1,u=2,f={8:1,46:1},v={37:1,38:1,39:1,40:1,36:1,35:1,33:1,34:1},A=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:-1,i=arguments[1],n=arguments[2];(0,s.default)(this,e),this.index=t,this.selection=n,this.content=i}return(0,r.default)(e,[{key:"equalsContent",value:function(e){return!!e&&(0,h.removeFillingCharString)(this.content,!1)===(0,h.removeFillingCharString)(e.content,!1)}},{key:"equalsSelection",value:function(e){return!!(this.selection&&e&&e.selection&&this.selection.start===e.selection.start&&this.selection.end===e.selection.end)}},{key:"equals",value:function(e){return this.equalsContent(e)&&this.equalsSelection(e)}}]),e}(),C=function(e){function t(e,i){(0,s.default)(this,t);var o=(0,a.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e,i));return o.clear(),o.bindKeyboardEvent(),o.setupNativeEditingHandler(),o}return(0,o.default)(t,e),(0,r.default)(t,[{key:"bindKeyboardEvent",value:function(){this.editor.keyBoard.addBinding({key:"z",shortKey:!0},this.undo.bind(this)),this.editor.keyBoard.addBinding({key:"z",shortKey:!0,shiftKey:!0},this.redo.bind(this)),this.editor.keyBoard.addBinding({key:"y",shortKey:!0},this.redo.bind(this))}},{key:"setupNativeEditingHandler",value:function(){var e=this,t=this.editor.input;t.addEventListener("keydown",this.handleKeydown.bind(this)),t.addEventListener(this.editor.env.ie?"keypress":"input",this.handleInput.bind(this)),t.addEventListener("keyup",this.handleKeyup.bind(this)),t.addEventListener("compositionstart",function(t){e.composing=!0,e.typing||e.onTypingStart()}),t.addEventListener("compositionend",function(t){e.composing=!1,e.editor.valueChange()}),t.addEventListener("click",this.onClick.bind(this)),t.addEventListener("paste",this.handlePasteAndDrop.bind(this)),t.addEventListener("drop",this.handlePasteAndDrop.bind(this))}},{key:"onClick",value:function(){var e=this;setTimeout(function(){e.typing?(e.save(!0)||e.updateSelection(),e.resetTypingVars()):e.updateSelection();e.editor.selectionChange()})}},{key:"handlePasteAndDrop",value:function(){var e=this;setTimeout(function(){e.save(!0),e.refreshState()})}},{key:"handleKeydown",value:function(e){var t=e.keyCode,i=this.getKeyGroup(t);if(e[h.SHORTKEY]&&("z"===e.key||90===e.keyCode)||e[h.SHORTKEY]&&("y"===e.key||89===e.keyCode)||e[h.SHORTKEY]&&e.shiftKey&&("z"===e.key||90===e.keyCode))e.preventDefault();else if(!this.composing&&(e[h.SHORTKEY]||e.altKey||e.ctrlKey||e.shiftKey))this.save(!0),this.previousKeyGroup=i;else if(i===c)this.previousKeyGroup===u&&(this.save(!0),this.resetTypingVars()),this.typing||this.onTypingStart(),this.previousKeyGroup=i;else if(i===d)this.editor.selection.removeFillingCharNode(),this.typing&&(this.save(!0),this.resetTypingVars()),this.previousKeyGroup=i;else{if(this.editor.selection.removeFillingCharNode(),this.composing)return;this.typing?this.typing&&this.previousKeyGroup===c&&(this.save(!0),this.resetTypingVars()):this.onTypingStart()}}},{key:"updateSelection",value:function(e){if(!this.snapShots.length)return!1;if(!e){var t=this.editor.getCurrentState();e=new A(-1,t.content,t.selection)}var i=this.index,n=this.snapShots[i];return n&&n.equalsContent(e)&&!n.equalsSelection(e)?(e.index=i,this.snapShots[i]=e,this.currState=e,!0):!(!n||n.equalsContent(e)||n.equalsSelection(e))&&this.save(!0)}},{key:"onTypingStart",value:function(){this.typing=!0,this.hasUndo=!0,this.hasRedo=!1,this.onChange()}},{key:"handleInput",value:function(e){var t=this;this.editor.env.ie?setTimeout(function(){t.editor.valueChange()}):this.editor.valueChange()}},{key:"handleKeyup",value:function(e){var i=e.keyCode,n=this.getKeyGroup(i),a=Date.now();if(n===u){if(this.composing)return;a-this.lastRecorded>=t.DEFAULTS.delay&&this.save(!0),this.previousKeyGroup=n,this.editor.selectionChange()}n===d&&(this.updateSelection(),this.editor.selectionChange()),this.lastRecorded=a}},{key:"getKeyGroup",value:function(e){if("number"!==typeof e)throw new Error("keyCode should be number!");return f[e]?u:v[e]?d:c}},{key:"keyGroupChanged",value:function(e){return this.getKeyGroup(e)!==this.previousKeyGroup}},{key:"onChange",value:function(){this.editor.formatChange&&this.editor.formatChange(),this.editor.hooks.undoRedoStateChange(this.hasUndo,this.hasRedo)}},{key:"clear",value:function(){this.hasUndo=!1,this.hasRedo=!1,this.snapShots=[],this.index=-1,this.currState=null,this.locked=!1,this.resetTypingVars(),this.refreshState()}},{key:"lock",value:function(){this.locked=!0}},{key:"unlock",value:function(){this.locked=!1}},{key:"getNextHistoryState",value:function(e){if(this.snapShots.length<=0)return null;var t=void 0,i=void 0;if(this.currState)if(e){for(t=this.index-1;t>=0;t--)if(!(i=this.snapShots[t]).equals(this.currState))return i.index=t,i}else for(t=this.index+1;t<this.snapShots.length;t++)if(!(i=this.snapShots[t]).equals(this.currState))return i.index=t,i;return null}},{key:"restoreHistoryState",value:function(e){e&&(this.index=e.index,this.currState=this.snapShots[this.index],this.editor.updateContent(e.content),this.editor.setSelection(e.selection),this.refreshState())}},{key:"refreshState",value:function(){this.hasUndo=!!this.getNextHistoryState(!0),this.hasRedo=!!this.getNextHistoryState(!1),this.resetTypingVars(),this.onChange()}},{key:"resetTypingVars",value:function(){this.composing=!1,this.typing=!1,this.previousKeyGroup=-1,this.lastRecorded=0}},{key:"undo",value:function(){if(this.hasUndo){this.save(!0);var e=this.getNextHistoryState(!0);return!!e&&(this.restoreHistoryState(e),!0)}return!1}},{key:"redo",value:function(){if(this.hasRedo){if(this.save(!0),this.hasRedo){var e=this.getNextHistoryState(!1);if(e)return this.restoreHistoryState(e),!0}return!1}return!1}},{key:"save",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(!this.locked){var i=this.editor.getCurrentState(),n=new A(-1,i.content,i.selection);if(this.currState&&n.equalsContent(this.currState)){if(e)return!1;if(n.equalsSelection(this.currState))return!1}return this.snapShots.splice(this.index+1,this.snapShots.length-this.index-1),this.snapShots.length==t.DEFAULTS.maxStack&&this.snapShots.shift(),this.index=this.snapShots.push(n)-1,n.index=this.index,this.currState=n,!0}}}]),t}(l.default);C.DEFAULTS={delay:1200,maxStack:100},t.default=C,t.HistoryState=A},685:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){var e=navigator.userAgent.toLowerCase(),t=e.match(/edge[ \/](\d+.?\d*)/),i=e.indexOf("trident/")>-1,n=!(!t&&!i),a={ie:n,edge:!!t,webkit:!n&&e.indexOf(" applewebkit/")>-1,mac:e.indexOf("macintosh")>-1,mobile:e.indexOf("mobile")>-1,iOS:/(ipad|iphone|ipod)/.test(e),isPcTencentDocApp:"undefined"!=typeof external&&"undefined"!=typeof external.nativeCall};return a.gecko="Gecko"==navigator.product&&!a.webkit&&!a.ie,a.firefox=a.gecko||e.indexOf("firefox")>-1,a.webkit&&(e.indexOf("chrome")>-1?a.chrome=!0:a.safari=!0),a}();t.default=n},686:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,a=i(404),o=(n=a)&&n.__esModule?n:{default:n};t.default=function(e,t){return function(e){/String/.test(Object.prototype.toString.call(e.text))?e.text=e.text.replace(String.fromCharCode(65279),""):/Number/.test(Object.prototype.toString.call(e.text))?e.text=e.text.toString():e.text=""}(e),e.stage=t,new o.default(e)}},687:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(i(3)),a=g(i(0)),o=g(i(1)),s=g(i(4)),r=g(i(59)),l=g(i(5)),h=i(10);function g(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){return(0,a.default)(this,t),(0,s.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e))}return(0,l.default)(t,e),(0,o.default)(t,[{key:"addHook",value:function(e,i){switch(this._hooks[e]&&this.removeHook(e),e){case h.PLUGIN_HOOK.MOUSE_DOWN:this.stage.event.eventMouse.listen("mousedown",i);break;case h.PLUGIN_HOOK.MOUSE_MOVE:this.stage.event.eventMouse.listen("mousemove",i);break;case h.PLUGIN_HOOK.CLICK:this.stage.event.eventMouse.listen("click",i);break;default:return void(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"addHook",this).call(this,e,i)}this._hooks[e]=i}},{key:"removeHook",value:function(e){var i=this._hooks[e];if(void 0!==i){switch(e){case h.PLUGIN_HOOK.MOUSE_MOVE:this.stage.event.eventMouse.remove("mousemove",i);break;case h.PLUGIN_HOOK.MOUSE_DOWN:this.stage.event.eventMouse.remove("mousedown",i);break;case h.PLUGIN_HOOK.CLICK:this.stage.event.eventMouse.remove("click",i);break;default:return void(0,r.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"removeHook",this).call(this,e)}delete this._hooks[e]}else console.warn("remove a undefined hook in alloyExcelPlugin")}}]),t}(g(i(1303)).default);t.default=c}}]);
//# sourceMappingURL=chunk-alloyexcel-pc-7b5544bc34.js.map