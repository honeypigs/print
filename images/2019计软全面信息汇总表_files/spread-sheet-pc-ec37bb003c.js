!function(){var e=!1,t=function(){!function(e){function t(t){for(var n,r,s=t[0],l=t[1],u=t[2],c=0,h=[];c<s.length;c++)r=s[c],o[r]&&h.push(o[r][0]),o[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);for(d&&d(t);h.length;)h.shift()();return i.push.apply(i,u||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,s=1;s<a.length;s++){var l=a[s];0!==o[l]&&(n=!1)}n&&(i.splice(t--,1),e=r(r.s=a[0]))}return e}var n={},o={"spread-sheet-pc":0},i=[];function r(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.e=function(e){var t=[],a=o[e];if(0!==a)if(a)t.push(a[2]);else{var n=new Promise(function(t,n){a=o[e]=[t,n]});t.push(a[2]=n);var i,s=document.createElement("script");s.charset="utf-8",s.timeout=120,r.nc&&s.setAttribute("nonce",r.nc),s.src=function(e){return r.p+"static/js/"+({bundle_FPS:"bundle_FPS","bundle_calculation-environment":"bundle_calculation-environment",bundle_contextmenu:"bundle_contextmenu",bundle_discuss:"bundle_discuss",bundle_excel_plugin_pc:"bundle_excel_plugin_pc",bundle_mentionplugin:"bundle_mentionplugin",bundle_panel_pc:"bundle_panel_pc",bundle_resetLocation:"bundle_resetLocation",bundle_sheetsbar:"bundle_sheetsbar",bundle_smart_selection:"bundle_smart_selection",bundle_sort:"bundle_sort",bundle_toolbar:"bundle_toolbar",bundle_ui_dialog:"bundle_ui_dialog",bundle_ui_padmodal:"bundle_ui_padmodal",bundle_ui_tooltip:"bundle_ui_tooltip",mention_performance_plugin:"mention_performance_plugin"}[e]||e)+"-"+{bundle_FPS:"56254c5740","bundle_calculation-environment":"703b1124bd",bundle_contextmenu:"0ba2959e66",bundle_discuss:"8395d263c1",bundle_excel_plugin_pc:"e010113ef0",bundle_mentionplugin:"9d32b269f8",bundle_panel_pc:"fbf4e77f5b",bundle_resetLocation:"ee4de850dc",bundle_sheetsbar:"d253504709",bundle_smart_selection:"9852cb235b",bundle_sort:"004be6e86f",bundle_toolbar:"8e4820943e",bundle_ui_dialog:"1f79decb2e",bundle_ui_padmodal:"e4ce041e7b",bundle_ui_tooltip:"c3f0134326",mention_performance_plugin:"2b72d220ed"}[e]+".js"}(e),0!==s.src.indexOf(window.location.origin+"/")&&(s.crossOrigin="anonymous"),i=function(t){s.onerror=s.onload=null,clearTimeout(l);var a=o[e];if(0!==a){if(a){var n=t&&("load"===t.type?"missing":t.type),i=t&&t.target&&t.target.src,r=new Error("Loading chunk "+e+" failed.\n("+n+": "+i+")");r.type=n,r.request=i,a[1](r)}o[e]=void 0}};var l=setTimeout(function(){i({type:"timeout",target:s})},12e4);s.onerror=s.onload=i,document.head.appendChild(s)}return Promise.all(t)},r.m=e,r.c=n,r.d=function(e,t,a){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},r.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(a,n,function(t){return e[t]}.bind(null,n));return a},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="//s2.url.cn/tim/docs/sheets/",r.oe=function(e){throw console.error(e),e};var s=window.webpackJsonp=window.webpackJsonp||[],l=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var d=l;i.push([172,"chunk-vendors-part-pc","chunk-vendors-pc","chunk-core-pc","chunk-formula-pc","chunk-feature-pc","chunk-alloyexcel-pc","chunk-view-pc"]),a()}({1019:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(a(24)),o=y(a(9)),i=y(a(31)),r=y(a(16)),s=y(a(0)),l=y(a(1)),u=y(a(100)),d=y(a(40)),c=y(a(7)),h=y(a(274)),f=a(387),p=y(a(389)),v=y(a(110)),_=a(22),E=a(249),T=y(a(12)),m=a(71),g=a(113),S=y(a(8)),R=a(26),A=a(99),w=a(237),I=a(90),C=y(a(396));function y(e){return e&&e.__esModule?e:{default:e}}var O=function(){function e(t){(0,s.default)(this,e),this.autoFetch=0,this.parent=t.app,this.spreadsheetId=t.spreadsheetId,this.init(t)}return(0,l.default)(e,[{key:"init",value:function(e){var t=this;this.header=e.header,this.cache={},this.selectionCache={},this.viewSheetHeightsCache={},this.mutationCache={},this.autoLoad=[],this.setDataCache(e.activeSheetId,e.activeSheetData),T.default.wait(3e3).run(function(){t.autoLoadData(t.autoFetch,e.activeSheetId)})}},{key:"getHeader",value:function(){return this.header}},{key:"updateHeader",value:function(e){this.header=e}},{key:"loadSheet",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=a.onSuccess,o=a.onFail,i=a.isThreeDimensionClick,r=void 0!==i&&i,s=a.oldSheetId,l=void 0===s?"":s,u=this.parent.spreadsheet.getSheetBySheetId(e);u?(u.isFetching=!0,this.setSheetData(u,{onSuccess:function(a){if(t.parent.spreadsheet.setActiveSheetId(e),t.parent.view&&t.parent.view.canvas&&t.parent.view.canvas.excel){var o=a.getTitle();if(r&&l&&l!==e){var i=t.parent.spreadsheet.getSheetBySheetId(l);if(!i)throw new Error("\u4e09\u7ef4\u5f15\u7528\u8de8\u8868\u70b9\u51fb\u7684\u65f6\u5019\u65e7\u8868 "+l+" \u4e0d\u5b58\u5728");var s=t.parent.spreadsheet,u=i.getTitle(),d=s.getSheetIndexBySheetId(l),c=s.getSheetIndexBySheetId(e),h=d>c?o:u,f=d>c?e:l,p=d<c?o:u,v=d<c?e:l;t.parent.view.canvas.excel.inputCenter.board.setCrossSheetFormulaEditorCache({startSheetName:h,endSheetName:p,startSheetId:f,endSheetId:v})}else t.parent.view.canvas.excel.inputCenter.board.setCrossSheetFormulaEditorCache({startSheetName:o,endSheetName:o,startSheetId:e,endSheetId:e})}t.parent.view&&t.parent.view.canvas&&t.parent.view.canvas.excel&&t.parent.view.canvas.excel.clearTable();var _=+new Date;window.performanceData&&(window.performanceData.viewStart=_),t.parent.view&&t.parent.view.refreshExcelView(),C.default.report("view_init_process");var E=+new Date;if(window.performanceData&&(window.performanceData.viewEnd=E),t.parent.toggle=null,t.parent.view&&t.parent.view.canvas&&t.parent.view.canvas.excel){var T=t.parent.view.canvas.excel.inputCenter.board;T.isInCrossSheetFormulaEditingMode()&&t.parent.view.canvas.excel.event.eventInput.trigger("inputShow",{editValue:T.crossSheetFormulaEditorCache.editValue,enterToolbarInput:!T.isInOriginSheet(),cursor:T.crossSheetFormulaEditorCache.cursorPosition})}"function"===typeof n&&n()},onFail:function(){"function"===typeof o&&o()}})):"function"===typeof o&&o()}},{key:"autoLoadData",value:function(e,t){var a=this;if(!(e<=0)){this.autoLoad=this.header.slice(0,e+1).map(function(e){return e.id}).filter(function(e){return e!==t});var n=setInterval(function(){if(!a.autoLoad.length)return clearInterval(n);var e=a.autoLoad.shift(),t=a.parent.spreadsheet.getSheetBySheetId(e);t&&t.isLoaded||a.fetch(e,function(t){"fail"!==t&&a.setDataCache(e,t)})},500)}}},{key:"removeFromAutoLoad",value:function(e){if(this.autoLoad.length)for(var t=this.autoLoad.length-1;t>=0;t--)e===this.autoLoad[t]&&this.autoLoad.splice(t,1)}},{key:"getFetchUrl",value:function(e){return"/dop-api/get/sheet?padId="+this.spreadsheetId+"&subId="+e+"&xsrf="+c.default.getXsrf()+"&_r="+Math.random()}},{key:"checkRespose",value:function(e){return e.status&&200===e.status&&e.data&&0===e.data.retcode?"succ":"fail"}},{key:"fetch",value:function(e,t){var a=this,n=this.getFetchUrl(e);return(0,u.default)({method:"get",url:n,responseType:"json"}).then(function(n){"fail"!==a.checkRespose(n)?(a.removeFromAutoLoad(e),"function"===typeof t&&(n.data.data?t(n.data.data.initialAttributedText.text):(S.default.monitor(34462517),t("fail")))):"function"===typeof t&&(t("fail"),(0,w.switchSheetError)(I.errCodeType.SHEET_FETCH_ERROR),S.default.run(R.CONFIG.SWITCH_SHEET_SERVER_FAIL,[e,n]))}).catch(function(a){t("fail"),A.dialog.report("\u7cfb\u7edf\u6d88\u606f","\u52a0\u8f7d\u8868\u683c\u65f6\u9047\u5230\u672a\u77e5\u9519\u8bef\uff0c\u6211\u4eec\u5bf9\u6b64\u5f15\u8d77\u7684\u4e0d\u4fbf\u8868\u793a\u62b1\u6b49\uff0c\u4f60\u53ef\u4ee5\u9009\u62e9\u5237\u65b0\u91cd\u8bd5\u6216\u5728\u5410\u4e2a\u69fd\u53cd\u9988\u5e2e\u52a9\u6211\u4eec\u6539\u5584\u8868\u683c\u7684\u4f53\u9a8c\u3002",function(){(0,E.tencentDocOpenUrl)("https://support.qq.com/products/28096")},function(){location.reload()}),S.default.run(R.CONFIG.SWITCH_SHEET_FRONT_FAIL,[e,a&&a.stack])})}},{key:"setDataCache",value:function(e,t){Array.isArray(t)?this.cache[e]=t:"string"===typeof t?this.cache[e]=t:this.loadSheet(e)}},{key:"setMutationCache",value:function(e,t){this.mutationCache[e]?this.mutationCache[e].push(t):(this.mutationCache[e]=[],this.mutationCache[e].push(t))}},{key:"copySheetData",value:function(e,t){var a=(0,r.default)(t.serialize()),n=e.getSheetId(),s=e.getTitle();(0,f.keyframeV1)(e,a,0,0,v.default.KEYFRAME_VER);var l=!0,u=!1,c=void 0;try{for(var h,_=(0,i.default)((0,o.default)(e.sheetRangeControl.ranges));!(l=(h=_.next()).done);l=!0){var E=h.value;e.deleteSheetRange(E)}}catch(m){u=!0,c=m}finally{try{!l&&_.return&&_.return()}finally{if(u)throw c}}e.deleteMentions();var T=e.getData().rowData;T&&T.forEach(function(e){e&&e.values.forEach(function(e){e&&null!=e.getMentionDetails()&&e.clearMentionDetails()})}),e.setSheetId(n),e.setTitle(s),this.updateSheetsIndex(),new p.default({sheetId:e.getSheetId(),lastRow:e.getRowCount()-1,lastCol:e.getColCount()-1}).run(e,{isLocal:!0}),e.isLoaded=!0,d.default.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:n,sType:e.getParent()&&e.getParent().type||"normal",sheet:e})}},{key:"copySheetDataInWorker",value:function(e,t){this.parent.getCurrentMainThreadWorker().sheetList.copySheetData({oldSheetId:e,newSheetId:t})}},{key:"updateSheetsIndex",value:function(){var e=this,t=this.parent.spreadsheet.getSheets();this.header=[],t.forEach(function(t,a){e.header.push({id:t.getSheetId(),name:t.getTitle()}),t.getProperties().setIndex(a)})}},{key:"transformSpreadsheet",value:function(e,t){var a=e.getSheetId();return this.parent.getCurrentMainThreadWorker().sheetData.transformSpreadsheetBySheetId({sheetId:a,text:t,waitForFormulaLayerToBeInitialized:!0}),(0,h.default)(e,t,{afterKeyframeRun:function(t){d.default.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:e.getSheetId(),data:t.data,sType:t.sType,sheet:e})}})}},{key:"setSheetData",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=void 0,o=void 0,i=e.getSheetId();if(e.isLoaded&&(this.mutationCache[i]&&delete this.mutationCache[i],"function"===typeof a.onSuccess))return e.isFetching=!1,a.onSuccess(e);if(this.cache.hasOwnProperty(i)){if(n=+new Date,window.performanceData&&(window.performanceData.dataStart=n),this.transformSpreadsheet(e,this.cache[i]),o=+new Date,window.performanceData&&(window.performanceData.dataEnd=o),S.default.speed.hasInitReport()||S.default.speed.runReport(R.SPEED_REPORT_POINTS.DATA_HANDLE,n,+new Date),e.isLoaded=!0,e.isFetching=!1,this.mutationCache[i]){for(var r=0;this.mutationCache[i].length;){var s=this.mutationCache[i].shift();s.sheetId===i&&s.newVersion>r&&(this.parent.behavior.apply({type:"collab",sheetId:i,requestId:-1,opt:s}),r=s.newVersion)}delete this.mutationCache[i]}if(delete this.cache[i],"function"===typeof a.onSuccess)return a.onSuccess(e)}n=+new Date,this.fetch(i,function(i){"fail"!==i?(o=+new Date,S.default.speed.hasInitReport()||S.default.speed.runReport(R.SPEED_REPORT_POINTS.KEYFRAME_MUTATIONS_LOAD,n,+new Date),n=+new Date,window.performanceData&&(window.performanceData.dataStart=n),t.transformSpreadsheet(e,i),o=+new Date,window.performanceData&&(window.performanceData.dataEnd=o),S.default.speed.hasInitReport()||S.default.speed.runReport(R.SPEED_REPORT_POINTS.DATA_HANDLE,n,+new Date),e.isLoaded=!0,e.isFetching=!1,T.default.wait(3e3).run(function(){(0,m.hideToast)()}),"function"===typeof a.onSuccess&&a.onSuccess(e)):(e.isReadonly=!0,e.isFetching=!1,(0,m.showToast)("\u6570\u636e\u62c9\u53d6\u5931\u8d25"),"function"===typeof a.onFail&&a.onFail(e),T.default.wait(3e3).run(function(){(0,m.hideToast)()}))})}},{key:"saveSheetSelection",value:function(e,t){var a=this.parent.view;t=t||a.getSheetLocation(),this.selectionCache[e]=t}},{key:"getSheetSelection",value:function(e){return e&&this.selectionCache[e]?this.selectionCache[e]:void 0}},{key:"delSheetSeletion",value:function(e){e&&delete this.selectionCache[e]}},{key:"setSheetSelection",value:function(e){var t=this.getSheetSelection(e);if(void 0!==t){var a=t.xRange&&t.xRange[0]||0,o=t.yRange&&t.yRange[0]||0,i=this.parent.spreadsheet.getSheetBySheetId(e);if(i){var r=!1,s=!1;(a>=i.getColCount()||o>=i.getRowCount())&&(r=!0);var l=i.data.rowMetadata[o],u=i.data.columnMetadata[a];if((l&&(l.getHiddenByFilter()||l.getHiddenByUser())||u&&(u.getHiddenByFilter()||u.getHiddenByUser()))&&(s=!0),r||s){for(var d=0;d<=i.data.rowMetadata.length;d++){var c=i.data.rowMetadata[d];if(c&&!c.getHiddenByFilter()&&!c.getHiddenByUser()){o=d;break}if(!c){o=d;break}}for(var h=0;h<=i.data.columnMetadata.length;h++){var f=i.data.columnMetadata[h];if(f&&!f.getHiddenByFilter()&&!f.getHiddenByUser()){a=h;break}if(!f){a=h;break}}t.xRange=[a,a],t.yRange=[o,o]}}if(!_.isMobile){this.parent.view.canvas.excel.selectAreaCell({xRange:t.xRange&&[].concat((0,n.default)(t.xRange)),yRange:t.yRange&&[].concat((0,n.default)(t.yRange))},{x:a,y:o},!1,{sheetIds:[e,e]});var p=this.parent.view;p.toolBar&&p.toolBar.inputBox&&p.toolBar.inputBox.setCellCoordDisplay(a,o)}}else _.isMobile||this.parent.view.canvas.setFirstCellFocus()}},{key:"setSheetScroll",value:function(e){var t=this.getSheetSelection(e);if(void 0!==t){var a=t.col.frozen,n=t.row.frozen,o=t.col.flow,i=t.row.flow;this.parent.spreadsheet.getSheetBySheetId(e)&&(this.parent.view.canvas.excel.tableScroll({areaX:"frozen",diffX:-a,areaY:"frozen",diffY:-n}),this.parent.view.canvas.excel.tableScroll({areaX:"flow",diffX:-o,areaY:"flow",diffY:-i}))}else _.isMobile||this.parent.view.canvas.setFirstCellFocus()}},{key:"saveSheetHeights",value:function(e){var t=this.parent.view.canvas.excel;t&&t.tableData&&t.tableData.row&&t.tableData.row.heights&&(this.viewSheetHeightsCache[e]=(0,g.clone)(t.tableData.row.heights))}},{key:"delSheetHeights",value:function(e){e&&delete this.viewSheetHeightsCache[e]}},{key:"getSheetHeights",value:function(e){return e&&this.viewSheetHeightsCache[e]?this.viewSheetHeightsCache[e]:null}}]),e}();t.default=O},1058:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(16),i=(n=o)&&n.__esModule?n:{default:n};t.redirectToBlankPage=function(e){var t=location.pathname.replace("/sheet/",""),a={};a[t]={padType:"blankpage",clientVars:{type:e.type||17,errcode:e.errcode||"\u672a\u77e5\u9519\u8bef\u7801"}},localStorage.setItem("blankPageData",(0,i.default)(a)),location.replace(location.href.replace("/sheet/","/blankpage/"))}},1067:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasEmojiCharacter=function(e){for(var t=0;t<e.length;t++){var a=e.charCodeAt(t);if(console.log(a),55296<=a&&a<=56319){if(e.length>1){var n=e.charCodeAt(t+1),o=1024*(a-55296)+(n-56320)+65536;if(118784<=o&&o<=128895)return!0;if(129311<=o&&o<=129311)return!0;if(129320<=o&&o<=129327)return!0;if(129329<=o&&o<=129330)return!0;if(129356<=o&&o<=129356)return!0;if(129375<=o&&o<=129375)return!0;if(129376<=o&&o<=129387)return!0;if(129426<=o&&o<=129431)return!0;if(129504<=o&&o<=129510)return!0;if(129488<=o&&o<=129491)return!0}}else if(e.length>1){var n=e.charCodeAt(t+1);if(8419==n)return!0}else{if(8448<=a&&a<=10239)return!0;if(11013<=a&&a<=11015)return!0;if(10548<=a&&a<=10549)return!0;if(12951<=a&&a<=12953)return!0;if(169==a||174==a||12349==a||12336==a||11093==a||11036==a||11035==a||11088==a)return!0}if((9786==a||10084==a||9757==a||9996==a||9994==a||9995==a)&&e.length>t){var n=e.charCodeAt(t+1);if(65039==n)return!0}}},t.getStrBytes=function(e){var t,a=0,n=0,o=0;for(n=0,o=e.length;n<o;n++)t=e.charCodeAt(n),a+=t<=127?1:t<=2047?2:t<=65535?3:4;return a},t.getSubstr36Bytes=function(e){var t,a=0,n=0,o=0;for(n=0,o=e.length;n<o&&(t=e.charCodeAt(n),!((a+=t<=127?1:t<=2047?2:t<=65535?3:4)>36));n++);return e.substring(0,n)}},1072:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(9)),o=r(a(0)),i=r(a(1));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;(0,o.default)(this,e),this.capacity=t,this.map={}}return(0,i.default)(e,[{key:"delete",value:function(e){var t=this.map[e];return!!t&&(this.remove(t),delete this.map[t.key],!0)}},{key:"get",value:function(e){var t=this.map[e];if(t)return this.remove(t),this.setHead(t),t.value}},{key:"keys",value:function(){for(var e=[],t=this.head;t;)e.push(t.key),t=t.next;return e}},{key:"latest",value:function(){return this.head.value}},{key:"oldest",value:function(){return this.end.value}},{key:"remove",value:function(e){return e.previous?e.previous.next=e.next:this.head=e.next,null!=e.next?e.next.previous=e.previous:this.end=e.previous,e}},{key:"put",value:function(e,t){var a=this.map[e],o={key:void 0,value:void 0};if(a)return a.value=t,o=this.remove(a),this.setHead(a),o.value;var i={key:e,value:t};return(0,n.default)(this.map).length>=this.capacity?(delete this.map[this.end.key],o=this.remove(this.end),this.setHead(i)):this.setHead(i),this.map[e]=i,o.value}},{key:"setHead",value:function(e){e.next=this.head,e.previous=null,this.head&&(this.head.previous=e),this.head=e,this.end||(this.end=this.head)}},{key:"size",value:function(){return(0,n.default)(this.map).length}},{key:"toString",value:function(){for(var e="(newest) ",t=this.head;t;)e+=String(t.key)+":"+t.value,(t=t.next)&&(e+=" > ");return e+" (oldest)"}}]),e}();t.default=s},1082:function(e,t,a){var n={"./af":522,"./af.js":522,"./ar":523,"./ar-dz":524,"./ar-dz.js":524,"./ar-kw":525,"./ar-kw.js":525,"./ar-ly":526,"./ar-ly.js":526,"./ar-ma":527,"./ar-ma.js":527,"./ar-sa":528,"./ar-sa.js":528,"./ar-tn":529,"./ar-tn.js":529,"./ar.js":523,"./az":530,"./az.js":530,"./be":531,"./be.js":531,"./bg":532,"./bg.js":532,"./bm":533,"./bm.js":533,"./bn":534,"./bn.js":534,"./bo":535,"./bo.js":535,"./br":536,"./br.js":536,"./bs":537,"./bs.js":537,"./ca":538,"./ca.js":538,"./cs":539,"./cs.js":539,"./cv":540,"./cv.js":540,"./cy":541,"./cy.js":541,"./da":542,"./da.js":542,"./de":543,"./de-at":544,"./de-at.js":544,"./de-ch":545,"./de-ch.js":545,"./de.js":543,"./dv":546,"./dv.js":546,"./el":547,"./el.js":547,"./en-SG":548,"./en-SG.js":548,"./en-au":549,"./en-au.js":549,"./en-ca":550,"./en-ca.js":550,"./en-gb":551,"./en-gb.js":551,"./en-ie":552,"./en-ie.js":552,"./en-il":553,"./en-il.js":553,"./en-nz":554,"./en-nz.js":554,"./eo":555,"./eo.js":555,"./es":556,"./es-do":557,"./es-do.js":557,"./es-us":558,"./es-us.js":558,"./es.js":556,"./et":559,"./et.js":559,"./eu":560,"./eu.js":560,"./fa":561,"./fa.js":561,"./fi":562,"./fi.js":562,"./fo":563,"./fo.js":563,"./fr":564,"./fr-ca":565,"./fr-ca.js":565,"./fr-ch":566,"./fr-ch.js":566,"./fr.js":564,"./fy":567,"./fy.js":567,"./ga":568,"./ga.js":568,"./gd":569,"./gd.js":569,"./gl":570,"./gl.js":570,"./gom-latn":571,"./gom-latn.js":571,"./gu":572,"./gu.js":572,"./he":573,"./he.js":573,"./hi":574,"./hi.js":574,"./hr":575,"./hr.js":575,"./hu":576,"./hu.js":576,"./hy-am":577,"./hy-am.js":577,"./id":578,"./id.js":578,"./is":579,"./is.js":579,"./it":580,"./it-ch":581,"./it-ch.js":581,"./it.js":580,"./ja":582,"./ja.js":582,"./jv":583,"./jv.js":583,"./ka":584,"./ka.js":584,"./kk":585,"./kk.js":585,"./km":586,"./km.js":586,"./kn":587,"./kn.js":587,"./ko":588,"./ko.js":588,"./ku":589,"./ku.js":589,"./ky":590,"./ky.js":590,"./lb":591,"./lb.js":591,"./lo":592,"./lo.js":592,"./lt":593,"./lt.js":593,"./lv":594,"./lv.js":594,"./me":595,"./me.js":595,"./mi":596,"./mi.js":596,"./mk":597,"./mk.js":597,"./ml":598,"./ml.js":598,"./mn":599,"./mn.js":599,"./mr":600,"./mr.js":600,"./ms":601,"./ms-my":602,"./ms-my.js":602,"./ms.js":601,"./mt":603,"./mt.js":603,"./my":604,"./my.js":604,"./nb":605,"./nb.js":605,"./ne":606,"./ne.js":606,"./nl":607,"./nl-be":608,"./nl-be.js":608,"./nl.js":607,"./nn":609,"./nn.js":609,"./pa-in":610,"./pa-in.js":610,"./pl":611,"./pl.js":611,"./pt":612,"./pt-br":613,"./pt-br.js":613,"./pt.js":612,"./ro":614,"./ro.js":614,"./ru":615,"./ru.js":615,"./sd":616,"./sd.js":616,"./se":617,"./se.js":617,"./si":618,"./si.js":618,"./sk":619,"./sk.js":619,"./sl":620,"./sl.js":620,"./sq":621,"./sq.js":621,"./sr":622,"./sr-cyrl":623,"./sr-cyrl.js":623,"./sr.js":622,"./ss":624,"./ss.js":624,"./sv":625,"./sv.js":625,"./sw":626,"./sw.js":626,"./ta":627,"./ta.js":627,"./te":628,"./te.js":628,"./tet":629,"./tet.js":629,"./tg":630,"./tg.js":630,"./th":631,"./th.js":631,"./tl-ph":632,"./tl-ph.js":632,"./tlh":633,"./tlh.js":633,"./tr":634,"./tr.js":634,"./tzl":635,"./tzl.js":635,"./tzm":636,"./tzm-latn":637,"./tzm-latn.js":637,"./tzm.js":636,"./ug-cn":638,"./ug-cn.js":638,"./uk":639,"./uk.js":639,"./ur":640,"./ur.js":640,"./uz":641,"./uz-latn":642,"./uz-latn.js":642,"./uz.js":641,"./vi":643,"./vi.js":643,"./x-pseudo":644,"./x-pseudo.js":644,"./yo":645,"./yo.js":645,"./zh-cn":646,"./zh-cn.js":646,"./zh-hk":647,"./zh-hk.js":647,"./zh-tw":648,"./zh-tw.js":648};function o(e){var t=i(e);return a(t)}function i(e){if(!a.o(n,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return n[e]}o.keys=function(){return Object.keys(n)},o.resolve=i,e.exports=o,o.id=1082},110:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={KEYFRAME_VER:5,KEYFRAME_VER_LOWEST_SUPPORT:3,MUTATION_VER:5,MUTATION_VER_LOWEST_SUPPORT:3,CODE_VER:1,CLIENT_VER:1}},112:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.formatPainter=void 0;var n=b(a(9)),o=b(a(14)),i=b(a(47));t.mergeCells=function(e){var t=s.default.window.SpreadsheetApp,a=t.view.canvas.excel,n=t.spreadsheet.getActiveSheetId(),o=a.configData.rowHeight;function i(e,t,n){for(var i=[],r=t;r<=n;r++){var s=a.tableData.row.getHeight(r),l=a.tableData.row.getSetHeight(r);(null===l||void 0===l)&&s>o&&i.push({dimensionRange:new d.default(e,r,r,u.default.ROWS),size:s})}return i}var r=[];if(e&&e.length)r=e.map(function(e){return i(e.sheetId,e.startRowIndex,e.endRowIndex)}).reduce(function(e,t){return e.concat(t)});else{var c=a.selectData.select;r=i(n,c.yRange[0],c.yRange[1])}var h=[{requestId:l.default.MERGE_CELLS_REQUEST,opt:{sheetId:n,gridRanges:e}}];r.length&&h.push({requestId:l.default.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:n,dimensionModifiers:r}});return t.behavior.apply({type:"local",sheetId:n,requestId:l.default.MULTI_REQUEST,opt:{sheetId:n,gridRanges:e,requests:h}})},t.unmergeCells=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.UNMERGE_CELLS_REQUEST,opt:{sheetId:t.spreadsheet.getActiveSheetId(),gridRanges:e}})},t.insertRows=P,t.insertColumns=L,t.hideRows=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_HIDE_REQUEST,opt:{type:u.default.ROWS,sheetId:t.spreadsheet.getActiveSheetId(),dimensionRanges:e}})},t.hideColumns=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_HIDE_REQUEST,opt:{type:u.default.COLUMNS,sheetId:t.spreadsheet.getActiveSheetId(),dimensionRanges:e}})},t.showRows=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_SHOW_REQUEST,opt:{type:u.default.ROWS,sheetId:t.spreadsheet.getActiveSheetId(),dimensionRanges:e}})},t.showColumns=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_SHOW_REQUEST,opt:{type:u.default.COLUMNS,sheetId:t.spreadsheet.getActiveSheetId(),dimensionRanges:e}})},t.deleteRows=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.DELETE_DIMENSION_REQUEST,opt:{type:u.default.ROWS,sheet:e.spreadsheet.activeSheet}})},t.deleteColumns=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.DELETE_DIMENSION_REQUEST,opt:{type:u.default.COLUMNS,sheet:e.spreadsheet.activeSheet}})},t.resizeRows=function(e,t){var a=e.map(function(e,a){var n=function(e){if(t instanceof Array){var a=Math.min(e,t.length-1);return t[a]}return t}(a);return{dimensionRange:e,size:n}}),n=s.default.window.SpreadsheetApp;return n.behavior.apply({type:"local",sheetId:n.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:n.spreadsheet.getActiveSheetId(),dimensionModifiers:a}})},t.resizeColumns=function(e,t){var a=s.default.window.SpreadsheetApp,n=a.view.canvas.excel,o=e.map(function(e,a){var o=function(e){if("number"===typeof t)return t;if(t instanceof Array&&t.length>0){var a=Math.min(e,t.length-1);return t[a]}return n.configData.colWidth}(a);return{dimensionRange:e,size:o}});t instanceof Array&&(o=o.filter(function(e){var t=e.dimensionRange.startIndex,a=e.dimensionRange.endIndex;if(t!==a)return!0;var o=e.size,i=n.tableData.col.getWidth(t);return o!==i}));if(!o||!o.length)return i.default.resolve();return a.behavior.apply({type:"local",sheetId:a.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:a.spreadsheet.getActiveSheetId(),dimensionModifiers:o}})},t.resizeRowsColumns=function(e){if(!e||!e.length)return i.default.resolve();var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_DIMENSION_SIZE_REQUEST,opt:{sheetId:t.spreadsheet.getActiveSheetId(),dimensionModifiers:e}})},t.moveRows=function(e,t){var a=s.default.window.SpreadsheetApp;return a.behavior.apply({type:"local",sheetId:a.spreadsheet.getActiveSheetId(),requestId:l.default.MOVE_DIMENSION_REQUEST,opt:{type:u.default.ROWS,sheetId:a.spreadsheet.getActiveSheetId(),to:t,from:e}})},t.moveColumns=function(e,t){var a=s.default.window.SpreadsheetApp;return a.behavior.apply({type:"local",sheetId:a.spreadsheet.getActiveSheetId(),requestId:l.default.MOVE_DIMENSION_REQUEST,opt:{type:u.default.COLUMNS,sheetId:a.spreadsheet.getActiveSheetId(),to:t,from:e}})},t.setRowFormData=function(e,t){var a=s.default.window.SpreadsheetApp,n=a.spreadsheet.getActiveSheetId();return a.behavior.apply({type:"local",sheetId:n,requestId:l.default.SET_DIMENSION_FORMDATA_REQUEST,opt:{type:u.default.ROWS,sheetId:n,dimensionRanges:e,formDatas:t}})},t.setColFormData=function(e,t){var a=s.default.window.SpreadsheetApp,n=a.spreadsheet.getActiveSheetId();return a.behavior.apply({type:"local",sheetId:n,requestId:l.default.SET_DIMENSION_FORMDATA_REQUEST,opt:{type:u.default.COLUMNS,sheetId:n,dimensionRanges:e,formDatas:t}})},t.reorder=function(e,t,a){var n=s.default.window.SpreadsheetApp;return n.behavior.apply({type:"local",sheetId:n.spreadsheet.getActiveSheetId(),requestId:l.default.REORDER_RANGE_REQUEST,opt:{sheetId:n.spreadsheet.getActiveSheetId(),hasTitle:t,reorderInfos:e,gridRange:a}})},t.freeze=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.FREEZE_REQUEST,opt:(0,o.default)({sheetId:t.spreadsheet.getActiveSheetId()},e)})},t.userEnter=function(e){var t=e.text,a=e.colIndex,n=e.rowIndex,o=e.isChanged,r=void 0===o?void 0===e.isTextChanged||e.isTextChanged:o,u=e.isTextFormatRunsChanged,d=void 0===u||u,c=e.textFormatRuns,h=void 0===c?null:c,f=e.mentionDetailsMap;if(void 0===a||void 0===n)return M.default.monitor(33651147),i.default.reject();var p=s.default.window.SpreadsheetApp;if(p.getCurrentMainThreadWorker().sheetData.triggerAutoUpdateFormulaUpdate(),(0,T.isFormula)(t)){var v=[].slice.call(p.spreadsheet.getSheets(),0).map(function(e){return e.getTitle()}),_=p.spreadsheet.activeSheet.getIndex();t=(0,m.formulaAutofix)(t,v,_);var E=p.calcController.getItemByRowColOnCurrentSheet(n,a);if((0,T.isFormulaNode)(E)&&E.formulaModel&&E.formulaModel.toString(n,a)===t){var g=p.spreadsheet.activeSheet,S=g.getCellDataAtPosition(n,a);if(!S)return i.default.resolve();var R=S.getUserEnteredFormat();if(!R)return i.default.resolve();var A=R.getNumberFormat();if(!A||!(0,O.isTextCell)(A))return i.default.resolve()}}var w=p.spreadsheet.getActiveSheetId();return p.behavior.apply({type:"local",sheetId:w,requestId:l.default.SET_SINGLE_VALUE_REQUEST,opt:{rowIndex:n,colIndex:a,userEnterValue:t,isChanged:r,textFormatRuns:h,isTextFormatRunsChanged:d,sheetId:w,mentionDetailsMap:f}})},t.userEnterToSheetId=function(e,t,a,n){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",sheetId:n,requestId:l.default.SET_SINGLE_VALUE_REQUEST,opt:{rowIndex:t,colIndex:a,userEnterValue:e,sheetId:n}})},t.userRangeEnter=function(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();t.toggle&&(a=t.toggle.from);return t.behavior.apply({type:"local",sheetId:a,requestId:l.default.SET_RANGE_VALUE_REQUEST,opt:{data:e,sheetId:a}})},t.addImage=F,t.updateImage=function(e){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.UPDATE_IMAGE_REQUEST,opt:e})},t.deleteImage=function(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();Array.isArray(e)&&e.length>0&&e[0]&&e[0].sheetId?a=e[0].sheetId:!Array.isArray(e)&&e&&e.sheetId&&(a=e.sheetId);return t.behavior.apply({type:"local",sheetId:a,requestId:l.default.DELETE_IMAGE_REQUEST,opt:e})},t.insertLink=function(){var e=s.default.window.SpreadsheetApp;return new i.default(function(t,a){t(),e.view.canvas.pluginsApi.cardCenter.insertLink()})},t.fontBold=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.BOLD,formatValue:e}})},t.autoWrap=function(e,t){var a=s.default.window.SpreadsheetApp;return a.behavior.apply({type:"local",sheetId:a.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.WRAP_STRATEGY,formatValue:e,gridRange:t||null}})},t.fontItalics=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.ITALIC,formatValue:e}})},t.fontUnderLine=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.UNDERLINE,formatValue:e}})},t.fontStrike=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.STRIKE_THROUGH,formatValue:e}})},t.setFontFamliy=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.FONT_FAMINY,formatValue:e}})},t.setFontSize=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.FONT_SIZE,formatValue:e}})},t.setFontColor=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.COLOR,formatValue:e}})},t.setBorder=function(e,t,a){var o={};switch(t){case"all":o[y.BORDER_TYPE.TOP]=!0,o[y.BORDER_TYPE.LEFT]=!0,o[y.BORDER_TYPE.RIGHT]=!0,o[y.BORDER_TYPE.BOTTOM]=!0,o[y.BORDER_TYPE.MIDDLE]=!0,o[y.BORDER_TYPE.CENTER]=!0;break;case"top":o[y.BORDER_TYPE.TOP]=!0;break;case"left":o[y.BORDER_TYPE.LEFT]=!0;break;case"bottom":o[y.BORDER_TYPE.BOTTOM]=!0;break;case"right":o[y.BORDER_TYPE.RIGHT]=!0;break;case"outer":o[y.BORDER_TYPE.TOP]=!0,o[y.BORDER_TYPE.RIGHT]=!0,o[y.BORDER_TYPE.BOTTOM]=!0,o[y.BORDER_TYPE.LEFT]=!0;break;case"inner":o[y.BORDER_TYPE.MIDDLE]=!0,o[y.BORDER_TYPE.CENTER]=!0;break;case"vertical":o[y.BORDER_TYPE.CENTER]=!0;break;case"horizontal":o[y.BORDER_TYPE.MIDDLE]=!0;break;case"clear":case"none":e.color=null,e.style=null,o[y.BORDER_TYPE.TOP]=!0,o[y.BORDER_TYPE.RIGHT]=!0,o[y.BORDER_TYPE.BOTTOM]=!0,o[y.BORDER_TYPE.LEFT]=!0,o[y.BORDER_TYPE.MIDDLE]=!0,o[y.BORDER_TYPE.CENTER]=!0;break;case"custom":a&&(0,n.default)(a.group).forEach(function(e){o[e]=a.group[e]})}var i=s.default.window.SpreadsheetApp;return i.behavior.apply({type:"local",sheetId:i.spreadsheet.getActiveSheetId(),requestId:l.default.SET_BORDERS_REQUEST,opt:{type:o,props:e}})},t.setHideGridlines=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_HIDE_GRIDLINES_REQUEST,opt:{hideGridlines:e,sheetId:t.spreadsheet.getActiveSheetId()}})},t.setBackgroundColor=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.BACKGROUND_COLOR,formatValue:e}})},t.inserFunction=function(e){return new i.default(function(t,a){t();var n=s.default.window.SpreadsheetApp;n.view.canvas.excel.insertFormula({formula:e})})},t.setVerticalAlign=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.VERTICAL_ALIGN,formatValue:e}})},t.setHorizontalAlign=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_FORMAT_REQUEST,opt:{formatItem:c.default.HORIZONTAL_ALIGN,formatValue:e}})},t.clearFormat=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.CLEAR_FORMAT_REQUEST,opt:{}})},t.clearContent=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.CLEAR_RANGE_REQUEST,opt:{}})},t.setLink=function(e,t,a,n){var o=s.default.window.SpreadsheetApp;return o.behavior.apply({type:"local",sheetId:o.spreadsheet.getActiveSheetId(),requestId:l.default.SET_LINK_REQUEST,opt:{rowIndex:a,colIndex:n,userEnterValue:e,linkUrl:t}})},t.clearLink=function(e,t){var a=s.default.window.SpreadsheetApp;return a.behavior.apply({type:"local",sheetId:a.spreadsheet.getActiveSheetId(),requestId:l.default.CLEAR_LINK_REQUEST,opt:{rowIndex:e,colIndex:t}})},t.numberFormat=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.SET_NUMBER_FORMAT_REQUEST,opt:{pattern:e}})},t.decreaceDecimal=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.ADJUST_DECIMALS_REQUEST,opt:{decimalsDelta:-1}})},t.increaceDecimal=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.ADJUST_DECIMALS_REQUEST,opt:{decimalsDelta:1}})},t.replace=U,t.smartSelection=function(e){var t=s.default.window.SpreadsheetApp,a=e.changes,n=e.mergeCells,o=e.range,i=e.originCell;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.AUTO_FILL_REQUEST,opt:{sheetId:t.spreadsheet.getActiveSheetId(),changes:a,mergeCells:n,range:o,originCell:i}})},t.undo=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"undo",sheetId:e.spreadsheet.getActiveSheetId(),requestId:-1})},t.redo=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"redo",sheetId:e.spreadsheet.getActiveSheetId(),requestId:-2})},t.setBasicFilter=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.SET_BASIC_FILTER_REQUEST,opt:{sheetId:e.spreadsheet.getActiveSheetId()}})},t.clearBasicFilter=function(){var e=s.default.window.SpreadsheetApp;return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.CLEAR_BASIC_FILTER_REQUEST,opt:{sheetId:e.spreadsheet.getActiveSheetId()}})},t.updateFilterCriteria=function(e){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.UPDATE_FILTER_CRITERIA_REQUEST,opt:e})},t.applyPasteData=function(e){var t=s.default.window.SpreadsheetApp;return t&&t.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.PASTE_DATA_REQUEST,opt:e})},t.reorderWithFilter=function(e){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.REORDER_FILTER_REQUEST,opt:e})},t.insideSheetCopyPaste=function(e){var t=s.default.window.SpreadsheetApp;return t&&t.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.PASTE_DATA_REQUEST,opt:e})},t.defineFormRange=function(){var e=s.default.window.SpreadsheetApp,t=e.spreadsheet.activeSheet.getCellDataAtPosition(e.view.canvas.excel.selectData.active.yIndex,e.view.canvas.excel.selectData.active.xIndex);t||(t=new g.default);if(t.getSheetRange())return;var a=(0,R.getRandomWorkbookRangeId)();return e.behavior.apply({type:"local",sheetId:e.spreadsheet.getActiveSheetId(),requestId:l.default.DEFINE_COMMENT_RANGE_REQUEST,opt:{id:a},canUndoRedo:!1})},t.insertImage=function(){var e=s.default.window.SpreadsheetApp,t=e.view.canvas.excel.selectData.active.xIndex,a=e.view.canvas.excel.selectData.active.yIndex,n=e.spreadsheet.getActiveSheetId(),o=(0,v.default)();if(null===o)return;o.then(function(e){console.log("\u4e0a\u4f20\u56fe\u7247\u6210\u529f"),e.forEach(function(e){e.x=t,e.y=a,e.sheetId=n,F(e)});try{M.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_insert"})}catch(o){}},function(){console.warn("\u4e0a\u4f20\u56fe\u7247\u5931\u8d25")})},t.defineCommentRange=function(e){var t=s.default.window.SpreadsheetApp,a=t.view.canvas.excel.selectData.active.yIndex,n=t.view.canvas.excel.selectData.active.xIndex;if(isNaN(a)||isNaN(n))throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");if(!e)throw new Error("\u6ca1\u6709\u8f93\u5165 sheetRangeId");var o=t.spreadsheet.activeSheet.getCellDataAtPosition(a,n);o||(o=new g.default);for(var i,r=o.getSheetRange()||[],u=0;i=r[u++];)if(i.type===S.default.COMMENT_RANGE)return;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.DEFINE_COMMENT_RANGE_REQUEST,opt:{sheetId:t.spreadsheet.getActiveSheetId(),sheetRangeId:e,sheetRangeType:S.default.COMMENT_RANGE},canUndoRedo:!1})},t.deleteCommentRange=function(e){console.warn("delete range");var t=s.default.window.SpreadsheetApp,a=t.view.canvas.excel.selectData.active.yIndex,n=t.view.canvas.excel.selectData.active.xIndex;e&&(n=e.startColIndex,a=e.startRowIndex);if(isNaN(a)||isNaN(n))throw new Error("\u6ca1\u6709\u5b9a\u4f4d\u5230\u5355\u5143\u683c");var o=t.spreadsheet.activeSheet.getCellDataAtPosition(a,n);if(!o)return;for(var i,r=o.getSheetRange()||[],u=0;i=r[u++];)if(i.type===S.default.COMMENT_RANGE)return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.DELETE_COMMENT_RANGE_REQUEST,opt:{sheetId:t.spreadsheet.getActiveSheetId(),sheetRangeId:i.id},canUndoRedo:!1});return},t.dataValidation=function(e){var t=s.default.window.SpreadsheetApp,a=(0,D.getDataValidationConfig)(e);if(null===a)return null;try{M.default.tdwReport({opername:"doc_edit",module:"excel",action:"data_validation",obj3:a.ruleType})}catch(n){}return t.behavior.apply({type:"local",requestId:l.default.SET_DATA_VALIDATION_REQUEST,sheetId:t.spreadsheet.getActiveSheetId(),opt:{dataValidation:a,gridRange:e.selection}})},t.clearDataValidation=function(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",requestId:l.default.SET_DATA_VALIDATION_REQUEST,sheetId:t.spreadsheet.getActiveSheetId(),opt:{dataValidation:null,gridRange:e}})},t.doPaste=function(e){var t=e.plugins.copyPaste.getPasteType();if(I.isPad){if(t===A.CANPASTETYPE.NONE&&C.default.isCopyInEnv()){var a=C.default.getServerCopyData();if(a.plain)return void e.plugins.copyPaste.doClipboardPaste({html:a.html||"",plain:a.plain})}if(I.isTencentDocApp)return void(0,w.syncMobileClipboard)(function(t){var a={},n=0,o=e.plugins.copyPaste,i=o.copyPasteCache.getCacheState().clipboardCopyData;parseInt(i.timeStamp)>n&&(n=parseInt(i.timeStamp),a=i);var r=(0,w.getCopyPlainCache)();if(parseInt(r.timeStamp)>n){n=parseInt(r.timeStamp),a=r;try{a===r&&M.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_ctrl_paste"})}catch(s){}}t.timeStamp>n&&(n=t.timeStamp,a=t),e.plugins.copyPaste.doClipboardPaste({html:a.html||"",plain:a.plain||""})})}if(t===A.CANPASTETYPE.NONE)return void(I.isPCClient&&((0,N.hideToast)(),(0,N.showToast)("\u526a\u5207\u677f\u91cc\u7684\u5185\u5bb9\u53ef\u80fd\u88ab\u5916\u90e8\u7a0b\u5e8f\u6e05\u9664\u4e86\uff0c\u5f53\u524d\u6ca1\u6709\u53ef\u4ee5\u7c98\u8d34\u7684\u5185\u5bb9",void 0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,N.hideToast)()}})));if(t===A.CANPASTETYPE.CLIPBOARD)e.plugins.copyPaste.onPastePCClient();else{var n=e.plugins.copyPaste.getPasteType();if(n===A.CANPASTETYPE.NONE)return void(I.isPCClient&&((0,N.hideToast)(),(0,N.showToast)("\u526a\u5207\u677f\u91cc\u7684\u5185\u5bb9\u53ef\u80fd\u88ab\u5916\u90e8\u7a0b\u5e8f\u6e05\u9664\u4e86\uff0c\u5f53\u524d\u6ca1\u6709\u53ef\u4ee5\u7c98\u8d34\u7684\u5185\u5bb9",void 0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,N.hideToast)()}})));if(n===A.CANPASTETYPE.CLIPBOARD)e.plugins.copyPaste.onPastePCClient();else{var o=e.plugins.copyPaste,i=o.copyPasteCache.getCacheState().clipboardCopyData,r=(0,w.getCopyPlainCache)(),s=i.timeStamp>r.timeStamp?i:r,l={html:s.html,plain:s.plain};if(C.default.isCopyInEnv()){var u=C.default.getServerCopyData();u.timeStamp>Number(i.timeStamp)&&u.plain!==l.plain&&(l.html=u.html||"",l.plain=u.plain)}e.plugins.copyPaste.doClipboardPaste(l);try{s===r&&M.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_ctrl_paste"})}catch(d){}localStorage&&null==localStorage.getItem("pasteTip")&&(localStorage.setItem("pasteTip","true"),(0,N.hideToast)(),(0,N.showToast)("\u53f3\u952e\u4e0d\u652f\u6301\u7c98\u8d34\u5916\u90e8\u5185\u5bb9\uff0c\u8bf7\u4f7f\u7528Ctrl+V\u7c98\u8d34\u3002",void 0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,N.hideToast)()}}))}}},t.inserRowWithLogic=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=s.default.window.SpreadsheetApp,n=a.spreadsheet.activeSheet.getRowCount(),o=a.spreadsheet.activeSheet.getColCount(),i=a.view.canvas.excel.selectData.select.yRange[0],r=a.view.canvas.excel.selectData.select.yRange[1],l=a.view.canvas.excel.selectData.select.selectRow,u=a.spreadsheet.activeSheet.data.rowMetadata,d=0,c=void 0;for(c=i;c<i+e;c++)if(void 0===u[c]||null===u[c])d++;else{if(u[c]&&(!0===u[c].hiddenByFilter||!0===u[c].hiddenByUser))continue;d++}(n+d)*o<y.MAX_CELL_COUNT?P(t?[{index:i+d,amount:d}]:[{index:i,amount:d}]):k.dialog.confirm("\u63d2\u5165\u884c\u5217\u5931\u8d25","\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",function(){},function(){return s.default.window.getPadMultiSheetController&&s.default.window.getPadMultiSheetController().addNewSheet(),!0});try{if(l&&r-i===0){var h=d>1?"more":"one";M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+h+"_row"})}else l&&r-i>0?M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_row"}):M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_row"});e!==r-i+1&&M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_col"})}catch(f){}},t.insertColWithLogic=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=s.default.window.SpreadsheetApp,n=a.spreadsheet.activeSheet.getRowCount(),o=a.spreadsheet.activeSheet.getColCount(),i=a.view.canvas.excel.selectData.select.xRange[0],r=a.view.canvas.excel.selectData.select.xRange[0],l=a.view.canvas.excel.selectData.select.selectCol,u=a.spreadsheet.activeSheet.data.columnMetadata,d=0,c=void 0;for(c=i;c<i+e;c++)if(void 0===u[c]||null===u[c])d++;else{if(u[c]&&(!0===u[c].hiddenByFilter||!0===u[c].hiddenByUser))continue;d++}n*(o+d)<y.MAX_CELL_COUNT?L(t?[{index:i+d,amount:d}]:[{index:i,amount:d}]):k.dialog.confirm("\u63d2\u5165\u884c\u5217\u5931\u8d25","\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",function(){},function(){return s.default.window.getPadMultiSheetController&&s.default.window.getPadMultiSheetController().addNewSheet(),!0});try{if(l&&r-i===0){var h=d>1?"more":"one";M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+h+"_col"})}else l&&r-i>0?M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_col"}):M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_col"});e!==r-i+1&&M.default.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_row"})}catch(f){}},t.freezePreview=function(e){var t=s.default.window.SpreadsheetApp.view.canvas.excel;t.setFrozenPreviewState(),t.updateFrozenRow(Math.max(0,e.row||0)),t.updateFrozenCol(Math.max(0,e.column||0))},t.cancelFreezePreview=function(){var e=s.default.window.SpreadsheetApp,t=e.view.canvas.excel,a=e.spreadsheet.activeSheet,n=a.properties.gridProperties.frozenRowCount,o=a.properties.gridProperties.frozenColCount;t.cacelFrozenPreviewState(),t.updateFrozenRow(Math.max(0,n)),t.updateFrozenCol(Math.max(0,o))},t.cacelFrozenPreviewState=function(){s.default.window.SpreadsheetApp.view.canvas.excel.cacelFrozenPreviewState()},t.addConditionFormat=function(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();return t.behavior.apply({type:"local",requestId:l.default.ADD_CONDITIONAL_FORMAT_REQUEST,sheetId:a,opt:e})},t.deleteConditionFormat=function(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();return t.behavior.apply({type:"local",requestId:l.default.DELETE_CONDITIONAL_FORMAT_REQUEST,sheetId:a,opt:e})},t.updateConditionFormat=function(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();return t.behavior.apply({type:"local",requestId:l.default.UPDATE_CONDITIONAL_FORMAT_REQUEST,sheetId:a,opt:e})},t.setSheet=function(e){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",requestId:l.default.SET_SHEETS_REQUEST,sheetId:e.sheetId,opt:e,canUndoRedo:!1})};var r=b(a(40)),s=b(a(7)),l=b(a(13)),u=b(a(15)),d=b(a(35)),c=b(a(688)),h=b(a(11)),f=b(a(405)),p=a(68),v=b(a(691)),_=a(51),E=b(a(18)),T=a(44),m=a(1311),g=b(a(54)),S=b(a(173)),R=a(316),A=a(408),w=a(409),I=a(22),C=b(a(289)),y=a(33),O=a(48),D=a(98),N=a(71),M=b(a(8)),k=a(99);function b(e){return e&&e.__esModule?e:{default:e}}s.default.window;function P(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.INSERT_DIMENSION_REQUEST,opt:{type:u.default.ROWS,sheet:t.spreadsheet.activeSheet,insertInfo:e}})}function L(e){var t=s.default.window.SpreadsheetApp;return t.behavior.apply({type:"local",sheetId:t.spreadsheet.getActiveSheetId(),requestId:l.default.INSERT_DIMENSION_REQUEST,opt:{type:u.default.COLUMNS,sheet:t.spreadsheet.activeSheet,insertInfo:e}})}function F(e){return s.default.window.SpreadsheetApp.behavior.apply({type:"local",sheetId:e.sheetId,requestId:l.default.ADD_IMAGE_REQUEST,opt:{type:"IMAGE",id:e.id,url:e.url,width:e.width,height:e.height,sheetId:e.sheetId,x:e.x,y:e.y,offsetX:0,offsetY:0,clipInfo:e.clipInfo}})}var x=function(){var e=void 0,t=void 0,a=0|1<<E.default.SLOT_USER_ENTERED_FORMAT_DELTA;return{setCache:function(n,o){var i=n.startRowIndex,r=n.endRowIndex,l=n.startColIndex,u=n.endColIndex;(t=new f.default({spreadsheetApp:o,config:{setSlots:a,tile:!1,isFormatPainter:!0}})).onCopy({from:(0,_.convertGridRangeToIXYRange)(n),copyType:p.CopyType.copy,hotInstance:o});var d=s.default.window.SpreadsheetApp;return e=new h.default(d.spreadsheet.getActiveSheetId(),i,r,l,u)},apply:function(){if(e&&t){var n=t.spreadsheetApp,o=t.getCacheData();o.cellMask=a;var i=(0,_.convertGridRangeToIXYRange)(n.view.getSelection().rangeSelections[0]);t.onPaste({to:i,hotInstance:n,pasteData:o,config:{tile:!0}})}},clear:function(){e=null}}}();function U(e){var t=s.default.window.SpreadsheetApp,a=t.spreadsheet.getActiveSheetId();return e&&e[0]&&e[0].sheetId&&(a=e[0].sheetId),t.behavior.apply({type:"local",sheetId:a,requestId:l.default.REPLACE_ALL_REQUEST,opt:e})}t.formatPainter=x,r.default.search.listen("replace",U)},113:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(16),i=(n=o)&&n.__esModule?n:{default:n};t.isNumber=function(e){return"[object Number]"===Object.prototype.toString.call(e)&&!isNaN(e)},t.isNull=function(e){return"[object Null]"===Object.prototype.toString.call(e)},t.clone=function(e){return JSON.parse((0,i.default)(e))},t.isString=function(e){return"String"===Object.prototype.toString.call(e).slice(8,-1)},t.isObject=function(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)},t.arrayEqual=function(e){var t=e;if(this===t)return!0;if(this instanceof Array===!1||t instanceof Array===!1||this.length!==t.length)return!1;for(var a=0;a<this.length;a++)if(this[a]!==t[a])return!1;return!0},t.throttle=function(e,t,a,n){var o=void 0;return n="undefined"===typeof n||n,function(){var i=arguments,r=this;return"undefined"!==typeof a&&(r=a),n?(e.apply(r,i),n=!1):!o&&void(o=setTimeout(function(){clearTimeout(o),o=null,e.apply(r,i)},t))}}},1130:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.DATA_VERSION_TOO_LOW="DataVersionTooLow"}(n||(n={})),t.default=n},1138:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=a(22),r=a(1139);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.buttonMenuDom=$(".hp-ui-button-menu"),this.menuDom=$(".hp-ui-button-menu-wrapper a"),this.type=t.type,this.title=t.title,this.content=t.content,this.inputMaxLength=t.inputMaxLength,this.inputOverflowTips=t.inputOverflowTips,this.buttons=t.buttons,this.onClose=t.onClose,this.dialogDom=null,this.dialogInputDom=null,this.dialogInputErrorDom=null,this.cdn=clientVars&&clientVars.cdn?clientVars.cdn:"",this.init()}return(0,o.default)(e,[{key:"createDom",value:function(e,t,a){var n=$(document.createElement(t));return n.addClass(a),e.append(n),n}},{key:"show",value:function(){var e=this;this.dialogDom=this.createDom($(document.body),"div","m-component-dialog"),this.dialogDom.on("touchmove",function(e){e.preventDefault()}),this.createDom(this.dialogDom,"div","m-component-dialog-mask").on("touchstart touchend",function(e){e.preventDefault()});var t=this.createDom(this.dialogDom,"div","m-component-dialog-body"),a=this.createDom(t,"div","m-component-dialog-title");this.title&&this.title.length>0&&a.text(this.title),a.on("touchstart touchend",function(e){e.preventDefault()});var n=this.createDom(t,"div","m-component-dialog-content");if("InputBox"===this.type){t.addClass("m-component-dialog-body-input"),document.body.clientHeight<500&&((0,r.isPortrait)()?t.css("top",96):t.css("top",72));var o=this.createDom(n,"div","m-component-dialog-input-box"),i=o[0].clientWidth-28;this.dialogInputDom=this.createDom(o,"input","m-component-dialog-input"),this.dialogInputDom.css("width",i),this.dialogInputDom.attr("spellcheck","false"),this.dialogInputDom.attr("required","required"),this.content&&this.content.length>0&&this.dialogInputDom.val(this.content),this.bindInputListener(this.dialogInputDom);var s=this.createDom(o,"div","m-component-dialog-input-clear");this.createDom(s,"div","clear-image");this.addTap(s,function(){e.dialogInputDom.val(""),e.inputBoxValChange()}),this.dialogInputErrorDom=this.createDom(n,"div","m-component-dialog-input-error-hidden");var l=document.createElement("p");this.dialogInputErrorDom.append(l),n.append(this.dialogInputErrorDom)}else{if(this.content&&this.content.length>0)this.createDom(n,"div","m-component-dialog-message").text(this.content)}for(var u=this.createDom(t,"div","m-component-dialog-footer"),d=0;d<this.buttons.length;d++){var c=this.buttons[d];if(c.label&&c.label.length>0){var h=$(document.createElement("a"));h.addClass("m-component-dialog-button");var f="m-component-dialog-btn-default";"primary"===c.type?f="m-component-dialog-btn-primary":"danger"===c.type&&(f="m-component-dialog-btn-danger"),h.addClass(f),h.text(c.label),u.append(h),this.bindButtonListener(h,c)}}"InputBox"===this.type&&this.focusInputBox()}},{key:"close",value:function(){this.onClose&&this.onClose(),this.dialogDom.remove()}},{key:"getInputText",value:function(){return this.dialogInputDom.val()}},{key:"showInputErrorTips",value:function(e){this.dialogInputErrorDom.addClass("m-component-dialog-input-error"),this.dialogInputErrorDom.children("p").text(e),this.focusInputBox()}},{key:"checkInputError",value:function(){var e=!1;if(this.inputMaxLength&&this.inputMaxLength>0&&this.dialogInputDom.val().length>this.inputMaxLength){var t="\u8f93\u5165\u5185\u5bb9\u8fc7\u957f\u3002";this.inputOverflowTips&&this.inputOverflowTips.length>0&&(t=this.inputOverflowTips),this.showInputErrorTips(t),e=!0}return e}},{key:"focusInputBox",value:function(){var e=this;i.isIOS?this.dialogInputDom.focus():setTimeout(function(){e.dialogInputDom.focus().click()},100)}},{key:"inputBoxValChange",value:function(){this.checkInputError()&&this.dialogInputErrorDom.removeClass("m-component-dialog-input-error")}},{key:"bindInputListener",value:function(e){var t=this;e.on("input propertychange change",function(){t.inputBoxValChange()}),e.blur(function(){if(i.isIOS)for(var e=0;e<t.buttons.length;e++){var a=t.buttons[e];if("primary"===a.type){a.onclick&&"function"===typeof a.onclick&&a.onclick(t);break}}})}},{key:"bindButtonListener",value:function(e,t){var a=this;e.on("click",function(e){t.onclick&&"function"===typeof t.onclick?t.onclick(a,e):a.close()})}},{key:"addTap",value:function(e,t){e.on("touchstart",function(e){var t=e.originalEvent.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()}),e.on("touchend",function(e){e.preventDefault();var a=e.originalEvent.changedTouches[0],n=a.clientX,o=a.clientY;void 0===this.touchT||Date.now()>this.touchT+400||Math.abs(o-this.touchY)>30||Math.abs(n-this.touchX)>30||t()})}},{key:"init",value:function(){var e=this;this.buttonMenuDom.on("click",function(){var t=e.buttonMenuDom;if(!t.attr("disabled")){$("#tooltip").remove();var a=t.hasClass("hp-ui-button-menu-reverse"),n=t.find(".hp-ui-button-menu-wrapper"),o=t.find(".hp-ui-button-list-ul"),i=t.find(".hp-ui-button-list-ul li"),r=-1;if(t.data("close",e.buttonCloseMenu),n.is(":visible"))e.buttonCloseMenu(t);else{o.css("min-width",t.outerWidth()+"px"),n.show(),t.addClass("hp-ui-button-active");var s=Math.max(200,Math.min($("body").height()-o.offset().top-50,435));o.css("max-height",s+"px"),a&&o.css("top","-"+(o.outerHeight()+t.outerHeight()+10)+"px"),window.setTimeout(function(){$("body").on("keydown.hp-ui-button-menu",function(a){if(n.is(":hidden"))return!0;var s=r;switch(a.keyCode){case 13:return o.find("li.hp-ui-button-menuitem-selected > a").trigger("click"),!1;case 27:return e.buttonCloseMenu(t),!1;case 38:r=r-1<0?i.length-1:r-1;break;case 40:r=(r+1)%i.length;break;default:return!0}return o.find("li:nth-child("+(s+1)+")").removeClass("hp-ui-button-menuitem-selected"),o.find("li:nth-child("+(r+1)+")").addClass("hp-ui-button-menuitem-selected"),!1}).on("click.hp-ui-button-menu",function(){e.buttonCloseMenu(t)})},0)}}}),this.menuDom.on("click",function(){if(!e.menuDom.hasClass("hp-ui-button-menu-disabled")){var t=e.menuDom.closest(".hp-ui-button");t.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.buttonCloseMenu(t)}})}},{key:"buttonCloseMenu",value:function(e){$("body").off(".hp-ui-button-menu"),e.find(".hp-ui-button-menu-wrapper").hide(),e.removeClass("hp-ui-button-active"),e.find(".hp-ui-button-menuitem-selected").removeClass("hp-ui-button-menuitem-selected"),e.trigger("menu-closed")}}]),e}();t.default=l},1139:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.addTap=function(e,t){var a=void 0;a="function"===typeof t?t:t.tap;return e.addEventListener("touchstart",function(e){var a=e.touches[0];this.touchX=a.clientX,this.touchY=a.clientY,this.touchT=Date.now(),e.stopPropagation(),t.preventDefault&&e.preventDefault(),t.touchStart&&t.touchStart()}),e.addEventListener("touchend",function(a){var n=a.changedTouches[0],o=n.clientX,i=n.clientY;if(!(void 0===this.touchT||Math.abs(i-this.touchY)>30||Math.abs(o-this.touchX)>30)){if(e.ontap)e.ontap();else{var r=document.createEvent("HTMLEvents");r.initEvent("tap",!1,!0),e.dispatchEvent(r)}t.touchEnd&&t.touchEnd()}}),a&&e.addEventListener("tap",a,!1),e},t.addInputChange=function(e,t){var a=!1;return e.addEventListener("compositionstart",function(e){a=!0}),e.addEventListener("compositionend",function(e){a=!1,t.throttle?t.throttle(200)(e.target.value):t(e.target.value)}),e.addEventListener("input",function(e){a||(t.throttle?t.throttle(200)(e.target.value):t(e.target.value))}),e},t.addEvent=function(e,t,a){return e.addEventListener(t,function(e){a(e)}),e},t.addClass=function(e,t){if(!e)return;e.classList.add(t)},t.removeClass=function(e,t){if(!e)return;e.classList.remove(t)},t.showComponent=function(e){if(!e)return;"none"===e.style.display&&(e.style.display="block")},t.hideComponent=function(e){if(!e)return;e.style.display="none"},t.setStyle=function(e,t,a){if(!e)return;e.style[t]=a},t.$$=function(e){return document.querySelector(e)},t.makeTranslate=function(e,t,a){var n,o,i=a||"y",r=e||"";if("x"!=i&&"y"!=i||"string"!=typeof r)return r;"x"==a?(n=" translateX("+t+"px)",o=/translateX\(\d+(px)?\)/i):(n=" translateY("+t+"px)",o=/translateY\(\d+(px)?\)/i);return o.test(r)&&e.replace(o,n)||r.concat(" "+n)},t.isPortrait=function(){if("number"==typeof window.orientation)return window.orientation/90%2==0;try{var e=window.screen.orientation.angle;if("number"==typeof e)return e/90%2==0}catch(t){}return!0}},1148:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.returnModalContentWithErrCode=function(e,t){return i.default.createElement("div",null,i.default.createElement("div",null,e),i.default.createElement("div",{style:{opacity:.4}},"\u9519\u8bef\u7801:",t," ",function(){var e=new Date,t=e.getFullYear(),a=e.getMonth()+1<10?"0"+(e.getMonth()+1):e.getMonth()+1,n=e.getDate()<10?"0"+e.getDate():e.getDate();e.getHours(),e.getHours(),e.getMinutes(),e.getMinutes(),e.getSeconds(),e.getSeconds();return t+"-"+a+"-"+n}()))};var n,o=a(46),i=(n=o)&&n.__esModule?n:{default:n}},1149:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(16)),o=a(398),i=a(26),r=p(a(138)),s=p(a(8)),l=a(283),u=p(a(7)),d=a(22),c=a(1150),h=a(143),f=a(200);function p(e){return e&&e.__esModule?e:{default:e}}var v={CHECK_MUTATION_ERROR:function(e,t){var a=(0,i.getTdwObj3Value)(i.TDW_MODULE.MUTATION,e);(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.CHECK_MUTATION,obj3Value:a,ver5Value:i.TDW_VER5_VALUE.CHECK_MUTATION_ERROR,detail:[e]}),console.error("Check mutation error: ",e,t)},CHECK_MUTATION_RESULT_ERROR:function(e){var t=(0,i.getTdwObj3Value)(i.TDW_MODULE.MUTATION,e);o.AlloyReport.monitor(i.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[e.operationType]),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.CHECK_MUTATION,obj3Value:t,ver5Value:i.TDW_VER5_VALUE.CHECK_MUTATION_FAIL,detail:[e]}),e.operationType!==r.default.HISTORY&&(0,o.sentryReport)({errorType:i.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:e})},RUN_MUTATION_ERROR:function(e,t){var a=(0,i.getTdwObj3Value)(i.TDW_MODULE.MUTATION,t);e.message&&0===e.message.indexOf("ApiCheckError")?(o.AlloyReport.monitor(i.MONITOR_POINTS.CHECK_MUTATION_FAIL_MAP[t.operationType]),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.CHECK_MUTATION,obj3Value:a,ver5Value:i.TDW_VER5_VALUE.CHECK_MUTATION_FAIL,detail:[t]}),t.operationType!==r.default.HISTORY&&(0,o.sentryReport)({errorType:i.SENTRY_ERROR_TYPE.CHECK_MUTATION_ERROR,message:t,error:e})):(o.AlloyReport.monitor(i.MONITOR_POINTS.RUN_MUTATION_ERROR_MAP[t.operationType]),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.RUN_MUTATION,obj3Value:a,ver5Value:i.TDW_VER5_VALUE.RUN_MUTATION_ERROR,detail:[t]}),t.operationType!==r.default.HISTORY&&(0,o.sentryReport)({errorType:i.SENTRY_ERROR_TYPE.RUN_MUTATION_ERROR,message:t,error:e}))},AFTER_MUTATION_RUN_CATCH_ERROR:function(e,t){var a=(0,i.getTdwObj3Value)(i.TDW_MODULE.MUTATION,t);o.AlloyReport.monitor(33660169),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"afterMutationRun",obj3Value:a,ver5Value:"1",detail:[t]}),(0,o.sentryReport)({errorType:"afterMutationRunError",error:e})},COMMIT_EMPTY_MUTATION:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"mutation",actionValue:"commitEmptyMutation",detail:e})},DO_BEHAVIOR_AFTER_SHUTDOWN:function(){o.AlloyReport.monitor(34280469),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"doBehaviorAfterShutDown",ver5Value:"1"})},COMMIT_MUTATION_CATCH_ERROR:function(e,t){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"1",detail:e}),(0,o.sentryReport)({errorType:"SerializeMutationError",error:t})},COMMIT_MUTATION:function(e){o.AlloyReport.monitor(33659447),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"2",detail:e})},CACHE_DATA_FLOW_COMMIT_MUTATION:function(e){o.AlloyReport.monitor(33637651),(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"mutation",actionValue:"commitMutation",ver5Value:"0",detail:e})},PAGE_LOAD:function(e){o.AlloyReport.monitor(33631971),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"init",actionValue:"pageLoaded",ver5Value:"0",detail:e})},DUPLICATE_SHEET_ID:function(e){o.AlloyReport.monitor(33955439),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"init",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},SERIALIZE_MUTATION:function(e,t){console.log(t),o.AlloyReport.monitor(33611128),(0,o.sentryReport)({errorType:"serializeMutationError",error:t}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"serializeMutation",ver5Value:"1",detail:e})},DESERIALIZE_MUTATION:function(e,t){o.AlloyReport.monitor(33611915),(0,o.sentryReport)({errorType:"deserializeMutationError",error:t}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"deserializeMutation",ver5Value:"1",detail:e})},GET_COLLAB_MUTATIONS:function(e){o.AlloyReport.monitor(33614885),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"getCollabMutations",ver5Value:"1",detail:e})},CREATE_ZIPKETFRAME:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"keyframe",actionValue:"createZipKeyframe",ver5Value:"1",detail:e})},APPLY_NEW_CHANGES_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesError",detail:e})},LOAD_REQUEST:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"loadRequest",actionValue:"local",detail:e})},APPLY_BEHAVIOR_ERROR:function(e,t){console.error(t),(0,o.sentryReport)({errorType:"loadRequestError",message:"loadRequestError",error:t}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"1",detail:e})},APPLY_BEHAVIOR_NOT_LOADED:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"2",detail:e})},APPLY_BEHAVIOR_LEVEL_INFO:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"3",detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"4";(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:t,detail:e})},APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:function(){o.AlloyReport.monitor(33686607)},REQUEST_SIZE_OVER_LIMIT:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"applyLocal",actionValue:"requestSizeOverLimit",detail:e})},FOLLOW_REQUEST_MUTATIONS:function(e){o.AlloyReport.monitor(33641617),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"followRequestMutations",ver5Value:"1",detail:e})},SERIALIZE_MUTATION_CACHE_ERROR:function(e,t){console.log(t),o.AlloyReport.monitor(i.MONITOR_POINTS.SERIALIZE_MUTATION_ERROR),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.SERIALIZE_MUTATION,obj3Value:(0,i.getTdwObj3Value)(i.TDW_MODULE.MUTATION,e),ver5Value:i.TDW_VER5_VALUE.SERIALIZE_MUTATION_ERROR,detail:[e]}),(0,o.sentryReport)({errorType:i.SENTRY_ERROR_TYPE.SERIALIZE_MUTATION_ERROR,message:e,error:t})},DESERIALIZE_MUTATION_CACHE_ERROR:function(e,t){console.error("Deserialize mutation error: ",e,t),o.AlloyReport.monitor(i.MONITOR_POINTS.DESERIALIZE_MUTATION_ERROR),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.DESERIALIZE_MUTATION,ver5Value:i.TDW_VER5_VALUE.DESERIALIZE_MUTATION_ERROR,detail:[e]}),(0,o.sentryReport)({errorType:i.SENTRY_ERROR_TYPE.DESERIALIZE_MUTATION_ERROR,message:e,error:t})},GENERATE_MUTATION_1:function(){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.GENERATE_MUTATION,ver5Value:i.TDW_VER5_VALUE.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_OPTION,detail:["no opt"]})},GENERATE_MUTATION_2:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.GENERATE_MUTATION,ver5Value:i.TDW_VER5_VALUE.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_EXPANSION,detail:e})},GENERATE_MUTATION_3:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:i.TDW_MODULE.MUTATION,actionValue:i.TDW_ACTION.GENERATE_MUTATION,ver5Value:i.TDW_VER5_VALUE.GENERATE_MUTATION_PASTE_SETRANGE_ERROR_NO_GRIDRANGE,detail:e})},DO_KEYFRAME_CATCH_ERROR_1:function(e,t){o.AlloyReport.monitor(33614378),(0,o.sentryReport)({errorType:"doKeyframeErrorVersion3",error:t}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe",ver5Value:"1",detail:e})},DO_KEYFRAME_CATCH_ERROR_2:function(e){o.AlloyReport.monitor(33614380),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe",ver5Value:"2",detail:e})},DO_KEYFRAME_CATCH_ERROR_3:function(e){o.AlloyReport.monitor(33614379),o.AlloyReport.monitor(33955111),(0,o.sentryReport)({errorType:"doKeyframeErrorNoVersion",error:e}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe",ver5Value:"3"})},DO_KEYFRAME:function(e){o.AlloyReport.monitor(33637702),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"doKeyframe",ver5Value:"0",detail:e})},DO_MUTATIONS:function(e){o.AlloyReport.monitor(33614886),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"mutation",actionValue:"doMutations",ver5Value:"1"}),(0,o.sentryReport)({errorType:"doMutationsError",message:e})},ZIP_KEYFRAME:function(){o.AlloyReport.monitor(34364018),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"1"})},ZIP_KEYFRAME_CATCH_ERROR:function(e){o.AlloyReport.monitor(34364008),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"keyframe",actionValue:"zip",ver5Value:"2",detail:e})},COPY_PASTE:function(){console.log("textarea onPaste"),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"copyPaste",actionValue:"onPaste"})},CHOOSE_FORMAT_ERROR:function(e,t){console.warn(t),o.AlloyReport.monitor(3437448),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"numberFormat",actionValue:"chooseFormatError",detail:e})},PARSE_FORMAT_ERROR:function(e,t){console.warn(t),o.AlloyReport.monitor(3437447),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"numberFormat",actionValue:"parseFormatError",detail:e})},RETRY_SENDMESSAGE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"retrySendMessage",detail:e})},MOVE_MESSAGEINFO_COMMITING_QUEUE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"moveMessageIntoCommitingQueue",detail:e})},RETRY_COMMIT:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"retryCommit",detail:e})},SEND_USERCHANGE:function(e,t,a){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"1",obj3Value:String(a),detail:e})},SEND_USERCHANGE_1:function(e,t,a){o.AlloyReport.monitor(33639350),(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"0",obj3Value:String(a),detail:e})},HANDLE_COMMIT_ONSENDERROR:function(e,t){var a={60002:33612280,60004:33612281,60005:33612282,60011:33612283,60013:33612284,60014:33612285,60003:33612286,60008:33612287,60016:33612288,60017:33612289,60007:33612290,60015:33612291,60021:33631110,60022:33631111};a[t]?o.AlloyReport.monitor(a[t]):o.AlloyReport.monitor(33698544),u.default.window.log&&u.default.window.log.error&&u.default.window.log.error("handleCommitOnSendError",{seq:e[0],cmd:e[1],result:e[2]}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"handleCommitOnSendError",ver5Value:t.toString(),detail:e})},ACCEPT_COMMIT:function(e){o.AlloyReport.monitor(33639758),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"acceptCommit",ver5Value:"1",detail:e})},HANDLE_COMMIT_ERROR:function(e,t){var a={60018:33612308,60019:33612309,60020:33612310,40000:33612311,40001:33612312,40020:33612313,40002:33612315,40003:33612316,40005:33612317,40006:33712774,40021:33612318,40022:33612319,40023:33612320,40024:33688491,40025:33688492,40026:33688493,40027:33713210,40028:33688494,41001:33612321,41002:33612322,10000:33612314,10001:33612323};a[t]?o.AlloyReport.monitor(a[t]):o.AlloyReport.monitor(33698546),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleCommitError",ver5Value:t.toString(),detail:e})},HANDLE_TASK_DUPLICATE:function(e){o.AlloyReport.monitor(33612330),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleTaskDuplicate",detail:e})},HANDLE_ROOM_ERRORCODE:function(e,t){var a={101:33612294,102:33612295,103:33612296,104:33612297,105:33612298,106:33612299};a[t.errCode]?o.AlloyReport.monitor(a[t.errCode]):o.AlloyReport.monitor(33709329),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"handleRoomErrorCode",ver5Value:t.errCode&&t.errCode.toString(),detail:e})},HANDLE_NEW_CHANGES:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"handleNewChanges",detail:e})},APPLY_NEWCHANGES_VERROR:function(e,t){var a={collab:"1",missing:"2"};a[t]&&(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:a[t],detail:e});var n={collab:33685595,missing:33685596};n[t]&&o.AlloyReport.monitor(n[t])},DUPLICATE_MESSAGE:function(e){o.AlloyReport.monitor(33629759),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"DuplicateMessage",detail:e})},APPLY_NEWCHANGES_CATCH_ERROR:function(e){o.AlloyReport.monitor(33612332),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"1",detail:e})},APPLY_NEWCHANGES:function(e){o.AlloyReport.monitor(33638469),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"applyNewChanges",ver5Value:"0",detail:e})},CHECK_AND_APPLYNEWCHANGES:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"checkAndApplyNewChanges",detail:e})},APPLY_NEWCHANGES_VERROR2:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"applyNewChangesVError",ver5Value:"4",detail:e}),o.AlloyReport.monitor(33707992)},SWITCH_CHANEL_STATUS:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"switchChanelStatus",detail:e})},HANDLE_FETCH_RESULT:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"handleFetchResult",detail:e})},FETCH_USERCHANGES_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesError",detail:e}),o.AlloyReport.monitor(33633746)},FETCH_AND_APPLY_MISSCHANGES:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"fetchAndApplyMisschanges",detail:e})},EMPTY_KEYFRAME_BY_AUTOEXPAND:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"emptyKeyframeByAutoExpand",detail:e})},ADD_USER_CHANGE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"addUserChange",detail:e})},UPDATE_BASEVERSION:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"updateBaseVersion",detail:e})},UPDATE_BASEVERSION_ERROR:function(e){o.AlloyReport.monitor(33687853),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"updateBaseVersionError",detail:e})},ACCEPT_COMMIT_2:function(e,t){o.AlloyReport.monitor(33639756),(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:t,ver5Value:"0",detail:e})},FETCH_USERCHANGE_ARGUMENT:function(e){o.AlloyReport.monitor(33612380),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"fetchUserChangesArgument",ver5Value:"1",detail:e})},FETCH_USERCHANGES:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",detail:e})},FETCH_USERCHANGES_3:function(e){o.AlloyReport.monitor(33612438),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"fetchUserChanges",ver5Value:"1",detail:e})},INIT_DATA_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"userchange",actionValue:"initDataError",ver5Value:"1",detail:e})},STORE_DATA_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"userchange",actionValue:"storeDataError",ver5Value:"1",detail:e})},NOT_SUPPORT_INDEXEDDB:function(e){o.AlloyReport.monitor(33639031),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"notSupportIndexedDB",detail:["indexedDB is no supported."]})},OPEN_INDEXED_DB:function(e){o.AlloyReport.monitor(33709943);var t=e.code,a=e.message,n=e.name;(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"openIndexedDB",ver5Value:"2",detail:["indexedDB open failed.",t,a,n]})},NOT_SUPPORT_INDEXEDDB_2:function(e){var t=e.code,a=e.message,n=e.name;o.AlloyReport.monitor(33624010),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"openIndexedDB",ver5Value:"1",detail:["indexedDB open failed.",t,a,n]})},NOT_SUPPORT_INDEXEDDB_3:function(){o.AlloyReport.monitor(33639030),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"openIndexedDB",ver5Value:"0",detail:["indexedDB open success."]})},UPDATE_INDEXED_DB:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"updateIndexedDB",detail:e})},STORE_UNVALIABLE_WHEN_SET:function(e){o.AlloyReport.monitor(33624016),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenSet",detail:e})},INDEXDB_SET_VALUE:function(e){o.AlloyReport.monitor(33624019),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",detail:e})},INDEXDB_SET_VALUE_ONERROR:function(e){o.AlloyReport.monitor(33624017),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"1",detail:e})},CHANGE_DATAKEY:function(e){o.AlloyReport.monitor(33692488),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"changeDataKey",detail:e})},STORE_UNVALIABLE_WHEN_UPDATE:function(e){o.AlloyReport.monitor(33624030),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"storeUnvaliableWhenUpdate",detail:e})},INDEXEDDB_UPDATE_VALUE:function(e){o.AlloyReport.monitor(33648382),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"2",detail:e})},INDEXEDDB_UPDATE_VALUE_2:function(e){o.AlloyReport.monitor(33624031),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",detail:e})},INDEXEDDB_UPDATE_VALUE_3:function(e){o.AlloyReport.monitor(33624032),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"1",detail:e})},INDEXEDDB_UPDATE_VALUE_4:function(e){o.AlloyReport.monitor(33624033),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"3",detail:e})},DELETE_DATA_ERROR:function(e){o.AlloyReport.monitor(33624034),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"deleteDataError",detail:e})},DELETE_VALUE:function(e){o.AlloyReport.monitor(33624036),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"1",detail:e})},DELETE_VALUE_2:function(e){o.AlloyReport.monitor(33624035),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",detail:e})},CLEAR_DATA_ERROR:function(e){o.AlloyReport.monitor(33624037),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"clearDataError",detail:e})},CLEAR_DATA:function(e){o.AlloyReport.monitor(33624039),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"1",detail:e})},CLEAR_DATA_2:function(e){o.AlloyReport.monitor(33624038),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"clearData",ver5Value:"0",detail:e})},GET_DATA_ERROR:function(e){o.AlloyReport.monitor(33624047),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"getDataError",detail:e})},GET_DATA:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"2",detail:e})},GET_DATA_ERROR_2:function(e){o.AlloyReport.monitor(33624049),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"1",detail:e})},GET_DATA_SUCC:function(e){o.AlloyReport.monitor(33624048),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"indexeddb",actionValue:"getData",ver5Value:"0",detail:e})},NETWORK_ERROR:function(){o.AlloyReport.monitor(33612270),(0,o.sentryReport)({errorType:"90sNoSocket"}),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"socket",actionValue:"networkError",ver5Value:"90sNoSocket"})},ACCEPT_MESSAGE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"socket",actionValue:"message",detail:e})},ROOM_STATE_CHANGE:function(e,t){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"socket",actionValue:"roomstatechange",ver5Value:t.valueOf(),detail:e})},HANDLE_SHUTDOWN:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"socket",actionValue:"handleShutDown",ver5Value:e})},RELOAD_TIP:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},RELOAD_TIP_DEBUG:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e,detail:[e]})},SWITCH_SHEET_IN_PREVIEW:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"sheetbar",actionValue:"switchSheetInPreview",detail:e})},PREVIEW_SERVER_SHEET_DATA:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetData",detail:e})},PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"sheetbar",actionValue:"previewServerSheetDataOnResponse",detail:e})},SWITCH_SHEET_ON_SUCCESS:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnSuccess",ver5Value:"1",detail:e})},SWITCH_SHEET_ON_FAIL:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"sheetbar",actionValue:"switchSheetOnFail",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_2:function(e){o.AlloyReport.monitor(33955440),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"1",detail:e})},DUPLICATE_SHEET_ID_3:function(e){o.AlloyReport.monitor(34098881),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"sheetsbar",actionValue:"duplicateSheetId",ver5Value:"2",detail:e})},FETCH_DATA_ERROR:function(e){o.AlloyReport.monitor(33701460),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"1",detail:e})},FETCH_DATA_ERROR_2:function(e,t,a){var n={100000:33711861,100002:33711862,100003:33711863,200105:33711864,200200:33711865,200011:33715032};t&&n[a]?o.AlloyReport.monitor(n[a]):o.AlloyReport.monitor(33711866),(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"fullMember",actionValue:"fetchDataError",ver5Value:"2",detail:e})},K2S_CONVERTER:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"fullMember",actionValue:"k2sConverter",detail:e})},INIT_OFFLINE_STORE_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"indexeddb",actionValue:"initOfflineStore",ver5Value:"1",detail:e})},GET_OFFLINE_DATA:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"getOfflineData",ver5Value:"commitQueue",detail:e})},GET_OFFLINE_DATA_WAITING_QUEUE:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"getOfflineData",ver5Value:"waitingQueue",detail:e})},CHANGEDATAKEY_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782646)},SETDATA_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"setDataCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782647)},UPDATEDATA_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"updateDataCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782648)},DELETEDATA_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"deleteDataCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782654)},CLEARDATA_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"clearDataCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782655)},GETDATA_CATCH_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"indexeddb",actionValue:"getDataCatchError",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33782678)},SWITCH_SHEET_SERVER_FAIL:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"switchSheet",actionValue:"serverFail",detail:e}),o.AlloyReport.monitor(33701441)},SWITCH_SHEET_FRONT_FAIL:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.DEBUG,moduleValue:"switchSheet",actionValue:"frontFail",detail:e}),o.AlloyReport.monitor(33701442)},PARSE_KEYFRAME_ERROR:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33639871)},UNZIP_KEYFRAME_ERROR:function(e,t){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33639872),(0,o.sentryReport)({errorType:"keyframeUnzipError",error:t})},PARSE_KEYFRAME_ERROR_2:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"parse",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33639871)},UNZIP_KEYFRAME:function(e,t){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"keyframe",actionValue:"unzip",ver5Value:"1",detail:e}),o.AlloyReport.monitor(33639872),(0,o.sentryReport)({errorType:"keyframeUnzipError",error:t})},MESSAGECENTER_DATA_ERROR_TIP:function(e,t){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"dataErrorTip",ver5Value:t,detail:e})},NET_OFFLINE_ERROR_TIP:function(){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.INFO,moduleValue:"messageCenter",actionValue:"netOfflineErrorTip"}),o.AlloyReport.monitor(33697418)},MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:function(e){(0,o.dataFlowReport)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"dataErrorTip",detail:e})},APPLY_BEHAVIOR_UNDO:function(e){(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"undo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_REDO:function(e){(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"redo",ver5Value:"0",detail:e})},APPLY_BEHAVIOR_LOCAL:function(e){(0,o.cacheDataFlow)({level:o.DataFlowLogLevel.IMPORTANT,moduleValue:"applyBehavior",actionValue:"local",ver5Value:"0",detail:e})},CREATE_WORKER_ERROR:function(e){(0,o.sentryReport)({error:e,errorType:"web-worker",message:"\u521b\u5efaworker\u5931\u8d25"})},UPDATE_SMART_SELECTION_ERROR:function(e,t){(0,o.sentryReport)({errorType:"UpdateSmartSelectionError",message:e,error:t})},INVERT_MUTATION_ERROR:function(e,t){(0,o.sentryReport)({errorType:"InvertMutationError",message:e,error:t})},FILL_DRAG:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_drag"})},FILL_SERIES:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_series"})},FILL_COPY:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_copy"})},FILL_OPTION:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option"})},FILL_OPTION_COPY:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_copy"})},FILL_OPTION_SERIES:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_option_series"})},FILL_FORMAT:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_format"})},FILL_WITHOUT_FORMAT:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill",action:"fill_without_format"})},MOBILE_FILL_SERIES:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_series"})},MOBILE_FILL_COP:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"mobile_fill_copy"})},CLK_FILL_SUCCESS:function(){(0,l.tdw)({module:"doc_excel_editor",opername:"excel_fill_mobile",action:"clk_fill_success"})},LOAD_DATA_SUCC:function(e,t,a){var n=u.default.window,i=n.clientVars,r=n.performance;if(("undefined"===typeof i||!i.isSnapshot)&&r&&r.timing){var s=r.timing,l=e.getTime()-s.navigationStart,h=t.getTime()-s.navigationStart,f={};s.responseStart-s.requestStart>0&&(f[1]=s.responseStart-s.requestStart),s.responseStart-s.navigationStart>0&&(f[2]=s.responseStart-s.navigationStart),s.responseEnd-s.navigationStart>0&&(f[3]=s.responseEnd-s.navigationStart),f[4]=l,f[5]=h;var p=e.getTime()-s.fetchStart;if(4===a)return;(0,c.monitorReport)(f,a);var v={sheet:{PC:{open:[33556929,33556932,33556933,33556934],blank:[33556931,33556935,33556936,33556937],template:[33561163,33561164,33561165,33561166],preview:[33561162,33561159,33561160,33561161]},Android:{open:[33557617,33557629,33557630,33557631],blank:[33557621,33557623,33557624,33557625],template:[33561171,33561172,33561173,33561174],preview:[33561167,33561168,33561169,33561170]},IOS:{open:[33557618,33557632,33557633,33557634],blank:[33557622,33557626,33557627,33557628],template:[33561179,33561180,33561181,33561182],preview:[33561175,33561176,33561177,33561178]}}};v["sheet-without-ssr-data"]=v.sheet;var _,E="",T="";_=0===u.default.window.isSheetHasRightSsrData?"sheet-without-ssr-data":"sheet",E=d.isMobile?d.isAndroid?"Android":"IOS":"PC",i.preview&&(T="preview"),i&&!0===i.newPad&&(T="undefined"!==typeof i.tid&&"20001"!==i.tid?"template":"blank");var m=void 0;p<2e3?m=1:p<3e3?m=2:p<5e3&&(m=3);var g=_&&v[_]&&v[_][E];if(g){var S=[g.open[0]];m&&S.push(g.open[m]),T&&(S.push(g[T][0]),m&&S.push(g[T][m])),o.AlloyReport.monitor(S)}}},SWITCH_SHEET_SUCC:function(e){o.AlloyReport.monitor({success:{PC:33556930,Android:33557619,IOS:33557620},fail:{PC:33560365,Android:33560689,IOS:33560690}}[e][d.isMobile?d.isAndroid?"Android":"IOS":"PC"])},REPORT_FOR_PLATFORM:function(e){(0,c.monitorReportForPlatform)(e)},REPORT_FILES_TIMES:function(){var e=function(){if(!performance||!performance.getEntries)return null;var e=void 0;try{e=performance.getEntries()}catch(a){return null}var t=[];return e.map(function(e){e.name&&e.duration&&(-1===e.name.indexOf("js/spread-sheet")&&-1===e.name.indexOf("js/bundle-vendors")&&-1===e.name.indexOf("js/bundle-core")&&-1===e.name.indexOf("js/core-sheet")||t.push({name:e.name,duration:e.duration}))}),t}();(0,l.tdw)({opername:"excel_performance",module:"files",action:"load_time",obj1:(0,n.default)(e)})},REPORT_FOR_QUICK_LOOK:function(e){var t=void 0;t="success"===e?{PC:33986901,Mobile:33986902,IOS:33986903,Android:33986904,All:33986900}:{PC:33987060,Mobile:33987061,IOS:33987062,Android:33987063,All:33987059};try{var a=void 0;d.isMobile?(a="Mobile",o.AlloyReport.monitor(t[a]),d.isAndroid?a="Android":d.isIOS&&(a="IOS")):a="PC",o.AlloyReport.monitor(t[a]),o.AlloyReport.monitor(t.All),"success"===e?(0,l.tdw)({opername:"doc_core",module:"visit",action:"quick_look_succ"}):(0,l.tdw)({opername:"doc_core",module:"visit",action:"quick_look_fail"})}catch(n){console.error(n)}},SHEET_STATUS_REPORT:function(e){if(e){e.getBasicFilter()&&(0,l.tdw)({opername:"doc_excel_editor",module:"excel_filter",action:"excel_contain_filter"});var t=e.getMerges(),a=!1,n=[];if(t.forEach(function(e){0===e.startRowIndex&&(a=!0),n.push([e.startRowIndex,e.startColIndex])}),a&&(0,l.tdw)({opername:"doc_excel_editor",module:"excel_merge",action:"top_row_merge"}),n.length>0){var o=0,i=0,r=0,s=0,u=0,d=0;n.forEach(function(t){var a=t[0],n=t[1],l=e.data.rowData[a]&&e.data.rowData[a].values[n];if(l){var c=l.getUserEnteredFormat();if(c){var h=c.getHorizontalAlign(),f=c.getVerticalAlign();h&&"left"!==h||(o+=1),"center"===h&&(i+=1),"right"===h&&(r+=1),"top"===f&&(s+=1),f&&"middle"!==f||(u+=1),"bottom"===f&&(d+=1)}}}),(0,l.tdw)({opername:"doc_excel_editor",module:"excel_merge",action:"merge_align",ver5:"h_align_left:"+o+",h_align_center:"+i+",h_align_right:"+r+",v_align_top:"+s+",v_align_middle:"+u+",v_align_bottom:"+d})}var c=e.getProperties().getGridProperties();if(c){var h=c.frozenColCount,f=c.frozenRowCount;1===h&&(0,l.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_column_freeze"}),1===f&&(0,l.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_first_row_freeze"}),(f>1||h>1)&&(0,l.tdw)({opername:"doc_excel_editor",module:"excel_freeze",action:"include_freeze_range"})}}},REPORT_FOR_QL_PV:function(){try{var e,t={PC:34024799,Mobile:34024802,IOS:34024801,Android:34024800,All:34024798};d.isMobile?(e="Mobile",s.default.monitor(t[e]),d.isAndroid?e="Android":d.isIOS&&(e="IOS")):e="PC",s.default.monitor(t[e]),s.default.monitor(t.All);var a=(0,h.getQuery)("tdsourcetag");a||(a=localStorage.getItem("tdsourcetag")),a&&((0,f.setCookie)("adtag",a),localStorage.setItem("tdsourcetag",a)),(0,l.tdw)({opername:"doc_core",module:"visit",action:"detail_page_quicklook",source3:a||""})}catch(n){s.default.monitor(3410984)}},REPORT_FOR_PV:function(){try{var e,t={sheet:{PC:3410973,Mobile:3410974,IOS:3410975,Android:3410976,All:3410982},All:3410983},a=t.sheet;d.isMobile?(e="Mobile",s.default.monitor(a[e]),d.isAndroid?e="Android":d.isIOS&&(e="IOS")):e="PC",s.default.monitor(a[e]),s.default.monitor(a.All),s.default.monitor(t.All),u.default.window.clientVars.preview&&(0,l.tdw)({opername:"doc_pcview",module:"open",action:"pre_req"});var n=(0,h.getQuery)("tdsourcetag");n||(n=localStorage.getItem("tdsourcetag")),n&&((0,f.setCookie)("adtag",n),localStorage.setItem("tdsourcetag",n)),(0,l.tdw)({opername:"doc_core",module:"visit",action:"detail_page",source3:n||""}),o.AlloyReport.monitor(33635051),o.AlloyReport.monitor(33635108)}catch(i){s.default.monitor(3410984)}},RESET_DEFAULT_TDW_DATA:function(){(0,l.resetDefaultTdwData)()},INVER_MUTATION_ERROR:function(e,t){(0,o.sentryReport)({errorType:"InvertMutationError",message:e,error:t})}};t.default=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];v[e]&&v[e].apply(v,a)}},1150:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(9)),o=l(a(31)),i=l(a(14)),r=l(a(25));t.monitorReport=function(e,t){if("object"!==("undefined"===typeof e?"undefined":(0,r.default)(e)))return;var a={flag1:21558,flag2:1,flag3:t},l=!0,u=!1,d=void 0;try{for(var c,h=(0,o.default)((0,n.default)(e));!(l=(c=h.next()).done);l=!0){var f=c.value;a[f]=e[f]}}catch(v){u=!0,d=v}finally{try{!l&&h.return&&h.return()}finally{if(u)throw d}}var p=(0,i.default)({appid:20201},a);s.default.huatuo(p)},t.monitorReportForPlatform=function(e){if(!e||!e.PC||!e.Android||!e.IOS)return;var t;f?d?t="Android":c&&(t="IOS"):t="PC";t&&s.default.monitor(e[t])};var s=l(a(397));function l(e){return e&&e.__esModule?e:{default:e}}var u=navigator.userAgent.toLowerCase(),d=/android|adr/i.test(u),c=/(iphone|ipad|ipod)/.test(u),h=/(ipad)/i.test(u),f=/(mobile)/i.test(u)&&!h},1151:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=E(a(14)),i=E(a(16)),r=E(a(63)),s=E(a(0)),l=E(a(1)),u=E(a(7)),d=a(26),c=E(a(12)),h=E(a(238)),f=a(279),p=a(283),v=E(a(8)),_=a(22);function E(e){return e&&e.__esModule?e:{default:e}}!function(e){e.PC="PC",e.ANDROID="Android",e.IOS="IOS"}(n||(n={}));var T=_.isMobile?_.isAndroid?n.ANDROID:n.IOS:n.PC,m={},g=!1;m.alloyExcelFirstRender={initDefaultReportData:function(e){if(!g){g=!0;var t=e.timing.requestStart;if(e.speedReportData.set(d.SPEED_REPORT_POINTS.LOAD_CGI_DATA_TIME,u.default.window._loadDataTime),e.speedReportData.set(d.SPEED_REPORT_POINTS.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME,u.default.window._loadDataTime-e.performanceData._starterRunFinish),e.speedReportData.set(d.SPEED_REPORT_POINTS.RUN_STARTER_JS_TIME,e.performanceData._starterRunFinish),e.speedReportData.set(d.SPEED_REPORT_POINTS.DNS,e.timing.domainLookupEnd-e.timing.domainLookupStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.HTML_TTFB,e.timing.responseStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.HTML_LOAD,e.timing.responseEnd-e.timing.responseStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.WHITE_SCREEN,e.performanceData.jsStartRun-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.NAVIGATION_TO_FETCH,e.timing.fetchStart-e.timing.navigationStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.FETCH_TO_REQUEST,e.timing.requestStart-e.timing.fetchStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.HTML_TO_REQUEST,u.default.window._loadStartTime-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.CORE_TO_REQUEST,e.performanceData._jsStartRun-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.BOOT_START,e.performanceData.bootStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.BOOT_END,e.performanceData.bootEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.HTML_TTFB,e.timing.responseStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_TO_REQUEST,e.performanceData.spreadStartRun-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_INIT_START,e.performanceData.spreadInitStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_INIT_DATA_START,e.performanceData.spreadInitDataStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_INIT_DATA_END,e.performanceData.spreadInitDataEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_INIT_END,e.performanceData.spreadInitEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.DATA_START,e.performanceData.dataStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.DATA_END,e.performanceData.dataEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.VIEW_START,e.performanceData.viewStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.VIEW_NEW_START,e.performanceData.viewNewStart-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.VIEW_NEW_END,e.performanceData.viewNewEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.VIEW_END,e.performanceData.viewEnd-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SPREAD_INIT_FINISHED,e.performanceData.spreadInitFinished-t),e.speedReportData.set(d.SPEED_REPORT_POINTS.SYNC_JS_RUN,e.timing.domContentLoadedEventEnd-e.performanceData.jsStartRun),e.speedReportData.set(d.SPEED_REPORT_POINTS.DOM_CONTENT_LOAD,e.timing.domContentLoadedEventEnd-e.timing.navigationStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.DOM_CONTENT_LOAD_WORKER,e.timing.domContentLoadedEventEnd-e.timing.navigationStart),u.default.window.quickLookRenderEnd&&u.default.window.quickLookRenderStart){var a=u.default.window.quickLookRenderEnd-e.timing.requestStart;e.speedReportData.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN,a),e.speedReportData.set(d.SPEED_REPORT_POINTS.QUICKLOOK,a),e.speedReportData.set(d.SPEED_REPORT_POINTS.RENDER_CACHE_IMG,u.default.window.quickLookRenderEnd-u.default.window.quickLookRenderStart),v.default.run(d.CONFIG.REPORT_FOR_QUICK_LOOK,"success")}else e.speedReportData.set(d.SPEED_REPORT_POINTS.FIRST_SCREEN,e.performanceData.initAfterCanvasLoaded-e.timing.fetchStart),v.default.run(d.CONFIG.REPORT_FOR_QUICK_LOOK,"fail");if(e.speedReportData.set(d.SPEED_REPORT_POINTS.RENDER_OVER,e.performanceData.afterCanvasRenderOver-e.timing.fetchStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.INTERACTABLE,e.performanceData.initAfterCanvasLoaded-e.timing.fetchStart),e.speedReportData.set(d.SPEED_REPORT_POINTS.INTERACTABLE_WORKER,e.performanceData.initAfterCanvasLoaded-e.timing.fetchStart),e.setFirstScreenTime(e.speedReportData.get(d.SPEED_REPORT_POINTS.FIRST_SCREEN)||0),"preload"===window.loadMode){window.performance.mark("prealoadInteractable"),window.performance.measure("prealoadInteractableDuration","userOpenTime","prealoadInteractable");var n=window.performance.getEntriesByType("measure");n&&n.length>0&&(e.speedReportData.set(d.SPEED_REPORT_POINTS.INTERACTABLE,n[0].duration),e.speedReportData.set(d.SPEED_REPORT_POINTS.INTERACTABLE_WORKER,n[0].duration))}if(performance.getEntries){for(var o=performance.getEntriesByType("resource"),i=void 0,r=void 0,s=0,l=0,c=0,h=0,f=0,p=o.length;f<p;f++)"script"===(i=o[f]).initiatorType&&(r=i.name.match(d.REG_JS_LOAD_FILE))&&d.JS_LOAD_FILE_MAP[r[0]]&&(e.speedReportData.set(d.JS_LOAD_FILE_MAP[r[0]],Math.round(i.duration)),s=0===s?i.startTime:Math.min(s,i.startTime),l=0===l?i.responseEnd:Math.max(l,i.responseEnd)),"link"===i.initiatorType&&(r=i.name.match(d.REG_CSS_LOAD_FILE))&&d.CSS_LOAD_FILE_MAP[r[0]]&&(e.speedReportData.set(d.CSS_LOAD_FILE_MAP[r[0]],Math.round(i.duration)),c=0===c?i.startTime:Math.min(c,i.startTime),h=0===h?i.responseEnd:Math.max(h,i.responseEnd));e.speedReportData.set(d.SPEED_REPORT_POINTS.TOTAL_JS_LOAD,Math.round(l-s)),e.speedReportData.set(d.SPEED_REPORT_POINTS.TOTAL_CSS_LOAD,Math.round(h-c))}}}};var S=function(){function e(){(0,s.default)(this,e),this.data=new r.default,u.default.window.__speedReportData={}}return(0,l.default)(e,[{key:"get",value:function(e){return this.data.get(e)}},{key:"getAll",value:function(){return this.data}},{key:"set",value:function(e,t){this.data.set(e,t),u.default.window.__speedReportData[e]=t}},{key:"delete",value:function(e){this.data.delete(e)}}]),e}(),R=new(function(){function e(){(0,s.default)(this,e),this.performanceData=window.performanceData||{},this.speedReportData=new S,this.sig="",this.initReportFlag=!1,this.FIRST_SCREEN_TIME=0,this.init()}return(0,l.default)(e,[{key:"setFirstScreenTime",value:function(e){this.FIRST_SCREEN_TIME=e}},{key:"getFirstScreenTime",value:function(){return this.FIRST_SCREEN_TIME}},{key:"getSig",value:function(){if(this.sig)return this.sig;try{this.sig=u.default.window.clientVars.collab_client_vars.client.sig}catch(e){}return this.sig}},{key:"mark",value:function(e,t){return this.speedReportData.set(e,t)}},{key:"getSpeedData",value:function(e){var t=this;if(!Array.isArray(e))return this.speedReportData.get(e);var a=[];return e.forEach(function(e){a.push(t.getSpeedData(e))}),a}},{key:"hasInitReport",value:function(){return this.initReportFlag}},{key:"getSpeedDataAll",value:function(){return this.speedReportData}},{key:"initTiming",value:function(){var e=window&&(window.performance||window.webkitPerformance||window.msPerformance)||{};this.timing=e.timing}},{key:"init",value:function(){d.reportSpeedFlag&&this.initTiming()}},{key:"startInitReport",value:function(){var e=this,t={},a=(0,f.getSheetCellsNum)(u.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId());(0,p.tdw)({opername:"quality_doc",module:"excel_detail",action:"open_time_cost",ver5:this.getSpeedData(d.SPEED_REPORT_POINTS.WHITE_SCREEN),ver6:this.getFirstScreenTime(),ver7:this.getSpeedData(d.SPEED_REPORT_POINTS.INTERACTABLE)||0,ver8:(0,i.default)(a)});var n=this.speedReportData.get(d.SPEED_REPORT_POINTS.FIRST_SCREEN)||0,o=this.speedReportData.get(d.SPEED_REPORT_POINTS.INTERACTABLE)||0;this.speedReportData.getAll().forEach(function(n,o){d.TDW_REPORT_ACTION[o]&&((0,p.tdw)({opername:"excel_performance",module:"start",action:d.TDW_REPORT_ACTION[o],ver5:n,ver6:e.getSig(),ver7:e.getFirstScreenTime(),ver8:(0,i.default)(a)}),e.speedReportData.delete(o)),t[o]=n,d.SPEED_REPORT_LOG[o]&&h.default.info(d.SPEED_REPORT_LOG[o]+": "+n)}),this.huatuoReport(t),c.default.wait(5e3).run(function(){console.warn("%c"+d.SPEED_REPORT_LOG[d.SPEED_REPORT_POINTS.FIRST_SCREEN]+": "+n,"color: red; font-size: 14px;"),console.warn("%c"+d.SPEED_REPORT_LOG[d.SPEED_REPORT_POINTS.INTERACTABLE]+": "+o,"color: red; font-size: 14px;")})}},{key:"runDefaultReport",value:function(){m.alloyExcelFirstRender.initDefaultReportData(this),this.startInitReport(),this.initReportFlag=!0}},{key:"huatuoReport",value:function(e){var t={appid:20533,flag1:22213,flag2:1,flag3:1,platform:T};for(var a in e)if(d.SPEED_REPORT_LOG[a]){var n=d.SPEED_REPORT_LOG[a]+": "+e[a];console.warn("%c"+n,"color: green; font-size: 14px;")}e=(0,o.default)({},t,{speedTime:e}),v.default.huatuo(e,!0)}},{key:"runReport",value:function(e,t,a,n){if(!d.SPEED_REPORT_POINTS[e])throw new Error("TDW_REPORT_ACTION[SPEED_REPORT_POINT] is not existed");m.alloyExcelFirstRender.initDefaultReportData(this);var o=a-t,r=this.getSpeedData(e)||0;if(this.speedReportData.set(e,r+o),!n){var s=(0,f.getSheetCellsNum)(u.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId()),l=this.getSpeedData(e)||0,c={};c[e]=l,this.huatuoReport(c),d.TDW_REPORT_ACTION[e]&&((0,p.tdw)({opername:"excel_performance",module:"start",action:d.TDW_REPORT_ACTION[e],ver5:l,ver6:this.getSig(),ver7:this.getFirstScreenTime(),ver8:(0,i.default)(s)}),this.speedReportData.delete(e)),h.default.info(d.SPEED_REPORT_LOG[e]+": "+l)}}},{key:"run",value:function(e){if(m[e]){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];m[e].apply(this,a)}}}]),e}());t.default=R},1152:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o,i=_(a(16)),r=_(a(0)),s=_(a(1)),l=a(398),u=a(279),d=_(a(7)),c=_(a(8)),h=a(1153),f=_(h),p=a(22),v=a(140);function _(e){return e&&e.__esModule?e:{default:e}}!function(e){e.REPORT="report",e.MONITOR="monitor",e.CLOSE="close"}(n||(n={})),function(e){e[e.STOP=0]="STOP",e[e.WAIT=1]="WAIT",e[e.RUN=2]="RUN"}(o||(o={}));var E,T=void 0,m=void 0;"undefined"!==typeof document.hidden?(m="visibilitychange",T="visibilityState"):"undefined"!==typeof document.mozHidden?(m="mozvisibilitychange",T="mozVisibilityState"):"undefined"!==typeof document.msHidden?(m="msvisibilitychange",T="msVisibilityState"):"undefined"!==typeof document.webkitHidden&&(m="webkitvisibilitychange",T="webkitVisibilityState"),function(e){e.ERROR="error"}(E||(E={}));var g=!1,S={permission_click:34206089,share_click:34206090,smartSplit_calc:34206079,record_enter:34206073,search_traverse:34206078,fullScreen_click:34206091,sheetbar_addSheet:34206084,sheetbar_removeSheet:34206085,keyframeMutation_copySheet:34206077,sheetbar_switchSheet:34206074,sheetbar_moveSheet:34206086,applyMutation_undo:34206083,applyMutation_redo:34206082,applyMutation_local_0:34206032,applyMutation_local_1:34206033,applyMutation_local_2:34206034,applyMutation_local_3:34206035,applyMutation_local_4:34206036,applyMutation_local_5:34206037,applyMutation_local_6:34206038,applyMutation_local_7:34206039,applyMutation_local_8:34206040,applyMutation_local_9:34206041,applyMutation_local_10:34206042,applyMutation_local_11:34206043,applyMutation_local_12:34206044,applyMutation_local_13:34206045,applyMutation_local_14:34206046,applyMutation_local_15:34206047,applyMutation_local_16:34206048,applyMutation_local_17:34206049,applyMutation_local_18:34206050,applyMutation_local_19:34206051,applyMutation_local_20:34206052,applyMutation_local_21:34206053,applyMutation_local_22:34206054,applyMutation_local_23:34206055,applyMutation_local_24:34206056,applyMutation_local_25:34206057,applyMutation_local_26:34206058,applyMutation_local_27:34206059,applyMutation_local_28:34206060,applyMutation_local_29:34206061,applyMutation_local_30:34206062,applyMutation_local_31:34206063,applyMutation_local_32:34206064,applyMutation_local_33:34206065,applyMutation_local_34:34206066,applyMutation_local_35:34206067,applyMutation_local_36:34206068,applyMutation_local_37:34206069,applyMutation_local_38:34206070,applyMutation_local_39:34206071,keyframe_export:34206072,keyframe_createKeyframe:34206080,keyframeMutation_switchRecordSheet:34206075,copy_analysis:34206076,quickOpen_init:34206093,quickOpen_snapshot:34206094,view_collaborator:34206088,view_scale:34206087,view_resize:34206092,unknown_module_unknown_action:34206106,jank_heartbeat:34206133,"applyMutation_collab_-1":34206191,applyMutation_collab_0:34206151,applyMutation_collab_1:34206152,applyMutation_collab_2:34206153,applyMutation_collab_3:34206154,applyMutation_collab_4:34206155,applyMutation_collab_5:34206156,applyMutation_collab_6:34206157,applyMutation_collab_7:34206158,applyMutation_collab_8:34206159,applyMutation_collab_9:34206160,applyMutation_collab_10:34206161,applyMutation_collab_11:34206162,applyMutation_collab_12:34206163,applyMutation_collab_13:34206164,applyMutation_collab_14:34206165,applyMutation_collab_15:34206166,applyMutation_collab_16:34206167,applyMutation_collab_17:34206168,applyMutation_collab_18:34206169,applyMutation_collab_19:34206170,applyMutation_collab_20:34206171,applyMutation_collab_21:34206172,applyMutation_collab_22:34206173,applyMutation_collab_23:34206174,applyMutation_collab_24:34206175,applyMutation_collab_25:34206176,applyMutation_collab_26:34206177,applyMutation_collab_27:34206178,applyMutation_collab_28:34206179,applyMutation_collab_29:34206180,applyMutation_collab_30:34206181,applyMutation_collab_31:34206182,applyMutation_collab_32:34206183,applyMutation_collab_33:34206184,applyMutation_collab_34:34206185,applyMutation_collab_35:34206186,applyMutation_collab_36:34206187,applyMutation_collab_37:34206188,applyMutation_collab_38:34206189,applyMutation_collab_39:34206190,messageOfflineStore_apply:34206135,messageOfflineStore_followAndApply:34206136,messageCenter_fetchAndApplyCollabNewChanges:34206206,page_refresh:34206195},R=function(){function e(){(0,r.default)(this,e),this.stack=[],this.status=n.CLOSE,this.preHeartBeatTime=0,this.timeoutTimer=null,this.jankKey="",this.isJankKeyLocked=!1,this.reportedTimes=0,this.init(),this.pageActiveMonitor=new f.default,this.traceStack=v.traceStack}return(0,s.default)(e,[{key:"init",value:function(){var e=this;document.addEventListener(m,function(){"hidden"===document[T]?(console.log("\u5173\u95ed\u5b9a\u65f6\u5668"),e.closeMonitor()):(console.log("\u5f00\u542f\u5b9a\u65f6\u5668"),e.startMonitor())});var t=navigator.userAgent.toLowerCase(),a=/(android)/.test(t)?"android":/(iphone|ipad|ipod)/.test(t)?"ios":"pc";this.jankMonitorTimer={ios:{3:33580565,4:33580566,5:33581294,6:33581295,7:33581296,8:33581297,9:33581298,10:33580569},android:{3:33580552,4:33580553,5:33580554,6:33580555,7:33580556,8:33580557,9:33580558,10:33580559},pc:{3:33580573,4:33580574,5:33580575,6:33580576,7:33580577,8:33580578,9:33580579,10:33580580}}[a],p.isMac?this.jankOnPageUnactiveMonitor=34462711:p.isMobile?this.jankOnPageUnactiveMonitor=34462712:p.isPad?this.jankOnPageUnactiveMonitor=34462713:p.isPc?this.jankOnPageUnactiveMonitor=34462710:this.jankOnPageUnactiveMonitor=34462784}},{key:"log",value:function(e){if(this.status===n.MONITOR){this.stack.length>50&&this.stack.shift();var t=window.SpreadsheetApp&&window.SpreadsheetApp.messageCenter&&window.SpreadsheetApp.messageCenter.currentVersion||-1,a=window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet&&window.SpreadsheetApp.spreadsheet.getActiveSheetId()||"unknown";e.baseVersion=t,e.activeSheetId=a,this.stack.push({jankLogOptions:e,time:(new Date).getTime()}),this.isJankKeyLocked||(e.lockJankKey?(this.jankKey=e.moduleValue+"_"+e.actionValue,this.isJankKeyLocked=!0):this.jankKey=e.moduleValue+"_"+e.actionValue)}}},{key:"onSetTimeout",value:function(){var e=this;if(this.reportedTimes>10)return console.warn("[jank] reportedTimes > REPORT_MAX_TIMES"),void this.closeMonitor();this.timeoutTimer=setTimeout(function(){var t=(new Date).getTime()-e.preHeartBeatTime-500;t>3e3?e.report(t):(e.status===n.MONITOR&&(e.stack=[],e.isJankKeyLocked=!1,e.log({moduleValue:"jank",actionValue:"heartbeat"})),e.stop===o.WAIT&&(e.stop=o.RUN),e.preHeartBeatTime=(new Date).getTime(),e.onSetTimeout())},1e3)}},{key:"report",value:function(e){this.reportedTimes++,this.__report(e),this.stop===o.WAIT&&(this.stop=o.RUN),this.closeMonitor(),this.reportedTimes<10&&this.startMonitor()}},{key:"__handleMonitor",value:function(e){if(this.status===n.MONITOR)try{this.log({moduleValue:"jank",actionValue:"heartbeat",level:E.ERROR});var t=this.stack,a=void 0;window.log&&window.log.info("\u5361\u987f\u65e5\u5fd7\u5f00\u59cb_V2============");for(var o=0;o<this.stack.length;o++){var i=t[o],r=t[o+1];if(i.jankLogOptions.level===E.ERROR?window.log&&window.log.error(new Date(i.time)+(0,l.joinReportInfo)(i.jankLogOptions)):window.log&&window.log.info(new Date(i.time)+(0,l.joinReportInfo)(i.jankLogOptions)),o===this.stack.length-1)break;r.time-i.time>3e3&&(a=i)}window.log&&window.log.error(v.traceStack.queue),window.log&&window.log.info("\u5361\u987f\u65e5\u5fd7\u7ed3\u675f================="),a||(a=t[t.length-2]);var s=a&&a.jankLogOptions.moduleValue||"unknown_module",u=a&&a.jankLogOptions.actionValue||"unknown_action";this.isJankKeyLocked||(this.jankKey=s+"_"+u),window.log&&window.log.info("\u5361\u987f\uff0c",this.jankKey,e),console.log("\u7f57\u76d8\u5361\u987f\u4e0a\u62a5",s,u,e,this.jankKey),window.log&&window.log.report("jank_V2_"+this.jankKey,{query:{sessionId:window.log.var.sessionId}})}catch(d){console.error("jank report error",d)}}},{key:"__report",value:function(e){if(window.AlloyReport&&l.isProductEnvironment)if(this.__handleMonitor(e),e>=3e3&&e<4e3&&c.default.monitor(this.jankMonitorTimer[3]),e>=4e3&&e<5e3&&c.default.monitor(this.jankMonitorTimer[4]),e>=5e3&&e<6e3&&c.default.monitor(this.jankMonitorTimer[5]),e>=6e3&&e<7e3&&c.default.monitor(this.jankMonitorTimer[6]),e>=7e3&&e<8e3&&c.default.monitor(this.jankMonitorTimer[7]),e>=8e3&&e<9e3&&c.default.monitor(this.jankMonitorTimer[8]),e>=9e3&&e<1e4&&c.default.monitor(this.jankMonitorTimer[9]),e>=1e3&&c.default.monitor(this.jankMonitorTimer[10]),this.jankKey&&S[this.jankKey]?c.default.monitor(S[this.jankKey]):c.default.monitor(34206107),this.pageActiveMonitor.status()===h.PageStatus.ACTIVE)if(this.stop==o.RUN)if(window.SpreadsheetApp.sheetStatus.permission.gEditable){if("page_refresh"!==this.jankKey&&!g){g=!0;var t={opername:"excel_crash_4",module:"crash",obj3:e,ver5:this.jankKey};t.action=e>3e3&&e<=1e4?"crash_default":"crash_stutters";var a=(0,u.getSheetCellsNum)(d.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId());t.ver3=(0,i.default)(a),c.default.tdwSingleReport(t)}}else e<1e4?c.default.monitor(34026367):c.default.monitor(34026366);else e<1e4?c.default.monitor(34026365):c.default.monitor(34026364);else window.AlloyReport.monitor(this.jankOnPageUnactiveMonitor)}},{key:"startMonitor",value:function(){this.pageActiveMonitor.start(),this.reportedTimes>=10||(this.timeoutTimer?console.warn("[jank] timeout exist"):(this.status=n.REPORT,this.preHeartBeatTime=(new Date).getTime(),this.onSetTimeout(),this.status=n.MONITOR,this.stack=[],this.isJankKeyLocked=!1,this.log({moduleValue:"jank",actionValue:"heartbeat"})))}},{key:"closeMonitor",value:function(){this.pageActiveMonitor.end(),clearTimeout(this.timeoutTimer),this.timeoutTimer=null,this.stack=[],this.status=n.CLOSE,this.preHeartBeatTime=0,this.isJankKeyLocked=!1}},{key:"stopReport",value:function(){this.stop=o.STOP}},{key:"restartReport",value:function(){this.stop=o.WAIT}}]),e}();t.default=R},1153:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PageStatus=void 0;var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=t.PageStatus=void 0;!function(e){e[e.STOP=0]="STOP",e[e.UNACTIVE=1]="UNACTIVE",e[e.ACTIVE=2]="ACTIVE"}(r||(t.PageStatus=r={}));var s=function(){function e(){var t=this;(0,n.default)(this,e),this._status=r.STOP,this._check=function(){t._status=r.UNACTIVE,document.body.addEventListener("mousemove",t._handle)},this._handle=function(){t._status=r.ACTIVE,document.body.removeEventListener("mousemove",t._handle),t.start()}}return(0,o.default)(e,[{key:"start",value:function(){var e=this;this._status=r.ACTIVE,this._timer=setTimeout(function(){e._check()},12e4)}},{key:"end",value:function(){clearTimeout(this._timer),this._status=r.STOP}},{key:"status",value:function(){return this._status}}]),e}();t.default=s},1154:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(3)),o=c(a(0)),i=c(a(1)),r=c(a(4)),s=c(a(59)),l=c(a(5)),u=c(a(674)),d=c(a(1410));function c(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.parent=e,a.node="#canvasContainer",a.init(),a}return(0,l.default)(t,e),(0,i.default)(t,[{key:"refreshExcelView",value:function(){this.canvas.initData(this.node),this.canvas.excel&&this.canvas.excel.inputCenter&&this.canvas.excel.inputCenter.board.focus(),this.reportLocation()}},{key:"resizeExcelView",value:function(){var e=document.querySelector("#canvasContainer");if(null!==e){var t=window.innerHeight-e.getBoundingClientRect().top-36;e.style.height=t+"px",this.parent.preview.isActive||this.parent&&this.parent.view&&this.parent.view.canvas&&this.parent.view.canvas.excel.resize(),this.canvas.excel&&this.canvas.excel.inputCenter&&this.canvas.excel.inputCenter.board.focus()}}},{key:"initInputBox",value:function(){this.inputBox=new d.default(this.parent,this.parent.view.canvas)}},{key:"initPlugins",value:function(){var e=this;(0,s.default)(t.prototype.__proto__||(0,n.default)(t.prototype),"initPlugins",this).call(this),a.e("bundle_panel_pc").then(a.t.bind(null,1658,7)).then(function(t){var a=t.CustomFormatPanel,n=t.DataValidationPanel,o=t.SortRangePanel,i=t.RangeSelectionPanel,r=t.ValidationErrorPanel,s=t.SearchReplacePanel,l=t.FilterPanel,u=t.FormulaEditorPanel,d=t.SidePanelMain,c=t.ConditionalFormatPanel;e.plugins={customFormatPanel:new a(e.parent),dataValidationPanel:new n(e.parent),sortRangePanel:new o(e.parent),rangeSelectionPanel:new i(e.parent),validationErrorPanel:new r(e.parent),searchReplacePanel:new s(e.parent),filterPanel:new l(e.parent),formulaEditorPanel:new u(e.parent),sidePanelMain:new d(e.parent),conditionalFormatPanel:new c(e.parent)}})}}]),t}(u.default);t.default=h},12:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(24)),o=s(a(1068)),i=s(a(0)),r=s(a(1));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,a){(0,i.default)(this,e),this.timer=t,this.done=!1,this.callback=function(){},this.frames=a/t.interval|0}return(0,r.default)(e,[{key:"setFrame",value:function(e){this.frames=e,0!==this.frames&&(this.frames=(0,o.default)(this.frames)?this.frames:1+(0|this.frames))}},{key:"run",value:function(e){return this.callback=e,this.setFrame(this.frames+this.timer.currFrame),this.timer.push(this),this}},{key:"stop",value:function(){this.timer.erase(this)}}]),e}(),u=function(){function e(){(0,i.default)(this,e),this.zeroFrameDone=!1,this.times=0,this.started=!1,this.interval=500,this.t=null,this.cache={},this.currFrame=0,this.maxFrame=0}return(0,r.default)(e,[{key:"pause",value:function(){clearInterval(this.t)}},{key:"restart",value:function(){this.started=!1,this.start()}},{key:"clear",value:function(){this.cache={},this.started=!1,this.currFrame=0,this.maxFrame=0,clearInterval(this.t),this.t=null}},{key:"execNextFrame",value:function(){if(this.currFrame>this.maxFrame)return this.clear();var e=this.cache[this.currFrame];if(e){e.forEach(function(e,t){e&&(e.done=!0,e.callback&&e.callback()),e=null});var t,a=e.filter(function(e){return!e.done});if(a.length)this.cache[this.currFrame+1]||(this.cache[this.currFrame+1]=[]),(t=this.cache[this.currFrame+1]).push.apply(t,(0,n.default)(a)),this.maxFrame++;delete this.cache[this.currFrame]}}},{key:"push",value:function(e){this.cache[e.frames]||(this.cache[e.frames]=[]),this.cache[e.frames].push(e),this.maxFrame=Math.max(this.maxFrame,e.frames),this.start()}},{key:"erase",value:function(e){if(e){var t=e.frames;if(void 0!==this.cache[t]){var a=this.cache[t].indexOf(e);a>-1&&this.cache[t].splice(a,1)}}}},{key:"wait",value:function(e){return new l(this,e)}},{key:"start",value:function(){var e=this;if(!this.started){if(this.started=!0,this.cache[0]&&!this.zeroFrameDone)return this.zeroFrameDone=!0,setTimeout(function(){try{e.execNextFrame()}catch(t){console.error(t)}},0),this.started=!1;this.t=setInterval(function(){try{e.execNextFrame()}catch(t){console.error(t)}e.currFrame++},this.interval)}}}]),e}();t.default=new u},123:function(e,t){e.exports=window.ReactDOM},124:function(e,t,a){"use strict";function n(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""}Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=n,t.getXsrf=function(){return n("TOK")||""},t.getBkn=function(){var e=n("skey"),t=5381;if(!e)return;for(var a=0,o=e.length;o>a;++a)t+=(t<<5)+e.charAt(a).charCodeAt();return 2147483647&t},t.hasLoginCookie=function(){return!!(n("uid")&&n("uid_key")||n("p_luin")&&n("p_lskey")||n("p_uin")&&n("p_skey"))}},1310:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=i(a(7)).default.window;var s=new(function(){function e(){(0,n.default)(this,e)}return(0,o.default)(e,[{key:"maybeShrinkImage",value:function(e,t,a,n){var o=void 0;if(!r.FileReader||!r.Image||-1==e.type.indexOf("image")||0==e.type.indexOf("image/gif")||e.size<5e5)t(e);else{var i=new FileReader;i.onloadend=function(){(o=new Image).onload=function(){var i,r=a||1280,s=n||3280,l=o.width,u=o.height,d=o.width,c=o.height,h=void 0;l>u?l>r&&(u*=r/l,l=r):u>s&&(l*=s/u,u=s),(h=document.createElement("canvas")).width=l,h.height=u,h.getContext("2d").drawImage(o,0,0,l,u),i=function(e){var t=void 0,a=void 0,n=void 0,o=void 0,i=void 0;t=e.split(",")[0].indexOf("base64")>=0?atob(e.split(",")[1]):unescape(e.split(",")[1]);for(a=e.split(",")[0].split(":")[1].split(";")[0],n=new ArrayBuffer(t.length),o=new Uint8Array(n),i=0;i<t.length;i++)o[i]=t.charCodeAt(i);return new Blob([n],{type:a})}(h.toDataURL(e.type,.8)),t(i,l,u,d,c)},o.src=i.result},i.readAsDataURL(e)}}}]),e}());t.default=s},1336:function(e,t,a){"use strict";!function(e){function a(e){return e.split('"').length-1}var n=function(e){var t,n,o,i,r,s,l,u=[],d=0;for((o=(e=e.replace(/\r\n/g,"\n").replace(/\r/g,"\n")).split("\n")).length>1&&""===o[o.length-1]&&o.pop(),t=0,n=o.length;t<n;t+=1){for(o[t]=o[t].split("\t"),i=0,r=o[t].length;i<r;i+=1)u[d]||(u[d]=[]),s&&0===i?(l=u[d].length-1,u[d][l]=u[d][l]+"\n"+o[t][0],s&&1&a(o[t][0])&&(s=!1,u[d][l]=u[d][l].substring(0,u[d][l].length-1))):i===r-1&&0===o[t][i].indexOf('"')&&1&a(o[t][i])?(u[d].push(o[t][i].substring(1)),s=!0):s?(1&a(o[t][i])&&s&&0!=o[t][i].length&&o[t][i].lastIndexOf('"')===o[t][i].length-1&&(s=!1),l=u[d].length-1,u[d][l]=u[d][l]+"\n"+o[t][0]):(u[d].push(o[t][i]),s=!1);s||(d+=1)}return u},o=function(e){var t,a,n,o,i,r="";for(t=0,a=e.length;t<a;t+=1){for(o=e[t].length,n=0;n<o;n+=1)n>0&&(r+="\t"),"string"===typeof(i=e[t][n])?i.indexOf("\n")>-1||i.indexOf("\r")>-1||i.indexOf("\t")>-1?r+='"'+i.replace(/"/g,'""')+'"':r+=i:r+=null===i||void 0===i?"":i;a-1!=t&&(r+="\n")}return r};t.parse=n,t.stringify=o}(window)},1344:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(a(0)),o=_(a(1)),i=_(a(40)),r=_(a(7)),s=_(a(17)),l=a(70),u=_(a(15)),d=a(125),c=a(163),h=a(33),f=_(a(13)),p=_(a(29)),v=a(18);function _(e){return e&&e.__esModule?e:{default:e}}var E=function(){function e(t){var a=this;(0,n.default)(this,e),this.parent=t.parent,i.default.spreadsheetEvent.listen("renderAfterMutationRun",function(e){(a.parent.preview.isActive&&"preview"===e.sType||!a.parent.preview.isActive&&"normal"===e.sType)&&(a.parent.preview.isActive?a.parent.preview.previewsheet.activeSheet.isLoaded:a.parent.spreadsheet.activeSheet.isLoaded)&&a.play([e.mutation],e.isLocal)})}return(0,o.default)(e,[{key:"play",value:function(e,t){var a=0,n=void 0;if(void 0!==this.parent.view.canvas.excel&&!r.default.window.actionExporting)for(;a<e.length;a++)switch((n=e[a]).id){case s.default.INSERT_DIMENSION_MUTATION:this.insertDimension(n,t);break;case s.default.DELETE_DIMENSION_MUTATION:this.deleteDimension(n);break;case s.default.SET_DIMENSION_PROPERTIES_MUTATION:this.setDimensionProperties(n);break;case s.default.SET_RANGE_MUTATION:this.setRange(n);break;case s.default.SET_CELL_PROPERTIES_MUTATION:this.setCellProperties(n);break;case s.default.MERGE_CELLS_MUTATION:this.mergeCell(n);break;case s.default.UNMERGE_CELLS_MUTATION:this.unmergeCell(n);break;case s.default.ADD_EMBEDDED_OBJECT_MUTATION:this.addEmbeddedObject(n);break;case s.default.DELETE_EMBEDDED_OBJECT_MUTATION:this.deleteEmbeddedObject(n);break;case s.default.UPDATE_EMBEDDED_OBJECT_MUTATION:this.updateEmbeddedObject(n);break;case s.default.COPY_PASTE_MUTATION:break;case s.default.REORDER_RANGE_MUTATION:this.reorderRange(n);break;case s.default.DEFINE_FILTER_MUTATION:this.defineBasicFilter(n);break;case s.default.UPDATE_FILTER_MUTATION:this.updateFilter(n);break;case s.default.DELETE_FILTER_MUTATION:this.closeFilter(n);break;case s.default.SET_SHEET_PROPERTIES_MUTATION:this.setSheetProperties(n);break;case s.default.UPDATE_ALL_SHEETS_MUTATION:case s.default.MAP_RANGE_MUTATION:break;case s.default.DEFINE_SHEET_RANGE_MUTATION:this.defineSheetRange(n);break;case s.default.DELETE_SHEET_RANGE_MUTATION:this.deleteSheetRange(n)}}},{key:"updateSelection",value:function(e){switch(e.id){case f.default.INSERT_DIMENSION_REQUEST:case f.default.DELETE_DIMENSION_REQUEST:case f.default.MOVE_DIMENSION_REQUEST:}}},{key:"getSheet",value:function(e){return this.parent.preview.isActive?this.parent.preview.previewsheet.getSheetBySheetId(e):this.parent.spreadsheet.getSheetBySheetId(e)}},{key:"checkSheet",value:function(e){return this.parent.preview.isActive?e!==this.parent.preview.previewsheet.activeSheet.getSheetId():e!==this.parent.spreadsheet.activeSheet.getSheetId()}},{key:"mergeCell",value:function(e){var t=e.startRowIndex,a=e.endRowIndex,n=e.startColIndex,o=e.endColIndex,i=e.sheetId;this.checkSheet(i)||this.parent.view.canvas.excel.mergeCell(n,t,o-n+1,a-t+1)}},{key:"unmergeCell",value:function(e){var t=e.startRowIndex,a=e.startColIndex,n=e.sheetId;this.checkSheet(n)||this.parent.view.canvas.excel.splitCell(a,t)}},{key:"copyPaste",value:function(e){var t=e.pasteMappings;if(t[0]){var a=t[0].destination.sheetId;if(!this.checkSheet(a)){var n=this.getSheet(a);if(null!==n){var o=[],i=void 0,r=void 0,s=void 0;t.forEach(function(e){for(var t=e.destination,a=t.startColIndex,l=t.endColIndex,u=t.startRowIndex,c=t.endRowIndex,h=u;h<=c;h++)for(var f=a;f<=l;f++)i=h,r=f,s=n.getCellDataAtPosition(i,r),o.push([r,i,(0,d.transformValue)(s,new p.default({setSlots:s?s.setSlots:0}))])}),this.parent.view.canvas.excel.setCellsData(o)}}}}},{key:"setRange",value:function(e){var t=e.gridRange.sheetId,a=this.getSheet(t),n=0,o=e.cellDataDeltaAtPositions,i=void 0,r=[],s=void 0,l=void 0;if(!this.checkSheet(t)&&null!==a){for(;n<o.length;n++)s=(i=o[n]).rowIndex,l=i.colIndex,r.push([l,s,(0,d.transformValue)(a.getCellDataAtPosition(s,l),i.cellDataDelta,{sheet:a,row:s,col:l})]);this.parent.view.canvas.excel.setCellsData(r)}}},{key:"setCellProperties",value:function(e){var t=e.gridRange,a=t.sheetId,n=this.getSheet(a),o=[],i=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=void 0;if(!this.checkSheet(a)&&null!==n){if(n)for(s=t.startRowIndex<0?n.data.startRow:t.startRowIndex,l=t.endRowIndex<0?n.data.rowData.length-1:t.endRowIndex,u=t.startColIndex<0?n.data.startColumn:t.startColIndex,c=t.endColIndex<0?n.getColCount():t.endColIndex,i=s;i<=l;i++)for(r=u;r<=c;r++)o.push([r,i,(0,d.transformValue)(n.getCellDataAtPosition(i,r),e.cellDataDelta,{sheet:n,row:i,col:r})]);this.parent.view.canvas.excel.setCellsData(o)}}},{key:"insertDimension",value:function(e,t){var a=e.index,n=e.amount,o=e.type,i=e.sheetId;if(!this.checkSheet(i)){var r=this.parent.spreadsheet.activeSheet;if(o===u.default.ROWS)this.parent.view.canvas.excel.addRow(a,n),t&&a+n<=this.parent.spreadsheet.activeSheet.getRowCount()&&this.parent.view.canvas.excel.selectRow([a,a+n-1],!1);else if(o===u.default.COLUMNS){this.parent.view.canvas.excel.addCol(a,n),t&&a+n<=this.parent.spreadsheet.activeSheet.getColCount()&&this.parent.view.canvas.excel.selectCol([a,a+n-1],!1);var s=this.parent.view.canvas.excel.tableData.filter.range;if(s&&s.xRange&&a>s.xRange[0]&&a<=s.xRange[1]){var l=s.yRange[0],c=void 0,h=void 0,f=void 0,v=void 0,_=void 0,E=[];for(c=s.xRange[0];c<=s.xRange[1];c++)(_=r.getCellDataAtPosition(l,c))&&_.getMergeReference()?(f=(h=_.getMergeReference()).startColIndex,v=h.startRowIndex):(f=c,v=l),E.push([f,v,(0,d.transformValue)(_,new p.default({setSlots:0,clearSlots:0}),{sheet:r,row:l,col:c})]);this.parent.view.canvas.excel.setCellsData(E)}}}}},{key:"deleteDimension",value:function(e){var t=e.index,a=e.amount,n=e.type,o=e.sheetId;this.checkSheet(o)||(n===u.default.ROWS?this.parent.view.canvas.excel.removeRow([t,t+a-1]):this.parent.view.canvas.excel.removeCol([t,t+a-1]))}},{key:"setDimensionProperties",value:function(e){var t=e.ranges,a=e.operation,n=e.type,o=e.sheetId,i=void 0,r=0,s=0;if(!this.checkSheet(o))for(;r<t.length;r++)for(i=t[r],s=0;s<a.length;s++)switch(a[s].slot){case l.DIMENSION_PROPERTIES_SLOT.SLOT_SIZE:this.setDimensionSize(n,i,a[s]);break;case l.DIMENSION_PROPERTIES_SLOT.SLOT_HIDDEN:this.setDimensionHidden(n,i,a[s])}}},{key:"setDimensionSize",value:function(e,t,a){var n=void 0,o=void 0,i=this.parent.view.canvas.excel,r=a.size,s=t.sheetId;if(!this.checkSheet(s))for(null!==a.size&&void 0!==a.size||e!==u.default.COLUMNS||(r=h.DEFAULT_COL_WIDTH),o=e===u.default.ROWS?i.setRowHeight.bind(i):i.setColWidth.bind(i),n=t.startIndex;n<=t.endIndex;n++)o(n,r)}},{key:"setDimensionHidden",value:function(e,t,a){var n=void 0,o=void 0,i=this.parent.view.canvas.excel,r=t.sheetId;this.checkSheet(r)||(e===u.default.ROWS?(n=i.hideRow.bind(i),o=i.showRow.bind(i)):(n=i.hideCol.bind(i),o=i.showCol.bind(i)),a.hidden?n([t.startIndex,t.endIndex]):o([t.startIndex,t.endIndex]))}},{key:"addEmbeddedObject",value:function(e){var t=e.data,a=t.sheetId;this.checkSheet(a)||this.parent.view.canvas.excel.addImage({anchor:{row:t.y,col:t.x},id:t.id,url:t.url,size:{width:t.width,height:t.height},offset:{x:t.offsetX,y:t.offsetY},zIndex:t.zIndex,type:t.type,clipInfo:t.clipInfo})}},{key:"deleteEmbeddedObject",value:function(e){var t=e.key,a=e.sheetId;this.checkSheet(a)||this.parent.view.canvas.excel.removeImage(t)}},{key:"updateEmbeddedObject",value:function(e){var t=e.data,a=t.sheetId;this.checkSheet(a)||this.parent.view.canvas.excel.updateImage({anchor:{row:t.y,col:t.x},id:t.id,url:t.url,size:{width:t.width,height:t.height},offset:{x:t.offsetX,y:t.offsetY},zIndex:t.zIndex,type:t.type,clipInfo:t.clipInfo,previewInsertInfo:t.previewInsertInfo})}},{key:"reorderRange",value:function(e){var t=e.range,a=e.sheetId,n=[],o=this.getSheet(a),i=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=void 0;if(!this.checkSheet(a)&&null!==o&&null!==o){i=t.startRowIndex<0?o.data.startRow:t.startRowIndex,r=t.endRowIndex<0?o.getRowCount():t.endRowIndex,s=t.startColIndex<0?o.data.startColumn:t.startColIndex,l=t.endColIndex<0?o.getColCount():t.endColIndex;var f=void 0;for(u=i;u<=r;u++){for(f=[],c=s;c<=l;c++)h=o.getCellDataAtPosition(u,c),f.push((0,d.transformValue)(h,new p.default({setSlots:v.CELL_DATA_SLOT_COMPOSE.ALL}),{sheet:o,row:u,col:c}));n.push(f)}this.parent.view.canvas.excel.setAreaData([s,l],[i,r],n)}}},{key:"setSheetProperties",value:function(e){var t=e.sheetId;if(!this.checkSheet(t))switch(e.type){case c.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_ROWS:this.parent.view.canvas.excel.updateFrozenRow(Math.max(0,e.value));break;case c.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_COLUMNS:this.parent.view.canvas.excel.updateFrozenCol(Math.max(0,e.value));break;case c.SHEET_PROPERTIES_SLOT.SLOT_HIDE_GRIDLINES:this.parent.view.canvas.excel.setHideGridlines(e.value)}}},{key:"defineBasicFilter",value:function(e){var t=this.parent.spreadsheet.activeSheet,a=e.sheetId,n=void 0;if(t&&a===this.parent.spreadsheet.activeSheet.getSheetId()&&!this.checkSheet(a)){var o=e.delta.defaultFilterId,i=t.getBasicFilter(),r=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=[];if(o&&i){var f=(0,d.transformFilter)(i);this.parent.view.canvas.excel.doFilter(f);var v=i.range;for(s=v.startRowIndex,r=v.startColIndex;r<=v.endColIndex;r++)(n=t.getCellDataAtPosition(s,r))&&n.getMergeReference()?(u=(l=n.getMergeReference()).startColIndex,c=l.startRowIndex):(u=r,c=s),h.push([u,c,(0,d.transformValue)(n,new p.default({setSlots:0,clearSlots:0}),{sheet:t,row:s,col:r})]);this.parent.view.canvas.excel.setCellsData(h),this.parent.view.canvas.pluginsApi.filterHeader.doFilter()}}}},{key:"updateFilter",value:function(e){var t=this.parent.spreadsheet.activeSheet,a=e.sheetId,n=void 0;if(t&&!this.checkSheet(a)){var o=e.delta.defaultFilterId,i=t.getBasicFilter(),r=void 0,s=void 0,l=void 0,u=void 0,c=void 0,h=[];if(o&&i){var f=(0,d.transformFilter)(i),v=i.range;for(s=v.startRowIndex,r=v.startColIndex;r<=v.endColIndex;r++)(n=t.getCellDataAtPosition(s,r))&&n.getMergeReference()?(u=(l=n.getMergeReference()).startColIndex,c=l.startRowIndex):(u=r,c=s),h.push([u,c,(0,d.transformValue)(n,new p.default({setSlots:0,clearSlots:0}),{sheet:t,row:s,col:r})]);this.parent.view.canvas.excel.setCellsData(h),this.parent.view.canvas.excel.doFilter(f)}}}},{key:"closeFilter",value:function(e){var t=this.parent.spreadsheet.activeSheet,a=e.sheetId;if(t&&!this.checkSheet(a)){if(e.delta.defaultFilterId){var n=this.parent.view.canvas.excel.tableData.filter.range;if(n){var o=n.yRange[0],i=void 0,r=void 0,s=void 0,l=void 0,u=void 0,c=[];for(i=n.xRange[0];i<=n.xRange[1];i++)(u=t.getCellDataAtPosition(o,i))&&u.getMergeReference()?(s=(r=u.getMergeReference()).startColIndex,l=r.startRowIndex):(s=i,l=o),c.push([s,l,(0,d.transformValue)(u,new p.default({setSlots:0,clearSlots:0}),{sheet:t,row:o,col:i})]);this.parent.view.canvas.excel.setCellsData(c)}this.parent.view.canvas.excel.closeFilter()}this.parent.view.canvas.pluginsApi.filterHeader.closeFilter()}}},{key:"defineSheetRange",value:function(e){var t=this.parent.spreadsheet.activeSheet,a=e.sheetId;t&&!this.checkSheet(a)&&this.parent.view.canvas.excel.renderNextTick()}},{key:"deleteSheetRange",value:function(e){var t=this.parent.spreadsheet.activeSheet,a=e.sheetId;t&&!this.checkSheet(a)&&this.parent.view.canvas.excel.renderNextTick()}},{key:"selectCell",value:function(e,t,a,n){this.parent.view.canvas.excel.selectAreaCell({yRange:[e,a],xRange:[t,n]},{x:t,y:e},!0)}}]),e}();t.default=E},1345:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=s(a(138)),r=a(193);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e),this.undoStack=[],this.redoStack=[]}return(0,o.default)(e,[{key:"push",value:function(e){this.clearRedoStack(),this.undoStack.unshift(e)}},{key:"undo",value:function(){var e=this.getLocalMutations(this.undoStack);if(e){var t=e.mutations,a=e.index;a>=1&&(t=this.transform(t,{stack:this.undoStack,pointer:a-1})),t.undo.forEach(function(e){e.operationType=i.default.UNDO}),t.run(a>=1);var n=t.reverse();return this.redoStack.unshift(n),t}}},{key:"redo",value:function(){var e=this.getLocalMutations(this.redoStack);if(!e)return console.log("redo stack is empty");var t=e.mutations,a=e.index;a>=1&&(t=this.transform(t,{stack:this.undoStack,pointer:a-1})),t.undo.forEach(function(e){e.operationType=i.default.REDO}),t.run(a>=1);var n=t.reverse();return this.undoStack.unshift(n),t}},{key:"sync",value:function(e){this.undoStack.length>0&&this.undoStack.unshift(e),this.redoStack.length>0&&this.undoStack.unshift(e)}},{key:"transform",value:function(e,t){for(var a=void 0,n=t.stack,o=t.pointer;o>=0;){a=n[o];var i=(0,r.followRequestMutations)([e.undo],[a.redo],!0)[0],s=(0,r.followRequestMutations)([a.redo],[e.undo],!1)[0];e.undo=s,e.redo=[],n[o].redo=i,o--}return e}},{key:"clearRedoStack",value:function(){this.redoStack.length=0}},{key:"getLocalMutations",value:function(e){var t=void 0,a=void 0;for(t=0;t<e.length;t++)if((a=e[t]).local)return e.splice(t,1),{mutations:a,index:t};return null}}]),e}();t.default=l},1346:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.commitMutation=void 0;var n=p(a(16)),o=p(a(9)),i=p(a(7)),r=p(a(13)),s=a(79),l=a(90),u=a(411),d=p(a(8)),c=a(26),h=a(140),f=a(82);function p(e){return e&&e.__esModule?e:{default:e}}t.commitMutation=(0,h.traceFunc)(function(e,t,a,h,f){var p={};if(!a||0===a.length)return void d.default.run(c.CONFIG.COMMIT_EMPTY_MUTATION,[h||"unknowRequestId",t,a,f]);a.forEach(function(t){var a=t.getAffectedSheetId();if(!a)throw e.event.errorCode.trigger("errorCode",{type:"front",code:l.errCodeType.SHEET_ID_ERROR_2}),new Error("mutation\u5fc5\u987b\u5b9e\u73b0getAffectedSheetId\u63a5\u53e3\u624d\u80fd\u63d0\u4ea4\uff01\uff01\uff01");p[a]||(p[a]=[]),p[a].push(t)});var _=(0,o.default)(p);if(-1===_.indexOf(t))throw e.event.errorCode.trigger("errorCode",{type:"front",code:l.errCodeType.SHEET_ID_ERROR_3}),Error("\u81ea\u52a8\u5206\u7ec4\u540e\uff0c\u6570\u636e\u4e32\u8868\u7684\u6821\u9a8c\u4f1a\u653e\u5f00\uff0c\u53ef\u4ee5\u540c\u65f6\u4ea7\u751f\u5bf9\u591a\u4e2asheet\u7684\u5f71\u54cd\uff0c\u4f46\u9700\u8981\u6709\u5f53\u524dsheet\u7684\u4fee\u6539\uff0c\u5426\u5219\u65e0\u6cd5\u901a\u8fc7\u7edf\u4e00\u6821\u9a8c\u3002\u5982\u679c\u4ee5\u540e\u6709workbook\u7684\u9690\u85cfsheet\u4fee\u6539\uff0c\u6700\u597d\u4e0a\u5c42\u4f20\u5165\u5bf9\u5e94\u7684sheetId\u3002");_.forEach(function(e){!function(e,t,a,o){var h=i.default.window.SpreadsheetApp,f=h.spreadsheet;f.properties;if(h.socket.client&&"SHUTDOWN"===h.socket.client.getRoomState())return d.default.run(c.CONFIG.DO_BEHAVIOR_AFTER_SHUTDOWN),void alert("\u8868\u683c\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002");var p=[];try{for(var _,E=0;_=t[E++];)p.push((0,s.serializeMutation)(_))}catch(S){var T="";try{T=(0,n.default)(t)}catch(R){}return void d.default.run(c.CONFIG.COMMIT_MUTATION_CATCH_ERROR,[a||"unknowRequestId",e,T],S)}for(var m=0;m<t.length;m++){var g=t[m];if(g&&g.getAffectedSheetId()!==e)return d.default.run(c.CONFIG.COMMIT_MUTATION,[e,t]),void h.socket.client.shutDown(l.errCodeType.SHEET_ID_ERROR_1)}if(d.default.run(c.CONFIG.CACHE_DATA_FLOW_COMMIT_MUTATION,[a||"unknowRequestId",e]),(0,u.checkOfflinePattern)(h),a===r.default.SET_SHEETS_REQUEST)return void t.forEach(function(t){!function(e,t,a,n){var o=[{type:"ms",d:t}];i.default.window.SpreadsheetApp.messageCenter.addUserChange(e,0,o,r.default.SET_SHEETS_REQUEST,!0,a,n)}(e,t.data,o.oSubId,o.withKeyData)});a!==r.default.SET_SINGLE_VALUE_REQUEST&&a!==r.default.PASTE_DATA_REQUEST||0!==i.default.window.clientVars.isUserChangeTitle||function(e,t){var a=/^[^\u4e00-\u9fa5a-zA-Z\d]+/,n=/[^\u4e00-\u9fa5a-zA-Z\d]+$/,o=function(e){var t="";if(e){var o=(t=e.replace(a,"").replace(n,"").trim()).split(/\s{10}/),i=o[o.length-1];i&&o.length>1&&(i=i.replace(/^\s*/,""),t=o[0]+"          "+i)}return t},i=function(e){if(e){var t=e.replace(a,"");return t.length>0}return!1},r=function(e){if(e){for(var t="",a=0;a<e.data.rowData.length;a++)if(e.data.rowData[a]){for(var n=e.data.rowData[a].values,r=0;r<n.length;r++){var s=n[r];if(s){var l=s.getFormattedValue();if(!s.getFormula()&&i(l&&l.value)){t=o(l&&l.value);break}}}if("string"===typeof t&&t)break}return t}}(e.activeSheet);"function"===typeof t&&t(r)}(f,v);h.messageCenter.addUserChange(e,0,t,a,!1,null,!1)}(e,p[e],h,f)})});function v(e){i.default.window.clientVars.collab_client_vars.ver>=5&&(e&&i.default.window.SpreadsheetApp.spreadsheet.setTitle(e),i.default.window.SpreadsheetApp.event.spreadsheetEvent.trigger(f.EVENT_NAME.TITLE_AUTO_CHANGE))}},140:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.traceFunc=t.TraceStack=t.traceStack=void 0;var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(){(0,n.default)(this,e),this._queue=[],this._taskStack=[],this._count=0}return(0,o.default)(e,[{key:"_runTask",value:function(){}},{key:"_overTask",value:function(){for(var e=[],t=[],a=void 0,n=0;n<this._taskStack.length;n++)if(a=this._taskStack[n],void 0===e[0]||e[0].id!==a.id||e[0].type===a.type)t.push(a),e.unshift(a);else{var o=e.shift();o.time=a.end-o.start,o.start=l(o.start),delete o.type}this._queue.push(t),this._taskStack=[],this._count=0,this._queue.length>5&&(this._queue=this._queue.slice(-5)),console.log(this._queue)}}]),(0,o.default)(e,[{key:"start",value:function(e){0===this._count&&this._runTask(),this._count++,this._taskStack.push({id:e,start:Date.now(),type:0})}},{key:"end",value:function(e){this._taskStack.push({id:e,end:Date.now(),type:1}),this._count--,0===this._count&&this._overTask()}},{key:"clear",value:function(){0===this._count?this._queue.length=0:console.warn("\u5806\u6808\u8bb0\u5f55\u6267\u884c\u8fc7\u7a0b\u4e2d\u65e0\u6cd5\u6e05\u9664")}},{key:"queue",get:function(){return this._queue}},{key:"task",get:function(){return this._queue[this._queue.length-1]}}]),e}(),s=new r;function l(e){var t=new Date(e),a=t.getMonth()+1,n=t.getDate(),o=t.getHours(),i=t.getMinutes(),r=t.getSeconds(),s=t.getMilliseconds(),l=[a,n,o,i].map(function(e){return e<10?"0"+e:e.toString()});return l[0]+"-"+l[1]+" "+l[2]+":"+l[3]+" "+r+":"+s}t.traceStack=s,t.TraceStack=r,t.traceFunc=function(e){var t=void 0;try{if(t=e.toString().match(/^(function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(t))return console.warn("proxy function error"),e}catch(n){return console.warn("proxy function error",n),e}if(null===t)return e;var a=t[2];return"string"!==typeof a?e:function(){s.start(""+a);var t=e.apply(this,arguments);return s.end(""+a),t}},t.default=function(e){return function(t,a,n){!function(e,t,a,n){var o=void 0;try{if(o=e.toString().match(/^(class|function)\s(\w+)[\(\s]/),"[object Array]"!==Object.prototype.toString.apply(o))return console.warn("proxy function error"),n}catch(r){return console.warn("proxy function error",r),n}var i=o[2];if("string"!==typeof i)return n;e.prototype[a+"-decorators"]=n.value,n.value=function(){s.start(i+"-"+a);var t=e.prototype[a+"-decorators"].apply(this,arguments);return s.end(i+"-"+a),t}}(e,0,a,n)}}},1401:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parse2TextFormatRuns=t.parse2TextFormat=void 0;var n=i(a(9)),o=i(a(89));function i(e){return e&&e.__esModule?e:{default:e}}function r(e){var t=/[+-]?\d+(?:\.\d+)?/g.exec(e);return t&&Number(t[0])||10}function s(e){var t=10;return/pt$/i.test(e)?t=r(e):/px$/i.test(e)&&(t=Math.round(3*r(e)/4)),t}t.parse2TextFormat=function(e,t){return e&&(0,n.default)(e).length?function(e,t){var a=e.color?o.default.Utils.colorUtils.colorValues(e.color):null;return new o.default.Cell.Format.TextFormat({color:a?new o.default.Cell.Format.Color({red:a[0],green:a[1],blue:a[2],alpha:a[3]}):t&&t.color?t.color:new o.default.Cell.Format.Color({red:0,green:0,blue:0,alpha:1}),fontFamily:e.fontFamily?e.fontFamily:t&&t.fontFamily?t.fontFamily:"Microsoft YaHei",fontSize:e.fontSize?s(e.fontSize):t&&t.fontSize?t.fontSize:10,bold:void 0!==e.bold?e.bold:!(!t||!t.bold)&&t.bold,italic:void 0!==e.italic?e.italic:!(!t||!t.italic)&&t.italic,strikethrough:void 0!==e.strikethrough&&e.strikethrough,underline:void 0!==e.underline?e.underline:null})}(e,t):null},t.parse2TextFormatRuns=function(e){var t=[],a=0;return e&&(t=(e=function(e){if(!e||e.length<=1)return e;for(var t=0,a=void 0,n=void 0;t<e.length-1;)a=e[t],n=e[t+1],a.textFormat===n.textFormat||a.textFormat&&a.textFormat.equal(n.textFormat)?(a.text+=n.text,e.splice(t+1,1)):t++;return e}(e)).map(function(e){var t=new o.default.Cell.TextFormatRun({startIndex:a,format:e.textFormat});return a+=e.text.length,t})),t}},1402:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(3)),o=l(a(0)),i=l(a(1)),r=l(a(4)),s=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,{alloyExcel:e.excel}));return a.app=e.spreadsheetApp,a.cache={},a.rotateAngleNumber=0,a.loadingNumber=0,a.getSheet=e.getSheet,a.addHook("afterRender",a.renderCellLoading.bind(a)),a.stage.render(),a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"cycleForRotation",value:function(){var e=this;requestAnimationFrame(function(){e.loadingNumber&&e.stage.render(),e.cycleForRotation()})}},{key:"renderCellLoading",value:function(e){this.rotateAngleNumber++,this.loadingNumber=0;var t=this.stage.areaData,a=void 0,n=void 0,o=this.app.spreadsheet.activeSheet,i=o.data.rowData,r=void 0,s=Math.max(t.row.frozen.from-1,0),l=Math.min(t.row.frozen.to+1,o.getRowCount());for(n=s;n<l;n++)if(i[n]){var u=o.getColCount(),d=Math.max(t.col.frozen.from-1,0),c=Math.min(t.col.frozen.to+1,u);for(a=d;a<c;a++)(r=i[n].values[a])&&this.render(r,n,a,e);var h=Math.max(t.col.flow.from-1,0),f=Math.min(t.col.flow.to+1,u);for(a=h;a<f;a++)(r=i[n].values[a])&&this.render(r,n,a,e)}var p=Math.max(t.row.flow.from-1,0),v=Math.min(t.row.flow.to+1,o.getRowCount());for(n=p;n<v;n++)if(i[n]){var _=o.getColCount(),E=Math.max(t.col.frozen.from-1,0),T=Math.min(t.col.frozen.to+1,_);for(a=E;a<T;a++)(r=i[n].values[a])&&this.render(r,n,a,e);var m=Math.max(t.col.flow.from-1,0),g=Math.min(t.col.flow.to+1,_);for(a=m;a<g;a++)(r=i[n].values[a])&&this.render(r,n,a,e)}}},{key:"render",value:function(e,t,a,n){var o=this.getSheet();if(void 0!==o.data){var i=o.data,r=i.rowMetadata[t];i.columnMetadata[a];if(!r||!r.hiddenByUser&&!r.hiddenByFilter){var s=e.getEffectiveValue();if(e.getFormula()&&!s){var l=this.stage.areaData.col.getViewportLeft(a),u=this.stage.areaData.col.getViewportLeft(a+1),d=(l+u)/2,c=(this.stage.areaData.row.getViewportTop(t)+this.stage.areaData.row.getViewportTop(t+1))/2,h=u-l;n.fillText("\u8ba1\u7b97\u4e2d...",d,c,h)}}}}}]),t}(l(a(243)).default.AlloyExcelPlugin);t.default=u},1403:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(a(9)),o=_(a(31)),i=_(a(0)),r=_(a(1)),s=_(a(7)),l=a(125),u=_(a(238)),d=_(a(706)),c=a(124),h=_(a(12)),f=_(a(8)),p=a(1404),v=a(143);function _(e){return e&&e.__esModule?e:{default:e}}var E=s.default.window,T=function(){function e(t){(0,i.default)(this,e),this.spreadsheetApp=t}return(0,r.default)(e,[{key:"init",value:function(e,t,a){this.excel=e,this.scale=t||1,this.lastExcelVersion=a}},{key:"updateImageData",value:function(){if(void 0===this.lastImageVersion||this.lastImageVersion!==this.lastExcelVersion){this.lastImageVersion=this.lastExcelVersion;var e=(0,p.getSnapshotDpr)(),t=this.excel.width*e,a=this.excel.height*e;return this.excel.ctx.getImageData(0,0,t,a)}}},{key:"updateShadowExcel",value:function(){try{this.excel.clearTable()}catch(n){}if(void 0===this.lastExcelVersion||this.lastExcelVersion!==this.spreadsheetApp.messageCenter.currentVersion){this.lastExcelVersion=this.spreadsheetApp.messageCenter.currentVersion,E.swReportStop&&E.swReportStop(),f.default.jank.log({moduleValue:"quickOpen",actionValue:"snapshot"});var e=+new Date,t=(0,l.transformAll)(this.spreadsheetApp.spreadsheet.activeSheet);t=this.sideCanvasDataCutter(t),this.excel&&(this.excel.setTableAll(t),this.excel.tableAltering=!1);var a=+new Date-e;u.default.log("\u66f4\u65b0AlloyExcel\u5bf9\u8c61\u6570\u636e:"+a),E.swReportRestart&&E.swReportRestart()}}},{key:"sideCanvasDataCutter",value:function(e){var t=100,a=50,i=Math.max(s.default.window.SpreadsheetApp.view.canvas.excel.height,450),r=Math.max(s.default.window.SpreadsheetApp.view.canvas.excel.width,800);try{for(var l=s.default.window.SpreadsheetApp.view.canvas.excel.areaData.col.globalLeft,u=0;u<l.length;u++)if(l[u]>r){a=u+1;break}for(var d=s.default.window.SpreadsheetApp.view.canvas.excel.areaData.row.globalTop,c=0;c<d.length;c++)if(d[c]>i){t=c+1;break}}catch(D){}var h={},f=!0,p=!1,v=void 0;try{for(var _,E=(0,o.default)((0,n.default)(e.merge));!(f=(_=E.next()).done);f=!0){var T=_.value,m=e.merge[T];m.y>=t||m.x>=a||(m.y+m.h>t-1&&(m.h=t-m.y-1),m.x+m.w>a-1&&(m.w=a-m.x-1),0!==m.w&&0!==m.h&&(h[T]=m))}}catch(D){p=!0,v=D}finally{try{!f&&E.return&&E.return()}finally{if(p)throw v}}var g={};for(var S in e.colHide)Number(S)>=a||(g[S]=e.colHide[S]);var R={};for(var A in e.rowHide)Number(A)>=t||(R[A]=e.rowHide[A]);var w=[].concat(e.colWidths);w.length>=a&&(w.length=a);var I=[].concat(e.rowHeights);I.length>=t&&(I.length=t);for(var C=[],y=0;y<e.data.length;y++){var O=[].concat(e.data[y]);if(O.length>a&&(O.length=a),C.push(O),y>=t-1)break}return{colWidths:w,rowHeights:I,colHide:g,rowHide:R,frozen:e.frozen,merge:h,shapes:e.shapes,filter:e.filter,links:e.links,data:C,hideGridlines:e.hideGridlines}}},{key:"saveImageDataLocal",value:function(e,t){try{var a=this.spreadsheetApp.spreadsheet.activeSheet.properties.getGridProperties(),n=a.frozenRowCount>0||a.frozenColCount>0;this.spreadsheetApp.spreadsheet.mainThreadWorker.snapshot.saveQuicklookSnapshot(e,t,{padId:location.pathname.replace("/sheet/",""),userId:(0,c.getCookie)("uid"),sheetId:(0,v.getQuery)("tab")||"",isMobile:!1,isForzen:n})}catch(o){return console.error(o),u.default.log("saveImageDataLocal,"+o),""}}},{key:"uploadSnapshotThumb",value:function(e,t,a){try{this.spreadsheetApp.spreadsheet.mainThreadWorker.snapshot.uploadSnapshotThumb(e,t,{padId:E.clientVars.globalPadId,userId:E.clientVars.userId,version:a})}catch(n){return console.error(n),""}}},{key:"createSnapshot",value:function(e){var t=this;e&&this.updateShadowExcel();try{var a=this.updateImageData();a&&(this.saveImageDataLocal(a,{startX:0,startY:0}),h.default.wait(d.default.QUICKLOOK_STEP).run(function(){t.createSnapshot(!0)}))}catch(n){console.error("\u4fdd\u5b58\u622a\u56fe\u51fa\u9519")}}},{key:"createSnaphpotThumb",value:function(e){arguments.length>1&&void 0!==arguments[1]&&arguments[1];var t=arguments[2];if(0===this.spreadsheetApp.spreadsheet.activeSheet.getIndex()){e&&this.updateShadowExcel();var a=(0,p.getSnapshotDpr)();try{console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u5f00\u59cb\u751f\u6210\u7f29\u7565\u56fe");var n=this.updateImageData(),o=Math.round((this.excel.configData.rowHeadWidth+2)*a),i=Math.round((this.excel.configData.colHeadHeight+2)*a);console.log("startX:"+o+"startY:"+i),n&&this.uploadSnapshotThumb(n,{startX:o,startY:i,maxWidth:Math.round(800*a*this.scale),maxHeight:Math.round(450*a*this.scale)},t)}catch(r){console.error("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u4e0a\u4f20\u7f29\u7565\u56fe\u5931\u8d25")}}else console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u5f53\u524d\u975e\u7b2c\u4e00\u4e2asheet\uff0c\u4e0d\u9700\u8981\u4e0a\u4f20\u622a\u56fe")}},{key:"checkShouldUploadThumb",value:function(e,t){var a=this,n=this.spreadsheetApp.spreadsheet.activeSheet.getIndex(),o=void 0!==t?t:this.spreadsheetApp.messageCenter.currentVersion;0===n?(console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u5f00\u59cb\u8bf7\u6c42\u662f\u5426\u4e0a\u4f20\u7f29\u7565\u56fe"),$.ajax({url:"/sdc/check_thumbnail_status?padId="+E.clientVars.globalPadId+"&version="+o,xhrFields:{withCredentials:!0},success:function(t){t&&0===t.retcode&&(t.result.need_upload_thumbnail?(console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u9700\u8981\u4e0a\u4f20\u7f29\u7565\u56fe"),a.createSnaphpotThumb(e,a.scale,o)):console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u4e0d\u9700\u8981\u4e0a\u4f20\u7f29\u7565\u56fe"))},error:function(){}})):console.log("\u7f29\u7565\u56fe\u9700\u6c42\uff1a\u5f53\u524d\u975e\u7b2c\u4e00\u4e2asheet\uff0c\u4e0d\u9700\u8981\u4e0a\u4f20\u622a\u56fe")}}]),e}();t.default=T},1404:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSnapshotDpr=function(){return n.isMobile||n.isMac||n.isPad?1.5:1};var n=a(22)},1405:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=m(a(31)),i=m(a(3)),r=m(a(0)),s=m(a(1)),l=m(a(4)),u=m(a(5)),d=m(a(243)),c=m(a(1406)),h=a(414),f=m(a(708)),p=m(a(707)),v=m(a(1408)),_=a(22),E=m(a(8)),T=m(a(7));function m(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.CELL=0]="CELL",e[e.SHAPE=1]="SHAPE"}(n||(n={}));var g=function(e){function t(e){(0,r.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,{alloyExcel:e.excel}));return a._renderCollabCell=function(){var e=a.cellStore.all(),t=!0,n=!1,i=void 0;try{for(var r,s=(0,o.default)(e);!(t=(r=s.next()).done);t=!0){r.value.render()}}catch(l){n=!0,i=l}finally{try{!t&&s.return&&s.return()}finally{if(n)throw i}}},a._focusCell=function(e){a.cellStore.focus(e)},a._selectionShow=function(e){if(void 0!==e){if(e.show){if(!e.activeChange&&!e.selectChange)return;a.status=n.CELL,a.coords.x=a.stage.selectData.active.xIndex,a.coords.y=a.stage.selectData.active.yIndex,a.coords.isEditing=3===a.stage.tableData.tableStatus}else if(null!==a.stage.selectData.pickShape)a.status=n.SHAPE,a.shapeId=a.stage.selectData.pickShape,a._focusShape(a.stage.selectData.pickShape);else{if(0!==a.stage.tableData.tableStatus)return;a.status=n.CELL,a.coords.x=-1,a.coords.y=-1,a.coords.isEditing=!1}a._notifyMyPosition()}},a._enterInput=function(){a.status=n.CELL,a.coords.x=a.stage.selectData.active.xIndex,a.coords.y=a.stage.selectData.active.yIndex,a.coords.isEditing=!0,a._inputCell({x:a.coords.x,y:a.coords.y}),a._notifyMyPosition()},a._clear=function(){a.cellStore.clear(),a.shapeStore.clear(),a._render()},a.app=e.spreadsheetApp,a.coords={x:-1,y:-1,isEditing:!1},a.shapeId=null,p.default.init({alloyExcel:a.stage}),f.default.init({alloyExcel:a.stage}),a.cellStore=new c.default,a.shapeStore=new v.default,a._render=(0,h.debounce)(a._render.bind(a),100),a._selectionShow=(0,h.debounce)(a._selectionShow,500),a.addHook("selectionShow",a._selectionShow),a.addHook("enterInputStatus",a._enterInput),T.default.event.sheetsBar.listen("switchSheetEnd",a._clear),a.listenPermissionsStatusChange(),a}return(0,u.default)(t,e),(0,s.default)(t,[{key:"_isValid",value:function(e){return null!==e.x&&null!==e.y}},{key:"_listenEvent",value:function(){this.app.sheetStatus.permission.gEditable&&(this.addHook("afterRender",this._renderCollabCell),_.isPc?this.addHook("mouseDown",this._focusCell):this.addHook("tap",this._focusCell))}},{key:"_removeEvent",value:function(){this.app.sheetStatus.permission.gEditable||(this.removeHook("afterRender",this._renderCollabCell),_.isPc?this.removeHook("mouseDown",this._focusCell):this.removeHook("tap",this._focusCell))}},{key:"_render",value:function(){this.stage.renderNextTick()}},{key:"_inputCell",value:function(e){this.cellStore.unfocus(e)}},{key:"_focusShape",value:function(e){this.shapeStore.focus(e)}},{key:"_notifyMyPosition",value:function(){if(this.status===n.CELL)this.app.view.afterSelectionEnd(this.coords.x,this.coords.y,this.coords.isEditing);else if(this.status===n.SHAPE){if(null===this.shapeId)return;this.app.view.afterPickShape(this.shapeId)}}},{key:"listenPermissionsStatusChange",value:function(){var e=this;this.app.sheetStatus.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){this._removeEvent(),this._render()}},{key:"switchToEditable",value:function(){this._listenEvent()}},{key:"addCollaborator",value:function(e){this._isValid(e)&&(E.default.jank.log({moduleValue:"view",actionValue:"collaborator",detail:["add"]}),void 0!==e.x&&void 0!==e.y?(0===this.cellStore.amount()&&this._listenEvent(),this.cellStore.addUser(e)):e.shapeId&&this.shapeStore.addUser(e),this._render())}},{key:"changeCollaborator",value:function(e){this._isValid(e)&&(E.default.jank.log({moduleValue:"view",actionValue:"collaborator",detail:["change"]}),void 0!==e.x&&void 0!==e.y?this.shapeStore.exist(e.id)?(this.shapeStore.removeUser(e.id),this.addCollaborator(e)):this.cellStore.exist(e.id)?this.cellStore.updateUser(e):this.addCollaborator(e):e.shapeId&&(this.cellStore.exist(e.id)?(this.cellStore.removeUser(e.id),this.addCollaborator(e)):this.shapeStore.exist(e.id)?this.shapeStore.updateUser(e):this.addCollaborator(e)),this._render())}},{key:"removeCollaborator",value:function(e){this.cellStore.exist(e)?(this.cellStore.removeUser(e),0===this.cellStore.amount()&&this._removeEvent()):this.shapeStore.exist(e)&&this.shapeStore.removeUser(e),this._render()}}]),t}(d.default.AlloyExcelPlugin);t.default=g},1406:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(14)),o=h(a(31)),i=h(a(204)),r=h(a(0)),s=h(a(1)),l=h(a(1407)),u=h(a(707)),d=h(a(8)),c=a(22);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,r.default)(this,e),this.users={},this.cells=new i.default}return(0,s.default)(e,[{key:"all",value:function(){return this.cells}},{key:"getCell",value:function(e,t){var a=!0,n=!1,i=void 0;try{for(var r,s=(0,o.default)(this.cells.values());!(a=(r=s.next()).done);a=!0){var l=r.value;if(l.x===e&&l.y===t)return l}}catch(u){n=!0,i=u}finally{try{!a&&s.return&&s.return()}finally{if(n)throw i}}return null}},{key:"addUser",value:function(e){if(void 0!==e.x&&void 0!==e.y)if(this.users[e.id])this.updateUser(e);else{var t=null,a=!0,i=!1,r=void 0;try{for(var s,d=(0,o.default)(this.cells.values());!(a=(s=d.next()).done);a=!0){var c=s.value;if(c.x===e.x&&c.y===e.y){t=c;break}}}catch(f){i=!0,r=f}finally{try{!a&&d.return&&d.return()}finally{if(i)throw r}}t||(t=new u.default({x:e.x,y:e.y}));var h=new l.default((0,n.default)(e,{cell:t}));t.insertUser(h),this.users[e.id]=h,this.cells.add(t)}}},{key:"updateUser",value:function(e){void 0!==e.x&&void 0!==e.y&&(this.users[e.id]?(this.removeUser(e.id),this.addUser(e)):this.addUser(e))}},{key:"removeUser",value:function(e){if(this.users[e]){var t=this.users[e];return t.cell.eraseUser(t),t.cell.usersAmount()<=0&&this.cells.delete(t.cell),delete this.users[e],t}return null}},{key:"exist",value:function(e){return!!this.users[e]}},{key:"amount",value:function(){return this.cells.size}},{key:"clear",value:function(){this.users={},this.cells.clear()}},{key:"focus",value:function(e){var t=e.x,a=e.y,n=this.getCell(t,a);n&&(n.active(),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_co-edit",action:"mb_select_hover_tag"}))}},{key:"unfocus",value:function(e){var t=e.x,a=e.y,n=this.getCell(t,a);if(n){n.inactive();var o=c.isPc?"co_edit_p":"mb_co_edit_p";d.default.tdwReport({opername:"doc_excel_editor",module:"excel_co-edit",action:o,obj3:n.usersEditingAmount()+1})}}}]),e}();t.default=f},1407:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(0),i=(n=o)&&n.__esModule?n:{default:n};t.default=function e(t){(0,i.default)(this,e),this.id=t.id,this.name=t.name,this.color=t.color,this.isEditing=t.input,this.coords={x:t.x,y:t.y},this.cell=t.cell}},1408:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(14)),o=d(a(31)),i=d(a(204)),r=d(a(0)),s=d(a(1)),l=d(a(1409)),u=d(a(708));function d(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,r.default)(this,e),this.users={},this.shapes=new i.default}return(0,s.default)(e,[{key:"getShape",value:function(e){var t=!0,a=!1,n=void 0;try{for(var i,r=(0,o.default)(this.shapes.values());!(t=(i=r.next()).done);t=!0){var s=i.value;if(e===s.shapeId)return s}}catch(l){a=!0,n=l}finally{try{!t&&r.return&&r.return()}finally{if(a)throw n}}return null}},{key:"addUser",value:function(e){if(e.shapeId)if(this.users[e.id])this.updateUser(e);else{var t=null,a=!0,i=!1,r=void 0;try{for(var s,d=(0,o.default)(this.shapes.values());!(a=(s=d.next()).done);a=!0){var c=s.value;if(c.shapeId===e.shapeId){t=c;break}}}catch(f){i=!0,r=f}finally{try{!a&&d.return&&d.return()}finally{if(i)throw r}}t||(t=new u.default({shapeId:e.shapeId}));var h=new l.default((0,n.default)(e,{shape:t}));t.insertUser(h),this.users[e.id]=h,this.shapes.add(t)}}},{key:"updateUser",value:function(e){e.shapeId&&(this.users[e.id]?(this.removeUser(e.id),this.addUser(e)):this.addUser(e))}},{key:"removeUser",value:function(e){if(this.users[e]){var t=this.users[e];return t.shape.eraseUser(t),t.shape.userAmount()<=0&&this.shapes.delete(t.shape),delete this.users[e],t}return null}},{key:"exist",value:function(e){return!!this.users[e]}},{key:"clear",value:function(){this.users={},this.shapes.clear()}},{key:"focus",value:function(e){var t=this.getShape(e);t&&t.active()}}]),e}();t.default=c},1409:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(0),i=(n=o)&&n.__esModule?n:{default:n};t.default=function e(t){(0,i.default)(this,e),this.id=t.id,this.name=t.name,this.color=t.color,this.shapeId=t.shapeId,this.shape=t.shape}},1410:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(0)),o=c(a(1)),i=c(a(7)),r=c(a(1411)),s=a(206),l=c(a(1412)),u=a(82),d=c(a(12));function c(e){return e&&e.__esModule?e:{default:e}}var h=i.default.window.$,f=/Mac/i.test(navigator.platform)?"metaKey":"ctrlKey",p=function(){function e(t,a){(0,n.default)(this,e),this.app=t,this.excel=a.excel,this.initDOM(),this.initMouseEvent(),this.initShortCutsEvents(),this.initCoreEvents()}return(0,o.default)(e,[{key:"initDOM",value:function(){var e=this,t=document.querySelector(".inputboxwrap");if(t){this.cellHeadEl=document.querySelector(".cell-head");var a=document.querySelector(".cell-input");a&&a.parentNode&&a.parentNode.removeChild(a),this.alloySTE=new l.default({parent:t,className:"cell-input",platform:"PC",exitHandler:this._editorExitHandler.bind(this),valueChange:this._editorValueChange.bind(this)});var n=h("#inputboxwithpc");n.show(),this.inputBoxResizeEle=h("#inputboxResize"),this.inputBoxResizeEle.hover(function(){e.inputBoxResizeHandler||(e.inputBoxResizeHandler=new r.default(e.app),e.inputBoxResizeHandler.isEnable=!0,e.inputBoxResizeHandler.init(e.inputBoxResizeEle,n,h("#canvasContainer")))})}else console.warn("warning: cannot find input box parent node!")}},{key:"initMouseEvent",value:function(){var e=this;this.alloySTE.attachEventToInput("mousedown",function(t){e.excel.inputChannel({type:"ENTER_TOOLBAR_INPUT"}),d.default.wait(0).run(function(){e.app.event.default.trigger("uncheck-format")})})}},{key:"initShortCutsEvents",value:function(){var e=this;this.alloySTE.attachEventToInput("keydown",function(t){var a=66===t.keyCode||"b"===t.key,n=73===t.keyCode||"i"===t.key,o=68===t.keyCode||"d"===t.key,i=85===t.keyCode||"u"===t.key;if((a||n||o||i)&&!0===t[f]){t.preventDefault();var r=a?"bold":n?"italic":o?"strikeThrough":i?"underline":"";e._format(r)}})}},{key:"initCoreEvents",value:function(){var e=this;this.app.event.view.listen(u.EVENT_NAME.ACTIVATION_CHANGE,function(){e.resetWhenChangeActivation()}),this.app.event.view.listen(u.EVENT_NAME.INPUT_CHANGE,function(t){e.setCellValue(t)}),this.app.event.view.listen(u.EVENT_NAME.INPUT_END,function(){e.resetWhenChangeActivation()})}},{key:"_format",value:function(e){if(e&&e.length){var t=this.getRange();this.excel.inputChannel({type:"FORMAT",cmd:e,range:t})}}},{key:"_editorExitHandler",value:function(e){}},{key:"_editorValueChange",value:function(e){this.syncValue(e)}},{key:"resetWhenChangeActivation",value:function(){var e=this.app.view.canvas.excel.selectData.active.yIndex,t=this.app.view.canvas.excel.selectData.active.xIndex,a=this.app.spreadsheet.activeSheet.getCellDataAtPosition(e,t),n=a&&a.getEditValue()||"";this._resetWhenChangeActivation(t,e,n)}},{key:"_resetWhenChangeActivation",value:function(e,t,a){this.setCellCoordDisplay(e,t),this.setCellValue(a)}},{key:"setCellCoordDisplay",value:function(e,t){var a=this._getCellHeadText(e,t);this.cellHeadEl&&(this.cellHeadEl.innerText=a)}},{key:"_getCellHeadText",value:function(e,t){return e=e||0,t=t||0,(0,s.toColumnName)(e+1)+(t+1)}},{key:"syncValue",value:function(e){e=e||this.getText(),this.excel.inputChannel({type:"SYNC_VALUE",value:e})}},{key:"clear",value:function(){this.alloySTE.clear()}},{key:"setCellValue",value:function(e){this.clear(),this.alloySTE.setText(e),this.alloySTE.save()}},{key:"getRange",value:function(){return this.alloySTE.getSelection()}},{key:"setRange",value:function(e){this.alloySTE.setSelection(e)}},{key:"collapseToEnd",value:function(){this.alloySTE.collapseToEnd()}},{key:"getText",value:function(){return this.alloySTE.getText()}},{key:"hasFocus",value:function(){return this.alloySTE.hasFocus()}},{key:"blur",value:function(){this.alloySTE.blur()}},{key:"focus",value:function(){this.alloySTE.focus()}}]),e}();t.default=p},1411:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=i(a(7)).default.window.$,s=function(){function e(t){(0,n.default)(this,e),this.is_mouse_down=!1,this.isEnable=!1,this.app=t,this.excel=t.view.canvas.excel}return(0,o.default)(e,[{key:"init",value:function(e,t,a){this.isEnable&&(this.$inputboxResize=e,this.$resizeObj=t,this.$editor=a,this.registerResize())}},{key:"registerResize",value:function(){var e=this;this.$inputboxResize.mousedown(function(t){e.is_mouse_down=!0}),r(document).bind("click mouseup",function(t){e.is_mouse_down&&(e.is_mouse_down=!1)}),r(document).mousemove(function(t){e.doResize(t,!0)})}},{key:"doResize",value:function(e,t){var a,n,o;if(this.is_mouse_down){var i=parseInt(this.$resizeObj[0].getBoundingClientRect().top),r=parseInt(this.$editor.css("padding-top"));a=t?(a=e.clientY-i+10>25?e.clientY-i+10:25)<=75?a:75:(a=e.clientY+r-i+10>25?e.clientY+r-i+10:25)<=75?a:75,o=this.$editor[0].getBoundingClientRect().top,n=window.innerHeight-o-36,this.$resizeObj.height(a),this.$resizeObj.css("line-height",a+"px"),this.$editor.css("height",n),this.excel.resize(),this.excel.setDistanceY(o)}}},{key:"resetMouseDown",value:function(){this.is_mouse_down=!1}}]),e}();t.default=s},1413:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(0)),o=p(a(1)),i=p(a(408)),r=p(a(1414)),s=p(a(1422)),l=p(a(1424)),u=p(a(1425)),d=p(a(710)),c=p(a(1426)),h=p(a(1427)),f=p(a(1428));function p(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(t){(0,n.default)(this,e),this.parent=t,this.init()}return(0,o.default)(e,[{key:"init",value:function(){this.initCopyPaste(),this.initContext(),this.initFullMember(),this.initRelateForm(),this.initConditionalFormat(),this.initFormatPainter(),this.initSmartSplit()}},{key:"initCopyPaste",value:function(){this.copyPaste=new i.default(this.parent)}},{key:"initOfflineSnapshot",value:function(){this.offlineSnapshot=new s.default(this.parent)}},{key:"initContext",value:function(){this.context=new l.default(this.parent)}},{key:"initFullMember",value:function(){this.fullMember=new u.default(this.parent)}},{key:"initRelateForm",value:function(){this.rmap=new r.default(this.parent)}},{key:"initDataValidation",value:function(){this.dataValidation=new d.default(this.parent)}},{key:"initFormatPainter",value:function(){this.formatPainter=new h.default(this.parent)}},{key:"initSmartSplit",value:function(){this.smartSplit=new f.default(this.parent)}},{key:"initConditionalFormat",value:function(){this.conditionalFormat=new c.default(this.parent)}}]),e}();t.default=v},1422:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(16)),o=d(a(0)),i=d(a(1)),r=d(a(7)),s=d(a(1423)),l=a(188),u=d(a(8));function d(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(t){(0,o.default)(this,e),this.app=t,this.init(),this.offlineSnapshotIndexDB=new s.default(t)}return(0,i.default)(e,[{key:"init",value:function(){}},{key:"backUp",value:function(){if(this.app.sheetStatus.permission.gEditable)try{console.log("\u6b63\u5728\u5907\u4efd\u79bb\u7ebf\u5feb\u7167");var e=this.app.spreadsheet.getActiveSheetId(),t=(this.app.spreadsheet.getSheetBySheetId(e),r.default.window.clientVars.padId+"_"+e),a=r.default.window.CryptoJS.MD5(t).toString(),o=(0,l.createZipKeyframe)(e);if(!o)return void console.log("\u5907\u4efd\u5931\u8d25\uff0c keyframe\u4e3a\u7a7a\u3002");var i=r.default.window.CryptoJS.AES.encrypt(o,t).toString();this.offlineSnapshotIndexDB.save(a,i),console.log("\u5907\u4efd\u6210\u529f")}catch(s){console.error("\u5907\u4efd\u5931\u8d25\uff0c\u539f\u56e0\uff1a"+s),u.default.tdwReport({opername:"offlineSnapshot_backup",module:"offlineSnapshot",action:"\u79bb\u7ebf\u5feb\u7167\u5907\u4efd\u5931\u8d25\uff0c try catch \u62a5\u9519",obj1:(0,n.default)(s)})}}},{key:"getBackUp",value:function(e,t,a){var n=r.default.window.CryptoJS.MD5(e).toString();this.offlineSnapshotIndexDB.get(n,function(a){var n=r.default.window.CryptoJS.AES.decrypt(a,e).toString(r.default.window.CryptoJS.enc.Utf8);t(n)},function(){a()})}},{key:"intervalBackUp",value:function(){var e=this;this.intervalTimer=setInterval(function(){e.backUp()},1e4)}},{key:"stopIntervalBackUp",value:function(){clearInterval(this.intervalTimer)}}]),e}();t.default=c},1423:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(16)),o=l(a(0)),i=l(a(1)),r=l(a(7)),s=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var a=this;(0,o.default)(this,e),this.storeName="client_backup_keyframes",this.dbName="tencent_doc_client_keyframe_backup",this.version=1,this.supportIndexDB=!1,this.initAfterDelete=function(){a.deleteDB(function(){localStorage.setItem("lastTimeCleanKeyframeBackupDB",String((new Date).getTime())),a.init()},function(){a.init()})},this.app=t,this.init()}return(0,i.default)(e,[{key:"init",value:function(){var e=this;if(this.__indexedDB=r.default.window.indexedDB||r.default.window.mozIndexedDB||r.default.window.webkitIndexedDB||r.default.window.msIndexedDB,!this.__indexedDB)return console.error("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301IndexedDB\uff0c\u65e0\u6cd5\u5907\u4efd"),void s.default.tdwReport({opername:"indexDB_init",module:"offlineSnapshot",action:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301indexDB"});this.supportIndexDB=!0;var t=void 0;try{t=this.__indexedDB.open(this.dbName,this.version)}catch(a){return this.supportIndexDB=!1,console.error("keyframe backup db \u6253\u5f00\u5931\u8d25"),void s.default.tdwReport({opername:"indexDB_init",module:"offlineSnapshot",action:"\u6253\u5f00\u6570\u636e\u5e93\u5931\u8d25",obj1:a.name||a.message||""})}console.log("keyframe backup db start init"),t.onerror=function(e){console.error("keyframe backup db \u6253\u5f00\u5931\u8d25"),s.default.tdwReport({opername:"indexDB_init",module:"offlineSnapshot",action:"\u6253\u5f00\u6570\u636e\u5e93\u5931\u8d25",obj1:(0,n.default)(e)})},t.onsuccess=function(a){e.db=t.result,console.log("keyframe backup db \u6253\u5f00\u6210\u529f")},t.onupgradeneeded=function(t){e.db=t.target.result;e.db.createObjectStore(e.storeName,{keyPath:"key"});t.target.transaction.oncomplete=function(){console.log("keyframe backup db \u521d\u59cb\u5316\u6210\u529f")}}}},{key:"save",value:function(e,t){if(this.supportIndexDB&&this.db&&this.db.transaction){var a=this.db.transaction([this.storeName],"readwrite"),o=a&&a.objectStore&&a.objectStore(this.storeName);o.delete(e);var i=o.add({key:e,data:t});i.onsuccess=function(){},i.onerror=function(e){console.error("\u6570\u636e\u5907\u4efd\u5931\u8d25",e),s.default.tdwReport({opername:"indexDB_save",module:"offlineSnapshot",action:"\u6570\u636e\u5907\u4efd\u5931\u8d25",obj1:(0,n.default)(e)})}}}},{key:"get",value:function(e,t,a){if(this.supportIndexDB&&this.db&&this.db.transaction){var n=this.db.transaction([this.storeName]),o=n&&n.objectStore&&n.objectStore(this.storeName),i=o&&o.get(e);if(!i)return console.error("\u8bfb\u53d6\u5907\u4efd\u6570\u636e\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6e38\u6807"),void s.default.tdwReport({opername:"indexDB_get",module:"offlineSnapshot",action:"\u8bfb\u53d6\u5907\u4efd\u6570\u636e\u5931\u8d25\uff0c\u65e0\u6cd5\u8bfb\u53d6\u6e38\u6807"});i.onerror=function(e){console.log("\u8bfb\u53d6\u5907\u4efd\u6570\u636e\u5931\u8d25\uff0c\u6e38\u6807\u64cd\u4f5c\u5931\u8d25"),s.default.tdwReport({opername:"indexDB_get",module:"offlineSnapshot",action:"\u8bfb\u53d6\u5907\u4efd\u6570\u636e\u5931\u8d25\uff0c\u6e38\u6807\u64cd\u4f5c\u5931\u8d25"}),a()},i.onsuccess=function(){var e=i.result;e&&e.data?t(e.data):a()}}}},{key:"deleteDB",value:function(e,t){if(this.__indexedDB=r.default.window.indexedDB||r.default.window.mozIndexedDB||r.default.window.webkitIndexedDB||r.default.window.msIndexedDB,!this.__indexedDB)return console.error("\u6d4f\u89c8\u5668\u4e0d\u652f\u6301IndexedDB\uff0c\u65e0\u6cd5\u5220\u9664"),void s.default.tdwReport({opername:"indexDB_delete",module:"offlineSnapshot",action:"\u6d4f\u89c8\u5668\u4e0d\u652f\u6301indexDB"});var a=this.__indexedDB.deleteDatabase(this.dbName);console.log("keyframe backup db start delete"),a.onerror=function(){console.log("keyframe backup db \u5220\u9664\u5931\u8d25"),t&&t()},a.onsuccess=function(){console.log("keyframe backup db \u5220\u9664\u6210\u529f"),e&&e()},a.onblocked=function(){console.log("keyframe backup db blocked")},a.onupgradeneeded=function(){console.log("keyframe backup db upgradeneeded")}}}]),e}();t.default=u},1424:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(16)),o=l(a(0)),i=l(a(1)),r=l(a(7)),s=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,o.default)(this,e),this.queue=[],this.app=t}return(0,i.default)(e,[{key:"push",value:function(e){this.queue.length>100&&this.queue.shift(),this.queue.push({time:(new Date).toString(),info:e})}},{key:"send",value:function(){if(r.default.window.navigator.onLine&&this.queue.length){var e={queue:this.queue,padId:r.default.window.clientVars.globalPadId,url:r.default.window.location.href};e.commitingQueue=this.app.messageCenter.commitingQueue.jsonData,e.waitingQueue=this.app.messageCenter.waitingQueue.map(function(e,t){return{index:t,jsonData:e.jsonData}}),s.default.tdwReport({opername:"doc_excel_editor",module:"spread-sheet",action:"context",obj3:(0,n.default)(e)}),this.queue=[]}}}]),e}();t.default=u},1425:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(0)),o=p(a(1)),i=p(a(7)),r=p(a(100)),s=p(a(274)),l=a(71),u=a(99),d=p(a(8)),c=a(26),h=a(124),f=a(237);function p(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(t){(0,n.default)(this,e),this.isFull=!1,this.timer=0,this.app=t,this.init()}return(0,o.default)(e,[{key:"init",value:function(){var e=this;!i.default.window.clientVars.isOverConNum||i.default.window.clientVars.isOverUpdateConNum||i.default.window.clientVars.isCreator||(d.default.monitor(33686979),this.isFull=!0,this.timer=setInterval(function(){e.fetchData()},1e4))}},{key:"fetchData",value:function(){var e=this;d.default.monitor(33686980);var t=this.app.spreadsheet.getActiveSheetId(),a="/dop-api/querydata?padid="+i.default.window.clientVars.globalPadId+"&type=sheet&subid="+t;a+="&xsrf="+(0,h.getXsrf)(),(0,r.default)({method:"get",url:a,responseType:"json"}).catch(function(e){u.dialog.info("\u7cfb\u7edf\u6d88\u606f","\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u5237\u65b0\u91cd\u8bd5\u3002\uff08\u9519\u8bef\u7801\uff1aC0001\uff09"),d.default.run(c.CONFIG.FETCH_DATA_ERROR,[t,e])}).then(function(a){var n=a.data;n&&0===n.retcode?n.isOverConNum||0==(2&i.default.window.clientVars.rightFlag)?e.refreshSheet(n.atext.text,t):((0,f.showNoLongerFullMemberTip)(),(0,l.hideToast)(),i.default.window.clearInterval(e.timer)):(d.default.run(c.CONFIG.FETCH_DATA_ERROR_2,[t,n&&n.retcode],n,n.retcode),u.dialog.info("\u7cfb\u7edf\u6d88\u606f","\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u7a0d\u540e\u5237\u65b0\u91cd\u8bd5\u3002\uff08\u9519\u8bef\u7801\uff1aC0002\uff09"))})}},{key:"refreshSheet",value:function(e,t){var a=this.app.spreadsheet.getSheetBySheetId(t);a&&(d.default.run(c.CONFIG.K2S_CONVERTER,[t]),this.app.getCurrentMainThreadWorker().sheetData.transformSpreadsheetBySheetId({sheetId:a.getSheetId(),text:e,waitForFormulaLayerToBeInitialized:!1}),(0,s.default)(a,e,{afterKeyframeRun:function(e){i.default.event.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:a.getSheetId(),data:e.data,sType:e.sType})}}),this.app.view.refreshExcelView())}}]),e}();t.default=v},143:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(154)),o=l(a(83)),i=l(a(14)),r=l(a(41));t.getQueryObject=u,t.getQuery=d,t.replaceQuery=c,t.addQuery=function(e,t){return c(e,(0,i.default)(d(e),t))},t.removeQuery=function(e,t){var a=u(e);return delete a[t],c(e,a)};var s=a(203);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return(e.split("?")[1]||"").split("&").filter(function(e){return e}).map(function(e){return e.split("=").map(decodeURIComponent)}).reduce(function(e,t){var a=(0,r.default)(t,2),n=a[0],s=a[1];return(0,i.default)(e,(0,o.default)({},n,e[n]?[s].concat(e[n]):s))},(0,n.default)(null))}function d(e){var t=window.location.search.match(new RegExp("(\\?|&)"+e+"=([^&]*)(&|$)"));return t?decodeURIComponent(t[2]):""}function c(e,t){return e.replace(/(\?.*)?$/,"?"+(0,s.objectMap)(t,function(e,t){return[t,e].map(encodeURIComponent).join("=")}).join("&"))}},1430:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportFreezeApplyStatus=t.generateFreezeBtnText=t.generateFreezeRequestOption=t.caclFrozenRowColmn=void 0,t.cancelFreezePreview=u,t.firstRowFreezePreview=function(e){i.default.Api.freezePreview({row:1})},t.firstColumnFreezePreview=function(e){i.default.Api.freezePreview({column:1})},t.freezePreview=function(e){if(s(e).isError)return u(e);var t=l(e);i.default.Api.freezePreview(t)},t.doFreeze=function(e,t){var a={};switch(t){case"firstRow":a={row:1,column:0};break;case"firstColumn":a={column:1,row:0};break;case"currentCell":a=l(e);break;case"cancelFreeze":a={row:-1,column:-1}}i.default.Api.cacelFrozenPreviewState(),i.default.Api.freeze(a)};var n=a(206),o=r(a(81)),i=r(a(307));function r(e){return e&&e.__esModule?e:{default:e}}var s=t.caclFrozenRowColmn=function(e){var t=e.spreadsheet.activeSheet,a=t.getFrozenRowCount(),n=t.getFrozenColCount(),o=e.view.canvas.excel.selectData.select,i=o.selectRow,r=o.selectCol,s=o.xRange,l=o.yRange,u=-1,d=-1,c=!0,h=!0,f=l[0],p=s[0],v=l[1]-l[0],_=s[1]-s[0],E=!1;if(0===v&&0===_)E=!0;else{var T=t.getCellDataAtPosition(f,p);if(T&&T.getMergeReference()){var m=T.getMergeReference();m&&m.endRowIndex===l[1]&&m.endColIndex===s[1]&&(E=!0)}}E?(u=l[0]-1<0?l[1]:l[0]-1,d=s[0]-1<0?s[1]:s[0]-1):i&&!r?(u=l[1],n&&0===a?d=n-1:h=!1):!i&&r?(d=s[1],a&&0===n?u=a-1:c=!1):(u=l[1],d=s[1]);var g,S,R=void 0,A=void 0,w=0,I=0,C=!1;for(g=(R=e.view.canvas.excel).bodyWidth,S=R.bodyHeight,A=0;A<=d;A++)(w+=R.tableData.col.getWidth(A))>g&&(C=!0);for(A=0;A<=u;A++)(I+=R.tableData.row.getHeight(A))>S&&(C=!0);return{isError:C,row:u,column:d,isForzenRow:c,isForzenColumn:h}},l=t.generateFreezeRequestOption=function(e){var t=s(e),a=t.row,n=t.column,o=t.isForzenRow;return{column:t.isForzenColumn?n+1:0,row:o?a+1:0}};t.generateFreezeBtnText=function(e){var t=s(e),a=t.isError,o=t.row,i=t.column,r=t.isForzenRow,l=t.isForzenColumn;if(a)return"\u51bb\u7ed3\u7a97\u683c";var u=(-1==o?0:o)+1,d=(0,n.toColumnName)(-1==i?1:i+1);return"\u51bb\u7ed3\u81f3\u7b2c"+(r?u+"\u884c":"")+(l?d+"\u5217":"")};function u(e){i.default.Api.cancelFreezePreview()}t.reportFreezeApplyStatus=function(e,t){var a=t.row,n=t.column;if(a&&a>0&&0===n)o.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row_freeze"});else if(n&&n>0&&0===a)o.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"col_freeze"});else if(n&&n>0&&a&&a>0){var i=e.spreadsheet.activeSheet,r=i.getFrozenRowCount(),s=i.getFrozenColCount();0!==r&&0!==s?o.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"re-row+col_freeze"}):0!==r&&0!==s||o.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_freeze",action:"row+col_freeze"})}}},1431:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(114)),o=r(a(47));t.doSort=function(e,t){return s(this,void 0,void 0,n.default.mark(function a(){var o,r,s,l,u,d,c,h;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:o=e.view,r=i.default.Range.GridRange,s=[],l=e.view.canvas.excel.selectData,u=l.active.xIndex,d=e.spreadsheet.getActiveSheetId(),c=e.spreadsheet.activeSheet,h=new r(d,l.select.yRange[0],l.select.yRange[1],l.select.xRange[0],l.select.xRange[1]),o.canvas.plugins.cardCenter.hideAll(),a.t0=t,a.next="ascbyrange"===a.t0?12:"desbyrange"===a.t0?14:"definerange"===a.t0?16:22;break;case 12:return s.push({type:1,column:u}),a.abrupt("break",22);case 14:return s.push({type:0,column:u}),a.abrupt("break",22);case 16:return s.push({type:1,column:u}),a.next=19,e.feature.getSort();case 19:return a.sent.customSortClk(c,s,h),a.abrupt("return");case 22:return a.next=24,e.feature.getSort();case 24:a.sent.sortBtnClk(c,s,h);case 26:case"end":return a.stop()}},a,this)}))};var i=r(a(89));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,a,n){return new(a||(a=o.default))(function(o,i){function r(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(r,s)}l((n=n.apply(e,t||[])).next())})}},1433:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=s(a(1434)),r=s(a(1436));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){(0,n.default)(this,e),this.network=new i.default,this.permission=new r.default,this.init()}return(0,o.default)(e,[{key:"init",value:function(){}}]),e}();t.default=l},1434:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(3)),o=l(a(0)),i=l(a(1)),r=l(a(4)),s=l(a(5));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(){return(0,o.default)(this,t),(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,"network"))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"init",value:function(){this.status="online"}},{key:"isOnline",value:function(){return"online"==this.status}}]),t}(l(a(1435)).default);t.default=u},1435:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(0)),o=r(a(1)),i=r(a(40));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,n.default)(this,e),this.type=t,this.callbacks=[],this.init()}return(0,o.default)(e,[{key:"bindEvent",value:function(){var e=this;i.default.sheetStatus.listen("change",function(t,a){e.type===t&&e.set(a)})}},{key:"getStatus",value:function(){return this.status}},{key:"set",value:function(e){this.status=e,this.callbacks.forEach(function(t){t(e)})}},{key:"listen",value:function(e){this.callbacks.push(e)}}]),e}();t.default=s},1436:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(){(0,n.default)(this,e),this.gCopyable=!1,this.gEditable=!1,this.isPreview=!1,this.editCbs=[],this.copyCbs=[],this.init()}return(0,o.default)(e,[{key:"init",value:function(){if(window.clientVars){var e=window.clientVars;this.gEditable=(!e.isOverConNum||e.isCreator)&&0!=(2&e.rightFlag)&&!e.isFormPreview,this.gCopyable=!!this.gEditable||!(e.advPolicy&&1===e.advPolicy.view_forbid_copy_print),this.isPreview=e.preview}}},{key:"listenEditChange",value:function(e){this.editCbs.push(e)}},{key:"setgEditable",value:function(e){this.gEditable!==e&&(this.gEditable=e,this.editCbs.forEach(function(t){t(e)}))}},{key:"listenCopyChange",value:function(e){this.copyCbs.push(e)}},{key:"setgCopyable",value:function(e){this.gCopyable!==e&&(this.gCopyable=e,this.copyCbs.forEach(function(t){t(e)}))}}]),e}();t.default=r},1437:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=m(a(0)),o=m(a(1)),i=m(a(100)),r=m(a(230)),s=m(a(40)),l=m(a(7)),u=m(a(274)),d=m(a(1438)),c=a(1441),h=a(79),f=m(a(712)),p=m(a(385)),v=m(a(12)),_=m(a(8)),E=a(26),T=m(a(416));function m(e){return e&&e.__esModule?e:{default:e}}var g=!1,S=function(){function e(t){(0,n.default)(this,e),this.parent=t,this.spreadsheetId=l.default.window.clientVars.globalPadId}return(0,o.default)(e,[{key:"initPreview",value:function(){this.previewMainThreadWorker=new f.default("previewWorker"),this.calcController=new T.default(this.parent,{isPreview:!0,previewMainThreadWorker:this.previewMainThreadWorker});var e=this.parent.handleData.getHeader(),t=e[0].id,a=e,n=this.parent.spreadsheet.spreadsheetId;this.previewsheet=new r.default({parent:this.parent,spreadsheetId:this.parent.spreadsheet.spreadsheetId,isReadonly:!0,activeSheetId:e[0].id,mainThreadWorker:this.previewMainThreadWorker}),this.previewMainThreadWorker.sheetData.initSpreadsheetApp({activeSheetData:"",activeSheetId:t,header:a,spreadsheetId:n,title:"",waitForFormulaLayerToBeInitialized:!1}),this.previewsheet.setType(p.default.PREVIEW),this.view||(this.view=new d.default(this.parent));var o=this.parent.view;o&&o.canvas&&o.canvas.excel&&o.canvas.excel.clearTable(),this.parent.view=this.view,this.parent.inactiveView=o,this.lastPermission=this.parent.sheetStatus.permission.gEditable}},{key:"disablePreview",value:function(){var e=this;this.previewMainThreadWorker&&this.previewMainThreadWorker.terminateWorker(),delete this.previewMainThreadWorker,this.parent.spreadsheet.setType(p.default.NORMAL),this.parent.view.canvas.excel&&this.parent.view.canvas.excel.clearTable(),this.parent.inactiveView&&(this.parent.view=this.parent.inactiveView,this.parent.inactiveView=null),v.default.wait(100).run(function(){e.parent.sheetStatus.permission.setgEditable(e.lastPermission),e.parent.view.refreshExcelView(),e.parent.view.sheetsBar&&e.parent.view.sheetsBar.refreshUI(),e.parent.view.resizeExcelView()})}},{key:"setRevertMode",value:function(e,t,a){if(e){if(this.isActive||("function"===typeof a&&a(),this.initPreview()),this.isActive=!0,this.parent.view.canvas.excel&&this.parent&&this.parent.view&&this.parent.view.canvas&&this.parent.view.canvas.excel.resize(),t){var n=t.header,o=n&&n[0].d.slice();if(!o)return;this.clearAndReInitSheets(o);var i=this.parent.preview.previewsheet.getActiveSheetId();this.switchSheet(i)}}else this.disablePreview(),this.isActive=!1,"function"===typeof a&&a()}},{key:"setPreviewMode",value:function(e,t,a){if(!g)if(e){if(this.isActive||("function"===typeof a&&a(),this.initPreview()),this.isActive=!0,this.recordInfo=null,this.parent.view.canvas.excel&&this.parent&&this.parent.view&&this.parent.view.canvas&&this.parent.view.canvas.excel.resize(),t&&0===t.retcode){g=!0;var n=t.version,o=(t.padID,t.fRev),i=t.header,r=t.isRevertVersion,s=t.revertAuthor;this.recordInfo={ver:n,fRev:o,isRevertVersion:r,revertAuthor:s};var l=i[0].d.slice();this.clearAndReInitSheets(l);var u=l[0].id;this.switchSheet(u)}}else this.disablePreview(),this.isActive=!1,"function"===typeof a&&a()}},{key:"clearAndReInitSheets",value:function(e){var t=this;this.previewMainThreadWorker.sheetData.clearAndReInitSheets({sheetList:e}),this.previewsheet.clearSheets(),e.forEach(function(e,a){var n=e.id,o=e.name,i=e.hidden,r=t.previewsheet.createSheet(n,o);r.setParent(t.previewsheet),r.isReadonly=!0,r.hide(i),t.previewsheet.insertSheet(r,a)})}},{key:"switchSheet",value:function(e){var t=l.default.window.showOfflineData;this.previewsheet.setActiveSheetId(e);this.previewsheet.getSheetBySheetId(e);if(_.default.run(E.CONFIG.SWITCH_SHEET_IN_PREVIEW,[e,!!t]),t)l.default.window.clientVars.padId;else this.previewServerSheetData(e)}},{key:"previewServerSheetData",value:function(e,t){var a=this,n=this.previewsheet.getSheetBySheetId(e);if(n){if(n.isLoaded)return void this.onResponse();var o={sheetId:e,padId:this.spreadsheetId};this.recordInfo&&(o.ver=this.recordInfo.ver,o.fRev=this.recordInfo.fRev),_.default.run(E.CONFIG.PREVIEW_SERVER_SHEET_DATA,[o]),this.fetch(o).then(function(e){if(200===e.status){var i=e.data;if(i&&0===i.retcode){_.default.run(E.CONFIG.PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE,[o]);var r=i.data.initialAttributedText.text,s=i.data.actionlist;a.onRecordResponse(n,r,s),"function"===typeof t&&t()}}})}}},{key:"onRevertResponse",value:function(e,t){this.previewMainThreadWorker.sheetData.initSheet({sheetData:t,sheetId:e.getSheetId(),sheetTitle:e.getTitle()}),e&&(e.isLoaded=!1,this.onResponse(function(){(0,u.default)(e,t,{afterKeyframeRun:function(t){s.default.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:e.getSheetId(),data:t.data,sType:t.sType})}}),e.isLoaded=!0}))}},{key:"onRecordResponse",value:function(e,t,a){var n=this,o=e.getSheetId();this.previewMainThreadWorker.sheetData.initSheet({sheetData:t,sheetId:e.getSheetId(),sheetTitle:e.getTitle()}),e&&(e.isLoaded=!1,this.onResponse(function(){(0,u.default)(e,t,{afterKeyframeRun:function(t){s.default.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:e.getSheetId(),data:t.data,sType:t.sType})},afterConvert:function(){if(a&&a.length)for(var t=0;t<a.length;t++){var i=(0,c.recordCallback)(e,a[t]).map(function(e){return(0,h.serializeMutation)(e)});n.previewMainThreadWorker.mutationData.syncHistoryMutations({sheetId:o,serializedMutations:i})}else n.recordInfo&&n.recordInfo.isRevertVersion&&(0,c.revertCallback)(e,{author:n.recordInfo.revertAuthor})}}),e.isLoaded=!0}))}},{key:"onResponse",value:function(e){var t=this;(_.default.jank.log({moduleValue:"keyframeMutation",actionValue:"switchRecordSheet"}),l.default.window.previewLoading=!0,"function"===typeof e&&e(),this.parent.view.canvas.excel&&this.parent.view.canvas.excel.clearTable(),this.parent.view.refreshExcelView(),this.parent.view.sheetsBar)?(this.parent.view.sheetsBar.spreadsheet=this.previewsheet,this.parent.view.sheetsBar.refreshUI(),s.default.sheetsBar.trigger("switchSheetEnd")):s.default.sheetsBar.listen("loadEnd",function(){t.parent.view.sheetsBar.spreadsheet=t.previewsheet,s.default.sheetsBar.trigger("switchSheetEnd")});l.default.window.previewLoading=!1,g=!1}},{key:"getPreviewUrl",value:function(e){var t="",a="";return void 0!=e.fRev&&parseInt(e.fRev)>=0&&(t="&fRev="+e.fRev),void 0!=e.ver&&(a="&rev="+e.ver),"/dop-api/get/sheet?padId="+e.padId+a+t+"&_r="+parseInt(String(1e4*Math.random()))+"&subId="+e.sheetId+"&xsrf="+l.default.getXsrf()}},{key:"fetch",value:function(e){return(0,i.default)({method:"get",url:this.getPreviewUrl(e),responseType:"json"})}}]),e}();t.default=S},1438:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(3)),o=c(a(0)),i=c(a(1)),r=c(a(4)),s=c(a(5)),l=c(a(674)),u=c(a(1439)),d=c(a(40));function c(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.parent=e,a.init(),a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"updateSheetsbar",value:function(){this.sheetsBar.refreshUI()}},{key:"refreshExcelView",value:function(){this.canvas.initData("#canvasContainerPreview")}},{key:"initAfterCanvasLoaded",value:function(){this.initSheetsbar()}},{key:"init",value:function(){this.initCanvas()}},{key:"initSheetsbar",value:function(){var e=this;a.e("bundle_sheetsbar").then(a.t.bind(null,779,7)).then(function(t){e.sheetsBar=new t.default(e.parent.preview.previewsheet,e.parent),d.default.sheetsBar.trigger("loadEnd")})}},{key:"initCanvas",value:function(){var e=this;this.canvas=new u.default({spreadsheetApp:this.parent,callback:function(){e.initAfterCanvasLoaded()}})}}]),t}(l.default);t.default=h},1441:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(a(9)),o=g(a(14));t.recordCallback=function(e,t){var a=t.author,f=JSON.parse(t.action),p=[];f.forEach(function(e){"ms"!==e.type&&"ct"!==e.type&&"revert"!==e.type&&p.push((0,i.getCollabMutations)(e))});var v={},_=function(t,a,n){var i=(0,d.transparentColor)(n,.8),h=void 0;switch(t.operationType=r.default.HISTORY,t.run(e,{isLocal:!0,ignoreCheck:-1===s.NOT_IGNORE_CHECK_MUTATIONS.indexOf(t.id)}),t.id){case l.default.INSERT_DIMENSION_MUTATION:t.type===T.default.COLUMNS?h=new c.default(e.getSheetId(),0,e.getRowCount()-1,t.index,t.index+t.amount-1):t.type===T.default.ROWS&&(h=new c.default(e.getSheetId(),t.index,t.index+t.amount-1,0,e.getColCount()-1)),S(e,{gridRange:h,isBackground:!0,author:a,color:n});break;case l.default.SET_DIMENSION_PROPERTIES_MUTATION:var f=t.ranges[0];f&&(t.type===T.default.COLUMNS?h=new c.default(e.getSheetId(),0,e.getRowCount()-1,f.startIndex,f.endIndex):t.type===T.default.ROWS&&(h=new c.default(e.getSheetId(),f.startIndex,f.endIndex,0,e.getColCount()-1)),S(e,{gridRange:h,isBackground:!0,author:a,color:n}));break;case l.default.SET_CELL_PROPERTIES_MUTATION:case l.default.SET_RANGE_MUTATION:case l.default.DEFINE_FILTER_MUTATION:S(e,{gridRange:t.gridRange,isBackground:!0,author:a,color:n});break;case l.default.REORDER_RANGE_MUTATION:S(e,{gridRange:t.range,isBackground:!0,author:a,color:n});break;case l.default.MERGE_CELLS_MUTATION:case l.default.UNMERGE_CELLS_MUTATION:h=new c.default(e.getSheetId(),t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex),S(e,{gridRange:h,isBackground:!0,author:a,color:n});break;case l.default.ADD_EMBEDDED_OBJECT_MUTATION:case l.default.UPDATE_EMBEDDED_OBJECT_MUTATION:var p=t.data.id,_=new u.default({data:(0,o.default)({},t.data,{previewInsertInfo:{recordAuthor:a,borderColor:"1px solid "+i}})});v[p]||(v[p]=_);break;case l.default.DELETE_EMBEDDED_OBJECT_MUTATION:var E=t.key;v[E]&&delete v[E];break;default:t.getAffectedGridRanges().forEach(function(t){return S(e,{gridRange:t,isBackground:!0,author:a,color:n})})}},E=[];p&&a&&h.default.window.CoreSheet.historylist.getColorFromId(a)&&function(){for(var t=h.default.window.CoreSheet.historylist.getColorFromId(a),o=0,i=p.length;o<i;o++){var r=p[o];r.forEach(function(e){_(e,a,t),E.push(e)})}m.default.wait(100).run(function(){(0,n.default)(v).forEach(function(t){var a=v[t];a.run(e,{isLocal:!1})})})}();return E},t.revertCallback=function(e,t){var a=e.getGridRangeHasData();if(a.isValid()){var n=t.author,o=h.default.window.CoreSheet.historylist.getColorFromId(n);S(e,{gridRange:a,isBackground:!0,author:n,color:o})}};var i=a(188),r=g(a(138)),s=a(17),l=g(s),u=g(a(280)),d=a(155),c=g(a(11)),h=g(a(7)),f=g(a(43)),p=g(a(39)),v=g(a(29)),_=g(a(18)),E=g(a(32)),T=g(a(15)),m=g(a(12));function g(e){return e&&e.__esModule?e:{default:e}}function S(e,t){var a=t.gridRange,n=t.color,o=t.isBackground,i=t.author,r=(0,d.transparentColor)(n,.2);if(a){var s=new p.default;o&&s.setSlot(E.default.BACKGROUND_COLOR,r);var l=new v.default;l.setSlot(_.default.SLOT_EFFIECTIVE_FORMAT_DELTA,s),l.setSlot(_.default.SLOT_AUTHOR,i),new f.default({gridRange:a,cellDataDelta:l}).run(e,{isLocal:!1})}}},1442:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MainThreadController=void 0;var n=c(a(3)),o=c(a(0)),i=c(a(4)),r=c(a(5)),s=c(a(713)),l=c(a(714)),u=c(a(8)),d=a(26);function c(e){return e&&e.__esModule?e:{default:e}}var h=window,f=h.__globalWorkerFilePath,p="?";h.location.href.indexOf("showLog=1")>=0&&(p+="showLog=1"),h.location.href.indexOf("showFormulaLog=1")>=0&&(p+="&showFormulaLog=1"),(t.MainThreadController=function(e){function t(e){(0,o.default)(this,t);var a=(0,i.default)(this,(t.__proto__||(0,n.default)(t)).call(this));a.isSupportWorker=t.isSupportWorker;try{a.isSupportWorker&&(a.timeBeforeNewWorker=Date.now(),console.log("\u5f53\u524d\u7248\u672c","release-20190829-26118152"),a.worker=new h.Worker(""+f+p,{name:e}),a.worker.onerror=function(e){},a.timeAfterNewWorker=Date.now(),a.channel=new l.default(a.worker,a))}catch(r){console.error("worker error:",r),a.isSupportWorker=!1,u.default.run(d.CONFIG.CREATE_WORKER_ERROR,r)}return a}return(0,r.default)(t,e),t}(s.default)).isSupportWorker=!!h.Worker},1444:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerAbilityTest=void 0;var n=r(a(0)),o=r(a(1)),i=a(97);function r(e){return e&&e.__esModule?e:{default:e}}t.WorkerAbilityTest=function(){function e(t){(0,n.default)(this,e),this.mainThreadController=t,this.addActionListener()}return(0,o.default)(e,[{key:"addActionListener",value:function(){}},{key:"runTest",value:function(){var e=Date.now();return this.mainThreadController.requestPromise(i.WorkerAbilityTestActionTypes.MessageTest,e)}},{key:"heartBeatTest",value:function(e){return this.mainThreadController.requestPromise(i.WorkerAbilityTestActionTypes.HeartBeatTest,e)}}]),e}()},1445:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Report=void 0;var n=u(a(24)),o=u(a(0)),i=u(a(1)),r=a(97),s=u(a(8)),l=u(a(7));function u(e){return e&&e.__esModule?e:{default:e}}t.Report=function(){function e(t){(0,o.default)(this,e),this.mainThreadController=t,this.addActionListener()}return(0,i.default)(e,[{key:"addActionListener",value:function(){this.mainThreadController.listen(r.ReportActionTypes.MonitorReport,this.monitor.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.TdwReport,this.tdw.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.HuatuoReport,this.huatuo.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.TdwSingleReport,this.tdwSingleReport.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.DebuggerAlert,this.debuggerAlert.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.RunReport,this.run.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.SpeedMarkReport,this.speedMark.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.FlowLogReport,this.flowLog.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.SpeedRunReport,this.speedRunReport.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.SpeedhasInitReport,this.speedhasInitReport.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.SpeedRun,this.speedRun.bind(this)),this.mainThreadController.listen(r.ReportActionTypes.WebLog,this.weblog.bind(this))}},{key:"monitor",value:function(e){s.default.monitor(e)}},{key:"tdw",value:function(e){s.default.tdwReport(e)}},{key:"huatuo",value:function(e){s.default.huatuo(e,!0)}},{key:"tdwSingleReport",value:function(e){var t=e.data,a=e.disableParam;s.default.tdwSingleReport(t,a)}},{key:"run",value:function(e){var t=e.args;s.default.run.apply(s.default,(0,n.default)(t))}},{key:"speedMark",value:function(e){var t,a=e.args;(t=s.default.speed).mark.apply(t,(0,n.default)(a))}},{key:"speedRunReport",value:function(e){var t,a=e.args;(t=s.default.speed).runReport.apply(t,(0,n.default)(a))}},{key:"speedhasInitReport",value:function(e){var t,a=e.args;(t=s.default.speed).hasInitReport.apply(t,(0,n.default)(a))}},{key:"speedRun",value:function(e){var t,a=e.args;(t=s.default.speed).run.apply(t,(0,n.default)(a))}},{key:"flowLog",value:function(e){var t=e.args;s.default.flowLog.apply(s.default,(0,n.default)(t))}},{key:"debuggerAlert",value:function(e){alert(e)}},{key:"weblog",value:function(e){var t,a=e.level,o=e.args;l.default.window.log&&l.default.window.log[a]&&(t=l.default.window.log)[a].apply(t,(0,n.default)(o))}}]),e}()},1446:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Raven=void 0;var n=l(a(14)),o=l(a(0)),i=l(a(1)),r=a(97),s=a(673);function l(e){return e&&e.__esModule?e:{default:e}}t.Raven=function(){function e(t){(0,o.default)(this,e),this.mainThreadController=t,this.addActionListener()}return(0,i.default)(e,[{key:"addActionListener",value:function(){this.mainThreadController.listen(r.RavenActionTypes.CaptureException,this.captureException.bind(this)),this.mainThreadController.listen(r.RavenActionTypes.CaptureWorkerPromiseException,this.captureWorkerPromiseException.bind(this))}},{key:"captureException",value:function(e){var t=e.errorString,a=e.params;s.Raven&&s.Raven.captureException("from-worker: "+t,a)}},{key:"captureWorkerPromiseException",value:function(e){var t=e.message,a=e.stack;try{var o=(0,n.default)(new Error,{message:t,stack:a});s.Raven&&s.Raven.captureException(o)}catch(i){console.error(i)}}}]),e}()},1447:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cookie=void 0;var n=s(a(0)),o=s(a(1)),i=a(97),r=s(a(7));function s(e){return e&&e.__esModule?e:{default:e}}t.Cookie=function(){function e(t){(0,n.default)(this,e),this.mainThreadController=t,this.addActionListener()}return(0,o.default)(e,[{key:"addActionListener",value:function(){this.mainThreadController.listen(i.CookieActionTypes.Xsrf,this.getXsrf.bind(this))}},{key:"getXsrf",value:function(){return r.default.getXsrf()}}]),e}()},1448:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SheetData=void 0;var n=h(a(114)),o=h(a(14)),i=h(a(0)),r=h(a(1)),s=h(a(47)),l=h(a(100)),u=h(a(7)),d=a(97),c=h(a(12));function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e,t,a,n){return new(a||(a=s.default))(function(o,i){function r(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(r,s)}l((n=n.apply(e,t||[])).next())})};t.SheetData=function(){function e(t){(0,i.default)(this,e),this.isSheetDataReady=!1,this.mainThreadController=t,this.mainThreadController.listen(d.SheetDataActionTypes.FetchSheetOnMainThread,this.fetchSheet.bind(this))}return(0,r.default)(e,[{key:"checkSheetFormulaLayerStatusBetweenThreads",value:function(){var e=u.default.window.SpreadsheetApp.calcController.sheetFormulaLayerStatusMap.getCurrentStatusMap();return this.mainThreadController.requestPromise(d.SheetDataActionTypes.CheckSheetFormulaLayerStatusBetweenThreads,{currentStatusMap:e})}},{key:"getRangeDataFromMainThread",value:function(e){return mainThreadController.requestPromise(d.SheetDataActionTypes.GetRangeDataFromMainThread,e)}},{key:"informNetworkChange",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.InformNetworkChange,e)}},{key:"initSpreadsheetApp",value:function(e){var t=this,a={padId:window.clientVars.padId};return this.mainThreadController.requestPromise(d.SheetDataActionTypes.InitSpreadsheetApp,(0,o.default)(e,{clientVars:a})).then(function(e){return t.isSheetDataReady=!0,t.initSheetDataTime=Date.now(),e})}},{key:"initSheet",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.InitSheet,e)}},{key:"loadSheet",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.LoadSheet,e)}},{key:"resetSheetOnWorkerFormula",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.resetSheetOnWorkerFormula,e)}},{key:"syncVisibleAreaToWorker",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.syncVisibleAreaToWorker,e)}},{key:"triggerAutoUpdateFormulaUpdate",value:function(){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.TriggerAutoUpdateFormulaUpdate,{})}},{key:"waitForWorkerSpreadsheetReady",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{timeOut:6e4};return this.isSheetDataReady?s.default.resolve(!0):this.mainThreadController.requestPromise(d.SheetDataActionTypes.waittingForWorkerSpreadsheetReady,e,e.timeOut)}},{key:"updateSpreadsheet",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.UpdateSpreadsheet,e)}},{key:"clearAndReInitSheets",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.ClearAndReInitSheets,e)}},{key:"clearAndReInitOneSheet",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.ClearAndReInitOneSheet,e)}},{key:"transformSpreadsheetBySheetId",value:function(e){return this.mainThreadController.requestPromise(d.SheetDataActionTypes.TransformSpreadsheetBySheetId,e)}},{key:"fetchSheet",value:function(e){var t=this;return new s.default(function(a,o){var i=u.default.getXsrf();t.fetch(e.sheetId,e.spreadsheetId,i,function(e){return f(t,void 0,void 0,n.default.mark(function t(){return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:a(e);case 1:case"end":return t.stop()}},t,this)}))})})}},{key:"fetch",value:function(e,t,a,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return f(this,void 0,void 0,n.default.mark(function r(){var s,u,d,h,f=this;return n.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=3,u=2e3,d="/dop-api/get/sheet?padId="+t+"&subId="+e+"&xsrf="+a+"&_r="+Math.random(),n.next=5,(0,l.default)({method:"get",url:d,responseType:"json"}).catch(function(n){i>=s?o("fail"):c.default.wait(u).run(function(){f.fetch(e,t,a,o,++i)})});case 5:if(h=n.sent,"fail"!==this.checkRespose(h)){n.next=15;break}if(!(i>=s)){n.next=12;break}return o("fail"),n.abrupt("return");case 12:return++i,c.default.wait(u).run(function(){f.fetch(e,t,a,o,i)}),n.abrupt("return");case 15:o&&o(h.data.data.initialAttributedText.text);case 16:case"end":return n.stop()}},r,this)}))}},{key:"checkRespose",value:function(e){return e.status&&200===e.status&&e.data&&0===e.data.retcode?"succ":"fail"}}]),e}()},1449:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MutationData=void 0;var n=h(a(16)),o=h(a(0)),i=h(a(1)),r=h(a(7)),s=a(97),l=a(137),u=h(a(1450)),d=a(79),c=h(a(8));function h(e){return e&&e.__esModule?e:{default:e}}var f=!1;window,t.MutationData=function(){function e(t){(0,o.default)(this,e),this.mainThreadController=t,this.mutationQueue=new u.default,this.mainThreadController.listen(s.MutationActionTypes.SyncNonPersistentMutationsToMainThread,this.syncNonPersistentMutationsToMainThread.bind(this)),this.mutationHandleStartTimeMap={}}return(0,i.default)(e,[{key:"syncActiveSheetMutations",value:function(e){var t=e.sheetId,a=e.mutations,n=this.mutationQueue.push(t,a),o={sheetId:t,serializedMutations:a.map(function(e){return(0,d.serializeMutation)(e)}),mutationQueueId:n};return this.mutationHandleStartTimeMap[n]=Date.now(),this.mainThreadController.requestPromise(s.MutationActionTypes.SyncActiveSheetMutations,o)}},{key:"syncHistoryMutations",value:function(e){return this.mainThreadController.request(s.MutationActionTypes.SyncHistoryMutations,e)}},{key:"syncNonPersistentMutationsToMainThread",value:function(e){var t=e.serializedMutations,a=e.isFromFormula,o=e.latestMutationQueueIdInWorker,i=e.mutationQueueIdRelatedSheetId,s=e.isFinalMutationToCurrentMutationQueueFromFormula,u=e.muationQueueRunnedIndex,d=r.default.window.SpreadsheetApp,h=t.reduce(function(e,t){var a=(0,l.createMutationFromSerialize)(t);return a&&e.push(a),e},[]);if(this.mutationQueue.transform(i,o,h,u).forEach(function(e){d.behavior.applyMutation(e,{isLocal:!0,isFromFormula:a})}),this.mutationQueue.complete(i,o),s){var p=r.default.window.SpreadsheetApp;if(p.calcController.sheetFormulaLayerStatusMap.isSheetCalculating(i)&&p.calcController.sheetFormulaLayerStatusMap.setIntializedDone(i),("undefined"===typeof this.mutationQueue.queue[i]||this.mutationQueue.queue[i].length<2)&&(h.length>0||-1===o)&&!f){var v=p.calcController.formulaGraph.getUnfinishedCalculationNodesBySheetId(i);v.length>0&&(f=!0,c.default.tdwReport&&c.default.tdwReport({opername:"doc_excel",module:"formula_worker",action:"worker_has_unfinished_calculation_nodes",ver5:(0,n.default)({nodes:v,type:s?0:1})}),c.default.monitor(33969186))}}return!0}}]),e}()},1450:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),o=l(a(1)),i=a(193),r=l(a(7)),s=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}var u=!1,d=-1,c=!1,h=function(){function e(){(0,n.default)(this,e),this.uniqueId=0,this.queue={}}return(0,o.default)(e,[{key:"push",value:function(e,t){this.queue[e]||(this.queue[e]=[]);var a=this.uniqueId;(this.uniqueId++,this.queue[e].push({mutations:t,id:a,isComplete:!1,startTime:Date.now()}),this.queue[e].length>200&&d<6)&&(this.queue[e].splice(0,200-this.queue[e].length),s.default.monitor(33906029),d++,c||(r.default.window.SpreadsheetApp.getCurrentMainThreadWorker().sheetData.checkSheetFormulaLayerStatusBetweenThreads().then(function(e){e||s.default.monitor(34277139)}),c=!0),u||r.default.window.SpreadsheetApp.calcController.getUnfinishedCalculationNodesBySheetId(e).length>0&&(s.default.monitor(33969186),u=!0));return a}},{key:"transform",value:function(e,t,a){var n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1;if(!this.queue[e])return-1!==t&&console.error("SheetId "+e+" can not found in MutationQueue"),a;var o,r=void 0,s=[],l=[a],u=!1;for(-1===t&&(u=!0),r=0,o=this.queue[e].length;r<o;r++)u?s.push(this.queue[e][r].mutations):this.queue[e][r].id===t&&(n>=0&&n<=this.queue[e][r].mutations.length-2&&s.push(this.queue[e][r].mutations.slice(n+1)),u=!0);return u?(0,i.followRequestMutations)(s,l,!0)[0]:a}},{key:"complete",value:function(e,t){if(-1!==t){if(!this.queue[e])throw new Error("SheetId "+e+" can not found in MutationQueue");var a,n=void 0;for(n=0,a=this.queue[e].length;n<a;n++)if(this.queue[e][n].id===t){if(!this.queue[e][n].isComplete)this.queue[e][n].isComplete=!0,Date.now()-this.queue[e][n].startTime>3e4&&s.default.monitor(33906250);break}this.queue[e].splice(0,n)}}}]),e}();t.default=h},1451:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SheetList=void 0;var n=r(a(0)),o=r(a(1)),i=a(97);function r(e){return e&&e.__esModule?e:{default:e}}t.SheetList=function(){function e(t){(0,n.default)(this,e),this.mainThreadController=t}return(0,o.default)(e,[{key:"headerUpdateSync",value:function(e){return this.mainThreadController.requestPromise(i.SheetListActionTypes.HeaderUpdateSync,e)}},{key:"copySheetData",value:function(e){return this.mainThreadController.requestPromise(i.SheetListActionTypes.CopySheetData,e)}}]),e}()},1452:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Snapshot=void 0;var n=r(a(0)),o=r(a(1)),i=a(97);function r(e){return e&&e.__esModule?e:{default:e}}t.Snapshot=function(){function e(t){(0,n.default)(this,e),this.mainThreadController=t}return(0,o.default)(e,[{key:"saveQuicklookSnapshot",value:function(e,t,a){this.mainThreadController.requestPromise(i.SnapShootTypes.SaveSnapshotLocal,{imageData:e,cutAreaInfo:t,sheetInfo:a})}},{key:"uploadSnapshotThumb",value:function(e,t,a){console.log("imageDataSize:",e.data.length),this.mainThreadController.requestPromise(i.SnapShootTypes.UploadSnaphotThumb,{imageData:e,cutAreaInfo:t,sheetInfo:a})}}]),e}()},1591:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=y(a(114)),o=y(a(9)),i=y(a(31)),r=y(a(0)),s=y(a(1)),l=y(a(47)),u=y(a(100)),d=y(a(274)),c=y(a(1592)),h=y(a(230)),f=a(44),p=a(40),v=y(p),_=y(a(436)),E=a(97),T=a(437),m=a(137),g=y(a(710)),S=y(a(7)),R=y(a(12)),A=y(a(1593)),w=a(437),I=y(a(451)),C=y(a(416));function y(e){return e&&e.__esModule?e:{default:e}}var O=function(e,t,a,n){return new(a||(a=l.default))(function(o,i){function r(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(r,s)}l((n=n.apply(e,t||[])).next())})},D=new(function(){function e(){(0,r.default)(this,e),this.isSheetDataReady=!1,this.mutationCache={},this.localMutationCache={},this.addListenActions(),this.loadSheetPromiseMap={}}return(0,s.default)(e,[{key:"destroy",value:function(){this.isSheetDataReady&&((0,p.removeAllEvent)(),this.calcController.destroy(),delete this.dataValidation,delete this.calcController,delete this.spreadsheet,delete this.spreadsheetApp,this.isSheetDataReady=!1)}},{key:"addListenActions",value:function(){_.default.listen(E.SheetDataActionTypes.InitSpreadsheetApp,this.initSpreadsheetApp.bind(this)),_.default.listen(E.SheetDataActionTypes.InitSheet,this.initSheet.bind(this)),_.default.listen(E.SheetDataActionTypes.LoadSheet,this.loadSheet.bind(this)),_.default.listen(E.SheetDataActionTypes.UpdateSpreadsheet,this.updateSpreadsheet.bind(this)),_.default.listen(E.SheetDataActionTypes.waittingForWorkerSpreadsheetReady,this.waittingForWorkerSpreadsheetReady.bind(this)),_.default.listen(E.SheetDataActionTypes.syncVisibleAreaToWorker,this.syncVisibleAreaToWorker.bind(this)),_.default.listen(E.SheetDataActionTypes.resetSheetOnWorkerFormula,this.resetSheetOnWorkerFormula.bind(this)),_.default.listen(E.SheetDataActionTypes.ClearAndReInitSheets,this.clearAndReInitSheets.bind(this)),_.default.listen(E.SheetDataActionTypes.ClearAndReInitOneSheet,this.clearAndReInitOneSheet.bind(this)),_.default.listen(E.SheetDataActionTypes.TransformSpreadsheetBySheetId,this.transformSpreadsheetBySheetId.bind(this)),_.default.listen(E.SheetDataActionTypes.TriggerAutoUpdateFormulaUpdate,this.triggerAutoUpdateFormulaUpdate.bind(this)),_.default.listen(E.SheetDataActionTypes.InformNetworkChange,this.informNetworkChange.bind(this)),_.default.listen(E.SheetDataActionTypes.CheckSheetFormulaLayerStatusBetweenThreads,this.checkSheetFormulaLayerStatusBetweenThreads.bind(this))}},{key:"checkSheetFormulaLayerStatusBetweenThreads",value:function(e){var t=e.currentStatusMap,a=this.calcController.sheetFormulaLayerStatusMap.getCurrentStatusMap(),n=!0,r=!0,s=!1,l=void 0;try{for(var u,d=(0,i.default)((0,o.default)(t));!(r=(u=d.next()).done);r=!0){var c=u.value;if(t[c]!==a[c]){n=!1;break}}}catch(h){s=!0,l=h}finally{try{!r&&d.return&&d.return()}finally{if(s)throw l}}return n}},{key:"updateDependentNodesOnMainThread",value:function(e){var t=e.dataMap,a=e.dependentRows,n=e.dependentCols,r=[],s=!0,l=!1,u=void 0;try{for(var d,c=(0,i.default)((0,o.default)(t));!(s=(d=c.next()).done);s=!0){var h=d.value,f=t[h],p=this.spreadsheet.getSheetBySheetId(h);if(p&&p.isLoaded){var v=!0,m=!1,g=void 0;try{for(var S,R=(0,i.default)((0,o.default)(f));!(v=(S=R.next()).done);v=!0){var A=S.value,w=parseInt(A),I=f[w],C=!0,y=!1,O=void 0;try{for(var D,N=(0,i.default)((0,o.default)(I));!(C=(D=N.next()).done);C=!0){var M=D.value,k=parseInt(M),b=p.getCellDataAtPosition(w,k);r.push((0,T.getCrossWorkerCellDataForFormulaFromCellData)(b,w,k,h))}}catch(P){y=!0,O=P}finally{try{!C&&N.return&&N.return()}finally{if(y)throw O}}}}catch(P){m=!0,g=P}finally{try{!v&&R.return&&R.return()}finally{if(m)throw g}}}else console.error("\u8868\u683c "+h+" \u5c1a\u672a\u5728 worker \u4e2d\u52a0\u8f7d\u3002")}}catch(P){l=!0,u=P}finally{try{!s&&c.return&&c.return()}finally{if(l)throw u}}return _.default.requestPromise(E.SheetDataActionTypes.UpdateDependentNodesOnMainThread,{datas:r,dependentRows:a,dependentCols:n})}},{key:"loadSheet",value:function(e){var t=this,a=e.sheetId,o=e.waitForFormulaLayerToBeInitialized,i=(e.isFirstLoadInMainThread,this.spreadsheet.getSheetBySheetId(a));if(!i)return l.default.resolve(!1);if(i.isFetching=!0,i&&i.isLoaded)return i.isFetching=!1,O(t,void 0,void 0,n.default.mark(function e(){var t,i;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.calcController.sheetFormulaLayerStatusMap,i=o?t.getInitialPromise(a):t.getWaitingPromise(a),!(0,f.isPromise)(i)){e.next=5;break}return e.next=5,i;case 5:return e.abrupt("return",l.default.resolve(!0));case 6:case"end":return e.stop()}},e,this)}));if(this.loadSheetPromiseMap[a])return this.loadSheetPromiseMap[a];var r=new l.default(function(e,r){return O(t,void 0,void 0,n.default.mark(function t(){var r,s,l,u,d=this;return n.default.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(r=function(t){return O(d,void 0,void 0,n.default.mark(function r(){var s,l,u=this;return n.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:if("fail"===t){n.next=16;break}if(this.transformSpreadsheet(i,t),i.isLoaded=!0,i.isFetching=!1,this.mutationCache[a]&&this.mutationCache[a].forEach(function(e){u.spreadsheetApp.behavior.apply({type:"collab",sheetId:a,requestId:-1,opt:{str:e}})}),delete this.mutationCache[a],this.localMutationCache[a]&&this.localMutationCache[a].forEach(function(e){var t=(0,m.createMutationFromSerialize)(e);if(!t)return!1;try{t.run(i,{isLocal:!0})}catch(a){}}),delete this.localMutationCache[a],s=this.calcController.sheetFormulaLayerStatusMap,l=o?s.getInitialPromise(a):s.getWaitingPromise(a),!(0,f.isPromise)(l)){n.next=13;break}return n.next=13,l;case 13:e(!0),n.next=20;break;case 16:i.isReadonly=!0,i.isFetching=!1,delete this.loadSheetPromiseMap[a],e(!1);case 20:case"end":return n.stop()}},r,this)}))},s=this.spreadsheet.spreadsheetId,!(0,w.isIE)()){t.next=9;break}return t.next=5,this.fetchSheet({sheetId:a,spreadsheetId:s});case 5:"string"!==typeof(l=t.sent)?(delete this.loadSheetPromiseMap[a],e(!1)):r(l),t.next=13;break;case 9:return t.next=11,A.default.getXsrf();case 11:u=t.sent,this.fetch(a,s,u,r);case 13:case"end":return t.stop()}},t,this)}))});return this.loadSheetPromiseMap[a]=r,r}},{key:"informNetworkChange",value:function(e){S.default.event.default.trigger(e.type,void 0)}},{key:"syncVisibleAreaToWorker",value:function(e){var t=e.visibleArea;if(!this.isSheetDataReady)return!1;this.calcController.visibleArea=t}},{key:"triggerAutoUpdateFormulaUpdate",value:function(){if(!this.isSheetDataReady)return!1;this.calcController.triggerAutoUpdateFormulaUpdate()}},{key:"updateSpreadsheet",value:function(e){var t=this;if(!this.spreadsheet)return!1;var a=e.sheetsList;return this.spreadsheet.clearSheets(),a.forEach(function(e,a){var n=e.id,o=e.name,i=t.spreadsheet.createSheet(n,o);t.spreadsheet.insertSheet(i,a)}),!0}},{key:"waittingForWorkerSpreadsheetReady",value:function(e){var t=this;return new l.default(function(a,n){t.isSheetDataReady&&a(!0);var o=setInterval(function(){t.isSheetDataReady&&a(!0)},50),i=R.default.wait(e.timeOut).run(function(){clearInterval(o),R.default.erase(i),a(t.isSheetDataReady)})})}},{key:"fetchSheet",value:function(e){return _.default.requestPromise(E.SheetDataActionTypes.FetchSheetOnMainThread,e)}},{key:"fetch",value:function(e,t,a,o){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0;return O(this,void 0,void 0,n.default.mark(function r(){var s,l,d,c,h=this;return n.default.wrap(function(n){for(;;)switch(n.prev=n.next){case 0:return s=3,l=2e3,d="/dop-api/get/sheet?padId="+t+"&subId="+e+"&xsrf="+a+"&_r="+Math.random(),n.next=5,(0,u.default)({method:"get",url:d,responseType:"json"}).catch(function(n){i>=s?o("fail"):R.default.wait(l).run(function(){h.fetch(e,t,a,o,++i)})});case 5:if(c=n.sent,"fail"!==this.checkRespose(c)){n.next=15;break}if(!(i>=s)){n.next=12;break}return o("fail"),n.abrupt("return");case 12:return++i,R.default.wait(l).run(function(){h.fetch(e,t,a,o,i)}),n.abrupt("return");case 15:o(c.data.data.initialAttributedText.text);case 16:case"end":return n.stop()}},r,this)}))}},{key:"checkRespose",value:function(e){return e.status&&200===e.status&&e.data&&0===e.data.retcode?"succ":"fail"}},{key:"initSpreadsheetApp",value:function(e){var t=e.activeSheetData,a=e.activeSheetId,n=e.header,o=e.spreadsheetId,i=e.title,r=e.clientVars;return window.clientVars=r,this.spreadsheetApp=new c.default({activeSheetData:t,activeSheetId:a,header:n,spreadsheetId:o,title:i}),this.spreadsheet=this.initSpreadsheet({spreadsheetId:o,activeSheetId:a,sheetsList:n}),this.spreadsheetApp.spreadsheet=this.spreadsheet,this.spreadsheetApp.sheetControl=new I.default(this.spreadsheetApp),this.calcController=new C.default(this.spreadsheetApp),this.spreadsheetApp.calcController=this.calcController,this.dataValidation=new g.default(this.spreadsheetApp),this.spreadsheetApp.plugins={dataValidation:this.dataValidation},"undefined"!==typeof t&&this.initSheet({sheetId:a,sheetData:t,sheetTitle:i}),this.isSheetDataReady=!0,!0}},{key:"initSpreadsheet",value:function(e){var t=new h.default({parent:this.spreadsheetApp,spreadsheetId:e.spreadsheetId,activeSheetId:e.activeSheetId});return e.sheetsList.forEach(function(e,a){var n=e.id,o=e.name,i=t.createSheet(n,o);t.insertSheet(i,a)}),t}},{key:"initSheet",value:function(e){var t=e.sheetId,a=this.spreadsheet.getSheetBySheetId(t);if(a)return this.transformSpreadsheet(a,e.sheetData),a.isLoaded=!0,a.isFetching=!1,"initSheet Success"}},{key:"clearAndReInitSheets",value:function(e){var t=this;if(!this.isSheetDataReady)return!1;this.spreadsheet.clearSheets(),this.spreadsheet.getSheets().forEach(function(e){t.calcController.resetSheet(e.getSheetId())}),e.sheetList.forEach(function(e,a){var n=e.id,o=e.name,i=t.spreadsheet.createSheet(n,o);i.setParent(t.spreadsheet),t.spreadsheet.insertSheet(i,a)})}},{key:"clearAndReInitOneSheet",value:function(e){if(!this.isSheetDataReady)return!1;var t=e.sheetId;delete this.loadSheetPromiseMap[t],this.spreadsheet.reInitSheetBySheetId(t)}},{key:"resetSheetOnWorkerFormula",value:function(e){var t=e.sheetId;this.calcController.resetSheet(t)}},{key:"transformSpreadsheetBySheetId",value:function(e){if(!this.isSheetDataReady)return!1;var t=e.sheetId,a=e.text,n=this.spreadsheet.getSheetBySheetId(t);return n?(n.isLoaded=!0,this.transformSpreadsheet(n,a),e.waitForFormulaLayerToBeInitialized?this.calcController.sheetFormulaLayerStatusMap.getInitialPromise(t):void 0):void 0}},{key:"transformSpreadsheet",value:function(e,t){var a=e.getSheetId();return this.calcController.resetSheet(a),(0,d.default)(e,t,{afterKeyframeRun:function(e){v.default.spreadsheetEvent.trigger("afterKeyframeRun",{sheetId:a,data:e.data,sType:e.sType})}})}},{key:"setMutationCache",value:function(e,t){this.mutationCache[e]?this.mutationCache[e].push(t):(this.mutationCache[e]=[],this.mutationCache[e].push(t))}},{key:"setLocalMutationCache",value:function(e,t){this.localMutationCache[e]?this.localMutationCache[e].push(t):(this.localMutationCache[e]=[],this.localMutationCache[e].push(t))}}]),e}());self.sheetData=D,t.default=D},1592:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(3)),o=c(a(0)),i=c(a(1)),r=c(a(4)),s=c(a(5)),l=c(a(500)),u=c(a(410)),d=c(a(415));function c(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.init(e),a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"init",value:function(e){this.behavior=new u.default(this),new d.default(this)}}]),t}(l.default);t.default=h},1593:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=s(a(436)),r=a(97);function s(e){return e&&e.__esModule?e:{default:e}}var l=new(function(){function e(){(0,n.default)(this,e),this.addActionListener()}return(0,o.default)(e,[{key:"addActionListener",value:function(){}},{key:"getXsrf",value:function(){return i.default.requestPromise(r.CookieActionTypes.Xsrf,"")}}]),e}());t.default=l},1603:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(a(0)),o=_(a(1)),i=_(a(7)),r=_(a(1604)),s=_(a(1607)),l=_(a(1615)),u=a(90),d=a(22),c=a(71),h=_(a(8)),f=a(26),p=a(395),v=a(165);function _(e){return e&&e.__esModule?e:{default:e}}var E=i.default.window,T=function(){function e(t,a){if((0,n.default)(this,e),this.onceOpened=!1,this.hadShowOfflineTip=!1,this.app=t,this.messageHandler=a&&a.messageHandler||null,i.default.window.WebSocket&&i.default.window.WebSocket.prototype&&i.default.window.WebSocket.prototype.send)"complete"===document.readyState||"loading"!==document.readyState&&!document.documentElement.doScroll?this.loopProbe():document.addEventListener("DOMContentLoaded",this.loopProbe.bind(this));else{var o=d.isIOS?3078272:d.isAndroid?3078271:3078270;h.default.monitor(o)}}return(0,o.default)(e,[{key:"loopProbe",value:function(){var e=this;i.default.window.clientVars.isOverConNum&&!i.default.window.clientVars.isCreator||i.default.window.clientVars.isSnapshot||i.default.window.clientVars.preview||i.default.window.clientVars.isFormPreview||(this.init(),setTimeout(function(){e.client&&"SHUTDOWN"===e.client.getRoomState()||e.client&&e.onceOpened||(h.default.run(f.CONFIG.NETWORK_ERROR),e.client?e.client.shutDown(u.errCodeType.SOCKET_NOT_SET_UP):e.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.SOCKET_NOT_SET_UP}))},9e4))}},{key:"init",value:function(){var e=this;this.client=new r.default(i.default.window.clientVars.collab_client_vars,i.default.window.clientVars.userId,"excel"),this.client.onReceivMessageFromServer=this.handleMessageFromServer.bind(this),this.client.onRoomStateChange=this.handleRoomStateChange.bind(this),this.client.onNetReconnectedFail=this.handleNetReconnectedFail.bind(this),this.client.getHeaderGeneralPacket=this.getHeaderGeneralPacket.bind(this),this.client.onShutDown=this.handleShutDown.bind(this),this.client.onOpen=this.handleSocketOpen.bind(this),this.client.getPadRev=this.getPadRev.bind(this),this.client.open(),$(E).bind("unload",function(){e.client.shutDown("unload")})}},{key:"paddingNumber",value:function(e,t){return(Array(t).join("0")+e).slice(-t)}},{key:"getTimeStr",value:function(){var e=new Date;return e.getFullYear()+this.paddingNumber(e.getMonth()+1,2)+this.paddingNumber(e.getDate(),2)}},{key:"getHeaderGeneralPacket",value:function(){var e={};return i.default.window.__globalReleaseVersion&&(e.rel_rev=i.default.window.__globalReleaseVersion),e}},{key:"getPadRev",value:function(){return this.app.messageCenter.commitingQueue.isEmpty?this.app.messageCenter.currentVersion:this.app.messageCenter.commitingQueue.baseVersion}},{key:"handleSocketOpen",value:function(){this.onceOpened=!0}},{key:"handleMessageFromServer",value:function(e,t){if("CODEREV_NEW"!==e&&"LAST_REVERSION"!==e&&"RIGHT_MESSAGE"!==e&&"REVERT_MESSAGE"!==e||h.default.run(f.CONFIG.ACCEPT_MESSAGE,[e,t]),"NEW_CHANGES"===e)this.messageHandler&&this.messageHandler.handleNewChanges(t);else if("USER_NEWINFO"===e)this.handleUserNewInfo(t);else if("USER_LEAVE"===e)this.handleUserLeave(t);else if("CURSOR_MESSAGE"===e)this.handleCursorMessage(t);else if("RIGHT_MESSAGE"===e)this.handleRightMessage(t);else if("TITLE_MESSAGE"===e)this.handleTitleMessage(t);else if("HANDLE_DELETE"===e)this.handleDeletePad(t);else if("COMM_NOTICE"===e)this.handleCommonNotice(t);else if("CODEREV_NEW"===e)this.handleCodeRevNew(t);else if("LAST_REVERSION"===e){var a=t.body.notice.lastRev;this.messageHandler&&this.messageHandler.handleLastRervesion(a)}else if("REVERT_MESSAGE"===e)this.messageHandler&&this.app.revertSpreadSheet();else if("READY_ERROR"===e){40029===t.body.data.reason&&this.handleShutDown("40029")}}},{key:"handleUserNewInfo",value:function(e){i.default.event.network.trigger("userNewInfo",e.body&&e.body.notice)}},{key:"handleUserLeave",value:function(e){i.default.event.network.trigger("userLeave",e.body&&e.body.notice)}},{key:"handleCursorMessage",value:function(e){i.default.event.network.trigger("cursor",e.body&&e.body.notice)}},{key:"handleRightMessage",value:function(e){s.default.notifyRightChange(this.app,e&&e.body&&e.body.notice),s.default.comparePrivilege(this.app)}},{key:"handleTitleMessage",value:function(e){e&&e.body&&e.body.notice&&e.body.notice.title&&this.app.spreadsheet.setTitle(e.body.notice.title,!0)}},{key:"handleDeletePad",value:function(e){i.default.event.network.trigger("deletePad")}},{key:"handleCommonNotice",value:function(e){if(e&&e.body&&e.body.notice){var t=e.body.notice,a=e.body.notice.type;"push_message"===a?this.handlePushMessage(t):"RELOAD"===a?this.handleReloadMessage(t):"DOCCOMMENT_TYPE"===a||"DISCUSS_TYPE"===a&&this.app.view.discuss.onReceiveMessagePush(t.payload)}}},{key:"handlePushMessage",value:function(e){if(e&&e.message){var t=JSON.parse(e.message),a=t.type;"unbind"===a?l.default.unbindAccount(t):"wl"===a&&i.default.window.log&&i.default.window.log.ws&&i.default.window.log.ws(t),$(E).trigger("notification_message",[e.message])}}},{key:"handleReloadMessage",value:function(e){this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.RELOAD}),this.app.sheetStatus.permission.setgEditable(!1)}},{key:"handleCodeRevNew",value:function(e){if(e&&e.body&&e.body.notice){var t=e.body.notice,a=t.code_ver;0,function(e,t){var a=/^\d+\.\d+/gi,n=e.match(a),o=t.match(a);return!(!n||!o)&&(e=n[0])===(t=o[0])}(t.dver,E._grayVersion)&&a===i.default.window.clientVars.collab_client_vars.pver||(h.default.monitor(33624154),this.client.shutDown(u.errCodeType.KICK),this.app.sheetStatus.permission.setgEditable(!1))}}},{key:"handleRoomStateChange",value:function(e,t){e=e.toUpperCase(),h.default.run(f.CONFIG.ROOM_STATE_CHANGE,[e,t],e),"RECONNECTING_IN_CLOSED"===e?(h.default.monitor(33612136),this.handleOffline(t)):"OPENED"===e&&this.handleOnline(t)}},{key:"handleShutDown",value:function(e){h.default.run(f.CONFIG.HANDLE_SHUTDOWN,e),console.log("%c handleShutDown",e),"unload"!==e&&(h.default.monitor(33612127),-1!==e.indexOf("60000")?(h.default.monitor(33712329),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60000"})):-1!==e.indexOf("60001")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60001"}):-1!==e.indexOf("60002")?(h.default.monitor(33712365),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60002"})):-1!==e.indexOf("code=60003")?(h.default.monitor(33712374),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60003"})):-1!==e.indexOf("60003")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60003"}):-1!==e.indexOf("code=60004")?(h.default.monitor(33712379),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60004"})):-1!==e.indexOf("60004")?(h.default.monitor(33712380),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60004"})):-1!==e.indexOf("60005")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60005"}):-1!==e.indexOf("60006")?(h.default.monitor(33713563),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60006"})):-1!==e.indexOf("code=60007")?(h.default.monitor(33713595),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60007"})):-1!==e.indexOf("60007")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60007"}):-1!==e.indexOf("code=60008")?(h.default.monitor(33713473),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60008"})):-1!==e.indexOf("60008")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60008"}):-1!==e.indexOf("60010")?(h.default.monitor(33686978),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60010"})):-1!==e.indexOf("code=60011")?(h.default.monitor(33712550),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60011"})):-1!==e.indexOf("60011")?(h.default.monitor(33712549),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60011"})):-1!==e.indexOf("code=60013")?(h.default.monitor(33712556),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60013"})):-1!==e.indexOf("60013")?(h.default.monitor(33712557),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60013"})):-1!==e.indexOf("code=60014")?(h.default.monitor(33712559),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60014"})):-1!==e.indexOf("60014")?(h.default.monitor(33712558),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60014"})):-1!==e.indexOf("code=60015")?(h.default.monitor(33712568),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60015"})):-1!==e.indexOf("60015")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60015"}):-1!==e.indexOf("60016")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60016"}):-1!==e.indexOf("code=60017")?(h.default.monitor(33712574),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60017"})):-1!==e.indexOf("60017")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60017"}):-1!==e.indexOf("INACTIVE")?(h.default.monitor(33712576),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"INACTIVE"})):-1!==e.indexOf("60018")?(h.default.monitor(33712583),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60018"})):-1!==e.indexOf("60019")?(h.default.monitor(33712584),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60019"})):-1!==e.indexOf("60020")?(h.default.monitor(33712585),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60020"})):-1!==e.indexOf("code=60021")?(h.default.monitor(33713418),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60021"})):-1!==e.indexOf("60021")?(h.default.monitor(33713444),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60021"})):-1!==e.indexOf("60022")?(h.default.monitor(33713469),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60022"})):-1!==e.indexOf("40000")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40000"}):-1!==e.indexOf("40001")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40001"}):-1!==e.indexOf("40002")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40002"}):-1!==e.indexOf("40003")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40003"}):-1!==e.indexOf("40005")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40005"}):-1!==e.indexOf("40006")?(h.default.monitor(33712775),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40006"})):-1!==e.indexOf("40020")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40020"}):-1!==e.indexOf("40021")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40021"}):-1!==e.indexOf("40022")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40022"}):-1!==e.indexOf("40023")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40023"}):-1!==e.indexOf("40024")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40024"}):-1!==e.indexOf("40025")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40025"}):-1!==e.indexOf("40026")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40026"}):-1!==e.indexOf("40028")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40028"}):-1!==e.indexOf("40029")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40029"}):-1!==e.indexOf("40030")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"40030"}):-1!==e.indexOf("41001")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"41001"}):-1!==e.indexOf("41002")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"41002"}):-1!==e.indexOf("10000")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"10000"}):-1!==e.indexOf("10001")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"10001"}):-1!==e.indexOf("70001")?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:u.errCodeType.NOT_VIP_FULL}):e===u.errCodeType.SOCKET_NOT_SET_UP?this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.SOCKET_NOT_SET_UP}):e===u.errCodeType.PERMISSION_CHANGE?this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.PERMISSION_CHANGE}):e===u.errCodeType.APPLY_NEW_CHANGE_ERROR?this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.APPLY_NEW_CHANGE_ERROR}):e===u.errCodeType.KICK?this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.KICK}):e===u.errCodeType.SHEET_ID_ERROR_1?this.app.event.errorCode.trigger("errorCode",{type:"front",code:u.errCodeType.SHEET_ID_ERROR_1}):this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"UNKNOWN"}),this.app.sheetStatus.permission.setgEditable(!1))}},{key:"handleOffline",value:function(e){this.onceOpened&&(this.hadShowOfflineTip||($(E).trigger("networkOffline"),this.app.sheetStatus.network.set("offline"),d.isIOS&&e&&-1!==e.indexOf("socket io error")||(this.offlineSnackbar=(0,p.showOfflineTip)(this.app.sheetStatus.permission.gEditable&&!this.app.messageOfflineStore.isShield),this.hadShowOfflineTip=!0),this.app.getCurrentMainThreadWorker().sheetData.informNetworkChange({type:"networkOffline"})))}},{key:"handleNetReconnectedFail",value:function(){this.hadShowOfflineTip||d.isIOS&&(this.offlineSnackbar=(0,p.showOfflineTip)(this.app.sheetStatus.permission.gEditable&&!this.app.messageOfflineStore.isShield),this.hadShowOfflineTip=!0)}},{key:"handleOnline",value:function(e){this.app.messageCenter.retryCommit(0),this.app.messageCenter.commitingQueueTimeoutStatus="INIT",this.hideOfflineTips(),$(E).trigger("networkOnline"),this.app.sheetStatus.network.set("online"),(0,v.showSavedText)(),i.default.event.network.trigger("online"),this.hadShowOfflineTip=!1,this.app.getCurrentMainThreadWorker().sheetData.informNetworkChange({type:"networkOnline"})}},{key:"hideOfflineTips",value:function(){(0,c.hideToast)(),this.offlineSnackbar&&this.offlineSnackbar.close&&this.offlineSnackbar.close()}}]),e}();t.default=T},1604:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(16));t.default=function(e,t,a){var s=this;this.emRoomState={INIT:"INIT",CONNECTING:"CONNECTING",OPENED:"OPENED",RECONNECTING_In_CLOSED:"RECONNECTING_In_CLOSED",SHUTDOWN:"SHUTDOWN"},this.emRoomErrCode={suc:0,timeout:101,parameterErr:102,exist:103,roomDisconnect:104,roomClose:105,roomStateErr:106};var l=" collab Room ",u=new i.WebSocketRoomReporter(a),d=new i.MsgSenderReporter(a),c=e.padId,h=e.globalPadId,f=e.pver,p=e.apid;window.md=e.wmode,window.websocketReopenCount=e.websocketReopenCount,window.pollingAttemptNumber=e.pollingAttemptNumber;var v,_,E=e.client&&e.client.upid,T=e.client&&e.client.sid,m=e.client&&e.client.tid,g=e.client&&e.client.sig,S=t,R=0,A=5e3,w=0,I=3,C=0,y=2,O=1500,D=0,N=0,M=0,k=[],b=0,P=0,L=0,F=0,x=[],U=[],V=3e3,H=s.emRoomState.INIT,B=!0,G=0,W=!0,j=!1;function Y(){Se("socket  reopen "),Q(),he(),oe(),s.open()}function z(){return b}function Q(){_&&(_.onmessage=function(){},_.onpostmessage=function(){},_.onSocketClosed=function(){},_.onSocketOpened=function(){},_.onSocketStatusChanged=function(){},_.onlogmessage=function(){},_.onReopenCount=function(){},_.onlogWarn=function(){},_.disconnect()),_=null}function q(e,t,a){Ae("socket notifyRoomClosed, closeReason = "+e+",bShutDown= "+t+", delayOpenTime ="+a+", time:"+new Date),P&&(clearTimeout(P),P=0),B=!0;var n=s.getRoomState();he(),oe(),function(){for(var e=0;e<x.length;e++){var t=x[e];!function(){var e=t,a={errCode:s.emRoomErrCode.roomClose,errMsg:"room close"};e.onsendAccept&&e.waitAcceptCmd?setTimeout(function(){e.onsendAccept(e.seq,e.cmd,e.data,null,a)},10):e.onsend&&setTimeout(function(){e.onsend(e.seq,e.cmd,e.data,a)},10)}();var a={errCode:s.emRoomErrCode.roomClose,errMsg:"room close",event:"netStatusChange",needRetry:!1};d.reportMsg(t,a)}x=[],F&&(clearTimeout(F),F=0)}();var o=!0===t;n!==s.emRoomState.RECONNECTING_In_CLOSED&&(o=!0);var i={closeReason:e,bShutDown:t,bNeedNotify:o,bFirstConnect:W};if(u.reportNetWorkEvent("close",i),W=!1,!0===t)return function(){_=null,b=0,k=[],L&&(clearTimeout(L),L=0);P&&(clearTimeout(P),P=0);oe(),he()}(),de(s.emRoomState.SHUTDOWN,e),void(n!==s.emRoomState.SHUTDOWN&&s.onShutDown(e));de(s.emRoomState.RECONNECTING_In_CLOSED,e),function(e,t){if(L)return;k.push(+new Date),b+=1;var a=t;if(!t){var n=Math.min(3e4,1e3*Math.pow(2,b+1)),o=(i=.4*n,n+Math.floor(Math.random()*(2*i+1)-i));a=o}var i;Se("socket delayReopen delayTime = "+a+", fuzzedRetryDelay  =  "+o),L=setTimeout(function(){L&&(clearTimeout(L),L=0),s.open()},a)}(0,a),n!==s.emRoomState.RECONNECTING_In_CLOSED&&s.onClose(e)}function K(){b=0,k=[],j=!1,B=!1,Se("socket onSocketOpenEvent : "+new Date),P&&(clearTimeout(P),P=0),L&&(clearTimeout(L),L=0),u.reportNetWorkEvent("connect"),he(),oe(),ae()}function Z(e){Ae("socket onSocketClosedEvent : "+new Date),_&&(_.onmessage=function(){},_.onpostmessage=function(){},_.onSocketClosed=function(){},_.onSocketOpened=function(){},_.onSocketStatusChanged=function(){},_.onlogmessage=function(){},_.onReopenCount=function(){},_.onlogWarn=function(){}),_=null,q(e,!1),j&&s.onNetReconnectedFail()}function J(e,t){if(e&&t&&t.event){var a=t.event;if("reconnecting"===a)Se("socket onSocketStatusChanged receive reconnecting time: "+new Date),j=!0,u.reportNetWorkEvent(a);else if("connect_timeout"===a||"connect_error"===a){Se("socket onSocketStatusChanged receive connect_timeout or connect_error time: "+new Date);var n={failReason:t.failReason};u.reportNetWorkEvent("connectfail",n)}else if("disconnect"===a){Se("socket onSocketStatusChanged receive disconnect time: "+new Date),B=!0;var o="close by disconnect ";t.disconnectReason&&(o+=t.disconnectReason),P||(oe(),he(),function(){for(var e=0;e<x.length;)if(("sending"===x[e].state||"waitAccept"===x[e].state)&&x[e].retryCount>=x[e].maxRetryCount){var t=x[e];!function(){var e=t,a={errCode:s.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect"};e.onsendAccept&&e.waitAcceptCmd?setTimeout(function(){e.onsendAccept(e.seq,e.cmd,e.data,null,a)},10):e.onsend&&setTimeout(function(){e.onsend(e.seq,e.cmd,e.data,a)},10)}(),U.push(x[e]),x.splice(e,1);var a={errCode:s.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect",event:"netStatusChange",needRetry:!1};d.reportMsg(t,a)}else{if("sending"===x[e].state||"waitAccept"===x[e].state){var t=x[e];x[e].state="waiting";var a={errCode:s.emRoomErrCode.roomDisconnect,errMsg:"room Disconnect",event:"netStatusChange",needRetry:!0};d.reportMsg(t,a)}e++}}(),P=setTimeout(function(){Se("socket onSocketStatusChanged do disconnect time: "+new Date),Q(),q(o,!1)},15e3)),u.reportNetWorkEvent(a)}}}function X(e){D=setTimeout(function(){ae()},e)}this.onRoomStateChange=function(e,t){},this.onOpen=function(){},this.onClose=function(e){},this.onShutDown=function(e){},this.onReceivMessageFromServer=function(e){},this.onNetReconnectedFail=function(){},this.getPadRev=function(){},this.getHeaderGeneralPacket=function(){},this.getRoomState=function(){return H},this.open=function(){_?Re("socket open setUpSocket socket has exist"):s.getRoomState()!==s.emRoomState.shutDown?(Se("socket open setUpSocket "),v=String(Math.floor(1e12*Math.random())),(_=new o.default(v,c,h,E,g)).onmessage=fe,_.onpostmessage=le,_.onSocketClosed=Z,_.onSocketOpened=K,_.onSocketStatusChanged=J,_.onlogmessage=Se,_.onReopenCount=z,_.onlogWarn=Re,_.connect(),G=(new Date).getTime(),s.getRoomState()===s.emRoomState.INIT?de(s.emRoomState.CONNECTING):de(s.emRoomState.RECONNECTING_In_CLOSED),u.reportNetWorkEvent("setupSocket")):Ae("socket open setUpSocket socket error: the room state is shutdown")},this.closeAndDelayReopen=function(e,t){setTimeout(function(){e||(e="close by client"),Se("closeAndDelayReopen closeReason = "+e+" delayOpenTime = "+t),Q(),q(e,!1,t)},0)},this.shutDown=function(e){setTimeout(function(){Se("shutDown  closeReason ="+e),e||(e="close by client"),Q(),q(e,!0)},0)},$(window).on("online",function(e){Se(" browser online time: "+new Date)}),$(window).on("offline",function(e){Se(" browser offline time: "+new Date)});var ee=0,te=null;function ae(){Se("loginRoom"),M&&(clearTimeout(M),M=0),C+=1,N=s.createMessageSeq();var e={roomType:"padpage",roomName:"padpage/"+h,upid:E,gid:h,sid:T,tid:m,sig:g,data:{stats:ue()}};te=ie("CLIENT_READY",N,(0,n.default)(e)),_.postMessageForWebSocket(te),ee=(new Date).getTime(),M=setTimeout(function(){Se("loginRoom loginTimeout seq = "+N);var e={errCode:s.emRoomErrCode.timeout,errMsg:"timeout error"};ne(N,"CLIENT_READY",e)},3e3),u.reportNetWorkEvent("login")}function ne(e,t,a){M&&(clearTimeout(M),M=0);var n=(new Date).getTime(),o={cmd:"CLIENT_READY",seq:N,postData:te,retryCount:C,lastSendTime:ee,onpostTime:n,firstSendTime:ee},i={errCode:0,event:"onpost",needRetry:!1};if(N=0,0===a.errCode&&a.response&&a.response.onpost&&(0===a.response.onpost.result||60009===a.response.onpost.result))!function(e){de(s.emRoomState.OPENED),oe(),he(),ce(e.heartbeat_interval),x.length&&setTimeout(function(){re()},0);var t={bFirstConnect:W};u.reportNetWorkEvent("open",t),W=!1,setTimeout(function(){s.onOpen()},0)}(a.response.onpost),i.errCode=a.response.onpost.result;else if(0!==a.errCode)Ae("handleLoginResponse onpost fail, retry, client result = "+a.errCode),C>=y?(Ae("handleLoginResponse login fail loginCount = "+C+", errCode ="+a.errCode),oe(),s.closeAndDelayReopen(_e(a.errCode,"login fail")),i.needRetry=!1):(X(O),i.needRetry=!0),i.errCode=a.errCode,i.event="netStatusChange";else{var r=a.response.onpost.result;i.errCode=r,i.event="onpost";var c=O;a.response.onpost.retry_interval&&(c=a.response.onpost.retry_interval),Ae("handleLoginResponse login fail loginCount = "+C+", errCode ="+r),60004===r||60005===r||60011===r||60013===r||60014===r||60021===r||60022===r?C>=y?(oe(),60021===r||60022===r?s.shutDown(_e(r," login fail timeout")):s.closeAndDelayReopen(_e(r," login fail timeout")),i.needRetry=!1):(Ae(l+"handleLoginResponse onpost fail, retry, server result = "+r),X(c),i.needRetry=!0):60001===r||60002===r?(s.closeAndDelayReopen(_e(r,"login fail")),i.needRetry=!1):60003===r||60007===r||60008===r||60010===r||60015===r||6e4===r||60006===r?(s.shutDown(_e(r,"login fail")),i.needRetry=!1):40029===r?(s.shutDown(_e(r,"")),i.needRetry=!1):(s.shutDown(_e(r,"login fail")),i.needRetry=!1)}0!==i.errCode&&(i.errMsg=_e(i.errCode)),d.reportMsg(o,i)}function oe(){C=0,N=0,M&&(clearTimeout(M),M=0),D&&(clearTimeout(D),D=0)}function ie(e,t,a){var o=0;0===S.indexOf("g")&&(o=1);var i=S.replace("p.","").replace("g.",""),l=(0,r.getCookie)("wl"),u={type:e,task_id:t,docid:h,uid:i,cookie:Te(),base_rev:s.getPadRev(),code_ver:f,session_type:o,gray:0,dver:window._grayVersion||"1.0.0",wl:l,generalpacket:s.getHeaderGeneralPacket()};p&&(u.apid=p);var d=(0,n.default)(u)+"\n";return a&&(d+=a),d}function re(){if(!0!==se()){if(!1!==function(){if(x.length<=0)return Se("Can't sendMessage messageQueue.length = 0"),!1;if(s.getRoomState()!==s.emRoomState.OPENED||!1!==B)return Ae("Can't sendMessage the room state not open, state = "+s.getRoomState()+" bWebsocketDisconneted = "+B),!1;for(var e=0;e<x.length;e++)if("sending"===x[e].state)return Se("Can't sendMessage there is a sending message, seq = "+x[e].seq+" cmd="+x[e].cmd),!1;return!0}())for(var e=0;e<x.length;e++)if("waiting"===x[e].state){0!==x[e].retryCount&&x[e].firstSendTime||(x[e].firstSendTime=(new Date).getTime()),x[e].retryCount=x[e].retryCount+1,x[e].lastSendTime=(new Date).getTime(),x[e].onpostTime=0,x[e].state="sending",_.postMessageForWebSocket(x[e].postData),ve();break}}else Y()}function se(){if(s.getRoomState()===s.emRoomState.CONNECTING||s.getRoomState()===s.emRoomState.RECONNECTING_In_CLOSED||s.getRoomState()===s.emRoomState.RECONNECTING_In_CLOSED){var e=(new Date).getTime();if(G&&e>G&&e-G>5e4)return!0}return!1}function le(e){try{var t=e.split("\n");if(t.length<2)return void Ae(" onPostFromServer error\uff1a msg is not right");var a=JSON.parse(t[0]);if("HEART_BEAT"===a.type){var n=JSON.parse(t[1]);return void function(e,t){var a;w=0,t&&t.onpost&&t.onpost.heartbeat_interval&&(a=t.onpost.heartbeat_interval);ce(a)}(0,n)}if("CLIENT_READY"===a.type&&a.task_id===N){var n=JSON.parse(t[1]),o={errCode:s.emRoomErrCode.suc,errMsg:"",response:n};return void ne(a.task_id,a.type,o)}for(var i=!1,r=0;r<x.length;r++)if(x[r].seq===a.task_id&&x[r].cmd===a.type){i=!0,x[r].onpostTime=(new Date).getTime();var u=x[r],n=JSON.parse(t[1]),c=n.onpost.result,h=(n.onpost.retry_times,n.onpost.retry_interval);if(0!==c&&Ae("onPostFromServer end to parse  errcode = "+n.onpost.result),!x[r].waitAcceptCmd||0!==c){var f="suc";0!==c&&(f=_e(c));var p={errCode:c,errMsg:f,event:"onpost",response:n,needRetry:!1};d.reportMsg(u,p)}if(6e4===c||60006===c)return void s.shutDown(_e(c));if(60001===c)return void s.closeAndDelayReopen(_e(c),h);var o={errCode:s.emRoomErrCode.suc,errMsg:"",response:n};u.onsend&&function(){var e=o,t=u;setTimeout(function(){t.onsend(t.seq,t.cmd,t.data,e)},10)}(),x[r].waitAcceptCmd&&0===c?x[r].state="waitAccept":(U.push(x[r]),x.splice(r,1)),x.length&&setTimeout(function(){re()},10);break}var v=!1;if(!1===i)for(var r=0;r<U.length;r++)if(U[r].seq===a.task_id&&U[r].cmd===a.type){v=!0;break}!1===v&&!1===i&&Re("the onPostFromServer not found\uff1a seq="+a.task_id+" cmd = "+a.type),U.length>50&&U.splice(0,U.length-50)}catch(_){Ae(l+"onPostFromServer error parse msg exception = "+_)}}function ue(){var t={};return t.screen=[$(window).width(),$(window).height(),window.screen.availWidth,window.screen.availHeight,window.screen.width,window.screen.height].join(","),t.ip=e.clientIp,t.useragent=e.clientAgent,t}function de(e,t){var a="Channel state being set to "+e,n=H;e!=n&&(H=e,setTimeout(function(){s.onRoomStateChange(H,t)},0),u.reportRoomState(H),Se(a))}function ce(e){if(e&&(A=e),!R){var t=function(){for(var e=0,t=0;t<x.length;t++)"sending"===x[t].state&&(e=x[t].postData.length,x[t].lastSendTime);if(e>2097152){var a=me(e)/2;return a>A?a:A}return A}();R=setTimeout(function(){!function(){R&&(clearTimeout(R),R=0);if(s.getRoomState()!==s.emRoomState.OPENED||!_)return void Ae("sendBeatHeartOnTimer the room state not open state =  "+s.getRoomState());w>0&&Re("sendBeatHeartOnTimer fail count over 1, the fail beatHeartCount = "+w);if(w>=I)return Ae("sendBeatHeartOnTimer  reach to max BeatHeartCount closeAndDelayReopen"),void s.closeAndDelayReopen("close by beatHeart fail");w+=1;var e=s.createMessageSeq(),t=S.replace("p.","").replace("g.",""),a={type:"HEART_BEAT",task_id:e,docid:h,uid:t},o=(0,n.default)(a)+"\n";_.postMessageForWebSocket(o),ce()}()},t)}}function he(){R&&(clearTimeout(R),R=0),w=0,A=5e3}function fe(e){try{var t=e.split("\r\n");if("[object Array]"!==Object.prototype.toString.call(t))return void Ae("===== onGetMessageFromServer  parse msg error\uff0c is not Array =====");for(var a=0;a<t.length;a++){var n=t[a].split("\n");if(n.length<2)return void Ae(l+"onGetMessageFromServer error\uff1a msg is not right");var o,i=JSON.parse(n[0]);if(n[1]&&(o=JSON.parse(n[1])),"QUIT_NOTICE"!==i.type||"INACTIVE"!==o.notice.quit_type)if(x.length<=0){for(var r=!1,s=0;s<U.length;s++)if(U[s].seq===i.task_id){r=!0;break}!1===r&&pe(i,o)}else{for(var u=!1,s=0;s<x.length;s++){if(i.task_id===x[s].seq){var c=x[s];if(u=!0,x[s].waitAcceptCmd&&x[s].waitAcceptCmd.indexOf(i.type)>=0){var h=i.type,f={errCode:0,errMsg:"",response:{new_rev:i.new_rev,body:o}};c.onsendAccept&&function(){var e=c,t=h,a=f;setTimeout(function(){e.onsendAccept(e.seq,e.cmd,e.data,t,a)},10)}(),U.push(x[s]),x.splice(s,1);var p={waitAcceptCmd:h,event:"onsendAccept",response:o,needRetry:!1};d.reportMsg(c,p);break}Ae("===== onGetMessageFromServer the msg found in messageQueue, but waitcmd not equal (error) ===== the seq = "+i.task_id+" the msg cmd ="+x[s].cmd+" the server wait cmd ="+i.type);break}pe(i,o)}var r=!1;if(!1===u)for(var s=0;s<U.length;s++)if(U[s].seq===i.task_id&&U[s].waitAcceptCmd&&U[s].waitAcceptCmd.indexOf(i.type)>=0){r=!0;break}!1===u&&!1===r&&pe(i,o)}else Ee()}}catch(v){Ae("onGetMessageFromServer error parse msg exception = "+v)}}function pe(e,t){var a={new_rev:e.new_rev,body:t};setTimeout(function(){s.onReceivMessageFromServer(e.type,a)},10)}function ve(){F||(F=setTimeout(function(){!function(){F&&(clearTimeout(F),F=0);for(var e=!1,t=!1,a=!1,n=0;n<x.length;){var o=(new Date).getTime();if(("sending"===x[n].state||"waitAccept"===x[n].state)&&o>x[n].lastSendTime&&o-x[n].lastSendTime>x[n].timeout){e=!0;var i=!1,r=x[n];x[n].retryCount<x[n].maxRetryCount?(Ae("handleMessageTimer the msg timeout error, try again, the seq = "+x[n].seq+" the msg cmd ="+x[n].cmd+" messageQueue[i].retryCount = "+x[n].retryCount+" maxRetryCount = "+x[n].maxRetryCount+" state = "+x[n].state),x[n].state="waiting",i=!0,n++):(Ae("handleMessageTimer the msg timeout error, the seq = "+x[n].seq+" the msg cmd ="+x[n].cmd),i=!1,function(){var e={errCode:s.emRoomErrCode.timeout,errMsg:"timeout error"},t=r;t.onsend&&setTimeout(function(){t.onsend(t.seq,t.cmd,t.data,e)},10),t.onsendAccept&&t.waitAcceptCmd&&setTimeout(function(){t.onsendAccept(t.seq,t.cmd,t.data,null,e)},10)}(),U.push(x[n]),x.splice(n,1));var l={errCode:s.emRoomErrCode.timeout,errMsg:"timeout error",event:"netStatusChange",needRetry:i};d.reportMsg(r,l)}else"sending"===x[n].state&&(t=!0),"waiting"===x[n].state&&(a=!0),n++}U.length>50&&U.splice(0,U.length-50);!1===t&&!0===a&&(e=!0);x.length&&!0===e&&setTimeout(function(){re()},10);x.length&&ve()}()},1e3))}function _e(e,t){var a=" errMsg, code "+e;switch(e){case 6e4:a="Server Internal Error code "+e;break;case 60001:a="Connection Not Exist code "+e;break;case 60006:a="TX-LOGIN-PSKEY-EXPIRED code "+e;break;case 60003:case 60004:case 60005:case 60011:case 60013:a="TimeOut code "+e;break;case 60007:case 60015:a="UnAuth code "+e;break;case 60008:a="BigData code "+e;break;case 60010:a="MemberFull code "+e;break;case 60014:a="Frequently code "+e;break;case 60021:a="TX-LOGIN-PSKEY-EXPIRED TIMEOUT "+e;break;case 60022:a="UnAuth TIMEOUT code "+e;break;case 40029:a="JS Code Expired "+e}return t&&(a=t+" "+a),a}function Ee(){if(!(x.length>0)){s.shutDown("close by server INACTIVE")}}function Te(){var e="";return(0,r.getCookie)("p_luin")&&(e=e+"p_luin="+(0,r.getCookie)("p_luin")+";"),(0,r.getCookie)("p_lskey")&&(e=e+"p_lskey="+(0,r.getCookie)("p_lskey")+";"),(0,r.getCookie)("p_skey")&&(e=e+"p_skey="+(0,r.getCookie)("p_skey")+";"),(0,r.getCookie)("p_uin")&&(e=e+"p_uin="+(0,r.getCookie)("p_uin")+";"),(0,r.getCookie)("uid")&&(e=e+"uid="+(0,r.getCookie)("uid")+";"),(0,r.getCookie)("uid_key")&&(e=e+"uid_key="+(0,r.getCookie)("uid_key")+";"),(0,r.getCookie)("ww_utoken")&&(e=e+"ww_utoken="+(0,r.getCookie)("ww_utoken")+";"),e}function me(e){return!e||e<5120?V:e<1048576?1e4:e<2097152?1e4:e<4194304?15e3:e<6291456?2e4:25e3}function ge(){return b<5}function Se(e){ge()&&window.log&&window.log.info&&window.log.info(l+e)}function Re(e){ge()&&window.log&&window.log.warn&&window.log.warn(l+e)}function Ae(e){ge&&window.log&&window.log.error&&window.log.error(l+e)}this.sendMessage=function(e,t,a,n,o){return s.sendMessageWaitAcceptCmd(e,t,a,n,o)},this.sendMessageWaitAcceptCmd=function(e,t,a,n,o,i){if(i&&(!n||!n.waitAcceptCmd||"[object Array]"!==Object.prototype.toString.call(n.waitAcceptCmd))){Ae("checkParameter waitAcceptCmd invalid");var r={errCode:s.emRoomErrCode.parameterErr,errMsg:"msg custom_param invalid",cmd:e,seq:t};return r}if(s.getRoomState()!==s.emRoomState.OPENED){Re(" send message before the room open, state ="+s.getRoomState()+", seq = "+t+", cmd="+e),!0===se()&&(Re("trySendPendingMessage can not send msg, socket needReopen"),Y());var r={errCode:s.emRoomErrCode.roomStateErr,errMsg:"room state can not send msg",cmd:e,seq:t};return r}return function(e,t,a,n,o,i){var r=t;if(r)for(var l=0;l<x.length;l++)if(x[l].cmd===e&&x[l].messageSeq===t){var u={errCode:s.emRoomErrCode.exist,errMsg:"the msg has exist",cmd:e,seq:r};return Re("sendMessageWaitAcceptCmd the message has exist seq = "+r+" cmd="+e),u}r||(r=s.createMessageSeq());var d=ie(e,r,a),c=me(d.length);n&&n.timeout&&(n.maxRetryCount>3e4&&(n.maxRetryCount=3e4),c=n.timeout>c?n.timeout:c);var h,f=1;n&&n.maxRetryCount&&(n.maxRetryCount>5&&(n.maxRetryCount=5),f=n.maxRetryCount);n&&n.waitAcceptCmd&&(h=n.waitAcceptCmd);var p={cmd:e,seq:r,data:a,postData:d,timeout:c,maxRetryCount:f,waitAcceptCmd:h,onsend:o,onsendAccept:i,retryCount:0,lastSendTime:0,onpostTime:0,firstSendTime:0,state:"waiting"};return x.push(p),setTimeout(function(){re()},10),ve(),u={errCode:0,errMsg:"",cmd:e,seq:r}}(e,t,a,n,o,i)},this.createMessageSeq=function(){var e=(new Date).getTime(),t=Math.ceil(2147483648*Math.random(e));return t},this.cancelMessageBySeq=function(e){for(var t=0;t<x.length;t++)if(x[t].seq===e){Se("cancelMessageBySeq seq = "+e);var a=x[t].state;U.push(x[t]),x.splice(t,1),x.length&&"sending"===a&&setTimeout(function(){re()},10);break}}};var o=s(a(1605)),i=a(1606),r=(s(a(7)),a(124));function s(e){return e&&e.__esModule?e:{default:e}}},1605:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(16));t.default=function(e,t,a,r,l){var u=this;this.name="socketing",this.reconnectMaxTimes=3,this.connectTimeout=5e3,this.reconnectionDelay=3e3,this.reconnectionDelayMax=5e3,this.randomizationFactor=1;var d=null,c=null,h=!1;this.onSocketOpened=function(){},this.onSocketClosed=function(){},this.onmessage=function(){},this.onpostmessage=function(){},this.onlogmessage=function(){},this.onSocketStatusChanged=function(){},this.onReopenCount=function(){},this.onlogWarn=function(){};var f={},p=function(){};function v(e,t,a,n){function o(e,t){e[t]&&(e[t](),e[t]=p)}var i=setTimeout(function(){o(e,t),n()},a),r=function(){clearTimeout(i)};return o(e,t),e[t]=r,r}function _(e){var t,a,n,o;if(window.location.search&&window.location.search.length>=1&&(o=window.location.search.substring(1)),o)for(t=o.split("&"),a=0;a<t.length;a++)if((n=t[a].split("="))[0]===e)return n[1];return null}function E(e){e||(e="Closed by socket internal. forceClosed "),T(e),!1===h&&(u.onSocketClosed(e),h=!0)}function T(t){m("doDisconnect id = "+e+"reason: "+t+",hasWebSocketClosed: "+h),d&&(t&&(c=t),d.disconnect(),d=null)}function m(e){u.onlogmessage("(comet @t: "+Math.floor((new Date).valueOf()/100)%1e7+") "+e)}this.connect=function(){v(f,"connect",3e4,function(){E("Timeout connecting to server:")}),function(){var e=_("uid"),p=_("uid_key"),T="wss://"+window.location.host,g={w:["websocket"],l:["polling"],b:["polling","websocket"]},S=window.md||"ww",R=g[S.charAt(0)]||g.w,A=g[S.charAt(1)]||g.b,w=void 0===window.websocketReopenCount?2:window.websocketReopenCount,I=void 0===window.pollingAttemptNumber?3:window.pollingAttemptNumber,C=io.connect(T,{query:{tag:t,gtag:a,utag:r,sig:l,uid:e,uid_key:p},transports:R,reconnection:!0,reconnectionAttempts:u.reconnectMaxTimes,reconnectionDelay:u.reconnectionDelay,reconnectionDelayMax:u.reconnectionDelayMax,randomizationFactor:u.randomizationFactor,timeout:u.connectTimeout,path:"/websocket"});m("connecting channel io transports"+C.io.opts.transports+" pollingReopenCount = "+w+" pollingAttemptNumber="+I),d=C,C.on("reconnect_attempt",function(){m("socket io reconnect_attempt time="+new Date)}),C.on("connect_error",function(e){u.onlogWarn("socket io connect_error obj time:"+new Date+" code:"+(void 0!==e.description&&null!==e.description?e.description.code:90009));var t=u.getSocketChannelInfo();t||(t={}),t.event="connect_error",t.failReason="io connect_error unknown",e&&e.type&&(t.failReason=e.type),u.onSocketStatusChanged(C.io.readyState,t)}),C.on("connect_timeout",function(){var e=u.getSocketChannelInfo();e||(e={}),e.event="connect_timeout",e.failReason="connect_timeout",u.onSocketStatusChanged(C.io.readyState,e)}),C.on("get",function(e){u.onmessage(e)}),C.on("post",function(e){u.onpostmessage(e)}),C.on("connect",function(e){f.socketing&&f.socketing(),h=!1,m("socket io connect readyState: "+C.io.readyState),f.connect(),u.onSocketOpened(),!s&&window.performanceCollector&&window.performanceCollector.action&&(s=!0,window.performanceCollector.action("socket_connect","open_socket_connect",0))}),C.on("reconnect",function(e){var t=new Date;m("socket io reconnect number: "+e+",time: "+t+",channel.readyState: "+C.io.readyState)}),C.on("reconnecting",function(e){var t=new Date;C.io.opts.transports=R,console.log("socket io reconnecting number: "+e+",time: "+t+",channel.readyState: "+C.io.readyState+" attempt_transports:"+A+" pollingReopenCount:"+w+" pollingAttemptNumber:"+I),u.onReopenCount()>=w&&C.io.backoff.attempts>=I&&(C.io.opts.transports=A,o.default.run(i.CONFIG.REPORT_FOR_PLATFORM,{PC:33862722,Android:33862727,IOS:33862728}));var a=u.getSocketChannelInfo();a||(a={}),m("reconnecting channel io transports"+C.io.opts.transports+" pollingReopenCount = "+w+" pollingAttemptNumber="+I),a.event="reconnecting",u.onSocketStatusChanged(C.io.readyState,a)}),C.on("retry",function(e){"ok"!=e&&2==e.length&&(window.md=e);var t=new Date;m("socket io retry ,time: "+t),E("Server restarted or socket timed out on server. serverRetry offlineEdit")}),C.on("disconnect",function(e){var t=new Date;m("socket io disconnect, msg: "+(0,n.default)(e)+",time: "+t+",channel.readyState: "+C.io.readyState);var a=u.getSocketChannelInfo();a||(a={}),a.event="disconnect",c||(c=(0,n.default)(e)+" ClosedByOthers. WS disconnect offlineEdit"),a.disconnectReason=(0,n.default)(e)+" "+c,u.onSocketStatusChanged(C.io.readyState,a)}),C.on("connect_failed",function(e){m("socket io connect_failed"),v(f,"socketing",500,function(){E((0,n.default)(e)+" connect_failed Closed by client. WS connect_failed offlineEdit")})}),C.on("error",function(e){m("socket io error"),v(f,"socketing",500,function(){E((0,n.default)(e)+" socket io error Closed by client. WS error offlineEdit")})}),C.on("reconnect_failed",function(e){m("socket io reconnect_failed"),E((0,n.default)(e)+" reconnect_failed Closed by client. WS reconnect_failed offlineEdit"),!s&&window.performanceCollector&&window.performanceCollector.action&&(s=!0,window.performanceCollector.action("socket_connect","open_socket_connect",1))})}()},this.disconnect=function(e){e||(e="Closed by client. forceClosed "),T(e),h=!0},this.postMessageForWebSocket=function(e){new Date;(0,n.default)(e),d&&d.emit("post",e)},this.getSocketChannelInfo=function(){var e=null;return d&&((e={}).connected=d.connected,e.disconnected=d.disconnected,d.io&&(e.readyState=d.io.readyState,e.reconnecting=d.io.reconnecting)),e},this.describe=function(){return name}};var o=r(a(8)),i=a(26);function r(e){return e&&e.__esModule?e:{default:e}}var s=!1},1606:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.MsgSenderReporter=t.WebSocketRoomReporter=void 0;var n=i(a(25)),o=i(a(8));function i(e){return e&&e.__esModule?e:{default:e}}t.WebSocketRoomReporter=function(e){var t=0,a=0,n=0,i=!1,r=0,s=0,l=0,u="unknow",d=0,c=0,h=0,f=0,p="unknow";function v(){t=0,a=0,n=0,r=0,s=0,l=0,u="unknow",d=0,p="unknow",i=!1,c=0,h=0}function _(){var i={module:e,type:"room_open",closeReason:"unknow",roomState:p,startOpenTime:0,endOpenTime:0,openTotalTime:0,connectTime:0,loginTime:0,delayOpenTime:0,reconnectCount:0,loginCount:0,bShutDown:0,bNeedNotify:0,bFirstConnect:0};i.bShutDown=c,i.bNeedNotify=h,i.bFirstConnect=f,u&&(i.closeReason=u),i.startOpenTime=t,i.endOpenTime=a,a&&t&&a-t>0&&(i.openTotalTime=a-t),s&&t&&s-t>0&&(i.connectTime=s-t),s&&a&&a-s>0&&(i.loginTime=a-s),n&&t&&t>n&&(i.delayOpenTime=t-n),i.reconnectCount=l,i.loginCount=d;var r=i.module+"TDSP"+i.type+"TDSP"+i.closeReason+"TDSP"+i.roomState+"TDSP"+i.startOpenTime+"TDSP"+i.endOpenTime+"TDSP"+i.openTotalTime+"TDSP"+i.connectTime+"TDSP"+i.loginTime+"TDSP"+i.delayOpenTime+"TDSP"+i.reconnectCount+"TDSP"+i.loginCount+"TDSP"+i.bShutDown+"TDSP"+i.bNeedNotify+"TDSP"+i.bFirstConnect+"TDSP";console.log("report collab RoomConnectInfo reportMsg = ",r);var v={opername:"tech_doc_websocket",module:"websocket_collab",action:"room_connect",table:"dc03111",ver6:r};l>1&&(v.ver8=window.__globalReleaseVersion),o.default.tdwReport(v)}function E(t,a){var n={module:e,type:"socket_connect",roomState:p,closeReason:"unkown",startConnectTime:0,endConnectTime:0,connecTotalTime:0,connectNum:0},i=(new Date).getTime();n.startConnectTime=r,n.endConnectTime=i,n.connecTotalTime=n.endConnectTime-n.startConnectTime,n.connectNum=l,!0===t?n.closeReason="suc":(n.closeReason="unkown",a&&(n.closeReason=a));var s=n.module+"TDSP"+n.type+"TDSP"+n.roomState+"TDSP"+n.closeReason+"TDSP"+n.startConnectTime+"TDSP"+n.endConnectTime+"TDSP"+n.connecTotalTime+"TDSP"+n.connectNum+"TDSP";console.log("report collab SocketConnectInfo  reportMsg = ",s);var u={opername:"tech_doc_websocket",module:"websocket_collab",action:"socket_connect",table:"dc03111",ver6:s};o.default.tdwReport(u)}e||(e="unknow"),this.reportRoomState=function(e){p=e},this.reportNetWorkEvent=function(e,o){"setupSocket"===e?(v(),l=1,t=(new Date).getTime(),r=(new Date).getTime(),i=!0):"connectfail"===e?(E(!1,o.reason),i=!1,r=0):"reconnecting"===e?(!0===i&&E(!1,"reconnecting unknow"),l+=1,r=(new Date).getTime(),i=!0,0===t&&(v(),l=1,t=(new Date).getTime(),r=(new Date).getTime(),i=!0)):"connect"===e?(s=(new Date).getTime(),E(!0),r=0,i=!1):"open"===e?(a=(new Date).getTime(),u="suc",h=1,f=!0===o.bFirstConnect?1:0,_(),v()):"close"===e?(!0===i&&o.closeReason&&o.closeReason.indexOf("Timeout connecting")>=0&&E(!1,o.closeReason),a=(new Date).getTime(),u=o.closeReason,c=!0===o.bShutDown?1:0,h=!0===o.bNeedNotify?1:0,f=!0===o.bFirstConnect?1:0,_(),v(),n=(new Date).getTime()):"login"===e&&(d+=1)}},t.MsgSenderReporter=function(e){e||(e="unkown"),this.reportMsg=function(t,a){var i={seq:0,cmd:"null",errCode:0,errMsg:"",retryCount:0,dataSize:0,postTime:0,waitAcceptTime:0,totoalTime:0,allTotoalTime:0,waitAcceptCmd:"null",bFinish:1,module:e};i.seq=t.seq,i.cmd=t.cmd,i.retryCount=t.retryCount,i.dataSize=t.postData.length,!0===a.needRetry?i.bFinish=0:i.bFinish=1,t.postTime&&t.lastSendTime&&t.postTime>t.lastSendTime&&(i.postTime=t.postTime-t.lastSendTime);var r=(new Date).getTime();if(t.lastSendTime&&r>t.lastSendTime&&(i.totoalTime=r-t.lastSendTime),i.waitAcceptTime=i.totoalTime-i.postTime,t.firstSendTime&&r>t.firstSendTime&&(i.allTotoalTime=r-t.firstSendTime),a.waitAcceptCmd&&(i.waitAcceptCmd=a.waitAcceptCmd),"netStatusChange"===a.event&&(i.errCode=a.errCode,i.errMsg=a.errMsg),"onpost"===a.event&&(i.errCode=a.errCode,0===a.errCode?i.errMsg="suc":a.errMsg&&0!==a.errMsg.length?i.errMsg=a.errMsg:i.errMsg="onpost error"),"onsendAccept"===a.event)if("ACCEPT_COMMIT"===a.waitAcceptCmd)i.errCode=0,i.errMsg="suc";else if("COMMIT_ERROR"===a.waitAcceptCmd){var s=a.response.data;i.errCode=s.reason,s.msg&&(i.errMsg=s.msg)}else"TASK_DUPLICATE"===a.waitAcceptCmd&&(i.errCode=0,i.errMsg="suc");if(s={opername:"tech_doc_websocket",module:"websocket_collab",action:"sendMsg",table:"dc03111",ver6:i.module+"TDSP"+i.seq+"TDSP"+i.cmd+"TDSP"+i.errCode+"TDSP"+i.errMsg+"TDSP"+i.retryCount+"TDSP"+i.dataSize+"TDSP"+i.postTime+"TDSP"+i.waitAcceptTime+"TDSP"+i.totoalTime+"TDSP"+i.allTotoalTime+"TDSP"+i.waitAcceptCmd+"TDSP"+i.bFinish+"TDSP"},t.postData&&t.postData.indexOf("changeSetCount")>0&&t.postData.indexOf("\n")>0)for(var l=t.postData.split("\n"),u=0;u<l.length;u++){var d=l[u];"object"==(0,n.default)(JSON.parse(d))&&(JSON.parse(d).hasOwnProperty("changeSetCount")&&(s.obj3=JSON.parse(d).changeSetCount),JSON.parse(d).hasOwnProperty("offlineMsg")&&(s.ver5=JSON.parse(d).offlineMsg))}"USER_CHANGES"===t.cmd&&(s.ver3="USER_CHANGES",s.ver4=i.errCode,s.ver8=window.__globalReleaseVersion),o.default.tdwReport(s)}}},1607:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(16)),o=s(a(7)),i=a(751),r=a(90);function s(e){return e&&e.__esModule?e:{default:e}}t.default={notifyRightChange:function(e,t){try{if(""===t.payload||null===t.payload)return void(window.SLR&&window.SLR.dispatch("TX-AUTH-UPDATED"));var a=JSON.parse(t.payload);if(null==a)return;var n=a.seq;if("undefined"===typeof o.default.window.clientVars.msgFilterData&&(o.default.window.clientVars.msgFilterData={}),1===a.action)"undefined"===typeof o.default.window.clientVars.msgFilterData[n]?(4&o.default.window.clientVars.rightFlag&&(window.SLR&&window.SLR.dispatch("TX-AUTH-UPDATED"),$(window).trigger("permissionChanged"),(0,i.showToast)("\u6743\u9650\u4fee\u6539\u6210\u529f",{top:"5px"},{toolToastCloseTime:600})),e.sheetStatus.permission.gEditable||1!==a.advpolicy||e.socket.client.shutDown(r.errCodeType.PERMISSION_CHANGE)):delete o.default.window.clientVars.msgFilterData[n];else if(2===a.action);else if("undefined"!=a.exptime&&"undefined"!=a.settime&&"undefined"!=a.starttime){var s=a.exptime-a.starttime,l=s;if(s&&s>0){var u={};u.exptime=a.exptime,u.remaintime=l,u.settime=s,u.starttime=a.starttime,o.default.window.CoreSheet.advPermissions.onUpdateAuthExpInfo(u)}else console.error("\u6709\u6548\u671f\u53d8\u66f4\u9519\u8bef")}}catch(d){}},comparePrivilege:function(e){4&o.default.window.clientVars.rightFlag||e.socket.client.sendMessage("GET_PRIVILEGE",void 0,(0,n.default)({}),void 0,function(t,a,n,i){if(0===i.errCode&&i.response&&i.response.onpost&&0===i.response.onpost.result){var s=i.response.onpost.privilege_attribute,l=o.default.window.clientVars.privilegeAttribute;l.can_edit===s.can_edit&&l.can_read===s.can_read||(e.socket.client.shutDown(r.errCodeType.PERMISSION_CHANGE),e.sheetStatus.permission.setgEditable(!1),$("#editor").blur())}})}}},1608:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(3)),o=c(a(0)),i=c(a(1)),r=c(a(4)),s=c(a(5)),l=a(46),u=c(l),d=c(a(1609));function c(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(){return(0,o.default)(this,t),(0,r.default)(this,(t.__proto__||(0,n.default)(t)).apply(this,arguments))}return(0,s.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this.props,t=e.type,a=e.hideFunc,n=e.options;return"TOAST"===t?u.default.createElement(d.default,{hideFunc:a,options:n}," "):null}}]),t}(l.Component);t.default=h},1609:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(25)),o=h(a(3)),i=h(a(0)),r=h(a(1)),s=h(a(4)),l=h(a(5)),u=a(46),d=h(u);a(1610);var c=a(22);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e,a){(0,i.default)(this,t);var n=(0,s.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,a));return n.hide=n.hide.bind(n),n}return(0,l.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){}},{key:"useMobileUI",value:function(){return c.isMobile&&!/(ipad)/i.test(navigator.userAgent)}},{key:"handleCssParam",value:function(e){return"object"!==("undefined"===typeof e?"undefined":(0,n.default)(e))&&(e={}),delete e.top,delete e.left,delete e.right,delete e.bottom,delete e.position,delete e.transform,delete e.width,delete e.height,delete e["max-width"],delete e["max-height"],e.borderSizing="border-box",e.display="flex",e.position="fixed",e.zIndex="10100",this.useMobileUI()?(e.top="0px",e.left="0px",e.right="0px"):(e.top="105px",e.left="30px",e.right="30px"),e}},{key:"handleContentCss",value:function(e){var t={};if(this.useMobileUI()&&(t.position="relative",t.left="0px",t.top="0px",t.width=document.body.clientWidth+"px",t.paddingTop="15px",t.paddingBottom="15px",t.paddingLeft="12px",t.paddingRight="12px",t.borderRadius="0px",t.whiteSpacing="nowrap"),e){var a=e.toastType;a&&("typeNotice"===a?(t.backgroundColor="rgba(0,0,0,0.75)",t.color="white"):"typeNoticeWhite"===a?(t.backgroundColor="#ffffff",t.color="black"):"typeSuccess"===a?(t.backgroundColor="rgba(0,0,0,0.75)",t.color="white"):"typeWarning"===a&&(t.backgroundColor="#ff7d6f",t.color="white"))}return t}},{key:"handleTypeIcon",value:function(e){if(e){var t=e.toastType;if(t){var a="toast-icon";return"typeNotice"===t?a+=" toast-icon-notice":"typeNoticeWhite"===t?a+=" toast-icon-notice":"typeSuccess"===t?a+=" toast-icon-success":"typeWarning"===t&&(a+=" toast-icon-warnning"),d.default.createElement("div",{className:"toast-icon-container"},d.default.createElement("div",{className:a}))}}return""}},{key:"realContent",value:function(){var e=this.props.options,t=e.messageContent,a=e.extendParam;if("function"===typeof t)return d.default.createElement("span",{id:"toastContent"},t());if(a&&a.linkTitle){var n=a.linkTitle,o=t.split(n);return console.log("------",o),d.default.createElement("span",{id:"toastContent"},o[0],this.handleLinkType(),o[1])}return d.default.createElement("span",{id:"toastContent"},t)}},{key:"handleLinkType",value:function(){var e=this.props.options.extendParam;if(e&&e.linkTitle){var t=e.linkCallback||function(){};return d.default.createElement("span",{id:"tool-toast-content-link",className:"toast-link-mobile",onClick:t},e.linkTitle)}return null}},{key:"handleBtnText",value:function(e){if(e&&e.isNeedBtn)return d.default.createElement("span",{id:"toolToastBtn",onClick:e.btnCallBack},e.btnText)}},{key:"handleBtnTextAfter",value:function(e){if(e&&e.btnTextAfter)return d.default.createElement("span",{id:"toolToastBtnAfter"},e.btnTextAfter)}},{key:"handleHide",value:function(e){var t=this.hide;if(e){if(e.manualClose){var a={};return this.useMobileUI()&&(a["margin-left"]="auto",a["margin-right"]="0px"),d.default.createElement("div",{className:"toast-close-white",onClick:t,style:a},d.default.createElement("div",{className:"toast-close-white-img"}))}var n=3e3;return e.toolToastCloseTime&&parseFloat(e.toolToastCloseTime)&&(n=parseFloat(e.toolToastCloseTime)),setTimeout(function(){t()},n),""}return setTimeout(function(){t()},3e3),""}},{key:"hide",value:function(){this.props.hideFunc();var e=this.props.options.extendParam;e&&e.toolToastRemoveCallBack&&e.toolToastRemoveCallBack()}},{key:"render",value:function(){var e=this.props.options,t=(e.messageContent,e.cssParam),a=e.extendParam;return d.default.createElement("div",{id:"toastWrap",style:this.handleCssParam(t)},d.default.createElement("div",{id:"toast",style:this.handleContentCss(a)},this.handleTypeIcon(a),d.default.createElement("span",{id:"toastContent"},this.realContent()),this.handleBtnText(a),this.handleBtnTextAfter(a),this.handleHide(a)))}}]),t}(u.Component);t.default=f},1610:function(e,t,a){var n=a(1611);"string"===typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};a(37)(n,o);n.locals&&(e.exports=n.locals)},1611:function(e,t,a){t=e.exports=a(36)(!1);var n=a(758),o=n(a(1612)),i=n(a(1613)),r=n(a(1614));t.push([e.i,".toast-icon-notice {\n  width: 40px;\n  height: 40px;\n  background-size: 40px 40px;\n  background-image: url("+o+");\n}\n.toast-icon-success {\n  width: 40px;\n  height: 40px;\n  background-size: 40px 40px;\n  background-image: url("+i+");\n}\n.toast-icon-warnning {\n  width: 40px;\n  height: 40px;\n  background-size: 40px 40px;\n  background-image: url("+r+');\n}\n#toastWrap {\n  display: flex;\n  justify-content: center;\n  pointer-events: none;\n}\n#toast {\n  padding: 11px 20px;\n  line-height: 18px;\n  font-size: 14px;\n  position: relative;\n  word-wrap: break-word;\n  color: #ffffff;\n  font-family: "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  text-align: center;\n  background: rgba(0, 0, 0, 0.75);\n  background-size: cover;\n  display: flex;\n  align-items: center;\n  max-width: 686px;\n  box-sizing: border-box;\n  box-shadow: 0 0 0 0 rgba(0, 0, 0, 0.15), 0 2px 5px 0 rgba(0, 0, 0, 0.25);\n  pointer-events: auto;\n  border-radius: 2px;\n  -webkit-user-select: none;\n  -moz-user-select: none;\n  -ms-user-select: none;\n  user-select: none;\n}\n.toast-icon-container {\n  width: 20px;\n  height: 20px;\n  position: relative;\n  margin-right: 12px;\n}\n.toast-icon {\n  zoom: 0.5;\n  -moz-transform: scale(0.5);\n  -moz-transform-origin: 0 0;\n}\n.toast-close-white {\n  width: 17px;\n  height: 17px;\n  position: relative;\n  align-items: center;\n  margin-left: 5px;\n  cursor: pointer;\n}\n.toast-close-white-img {\n  width: 12px;\n  height: 12px;\n  position: absolute;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  top: 0;\n  margin: auto;\n  background: url(\'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAwAAAAMCAYAAABWdVznAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6QUYxOURERTBGNUFCMTFFNzg5NDI4RjhEMTJCQUMzN0EiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6QUYxOUREREZGNUFCMTFFNzg5NDI4RjhEMTJCQUMzN0EiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKFdpbmRvd3MpIj4gPHhtcE1NOkRlcml2ZWRGcm9tIHN0UmVmOmluc3RhbmNlSUQ9InhtcC5paWQ6NkFDMTA3NTI3REE5MTFFN0JBMUVBMTNGODc5RTBEMDkiIHN0UmVmOmRvY3VtZW50SUQ9InhtcC5kaWQ6NkFDMTA3NTM3REE5MTFFN0JBMUVBMTNGODc5RTBEMDkiLz4gPC9yZGY6RGVzY3JpcHRpb24+IDwvcmRmOlJERj4gPC94OnhtcG1ldGE+IDw/eHBhY2tldCBlbmQ9InIiPz5fnmXrAAAAUklEQVR42pTQ2woAIAgD0Bz9/y8vAoku08qXXnakaSTLz8DfF8UZ2AXRMwNkaIR3oNAS7lPFxhlZVPr7SurPshOyggohK6gQLuEDIbpGgEoTYAB9mRQYIWaghgAAAABJRU5ErkJggg==\') no-repeat;\n}\n#toolToastBtn {\n  color: #0188fb;\n  margin: 0 2px;\n  white-space: nowrap;\n  cursor: pointer;\n  font-weight: bold;\n}\n#toolToastBtn:hover {\n  color: #4060c9;\n}\n#toolToastBtn:active {\n  color: #354ea1;\n}\n.toast-link {\n  font-size: 14px;\n  color: #0188fb;\n  cursor: pointer;\n}\n.toast-link:hover {\n  color: #49affd;\n}\n.toast-link:active {\n  color: #017ddb;\n}\n.toast-link-mobile {\n  font-size: 16px;\n  color: #0188fb !important;\n  cursor: pointer;\n}\n',""])},1612:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAYFBMVEUAAAABiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPsBiPv////u+P+RzP0Gi/vn9P9NrPzZ7f6JyP0QkPv2+/9yvf1ktv1ds/w+pPyCVnMcAAAAEXRSTlMA7QaZ1LWtiHlZOBwTluTi6z9IyjgAAAEHSURBVDjLjZXdbsMgDEbtQIECSeqRrPvf+7/lWNSNOkDjcxfrSJYD/gCOd0YjEWrj/AA9gp3ojsmGphZHqlCx9s4XaoBn4AyKOqiBeSfqchq4JzIVPUT9z8HK65LSsrLSbaKIrLo8ZV757HETR2KkXzE1mgc6Filk0RL1WhdsFmei3jCFCcCTCA9OJjowxPjYZnm+7kUDmn2/ZWsz96IG5OL7zdyLCMT5TEVkANW0xBVQJiJomajByEQDTiY68DLRA8wScSrX7LFoq4v7tf3w6rxDtQrZ++Nlv4fxUiprU8RYr+u1tP4u6yoNAHmkyEOqmONB7B0HqSyax9gJe3buMw/7/vMBjB9OulPkmOLgYAAAAABJRU5ErkJggg=="},1613:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAq1BMVEUAAAAAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjEAxjH////w/PM4015/4pj5/vpR2HLy/PTQ9dm378WA45hf235d23wx0Vnl+erE8s914JBX2XdH1mo30l0t0FXnscbiAAAAJHRSTlMAd/v32bMK8c3JBemZlH9XPSwTrqhtIxkO6+GkjIVmQjPVpXFA4s3pAAABO0lEQVQ4y43T13LCMBCF4SP3gguhd5KsSYEkkP7+TxabcVi5yOK72/E/Ho1Gi4ppEvku5Vw/SqZQ2S5MkpiLLdqMbWqwx2gQJrUwBaocmxRsB5Ibn5T8G+6mHnXw+J8D6jRAaUQao/JeTNJwJygMSWuIXJ/0jH4eRnSFCAhmpPC5P/xSKQyQksJrlmUv9C9FrO7kMIZNrR6LbneSLt3q6H7o4hYuD8f97kvuHojNYPCwy78eKx0zYPLwnuXeuJOZCHl4fjqX3ElCeFQvuZN4/CS45I7d4Z4aJXdsxI+HS+5YH/Ub/z58nKjBAiDoCqJYVZe03PPKrkhrhYIzJ425g7ONodmYDUoxdYpx0aMOPbCg19EFkAlDcT6BmtSiFlaKhkCEVBOKAG2ctU8Sf+1AaZIsbc+yPHuZTFDxBxMlrnlmgPLCAAAAAElFTkSuQmCC"},1614:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAoCAMAAAC7IEhfAAAAY1BMVEUAAAD///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+aRQ2gAAAAIHRSTlMA+RLsloZYrAbj03luNxwC75kLsbNqO8d2RS8k3txTUuiho80AAAEjSURBVDjLlZXbcoMwDESFA+ZiwMYkpEl60f9/ZUdtp8FaE4Z9PLOAV5IFJfKDq7tQFKGr3eBpS2PV8kptNWZtpixYqSgN+uyJMzpZZWtK3lDZrH3xzJs6x9X7Zn6h+fnOiV9q+s+R4GCbaEOC/hKZNG8v7JJmNyRSge/C7iq6sFHVeRG4qMpLjypO9SnGLwUrIt8qdsEzMreeBsaH8TM8kIOqZSvrqIZGEBHSmjqNrmK8atoRTNe7GD9g3ginVYxIEXEkioxGHOwH0QNHHcPwIh3EMDWwXhqD5XHAwu2G53HYwrwGGIq8Wg/9z6vKDG7RG9NrNv5eBbwzbzBReLnMD8tdLrJ7RgsLIP/pCVZKPszcHF1S+2vv+CLdX83Hl/3+7+MbNY2LT5VU5o4AAAAASUVORK5CYII="},1615:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(7)),o=r(a(8)),i=a(124);function r(e){return e&&e.__esModule?e:{default:e}}t.default={unbindAccount:function(e){var t=(0,i.getCookie)("utype");t||console.error("handlePushMessage unbind utype is null!");var a=e.unbind;if("wx"===a){if(console.log("handlePushMessage unbind wx"),"wx"===t)return o.default.monitor(33612279),void n.default.window.SpreadsheetApp.socket.client.shutDown("TX-LOGIN-PSKEY-EXPIRED");console.log("handlePushMessage unbind wx push not for wx")}else if("qq"===a){if(console.log("handlePushMessage unbind qq"),"qq"===t)return;console.log("handlePushMessage unbind qq push not for qq")}}}},1616:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=w(a(63)),o=w(a(0)),i=w(a(1)),r=w(a(107)),s=w(a(25)),l=w(a(159)),u=w(a(138)),d=w(a(698)),c=a(193),h=w(a(7)),f=a(752),p=w(f),v=w(a(13)),_=a(90),E=a(188),T=a(438),m=w(a(12)),g=w(a(8)),S=a(26),R=a(165),A=w(a(140));function w(e){return e&&e.__esModule?e:{default:e}}var I,C=function(e,t,a,n){var o,i=arguments.length,u=i<3?t:null===n?n=(0,l.default)(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":(0,s.default)(Reflect))&&"function"===typeof Reflect.decorate)u=Reflect.decorate(e,t,a,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(u=(i<3?o(u):i>3?o(t,a,u):o(t,a))||u);return i>3&&u&&(0,r.default)(t,a,u),u},y=h.default.window;!function(e){e.NORMAL="normal",e.FETCHING="fetching",e.SHUTDOWN="shutDown"}(I||(I={}));var O=function(){function e(t,a){(0,o.default)(this,e),this.__currentVersion=0,this.__waitingQueue=new Array,this.commitingQueueTimeoutStatus="INIT",this.needKeyDataFlagMap=new n.default,this.__retryTime=0,this.__retryPostCount=0,this.__retryCommitCount=0,this.pushChangesCache=[],this.receiveCrossSheetMutation=!0,this.applyNewChangesError=!1,this.channelStatus=I.NORMAL,this.__maxRequesCount=5,this.app=t,this.init(a),this.loop()}return(0,i.default)(e,[{key:"init",value:function(e){this.__currentVersion=e.baseVersion,this.spreadSheetId=e.spreadsheetId}},{key:"loop",value:function(){var t=this;m.default.wait(e.MESSAGE_LOOP_INTERVAL).run(function(){if(t.app.socket&&t.app.socket.client&&"OPENED"===t.app.socket.client.getRoomState()){var e=(new Date).getTime(),a=t.__retryTime>0&&e>=t.__retryTime;a&&(t.__retryTime=0),a&&!t.commitingQueue.isEmpty?(g.default.run(S.CONFIG.RETRY_SENDMESSAGE,[e,t.commitingQueue.taskId]),t.sendUserChanges(t.commitingQueue)):t.commitingQueue.isEmpty&&t.waitingQueue.length>0&&(t.__commitingQueue=t.waitingQueue.shift()||null,t.__commitingQueue&&(t.__retryTime=0,g.default.run(S.CONFIG.MOVE_MESSAGEINFO_COMMITING_QUEUE,[t.__commitingQueue.key,t.__commitingQueue.isMutationChange(),t.__commitingQueue.mutations.length,t.waitingQueue.length]),t.__commitingQueue.status=f.UserChangeStatus.COMMITING,t.app.messageOfflineStore.updateData(t.__commitingQueue.key,t.__commitingQueue),t.sendUserChanges(t.__commitingQueue))),a||t.detectAndHandleQueueBlock()}t.loop()})}},{key:"detectAndHandleQueueBlock",value:function(){if("ERROR"!==this.commitingQueueTimeoutStatus){var e=(new Date).getTime();!this.commitingQueue.isEmpty&&this.__lastCommitTime&&e-this.__lastCommitTime>6e4&&("INIT"===this.commitingQueueTimeoutStatus?(this.retryCommit(100),this.commitingQueueTimeoutStatus="RETRY"):"RETRY"===this.commitingQueueTimeoutStatus&&(g.default.monitor(33714439),this.app.event.errorCode.trigger("errorCode",{type:"front",code:_.errCodeType.COMMITING_QUEUE_BLOCK}),this.resetCommitingQueue(),this.commitingQueueTimeoutStatus="ERROR"))}}},{key:"hasUncommittedChanges",value:function(e){return e?!(!this.__commitingQueue||this.__commitingQueue.isEmpty||this.__commitingQueue.sheetId!==e)||(this.waitingQueue.forEach(function(t){if(t.sheetId===e)return!0}),!1):this.__commitingQueue&&!this.__commitingQueue.isEmpty||this.waitingQueue.length>0}},{key:"retryCommit",value:function(e){this.__retryTime=(new Date).getTime()+e.valueOf(),g.default.run(S.CONFIG.RETRY_COMMIT,[this.__retryTime])}},{key:"sendUserChanges",value:function(e){var t=e.prepareCommitMessage();this.__lastCommitTime=(new Date).getTime();var a=this.app.socket.client.sendMessageWaitAcceptCmd("USER_CHANGES",e.taskId,t,this.prepareSendParams(),this.onSend.bind(this),this.onSendAccept.bind(this)),n=0===e.commitTimes;e.commitTimes=e.commitTimes+1,this.__commitingQueue&&(this.__commitingQueue.taskId=a.seq);var o=e.isOfflineMessage?"sendOfflineUserChange":"sendUserChange";a&&0!==a.errCode?(n&&g.default.run(S.CONFIG.SEND_USERCHANGE,[e.prepareMessageForReport(),a,e.commitTimes],o,e.requestCount),this.handleRoomErrorCode(0,"",a)):n&&g.default.run(S.CONFIG.SEND_USERCHANGE_1,[e.prepareMessageForReport(),e.commitTimes],o,e.requestCount)}},{key:"prepareSendParams",value:function(){return{timeout:15e3,maxRetryCount:3,waitAcceptCmd:["ACCEPT_COMMIT","COMMIT_ERROR","TASK_DUPLICATE"]}}},{key:"onSend",value:function(e,t,a,n){0===n.errCode&&n.response&&n.response.onpost&&0===n.response.onpost.result?this.__retryPostCount=0:this.handleCommitOnSendError(e,t,n)}},{key:"handleCommitOnSendError",value:function(e,t,a){if(a&&a.response&&a.response.onpost&&0!==a.response.onpost.result){var n=a.response.onpost.result;switch(g.default.run(S.CONFIG.HANDLE_COMMIT_ONSENDERROR,[e,t,a],n),n){case 60002:case 60004:case 60005:case 60011:case 60013:case 60014:case 60021:case 60022:if(this.__retryPostCount<3){this.__retryPostCount++,this.app.socket.client.cancelMessageBySeq(e);var o=3e3;a.response.onpost&&a.response.onpost.retry_interval&&(o=a.response.onpost.retry_interval),this.retryCommit(o)}else 60014===n?this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"60014"}):(this.__retryPostCount=0,this.shutDown(String(n)));break;case 60003:case 60008:case 60016:case 60017:this.clearOfflineStore(),this.shutDown(String(n));break;case 60007:case 60015:this.clearOfflineStore(),this.shutDown(String(n))}}else this.handleRoomErrorCode(e,t,a)}},{key:"onSendAccept",value:function(e,t,a,n,o){"USER_CHANGES"===t&&("ACCEPT_COMMIT"===n?this.handleAcceptCommit(e,t,o):"COMMIT_ERROR"===n?this.handleCommitError(e,t,o):"TASK_DUPLICATE"===n&&this.handleTaskDuplicate(e,t,o))}},{key:"acceptCommit",value:function(e,t,a,n){var o=this.__commitingQueue&&this.__commitingQueue.isOfflineMessage?"acceptOfflineCommit":"acceptCommit";g.default.run(S.CONFIG.ACCEPT_COMMIT_2,[e,t,a],o),!this.needKeyDataFlagMap.get(e)&&a&&this.needKeyDataFlagMap.set(e,a),this.updateBaseVersion(t),this.resetCommitingQueue(),n&&n.head||h.default.event.network.trigger("commitSuccess"),h.default.event.notificationCenterEvent.trigger("localChangeContent")}},{key:"handleAcceptCommit",value:function(e,t,a){if(0===a.errCode&&a.response){this.__retryCommitCount=0;var n=a.response.new_rev,o=a.response.body,i=o&&o.data,r=i&&i.need||!1,s=i&&i.subId;n>this.currentVersion+1?this.fetchAndApplyMisschanges(this.currentVersion+1,n):this.acceptCommit(s,n,r,i)}else g.default.run(S.CONFIG.ACCEPT_COMMIT,[e,t,a]),(0,R.showUserChangeSaveFailTip)(),this.handleRoomErrorCode(e,t,a)}},{key:"handleCommitError",value:function(e,t,a){if((0,R.showUserChangeSaveFailTip)(),0===a.errCode&&a.response){var n=a.response.body,o=n&&n.data,i=o&&o.reason||0;o&&o.msg;switch(g.default.run(S.CONFIG.HANDLE_COMMIT_ERROR,[e,t,a],i),i){case 60018:case 60019:case 60020:case 40006:if(this.__retryCommitCount<3){this.__retryCommitCount++,this.app.socket.client.cancelMessageBySeq(e);var r=void 0;a.response.body&&a.response.body.data&&a.response.body.data.retry_interval&&(r=a.response.body.data.retry_interval),r=r||3e3,this.retryCommit(r)}else this.__retryCommitCount=0,40006===i&&this.clearOfflineStore(),this.shutDown(String(i));break;case 40024:case 40025:this.shutDown(String(i));break;case 4e4:case 40001:case 40002:case 40003:case 40005:case 40020:case 40021:case 40022:case 40023:case 40026:case 40028:case 40030:case 41001:case 41002:case 1e4:case 10001:this.clearOfflineStore(),this.shutDown(String(i));break;default:this.shutDown(_.errCodeType.COMMIT_ERROR_CODE_UNDEFINED)}}else console.log("handleCommitError result="+a),this.handleRoomErrorCode(e,t,a)}},{key:"handleTaskDuplicate",value:function(e,t,a){if(0===a.errCode&&a.response){this.__retryCommitCount=0,g.default.run(S.CONFIG.HANDLE_TASK_DUPLICATE,[e,t,a]);var n=a.response.body,o=n&&n.data;o&&o.doneTime;this.resetCommitingQueue()}else console.log("handleTaskDuplicate result="+a),this.handleRoomErrorCode(e,t,a)}},{key:"handleRoomErrorCode",value:function(e,t,a){switch(g.default.run(S.CONFIG.HANDLE_ROOM_ERRORCODE,[e,t,a],a),a.errCode){case 101:case 104:case 106:this.retryCommit(3e3);break;case 102:this.clearOfflineStore(),this.app.event.errorCode.trigger("errorCode",{type:"socket",code:"102"});break;case 103:case 105:break;default:this.app.event.errorCode.trigger("errorCode",{type:"front",code:_.errCodeType.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED})}}},{key:"isDuplicateMessage",value:function(e){return this.commitingQueue.taskId===e}},{key:"handleNewChanges",value:function(e){var t=e.body&&e.body.data,a=e.new_rev;if(g.default.run(S.CONFIG.HANDLE_NEW_CHANGES,[a,t&&t.commitId]),t){var n={commitId:t.commitId,sheetId:t.subId,newVersion:a,changeset:t.changeset||"[]",isNeedKeyframe:t.need,head:t.head,revert:t.revert};this.pushChangesCache.push(n),this.checkAndApplyNewChanges()}}},{key:"applyNewChanges",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"collab";if(!this.applyNewChangesError){if(e.newVersion<=this.currentVersion&&g.default.run(S.CONFIG.APPLY_NEWCHANGES_VERROR,[o,t,n,e],o),!this.needKeyDataFlagMap.get(e.sheetId)&&e.isNeedKeyframe&&this.app.spreadsheet.getActiveSheetId()===e.sheetId&&this.needKeyDataFlagMap.set(e.sheetId,e.isNeedKeyframe),this.isDuplicateMessage(e.commitId))return this.acceptCommit(e.sheetId,e.newVersion,e.isNeedKeyframe),void g.default.run(S.CONFIG.DUPLICATE_MESSAGE,[e]);this.app.behavior.apply({type:"collab",sheetId:e.sheetId,requestId:-1,canUndoRedo:!1,opt:e}).catch(function(o){g.default.run(S.CONFIG.APPLY_NEWCHANGES_CATCH_ERROR,[e,t,n,o]),a.applyNewChangesError=!0,a.shutDown(_.errCodeType.APPLY_NEW_CHANGE_ERROR)}).then(function(a){g.default.run(S.CONFIG.APPLY_NEWCHANGES,[t,n,e.newVersion])})}}},{key:"handleCollabMutations",value:function(e,t,a,n){var o=this;if(this.app.spreadsheet.getActiveSheetId()===a||this.receiveCrossSheetMutation){var i=this.app.spreadsheet.getSheetBySheetId(a);if(i&&0!==t.length)if(i.isFetching||!i.isLoaded&&a!==this.app.spreadsheet.getActiveSheetId())this.app.handleData.setMutationCache(a,n);else{var r=(0,c.deSerializeRequests)(t),s=[];this.commitingQueue.mutations&&this.commitingQueue.mutations.length&&(s=(0,c.followRequestMutations)(r,this.commitingQueue.mutations,!1),r=(0,c.followRequestMutations)(this.commitingQueue.mutations,r,!0),this.commitingQueue.baseVersion=e,this.commitingQueue.mutations=s,this.commitingQueue.setKeyData(null));for(var l=0;l<this.waitingQueue.length;l++){var h=this.waitingQueue[l];h&&h.mutations&&h.mutations.length>0&&(s=(0,c.followRequestMutations)(r,h.mutations,!1),r=(0,c.followRequestMutations)(h.mutations,r,!0),h.mutations=s,h.baseVersion=e,h.setKeyData(null))}var f=Array.prototype.concat.apply([],r),p=new d.default({sheetId:a,local:!1});p.add(f),this.app.behavior.undoredoStack.sync(p),p.redo.forEach(function(e){e.operationType=u.default.COLLAB,o.app.behavior.applyMutation(e,{isLocal:!1,isCollab:!0})})}}}},{key:"checkAndApplyNewChanges",value:function(){if(g.default.run(S.CONFIG.CHECK_AND_APPLYNEWCHANGES,[this.channelStatus,this.pushChangesCache.length]),this.channelStatus===I.NORMAL&&this.pushChangesCache.length>0){this.pushChangesCache=this.pushChangesCache.sort(function(e,t){return e.newVersion-t.newVersion});for(var e=this.pushChangesCache.length,t=0;t<e;t++){var a=this.pushChangesCache[t];if(a.newVersion===this.currentVersion+1)this.applyNewChanges(a,t,e,"collab");else{if(a.newVersion>this.currentVersion+1){g.default.run(S.CONFIG.APPLY_NEWCHANGES_VERROR2,[a.newVersion,this.currentVersion]),this.fetchAndApplyMisschanges(this.currentVersion+1,a.newVersion-1);break}a.newVersion===this.currentVersion?g.default.monitor(33707990):g.default.monitor(33707991)}}this.pushChangesCache.splice(0,t)}}},{key:"switchChanelStatus",value:function(e){g.default.run(S.CONFIG.SWITCH_CHANEL_STATUS,[this.channelStatus,e]),this.channelStatus!==I.SHUTDOWN&&(this.channelStatus=e,this.channelStatus===I.NORMAL&&this.checkAndApplyNewChanges())}},{key:"handleFetchResult",value:function(e,t,a,n){var o=this;if(g.default.run(S.CONFIG.HANDLE_FETCH_RESULT,[this.channelStatus,e,a,t&&t.length,this.pushChangesCache.length]),e){for(var i=void 0,r=0;r<t.length;r++){var s=t[r];if(0===r)i=s.newVersion;else{if(s.newVersion!==i+1)return g.default.run(S.CONFIG.FETCH_USERCHANGES_ERROR,[s.newVersion,i]),void this.handleFetchResult(!1,void 0,"F0001","change Array is not continue.");i=s.newVersion}}g.default.jank.log({moduleValue:"messageCenter",actionValue:"fetchAndApplyCollabNewChanges",lockJankKey:!0}),t.forEach(function(e,t,a){o.applyNewChanges(e,t,a.length,"missing")}),this.switchChanelStatus(I.NORMAL)}else console.error("fetchAndApplyMisschangesError",a,n),this.switchChanelStatus(I.SHUTDOWN),(0,R.showCommonErrorModal1)(a);y.swReportRestart&&y.swReportRestart()}},{key:"fetchAndApplyMisschanges",value:function(e,t){y.swReportStop&&y.swReportStop(),g.default.run(S.CONFIG.FETCH_AND_APPLY_MISSCHANGES,[this.channelStatus,e,t,this.pushChangesCache.length]),this.channelStatus!==I.SHUTDOWN&&this.channelStatus!==I.FETCHING&&(g.default.monitor(33612374),this.switchChanelStatus(I.FETCHING),(0,T.getMisschange)(this.spreadSheetId,e,t,this.handleFetchResult.bind(this)))}},{key:"handleLastRervesion",value:function(e){this.currentVersion<e&&this.fetchAndApplyMisschanges(this.currentVersion+1,e)}},{key:"resetCommitingQueue",value:function(){this.deleteUserChange(this.__commitingQueue),this.__commitingQueue=null,this.commitingQueueTimeoutStatus="INIT",this.__lastCommitTime=null}},{key:"getWorkBookInfo",value:function(){return this.app.messageOfflineStore.workbookInfo}},{key:"addUserChange",value:function(e,t,a,n,o,i){var r=arguments.length>6&&void 0!==arguments[6]&&arguments[6],s=arguments.length>7&&void 0!==arguments[7]&&arguments[7],l=arguments.length>8&&void 0!==arguments[8]&&arguments[8];this.app.socket.client&&"OPENED"===this.app.socket.client.getRoomState()||(0,R.showOfflineEditingTip)();var u=null,d={sheetId:e,data:{taskId:t},isOfflineMessage:s};o&&(d.data.head=!0,d.data.oSubId=i||null,d.data.changeData=a);var c=!0;if(0===this.waitingQueue.length||t||o)u=new p.default(this.app,d),o||u.setOrAppendMutations(a),this.waitingQueue.push(u);else{var h=this.waitingQueue[this.waitingQueue.length-1];l&&h.allowAutoMerge&&h.isMutationChange()&&h.requestCount<this.maxRequestCount&&h.sheetId===e&&(u=h,c=!1),u?u.setOrAppendMutations(a):(u=new p.default(this.app,d),o||u.setOrAppendMutations(a),this.waitingQueue.push(u))}if(r||this.needKeyDataFlagMap.get(e)){var f=(0,E.createZipKeyframe)(e);this.needKeyDataFlagMap.delete(e),u.setKeyData(f||null);var _=this.app.spreadsheet.getSheetBySheetId(e);n===v.default.EXPAND_DIMENSION_REQUEST&&_&&_.isEmpty()&&(g.default.run(S.CONFIG.EMPTY_KEYFRAME_BY_AUTOEXPAND,[e]),u.setKeyData(null))}g.default.run(S.CONFIG.ADD_USER_CHANGE,[e,r,u.isWithKeyData(),o,i,a&&a.length]),c?this.app.messageOfflineStore.setData(u.key,u):this.app.messageOfflineStore.updateData(u.key,u)}},{key:"clearOfflineStore",value:function(){this.__waitingQueue=new Array,this.app.messageOfflineStore.clearWorkbookData()}},{key:"deleteUserChange",value:function(e){e&&this.app.messageOfflineStore.deleteData(e.key)}},{key:"updateBaseVersion",value:function(e){if(g.default.run(S.CONFIG.UPDATE_BASEVERSION,[this.currentVersion,e]),this.__currentVersion>e)g.default.run(S.CONFIG.UPDATE_BASEVERSION_ERROR,[this.currentVersion,e]);else{this.__currentVersion=e,this.app.messageOfflineStore.updateBaseVersion(e);for(var t=0;t<this.waitingQueue.length;t++)this.waitingQueue[t]&&(this.waitingQueue[t].baseVersion=e);if(e%50===0){var a=this.app.view.canvas.plugins;a&&a.shadowExcel&&a.shadowExcel.checkShouldUploadThumb(!0)}}}},{key:"shutDown",value:function(e){this.switchChanelStatus(I.SHUTDOWN),this.app.socket.client.shutDown(e)}},{key:"__sendChangeForTest",value:function(e,t,a){var n=null;n=new p.default(this.app,{sheetId:e}),a&&n.setKeyData(a||null),n.setOrAppendMutations(t),this.sendUserChanges(n)}},{key:"maxRequestCount",set:function(e){this.__maxRequesCount=e},get:function(){return this.__maxRequesCount}},{key:"currentVersion",get:function(){return this.__currentVersion}},{key:"commitingQueue",get:function(){return this.__commitingQueue||(this.__commitingQueue=new p.default(this.app,{sheetId:this.app.spreadsheet.activeSheet.getSheetId()})),this.__commitingQueue}},{key:"waitingQueue",get:function(){return this.__waitingQueue}}]),e}();t.default=O,O.MESSAGE_LOOP_INTERVAL=500,C([(0,A.default)(O)],O.prototype,"addUserChange",null)},1617:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__showFilterBoard=void 0;var n=r(a(172)),o=r(a(1618)),i=r(a(1624));function r(e){return e&&e.__esModule?e:{default:e}}t.__showFilterBoard=function(e){var t=e.aabb,a=e.xIndex;e.yIndex;if(n.default.sheetStatus.permission.gEditable){var r=n.default.view.canvas.excel.container.getBoundingClientRect(),s=n.default.spreadsheet,l=s.activeSheet.getBasicFilter();if(l)if(n.default.view.canvas.filterPanelShowing)n.default.view.canvas.filterPanelShowing=!1;else{n.default.view.canvas.filterPanelShowing=!0;var u=l.range,d=u.startRowIndex;u.endRowIndex,u.startColIndex,u.endColIndex;t||(t=n.default.view.canvas.excel.filterCenter._getAreaFilterBtn(a,d));var c=t[0]+r.left,h=t[1]+r.top+10;a<u.startColIndex&&(a=u.startColIndex);var f=new o.default({range:u,col:a,filter:l},s,"\n            position: fixed;\n            left:"+c+"px;\n            top:"+h+"px;\n            transform: translate(0, 10px);\n        ",n.default.view.canvas);new i.default({keepInViewport:!0,container:f.panel}).setPosition({height:10,width:10,left:c,top:h})}}}},1618:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a(14)),o=v(a(0)),i=v(a(1));a(774);var r=v(a(7)),s=v(a(1620)),l=v(a(1623)),u=a(293),d=a(776),c=a(777),h=a(292),f=a(22),p=v(a(12));function v(e){return e&&e.__esModule?e:{default:e}}r.default.window;var _=r.default.document,E=function(){function e(t,a,n,i){var r=t.range,d=t.col,c=t.filter,h=t.onClose,f=this;(0,o.default)(this,e),this.cancel=function(){f.close()},this.containerCls="filter-container",this.wrapFilterKeyWord="wrap-filter-key-word",this.resultWrapCls="dropdown-list-wrap",this.range=r,this.onClose=h,this.col=d,this.hot=a,this.renderer=i,this.currentColValue={},this.filter=c,this.addUp(),this.state={hidden:!1,tempResultList:this.result,filterResultList:this.result,keyWord:""},this.init(n),this.render(),this.childComponents=[],this.childComponents[u.CHILD_COMPONENT_ID_LIST]=new l.default({data:this.state.filterResultList,handleClickItem:this.setStateTempResultList.bind(this),handleClickSelectAll:this.setSelectAll.bind(this)},_.body.querySelector('[data-id="'+this.resultWrapCls+'"]')),this.childComponents[u.CHILD_COMPONENT_ID_INPUT]=new s.default({callback:this.filterUIStateResultList.bind(this)},_.body.querySelector('[data-id="'+this.wrapFilterKeyWord+'"]')),this.registerListener()}return(0,i.default)(e,[{key:"init",value:function(e){this.styleCssText=e}},{key:"addUp",value:function(){var e=this.filter,t=this.col,a=this.hot,n=(0,d.addUp)(e,t,a),o=n.resultList,i=n.currentColValue;this.result=o,this.currentColValue=i}},{key:"setState",value:function(e){var t=this;this.state=e,p.default.wait(0).run(function(){t.renderFilterUIStateResultList()})}},{key:"renderFilterUIStateResultList",value:function(){this.childComponents[u.CHILD_COMPONENT_ID_LIST].componentWillReceiveProps({data:this.state.filterResultList})}},{key:"filterUIStateResultList",value:function(e){var t=this.state.tempResultList.filter(function(t){return-1!==t.key.toLowerCase().indexOf(e.toLowerCase())});this.setState((0,n.default)(this.state,{filterResultList:t,keyWord:e}))}},{key:"setStateTempResultList",value:function(e){var t=this.state,a=t.tempResultList,o=t.filterResultList,i=(0,h.setStateTempResultList)({listToSet:e,tempResultList:a,filterResultList:o}),r=i.tempResultList,s=i.filterResultList;this.setState((0,n.default)(this.state,{tempResultList:r,filterResultList:s}))}},{key:"render",value:function(){var e=_.body.querySelector("."+this.containerCls);e||((e=_.createElement("div")).classList.add(this.containerCls),_.body.appendChild(e)),e.style.cssText=this.styleCssText,this.panel=e,e.innerHTML='\n            <div class="filter-panel-container" style="visibility: visible; left: 129px; top: 164px;"\n                role="menu" aria-haspopup="true" tabindex="0">\n                <div class="waffle-filtermenu" style="">\n                    <div class="waffle-filterbox-list-title" tabindex="0"\n                        role="tab" aria-expanded="true" style="">\n                        \u6392\u5e8f\n                    </div>\n                    <div class="waffle-filterbox-list-body goog-zippy-content" style="">\n                        <li>\n                            <input type="radio" name="sort" value="asc"/>  \n                            <label>\u5347\u5e8f</label>\n                        </li>\n                        <li>\n                            <input type="radio" name="sort" value="desc"/>\n                            <label>\u964d\u5e8f</label>\n                        </li>\n                    </div>\n                </div>\n                <div class="waffle-filtermenu" style="">\n                <div class="waffle-filterbox-list-title" tabindex="1"\n                    role="tab" aria-expanded="true" style="">\n                        \u6309\u641c\u7d22\u7b5b\u9009\n                </div>\n                <div class="waffle-filterbox-list-body goog-zippy-content" style="">\n                    <div class="waffle-filterbox-menu" style="">\n                        <div class="goog-menu-filter" style="">\n                            <div data-id="'+this.wrapFilterKeyWord+'" style="visibility: visible;"></div>\n                        </div>\n                        <div class="list-wrap" data-id="'+this.resultWrapCls+'">\n                        </div>\n                    </div>\n                <div class="goog-menuseparator" style=""></div>\n                <div class="waffle-filterbox-button-container" style="">\n                <div class="goog-inline-block waffle-filterbox-cancel-button" style="">\n                    <div data-id="cancel"  role="button" class="goog-inline-block jfk-button jfk-button-standard" tabindex="0" style="">\u53d6\u6d88</div>\n                </div>\n                <div class="goog-inline-block waffle-filterbox-ok-button" style="">\n                    <div data-id="confirm" role="button" class="goog-inline-block jfk-button jfk-button-action" tabindex="0" style="">\u786e\u5b9a</div>\n                </div>\n                </div>\n            </div>\n            </div>'}},{key:"registerListener",value:function(){var e=this,t=_.body.querySelector("."+this.containerCls);t.querySelector('[role="button"][tabindex="0"][data-id="confirm"]').addEventListener("click",function(t){return e.confirmHandler()}),t.querySelector('[role="button"][data-id="cancel"]').parentNode.addEventListener("click",function(t){return e.cancel()}),p.default.wait(300).run(function(){e.registerDocumentClick()}),p.default.wait(150).run(function(){e.registerDocumentOnmousewheel()}),r.default.event.default.listen("enterInputStatus",this.cancel)}},{key:"registerDocumentClick",value:function(){var e=this,t=this.panel;if(f.isPad)_.addEventListener("touchend",this._documentTouchEndHandler=this._onDocumentTouchEnd.bind(this));else{_.addEventListener("click",function a(n){if(!1!==n.isTrusted){var o=n.target;o===t||t.contains(o)||o.classList.contains("filter-span")||(_.removeEventListener("click",a),e.close())}})}}},{key:"registerDocumentOnmousewheel",value:function(){var e=this.panel;this.oldonmousewheel=_.onmousewheel,_.onmousewheel=function(t){var a=t.target;a===e||e.contains(a)||a.classList.contains("filter-span")||this.close()}.bind(this)}},{key:"_onDocumentTouchEnd",value:function(e){var t=this.panel,a=e.target;a===t||t.contains(a)||a.classList.contains("filter-span")||this.close()}},{key:"setSelectAll",value:function(){var e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).checked,t=void 0===e||e;return this.setStateTempResultList(this.state.filterResultList.map(function(e){return e.checked=t,e}))}},{key:"cancelSelectAll",value:function(){this.setStateTempResultList(this.state.filterResultList.map(function(e){return e.checked=!1,e}))}},{key:"confirmHandler",value:function(){var e=this.state,t=e.tempResultList,a=e.keyWord,n=this.hot,o=this.col,i=this.currentColValue;(0,c.filterPanelConfirmHandler)({tempResultList:t,keyWord:a,currentColValue:i,hot:n,col:o}),this.close()}},{key:"close",value:function(){try{_.body.removeChild(this.panel)}catch(e){}f.isPad?_.removeEventListener("touchend",this._documentTouchEndHandler):_.onclick=this.oldDocumentClick,r.default.event.default.remove("enterInputStatus",this.cancel),this.onClose&&this.onClose(),this.renderer.filterPanelShowing=!1,_.onmousewheel=this.oldonmousewheel}},{key:"scrollHandler",value:function(){this.close()}}]),e}();t.default=E},1619:function(e,t,a){(e.exports=a(36)(!1)).push([e.i,".filterbox-list-title {\n  font-weight: bold;\n  margin-bottom: 10px;\n}\n.goog-zippy-content {\n  height: 160px;\n  overflow: scroll;\n}\n.range-selection-footer-wrap {\n  display: flex;\n  justify-content: space-between;\n  flex-direction: row-reverse;\n  margin-top: 20px;\n}\n.range-selection-footer-wrap .button-group-wrap {\n  display: flex;\n}\n.range-selection-footer-wrap .button-group-wrap .common-button {\n  height: 34px;\n  width: 76px;\n  padding: 0;\n}\n.range-selection-footer-wrap .button-group-wrap .ml-16 {\n  margin-left: 16px;\n}\n.goog-menu-filter {\n  padding-bottom: 20px;\n}\n.filter-search-container {\n  height: 24px;\n  border-radius: 1px;\n  border: solid 1px #cecfd0;\n  display: flex;\n  align-items: center;\n}\n.filter-search-container .dropdown-search {\n  width: 100%;\n  height: 100%;\n  border-bottom: none;\n  display: flex;\n  align-items: center;\n  margin: 0 8px;\n}\n.filter-search-container .dropdown-search .dropdown-search-icon {\n  top: 0;\n  position: inherit;\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6RjlCQUEwNjJFOEY4MTFFN0JBOTI5QjczOEM0MzAyQzMiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6RjlCQUEwNjNFOEY4MTFFN0JBOTI5QjczOEM0MzAyQzMiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo1RkM5REE5QkU4ODMxMUU3QkE5MjlCNzM4QzQzMDJDMyIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo1RkM5REE5Q0U4ODMxMUU3QkE5MjlCNzM4QzQzMDJDMyIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Ppk/2BkAAAESSURBVHjapNMxSwJxGMfxuyIwEYkURRBskByEJIdcRBBBcLOGtt6MjgatvQ/HBoeChBCRdBCcBHFoicihMOz7wHNwHnfegX/4KDzPcz9P79Ew9jymSy2MEnKI4hsz9PHlF3CFW7xjohdISB4FdNHzupsyWkh59KXeRsOtGcc9Ej5fWfoPyFiFQ31vYoqhT8AKR7jEQAoH2shbhQBnoPOGPeAUHwEDZC6EY3vAj1UIcGRug197wBzZgAEyt8CfPeAFdY/Fcu6NzL06f4M3rHGzI8TU/plu5dZjlDPWJbnA0rG2adyhqI8xgpHbKkuzhqr2PnGid/qMJ1yjgsddeyMXJ3GuK+z8IFm8zr7/5Ji8/AswAPz3KpqgUCykAAAAAElFTkSuQmCC) no-repeat center center;\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n  .filter-search-container .dropdown-search .dropdown-search-icon {\n    background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMTM4IDc5LjE1OTgyNCwgMjAxNi8wOS8xNC0wMTowOTowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6NkE3OTIzN0FFRDA2MTFFN0IzMTE5NTA5MzgyNzQ4M0QiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6NkE3OTIzNzlFRDA2MTFFN0IzMTE5NTA5MzgyNzQ4M0QiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCkiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4MjUyQjcyOUVDODMxMUU3ODIzNkY5MkIxQ0YyMjU4QiIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4MjUyQjcyQUVDODMxMUU3ODIzNkY5MkIxQ0YyMjU4QiIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PhmKxAkAAAI+SURBVHja5Je7LwRRFMZ3WO8IIvFciXfCFh4JjeiEDhVRa0hQSNDqJSoFib9AhQqhoiLxKFZhF5usLBLibcMW67vJN3JtZsbs7owtnOSXu8/vfPfOnXPPKJFIxJHMSHEkOZzqC0VRfvttMWgGjaAU5PDzN3ANTsExuDWTWF155fuFvoF60AvqTE7KC9bBWaIG0sAA6BRfg3ewDzzgCjyDVFAAioAbtINsoQ92wQoIx2NALO8YqKbANtiiCaMQybtBFydwARZ4mUwbSAeToArcUyAY494q4wQKwSWYB59aBrTugkEmfwBzcSR38D9z1KiipqnbUGy4Di77IgXijQdqhKlZb8ZAHzfcDvBbcJv7uX8UahsacIFabpgNC2vNJjVrmUPXQAvHAxCy0ECImnIOTQNqofHYUHE90h7TNVDCMWCDgYBUznUNqLX9xQYDL1E5DE9DZ7KOY7Vc5tmQJzcqh6aBG73rZEFUcLw1MuDl6LbBgDsqh6aBI45tIMvC5FnUFHFoZECc8T7u1B4LDfRQ08cchnfBGpsJcZ6XW5C8jFoRav96GIk2ao/NxAjITyC5+O8otT70jnWtOrDCJkK0WVOcRTwzn6aGiEwwpPVDo5ZsnM1EIi1ZdCypG9GKpvRJKlwunaY0SI0UqSTPgtdY2/J+UGNy+c/BqtSWt4JhqcSLo3k5FgPyadnEmWo9mIiVOZEqqhwN3JAZfL+IvEexGkg0KsEEjT8i78xfPxv62Snfsd3/eQn+7dPxlwADAOeetHN3jdFvAAAAAElFTkSuQmCC) no-repeat center center;\n    background-size: 16px;\n  }\n}\n.filter-search-container .dropdown-search .search-ipt {\n  padding-left: 4px;\n  width: 100%;\n  border: 0;\n  outline: 0;\n  color: #333;\n  font-size: 14px;\n  /* FF 4-18 */\n  /* FF 19+ */\n  /* IE 10+ */\n}\n.filter-search-container .dropdown-search .search-ipt:focus::-webkit-input-placeholder {\n  color: transparent;\n}\n.filter-search-container .dropdown-search .search-ipt:focus:-moz-placeholder {\n  color: transparent;\n}\n.filter-search-container .dropdown-search .search-ipt:focus::-moz-placeholder {\n  color: transparent;\n}\n.filter-search-container .dropdown-search .search-ipt:focus:-ms-input-placeholder {\n  color: transparent;\n}\n",""])},1620:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(0)),o=u(a(1)),i=u(a(1621)),r=a(775),s=a(244),l=u(a(12));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).callback,a=arguments[1];(0,n.default)(this,e),this.callback=t,this.rootEl=a,this.search="",this.init()}return(0,o.default)(e,[{key:"init",value:function(){this.render(this.rootEl),this.registerListener(),this.callback=(0,i.default)(this.callback.bind(this),300),this.callback(this.search)}},{key:"afterRender",value:function(){var e=this;this.searchHidden||(this.timeoutAfter=l.default.wait(0).run(function(){e.inputEl.setSelectionRange(0,e.inputEl.value.length),e.inputEl.focus(),l.default.erase(e.timeoutAfter)}))}},{key:"getTemplate",value:function(){this.inputCls="search-ipt",this.searchCls="filter-search-container filter-search-container";var e="";return this.searchHidden&&(e="display:none;"),'\n      <div class="'+this.searchCls+'">\n        <div class="dropdown-search" style="'+e+'">\n          <i class="dropdown-search-icon"></i>\n          <input placeholder="" class="'+this.inputCls+'" value="'+(0,s.escapeHTML)(this.search)+'" />\n        </div>\n      </div>\n    '}},{key:"registerListener",value:function(){var e=this;this.inputEl.addEventListener("keydown",function(t){return e.onKeyDown(t)}),this.inputEl.addEventListener("input",function(t){return e.onInputSearch()})}},{key:"onInputSearch",value:function(){if(!this.searchHidden){var e=this.inputEl.value.trim();this.callback(e)}}},{key:"onKeyDown",value:function(e){var t=!0;switch(e.keyCode){case r.ENTER:case r.ARROW_UP_KEYCODE:case r.ARROW_DOWN_KEYCODE:this.childComponent&&this.childComponent.el&&this.childComponent.onKeyDown(e);break;case r.ESCAPE:t=!1;break;default:t=!0}t&&e.stopPropagation()}},{key:"render",value:function(e){e.innerHTML=this.getTemplate(),this.el=e.getElementsByClassName(this.searchCls)[0],this.inputEl=e.getElementsByClassName(this.inputCls)[0]}}]),e}();t.default=d},1621:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(1622),i=(n=o)&&n.__esModule?n:{default:n};t.default=function(e,t,a){var n=void 0,o=void 0,r=void 0,s=void 0,l=void 0,u=void 0,d=0,c=!1,h=!1,f=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function p(t){var a=n,i=o;return n=o=void 0,d=t,s=e.apply(i,a)}function v(e){var a=e-u;return void 0===u||a>=t||a<0||h&&e-d>=r}function _(){var e=Date.now();if(v(e))return E(e);l=setTimeout(_,function(e){var a=e-d,n=t-(e-u);return h?Math.min(n,r-a):n}(e))}function E(e){return l=void 0,f&&n?p(e):(n=o=void 0,s)}function T(){for(var e=Date.now(),a=v(e),i=arguments.length,r=Array(i),f=0;f<i;f++)r[f]=arguments[f];if(n=r,o=this,u=e,a){if(void 0===l)return function(e){return d=e,l=setTimeout(_,t),c?p(e):s}(u);if(h)return l=setTimeout(_,t),p(u)}return void 0===l&&(l=setTimeout(_,t)),s}return t=+t||0,(0,i.default)(a)&&(c=!!a.leading,r=(h="maxWait"in a)?Math.max(+a.maxWait||0,t):r,f="trailing"in a?!!a.trailing:f),T.cancel=function(){void 0!==l&&clearTimeout(l),d=0,n=u=o=l=void 0},T.flush=function(){return void 0===l?s:E(Date.now())},T}},1622:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(25),i=(n=o)&&n.__esModule?n:{default:n};t.default=function(e){var t="undefined"===typeof e?"undefined":(0,i.default)(e);return null!=e&&("object"==t||"function"==t)}},1623:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=a(244),r=s(a(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t,a){(0,n.default)(this,e),this.props=t,this.rootEl=a,this.render(),this.registerListener()}return(0,o.default)(e,[{key:"componentWillReceiveProps",value:function(e){this.props=e,this.render()}},{key:"getTemplate",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.props.data)return"";var e="filter_panel_selectAll",t="\u5168\u9009",a=this.props.data.filter(function(e){return!!e.visible}).length===this.props.data.length&&0!==this.props.data.length,n=e;return"\n    "+(0!==this.props.data.length?'\n<li class="li-checkbox waffle-filterbox-content  setSelectAll" data-type="setSelectAll" style="display:flex">\n    <input class="styled-checkbox" type="checkbox" value="'+(0,i.escapeHTML)(e)+'" id="'+n+'" '+(a?"checked":"")+' >\n    <label  for="'+n+'" class="filter-item-num" title="'+(0,i.escapeHTML)(t)+'">'+((0,i.escapeHTML)(t)||(0,i.escapeHTML)(e)||"\uff08\u7a7a\u767d\u5355\u5143\u683c\uff09")+"</label>\n</li>\n":'<div class="empty-wrap"><div  class="empty-wording">\u6ca1\u6709\u5339\u914d\u7684\u6570\u636e</div></div>')+"\n"+this.props.data.map(function(e,t){var a=e.key||"\uff08\u7a7a\u767d\u5355\u5143\u683c\uff09";return'\n<li class="li-checkbox waffle-filterbox-content 222" data-type="checkbox" style="display:flex" >\n    <input class="styled-checkbox" type="checkbox" value="'+(0,i.escapeHTML)(e.key)+'" id="'+t+'" '+(e.visible?"checked":"")+'>\n    <label for="'+t+'" class="filter-item-num" title="'+(0,i.escapeHTML)(a)+'"><span class="value-span">'+(0,i.escapeHTML)(a)+"</span></label>\n</li>\n"}).join("")+"\n    "}},{key:"render",value:function(){this.rootEl.innerHTML=this.getTemplate(this.props.data)}},{key:"registerListener",value:function(){var e=this,t=this.props.handleClickItem,a=void 0===t?function(){}:t,n=this.rootEl,o=this.props.handleClickSelectAll,i=void 0===o?function(){}:o;n.addEventListener("click",function(t){for(var o=t.target;-1===o.className.indexOf("222");){if(o===n){o=null;break}o=o.parentNode}o&&(o=o.querySelector("input"))&&r.default.wait(0).run(function(){a([{key:e.props.data[o.getAttribute("id")].key,checked:o.checked}])})}),n.addEventListener("click",function(e){for(var t=e.target;-1===t.className.indexOf("setSelectAll");){if(t===n){t=null;break}t=t.parentNode,console.log(t)}t&&(t=t.querySelector("input"))&&r.default.wait(0).run(function(){i({checked:t.checked})})})}},{key:"close",value:function(){}}]),e}();t.default=l},1624:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=a(439),r=a(1625);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{parent:null,name:null,className:"",keepInViewport:!0,container:null};(0,n.default)(this,e),this.options=t,this.container=this.options.container}return(0,o.default)(e,[{key:"isSubMenu",value:function(){return!1}},{key:"setPosition",value:function(e){var t=new r.Cursor(e);this.options.keepInViewport?(t.fitsBelow(this.container)?this.setPositionBelowCursor(t):t.fitsAbove(this.container)?this.setPositionAboveCursor(t):this.setPositionBelowCursor(t),t.fitsOnRight(this.container)?this.setPositionOnRightOfCursor(t):t.fitsOnLeft(this.container)?this.setPositionOnLeftOfCursor(t):this.setPositionOnRightOfCursor(t)):(this.setPositionBelowCursor(t),this.setPositionOnRightOfCursor(t))}},{key:"setPositionAboveCursor",value:function(e){var t=e.top-this.container.offsetHeight;this.isSubMenu()&&(t=window.scrollY+e.top+e.cellHeight-this.container.offsetHeight+3),this.container.style.top=t+"px"}},{key:"setPositionBelowCursor",value:function(e){var t=e.top-1;this.isSubMenu()&&(t=e.top+window.scrollY-1),this.container.style.top=t+"px"}},{key:"setPositionOnRightOfCursor",value:function(e){var t=void 0;t=this.isSubMenu()?window.scrollX+1+e.left+e.cellWidth:1+e.left,this.container.style.left=t+"px"}},{key:"setPositionOnLeftOfCursor",value:function(e){this.container.style.left=e.left-this.container.offsetWidth+(0,i.getScrollbarWidth)()+4+"px"}}]),e}();t.default=l},1625:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Cursor=void 0;var n=s(a(0)),o=s(a(1)),i=a(439),r=a(1626);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,n.default)(this,e);var a,o,s,l,u=(0,i.getWindowScrollTop)(),d=(0,i.getWindowScrollLeft)(),c=0,h=0,f=void 0,p=void 0;this.type=this.getSourceType(t),"literal"===this.type?(c=parseInt(t.top,10),h=parseInt(t.left,10),f=t.height,p=t.width):"event"===this.type&&(c=parseInt((0,r.pageY)(t),10),h=parseInt((0,r.pageX)(t),10),f=t.target.clientHeight,p=t.target.clientWidth),a=c-u,o=h-d,s=u,l=d,this.top=c,this.topRelative=a,this.left=h,this.leftRelative=o,this.scrollTop=s,this.scrollLeft=l,this.cellHeight=f,this.cellWidth=p}return(0,o.default)(e,[{key:"getSourceType",value:function(e){var t="literal";return e instanceof Event&&(t="event"),t}},{key:"fitsAbove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.topRelative>=t+e.offsetHeight}},{key:"fitsBelow",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerHeight;return this.topRelative+e.offsetHeight+this.cellHeight<=t}},{key:"fitsOnRight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=t}},{key:"fitsOnLeft",value:function(e){return this.leftRelative>=e.offsetWidth}},{key:"fitsAlignRight",value:function(e){return this.leftRelative+this.cellWidth>=e.offsetWidth}},{key:"fitsAlignLeft",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.innerWidth;return this.leftRelative+e.offsetWidth<=t}}]),e}();t.Cursor=l},1626:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.pageX=function(e){if(e.pageX)return e.pageX;var t=(0,n.getWindowScrollLeft)();return e.clientX+t},t.pageY=function(e){if(e.pageY)return e.pageY;var t=(0,n.getWindowScrollTop)();return e.clientY+t};var n=a(439)},1627:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=g(a(47)),o=g(a(63)),i=g(a(0)),r=g(a(1)),s=g(a(1628)),l=g(a(1630)),u=a(752),d=g(u),c=a(438),h=a(193),f=g(a(7)),p=a(412),v=a(411),_=g(a(172)),E=g(a(8)),T=a(26),m=a(165);function g(e){return e&&e.__esModule?e:{default:e}}var S=f.default.window,R=function(){function e(t){(0,i.default)(this,e),this.status=p.OfflineStoreStatus.CLOSE,this.isShield=!0,this.offlineChangesWhenPageLoad=[],t.baseVersion=t.baseVersion||0,this.setProperties(t)}return(0,r.default)(e,[{key:"setProperties",value:function(e){var t=this;this.app=e.app,this.globalPadId=e.globalPadId,this.userDomain=e.userDomain,this.userId=e.userId,this.baseVersion=e.baseVersion,this.userDomain=e.userDomain,this.isNeedInitOfflineData=e.isNeedInitOfflineData||!0,this.status=p.OfflineStoreStatus.INITING,this.store=new l.default(e.app,function(e,a){t.status=e?p.OfflineStoreStatus.OPEN:"string"===typeof a&&"notSupportIndexedDB"===a?p.OfflineStoreStatus.NOT_SUPPORT:p.OfflineStoreStatus.INIT_FAILED,t.afterInitIndexedDB()})}},{key:"afterInitIndexedDB",value:function(){if(this.workbookInfo||(E.default.run(T.CONFIG.INIT_OFFLINE_STORE_ERROR,[this.globalPadId,this.userId,this.userDomain,this.status]),this.status=p.OfflineStoreStatus.INIT_FAILED,console.error("globalPadId or userId can not be null")),this.hotFixUserDomainData(),this.isNeedInitOfflineData){var e=new o.default;e.set("status",u.UserChangeStatus.COMMITING),this.getWorkBookOfflineData(e,function(e,t){if(E.default.run(T.CONFIG.GET_OFFLINE_DATA,[e,t&&t.length]),e&&t&&t.length>0){var a=t[0];a.isOfflineMessage=!0;var n=new d.default(this.app,a);this.offlineChangesWhenPageLoad.push(n)}}.bind(this)),(e=new o.default).set("status",u.UserChangeStatus.WATING),this.getWorkBookOfflineData(e,function(e,t){var a=this;E.default.run(T.CONFIG.GET_OFFLINE_DATA_WAITING_QUEUE,[e,t&&t.length]),e&&t&&t.length>0&&(t.sort(d.default.compare),t.forEach(function(e){e.isOfflineMessage=!0;var t=new d.default(a.app,e);a.offlineChangesWhenPageLoad.push(t)})),this.afterReadOfflineChanges()}.bind(this))}}},{key:"afterReadOfflineChanges",value:function(){this.handleLocalOfflineChanges()}},{key:"handleLocalOfflineChanges",value:function(){var e=this;if(0!==this.offlineChangesWhenPageLoad.length){S.swReportStop&&S.swReportStop(),this.toastTips=s.default.show({content:"\u79bb\u7ebf\u6570\u636e\u540c\u6b65\u4e2d\uff0c\u8bf7\u7a0d\u540e...",mask:!0,visible:!0});var t=0;this.offlineChangesWhenPageLoad.length>0&&(t=this.offlineChangesWhenPageLoad[0].baseVersion),t<this.baseVersion?new n.default(function(a,n){(0,c.getMisschange)(e.globalPadId,t+1,e.baseVersion,function(e,t,o,i){e?a(t):n(o)})}).catch(function(t){console.error("\u79bb\u7ebf\u63d0\u4ea4\u524d\u8865\u62c9misschange\u5e94\u7528\u9519\u8bef\u3002",t),e.toastTips.close(),(0,m.showCommonErrorModal1)("N1000")}).then(function(t){E.default.jank.log({moduleValue:"messageOfflineStore",actionValue:"followAndApply",lockJankKey:!0}),t.map(function(t){var a=t.head?"[[]]":t.changeset,n={sheetId:t.sheetId,baseVersion:t.newVersion,data:{mutations:JSON.parse(a),head:t.head,changeData:t.head?t.changeset:void 0,taskId:t.commitId}};return new d.default(e.app,n)}).forEach(function(t){if(t.isMutationChange())for(var a=(0,h.deSerializeRequests)(t.mutations),n=0;n<e.offlineChangesWhenPageLoad.length;n++){var o=e.offlineChangesWhenPageLoad[n];if(t.sheetId===o.sheetId&&o.isMutationChange()&&o.mutations.length>0){var i=(0,h.followRequestMutations)(a,o.mutations,!1);e.offlineChangesWhenPageLoad[n].mutations=i}e.offlineChangesWhenPageLoad[n].baseVersion=t.baseVersion,e.offlineChangesWhenPageLoad[n].setKeyData(null)}}),e.applyLocalOfflineChanges(e.offlineChangesWhenPageLoad)}):t===this.baseVersion?(this.applyLocalOfflineChanges(this.offlineChangesWhenPageLoad),E.default.jank.log({moduleValue:"messageOfflineStore",actionValue:"apply",lockJankKey:!0})):console.error("\u672c\u5730\u79bb\u7ebf\u6570\u636e\u7248\u672c\u5927\u4e8e\u670d\u52a1\u5668\u7248\u672c")}}},{key:"applyLocalOfflineChanges",value:function(e){var t=this;e.forEach(function(e){e.status=u.UserChangeStatus.WATING,t.updateData(e.key,e),t.app.messageOfflineStore.deleteData(e.key),e.isMutationChange()?e.mutations.forEach(function(a){t.app.messageCenter.addUserChange(e.sheetId,e.taskId,a,-1,e.head,e.originSheetId,!1,!0,!0)}):t.app.messageCenter.addUserChange(e.sheetId,e.taskId,e.changeData,-1,e.head,e.originSheetId,!1,!0,!0),e.apply()}),this.toastTips.close(),S.swReportRestart&&S.swReportRestart()}},{key:"updateBaseVersion",value:function(e){this.baseVersion=e}},{key:"hotFixUserDomainData",value:function(){var e=arguments;if(this.isAvailable&&this.userDomain)try{this.store.changeDataKey(this.globalPadId+"_"+this.userDomain,this.globalPadId+"_"+this.userId,function(){console.log(e)})}catch(t){E.default.run(T.CONFIG.CHANGEDATAKEY_CATCH_ERROR,[t&&t.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}},{key:"setData",value:function(e,t,a){if(!this.isShield&&this.isAvailable){t.baseVersion=this.baseVersion,t.workbook=this.workbookInfo;try{this.store.set(e,t.storeData,a)}catch(n){E.default.run(T.CONFIG.SETDATA_CATCH_ERROR,[n&&n.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}}},{key:"updateData",value:function(e,t,a){if(!this.isShield&&this.isAvailable){t.baseVersion=this.baseVersion;try{this.store.update(e,t.storeData,!0,a)}catch(n){E.default.run(T.CONFIG.UPDATEDATA_CATCH_ERROR,[n&&n.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}}},{key:"deleteData",value:function(e,t){if(this.isAvailable)try{this.store.delete(e,t)}catch(a){E.default.run(T.CONFIG.DELETEDATA_CATCH_ERROR,[a&&a.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}},{key:"clearWorkbookData",value:function(e){if(this.isAvailable)try{this.store.clear(this.workbookInfo,e)}catch(t){E.default.run(T.CONFIG.CLEARDATA_CATCH_ERROR,[t&&t.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}},{key:"getWorkBookOfflineData",value:function(e,t){if(this.isAvailable)try{this.store.get({key:"workbook",value:this.workbookInfo},e,t)}catch(a){E.default.run(T.CONFIG.GETDATA_CATCH_ERROR,[a&&a.stack]),this.status=p.OfflineStoreStatus.ERROR,(0,v.checkOfflinePattern)(_.default)}}},{key:"workbookInfo",get:function(){return this.globalPadId&&this.userId?this.globalPadId+"_"+this.userId:null}},{key:"isAvailable",get:function(){return this.status===p.OfflineStoreStatus.OPEN&&null!==this.workbookInfo}},{key:"isBrowserSupportIndexedDB",get:function(){return this.status!==p.OfflineStoreStatus.INITING&&this.status===p.OfflineStoreStatus.NOT_SUPPORT||!0}}]),e}();t.default=R},1630:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(16)),o=f(a(0)),i=f(a(1)),r=f(a(1631)),s=f(a(7)),l=a(412),u=f(a(172)),d=a(411),c=f(a(8)),h=a(26);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t,a){(0,o.default)(this,e),this.DB_NAME=r.default.OFFLINE_DB_NAME,this.TABLE_NAME_PREFIX=r.default.OFFLINE_TABLE_NAME,this.app=t,this.init(a)}return(0,i.default)(e,[{key:"init",value:function(t){this.__indexedDB=s.default.window.indexedDB||s.default.window.mozIndexedDB||s.default.window.webkitIndexedDB||s.default.window.msIndexedDB;var a=this;if(!this.__indexedDB)return a.database=null,"function"===typeof t&&t(!1,"notSupportIndexedDB"),void c.default.run(h.CONFIG.NOT_SUPPORT_INDEXEDDB);var n=void 0;try{n=this.__indexedDB.open(this.DB_NAME,e.DB_VERSION)}catch(o){return a.database=null,"function"===typeof t&&t(!1,o.name||o.message||""),void c.default.run(h.CONFIG.OPEN_INDEXED_DB,o)}n.onerror=function(e){a.database=null,"function"===typeof t&&t(!1,e),c.default.run(h.CONFIG.NOT_SUPPORT_INDEXEDDB_2,e.target.error),a.app.messageOfflineStore&&(a.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))},n.onsuccess=function(e){a.database=n.result,"function"===typeof t&&t(!0,e),c.default.run(h.CONFIG.NOT_SUPPORT_INDEXEDDB_3)},n.onupgradeneeded=function(e){var t=e.target.result;if(t){if(!t.objectStoreNames.contains(a.tableName)){var n=t.createObjectStore(a.tableName,{keyPath:"key"});n.createIndex("key","key",{unique:!0}),n.createIndex("workbook","workbook",{unique:!1})}var o=e.target.transaction;if(o){var i=o.objectStore(a.tableName);i.indexNames.contains("time")&&i.deleteIndex("time"),i.indexNames.contains("data")&&i.deleteIndex("data"),o.oncomplete=function(e){c.default.run(h.CONFIG.UPDATE_INDEXED_DB,["indexedDB updated.",e])}}}}}},{key:"set",value:function(e,t,a){var o=this;if(this.database&&e){var i=this.database.transaction([this.tableName],"readwrite").objectStore(this.tableName);i.delete(e);var r=i.add({key:e,workbook:t.workbook,time:t.time||0,data:(0,n.default)(t)});r.onsuccess=function(t){c.default.run(h.CONFIG.INDEXDB_SET_VALUE,["indexedDB setValue.",e]),"function"===typeof a&&a(!0,t)},r.onerror=function(n){var i=n.target.error,r=i.code,s=i.message,f=i.name;c.default.run(h.CONFIG.INDEXDB_SET_VALUE_ONERROR,["indexedDB setValue.",e,t,r,s,f]),"function"===typeof a&&a(!1,n),o.app.messageOfflineStore&&(o.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))}}else c.default.run(h.CONFIG.STORE_UNVALIABLE_WHEN_SET,["arguments is no valid when set",e,this.database])}},{key:"changeDataKey",value:function(e,t,a){var o=this,i=this.database.transaction([this.tableName],"readwrite"),r=i&&i.objectStore&&i.objectStore(this.tableName),s=r&&r.openCursor(),f=r&&r.index("workbook");(s=f&&f.openCursor(IDBKeyRange.only(e))).onerror=function(e){"function"===typeof a&&a(!1,e),o.app.messageOfflineStore&&(o.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))},s.onsuccess=function(a){var i=a.target.result;if(i){var s=i.value.data,f=JSON.parse(s);f.key=t+"_"+f.sheetId+"_"+f.time,f.workbook=t,r.delete(i.primaryKey),r.add({key:f.key,workbook:f.workbook,time:f.time||0,data:(0,n.default)(f)}).onerror=function(a){var n=a.target.error,i=n.code,r=n.message,s=n.name;c.default.run(h.CONFIG.CHANGE_DATAKEY,[e,t,this.database,i,r,s]),o.app.messageOfflineStore&&(o.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))},i.continue()}}}},{key:"update",value:function(e,t,a,o){if(e&&this.database&&this.database.transaction){var i=this.database.transaction([this.tableName],"readwrite"),r=i&&i.objectStore&&i.objectStore(this.tableName),s=IDBKeyRange&&IDBKeyRange.only(e),f=r&&r.openCursor(s);if(f){var p=this;f.onsuccess=function(i){var r=i.target.result;if(r){var s=r.update({key:e,workbook:t.workbook,time:t.time||0,data:(0,n.default)(t)});s.onsuccess=function(t){c.default.run(h.CONFIG.INDEXEDDB_UPDATE_VALUE_2,["indexedDB updateValue. success.",e]),"function"===typeof o&&o(!0,t)},s.onerror=function(a){var n=a.target.error,i=n.code,r=n.message,s=n.name;c.default.run(h.CONFIG.INDEXEDDB_UPDATE_VALUE_3,["indexedDB updateValue. error.",e,t,i,r,s]),"function"===typeof o&&o(!1,a),p.app.messageOfflineStore&&(p.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))}}else!0===a&&p.set(e,t,o)},f.onerror=function(a){var n=a.target.error,i=n.code,r=n.message,s=n.name;c.default.run(h.CONFIG.INDEXEDDB_UPDATE_VALUE_4,["indexedDB updateValue. cursor error.",e,t,i,r,s]),"function"===typeof o&&o(!1,a),p.app.messageOfflineStore&&(p.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))}}else c.default.run(h.CONFIG.INDEXEDDB_UPDATE_VALUE,["indexedDB updateValue. cursor open failed.",e,t])}else c.default.run(h.CONFIG.STORE_UNVALIABLE_WHEN_UPDATE,["arguments is no valid when update",e,this.database])}},{key:"delete",value:function(e,t){var a=this;if(e&&this.database&&this.database.transaction){var n=this.database.transaction([this.tableName],"readwrite"),o=n&&n.objectStore&&n.objectStore(this.tableName),i=o&&o.delete(e);i.onerror=function(n){var o=n.target.error,i=o.code,r=o.message,s=o.name;c.default.run(h.CONFIG.DELETE_VALUE,["indexedDB deleteValue. error.",e,i,r,s]),"function"===typeof t&&t(!1,n),a.app.messageOfflineStore&&(a.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))},i.onsuccess=function(a){c.default.run(h.CONFIG.DELETE_VALUE_2,["indexedDB deleteValue. success.",e]),"function"===typeof t&&t(!0,a)}}else c.default.run(h.CONFIG.DELETE_DATA_ERROR,["arguments is no valid when deleteData",e,this.database])}},{key:"clear",value:function(e,t){var a=this;if(e&&this.database&&this.database.transaction){var n=this.database.transaction([this.tableName],"readwrite"),o=n&&n.objectStore&&n.objectStore(this.tableName),i=o&&o.openCursor(),r=o&&o.index("workbook");(i=r&&r.openCursor(IDBKeyRange.only(e))).onerror=function(n){var o=n.target.error,i=o.code,r=o.message,s=o.name;c.default.run(h.CONFIG.CLEAR_DATA,["indexedDB clearData. error.",e,i,r,s]),"function"===typeof t&&t(!1,n),a.app.messageOfflineStore&&(a.app.messageOfflineStore.status=l.OfflineStoreStatus.ERROR,(0,d.checkOfflinePattern)(u.default))},i.onsuccess=function(a){var n=a.target.result;n?(o.delete(n.primaryKey),n.continue()):(c.default.run(h.CONFIG.CLEAR_DATA_2,["indexedDB clearData. success.",e]),"function"===typeof t&&t(!0,a))}}else c.default.run(h.CONFIG.CLEAR_DATA_ERROR,["arguments is no valid when clearData",e,this.database])}},{key:"get",value:function(e,t,a){if(e&&this.database&&this.database.transaction){var n=this.database.transaction([this.tableName]),o=n&&n.objectStore&&n.objectStore(this.tableName),i=void 0;if("string"===typeof e)i=o&&o.get(e);else{var r=e.key,s=e.value,l=o&&o.index(r);i=l&&l.openCursor(IDBKeyRange.only(s))}if(i){i.onerror=function(t){var n=t.target.error,o=n.code,i=n.message,r=n.name;c.default.run(h.CONFIG.GET_DATA_ERROR_2,["indexedDB getData. error.",e,o,i,r]),"function"===typeof a&&a(!1,t)};var u=new Array,d=!1;i.onsuccess=function(n){var o=n.target.result;if(o){var i=o.value.data,r=!0,s=JSON.parse(i);t&&t.forEach(function(e,t){s[t]!==e&&(r=!1)}),r&&(u.push(s),d=!0),o.continue()}else c.default.run(h.CONFIG.GET_DATA_SUCC,["indexedDB getData. success.",e]),"function"===typeof a&&a(!0,u,d)}}else c.default.run(h.CONFIG.GET_DATA,["indexedDB getData. error. request is not valid",e])}else c.default.run(h.CONFIG.GET_DATA_ERROR,["arguments is no valid when getData",e,this.database])}},{key:"tableName",get:function(){return this.TABLE_NAME_PREFIX+"_offline"}}]),e}();p.DB_VERSION=1,t.default=p},1631:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={OFFLINE_DB_NAME:"TENCENT_DOCS_OFFLINE_STORE",OFFLINE_TABLE_NAME:"local_workbook"}},1634:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(1635);Object.defineProperty(t,"default",{enumerable:!0,get:function(){return(e=n,e&&e.__esModule?e:{default:e}).default;var e}})},1635:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(0)),o=h(a(1)),i=h(a(7)),r=a(22),s=a(71),l=a(671),u=a(445),d=h(a(8)),c=a(26);function h(e){return e&&e.__esModule?e:{default:e}}var f=r.browser.isMobile,p=r.browser.isWxMiniProgram;function v(e,t){t=(t||"t")+"=";var a=new RegExp(t+"\\d+"),n=Number(new Date);if(e.indexOf(t)>-1)return e.replace(a,t+n);if(e.indexOf("?")>-1){var o=e.split("?");return o[1]?o[0]+"?"+t+n+"&"+o[1]:o[0]+"?"+t+n}return e.indexOf("#")>-1?e.split("#")[0]+"?"+t+n+location.hash:e+"?"+t+n}var _=function(){function e(t){var a=this;(0,n.default)(this,e),this.init=function(){0===$("#auth-change-dialog").length&&$('<div id="auth-change-dialog" class="modaldialog"><div class="modal-tip tip-toast">\u4f60\u5728\u6b64\u8868\u683c\u7684\u6743\u9650\u5df2\u53d1\u751f\u53d8\u5316\uff0c\u70b9\u51fb<span class="refresh">\u5237\u65b0</span>\u3002</div></div>').appendTo(document.body),0===$("#mainmodals").length&&$('\n            <div id="mainmodals">\n                <div id="connectionbox" class="modaldialog">\n                    <div class="disconnected tip-toast">\u5f53\u524d\u7f51\u7edc\u5f02\u5e38\uff0c\u8bf7\u68c0\u67e5\u7f51\u7edc\u540e\uff0c\u70b9\u51fb<span class="reconnect">\u91cd\u65b0\u8fde\u63a5</span>\u3002</div>\n                    <div class="loading-connect tip-toast">\u6b63\u5728\u8fde\u63a5\u7f51\u7edc\uff0c\u8bf7\u7a0d\u5019...</div>\n                    <div class="connect-fail tip-toast">\u8fde\u63a5\u5931\u8d25\uff0c\u70b9\u51fb<span class="reconnect">\u91cd\u65b0\u8fde\u63a5</span>\u3002</div>\n                </div>\n                <div id="freakout-dialog" class="modaldialog">\n                    <div class="disconnected tip-toast" contenteditable="false">\u6587\u6863\u72b6\u6001\u6709\u66f4\u65b0\uff0c\u70b9\u51fb<span class="refresh">\u5237\u65b0</span>\u3002</div>\n                </div>\n            </div>\n            ').appendTo(document.body),$(".reconnect").click(function(){p?window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent(v(window.location.href,"rtime"))}):window.location.href=v(window.location.href,"rtime")}),$(".refresh").click(function(){p?window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent(v(window.location.href,"rtime"))}):window.location.href=v(window.location.href,"rtime")}),$("#connectionbox .dialog-cancel-x").on("click",function(){$("#modaloverlay").hide(),$("#connectionbox").addClass("compact"),$(".connection-status").hide()}),$("#freakout-copy-first").on("click",function(){$("#modaloverlay").hide(),$("#freakout-dialog").addClass("compact"),$("#freakout-copy-first").hide(),$(".connection-status").hide()}),$("#mainmodals").on("click",".reload",function(){location.reload()}),$("#mainmodals").on("click",".download",a.exportSheetData)},this.exportSheetData=function(){i.default.window.CoreSheet.export.exportSheetData(),d.default.monitor(33534178)},this.socketOpenHideDOM=function(){if($("#connectionbox").removeClass("compact"),$(".connection-status").hide(),$("#modaloverlay").hide(),$("#connectionbox").hide(),!f)try{window.external.setNetworkEnable("1")}catch(e){console.log("setNetworkEnable fail")}},this.showOfflineTip=function(){if((0,s.hideToast)(),$(".preview-page").length){var e={};e["margin-left"]="-"+$("#recordbar").css("width"),(0,s.showToast)("\u7f51\u7edc\u5f02\u5e38\u3002\u8fdb\u5165\u79bb\u7ebf"+(a.app.sheetStatus.permission.gEditable?"\u7f16\u8f91":"\u67e5\u770b")+"\u6a21\u5f0f\uff0c\u6682\u4e0d\u652f\u6301\u5386\u53f2\u7248\u672c\u7684\u67e5\u770b\u548c\u6062\u590d\u3002",e,{isWarnning:!0,toastType:"typeWarning"})}else a.app.sheetStatus.permission.gEditable?f?(0,s.showToast)("\u7f51\u7edc\u5f02\u5e38\uff0c\u79bb\u7ebf\u7f16\u8f91\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",{top:"48px"},{isWarnning:!0,supportMobile:!0,toastType:"typeWarning"}):(0,s.showToast)("\u7f51\u7edc\u5f02\u5e38\u3002\u8fdb\u5165\u79bb\u7ebf\u7f16\u8f91\u6a21\u5f0f\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",!1,{isWarnning:!0,toastType:"typeWarning"}):(0,s.showToast)("\u79bb\u7ebf\u67e5\u770b\u4e2d\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",!1,{toolToastCloseTime:5e3,supportMobile:!0,toastType:"typeWarning"})},this.app=t}return(0,o.default)(e,[{key:"showNetworkErrorModal",value:function(){if((0,s.hideToast)(),!f)try{window.external.setNetworkEnable("0")}catch(e){console.log("setNetworkEnable fail")}(0,l.showModal)("#connectionbox",500,!0)}},{key:"showReloadTip",value:function(e){d.default.run(c.CONFIG.RELOAD_TIP,e),e||(e=""),e=(0,u.escapeHTML)(e);var t=$("#mainmodals");t.find("#commit-error-dialog");$('<div id="commit-error-dialog" class="modaldialog modal-ready"><div class="disconnected tip-toast" contenteditable="false" >\u6587\u6863\u72b6\u6001\u6709\u66f4\u65b0\uff0c<span class="tendoc-blue-text reload">\u70b9\u51fb\u5237\u65b0</span>\u3002\uff08\u9519\u8bef\u7801\uff1a'+e+"\uff09</div> </div>").appendTo(t),(0,l.showModal)("#commit-error-dialog",500,!0),window.delTcntDocData&&window.delTcntDocData()}}]),e}();t.default=_},1636:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,a,n){var o,i=e.getSheetBySheetId(t),r=void 0;return i||(i=e.createSheet(t,""),e.insertSheet(i)),e.reInitSheetBySheetId(t),e.parent.getCurrentMainThreadWorker().sheetData.clearAndReInitOneSheet({sheetId:t}),e.parent.calcController.resetSheet(t),r=e.getSheetBySheetId(t),e.parent.handleData.transformSpreadsheet(r,a),e.reInitSheetBySheetId(t),e.parent.getCurrentMainThreadWorker().sheetData.clearAndReInitOneSheet({sheetId:t}),e.parent.calcController.resetSheet(t),o=e.getSheetBySheetId(t),e.parent.handleData.transformSpreadsheet(o,n),r.equal(o)}},1637:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if((0,n.getCookie)("dev_route_id"))return!0;return!1};var n=a(124)},1638:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(112),o=f(a(490)),i=f(a(230)),r=f(a(765)),s=f(a(95)),l=f(a(121)),u=f(a(115)),d=f(a(11)),c=f(a(35)),h=a(1640);function f(e){return e&&e.__esModule?e:{default:e}}var p={mergeCells:n.mergeCells,unmergeCells:n.unmergeCells,insertRows:n.insertRows,insertColumns:n.insertColumns,hideRows:n.hideRows,hideColumns:n.hideColumns,showRows:n.showRows,showColumns:n.showColumns,deleteRows:n.deleteRows,deleteColumns:n.deleteColumns,resizeRows:n.resizeRows,resizeColumns:n.resizeColumns,moveRows:n.moveRows,moveColumns:n.moveColumns,reorder:n.reorder,freeze:n.freeze,userEnter:n.userEnter,userRangeEnter:n.userRangeEnter,addImage:n.addImage,updateImage:n.updateImage,deleteImage:n.deleteImage,insertLink:n.insertLink,fontBold:n.fontBold,setLink:n.setLink,clearLink:n.clearLink,autoWrap:n.autoWrap,fontItalics:n.fontItalics,fontUnderLine:n.fontUnderLine,fontStrike:n.fontStrike,setFontFamliy:n.setFontFamliy,setFontSize:n.setFontSize,setFontColor:n.setFontColor,setBorder:n.setBorder,insertFunction:n.inserFunction,setVerticalAlign:n.setVerticalAlign,setHorizontalAlign:n.setHorizontalAlign,clearFormat:n.clearFormat,clearContent:n.clearContent,numberFormat:n.numberFormat,decreaceDecimal:n.decreaceDecimal,increaceDecimal:n.increaceDecimal,replace:n.replace,smartSelection:n.smartSelection,setBasicFilter:n.setBasicFilter,clearBasicFilter:n.clearBasicFilter,updateFilterCriteria:n.updateFilterCriteria,applyPasteData:n.applyPasteData,insideSheetCopyPaste:n.insideSheetCopyPaste,undo:n.undo,redo:n.redo,search:function(){window.SpreadsheetApp.view.plugins.searchReplacePanel.create()},SpreadsheetApp:o.default,Spreadsheet:i.default,Sheet:r.default,TextFormat:s.default,NumberFormat:l.default,Color:u.default,GridRange:d.default,DimensionRange:c.default,runMutationData:h.runMutationData,addConditionFormat:n.addConditionFormat,deleteConditionFormat:n.deleteConditionFormat,updateConditionFormat:n.updateConditionFormat};t.default=p},1639:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(3)),o=d(a(0)),i=d(a(1)),r=d(a(4)),s=d(a(5)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(46)),u=d(a(40));function d(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.firstClick=!1,a.state={width:0,isActived:!1,val:e.val},a.oldValue=e.val,a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"componentWillReceiveProps",value:function(e){this.state.val=e.val}},{key:"componentDidMount",value:function(){var e=this;u.default.sheetsBar.listen("startReName",function(t){t===e.props.id&&(e.firstClick=!0)})}},{key:"componentDidUpdate",value:function(){this.props.renameSheetId===this.props.id&&this.firstClick&&(this.dom.focus(),this.dom.select(),this.firstClick=!1)}},{key:"changeValue",value:function(e){var t=e.target,a=u.default.sheetsBar;this.state.val=t.value,a.trigger("reNaming",this.props.index,this.state.val)}},{key:"rename",value:function(e){if(!this.props.readonly){var t=u.default.sheetsBar;this.firstClick=!0,t.trigger("startReName",this.props.id)}}},{key:"blur",value:function(e){if(this.props.renameSheetId===this.props.id)return this.state.val===this.oldValue?this.cancel():void this.submit()}},{key:"submit",value:function(){u.default.sheetsBar.trigger("reNameDone",this.props.id,this.state.val)}},{key:"cancel",value:function(){u.default.sheetsBar.trigger("reNameDone",this.props.id,this.state.val)}},{key:"keydown",value:function(e){var t=this.props.renameSheetId===this.props.id;if(13===e.keyCode&&t)return this.submit()}},{key:"mousedown",value:function(e){this.props.renameSheetId===this.props.id&&e.stopPropagation()}},{key:"render",value:function(){var e=this,t=this.props.renameSheetId===this.props.id,a=!t,n=t?"rename":"";return l.createElement("input",{onMouseDown:this.mousedown.bind(this),ref:function(t){e.dom=t},maxLength:32,className:"sheet-tab-name "+n,value:this.props.val,readOnly:a,style:{width:this.props.inputWidth},onChange:this.changeValue.bind(this),onDoubleClick:this.rename.bind(this),onBlur:this.blur.bind(this),onKeyDown:this.keydown.bind(this)})}}]),t}(l.Component);t.default=c},1640:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.runMutationData=function(e,t){if(!e||!t)return;var a=JSON.parse(t),n=window.SpreadsheetApp.spreadsheet.getSheetBySheetId(e);if(n)for(var o=0;o<a.length;o++)(0,i.default)(n,a[o])};var n,o=a(667),i=(n=o)&&n.__esModule?n:{default:n}},1641:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(16)),o=p(a(0)),i=p(a(1)),r=a(755),s=p(a(362)),l=a(181),u=p(a(8)),d=a(510),c=p(a(7)),h=p(a(1644)),f=a(26);function p(e){return e&&e.__esModule?e:{default:e}}var v=window;var _=function(){function e(t){(0,o.default)(this,e),this.parent=t,this.styleDetail=[]}return(0,i.default)(e,[{key:"export",value:function(e){e.type;var t=e.onSuccess,a=e.onFail,n=e.onChange,o=(new Date).getTime(),i=new h.default({file:this,app:this.parent});i.onChange=function(e){"function"===typeof n&&n(e)},i.onSuccess=function(e,a,n){"function"===typeof t&&(t(e,a,n),u.default.speed.runReport(f.SPEED_REPORT_POINTS.FRONT_DOWNLOAD,o,+new Date))},i.onError=function(e){u.default.tdwReport({opername:"doc_export",module:"export_fail",action:"count",obj2:v.location.href,obj3:2}),function(e){try{var t=e&&e.stack,a=e&&e.toString&&e.toString();t&&(a+="\n"+t),v.log.report("export_fail",{data:{message:a,location:v.location.href}})}catch(n){}}(e),"function"===typeof a&&a(e)},i.start()}},{key:"clearStyleDetail",value:function(){this.styleDetail=[]}},{key:"transKeyFrameUtil",value:function(e){return(0,d.transKeyFrame)(e)}},{key:"__export__dev",value:function(e){var t=this.parent.preview.previewsheet.sheets[e],a=(0,r.getSheetExportInfo)(t),o=new s.default.Deflate({level:6}),i=[],u=t.getSheetId();i.push({id:t.getSheetId(),name:t.getTitle()}),o.push((0,n.default)({header:i}).replace(/\}$/,""),!1),o.push(',"'+u+'":'+(0,n.default)(a),!1),o.push("}",!0),c.default.window.actionExporting=!1,c.default.window.top.exportFlag=!0;var d=c.default.window.parent.clientVars.collab_client_vars.ver;c.default.window.CoreSheet.export.postExportSheetInfo((0,l.u8tobase64)(o.result),null,null,c.default.window.clientVars.padId,d,!0)}}]),e}();t.default=_},1644:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(16)),o=f(a(0)),i=f(a(1)),r=f(a(362)),s=f(a(100)),l=a(44),u=f(a(8)),d=f(a(753)),c=a(755),h=a(181);function f(e){return e&&e.__esModule?e:{default:e}}var p=function(){return window.clientVars.userName},v=function(){function e(t){(0,o.default)(this,e),this.DelayTime=50,this.SheetsAllDataCountLimit=2e5,this.app=t.app,this.file=t.file,this.dataCenter=this.app.handleData,this.sheets=this.app.spreadsheet.getSheets(),this.headers=this.getHeaders(this.sheets),this.allSheetCount={allNum:0,dataNum:0,isLarge:-1},this.rate=0,this.loadedSheets=[],this.unLoadSheets={sheets:[],sheetsPromise:[]},this.commentExportInfo=[],this._delate=new r.default.Deflate({level:6}),this.remoteCount=-1}return(0,i.default)(e,[{key:"start",value:function(){var e=this;this._delate&&this._delate.push((0,n.default)({header:this.headers}).replace(/\}$/,""),!1),this.sheets.length&&(this.classifySheets(this.sheets),this._currRate=100/(this.unLoadSheets.sheetsPromise.length+this.loadedSheets.length),this.remoteCount=this.unLoadSheets.sheets.length,this.localCount=this.loadedSheets.length,this.remoteCount?s.default.all(this.unLoadSheets.sheetsPromise).then(function(t){e.handleRemoteSheet(t)}).catch(function(t){e.onError(t)}):this.handleLocalSheet())}},{key:"classifySheets",value:function(e){var t=this;e.forEach(function(e){var a=e.getSheetId();if(e.isLoaded)t.loadedSheets.push({sheetId:a,sheet:e}),t.onChange({rate:t.rate.toFixed(0)});else{var n=t.dataCenter.getFetchUrl(a);t.unLoadSheets.sheetsPromise.push((0,s.default)({method:"get",url:n,responseType:"json"})),t.unLoadSheets.sheets.push(e)}})}},{key:"handleRemoteSheet",value:function(e){var t=this,a=void 0,n=this.unLoadSheets.sheets[this.remoteCount-1],o=e[this.remoteCount-1];if("fail"!==this.dataCenter.checkRespose(o))if(n.isLoaded=!0,o.data.data){var i=o.data.data.initialAttributedText&&o.data.data.initialAttributedText.text?o.data.data.initialAttributedText.text:"";if(a=o.data.data.padSubId||n.getSheetId(),n.getSheetId()===a){try{this.dataCenter.transformSpreadsheet(n,i)}catch(r){this.onError(r)}(0,l.delayWithST)(this.DelayTime).then(function(){return t.app.calcController.sheetFormulaLayerStatusMap.getInitialPromise(n.getSheetId()).catch(function(e){console.info(e)})}).then(function(){t.processRemoteData(n,e),t.unLoadSheets.sheets[t.remoteCount-1]=null}).catch(function(e){t.onError(e)})}}else this.onError();else(0,l.delayWithST)(this.DelayTime).then(function(){t.dataCenter.transformSpreadsheet(n,""),t.processRemoteData(n,e)}).catch(function(e){t.onError(e)})}},{key:"handleLocalSheet",value:function(){var e=this;(0,l.delayWithST)(this.DelayTime).then(function(){e.processLocalData()}).catch(function(t){e.onError(t)})}},{key:"processRemoteData",value:function(e,t){this.exportJankReport();var a=(0,c.getSheetExportInfo)(e),o=e.getSheetId(),i=p(),r=(0,c.getCommentsExportInfo)(e,i);this.setAllSheetCount(a),this._delate&&this._delate.push(',"'+o+'":'+(0,n.default)(a),!1),e.parent.reInitSheetBySheetId(o),d.default.sheetData.clearAndReInitOneSheet({sheetId:o}),this.app&&this.app.calcController.resetSheet(o),this.unLoadSheets.sheets[this.remoteCount]=null,this.remoteCount--,this.commentExportInfo.push(r),this.exportData(t)}},{key:"processLocalData",value:function(){this.exportJankReport();var e=this.loadedSheets[this.localCount-1],t=e.sheetId,a=(0,c.getSheetExportInfo)(e.sheet),o=p(),i=(0,c.getCommentsExportInfo)(e.sheet,o);this.setAllSheetCount(a),this._delate&&this._delate.push(',"'+t+'":'+(0,n.default)(a),!1),this.localCount--,this.commentExportInfo.push(i),this.exportData()}},{key:"exportData",value:function(e){this.remoteCount<=0&&this.localCount<=0?(this._delate&&this._delate.push(',"styleDetail":['+this.file.styleDetail),this._delate&&this._delate.push("]}",!0),this.file.clearStyleDetail(),this.allSheetCount.dataNum>this.SheetsAllDataCountLimit?this.allSheetCount.isLarge=1:this.allSheetCount.isLarge=0,this.onChange({rate:100}),this.onSuccess((0,h.u8tobase64)(this._delate.result),this.commentExportInfo,(0,n.default)(this.allSheetCount)),this._delate=null):(this.remoteCount?this.handleRemoteSheet(e):this.handleLocalSheet(),this.rate+=this._currRate,this.onChange({rate:this.rate.toFixed(0)}))}},{key:"exportJankReport",value:function(){var e=window.performance&&window.performance.memory?window.performance.memory:{};u.default.jank.log({moduleValue:"keyframe",actionValue:"export",detail:[e]})}},{key:"onChange",value:function(e){}},{key:"onError",value:function(e){}},{key:"onSuccess",value:function(e,t,a){}},{key:"onStyleDetailChange",value:function(){}},{key:"getHeaders",value:function(e){if(!Array.isArray(e))return[];var t=[];return e.forEach(function(e,a){t.push({id:e.getSheetId(),name:e.getTitle(),hidden:e.getProperties().getHidden()})}),t}},{key:"setAllSheetCount",value:function(e){try{this.allSheetCount.dataNum+=e.validDataCount,this.allSheetCount.allNum+=e.data[0].length*e.data.length,delete e.validDataCount}catch(t){console.error(t)}}}]),e}();t.default=v},1645:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(0)),o=f(a(1)),i=f(a(7)),r=a(82),s=a(1646),l=a(200),u=f(a(1647)),d=f(a(1649)),c=f(a(8)),h=f(a(1650));function f(e){return e&&e.__esModule?e:{default:e}}var p=function(){function e(t){(0,n.default)(this,e),this.app=t,this.init()}return(0,o.default)(e,[{key:"init",value:function(){var e=this;new h.default(this.app),this.app.event.init.listen(r.EVENT_NAME.AFTER_FIRST_RENDER,function(){new d.default(e.app),e.initContextMenu(),e.initPcToolbar(),e.initDiscussDrawer(),e.initTitleSync(),e.initMentionPlugin()}),this.app.event.init.listen(r.EVENT_NAME.AFTER_ALL_RENDER,function(){e.initSheetsbar(),e.initJankReport()});var t=!1;this.app.event.reportEvent.listen("loadRealReport",function(){t||(t=!0,Promise.resolve().then(a.t.bind(null,397,7)).then(function(e){i.default.window.ReportProxy&&i.default.window.ReportProxy.eachLoad(e.default),e.default.speed.runDefaultReport()}))})}},{key:"initPcToolbar",value:function(){var e=this;a.e("bundle_toolbar").then(a.t.bind(null,1653,7)).then(function(t){(0,s.removeToolbarTomb)();var a=new t.default("web_header_bottom",e.app,e.app.view.canvas,{});a.render(),e.app.view.canvas&&!e.app.view.canvas.hasRenderAll&&a.disabledAll(),(0,l.resize)()})}},{key:"initSheetsbar",value:function(){var e=this;a.e("bundle_sheetsbar").then(a.t.bind(null,779,7)).then(function(t){var a=new t.default(e.app.spreadsheet,e.app);e.app.view.sheetsBar=a,(0,l.resize)()})}},{key:"initContextMenu",value:function(){var e=this;a.e("bundle_contextmenu").then(a.t.bind(null,780,7)).then(function(t){new t.default(e.app).init()})}},{key:"initDiscussDrawer",value:function(){var e=this;a.e("bundle_discuss").then(a.t.bind(null,1663,7)).then(function(t){var a=new t.default(e.app);e.app.view.discuss=a})}},{key:"initJankReport",value:function(){try{c.default.jank.startMonitor()}catch(e){console.error("startJankMonitor error",e)}}},{key:"initTitleSync",value:function(){new u.default(this.app)}},{key:"initMentionPlugin",value:function(){var e=this;a.e("bundle_mentionplugin").then(a.t.bind(null,1664,7)).then(function(t){new t.default(e.app,e.app.view.canvas).initDefault()})}}]),e}();t.default=p},1646:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeToolbarTomb=function(){try{var e=document.querySelector(".toolbar-preview-pc");e&&e.remove()}catch(t){}},t.removeSheetsBarTomb=function(){}},1647:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});h(a(14));var n=h(a(0)),o=h(a(1)),i=h(a(7)),r=a(82),s=a(1648),l=a(143),u=h(a(8)),d=a(22),c=a(71);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e),this.app=t,this.bindEvents(),this.app.spreadsheet.setTitle(i.default.window.clientVars.padTitle,!0)}return(0,o.default)(e,[{key:"bindEvents",value:function(){var e=this;this.app.event.spreadsheetEvent.listen(r.EVENT_NAME.TITLE_CHANGE_LOCAL,function(t){e.setDocumentTitleToServer(t),e.titleEffect(!1)}),this.app.event.spreadsheetEvent.listen(r.EVENT_NAME.TITLE_CHANGE_SERVER,function(t){e.titleEffect(!0)}),this.app.event.spreadsheetEvent.listen(r.EVENT_NAME.TITLE_AUTO_CHANGE,function(){e.titleUpdateTips()})}},{key:"titleUpdateTips",value:function(){if(localStorage){var e=Number(localStorage.getItem("titleAutoSyncTipsTime"))||0;if(e<=2)(0,c.showToast)("\u5df2\u81ea\u52a8\u751f\u6210\u6807\u9898\uff0c\u70b9\u51fb\u6807\u9898\u53ef\u8fdb\u884c\u4fee\u6539\u3002",void 0,{toolToastCloseTime:5e3,supportMobile:!0}),e++,localStorage.setItem("titleAutoSyncTipsTime",String(e))}}},{key:"setOfflineStoreTitle",value:function(e){"undefined"!==typeof i.default.window.Storage&&(e?localStorage.setItem("offline_title_"+i.default.clientVars.padId,e):localStorage.removeItem("offline_title_"+i.default.clientVars.padId))}},{key:"setDocumentTitleToServer",value:function(e){var t=this;e=e.replace(/[\\\/:*?"<>|]/g,"").slice(0,128)||"\u65e0\u6807\u9898\u8868\u683c";var a=i.default.clientVars,n=a.creatorDomain,o=a.domainId,r=a.padId;this.setOfflineStoreTitle(e),(0,s.setLocalActions)("MODIFY",{domainId:o,localPadId:r,title:e,actiontoserver:1});var d=(0,l.addQuery)("//docs.qq.com/cgi-bin/redirect/"+n+"/ep/api/changetitle",{localPadId:r,newTitle:e});$.post(d,{},function(a,n){if("success"===n&&(0===a.retcode||"0"===a.retcode)){i.default.clientVars.isUserChangeTitle=1,i.default.clientVars.padTitle=e;try{(0,s.setLocalActions)("MODIFY",{domainId:o,localPadId:r,title:e,title_sort_priority:a.doc_info.title_sort_priority,title_sort_value:a.doc_info.title_sort_value});var l=localStorage.getItem("tdsourcetag");u.default.tdwReport({opername:"doc_core",module:"edit",action:"modify_title",source3:l||""})}catch(d){console.error(d)}t.setOfflineStoreTitle("")}})}},{key:"titleEffect",value:function(e){var t=this.app.spreadsheet.getTitle();if(d.isMobile||d.isPad){if(d.isTencentDocsApp&&window.mqq&&window.mqq.invoke("ui","setWebviewNaviTitle",{title:t,url:window.location.href}),this.app.view.header&&this.app.view.header.setHeaderTitle&&this.app.view.header.setHeaderTitle(t),document.title=t,d.isIOS)window.mqq&&window.mqq.ui&&window.mqq.ui.refreshTitle&&window.mqq.ui.refreshTitle();else{i.default.window.CoreSheet.shareController&&i.default.window.CoreSheet.shareController.setShareInfo();try{window.mqq.invoke("ui","setSharedDocNativeKeyboardEnable",{enable:0,source:0},function(){})}catch(a){console.log("setSharedDocNativeKeyboardEnable fail!")}}try{d.isWxMiniProgram&&window.wx.miniProgram.postMessage({data:{title:t}})}catch(a){}}else{try{document.title=t}catch(a){}this.app.event.default.trigger("title-update-pc",{title:t,isServer:e})}}}]),e}();t.default=f},1648:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(16)),o=s(a(9)),i=s(a(31));t.setLocalActions=function(e,t){t.createdDate=+new Date;var a="docs_actions",s=function(e){if("undefined"!==typeof r.default.window.Storage)return localStorage.getItem(e)}(a);s=s&&JSON.parse(s)||[];var l={};s.forEach(function(e,t){var a=e.data;l[a.localPadId+"$"+a.domainId]={index:t,type:e.type,value:a}});var u=l[t.localPadId+"$"+t.domainId];if(u){var d=!0,c=!1,h=void 0;try{for(var f,p=(0,i.default)((0,o.default)(t));!(d=(f=p.next()).done);d=!0){var v=f.value;u.value[v]=t[v]}}catch(_){c=!0,h=_}finally{try{!d&&p.return&&p.return()}finally{if(c)throw h}}s[u.index]={type:"ADD"===u.type&&"MODIFY"===e?"ADD":e,data:u.value}}else s.push({type:e,data:t});!function(e,t){"undefined"!==typeof r.default.window.Storage&&localStorage.setItem(e,t)}(a,(0,n.default)(s))};var r=s(a(7));function s(e){return e&&e.__esModule?e:{default:e}}},1649:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),o=l(a(1)),i=a(82),r=l(a(7)),s=a(200);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),this.app=t,this.initCommon(),this.initPC()}return(0,o.default)(e,[{key:"initCommon",value:function(){this.app.event.default.listen(i.EVENT_NAME.UI_SHOW,function(e){})}},{key:"initPC",value:function(){var e=this;this.app.event.default.listen(i.EVENT_NAME.UI_SHOW,function(t){switch(t){case"search-panel-pc":e.hideToolbarMorePC(),e.hideToolbarDropdownPC(),e.hideDropdownPC();break;case"formula-editor-panel":e.hideCanvasCard()}}),this.event.toolBar.listen("beforePCFormulaPanelShow",function(){e.hideConditionalFormatPC()}),this.event.toolBar.listen("conditionalFormatPanelShow",function(){e.hideFormulaPadPC(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad()}),this.event.toolBar.listen("recordChangePanelBeforeShow",function(){e.hideConditionalFormatPC()}),this.event.toolBar.listen("readRecordPanelShow",function(){e.hideConditionalFormatPC()}),this.event.toolBar.listen("authSharePanelShow",function(){e.hideConditionalFormatPC(),e.hideMentionPanel(0)}),this.event.default.listen("record-hide-side",function(){e.hideMentionPanel(0)})}},{key:"initPad",value:function(){var e=this;this.app.event.default.listen(i.EVENT_NAME.UI_SHOW,function(t){switch(t){case"formula-board":e.hideToolPanelMobilePad();break;case"filter-panel-pc":e.hideToolPanelMobilePad(),e.hideCanvasCard(),e.hideTableMenuMobilePad(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad();break;case"search-panel-m":e.hideToolPanelMobilePad(),e.hideHeaderMobilePad(),e.hideMentionPanel();break;case"more-menu-m":e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad(),e.hideMentionPanel();break;case"auth-m":e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad();break;case"formula-editor-panel":e.hideCanvasCard();break;case"comment-panel-m":e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad(),e.hideHeaderMobilePad(),e.hideSearchReplacePanelMobilePad()}}),this.event.toolBar.listen("beforeToolPanelShow",function(){e.hideCanvasCard(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad()}),this.event.toolBar.listen("beforePCFormulaPanelShow",function(){e.hideCanvasCard(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad()}),this.stage.event.eventLink.listen("linkModifyBoxShow",function(){e.hideFormulaPadPC(),e.hideToolPanelMobilePad(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad()}),this.event.toolBar.listen("headerMoreMenuShow",function(){e.hideCanvasCard(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad()}),this.stage.event.eventMenu.listen("cellToolbarTruelyShow",function(){e.hideCanvasCard(),e.hideFilterPanelPCPad(),e.hideFormulaPadPC(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideMentionPanel()}),r.default.window.addEventListener("resize",function(){Math.min(window.innerWidth,document.body.offsetWidth);(0,s.inWhichSplitView)()<.5&&(e.hideFilterPanelPCPad(),e.hideCanvasCard(),e.hideTableMenuMobilePad(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad(),e.hideTemplateInfoPCPad())}),this.stage.event.eventInput.listen("inputShow",function(){e.hideFilterPanelPCPad(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad()}),this.event.toolBar.listen("validationListShow",function(){e.hideFilterPanelPCPad(),e.hideReadRecordPCPad(),e.hideAuthPanelPCPad()}),this.stage.event.eventSmart.listen("turnOnSmartSelection",function(){e.hideToolPanelMobilePad()})}},{key:"initMobile",value:function(){var e=this;this.app.event.default.listen(i.EVENT_NAME.UI_SHOW,function(t){switch(t){case"formula-board":e.hideToolPanelMobilePad();break;case"filter-panel-m":e.hideToolPanelMobilePad(),e.hideSearchReplacePanelMobilePad(),e.hideMentionPanel();break;case"validation-list-card-m":e.hideToolPanelMobilePad(),e.hideSearchReplacePanelMobilePad(),e.hideCanvasCard(),e.hideMentionPanel();break;case"search-panel-m":e.hideToolPanelMobilePad(),e.hideHeaderMobilePad();break;case"more-menu-m":e.hideFilterPanelPCPad(),e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad(),e.hideMentionPanel();break;case"auth-m":e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad();break;case"switch-sheet":e.hideQuickPanelMobilePad();break;case"comment-panel-m":e.hideQuickPanelMobilePad(),e.hideToolPanelMobilePad(),e.hideHeaderMobilePad(),e.hideSearchReplacePanelMobilePad()}}),this.app.event.sheetsBar.listen("switchSheet",function(){e.hideQuickPanelMobilePad()}),this.stage.event.eventSmart.listen("turnOnSmartSelection",function(){e.hideToolPanelMobilePad()}),this.stage.event.eventMenu.listen("cellToolbarTruelyShow",function(){e.hideMentionPanel()})}},{key:"hideToolPanelMobilePad",value:function(){var e=this.app.view.mobileToolBar.components.toolPanel;e&&e.panel.hide()}},{key:"hideQuickPanelMobilePad",value:function(){this.app.view.mobileToolBar&&this.app.view.mobileToolBar.hide()}},{key:"hideFormulaPadPC",value:function(){this.app.view.plugins.formulaEditorPanel&&this.app.view.plugins.formulaEditorPanel.hide()}},{key:"hideTableMenuMobilePad",value:function(){this.app.view.canvas.excel.event.eventMenu.trigger("cellToolbarHide")}},{key:"hideFilterPanelPCPad",value:function(){this.app.view.plugins.filterPanel&&this.app.view.plugins.filterPanel.hide()}},{key:"hideReadRecordPCPad",value:function(){r.default.window.CoreSheet.ReadRecordModule.hideReadRecord()}},{key:"hideAuthPanelPCPad",value:function(){r.default.window.CoreSheet.authBtn.hideAuth()}},{key:"hideTemplateInfoPCPad",value:function(){r.default.window.CoreSheet.templateInfo&&r.default.window.CoreSheet.templateInfo.hide()}},{key:"hideSearchReplacePanelMobilePad",value:function(){this.app.view.plugins.searchReplacePanel&&this.app.view.plugins.searchReplacePanel.hide()}},{key:"hideCanvasCard",value:function(){this.app.view.canvas.pluginsApi.cardCenter.hideAll()}},{key:"hideHeaderMobilePad",value:function(){this.app.view.header&&this.app.view.header.exitFullScreen(),this.app.view.header&&this.app.view.header.hideHeader()}},{key:"hideToolbarMorePC",value:function(){this.app.event.toolBar.trigger("hide-more")}},{key:"hideToolbarDropdownPC",value:function(){this.app.event.default.trigger("close-toolbar-dropdown")}},{key:"hideDropdownPC",value:function(){r.default.event.notificationCenterEvent.trigger("closedropdown")}},{key:"hideConditionalFormatPC",value:function(){this.app.view.plugins&&this.app.view.plugins.conditionalFormatPanel&&this.app.view.plugins.conditionalFormatPanel.hide()}},{key:"hideMentionPanel",value:function(){switch(arguments.length>0&&void 0!==arguments[0]?arguments[0]:1){case 0:r.default.event.mentionEvent.trigger("cancelMentionAction");break;case 1:default:r.default.event.mentionEvent.trigger("hideQuickRemindMenu")}}},{key:"event",get:function(){return this.app.event}},{key:"stage",get:function(){return this.app.view.canvas.excel}}]),e}();t.default=u},165:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showNetworkOfflineTip=function(){var e=arguments.length>0&&void 0!==arguments[0]&&!arguments[0]?"\u67e5\u770b":"\u7f16\u8f91";return o.default.show({message:"\u7f51\u7edc\u5f02\u5e38\uff0c\u79bb\u7ebf"+e+"\u4e2d\uff0c\u6587\u6863\u6700\u65b0\u5185\u5bb9\u4f1a\u5728\u7f51\u7edc\u6062\u590d\u540e\u540c\u6b65\u3002",style:{zIndex:10003},autoClose:!1,closable:!0})},t.showSaveFrontEndErrorTip=function(e){o.default.show({message:"\u7f16\u8f91\u5185\u5bb9\u6682\u65e0\u6cd5\u4fdd\u5b58\u3002",type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return(0,i.showHowToHandleDataLostModal)(e),!1}}]})},t.showLoginExpiredTip=function(e){o.default.show({message:"\u767b\u5f55\u8fc7\u671f\uff0c\u70b9\u51fb\u5237\u65b0\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showUnAuthTip=function(e){o.default.show({message:"\u4f60\u7684\u6743\u9650\u5df2\u53d1\u751f\u53d8\u5316\uff0c\u7f16\u8f91\u5185\u5bb9\u6682\u65e0\u6cd5\u4fdd\u5b58\u3002",type:"error",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return(0,i.showHowToHandleDataLostModal)(e),!1}}]})},t.showBigDataFromFrontTip=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002";o.default.show({message:t,type:"error",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return(0,i.showHowToHandleDataLostModal)(e),!1}}]})},t.showSecurityTip=function(e){o.default.show({message:"\u6b64\u5185\u5bb9\u56e0\u8fdd\u89c4\u65e0\u6cd5\u7f16\u8f91\u3002",type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u4e86\u89e3\u8be6\u60c5",onClick:function(){window.open("https://docs.qq.com/doc/DWE9lbGhWTU9OV2VF","_blank")}}]})},t.showSheetBarDuplicateSheetId=function(e,t){n.default.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:{insertNewSheet:"\u65b0\u5efa\u5de5\u4f5c\u8868",moveSheet:"\u79fb\u52a8\u5de5\u4f5c\u8868",copySheetById:"\u521b\u5efa\u526f\u672c",deleteSheet:"\u5220\u9664\u5de5\u4f5c\u8868",renameSheet:"\u91cd\u547d\u540d\u5de5\u4f5c\u8868"}[t]+"\u5931\u8d25\uff0c\u6211\u4eec\u5bf9\u6b64\u8868\u793a\u62b1\u6b49\u3002\u53ef\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u6216\u8054\u7cfb\u6211\u4eec\u53cd\u9988\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u4f60\u4fee\u590d\u3002",okText:"\u8054\u7cfb\u6211\u4eec",onOk:function(){window.open("https://support.qq.com/products/28096?customInfo="+e,"_blank")},cancelText:"\u5237\u65b0",onCancel:function(){window.location.reload()},onClose:function(){window.location.reload()}})},t.showPermissionChangesTip=function(){o.default.show({message:"\u4f60\u5728\u6b64\u8868\u683c\u7684\u6743\u9650\u5df2\u53d1\u751f\u53d8\u5316\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showUserChangeSaveSuccessTip=function(){r.default.window.CoreSheet&&r.default.window.CoreSheet.saveStatus.showSaveTips("saving",3e3,null,"\u5df2\u81ea\u52a8\u4fdd\u5b58")},t.showUserChangeSaveFailTip=function(){r.default.window.CoreSheet&&r.default.window.CoreSheet.saveStatus.showSaveTips("text",3e3,null,"\u4fdd\u5b58\u5931\u8d25")},t.showNetOfflineErrorTip=function(e){o.default.show({message:"\u79bb\u7ebf\u7f16\u8f91\u4e0d\u53ef\u7528\uff0c\u8bf7\u8fde\u63a5\u7f51\u7edc\u540e\u5237\u65b0\u3002",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showOfflineEditingTip=function(){r.default.window.CoreSheet&&(r.default.window.CoreSheet.saveStatus.showSaveTips("offline",null,"\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91","\u6b63\u5728\u79bb\u7ebf\u7f16\u8f91"),function(e,t){var a=null;return function(){var n=this,o=arguments;a&&(clearTimeout(a),a=null),a=setTimeout(function(){e.apply(n,o)},t)}}(function(){r.default.window.CoreSheet.saveStatus.showSaveTips("offline",3e3,"\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f","\u79bb\u7ebf\u7f16\u8f91\u4fdd\u5b58\u6210\u529f")},1e3)())},t.showSavedText=function(){r.default.window.CoreSheet&&r.default.window.CoreSheet.saveStatus.showSavedText()},t.showServerConnectFailTip=function(e){o.default.show({message:"\u6682\u65e0\u6cd5\u8fde\u63a5\u5230\u670d\u52a1\u5668\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){(0,i.goToTuCao)(e)}}]})},t.showCommonErrorModal1=function(e){n.default.confirm({title:"\u7cfb\u7edf\u6d88\u606f",content:"\u8868\u683c\u9047\u5230\u9519\u8bef\uff0c\u8bf7\u5237\u65b0\u9875\u9762\u540e\u91cd\u8bd5\u3002",okText:"\u5237\u65b0",onOk:function(){window.location.reload()},cancelText:"\u8054\u7cfb\u6211\u4eec",onCancel:function(){return(0,i.goToTuCao)(e),!1}})},t.showCommonCrashAndFeedBackModal=function(e){var t={title:"\u7cfb\u7edf\u6d88\u606f",content:"\u52a0\u8f7d\u8868\u683c\u65f6\u9047\u5230\u672a\u77e5\u9519\u8bef\uff0c\u6211\u4eec\u5bf9\u6b64\u8868\u793a\u62b1\u6b49\uff0c\u53ef\u5c1d\u8bd5\u5237\u65b0\u9875\u9762\u6216\u8054\u7cfb\u6211\u4eec\u53cd\u9988\u95ee\u9898\uff0c\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u4f60\u4fee\u590d\u3002",cancelText:null,okText:"\u5410\u4e2a\u69fd",onOk:function(){window.open("https://support.qq.com/products/28096?customInfo="+e,"_blank")}};n.default.confirm(t)};var n=s(a(308)),o=s(a(443)),i=a(395),r=s(a(7));function s(e){return e&&e.__esModule?e:{default:e}}},1650:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(0)),o=r(a(1651)),i=r(a(1652));function r(e){return e&&e.__esModule?e:{default:e}}t.default=function e(t){var a=this;(0,n.default)(this,e),this._handleErrorCode=function(e){var t=e.type,n=e.code,o=e.data;switch(t){case"socket":a._socketErrorCode.showError(n);break;case"cgi":break;case"front":a._frontErrorCode.showError(n,o)}},this._app=t,this._socketErrorCode=new o.default(t),this._frontErrorCode=new i.default(t),this._app.event.errorCode.listen("errorCode",this._handleErrorCode)}},1651:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),o=l(a(1)),i=a(237),r=a(165),s=a(756);function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){(0,n.default)(this,e),this._app=t}return(0,o.default)(e,[{key:"showError",value:function(e){if((0,i.checkVipToast)(e))window.SpreadsheetApp.sheetStatus.permission.setgEditable(!1);else switch(console.log("%c in socket error:","color:red",e),e){case"60000":(0,i.showServerErrorTip)(e);break;case"60001":navigator.onLine?(0,i.showServerErrorTip)(e):(0,r.showNetworkOfflineTip)();break;case"60002":(0,i.showServerConnectTimeout)(e);break;case"60003":case"60016":case"60017":case"40001":case"40002":case"40003":case"40030":(0,s.reportError)(e),(0,r.showSaveFrontEndErrorTip)(e);break;case"102":(0,r.showSaveFrontEndErrorTip)(e);break;case"60004":case"60005":case"60011":case"60013":case"60018":case"60019":case"60020":case"60021":case"60022":(0,i.showServerTaskTimeout)(e);break;case"60006":(0,r.showLoginExpiredTip)(e);break;case"60007":case"60015":(0,r.showUnAuthTip)(e);break;case"60008":case"40026":case"40028":(0,s.reportError)(e),(0,i.showBigDataFromServerTip)(e);break;case"60010":case"INACTIVE":(0,i.showFullMemberTip)(e);break;case"60014":(0,i.showFrequentEditTip)(e);break;case"40000":case"40005":case"40006":case"40020":case"40021":case"40022":case"40023":case"41001":case"41002":case"10000":case"10001":(0,s.reportError)(e),(0,i.showSaveBackEndErrorTip)(e);break;case"40024":case"40029":(0,i.showUpgradeTip)(e);break;case"40025":(0,r.showSecurityTip)(e);break;default:(0,i.showUpdatePadTip)()}}}]),e}();t.default=u},1652:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(0)),o=u(a(1)),i=a(90),r=a(237),s=a(165),l=a(756);function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,n.default)(this,e),this._app=t}return(0,o.default)(e,[{key:"showError",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};switch(e){case i.errCodeType.APPLY_NEW_CHANGE_ERROR:(0,l.reportError)(e),(0,r.showApplyNewChangeErrorTip)(i.errCodeType.APPLY_NEW_CHANGE_ERROR);break;case i.errCodeType.REQUEST_SIZE_LIMIT:(0,s.showBigDataFromFrontTip)(i.errCodeType.REQUEST_SIZE_LIMIT,t.message);break;case i.errCodeType.KICK:case i.errCodeType.DATA_VERSION_TOO_LOW:(0,r.showUpgradeTip)(e);break;case i.errCodeType.KEYFRAME_UNZIP_ERROR:(0,s.showCommonCrashAndFeedBackModal)(i.errCodeType.KEYFRAME_UNZIP_ERROR);break;case i.errCodeType.SHEET_ID_ERROR_1:case i.errCodeType.SHEET_ID_ERROR_2:case i.errCodeType.SHEET_ID_ERROR_3:(0,s.showSaveFrontEndErrorTip)(e);break;case i.errCodeType.SHEET_ID_INIT_OLD_DUPLICATE:break;case i.errCodeType.SHEET_ID_SHEET_BAR_OLD_DUPLICATE:(0,s.showSheetBarDuplicateSheetId)(i.errCodeType.SHEET_ID_SHEET_BAR_OLD_DUPLICATE,t.actionType);break;case i.errCodeType.SHEET_ID_SHEET_BAR_NEW_DUPLICATE:(0,s.showSheetBarDuplicateSheetId)(i.errCodeType.SHEET_ID_SHEET_BAR_NEW_DUPLICATE,t.actionType);break;case i.errCodeType.SOCKET_NOT_SET_UP:(0,s.showServerConnectFailTip)(i.errCodeType.SOCKET_NOT_SET_UP);break;case i.errCodeType.OFFLINE_INDEXDB_NOT_AVAILABLE:(0,l.reportError)(e),(0,s.showNetOfflineErrorTip)(i.errCodeType.OFFLINE_INDEXDB_NOT_AVAILABLE);break;case i.errCodeType.COMMIT_ERROR_CODE_UNDEFINED:break;case i.errCodeType.COMMITING_QUEUE_BLOCK:(0,s.showSaveFrontEndErrorTip)(i.errCodeType.COMMITING_QUEUE_BLOCK);break;case i.errCodeType.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED:(0,s.showCommonErrorModal1)(i.errCodeType.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED);break;case i.errCodeType.PERMISSION_CHANGE:(0,s.showPermissionChangesTip)();break;case i.errCodeType.FETCH_USER_CHANGE_RESPONSE_NOT_CONTINUE:case i.errCodeType.FETCH_USER_CHANGE_TO_LESS_THAN_FROM:case i.errCodeType.FETCH_USER_CHANGE_CGI_HTTP_ERROR:case i.errCodeType.FETCH_USER_CHANGE_RESPONSE_DATA_EMPTY:case i.errCodeType.FETCH_USER_CHANGE_RESPONSE_ARRAY_EMPTY:case i.errCodeType.FETCH_USER_CHANGE_RESPONSE_ERROR_CODE:break;case i.errCodeType.RELOAD:default:(0,r.showUpdatePadTip)()}}}]),e}();t.default=d},172:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),a(781);var n=c(a(7)),o=c(a(490)),i=c(a(1637)),r=c(a(1638)),s=c(a(238)),l=c(a(1641)),u=c(a(40)),d=c(a(1645));function c(e){return e&&e.__esModule?e:{default:e}}s.default.info("spreadLoadSuccess");var h=n.default.window;h.performanceData&&(h.performanceData.spreadStartRun=Number(new Date));try{h._grayVersion="1.2.0",h.__console.log("%c\u3010\u7248\u672c\u4fe1\u606f\u3011"),h.__console.log("%c\u5f53\u524d\u6570\u636e\u7248\u672c\uff1a"+h._grayVersion,"color: green; font-size: 16px;"),h.__console.log("%c\u5f53\u524d\u7248\u672c\uff1a"+h.__globalReleaseVersion,"color: blue; font-size: 16px;")}catch(v){console.warn(v)}var f=new o.default({hook:{getBottomHeight:function(){return 36}}});new d.default(f);var p=new l.default(f);f.addModule("file",p),t.default=f,(0,i.default)()&&(h.tdsheetapi=r.default),h.SpreadsheetApp=f,s.default.info("trigger spreadLoadSuccess"),h.__ws&&h.__ws.trigger("setLoadData",{type:"spreadsheet"}),u.default.default.trigger("spreadLoadSuccess")},174:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CalcInputWidth=void 0;var n=l(a(16)),o=l(a(9)),i=l(a(0)),r=l(a(1));t.throttle=function(e,t,a,n){var o=void 0;return n="undefined"===typeof n||n,function(){var i=arguments,r=this;return"undefined"!==typeof a&&(r=a),n?(e.apply(r,i),n=!1):!o&&void(o=setTimeout(function(){clearTimeout(o),o=null,e.apply(r,i)},t))}},t.timeChunk=function(e,t,a){var n=void 0,o=(e.length,0);return function(){n=setInterval(function(){if(0===e.length)return clearInterval(n);!function(){for(var n=0;n<Math.min(a||1,e.length);n++){var i=e.shift();t(i,o),o++}}()},19)}},t.inArray=function(e,t){for(var a,n=0;a=e[n++];)if(a===t)return!0;return!1},t.setHash=function(e){location.hash=e},t.getValueWithDefault=function(e,t){if(null!=e)return e;return t},t.checkEnumValue=function(e,t){for(var a=(0,o.default)(t),n=0;n<a.length;n++)if(t[a[n]]===e)return e;return null},t.clone=function(e){return JSON.parse((0,n.default)(e))},t.isSame=function(e,t){return u(e)===u(t)},t.arrToObjectKey=function(e){return e.reduce(function(e,t,a){return e[t]=1,e},{})};var s=l(a(81));function l(e){return e&&e.__esModule?e:{default:e}}t.CalcInputWidth=function(){function e(t){(0,i.default)(this,e),this.font=t,this.init()}return(0,r.default)(e,[{key:"init",value:function(){var e=document.createElement("pre");e.style.fontSize=this.font+"px",e.style.position="absolute",e.style.top="9999px",e.style.left="9999px",e.style.zIndex="-1",e.style.backgroundColor="transparent",e.style.fontFamily="Microsoft YaHei, Verdana, sans-serif",e.style.whiteSpace="pre",document.body.appendChild(e),this.dom=e}},{key:"calc",value:function(e,t){if(this.dom.style.display="block",t)for(var a=(0,o.default)(t),n=0;n<a.length;n++)this.dom.style[a[n]]=t[a[n]];this.dom.innerHTML=s.default.util.html.escapeHTML(e),this.dom.style.display="";var i=this.dom.offsetWidth;return this.dom.style.display="none",i}},{key:"destroy",value:function(){this.dom&&this.dom.remove()}}]),e}();function u(e){return null==e?null:e}},188:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(16));t.getCollabMutations=function(e){if("string"===typeof e)try{e=JSON.parse(e)}catch(a){throw d.default.run(c.CONFIG.GET_COLLAB_MUTATIONS,[e,a]),a}var t=[];return Array.isArray(e)&&e.forEach(function(e){if(e&&e.v){var a=(0,o.createMutationFromSerialize)(e);a&&t.push(a)}}),t},t.getNonnegative=function(e){return e<0?0:e},t.uuIdGenerate=function(e,t){return t?e+t.slice(0,5):e},t.dispatchKeyframe2Sheet=function(e){if(!(e=e||i.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId()))return void console.error("sheetId\u4e0d\u80fd\u4e3a\u7a7a");i.default.window.SpreadsheetApp.messageCenter.addUserChange(e,0,[new r.default({sheetId:e})],void 0,!1,void 0,!0)},t.createDataKeyframeStr=f,t.createZipKeyframe=function(e){window.swReportStop&&window.swReportStop(),d.default.jank.log({moduleValue:"keyframe",actionValue:"createKeyframe"}),window.swReportRestart&&window.swReportRestart();var t=f(e);if(!t){d.default.monitor(33711501);var a=i.default.window.SpreadsheetApp.spreadsheet.getSheetBySheetId(e);return d.default.run(c.CONFIG.CREATE_ZIPKETFRAME,[e,a&&a.isFetching,a&&a.isLoaded,a&&a.isReadonly]),null}var o=(0,s.zipKeyFrame)(t);return o||(0,n.default)([t])},t.findFirstEmptyRowIndex=function(e){for(var t=e.data.rowData,a=0;a<t.length;a++){if(!t[a])return a;var n=t[a].values;if(v(n))return a}return t.length},t.searchInPreview=function(e,t){for(var a=i.default.window.SpreadsheetApp.preview.previewsheet.sheets[e].data.rowData,n=!1,o=0;o<a.length;o++)if(a[o])for(var r=0;r<a[o].values.length;r++){var s=a[o].values[r];if(s){var l=s.effectiveValue;l&&l.value&&l.value==t&&(n=!0,console.log("\u641c\u7d22\u5230\u6570\u636e\uff0c\u4f4d\u7f6e\u662f\uff1a"," \u884c=",o," \u5217=",r))}}n||console.log("\u4fee\u8ba2\u8bb0\u5f55\u641c\u7d22\u7ed3\u679c\u4e3a\u7a7a")};var o=a(137),i=h(a(7)),r=h(a(391)),s=a(181),l=h(a(110)),u=a(160),d=h(a(8)),c=a(26);function h(e){return e&&e.__esModule?e:{default:e}}function f(e){var t=void 0,a=void 0;return e=e||i.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId(),(t=i.default.window.SpreadsheetApp.spreadsheet.getSheetBySheetId(e))&&t.isLoaded?window.clientVars&&window.clientVars.relative?(a=(0,n.default)((0,u.serialize)(t)),p(t),{type:"k",k:a,startRow:0,startCol:0,ver:l.default.KEYFRAME_VER_LOWEST_SUPPORT,sheetId:e}):(a=(0,n.default)(t.serialize()),p(t),{type:"k",k:a,startRow:0,startCol:0,ver:l.default.KEYFRAME_VER,sheetId:e}):null}function p(e){try{if(!e)return;for(var t=e.data.rowData,a=!1,n=0,o=t.length;n<o&&!a;n++){var i=t[n];if(i&&i.values)for(var r=0,s=i.values.length;r<s;r++){var l=i.values[r];if(l){var u=l.getFormula();if(u){var c=u.getParts();if(c&&0===c.length){d.default.monitor(33613232),a=!0;break}}}}}}catch(h){}}function v(e){for(var t=0;t<e.length;t++)if(null!=e[t])return!1;return!0}},193:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deSerializeRequests=t.serializeRequests=t.followRequestMutations=t.followRequests=t.follow=void 0;var n=d(a(16)),o=a(137),i=a(697),r=a(79),s=d(a(7)),l=d(a(8)),u=a(26);function d(e){return e&&e.__esModule?e:{default:e}}s.default.window;function c(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)if(!Array.isArray(e[t]))return!1;return!0}return!1}function h(e,t){var a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];try{var n,o=void 0,r=void 0,s=void 0,d=void 0,c=void 0,h=void 0,f=void 0;for(o=0,n=e.length;o<n;o++){for(d=e[o],h=[],r=0,s=t.length;r<s;r++)c=t[r],f=(0,i.transform)(c,d,!a),r<s-1&&(d=(0,i.transform)(d,c,a)),h.push(f);t=h}return l.default.monitor(33641616),t}catch(p){throw l.default.run(u.CONFIG.FOLLOW_REQUEST_MUTATIONS,[e,t,a,p&&p.stack]),p}}function f(e){for(var t=[],a=void 0,n=void 0,o=0,i=e.length;o<i;o++){n=e[o],t[o]=[];for(var s=0,l=n.length;s<l;s++)a=n[s],t[o].push((0,r.serializeMutation)(a))}return t}t.follow=function(e,t){var a=void 0,n=void 0,s=[],l=[],u=[],d=void 0,c=void 0;for(a=0,n=e.length;a<n;a++)(d=(0,o.createMutationFromSerialize)(e[a]))&&l.push(d);for(a=0,n=t.length;a<n;a++)(c=(0,o.createMutationFromSerialize)(t[a]))&&u.push(c);for(u=(0,i.transform)(u,l,!0),a=0,n=t.length;a<n;a++)s.push((0,r.serializeMutation)(u[a]));return s},t.followRequests=function(e,t){var a,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=void 0,s=void 0,u=void 0,d=void 0,p=void 0,v=void 0,_=void 0,E=void 0,T=void 0,m=void 0,g=!1;if(!function(e,t){return!(!c(e)||!c(t))}(e,t))return t;for(T=[],r=0,d=e.length;r<d;r++){for(_=[],s=0,u=e[r].length;s<u;s++)(p=(0,o.createMutationFromSerialize)(e[r][s]))?_.push(p):g=!0;T.push(_)}for(m=[],r=0,d=t.length;r<d;r++){for(E=[],s=0,u=t[r].length;s<u;s++)(v=(0,o.createMutationFromSerialize)(t[r][s]))?E.push(v):g=!0;m.push(E)}return a=f(h(T,m,i)),g&&l.default.tdwReport({opername:"doc_excel_editor",module:"excel_core",action:"followRequests",obj3:"requestsA: "+(0,n.default)(e||"")+"  requestsB: "+(0,n.default)(t||"")}),a},t.followRequestMutations=h,t.serializeRequests=f,t.deSerializeRequests=function(e){var t,a=[],n=void 0,i=void 0,r=void 0,s=[],l=void 0;for(n=0,t=e.length;n<t;n++){for(a=[],i=0,r=e[n].length;i<r;i++)(l=(0,o.createMutationFromSerialize)(e[n][i]))&&s.push(l);a.push(s)}return a}},198:function(e,t,a){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o={dialog:n(a(99)),alert:n(a(442)),modal:n(a(671)),toast:n(a(71)),tooltip:n(a(245))},i=window.T_SHEET||{};window.T_SHEET=i,i.CoreUI=o,t.default=o},200:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCookie=function(e){var t=document.cookie.match(new RegExp("(^| )"+e+"=([^;]*)(;|$)"));return t?decodeURIComponent(t[2]):""},t.setCookie=function(e,t,a,n,o){var i=new Date;i.setTime(i.getTime()+(o?36e5*o:2592e6)),document.cookie=e+"="+t+"; expires="+i.toGMTString()+"; path="+(n||"/")+"; "+(a?"domain="+a+";":"")},t.getQueryObject=function(e){var t={},a=void 0;a=/^\?/.test(e)?e.substr(1):e;for(var n=a.split("&"),o=0;o<n.length;o++)t[n[o].split("=")[0]]=unescape(n[o].split("=")[1]);return t},t.resize=function(){var e=document.createEvent("Event");e.initEvent("resize",!0,!0),window.dispatchEvent(e)},t.isPortrait=o,t.supportRotate=function(){try{window.mqq&&window.mqq.ui.setWebViewBehavior({restoreOrientation:"1"})}catch(e){}},t.forceRotatePortrait=function(){try{window.mqq&&window.mqq.ui.setWebViewBehavior({orientation:0})}catch(e){}},t.isWideScreen=function(){return(n.isTencentDocApp?document.body.offsetWidth:Math.min(window.innerWidth,document.body.offsetWidth))>=640},t.isCompactScreen=function(){var e=n.isTencentDocApp?document.body.offsetWidth:Math.min(window.innerWidth,document.body.offsetWidth);return e>320&&e<640},t.isNarrowScreen=function(){return(n.isTencentDocApp?document.body.offsetWidth:Math.min(window.innerWidth,document.body.offsetWidth))<=320},t.inWhichSplitView=function(){var e=o()?window.screen.width:window.screen.height,t=window.innerWidth/e;return t<.4?.33:t>=.4&&t<.6?.5:t>=.6&&t<.9?.66:1},t.isTouchSupported=function(){return"ontouchstart"in window},t.isWebComponentSupportedNatively=function(){var e=document.createElement("div");return!(!e.createShadowRoot||!e.createShadowRoot.toString().match(/\[native code\]/))},t.hasCaptionProblem=function(){"boolean"!==typeof i&&function(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),e.firstChild.appendChild(document.createElement("TD")),e.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var a=document.createElement("CAPTION");a.innerHTML="c<br>c<br>c<br>c",a.style.padding=0,a.style.margin=0,e.insertBefore(a,t),document.body.appendChild(e),i=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}();return i},t.showNav=function(e){o()&&(window.docNavBarHided=!1);!window.docNavBarHided||o()||!n.isIOS||window.showingNav||!e&&window.hidingNav||(window.showingNav=!0,e&&(window.hidingNav=!1),setTimeout(function(){window.showingNav=!1,window.docNavBarHided=!1,r()},350),window.mqq&&window.mqq.ui&&window.mqq.ui.setWebViewBehavior&&window.mqq.ui.setWebViewBehavior({docNavBarHide:"0",docNavBarHideDuration:"0.3"}))},t.hideNav=function(){o()&&(window.docNavBarHided=!0);window.docNavBarHided||o()||window.showingNav||window.hidingNav||(window.hidingNav=!0,setTimeout(function(){window.hidingNav=!1,window.docNavBarHided=!0,r()},350),window.mqq&&window.mqq.ui&&window.mqq.ui.setWebViewBehavior&&window.mqq.ui.setWebViewBehavior({docNavBarHide:"1",docNavBarHideDuration:"0.3"}))};var n=a(22);function o(){if("number"==typeof window.orientation)return window.orientation/90%2==0;try{var e=window.screen.orientation.angle;if("number"==typeof e)return e/90%2==0}catch(t){}return!0}var i=void 0;function r(){window.SpreadsheetApp&&window.SpreadsheetApp.view&&window.SpreadsheetApp.view.canvas.excel&&window.SpreadsheetApp.view.canvas.excel.resize()}},203:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(9)),o=r(a(16)),i=r(a(25));function r(e){return e&&e.__esModule?e:{default:e}}function s(e,t){return(0,n.default)(e).filter(function(t){return u(e,t)}).map(function(a){return t(e[a],a,e)})}function l(e,t){s(e,t)}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function d(e,t){for(var a=0;a<e.length;a++)if(e[a].source===t)return e[a];return null}t.deepClone=function(e){if("object"===("undefined"===typeof e?"undefined":(0,i.default)(e)))return JSON.parse((0,o.default)(e));return e},t.clone=function(e){var t={};return l(e,function(e,a){t[a]=e}),t},t.objectMap=s,t.objectEach=l,t.hasOwnProperty=u,t.cloneForce=function(e){var t=[],a={},n=[{parent:a,key:void 0,data:e}];for(;n.length;){var o=n.pop();if(o){var r=o.parent,s=o.key,l=o.data,u=r;"undefined"!==typeof s&&(u=r[s]={});var c=d(t,l);if(c){r[s]=c.target;continue}for(var h in t.push({source:l,target:u}),l)l.hasOwnProperty(h)&&("object"===(0,i.default)(l[h])?n.push({parent:u,key:h,data:l[h]}):u[h]=l[h])}}return a}},206:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasBasicFilter=function(e){var t=e.spreadsheet.activeSheet;if(t&&t.getBasicFilter())return!0;return!1},t.getCellFormat=s,t.getTextFormat=l,t.cellIsBold=function(e){return!!l(e).bold},t.cellIsItalic=function(e){return!!l(e).italic},t.cellIsUnderline=function(e){return!!l(e).underline},t.cellIsStrikethrough=function(e){return!!l(e).strikethrough},t.toColumnName=function(e){for(var t="",a=1,n=26;(e-=a)>=0;a=n,n*=26)t=String.fromCharCode(Math.floor(e%n/a)+65)+t;return t},t.isSingleCellBlank=u,t.isRangeCellBlank=function(e,t,a){if(function(e,t,a){var n=e.spreadsheet.activeSheet.getCellDataAtPosition(t,a);if(n&&n.getMergeReference())return!0;return!1}(e,t,a))return d(e,t,a);return u(e,t,a)},t.isMergeCellBlank=d,t.getCellDataDVAtPosition=function(e,t,a){var n=e.spreadsheet.activeSheet.getCellDataAtPosition(t,a),o=n&&n.getUserEnteredFormat();return o&&o.getDataValidation()};var n,o=a(286),i=a(89),r=(n=i)&&n.__esModule?n:{default:n};function s(e){var t=(0,o.getActiveCell)(e),a=void 0,n=e.spreadsheet.properties.defaultDefaultFormat;return t?null==(a=r.default.Utils.cellDataUtils.getExportFormat(t))&&(a=this.defaultProperties.defaultFormat):a=n,a}function l(e){var t=s(e),a=e.spreadsheet.properties.defaultDefaultFormat.getTextFormat();t.getTextFormat();return t.getTextFormat()||a}function u(e,t,a){var n=e.spreadsheet.activeSheet.getCellDataAtPosition(t,a),o=n&&n.getEditValue();return!o||""===o.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function d(e,t,a){var n=e.spreadsheet.activeSheet.getCellDataAtPosition(t,a),o=n&&n.getMergeReference();return!!o&&u(e,o.startRowIndex,o.startColIndex)}},22:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkIsIphoneX=s;var n=navigator.userAgent.toLowerCase(),o={isIE:-1!==navigator.userAgent.indexOf("msie")||-1!==navigator.userAgent.indexOf("rv:11")||!!window.ActiveXObject||"ActiveXObject"in window,ie:"",ie9:!1,ie10:!1,isMac:/Mac OS X/i.test(n)&&-1==n.indexOf("mobile"),isWindows:n.indexOf("windows")>=0,isAndroid:n.indexOf("android")>=0,isios:/(iphone|ipad|ipod)/.test(n),isPad:-1!==n.indexOf("ipad"),isMobile:-1!==n.indexOf("mobile")&&-1===n.indexOf("ipad"),isPc:-1===n.indexOf("mobile")&&-1===n.indexOf("ipad"),isTencentDocsApp:!!n.match(/(TencentDocs)/i),isWxMiniProgram:!!(window.location.href.indexOf("__wxjs_environment=miniprogram")>-1||/miniProgram/i.test(n)),isWxBrowser:/MicroMessenger/i.test(n),isTim:!!n.match(/tim/i),isPCClient:n.indexOf("txdocspc")>-1&&"undefined"!==typeof external,isSafari:/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),isChrome:/Chrome/.test(navigator.userAgent)&&/Google/.test(navigator.vendor),isFireFox:/Firefox/.test(navigator.userAgent),isMobileBrowser:/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(n)};if(o.ie){var i=navigator.appVersion.split(";")[1].replace(/[ ]/g,"");o.ie9="MSIE9.0"==i,o.ie10="MSIE10.0"==i}t.browser=o;var r=/TencentDocs/i.test(navigator.userAgent);function s(){var e=document.getElementsByClassName("iphoneXCheckDiv")[0];if(e||((e=document.createElement("div")).className="iphoneXCheckDiv",document.body.appendChild(e)),e.clientWidth>0)return!0;if(/iphone x/gi.test(window.navigator.userAgent))return!0;var t=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(812===window.screen.width&&375===window.screen.height||375===window.screen.width&&812===window.screen.height),a=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&3===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height),n=/iphone/gi.test(window.navigator.userAgent)&&window.devicePixelRatio&&2===window.devicePixelRatio&&(414===window.screen.width&&896===window.screen.height||896===window.screen.width&&414===window.screen.height);return t||a||n}var l=s(),u=window.location.href.indexOf("__wxjs_environment=qqminiprogram")>-1||/QQ/i.test(n)&&/MiniApp/i.test(n),d=o.isMac,c=o.isWindows,h=o.isAndroid,f=o.isChrome,p=o.isIE,v=o.isMobile,_=o.isMobileBrowser,E=o.isPCClient,T=o.isPad,m=o.isPc,g=o.isSafari,S=o.isFireFox,R=o.isTencentDocsApp,A=o.isTim,w=o.isWxBrowser,I=o.isWxMiniProgram,C=o.isios,y=/(wxwork)/i.test(n),O=/MicroMessenger/i.test(n)&&!y&&!I,D=!v&&/QQBrowser/i.test(n)&&!/QBCore/i.test(n),N=v&&/MQQBrowser/i.test(n)&&!/TBS/i.test(n),M=v?N:D,k=/QQ/i.test(n)&&!r&&!y&&!O&&!M&&!A&&!u,b=I||u;t.isTimOrQQFamily=A||/QQ/i.test(n);function P(e){var t=e.split("."),a=0;return t.length>=1&&(a=1e4*parseInt(t[0]),t.length>=2&&(a+=100*parseInt(t[1]),t.length>=3&&(a+=parseInt(t[2])))),a}t.isMac=d,t.isWindows=c,t.isAndroid=h,t.isChrome=f,t.isIE=p,t.isMobile=v,t.isWeWork=y,t.isMiniProgram=b,t.isMobileBrowser=_,t.isQQ=k,t.isPCQQBrowser=D,t.isWeChat=O,t.isMobileQQBrowser=N,t.isPCClient=E,t.isPad=T,t.isPc=m,t.isSafari=g,t.isFireFox=S,t.isTencentDocsApp=R,t.isTencentDocApp=r,t.isTim=A,t.isWxBrowser=w,t.isWxMiniProgram=I,t.isIOS=C,t.isIphoneX=l,t.isQQMiniProgram=u,t.checkTencentDocAppVersionSupportFunction=function(e){return!!r&&navigator.userAgent.match(/TencentDocs\/(\S*)/)[1]>=e},t.MQQLargerOrEqual=function(e){var t=function(){if(v&&!A){var e=new RegExp("QQ/{1}[0-9].{1}[0-9].{1}[0-9]","i").exec(n);return e&&e[0]?P(e[0].split("/")[1]):0}return 0}();return 0!=t&&t>=P(e)}},237:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkVipToast=function(e){var t=window.clientVars,a=t.userInfo&&t.userInfo.nick||"";if(o.default&&o.default.toast&&o.default.toast.showVipToast)return o.default.toast.showVipToast({errorCode:e,nickName:a});return!1},t.showServerErrorTip=function(e){i.default.show({message:"\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\u3002",type:"info",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){return(0,r.goToTuCao)(e),!1}}]})},t.showServerConnectTimeout=function(e){return i.default.show({message:"\u670d\u52a1\u5668\u8fde\u63a5\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){return(0,r.goToTuCao)(e),!1}}]})},t.showServerTaskTimeout=function(e){i.default.show({message:"\u670d\u52a1\u5668\u5904\u7406\u8d85\u65f6\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\u3002",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){(0,r.goToTuCao)(e)}}]})},t.showFullMemberTip=function(e){i.default.show({message:"\u6b63\u5728\u67e5\u770b\u7684\u4eba\u6570\u5df2\u8fbe\u4e0a\u9650\u3002",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showBigDataFromServerTip=function(e){i.default.show({message:"\u672c\u6b21\u64cd\u4f5c\u5185\u5bb9\u8fc7\u591a\uff0c\u65e0\u6cd5\u5e94\u7528\u3002",type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return(0,r.showHowToHandleDataLostModal)(e),!1}}]})},t.showNoLongerFullMemberTip=function(){i.default.show({message:"\u4f60\u53ef\u4ee5\u7f16\u8f91\u6b64\u6587\u6863\u4e86\uff0c\u8bf7\u5237\u65b0\u91cd\u8bd5\u3002",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showFrequentEditTip=function(e){i.default.show({message:"\u4f60\u7684\u64cd\u4f5c\u592a\u9891\u7e41\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5\u3002",style:{zIndex:10003},closable:!0,autoClose:!0,duration:3e3,action:[{text:"\u786e\u5b9a",onClick:function(){}}]})},t.showSaveBackEndErrorTip=function(e){i.default.show({message:"\u7f16\u8f91\u5185\u5bb9\u6682\u65e0\u6cd5\u4fdd\u5b58\u3002",type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5982\u4f55\u5904\u7406",onClick:function(){return(0,r.showHowToHandleDataLostModal)(e),!1}}]})},t.showUpgradeTip=function(e){i.default.show({message:"\u6587\u6863\u72b6\u6001\u6709\u66f4\u65b0\u3002",type:"info",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u70b9\u51fb\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showUpdatePadTip=function(){i.default.show({message:"\u6587\u6863\u72b6\u6001\u6709\u66f4\u65b0\u3002",type:"error",style:{zIndex:10003},autoClose:!1,onClose:function(){return!1},action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}}]})},t.showApplyNewChangeErrorTip=function(e){i.default.show({message:"\u5176\u4ed6\u534f\u4f5c\u8005\u7684\u5185\u5bb9\u6709\u66f4\u65b0\u3002",style:{zIndex:10003},autoClose:!1,action:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){return(0,r.goToTuCao)(e),!1}}]})},t.switchSheetError=function(e){n.default.confirm({maskStyle:{zIndex:10004},title:"\u7cfb\u7edf\u6d88\u606f",content:"\u670d\u52a1\u5668\u5f02\u5e38\uff0c\u65e0\u6cd5\u5207\u6362sheet\u3002\u53ef\u5c1d\u8bd5\u5237\u65b0\u6216\u8054\u7cfb\u6211\u4eec\uff0c\u6211\u4eec\u5c06\u5c3d\u5feb\u4e3a\u4f60\u4fee\u590d\u3002",actions:[{text:"\u5237\u65b0",onClick:function(){window.location.reload()}},{text:"\u8054\u7cfb\u6211\u4eec",onClick:function(){return(0,r.goToTuCao)(e),!1}}]})};var n=s(a(308)),o=s(a(198)),i=s(a(443)),r=a(395);function s(e){return e&&e.__esModule?e:{default:e}}},238:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={isFake:!0,listeners:[],var:{},namespace:"",version:0,_pid:0,_sessionId:"",_startTime:"",_uid:"",log:function(e){},info:function(e){}};["invokeWk","config","deleteDatabase","dispatch","getDBLog","getDBLogByTime","getUUID","getWorkerVar","hideConsole","listen","loadAsset","loadAssetLoader","query","raven","record","report","reportLog","showConsole","ws","debug","error","info","log","warn"].forEach(function(e){n[e]=function(){}});try{n=WebLog?new WebLog("flow"):n}catch(o){}t.default=n},244:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeHTML=function(e){var t=/[&<>'"]/g;t.MAP||(t.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"});return e.replace(t,function(e){return t.MAP[e]})},t.closest=function(e,t){var a=e.matches||e.webkitMatchesSelector||e.mozMatchesSelector||e.msMatchesSelector;for(;e;){if(a.call(e,t))return e;e=e.parentElement}return null},t.addEvent=function(e,t,a,n){e.addEventListener?e.addEventListener(t,a,n):e.attachEvent&&e.attachEvent("on"+t,function(){a(window.event)})},t.removeEvent=function(e,t,a,n){e.removeEventListener?e.removeEventListener(t,a,n):e.detachEvent&&e.detachEvent("on"+t,function(){a(window.event)})}},245:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return a.e("bundle_ui_tooltip").then(a.t.bind(null,1657,7))};t.toolTip=function(e,t){n().then(function(a){a.tooltip(e,t)})},t.showTooltip=function(e,t){n().then(function(a){a.tooltip(e,t)})},t.hideTooltip=function(){n().then(function(e){e.hideTooltip()})},t.changeTooltipText=function(e){n().then(function(t){t.changeTooltipText(e)})},t.horizontalTooltip=function(e,t,a){n().then(function(n){n.horizontalTooltip(e,t,a)})}},246:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isContainInvisibleChar=function(e){if(h.test(e))return!0;return!1},t.isAscii=f,t.isNumber=p,t.isLetter=v,t.isContainBannedChar=function(e){if(l.test(e))return!0;return!1},t.isSingleQuotationInEdge=function(e){if(u.test(e))return!0;return!1},t.isSheetNameValidateForCrossSheet=_,t.isColumnReferenceWithoutAbsolute=E,t.isStartWithCellReferenceNotColumnReference=T,t.readOneA1CellReference=function(e){var t=e.split(""),a="",o=m(t,0);if(o.success&&(a=o.reference,o.type===n.Column&&o.endIndex<t.length)){var i=m(t,o.endIndex);i.success&&i.type===n.Row&&(a+=i.reference)}return a},t.readOneA1Reference=m,t.getSheetNameForCorssSheet=g,t.getSheetsSyntaxFromAsteriskWildcard=function(e,t,a){var n=e.length;if(n<=1)return"";if(t<0||t>=n)return"";var o=e.slice(0,t),i=e.slice(t+1,n),r=S(o,a),s=S(i,a);return[r,s].filter(function(e){return""!==e}).join(",")},t.getSheetsSyntaxFromQuestionMarkWildcard=function(e,t,a,n){var o=e.length;if(o<=1)return"";if(t<0||t>=o)return"";var i=e.slice(0,t).filter(function(e){return R(e,a)}),r=e.slice(t+1,o).filter(function(e){return R(e,a)}),s=S(i,n),l=S(r,n);return[s,l].filter(function(e){return""!==e}).join(",")},t.getMultiSheetSyntax=S,t.isSheetNameMatchQuestionMarkWildcard=R;var n=t.ReferenceType=void 0;!function(e){e.Row="Row",e.Column="COLUMN",e.None="NONE"}(n||(t.ReferenceType=n={}));var o=[1,10,100,1e3,1e4,1e5,1e6],i=[1,26,676],r=1048576,s=16384,l=/[\*:\uff1a\[\]\?\\\/]/,u=/^'|'$/,d=/[:,\+\-\*\/\^%&=<(<>)(<=)>(>=)]/,c=/['\[\]\?\\%"\(\)\|\{\}#@!\$\^]/,h=/[\u0001\u0002\u0003\u0004\u0005\u0006\u0007\u0008\u0009\u000A\u000B\u000C\u000D\u000E\u000F\u0010\u0011\u0012\u0013\u0014\u0015\u0016\u0017\u0018\u0019\u001A\u001B\u001C\u001D\u001E\u001F\u007F]/;function f(e){return e<=127}function p(e){var t=e.charCodeAt(0);return!!f(t)&&(t>=48&&t<=57)}function v(e){var t=e.charCodeAt(0);if(!f(t))return!1;var a=32|t;return a>=97&&a<=122}function _(e){var t=e.split("");return!t||0===t.length||!p(t[0])&&(!!E(e)||!T(e)&&(!d.test(e)&&(!c.test(e)&&!(e.indexOf(" ")>=0))))}function E(e){var t=e.split("");if("$"===t[0])return!1;for(var a=!0,n=0,o=t.length;n<o;n++)if(!v(t[n])){a=!1;break}return a}function T(e){var t=e.split(""),a=m(t,0);if(a.success){if(a.type===n.Column){if(a.endIndex>=t.length)return!1;var o=m(t,a.endIndex);return!(!o.success||o.type!==n.Row)}return!0}return!1}function m(e,t){var a={success:!1,isRelative:!0,endIndex:t,type:n.None,reference:""},l=e.length;if(t>=l)return a;if("$"===e[t]&&(a.isRelative=!1,t++),t>=l)return a;var u=e[t];if(p(u)&&"0"!==u){a.type=n.Row;for(var d=t;d<l&&p(u);)++d<l&&(u=e[d]);if(d-t>7)return a;for(var c=0,h=d-1,f=0;h>=t;h--,f++)c+=(e[h].charCodeAt(0)-48)*o[f];if(c<=r)return a.endIndex=d,a.success=!0,a.reference=e.slice(t,d).join(""),a}else if(v(u)){a.type=n.Column;for(var _=t;_<l&&v(u);)++_<l&&(u=e[_]);if(_-t>3)return a;for(var E=0,T=_-1,m=0;T>=t;T--,m++)E+=((32|e[T].charCodeAt(0))-96)*i[m];if(E<=s)return a.endIndex=_,a.success=!0,a.reference=e.slice(t,_).join(""),a}return a}function g(e){return _(e)?e:"'"+e+"'"}function S(e,t){var a="";switch(e.length){case 0:a="";break;case 1:a=g(e[0])+"!"+t;break;default:var n=e[0],o=e[e.length-1],i=_(n),r=_(o);a=i&&r?n+":"+o+"!"+t:"'"+n+":"+o+"'!"+t}return a}function R(e,t){var a=t.length;if(a!==e.length)return!1;for(var n=e.toUpperCase(),o=t.toUpperCase(),i=0;i<a;i++)if("?"!==o[i]&&n[i]!==o[i])return!1;return!0}},250:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseLinkUrl=function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e=String(e).trim();var a=!/javascript:./i.test(e)&&(/^((http(s)?|ftp|file):\/\/)/i.test(e)||/\.com$/i.test(e)||/^www\./i.test(e)||/^(mailto:(\/\/)?)?([a-z0-9_\-\.])+\@([a-z0-9_\-\.])+\.([a-z]{2,})$/i.test(e));t&&!/^(https?|ftp|file)\:\/\//i.test(e)&&(e=/^(\/\/)/.test(e)?"http:"+e:"http://"+e);return a?e:null}},26:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TDW_REPORT_ACTION=t.SPEED_REPORT_LOG=t.CSS_LOAD_FILE_MAP=t.JS_LOAD_FILE_MAP=t.REG_CSS_LOAD_FILE=t.REG_JS_LOAD_FILE=t.SPEED_REPORT_POINTS=t.EDIT_SPEED_REPORT_POINTS=t.SPEED_MARK_POINTS=t.TDW_VER5_VALUE=t.TDW_ACTION=t.TDW_MODULE=t.getTdwObj3Value=t.SENTRY_ERROR_TYPE=t.MONITOR_POINTS=t.CONFIG=t.reportTDWFlag=t.reportMonitorFlag=t.reportSpeedFlag=t.reportFlag=void 0;var n,o,i,r,s,l=a(83),u=(n=l)&&n.__esModule?n:{default:n};var d;!function(e){e[e.HISTORY=-1]="HISTORY",e[e.LOCAL=0]="LOCAL",e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO",e[e.COLLAB=3]="COLLAB"}(d||(d={}));var c,h,f,p,v,_,E={SHEET_ROW_COUNT_EXCEED:33977078,SHEET_COL_COUNT_EXCEED:33977079,SHEET_CELL_COUNT_EXCEED:33977080,CHECK_MUTATION_ERROR:33624582,CHECK_MUTATION_FAIL_MAP:(o={},(0,u.default)(o,d.HISTORY,33692346),(0,u.default)(o,d.LOCAL,33692347),(0,u.default)(o,d.UNDO,33692348),(0,u.default)(o,d.REDO,33692349),(0,u.default)(o,d.COLLAB,33692350),o),RUN_MUTATION_ERROR_MAP:(i={},(0,u.default)(i,d.HISTORY,33692646),(0,u.default)(i,d.LOCAL,33692647),(0,u.default)(i,d.UNDO,33692648),(0,u.default)(i,d.REDO,33692649),(0,u.default)(i,d.COLLAB,33692650),i),SERIALIZE_MUTATION_ERROR:33611128,DESERIALIZE_MUTATION_ERROR:33611915,DESERIALIZE_MUTATION_FAIL:33693655,MUTATION_VER_LOWER_THAN_SUPPORT:33910951,CONVERT_MUTATION_ERROR:33910952,MERGE_GRID_RANGE_ERROR:33659770,MERGE_ALREADY_EXIST:33659722,MERGE_POSITION_CENTER_KEY_NOT_EXIST:33659723};!function(e){e.CHECK_MUTATION_ERROR="CheckMutationError",e.RUN_MUTATION_ERROR="RunMutationError",e.SERIALIZE_MUTATION_ERROR="SerializeMutationError",e.DESERIALIZE_MUTATION_ERROR="DeserializeMutationError"}(c||(t.SENTRY_ERROR_TYPE=c={})),function(e){e.MUTATION="mutation"}(h||(t.TDW_MODULE=h={})),function(e){e.CHECK_MUTATION="checkMutation",e.RUN_MUTATION="runMutation",e.SERIALIZE_MUTATION="serializeMutation",e.DESERIALIZE_MUTATION="deserializeMutation",e.GENERATE_MUTATION="generateMutation"}(f||(t.TDW_ACTION=f={})),function(e){e.CHECK_MUTATION_ERROR="1",e.CHECK_MUTATION_FAIL="2",e.RUN_MUTATION_ERROR="1",e.SERIALIZE_MUTATION_ERROR="1",e.DESERIALIZE_MUTATION_ERROR="1",e.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_OPTION="1",e.GENERATE_MUTATION_PASTE_INSERT_ERROR_NO_EXPANSION="2",e.GENERATE_MUTATION_PASTE_SETRANGE_ERROR_NO_GRIDRANGE="3"}(p||(t.TDW_VER5_VALUE=p={})),function(e){e[e.SWITCH_SHEET_TIME_START=0]="SWITCH_SHEET_TIME_START",e[e.SWITCH_SHEET_TIME_END=1]="SWITCH_SHEET_TIME_END",e[e.CANVAS_TRANSFROM_START=2]="CANVAS_TRANSFROM_START",e[e.CANVAS_TRANSFROM_END=3]="CANVAS_TRANSFROM_END",e[e.CANVAS_RENDER_START=4]="CANVAS_RENDER_START",e[e.CANVAS_RENDER_END=5]="CANVAS_RENDER_END",e[e.PASTE_START=6]="PASTE_START",e[e.PASTE_END=7]="PASTE_END",e[e.TIME_COPY_START=8]="TIME_COPY_START",e[e.TIME_COPY_END=9]="TIME_COPY_END",e[e.MUTATIONS_RUN_START=10]="MUTATIONS_RUN_START",e[e.MUTATIONS_RUN_END=11]="MUTATIONS_RUN_END"}(v||(t.SPEED_MARK_POINTS=v={})),function(e){e[e.NAVIGATION_TO_FETCH=1]="NAVIGATION_TO_FETCH",e[e.FETCH_TO_REQUEST=2]="FETCH_TO_REQUEST",e[e.HTML_TO_REQUEST=3]="HTML_TO_REQUEST",e[e.CORE_TO_REQUEST=4]="CORE_TO_REQUEST",e[e.BOOT_START=5]="BOOT_START",e[e.BOOT_END=6]="BOOT_END",e[e.SPREAD_TO_REQUEST=7]="SPREAD_TO_REQUEST",e[e.SPREAD_INIT_START=8]="SPREAD_INIT_START",e[e.SPREAD_INIT_DATA_START=9]="SPREAD_INIT_DATA_START",e[e.SPREAD_INIT_END=10]="SPREAD_INIT_END",e[e.DATA_START=11]="DATA_START",e[e.DATA_END=12]="DATA_END",e[e.VIEW_START=13]="VIEW_START",e[e.VIEW_NEW_START=14]="VIEW_NEW_START",e[e.VIEW_NEW_END=15]="VIEW_NEW_END",e[e.VIEW_END=16]="VIEW_END",e[e.SPREAD_INIT_DATA_END=17]="SPREAD_INIT_DATA_END",e[e.SPREAD_INIT_FINISHED=18]="SPREAD_INIT_FINISHED",e[e.DNS=28]="DNS",e[e.CONNECT=29]="CONNECT",e[e.HTML_TTFB=30]="HTML_TTFB",e[e.HTML_LOAD=31]="HTML_LOAD",e[e.WHITE_SCREEN=32]="WHITE_SCREEN",e[e.SYNC_JS_RUN=33]="SYNC_JS_RUN",e[e.TOTAL_JS_RUN=34]="TOTAL_JS_RUN",e[e.DOM_CONTENT_LOAD=35]="DOM_CONTENT_LOAD",e[e.WINDOW_LOAD=36]="WINDOW_LOAD",e[e.KEYFRAME_MUTATIONS_LOAD=37]="KEYFRAME_MUTATIONS_LOAD",e[e.KEYFRAME_TRANSFORM=117]="KEYFRAME_TRANSFORM",e[e.KEYFRAME_V0_DESERIALIZATION=132]="KEYFRAME_V0_DESERIALIZATION",e[e.KEYFRAME_DESERIALIZATION=38]="KEYFRAME_DESERIALIZATION",e[e.AFTER_KEYFRAME_RUN=118]="AFTER_KEYFRAME_RUN",e[e.MUTATIONS_DESERIALIZATION_AND_RUN=121]="MUTATIONS_DESERIALIZATION_AND_RUN",e[e.MUTATIONS_DESERIALIZATION=39]="MUTATIONS_DESERIALIZATION",e[e.MUTATIONS_RUN=119]="MUTATIONS_RUN",e[e.AFTER_MUTATIONS_RUN=120]="AFTER_MUTATIONS_RUN",e[e.DATA_HANDLE=40]="DATA_HANDLE",e[e.RENDER=41]="RENDER",e[e.FIRST_SCREEN=42]="FIRST_SCREEN",e[e.INTERACTABLE=43]="INTERACTABLE",e[e.FORMULA_DEPENDENCY_GRAPH=44]="FORMULA_DEPENDENCY_GRAPH",e[e.FORMULA_TOTAL_CALCULATION=45]="FORMULA_TOTAL_CALCULATION",e[e.JS_LOAD_PUBLIC_JQUERY=49]="JS_LOAD_PUBLIC_JQUERY",e[e.JS_LOAD_PUBLIC_JQUERY_UI=50]="JS_LOAD_PUBLIC_JQUERY_UI",e[e.JS_LOAD_PUBLIC_QQAPI=51]="JS_LOAD_PUBLIC_QQAPI",e[e.JS_LOAD_PUBLIC_RAVEN=52]="JS_LOAD_PUBLIC_RAVEN",e[e.JS_LOAD_PUBLIC_SOCKET=53]="JS_LOAD_PUBLIC_SOCKET",e[e.JS_LOAD_PUBLIC_WEBLOG=54]="JS_LOAD_PUBLIC_WEBLOG",e[e.JS_LOAD_CORE_SHEET_PC=55]="JS_LOAD_CORE_SHEET_PC",e[e.JS_LOAD_SPREAD_SHEET_PC=56]="JS_LOAD_SPREAD_SHEET_PC",e[e.JS_LOAD_CORE_SHEET_MOBILE=57]="JS_LOAD_CORE_SHEET_MOBILE",e[e.JS_LOAD_SPREAD_SHEET_MOBILE=58]="JS_LOAD_SPREAD_SHEET_MOBILE",e[e.JS_LOAD_CORE_SHEET_PAD=59]="JS_LOAD_CORE_SHEET_PAD",e[e.JS_LOAD_SPREAD_SHEET_PAD=60]="JS_LOAD_SPREAD_SHEET_PAD",e[e.TOTAL_JS_LOAD=61]="TOTAL_JS_LOAD",e[e.CSS_LOAD_CORE_SHEET_PC=62]="CSS_LOAD_CORE_SHEET_PC",e[e.CSS_LOAD_SPREAD_SHEET_PC=63]="CSS_LOAD_SPREAD_SHEET_PC",e[e.CSS_LOAD_CORE_SHEET_MOBILE=64]="CSS_LOAD_CORE_SHEET_MOBILE",e[e.CSS_LOAD_SPREAD_SHEET_MOBILE=65]="CSS_LOAD_SPREAD_SHEET_MOBILE",e[e.CSS_LOAD_CORE_SHEET_PAD=66]="CSS_LOAD_CORE_SHEET_PAD",e[e.CSS_LOAD_SPREAD_SHEET_PAD=67]="CSS_LOAD_SPREAD_SHEET_PAD",e[e.TOTAL_CSS_LOAD=68]="TOTAL_CSS_LOAD",e[e.SWITCH_SHEET=69]="SWITCH_SHEET",e[e.FIRST_SCREEN_LESS_10=83]="FIRST_SCREEN_LESS_10",e[e.FIRST_SCREEN_MORE_10=84]="FIRST_SCREEN_MORE_10",e[e.RENDER_TRANSFORM=85]="RENDER_TRANSFORM",e[e.RENDER_CANVAS=86]="RENDER_CANVAS",e[e.RENDER_DATA=87]="RENDER_DATA",e[e.RENDER_SEGMENTATION=88]="RENDER_SEGMENTATION",e[e.RENDER_META=89]="RENDER_META",e[e.INTERACTABLE_WORKER=97]="INTERACTABLE_WORKER",e[e.DOM_CONTENT_LOAD_WORKER=98]="DOM_CONTENT_LOAD_WORKER",e[e.WINDOW_LOAD_WORKER=99]="WINDOW_LOAD_WORKER",e[e.RENDER_INIT_UI=100]="RENDER_INIT_UI",e[e.RENDER_CHECK_ROW_HEIGHT=101]="RENDER_CHECK_ROW_HEIGHT",e[e.RENDER_TABLE_BODY=102]="RENDER_TABLE_BODY",e[e.RENDER_CACHE_IMG=125]="RENDER_CACHE_IMG",e[e.WHITE_SCREEN_NO_EXECUTE=126]="WHITE_SCREEN_NO_EXECUTE",e[e.SPREAD_RUN=127]="SPREAD_RUN",e[e.QUICKLOOK=128]="QUICKLOOK",e[e.LOAD_CGI_DATA_TIME=130]="LOAD_CGI_DATA_TIME",e[e.RUN_STARTER_JS_TIME=131]="RUN_STARTER_JS_TIME",e[e.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME=133]="LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME",e[e.TIME_PASTE_FROM_OUTER=134]="TIME_PASTE_FROM_OUTER",e[e.TIME_PASTE_FROM_INNTER=135]="TIME_PASTE_FROM_INNTER",e[e.TIME_COPY=136]="TIME_COPY",e[e.RENDER_OVER=140]="RENDER_OVER",e[e.FRONT_DOWNLOAD=141]="FRONT_DOWNLOAD"}(_||(t.SPEED_REPORT_POINTS=_={}));var T,m={"jquery-1":_.JS_LOAD_PUBLIC_JQUERY,"jquery-ui":_.JS_LOAD_PUBLIC_JQUERY_UI,qqapi:_.JS_LOAD_PUBLIC_QQAPI,"raven:":_.JS_LOAD_PUBLIC_RAVEN,socket:_.JS_LOAD_PUBLIC_SOCKET,"wl.v3":_.JS_LOAD_PUBLIC_WEBLOG,"core-sheet-pc":_.JS_LOAD_CORE_SHEET_PC,"spread-sheet-pc":_.JS_LOAD_SPREAD_SHEET_PC,"core-sheet-mobile":_.JS_LOAD_CORE_SHEET_MOBILE,"spread-sheet-mobile":_.JS_LOAD_SPREAD_SHEET_MOBILE,"core-sheet-pad":_.JS_LOAD_CORE_SHEET_PAD,"spread-sheet-pad":_.JS_LOAD_SPREAD_SHEET_PAD},g={"core-sheet-pc":_.CSS_LOAD_CORE_SHEET_PC,"spread-sheet-pc":_.CSS_LOAD_SPREAD_SHEET_PC,"core-sheet-mobile":_.CSS_LOAD_CORE_SHEET_MOBILE,"spread-sheet-mobile":_.CSS_LOAD_SPREAD_SHEET_MOBILE,"core-sheet-pad":_.CSS_LOAD_CORE_SHEET_PAD,"spread-sheet-pad":_.CSS_LOAD_SPREAD_SHEET_PAD};!function(e){e[e.FORMULA_CALCULATION_WITH_MUTATION=46]="FORMULA_CALCULATION_WITH_MUTATION",e[e.FORMULA_SINGLE_BATCH_CALCULATION=47]="FORMULA_SINGLE_BATCH_CALCULATION",e[e.FORMULA_CALCULATE_SINGLE_CELL_FORMULA=48]="FORMULA_CALCULATE_SINGLE_CELL_FORMULA",e[e.SWITCH_SHEET=69]="SWITCH_SHEET",e[e.APPLY_FILTER=70]="APPLY_FILTER",e[e.APPLY_COPY_PASTE=71]="APPLY_COPY_PASTE",e[e.APPLY_REORDER=72]="APPLY_REORDER"}(T||(t.EDIT_SPEED_REPORT_POINTS=T={}));var S=(r={},(0,u.default)(r,_.DNS,"[\u6253\u5f00]DNS\u67e5\u8be2"),(0,u.default)(r,_.CONNECT,"[\u6253\u5f00]\u5efa\u7acb\u8fde\u63a5"),(0,u.default)(r,_.HTML_TTFB,"[\u6253\u5f00]html\u7684ttfb\u8017\u65f6"),(0,u.default)(r,_.HTML_LOAD,"[\u6253\u5f00]html\u52a0\u8f7d\u8017\u65f6"),(0,u.default)(r,_.WHITE_SCREEN,"[\u6253\u5f00]\u767d\u5c4f\u65f6\u95f4"),(0,u.default)(r,_.SPREAD_RUN,"[\u6253\u5f00]spread\u4ecenavi\u5230\u5f00\u59cb\u6267\u884c\u65f6\u95f4"),(0,u.default)(r,_.SYNC_JS_RUN,"[\u6253\u5f00]\u540c\u6b65js\u6267\u884c\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.TOTAL_JS_RUN,"[\u6253\u5f00]\u6240\u6709js\u6267\u884c\u8017\u65f6+\u56fe\u7247\u52a0\u8f7d\u5b8c\u6210\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.DOM_CONTENT_LOAD,"[\u6253\u5f00]\u6574\u4f53\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.WINDOW_LOAD,"[\u6253\u5f00]\u6574\u4f53\u8017\u65f6\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.KEYFRAME_MUTATIONS_LOAD,"[\u6253\u5f00]keyframe+mutations\u62c9\u53d6\u8017\u65f6"),(0,u.default)(r,_.KEYFRAME_TRANSFORM,"[\u6253\u5f00]keyframe\u89e3\u6790\u8017\u65f6"),(0,u.default)(r,_.KEYFRAME_DESERIALIZATION,"[\u6253\u5f00]keyframe\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,u.default)(r,_.KEYFRAME_V0_DESERIALIZATION,"[\u6253\u5f00]\u5bfc\u5165\u7684keyframeV0\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,u.default)(r,_.AFTER_KEYFRAME_RUN,"[\u6253\u5f00]afterKeyframeRun\u8017\u65f6"),(0,u.default)(r,_.MUTATIONS_DESERIALIZATION_AND_RUN,"[\u6253\u5f00]mutations\u53cd\u5e8f\u5217\u5316\u4e0e\u6267\u884c\u8017\u65f6"),(0,u.default)(r,_.MUTATIONS_DESERIALIZATION,"[\u6253\u5f00]mutations\u53cd\u5e8f\u5217\u5316\u8017\u65f6"),(0,u.default)(r,_.MUTATIONS_RUN,"[\u6253\u5f00]mutations\u6267\u884c\u8017\u65f6"),(0,u.default)(r,_.AFTER_MUTATIONS_RUN,"[\u6253\u5f00]afterMutationsRun\u8017\u65f6"),(0,u.default)(r,_.DATA_HANDLE,"[\u6253\u5f00]\u6570\u636e\u5c42\u6574\u4f53\u89e3\u6790\u8017\u65f6"),(0,u.default)(r,_.RENDER,"[\u6253\u5f00]alloyExcel\u6e32\u67d3\u8017\u65f6"),(0,u.default)(r,_.RENDER_TRANSFORM,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u6570\u636e\u5c42\u8f6c\u6362\u6570\u636e\u4e3a\u6e32\u67d3\u5c42"),(0,u.default)(r,_.RENDER_CANVAS,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u6e32\u67d3\u5c42\u771f\u6b63\u8017\u65f6"),(0,u.default)(r,_.RENDER_DATA,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u5904\u7406\u6570\u636e"),(0,u.default)(r,_.RENDER_INIT_UI,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1ainit ui\u603b\u6267\u884c\u65f6\u95f4"),(0,u.default)(r,_.RENDER_CHECK_ROW_HEIGHT,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1acheckRowHeight"),(0,u.default)(r,_.RENDER_TABLE_BODY,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1atable body(\u5305\u542b\u5355\u5143\u683c\u5206\u6bb5\uff0c\u8986\u76d6\u6027\u548c\u8fb9\u6846\u7ebf\u521d\u59cb\u5316)\u6267\u884c\u65f6\u95f4"),(0,u.default)(r,_.RENDER_META,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u5904\u7406\u5176\u4ed6\u4fe1\u606f\uff08\u7b5b\u9009\u3001\u51bb\u7ed3\u7b49\uff09"),(0,u.default)(r,_.FIRST_SCREEN,"[\u6253\u5f00]\u9996\u5c4f"),(0,u.default)(r,_.INTERACTABLE,"[\u6253\u5f00]\u53ef\u4ea4\u4e92"),(0,u.default)(r,_.FORMULA_DEPENDENCY_GRAPH,"[\u6253\u5f00]\u51fd\u6570\u4f9d\u8d56\u56fe"),(0,u.default)(r,_.FORMULA_TOTAL_CALCULATION,"[\u6253\u5f00]\u51fd\u6570\u8ba1\u7b97\u603b\u8017\u65f6"),(0,u.default)(r,_.TOTAL_JS_LOAD,"[\u6253\u5f00]js\u603b\u52a0\u8f7d\u8017\u65f6"),(0,u.default)(r,_.TOTAL_CSS_LOAD,"[\u6253\u5f00]css\u603b\u52a0\u8f7d\u8017\u65f6"),(0,u.default)(r,T.FORMULA_CALCULATION_WITH_MUTATION,"[\u7f16\u8f91]mutation\u89e6\u53d1\u51fd\u6570\u8ba1\u7b97\u603b\u8017\u65f6"),(0,u.default)(r,T.FORMULA_SINGLE_BATCH_CALCULATION,"[\u7f16\u8f91]\u5355\u6279\u6b21\u51fd\u6570\u6301\u7eed\u8017\u65f6"),(0,u.default)(r,T.FORMULA_CALCULATE_SINGLE_CELL_FORMULA,"[\u7f16\u8f91]\u5173\u952e\u51fd\u6570calculateSingleCellFormula\u8017\u65f6"),(0,u.default)(r,T.SWITCH_SHEET,"[\u7f16\u8f91]\u5207sheet\u8017\u65f6"),(0,u.default)(r,_.INTERACTABLE_WORKER,"[\u6253\u5f00][worker]\u53ef\u4ea4\u4e92"),(0,u.default)(r,_.DOM_CONTENT_LOAD_WORKER,"[\u6253\u5f00][worker]\u6574\u4f53\u8017\u65f6\uff08\u4e3b\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.WINDOW_LOAD_WORKER,"[\u6253\u5f00][worker]\u6574\u4f53\u8017\u65f6\uff08\u6574\u4f53\u53ef\u4ea4\u4e92\uff09"),(0,u.default)(r,_.RENDER_CACHE_IMG,"[\u79d2\u770b]\u903b\u8f91\u8017\u65f6"),(0,u.default)(r,_.QUICKLOOK,"[\u79d2\u770b]\u79d2\u770b\u9996\u5c4f"),(0,u.default)(r,_.LOAD_CGI_DATA_TIME,"CGI\u6570\u636e\u52a0\u8f7d\u65f6\u95f4"),(0,u.default)(r,_.RUN_STARTER_JS_TIME,"\u524d\u7f6e\u903b\u8f91\u6267\u884c\u65f6\u95f4"),(0,u.default)(r,_.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME,"CGI\u6570\u636e\u52a0\u8f7d\u65f6\u95f4\u51cf\u53bb\u524d\u7f6e\u903b\u8f91\u6267\u884c\u65f6\u95f4"),(0,u.default)(r,_.RENDER_OVER,"[\u6253\u5f00]\u6e32\u67d3\u5c42\uff1a\u7ed3\u675f\u6e32\u67d3"),(0,u.default)(r,_.FRONT_DOWNLOAD,"\u524d\u7aef\u4e0b\u8f7d\u8017\u65f6"),r),R=(s={},(0,u.default)(s,_.NAVIGATION_TO_FETCH,"navigation_to_fetch"),(0,u.default)(s,_.FETCH_TO_REQUEST,"fetch_to_request"),(0,u.default)(s,_.HTML_TO_REQUEST,"html_to_request"),(0,u.default)(s,_.CORE_TO_REQUEST,"core_to_request"),(0,u.default)(s,_.BOOT_START,"boot_start"),(0,u.default)(s,_.BOOT_END,"boot_end"),(0,u.default)(s,_.SPREAD_TO_REQUEST,"spread_to_request"),(0,u.default)(s,_.SPREAD_INIT_START,"spread_init_start"),(0,u.default)(s,_.SPREAD_INIT_DATA_START,"spread_init_data_start"),(0,u.default)(s,_.SPREAD_INIT_END,"spread_init_end"),(0,u.default)(s,_.DATA_START,"data_start"),(0,u.default)(s,_.DATA_END,"data_end"),(0,u.default)(s,_.VIEW_START,"view_start"),(0,u.default)(s,_.VIEW_END,"view_end"),(0,u.default)(s,_.VIEW_NEW_START,"view_new_start"),(0,u.default)(s,_.VIEW_NEW_END,"view_new_end"),(0,u.default)(s,_.SPREAD_INIT_DATA_END,"spread_init_data_end"),(0,u.default)(s,_.SPREAD_INIT_FINISHED,"spread_init_finished"),(0,u.default)(s,_.DNS,"dns"),(0,u.default)(s,_.CONNECT,"connect"),(0,u.default)(s,_.HTML_TTFB,"html_ttfb"),(0,u.default)(s,_.HTML_LOAD,"html_load"),(0,u.default)(s,_.WHITE_SCREEN,"white_screen"),(0,u.default)(s,_.SYNC_JS_RUN,"sync_js_run"),(0,u.default)(s,_.TOTAL_JS_RUN,"total_js_run"),(0,u.default)(s,_.KEYFRAME_MUTATIONS_LOAD,"keyframe_mutations_load"),(0,u.default)(s,_.KEYFRAME_TRANSFORM,"keyframe_transform"),(0,u.default)(s,_.KEYFRAME_V0_DESERIALIZATION,"keyframe_v0_deserialization"),(0,u.default)(s,_.KEYFRAME_DESERIALIZATION,"keyframe_deserialization"),(0,u.default)(s,_.AFTER_KEYFRAME_RUN,"after_keyframe_run"),(0,u.default)(s,_.MUTATIONS_DESERIALIZATION_AND_RUN,"mutations_deserialization_and_run"),(0,u.default)(s,_.MUTATIONS_DESERIALIZATION,"mutations_deserialization"),(0,u.default)(s,_.MUTATIONS_RUN,"mutations_run"),(0,u.default)(s,_.AFTER_MUTATIONS_RUN,"after_mutations_run"),(0,u.default)(s,_.DATA_HANDLE,"data_handle"),(0,u.default)(s,_.RENDER,"render"),(0,u.default)(s,_.FIRST_SCREEN,"first_screen"),(0,u.default)(s,_.INTERACTABLE,"interactable"),(0,u.default)(s,_.FORMULA_DEPENDENCY_GRAPH,"formula_dependency_graph"),(0,u.default)(s,_.FORMULA_TOTAL_CALCULATION,"formula_total_calculation"),(0,u.default)(s,_.TOTAL_JS_LOAD,"total_js_load"),(0,u.default)(s,_.TOTAL_CSS_LOAD,"total_css_load"),(0,u.default)(s,_.FIRST_SCREEN_LESS_10,"first_screen_less_10"),(0,u.default)(s,_.FIRST_SCREEN_MORE_10,"first_screen_more_10"),(0,u.default)(s,_.RENDER_TRANSFORM,"render_transform"),(0,u.default)(s,_.RENDER_CANVAS,"render_canvas"),(0,u.default)(s,_.RENDER_DATA,"render_data"),(0,u.default)(s,_.RENDER_SEGMENTATION,"render_segmentation"),(0,u.default)(s,_.RENDER_META,"render_meta"),(0,u.default)(s,_.DOM_CONTENT_LOAD,"dom_content_load"),(0,u.default)(s,_.WINDOW_LOAD,"window_load"),(0,u.default)(s,_.RENDER_CACHE_IMG,"quick_look_img"),(0,u.default)(s,_.QUICKLOOK,"quick_look"),(0,u.default)(s,_.LOAD_CGI_DATA_TIME,"load_cgi_data_time"),(0,u.default)(s,_.RUN_STARTER_JS_TIME,"run_starter_js_time"),(0,u.default)(s,_.LOAD_CGI_DATA_TIME_MINUS_RUN_STARTER_JS_TIME,"load_cgi_data_minus_run_starter_js_time"),(0,u.default)(s,T.SWITCH_SHEET,"switch_sheet_cost"),(0,u.default)(s,_.RENDER_OVER,"render_over"),(0,u.default)(s,_.FRONT_DOWNLOAD,"front_download"),s);t.reportFlag=!0,t.reportSpeedFlag=!0,t.reportMonitorFlag=!0,t.reportTDWFlag=!0,t.CONFIG={CHECK_MUTATION_ERROR:"CHECK_MUTATION_ERROR",RUN_MUTATION_ERROR:"RUN_MUTATION_ERROR",CHECK_MUTATION_RESULT_ERROR:"CHECK_MUTATION_RESULT_ERROR",AFTER_MUTATION_RUN_CATCH_ERROR:"AFTER_MUTATION_RUN_CATCH_ERROR",COMMIT_EMPTY_MUTATION:"COMMIT_EMPTY_MUTATION",DO_BEHAVIOR_AFTER_SHUTDOWN:"DO_BEHAVIOR_AFTER_SHUTDOWN",COMMIT_MUTATION_CATCH_ERROR:"COMMIT_MUTATION_CATCH_ERROR",COMMIT_MUTATION:"COMMIT_MUTATION",CACHE_DATA_FLOW_COMMIT_MUTATION:"CACHE_DATA_FLOW_COMMIT_MUTATION",PAGE_LOAD:"PAGE_LOAD",DUPLICATE_SHEET_ID:"DUPLICATE_SHEET_ID",SERIALIZE_MUTATION:"SERIALIZE_MUTATION",DESERIALIZE_MUTATION:"DESERIALIZE_MUTATION",GET_COLLAB_MUTATIONS:"GET_COLLAB_MUTATIONS",CREATE_ZIPKETFRAME:"CREATE_ZIPKETFRAME",APPLY_NEW_CHANGES_ERROR:"APPLY_NEW_CHANGES_ERROR",LOAD_REQUEST:"LOAD_REQUEST",APPLY_BEHAVIOR_ERROR:"APPLY_BEHAVIOR_ERROR",APPLY_BEHAVIOR_NOT_LOADED:"APPLY_BEHAVIOR_NOT_LOADED",APPLY_BEHAVIOR_LEVEL_INFO:"APPLY_BEHAVIOR_LEVEL_INFO",APPLY_BEHAVIOR_LEVEL_IMPORTANT:"APPLY_BEHAVIOR_LEVEL_IMPORTANT",APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR:"APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR",REQUEST_SIZE_OVER_LIMIT:"REQUEST_SIZE_OVER_LIMIT",FOLLOW_REQUEST_MUTATIONS:"FOLLOW_REQUEST_MUTATIONS",SERIALIZE_MUTATION_CACHE_ERROR:"SERIALIZE_MUTATION_CACHE_ERROR",DESERIALIZE_MUTATION_CACHE_ERROR:"DESERIALIZE_MUTATION_CACHE_ERROR",GENERATE_MUTATION_1:"GENERATE_MUTATION_1",GENERATE_MUTATION_2:"GENERATE_MUTATION_2",GENERATE_MUTATION_3:"GENERATE_MUTATION_3",DO_KEYFRAME_CATCH_ERROR_1:"DO_KEYFRAME_CATCH_ERROR_1",DO_KEYFRAME_CATCH_ERROR_2:"DO_KEYFRAME_CATCH_ERROR_2",DO_KEYFRAME_CATCH_ERROR_3:"DO_KEYFRAME_CATCH_ERROR_3",DO_KEYFRAME:"DO_KEYFRAME",DO_MUTATIONS:"DO_MUTATIONS",ZIP_KEYFRAME:"ZIP_KEYFRAME",ZIP_KEYFRAME_CATCH_ERROR:"ZIP_KEYFRAME_CATCH_ERROR",COPY_PASTE:"COPY_PASTE",CHOOSE_FORMAT_ERROR:"CHOOSE_FORMAT_ERROR",PARSE_FORMAT_ERROR:"PARSE_FORMAT_ERROR",RETRY_SENDMESSAGE:"RETRY_SENDMESSAGE",MOVE_MESSAGEINFO_COMMITING_QUEUE:"MOVE_MESSAGEINFO_COMMITING_QUEUE",RETRY_COMMIT:"RETRY_COMMIT",SEND_USERCHANGE:"SEND_USERCHANGE",SEND_USERCHANGE_1:"SEND_USERCHANGE_1",HANDLE_COMMIT_ONSENDERROR:"HANDLE_COMMIT_ONSENDERROR",ACCEPT_COMMIT:"ACCEPT_COMMIT",HANDLE_COMMIT_ERROR:"HANDLE_COMMIT_ERROR",HANDLE_TASK_DUPLICATE:"HANDLE_TASK_DUPLICATE",HANDLE_ROOM_ERRORCODE:"HANDLE_ROOM_ERRORCODE",HANDLE_NEW_CHANGES:"HANDLE_NEW_CHANGES",APPLY_NEWCHANGES_VERROR:"APPLY_NEWCHANGES_VERROR",DUPLICATE_MESSAGE:"DUPLICATE_MESSAGE",APPLY_NEWCHANGES_CATCH_ERROR:"APPLY_NEWCHANGES_CATCH_ERROR",APPLY_NEWCHANGES:"APPLY_NEWCHANGES",CHECK_AND_APPLYNEWCHANGES:"CHECK_AND_APPLYNEWCHANGES",APPLY_NEWCHANGES_VERROR2:"APPLY_NEWCHANGES_VERROR2",SWITCH_CHANEL_STATUS:"SWITCH_CHANEL_STATUS",HANDLE_FETCH_RESULT:"HANDLE_FETCH_RESULT",FETCH_USERCHANGES_ERROR:"FETCH_USERCHANGES_ERROR",FETCH_AND_APPLY_MISSCHANGES:"FETCH_AND_APPLY_MISSCHANGES",EMPTY_KEYFRAME_BY_AUTOEXPAND:"EMPTY_KEYFRAME_BY_AUTOEXPAND",ADD_USER_CHANGE:"ADD_USER_CHANGE",UPDATE_BASEVERSION:"UPDATE_BASEVERSION",UPDATE_BASEVERSION_ERROR:"UPDATE_BASEVERSION_ERROR",ACCEPT_COMMIT_2:"ACCEPT_COMMIT_2",FETCH_USERCHANGE_ARGUMENT:"FETCH_USERCHANGE_ARGUMENT",FETCH_USERCHANGES:"FETCH_USERCHANGES",FETCH_USERCHANGES_3:"FETCH_USERCHANGES_3",INIT_DATA_ERROR:"INIT_DATA_ERROR",STORE_DATA_ERROR:"STORE_DATA_ERROR",NOT_SUPPORT_INDEXEDDB:"NOT_SUPPORT_INDEXEDDB",OPEN_INDEXED_DB:"OPEN_INDEXED_DB",NOT_SUPPORT_INDEXEDDB_2:"NOT_SUPPORT_INDEXEDDB_2",NOT_SUPPORT_INDEXEDDB_3:"NOT_SUPPORT_INDEXEDDB_3",UPDATE_INDEXED_DB:"UPDATE_INDEXED_DB",STORE_UNVALIABLE_WHEN_SET:"STORE_UNVALIABLE_WHEN_SET",INDEXDB_SET_VALUE:"INDEXDB_SET_VALUE",INDEXDB_SET_VALUE_ONERROR:"INDEXDB_SET_VALUE_ONERROR",CHANGE_DATAKEY:"CHANGE_DATAKEY",STORE_UNVALIABLE_WHEN_UPDATE:"STORE_UNVALIABLE_WHEN_UPDATE",INDEXEDDB_UPDATE_VALUE:"INDEXEDDB_UPDATE_VALUE",INDEXEDDB_UPDATE_VALUE_2:"INDEXEDDB_UPDATE_VALUE_2",INDEXEDDB_UPDATE_VALUE_3:"INDEXEDDB_UPDATE_VALUE_3",INDEXEDDB_UPDATE_VALUE_4:"INDEXEDDB_UPDATE_VALUE_4",DELETE_DATA_ERROR:"DELETE_DATA_ERROR",DELETE_VALUE:"DELETE_VALUE",DELETE_VALUE_2:"DELETE_VALUE_2",CLEAR_DATA_ERROR:"CLEAR_DATA_ERROR",CLEAR_DATA:"CLEAR_DATA",CLEAR_DATA_2:"CLEAR_DATA_2",GET_DATA_ERROR:"GET_DATA_ERROR",GET_DATA:"GET_DATA",GET_DATA_ERROR_2:"GET_DATA_ERROR_2",GET_DATA_SUCC:"GET_DATA_SUCC",NETWORK_ERROR:"NETWORK_ERROR",ACCEPT_MESSAGE:"ACCEPT_MESSAGE",ROOM_STATE_CHANGE:"ROOM_STATE_CHANGE",HANDLE_SHUTDOWN:"HANDLE_SHUTDOWN",SWITCH_SHEET_IN_PREVIEW:"SWITCH_SHEET_IN_PREVIEW",PREVIEW_SERVER_SHEET_DATA:"PREVIEW_SERVER_SHEET_DATA",PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE:"PREVIEW_SERVER_SHEET_DATA_ON_RESPONSE",SWITCH_SHEET_ON_SUCCESS:"SWITCH_SHEET_ON_SUCCESS",SWITCH_SHEET_ON_FAIL:"SWITCH_SHEET_ON_FAIL",DUPLICATE_SHEET_ID_2:"DUPLICATE_SHEET_ID_2",DUPLICATE_SHEET_ID_3:"DUPLICATE_SHEET_ID_3",FETCH_DATA_ERROR:"FETCH_DATA_ERROR",FETCH_DATA_ERROR_2:"FETCH_DATA_ERROR_2",K2S_CONVERTER:"K2S_CONVERTER",RELOAD_TIP:"RELOAD_TIP",RELOAD_TIP_DEBUG:"RELOAD_TIP_DEBUG",INIT_OFFLINE_STORE_ERROR:"INIT_OFFLINE_STORE_ERROR",GET_OFFLINE_DATA:"GET_OFFLINE_DATA",GET_OFFLINE_DATA_WAITING_QUEUE:"GET_OFFLINE_DATA_WAITING_QUEUE",CHANGEDATAKEY_CATCH_ERROR:"CHANGEDATAKEY_CATCH_ERROR",SETDATA_CATCH_ERROR:"SETDATA_CATCH_ERROR",UPDATEDATA_CATCH_ERROR:"UPDATEDATA_CATCH_ERROR",DELETEDATA_CATCH_ERROR:"DELETEDATA_CATCH_ERROR",CLEARDATA_CATCH_ERROR:"CLEARDATA_CATCH_ERROR",GETDATA_CATCH_ERROR:"GETDATA_CATCH_ERROR",SWITCH_SHEET_SERVER_FAIL:"SWITCH_SHEET_SERVER_FAIL",SWITCH_SHEET_FRONT_FAIL:"SWITCH_SHEET_FRONT_FAIL",PARSE_KEYFRAME_ERROR:"PARSE_KEYFRAME_ERROR",UNZIP_KEYFRAME_ERROR:"UNZIP_KEYFRAME_ERROR",PARSE_KEYFRAME_ERROR_2:"PARSE_KEYFRAME_ERROR_2",UNZIP_KEYFRAME:"UNZIP_KEYFRAME",MESSAGECENTER_DATA_ERROR_TIP:"MESSAGECENTER_DATA_ERROR_TIP",NET_OFFLINE_ERROR_TIP:"NET_OFFLINE_ERROR_TIP",MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT:"MESSAGECENTER_DATA_ERROR_TIP_IMPORTANT",APPLY_BEHAVIOR_UNDO:"APPLY_BEHAVIOR_UNDO",APPLY_BEHAVIOR_REDO:"APPLY_BEHAVIOR_REDO",APPLY_BEHAVIOR_LOCAL:"APPLY_BEHAVIOR_LOCAL",CREATE_WORKER_ERROR:"CREATE_WORKER_ERROR",UPDATE_SMART_SELECTION_ERROR:"UPDATE_SMART_SELECTION_ERROR",INVER_MUTATION_ERROR:"INVER_MUTATION_ERROR",FILL_DRAG:"FILL_DRAG",FILL_SERIES:"FILL_SERIES",FILL_COPY:"FILL_COPY",FILL_OPTION:"FILL_OPTION",FILL_OPTION_COPY:"FILL_OPTION_COPY",FILL_OPTION_SERIES:"FILL_OPTION_SERIES",FILL_FORMAT:"FILL_FORMAT",FILL_WITHOUT_FORMAT:"FILL_WITHOUT_FORMAT",MOBILE_FILL_SERIES:"MOBILE_FILL_SERIES",MOBILE_FILL_COP:"MOBILE_FILL_COP",CLK_FILL_SUCCESS:"CLK_FILL_SUCCESS",LOAD_DATA_SUCC:"LOAD_DATA_SUCC",SWITCH_SHEET_SUCC:"SWITCH_SHEET_SUCC",REPORT_FILES_TIMES:"REPORT_FILES_TIMES",REPORT_FOR_QUICK_LOOK:"REPORT_FOR_QUICK_LOOK",SHEET_STATUS_REPORT:"SHEET_STATUS_REPORT",SWITCH_SHEET_SPEED:"SWITCH_SHEET_SPEED",RENDER_TRANSFORM_SPEED:"RENDER_TRANSFORM_SPEED",RENDER_CANVAS_SPEED:"RENDER_CANVAS_SPEED",TIME_PASTE_FROM_OUTER_SPEED:"TIME_PASTE_FROM_OUTER_SPEED",TIME_COPY_SPEED:"TIME_COPY_SPEED",HANDDATA_SETSHEETDATA:"HANDDATA_SETSHEETDATA",REPORT_FOR_QL_PV:"REPORT_FOR_QL_PV",REPORT_FOR_PV:"REPORT_FOR_PV",RESET_DEFAULT_TDW_DATA:"RESET_DEFAULT_TDW_DATA"},t.MONITOR_POINTS=E,t.SENTRY_ERROR_TYPE=c,t.getTdwObj3Value=function(e,t){var a="";switch(e){case h.MUTATION:a=[t.getAffectedSheetId(),t.parentRequestId,t.id,t.operationType].join("-")}return a},t.TDW_MODULE=h,t.TDW_ACTION=f,t.TDW_VER5_VALUE=p,t.SPEED_MARK_POINTS=v,t.EDIT_SPEED_REPORT_POINTS=T,t.SPEED_REPORT_POINTS=_,t.REG_JS_LOAD_FILE=/jquery-1|jquery-ui|qqapi|raven|socket|wl\.v3|core-sheet-pc|spread-sheet-pc|core-sheet-mobile|spread-sheet-mobilet|core-sheet-pad|spread-sheet-pad/,t.REG_CSS_LOAD_FILE=/core-sheet-pc|spread-sheet-pc|core-sheet-mobile|spread-sheet-mobile|core-sheet-pad|spread-sheet-pad/,t.JS_LOAD_FILE_MAP=m,t.CSS_LOAD_FILE_MAP=g,t.SPEED_REPORT_LOG=S,t.TDW_REPORT_ACTION=R},286:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getActiveCell=function(e){var t=e.view.getSelection().activeCell;if(t.colIndex<0||t.colIndex<0)return null;return e.spreadsheet.activeSheet?e.spreadsheet.activeSheet.getCellDataAtPosition(t.rowIndex,t.colIndex):null},t.isMergeCell=r,t.hasMergeCell=function(e){var t=e.view.getSelection().rangeSelections[0],a=e.spreadsheet.activeSheet.getMerges();if(!a)return!1;for(var n=0;n<a.length;n++){var o=new i.default.Range.GridRange(a[n].sheetId,a[n].startRowIndex,a[n].endRowIndex,a[n].startColIndex,a[n].endColIndex);if(t.contain(o))return!0}return!1},t.singleRange=function(e){var t=e.view.getSelection().rangeSelections[0];if(t.startColIndex===t.endColIndex&&t.startRowIndex===t.endRowIndex)return!0;if(r(e))return!0;return!1},t.isSelectRow=function(e){return e.view.canvas.excel&&e.view.canvas.excel.selectData&&e.view.canvas.excel.selectData.select.selectRow},t.isSelectColoumn=function(e){return e.view.canvas.excel&&e.view.canvas.excel.selectData&&e.view.canvas.excel.selectData.select.selectCol},t.getSelectCLs=function(e){var t=e.view.getSelection().rangeSelections[0];return{rows:t.endRowIndex-t.startRowIndex+1,cols:t.endColIndex-t.startColIndex+1}},t.selectImage=function(e){return e.view.canvas.excel.frame.frameShow},t.singleColumn=function(e){var t=e.view.getSelection().rangeSelections[0];if(t.startColIndex===t.endColIndex)return!0;return!1},t.isSelectedAll=function(e){var t=e.view.getSelection().rangeSelections[0],a=e.spreadsheet.activeSheet.getRowCount(),n=e.spreadsheet.activeSheet.getColCount();if(0===t.startColIndex&&t.endColIndex===n-1&&0===t.startRowIndex&&t.endRowIndex===a-1)return!0;return!1},t.isRangeDataBlank=function(e,t){for(var a=t.startRowIndex;a<=t.endRowIndex;a++)for(var n=t.startColIndex;n<=t.endColIndex;n++)if(!s(e,a,n))return!1;return!0},t.isCellDataBlank=s,t.hasSelect=function(e){var t=e.view.canvas.excel.selectData.select;if(t&&t.xRange&&t.xRange.length>0&&t.yRange&&t.yRange.length>0)return!0;return!1},t.isPickShape=function(e){var t=e.view.canvas.excel.selectData;if(t&&t.pickShape)return!0;return!1};var n,o=a(89),i=(n=o)&&n.__esModule?n:{default:n};function r(e){var t=e.view.getSelection().rangeSelections[0],a=e.spreadsheet.activeSheet.getCellDataAtPosition(t.startRowIndex,t.startColIndex),n=a&&a.getMergeReference();return!!n&&t.equals(n)}function s(e,t,a){var n=e.spreadsheet.activeSheet.getCellDataAtPosition(t,a),o=n&&n.getEditValue();return!o||""===o.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}},292:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(14)),o=l(a(9)),i=l(a(63));t.transformCellData2String=u,t.isEmptyValue=d,t.naturalCompare=function(e,t){var a=[],n=[];e.replace(/(\d+)|(\D+)/g,function(e,t,n){a.push([t||1/0,n||""])}),t.replace(/(\d+)|(\D+)/g,function(e,t,a){n.push([t||1/0,a||""])});for(;a.length&&n.length;){var o=a.shift(),i=n.shift(),r=o[0]-i[0]||o[1].localeCompare(i[1]);if(r)return r}return a.length-n.length},t.handleRenderValue=function(e){(null===e||void 0===e||d(e))&&(e=s.EMPTY_KEY_VALUE);e.replace&&(e=e.replace(/\ufeff/g,""));return e},t.getRenderResult=function(e,t,a){if(e.data.rowData[t]){var n=e.data.rowData[t].values[a];if(n){var o=u(n);return o}}return null},t.isHiddenRowByUser=function(e,t){return(e.data.rowMetadata[t]||{hiddenByUser:!1}).hiddenByUser},t.unique=function(e){var t=new i.default;return e.filter(function(e){return!t.has(e)&&t.set(e,1)})},t.obj2Arr=function(e){return(0,o.default)(e).reduce(function(t,a){return t.push(e[a]),t},[])},t.diff=function(e,t){return e.filter(function(e){return t.every(function(t){return t!==e})})},t.setStateTempResultList=function(e){var t=e.listToSet,a=e.tempResultList,o=e.filterResultList,i=a.reduce(function(e,t,a){return e[t.key]=a,e},{});t.forEach(function(e){var t=e.key,o=e.checked,r=i[t];if(void 0!==r){var s=a[r];a.splice(r,1,(0,n.default)({},s,{visible:o}))}});var r=o.reduce(function(e,t,a){return e[t.key]=a,e},{});return t.forEach(function(e){var t=e.key,a=e.checked,i=r[t];if(void 0!==i){var s=o[i];o.splice(i,1,(0,n.default)({},s,{visible:a}))}}),{tempResultList:a,filterResultList:o}};var r=a(125),s=a(293);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return e?(0,r.getMergedValue)(e):null}function d(e){return s.REGEX_EMPTY_KEY_VALUE.test(e)||""===e}},293:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EMPTY_KEY_VALUE="",t.CHILD_COMPONENT_ID_LIST=0,t.CHILD_COMPONENT_ID_INPUT=1,t.REGEX_EMPTY_KEY_VALUE=/^\s+$/},307:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=p(a(14)),i=f(a(112)),r=p(a(410)),s=p(a(17)),l=p(a(138)),u=f(a(193)),d=a(79),c=p(a(67)),h=p(a(13));function f(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function p(e){return e&&e.__esModule?e:{default:e}}!function(e){e.Api=i,e.Behavior=r.default;!function(e){e.Api=(0,o.default)({},u,{serializeMutation:d.serializeMutation,deserializeMutation:d.deserializeMutation}),e.MUTATION_ID=s.default,e.MUTATION_OPERATION_TYPE=l.default,e.SetRangeMutation=c.default}(e.Mutation||(e.Mutation={}));!function(e){e.REQUEST_ID=h.default}(e.Request||(e.Request={}))}(n||(n={}));var v=window.T_SHEET||{};window.T_SHEET=v,v.Behavior=n,t.default=n},310:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.VALID_TYPE=void 0;!function(e){e.LIST="list",e.NUMBER="number",e.TEXT="text",e.DATE="date",e.AVAILABLE="available"}(n||(t.VALID_TYPE=n={}));var o=t.DATA_TYPE=void 0;!function(e){e.CONTENT="content",e.LENGTH="length",e.INT="int",e.FLOAT="float",e.ID_CARD="id-card",e.PHONE="phone",e.MAIL="mail",e.URL="url",e.GENDER="gender",e.NONE="none"}(o||(t.DATA_TYPE=o={}))},311:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(206)),o=l(a(1430)),i=l(a(286)),r=a(1431),s=l(a(246));function l(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}var u={cell:n,selection:i,freeze:o,sort:{doSort:r.doSort},sheetNameUtils:s},d=window.T_SHEET||{};window.T_SHEET=d,d.CoreUtils=u,t.default=u},395:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.goToTuCao=u,t.showHowToHandleDataLostModal=function(e){n.default.confirm({maskStyle:{zIndex:10004},title:"\u5982\u4f55\u5904\u7406",content:(0,s.returnModalContentWithErrCode)("\u4e3a\u9632\u6b62\u6570\u636e\u4e22\u5931\uff0c\u8bf7\u52ff\u5237\u65b0\u6216\u5173\u6389\u9875\u9762\u3002\u5efa\u8bae\u5148\u5bfc\u51fa\u6587\u4ef6\u6216\u5c06\u7f16\u8f91\u7684\u5185\u5bb9\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u5237\u65b0\u9875\u9762\u3002",e),okText:"\u5bfc\u51fa\u6587\u4ef6",onOk:function(){return o.default.window.CoreSheet.export.exportSheetData(),!1},cancelText:"\u5237\u65b0",onCancel:function(){window.location.reload()},action:"\u8054\u7cfb\u6211\u4eec",onClickAction:function(){return u(e),!1},onClose:function(){}})},t.showHowToHandleBigDataModal=function(e){n.default.confirm({maskStyle:{zIndex:10004},title:"\u5982\u4f55\u5904\u7406",content:(0,s.returnModalContentWithErrCode)("\u672c\u6b21\u64cd\u4f5c\u5185\u5bb9\u8f83\u591a\uff0c\u53ef\u5237\u65b0\u540e\u5c1d\u8bd5\u5206\u6279\u64cd\u4f5c\u3002\u82e5\u9700\u4fdd\u7559\u672c\u6b21\u64cd\u4f5c\u5185\u5bb9\uff0c\u53ef\u5148\u5bfc\u51fa\u6587\u4ef6\u6216\u5c06\u7f16\u8f91\u7684\u5185\u5bb9\u590d\u5236\u7c98\u8d34\u5230\u672c\u5730\uff0c\u7136\u540e\u518d\u5237\u65b0\u9875\u9762\u3002",e),okText:"\u5bfc\u51fa\u6587\u4ef6",onOk:function(){return o.default.window.CoreSheet.export.exportSheetData(),!1},cancelText:"\u5237\u65b0",onCancel:function(){window.location.reload()},action:"\u8054\u7cfb\u6211\u4eec",onClickAction:function(){u(e)}})},t.showOfflineTip=function(e){return window.navigator.onLine?(0,i.showServerConnectTimeout)("60001"):(0,r.showNetworkOfflineTip)(e)};var n=l(a(308)),o=l(a(7)),i=a(237),r=a(165),s=a(1148);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){window.open("https://support.qq.com/products/28096?customInfo="+e,"_blank")}},396:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(16)),o=i(a(397));function i(e){return e&&e.__esModule?e:{default:e}}var r={getMemory:function(){var e=window.performance||window.msPerformance||window.webkitPerformance;if(e&&e.memory)return e.memory},report:function(e){var t=this.getMemory();t&&o.default.tdwReport({opername:"doc_excel_editor",module:"excel_memory",action:e,ver5:(0,n.default)(t)})}};t.default=r},397:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(26),o=l(a(1149)),i=l(a(1151)),r=l(a(1152)),s=a(283);function l(e){return e&&e.__esModule?e:{default:e}}t.default={run:o.default,CONFIG:n.CONFIG,speed:i.default,jank:new r.default,tdwReport:s.tdw,tdwSingleReport:s.tdwSingle,monitor:s.AlloyReport.monitor,huatuo:s.AlloyReport.huatuo,retcode:s.AlloyReport.retcode}},398:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.cacheDataFlow=t.isProductEnvironment=t.joinReportInfo=t.DataFlowLogLevel=t.dataFlowReport=t.sentryReport=t.AlloyReport=t.platform=void 0;var n=h(a(16)),o=h(a(110)),i=h(a(7)),r=a(22),s=h(a(40)),l=a(279),u=a(673),d=h(a(12)),c=a(283);function h(e){return e&&e.__esModule?e:{default:e}}var f,p=!1,v=i.default.window.CoreSheet&&i.default.window.CoreSheet.util.cookie.get("dev_route_id"),_=i.default.window.CoreSheet&&i.default.window.CoreSheet.util.getQuery("devMode");function E(){return r.isMobile?r.isAndroid?f.ANDROID:f.IOS:f.PC}v||_||(t.isProductEnvironment=p=!0),function(e){e.PC="PC",e.ANDROID="Android",e.IOS="IOS"}(f||(f={}));var T,m={CheckMutationError:6,RunMutationError:6,afterMutationRunError:6};!function(e){e[e.IMPORTANT=0]="IMPORTANT",e[e.DEBUG=1]="DEBUG",e[e.INFO=2]="INFO"}(T||(t.DataFlowLogLevel=T={}));var g=[{moduleValue:"messageCenter",actionValue:"applyNewChangesVError",count:20},{moduleValue:"mutation",actionValue:"runMutation",ver5Value:"1",count:5},{moduleValue:"mutation",actionValue:"afterMutationRun",ver5Value:"1",count:5},{moduleValue:"indexeddb",actionValue:"getDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"clearDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"deleteDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"updateDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setDataCatchError",count:2},{moduleValue:"indexeddb",actionValue:"changeDataKeyCatchError",count:2},{moduleValue:"indexeddb",actionValue:"setValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"updateValue",ver5Value:"0",count:0},{moduleValue:"indexeddb",actionValue:"deleteValue",ver5Value:"0",count:0}],S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0};var R=null;function A(){R=d.default.wait(1e4).run(function(){var e=S,t=e.applyBehaviorAmount,a=e.commitMutationAmount,o=e.sendUserChangeAmount,r=e.acceptCommitAmount;if(0!==t||0!==a||0!==o||0!==r){var s=(0,l.getSheetCellsNum)(i.default.window.SpreadsheetApp.spreadsheet.getActiveSheetId()),u={opername:"excel_dataflow",module:"datalost",action:"datalost",ver3:(0,n.default)(s),ver5:t,ver6:a,ver7:o,ver8:r};c.tdwSingle&&(0,c.tdwSingle)(u,["user_mac","id"]),S={applyBehaviorAmount:0,commitMutationAmount:0,sendUserChangeAmount:0,acceptCommitAmount:0}}A()})}function w(e){var t=e.moduleValue,a=e.actionValue,n=e.ver5Value,o=t+"_"+a;return void 0!==n&&(o+="_"+n),o}p&&A(),s.default.windowEvent.listen("visibilitychange",function(){document.hidden?(d.default.erase(R),R=null):A()});var I=function(){var e={};return g.forEach(function(t){var a=t.moduleValue,n=t.actionValue,o=t.ver5Value,i=t.count,r=w({level:-1,moduleValue:a,actionValue:n,ver5Value:o});e[r]=i}),e}();function C(e){try{var t=e.level,a=e.moduleValue,n=e.actionValue,r=e.ver5Value,s=(e.detail,e.obj3Value),l=(i.default.window.SpreadsheetAp,w(e));if(void 0!==I[l]){if(I[l]<=0)return;I[l]=I[l]-1}var u=window.SpreadsheetApp&&window.SpreadsheetApp.messageCenter&&window.SpreadsheetApp.messageCenter.currentVersion||-1,d=window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet&&window.SpreadsheetApp.spreadsheet.getActiveSheetId()||"unknown",h=window.__globalReleaseVersion||"unknown";if(e.baseVersion=u,e.activeSheetId=d,i.default.window.log&&i.default.window.log.info&&i.default.window.log.info(y(e)),!p)return;if(t===T.IMPORTANT){var v={opername:"excel_dataflow",module:a||"unknown_dataflow_module",action:n||"unknown_action",obj3:s,ver3:d,ver5:r,ver6:u,ver7:o.default.CODE_VER,ver8:h};c.tdwSingle&&(0,c.tdwSingle)(v,["user_mac","id"])}else if(t===T.DEBUG&&E()===f.PC){var _={opername:"excel_dataflow",module:a||"unknown_dataflow_module",action:n||"unknown_action",obj3:s,ver3:d,ver5:r,ver6:u,ver7:o.default.CODE_VER,ver8:h};c.tdwSingle&&(0,c.tdwSingle)(_,["user_mac","id"])}(t===T.DEBUG||t===T.IMPORTANT&&"0"!==r)&&i.default.window.log&&i.default.window.log.report(l,{query:{sessionId:i.default.window.log.var.sessionId}})}catch(m){console.warn(m),i.default.window.log&&i.default.window.log.warn("dataFlowReport",m.message)}}function y(e){var t="";if(e)if(Array.isArray(e))e.forEach(function(e){if(t+="#",e)try{t+=(0,n.default)(e)}catch(a){t+="JSON.stringify error."}});else try{t+=(0,n.default)(e)}catch(a){t+="JSON.stringify error."}return t}window.dataFlowReport=C;var O=E(),D=void 0;i.default.window.AlloyReport?t.AlloyReport=D=i.default.window.AlloyReport:t.AlloyReport=D=c.AlloyReport,t.platform=O,t.AlloyReport=D,t.sentryReport=function(e){var t=e.errorType,a=e.message,o=e.error;if(void 0!==m[t]){if(m[t]<=0)return;m[t]=m[t]-1}if(p){a||(a="no_message"),o||((o=new Error).name="dataLost");try{o.message=o.message+"{\n"+(0,n.default)(a)+"\n}"}catch(i){}u.Raven&&u.Raven.captureException(o,{level:"error",logger:"info-report",tags:{ErrorType:t,networkVersion:"new"},sampleReport:!1})}},t.dataFlowReport=C,t.DataFlowLogLevel=T,t.joinReportInfo=y,t.isProductEnvironment=p,t.cacheDataFlow=function(e){e.level;var t=e.moduleValue,a=e.actionValue;"applyBehavior"!==t||"local"!==a&&"undo"!==a&&"redo"!==a?"mutation"===t&&"commitMutation"===a?S.commitMutationAmount++:"messageCenter"!==t||"sendOfflineUserChange"!==a&&"sendUserChange"!==a?"messageCenter"!==t||"acceptCommit"!==a&&"acceptOfflineCommit"!==a||S.acceptCommitAmount++:S.sendUserChangeAmount++:S.applyBehaviorAmount++;var n=window.SpreadsheetApp&&window.SpreadsheetApp.messageCenter&&window.SpreadsheetApp.messageCenter.currentVersion||-1,o=window.SpreadsheetApp&&window.SpreadsheetApp.spreadsheet&&window.SpreadsheetApp.spreadsheet.getActiveSheetId()||"unknown";window.__globalReleaseVersion,e.baseVersion=n,e.activeSheetId=o,i.default.window.log&&i.default.window.log.info&&i.default.window.log.info(y(e))}},40:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.removeAllEvent=void 0;var n=r(a(9)),o=r(a(996)),i=r(a(997));function r(e){return e&&e.__esModule?e:{default:e}}var s=function(){var e=o.default.create("sheetsBar"),t=o.default.create("default"),a=o.default.create("toolBar"),n=o.default.create("spreadsheetApp"),r=o.default.create("search"),s=o.default.create("sheetStatus"),l=o.default.create("network"),u=o.default.create("init"),d=o.default.create("view"),c=o.default.create("reportEvent"),h=o.default.create("notificationCenter"),f=o.default.create("login"),p=o.default.create("formula"),v=o.default.create("errorCode"),_=o.default.create("mentionEvent");return{sheetsBar:e,default:t,toolBar:a,spreadsheetEvent:n,search:r,sheetStatus:s,network:l,windowEvent:new i.default("undefined"===typeof window?{}:window),bodyEvent:new i.default("undefined"===typeof window||"undefined"===typeof window.document?{}:window.document.body),init:u,view:d,reportEvent:c,notificationCenterEvent:h,loginEvent:f,formula:p,errorCode:v,mentionEvent:_}}();t.removeAllEvent=function(){(0,n.default)(s).forEach(function(e){s[e].removeAll()})};t.default=s},410:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=de(a(47)),o=de(a(0)),i=de(a(1)),r=de(a(107)),s=de(a(25)),l=de(a(159)),u=de(a(1344)),d=de(a(13)),c=de(a(1345)),h=a(1346),f=de(a(698)),p=de(a(40)),v=de(a(770)),_=de(a(1347)),E=de(a(1348)),T=de(a(1349)),m=de(a(1354)),g=de(a(1355)),S=de(a(1356)),R=de(a(1357)),A=de(a(1358)),w=de(a(1359)),I=de(a(1360)),C=de(a(1362)),y=de(a(700)),O=de(a(290)),D=de(a(1363)),N=de(a(413)),M=de(a(450)),k=de(a(1369)),b=de(a(1370)),P=de(a(1381)),L=de(a(1382)),F=de(a(1383)),x=de(a(1384)),U=de(a(703)),V=de(a(1385)),H=de(a(1386)),B=de(a(1387)),G=de(a(1388)),W=de(a(1389)),j=de(a(1390)),Y=de(a(702)),z=de(a(1391)),Q=de(a(1392)),q=de(a(1393)),K=de(a(1394)),Z=de(a(1395)),J=de(a(1396)),X=de(a(705)),$=de(a(1397)),ee=de(a(1398)),te=de(a(12)),ae=de(a(8)),ne=a(26),oe=a(99),ie=de(a(140)),re=de(a(1399)),se=de(a(1400)),le=a(82),ue=a(90);function de(e){return e&&e.__esModule?e:{default:e}}var ce=function(e,t,a,n){var o,i=arguments.length,u=i<3?t:null===n?n=(0,l.default)(t,a):n;if("object"===("undefined"===typeof Reflect?"undefined":(0,s.default)(Reflect))&&"function"===typeof Reflect.decorate)u=Reflect.decorate(e,t,a,n);else for(var d=e.length-1;d>=0;d--)(o=e[d])&&(u=(i<3?o(u):i>3?o(t,a,u):o(t,a))||u);return i>3&&u&&(0,r.default)(t,a,u),u},he=function(){function e(t){(0,o.default)(this,e),this.parent=t,this.undoredoStack=new c.default,this.middleware=new u.default({parent:this.parent})}return(0,i.default)(e,[{key:"checkPermission",value:function(e){return"undo"!==e.type&&"redo"!==e.type&&"local"!==e.type||!1!==this.parent.sheetStatus.permission.gEditable}},{key:"apply",value:function(e){var t=this;if("undo"!==e.type&&"redo"!==e.type&&"local"!==e.type||ae.default.monitor(33638269),!1===this.checkPermission(e))return n.default.reject();p.default.spreadsheetEvent.trigger("applyBehaviorStart",e.sheetId);var a=void 0;switch(e.type){case"undo":a=new n.default(function(a,n){t.applyUndo(e.sheetId,a,n)});break;case"redo":a=new n.default(function(a,n){t.applyRedo(e.sheetId,a,n)});break;case"collab":a=new n.default(function(a,n){t.applyCollabMutations(e.opt,a,n)});break;case"local":a=new n.default(function(a,n){void 0===e.canUndoRedo&&(e.canUndoRedo=!0),t.applyLocalRequest(e.type,e.sheetId,e.requestId,e.opt,e.canUndoRedo,a,n)});break;default:a=new n.default(function(e,t){t()})}return a.then(function(){p.default.spreadsheetEvent.trigger("applyBehaviorEnd",e.sheetId)}).catch(function(){p.default.spreadsheetEvent.trigger("applyBehaviorEnd",e.sheetId)}),a}},{key:"applyUndo",value:function(e,t,a){ae.default.jank.log({moduleValue:"applyMutation",actionValue:"undo"});var n=this.undoredoStack.undo();ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_UNDO,[e,n&&n.sheetId]),n&&(ae.default.monitor(33686605),(0,h.commitMutation)(this.parent,n.sheetId,n.undo)),t()}},{key:"applyRedo",value:function(e,t,a){ae.default.jank.log({moduleValue:"applyMutation",actionValue:"redo"});var n=this.undoredoStack.redo();ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_REDO,[e,n&&n.sheetId]),n&&(ae.default.monitor(33686606),(0,h.commitMutation)(this.parent,n.sheetId,n.undo)),t()}},{key:"applyMutation",value:function(e,t){var a=this.parent.preview&&this.parent.preview.isActive&&t.isLocal?this.parent.preview.previewsheet:this.parent.spreadsheet;return e.run(a,t)}},{key:"applyCollabMutations",value:function(e,t,a){var n=this;try{var o=JSON.parse(e.changeset),i=-1;o.length>0&&o[0]&&o[0].length>0&&o[0][0]&&(i=o[0][0].r),ae.default.jank.log({moduleValue:"applyMutation",actionValue:"collab_"+i});var r=!1,s=[],l=this.parent&&this.parent.plugins&&this.parent.plugins.rmap;l&&l.isRelated(e.sheetId)&&l.updateFromSyncMutations(o,e.sheetId),o=o.filter(function(e,t){return"revert"===e.type&&(r=!0),"ms"!==e.type||(s.push(e),!1)}),e.revert&&r?this.parent.revertSpreadSheet():this.parent.messageCenter.handleCollabMutations(e.newVersion,o,e.sheetId,e),s.forEach(function(e){var t=e.d;n.parent.applySheetsChanges(t)}),this.parent.messageCenter.updateBaseVersion(e.newVersion),p.default.spreadsheetEvent.trigger(le.EVENT_NAME.DATA_CHANGE,{type:"syncndoredoStack"}),t()}catch(u){ae.default.run(ne.CONFIG.APPLY_NEW_CHANGES_ERROR,[u&&u.stack]),a()}}},{key:"applyLocalRequest",value:function(e,t,a,n){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],i=this,r=arguments[5],s=arguments[6];if(ae.default.jank.log({moduleValue:"applyMutation",actionValue:"local_"+a}),this.parent.view){var l=this.parent.view.getSelection(),u=void 0;ae.default.run(ne.CONFIG.LOAD_REQUEST,[a]);try{u=this.loadRequest(a,n,l)}catch(h){return ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_ERROR,[t],h),void s()}var d=u.getRanges(this.parent.spreadsheet);if(!this.checkRangesIsLoaded(d))return ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_NOT_LOADED,[t]),void s();var c=u.check(this.parent.spreadsheet);if(null===c)return ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LOCAL,[t]),r(),void(this.applyLocal(t,u,a,o,n)&&ae.default.monitor(33686607));if(c.ignore)return ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_INFO,[t]),void s(c);c.isWarningOnly?te.default.wait(300).run(function(){oe.dialog.confirm(c.warning.title,c.warning.content,function(){if(c.warning.repeat)i.applyLocalRequest(e,t,a,n,o,r,s);else{if(!i.applyLocal(t,u,a,o,n))return void ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"9");p.default.spreadsheetEvent.trigger(le.EVENT_NAME.DATA_CHANGE,{type:"requestcheckConfirm"}),ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"6"),ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT_MONITOR),r()}},function(){p.default.spreadsheetEvent.trigger(le.EVENT_NAME.DATA_CHANGE,{type:"requestcheckCancle"}),ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"7"),s()},function(e){""===e&&(p.default.spreadsheetEvent.trigger(le.EVENT_NAME.DATA_CHANGE,{type:"requestcheckCancle"}),ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"8"),s())})}):(ae.default.run(ne.CONFIG.APPLY_BEHAVIOR_LEVEL_IMPORTANT,[t],"4"),oe.dialog.info(c.error.title,c.error.content),p.default.spreadsheetEvent.trigger(le.EVENT_NAME.DATA_CHANGE,{type:"requestcheckError"}),s(c))}}},{key:"applyLocal",value:function(e,t,a,n,o){var i=this,r=new f.default({sheetId:e,local:!0});return t.predictRequestSize(this.parent.spreadsheet)>512e3?(this.parent.event.errorCode.trigger("errorCode",{type:"front",code:ue.errCodeType.REQUEST_SIZE_LIMIT,data:{message:t.requestSizeOverLimitTips()}}),ae.default.run(ne.CONFIG.REQUEST_SIZE_OVER_LIMIT,[e,a]),!1):(t.run(this.parent.spreadsheet,function(e){e.parentRequestId=t.id,r.add([e]),i.applyMutation(e,{isLocal:!0})}),n&&this.undoredoStack.push(r),(0,h.commitMutation)(this.parent,e,r.redo,a,o),!0)}},{key:"checkRangesIsLoaded",value:function(e){var t,a=void 0,n=void 0,o=void 0;for(a=0,t=e.length;a<t;a++){if(n=e[a],!(o=this.parent.spreadsheet.getSheetBySheetId(n.sheetId)))return!1;if(n.startRowIndex<0)return!1;if(n.endRowIndex>=o.getProperties().getGridProperties().rowCount)return!1;if(n.startColIndex<0)return!1;if(n.endColIndex>=o.getProperties().getGridProperties().columnCount)return!1}return!0}},{key:"loadRequest",value:function(e,t,a){switch(e){case d.default.INSERT_DIMENSION_REQUEST:return new v.default(t,a);case d.default.DELETE_DIMENSION_REQUEST:return new _.default(t,a);case d.default.MOVE_DIMENSION_REQUEST:return new w.default(t,a);case d.default.SET_DIMENSION_SIZE_REQUEST:return new E.default(t,a);case d.default.SET_DIMENSION_HIDE_REQUEST:return new T.default(t,a);case d.default.SET_DIMENSION_SHOW_REQUEST:return new m.default(t,a);case d.default.ADD_IMAGE_REQUEST:return new S.default(t,a);case d.default.DELETE_IMAGE_REQUEST:return new R.default(t,a);case d.default.UPDATE_IMAGE_REQUEST:return new A.default(t,a);case d.default.REORDER_RANGE_REQUEST:return new M.default(t,a);case d.default.SET_SHEETS_REQUEST:return new I.default(t,a);case d.default.SET_FORMAT_REQUEST:return new C.default(t,a);case d.default.MERGE_CELLS_REQUEST:return new y.default(t,a);case d.default.UNMERGE_CELLS_REQUEST:return new O.default(t,a);case d.default.FREEZE_REQUEST:return new D.default(t,a);case d.default.SET_SINGLE_VALUE_REQUEST:return new N.default(t,a);case d.default.SET_BORDERS_REQUEST:return new k.default(t,a);case d.default.CLEAR_FORMAT_REQUEST:return new P.default(t,a);case d.default.REPLACE_ALL_REQUEST:return new L.default(t,a);case d.default.PASTE_DATA_REQUEST:return new b.default(t,a);case d.default.SET_LINK_REQUEST:return new F.default(t,a);case d.default.CLEAR_LINK_REQUEST:return new x.default(t,a);case d.default.CLEAR_RANGE_REQUEST:return new U.default(t,a);case d.default.SET_NUMBER_FORMAT_REQUEST:return new V.default(t,a);case d.default.ADJUST_DECIMALS_REQUEST:return new H.default(t,a);case d.default.AUTO_FILL_REQUEST:return new B.default(t,a);case d.default.SET_BASIC_FILTER_REQUEST:return new G.default(t,a);case d.default.CLEAR_BASIC_FILTER_REQUEST:return new W.default(t,a);case d.default.UPDATE_FILTER_CRITERIA_REQUEST:return new j.default(t,a);case d.default.EXPAND_DIMENSION_REQUEST:return new g.default(t,a);case d.default.COPY_PASTE_REQUEST:return new Y.default(t,a);case d.default.SET_RANGE_VALUE_REQUEST:return new q.default(t,a);case d.default.SET_DATA_VALIDATION_REQUEST:return new K.default(t,a);case d.default.DEFINE_COMMENT_RANGE_REQUEST:return new z.default(t,a);case d.default.DELETE_COMMENT_RANGE_REQUEST:return new Q.default(t,a);case d.default.SET_DIMENSION_FORMDATA_REQUEST:return new Z.default(t,a);case d.default.REORDER_FILTER_REQUEST:return new re.default(t,a);case d.default.SET_HIDE_GRIDLINES_REQUEST:return new se.default(t,a);case d.default.ADD_CONDITIONAL_FORMAT_REQUEST:return new X.default(t,a);case d.default.DELETE_CONDITIONAL_FORMAT_REQUEST:return new $.default(t,a);case d.default.UPDATE_CONDITIONAL_FORMAT_REQUEST:return new ee.default(t,a);case d.default.MULTI_REQUEST:for(var n=0,o=t.requests.length;n<o;n++)t.requests[n]=this.loadRequest(t.requests[n].requestId,t.requests[n].opt,a);return new J.default(t,a);default:throw new Error("unknown request id")}}}]),e}();ce([(0,ie.default)(he)],he.prototype,"applyLocalRequest",null),ce([(0,ie.default)(he)],he.prototype,"applyLocal",null),ce([(0,ie.default)(he)],he.prototype,"loadRequest",null),t.default=he},411:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkOfflinePattern=void 0;var n=a(412),o=a(90),i=a(165);t.checkOfflinePattern=function(e){if(e.socket.client){var t=e.socket.client.getRoomState(),a=e.messageOfflineStore&&e.messageOfflineStore.status,r=e.messageOfflineStore.isShield;if((!navigator.onLine||"OPENED"!==t)&&r)return e.socket.hideOfflineTips(),e.socket.hadShowOfflineTip=!0,e.event.errorCode.trigger("errorCode",{type:"front",code:o.errCodeType.OFFLINE_INDEXDB_NOT_AVAILABLE}),void e.sheetStatus.permission.setgEditable(!1);"OPENED"!==t&&("RECONNECTING_In_CLOSED"!==t&&"SHUTDOWN"!==t||a!==n.OfflineStoreStatus.INIT_FAILED&&a!==n.OfflineStoreStatus.NOT_SUPPORT&&a!==n.OfflineStoreStatus.ERROR?(0,i.showOfflineEditingTip)():(e.event.errorCode.trigger("errorCode",{type:"front",code:o.errCodeType.OFFLINE_INDEXDB_NOT_AVAILABLE}),e.sheetStatus.permission.setgEditable(!1)))}else(0,i.showOfflineEditingTip)()}},412:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.OfflineStoreStatus=void 0;!function(e){e[e.CLOSE=0]="CLOSE",e[e.INITING=1]="INITING",e[e.OPEN=2]="OPEN",e[e.INIT_FAILED=3]="INIT_FAILED",e[e.NOT_SUPPORT=4]="NOT_SUPPORT",e[e.ERROR=5]="ERROR"}(n||(t.OfflineStoreStatus=n={}))},414:function(e,t,a){"use strict";function n(e,t){return e.slice(0,t)+(e.length>t?"...":"")}function o(e,t){for(var a=0,o=[];a<t;a++)e[a]&&o.push(n(e[a].name,10));return o.join("\u3001")}Object.defineProperty(t,"__esModule",{value:!0}),t.debounce=function(e,t){var a=null;return function(){var n=this,o=arguments;a&&(clearTimeout(a),a=null),a=setTimeout(function(){e.apply(n,o)},t)}},t.splice=n,t.join=o,t.calcText=function(e){var t="",a=function(e){var t=e.name||"";return t=n(t,16),e.isEditing&&(t+=" \u6b63\u5728\u8f93\u5165 "),t};if(e.length<=1)t=a(e[0]);else if(e[0].isEditing)if(e[1].isEditing){for(var i=0,r=0;r<e.length&&e[r].isEditing;r++)i++;t=o(e,2)+"\u7b49"+i+"\u4eba\u6b63\u5728\u8f93\u5165"}else t=a(e[0]);else t=o(e,2)+(e.length>2?"\u7b49":"");return t}},415:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=R(a(114)),o=R(a(9)),i=R(a(0)),r=R(a(1)),s=R(a(47));t.getSetCellPropertiesMutationForFormula=function(e){var t=w(e);return new h.default({gridRange:e.gridRange,cellDataDelta:t})},t.getCellDataDeltaForFormula=w;var l=R(a(7)),u=R(a(29)),d=R(a(18)),c=R(a(39)),h=R(a(43)),f=R(a(32)),p=R(a(40)),v=a(10),_=R(a(54)),E=a(90),T=R(a(17)),m=a(22),g=R(a(12)),S=R(a(8));function R(e){return e&&e.__esModule?e:{default:e}}var A=function(e,t,a,n){return new(a||(a=s.default))(function(o,i){function r(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(r,s)}l((n=n.apply(e,t||[])).next())})};function w(e){var t=new u.default;if(null===e.effectiveValue?t.clearSlot(d.default.SLOT_EFFIECTIVE_VALUE):"undefined"!==typeof e.effectiveValue&&t.setSlot(d.default.SLOT_EFFIECTIVE_VALUE,e.effectiveValue),"undefined"!==typeof e.userEnteredNumberFormat){var a=new c.default;null===e.userEnteredNumberFormat?a.clearSlot(f.default.NUMBER_FORMAT):a.setSlot(f.default.NUMBER_FORMAT,e.userEnteredNumberFormat),t.setSlot(d.default.SLOT_USER_ENTERED_FORMAT_DELTA,a)}if("undefined"!==typeof e.effectiveFormatNumberFormat){var n=new c.default;null===e.effectiveFormatNumberFormat?n.clearSlot(f.default.NUMBER_FORMAT):n.setSlot(f.default.NUMBER_FORMAT,e.effectiveFormatNumberFormat),t.setSlot(d.default.SLOT_EFFIECTIVE_FORMAT_DELTA,n)}return null===e.formula?t.clearSlot(d.default.SLOT_FORMULA):"undefined"!==typeof e.formula&&t.setSlot(d.default.SLOT_FORMULA,e.formula),t}var I=function(){function e(t){(0,i.default)(this,e),this.isApplyingBehavior=!1,this.mutationsWillSyncToWorker={},this.parent=t,this.receiveCrossSheetMutation=!0,this.init()}return(0,r.default)(e,[{key:"init",value:function(){this.listenMutationRun(),this.listenUpdateCellDataDV(),this.listenUpdateCellDatFromFormula(),this.listenHeaderChangeFromServer(),this.listenExcelResize(),this.listenHistoryPopState(),this.listenWorkrangeChange(),this.listenAfterMutationRun(),this.listenBeforeUnload(),this.listenApplyBehavior(),this.listenDataVersion(),this.listenAfterAllRender()}},{key:"listenAfterAllRender",value:function(){var e=this;l.default.event.default.listen("afterAllRender",function(t){var n=t.isFirstRender;l.default.window.loadingSnackBar&&l.default.window.loadingSnackBar.hide(),n||a.e("bundle_resetLocation").then(a.t.bind(null,1660,7)).then(function(t){if(!e.parent.location){var a=new(0,t.default)(e.parent);e.parent.addModule("location",a)}var n=l.default.clientVars.oPadSubId;e.parent.location.reset(n,function(t,a,o,i){var r=e.parent.view.getSheetLocation(),s=r.row.flow;switch(t){case"server":0===s&&void 0===r.xRange[0]?(o=o||0,i=i||0,n===a&&e.parent.view.canvas.excel.scrollToRowCol({row:o,col:i}),m.isMobile||m.isPad||e.parent.handleData.setSheetSelection(a)):void 0!==r.xRange[0]||m.isMobile||m.isPad||e.parent.view.canvas.setFirstCellFocus();break;case"local":0===s&&void 0===r.xRange[0]?m.isMobile||m.isPad?e.parent.handleData.setSheetScroll(a):(e.parent.handleData.setSheetSelection(a),e.parent.handleData.setSheetScroll(a)):void 0!==r.xRange[0]||m.isMobile||m.isPad||e.parent.view.canvas.setFirstCellFocus()}var l=e.parent.view.getSheetLocation(),u=e.parent.view.getCurrentPosition(),d=u.rowIndex,c=u.colIndex,h=e.parent.spreadsheet.getActiveSheetId();e.parent.location.handleChangeWithLoc({selectRange:l,sheetId:h,rowIndex:d,colIndex:c}),e.parent.location.handleChangeWithServer({selectRange:l,sheetId:h,rowIndex:d,colIndex:c})}),e.parent.location.initEvent()})})}},{key:"listenMutationRun",value:function(){var e=this;l.default.event.spreadsheetEvent.listen("afterMutationRun",function(t){var a="preview"===t.sType?e.parent.preview.previewsheet:e.parent.spreadsheet,n=void 0,o=void 0,i=void 0,r=void 0,s=void 0,u=void 0,c=t.mutation;switch(c.id){case T.default.INIT_DATA_MUTATION:for(i=0,s=c.lastCol;i<=s;i++)for(r=0,u=c.lastRow;r<=u;r++)a.autoUpdateCellData(c.sheetId,r,i);break;case T.default.SET_CELL_PROPERTIES_MUTATION:var h=c.cellDataDelta;if(n=h.setSlots|h.clearSlots,o=h.delta.userEnteredFormatDelta?h.delta.userEnteredFormatDelta.setSlots|h.delta.userEnteredFormatDelta.clearSlots:0,0!==(n&1<<d.default.SLOT_EFFIECTIVE_VALUE)||0!==(o&1<<f.default.NUMBER_FORMAT)||0!==(n&1<<d.default.SLOT_FORMULA)||0!==(o&1<<f.default.DATA_VALIDATION)||0!==(n&1<<d.default.SLOT_FORMULA)){var p=c.gridRange;for(i=p.startRowIndex,s=p.endRowIndex;i<=s;i++)for(r=p.startColIndex,u=p.endColIndex;r<=u;r++)a.autoUpdateCellData(p.sheetId,i,r)}break;case T.default.SET_RANGE_MUTATION:for(i=0,u=c.cellDataDeltaAtPositions.length;i<u;i++){var v=c.cellDataDeltaAtPositions[i].cellDataDelta;n=v.setSlots|v.clearSlots;var _=c.cellDataDeltaAtPositions[i].cellDataDelta.delta.userEnteredFormatDelta;o=_?_.setSlots|_.clearSlots:0,0===(n&1<<d.default.SLOT_EFFIECTIVE_VALUE)&&0===(o&1<<f.default.NUMBER_FORMAT)&&0===(n&1<<d.default.SLOT_FORMULA)&&0===(o&1<<f.default.DATA_VALIDATION)&&0===(n&1<<d.default.SLOT_FORMULA)||a.autoUpdateCellData(c.gridRange.sheetId,c.cellDataDeltaAtPositions[i].rowIndex,c.cellDataDeltaAtPositions[i].colIndex)}}l.default.event.spreadsheetEvent.trigger("renderAfterMutationRun",t)})}},{key:"listenUpdateCellDatFromFormula",value:function(){var e=this;p.default.spreadsheetEvent.listen("updateCellDataFromFormula",function(t){e.parent.behavior.applyMutation(t,{isLocal:!0,isFromFormula:!0})})}},{key:"listenWorkrangeChange",value:function(){var e=this;p.default.spreadsheetEvent.listen("afterKeyframeRun",function(t){var a=t.sheetId,n=e.parent.spreadsheet.getSheetBySheetId(a);if(n){var i=n.sheetRangeControl;if(!i)return;var r=i.ranges;if(!r)return;(0,o.default)(r).forEach(function(e){for(var t=r[e],a=t.gridRange,o=a.startRowIndex,i=a.endRowIndex,s=a.startColIndex,l=a.endColIndex,u=o;u<=i;u++)for(var d=s;d<=l;d++){var c=n.getCellDataAtPosition(u,d);c||(c=new _.default,n.setCellDataAtPosition(u,d,c)),c.addSheetRange(e,t.sheetRangeType)}})}})}},{key:"listenUpdateCellDataDV",value:function(){var e=this;p.default.spreadsheetEvent.listen("updateCellDataDV",function(t){var a=new u.default,n=new c.default;"undefined"!==typeof t.dataValidation?n.setSlot(f.default.DATA_VALIDATION,t.dataValidation):n.clearSlot(f.default.DATA_VALIDATION),a.setSlot(d.default.SLOT_USER_ENTERED_FORMAT_DELTA,n);var o=new h.default({gridRange:t.gridRange,cellDataDelta:a});e.parent.behavior.applyMutation(o,{isLocal:!0})})}},{key:"listenHeaderChangeFromServer",value:function(){var e=this;p.default.default.listen("headerUpdateSync",function(t){e.parent.getCurrentMainThreadWorker().sheetList.headerUpdateSync({sheets:t})})}},{key:"listenHistoryPopState",value:function(){}},{key:"listenBeforeUnload",value:function(){return A(this,void 0,void 0,n.default.mark(function e(){var t,a=this;return n.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=!1,g.default.wait(15e3).run(function(){t&&S.default.monitor(33687112)}),l.default.window.onbeforeunload=function(){var e=a.parent.view.canvas.excel;if(!e)return"\u5173\u95ed\u8868\u683c";var n=e.tableData.tableStatus,o=e.selectData.selectStatus;return window.SpreadsheetApp&&window.SpreadsheetApp.location&&window.SpreadsheetApp.location.updateParamAsServer(),S.default.jank.log({moduleValue:"page",actionValue:"refresh"}),3===n||2===n&&o===v.SELECT_STATUS.FORMULA?(t=!0,S.default.monitor(33687112),"\u5173\u95ed\u8868\u683c\u5c06\u4e0d\u4f1a\u4fdd\u5b58\u4f60\u6240\u8f93\u5165\u7684\u5185\u5bb9\uff0c\u662f\u5426\u786e\u8ba4\u79bb\u5f00\uff1f"):a.parent.messageCenter.hasUncommittedChanges()?"\u6587\u6863\u5b58\u5728\u672a\u4fdd\u5b58\u4fee\u6539\uff0c\u5982\u679c\u5173\u95ed\uff0c\u4fee\u6539\u5c06\u4e0d\u4f1a\u88ab\u4fdd\u5b58\u3002\u60a8\u662f\u5426\u786e\u5b9a\u5173\u95ed\uff1f":void 0};case 3:case"end":return e.stop()}},e,this)}))}},{key:"listenExcelResize",value:function(){var e=this;p.default.windowEvent.listen("resize",function(t){var a=e.parent.hook.getBottomHeight&&e.parent.hook.getBottomHeight()||0,n=document.querySelector("#canvasContainer");if(null!==n){var o=window.innerHeight-n.getBoundingClientRect().top-a;n.style.height=o+"px",e.parent.preview.isActive||e.parent&&e.parent.view&&e.parent.view.canvas&&e.parent.view.canvas.excel&&"function"===typeof e.parent.view.canvas.excel.resize&&e.parent.view.canvas.excel.resize()}})}},{key:"listenDataVersion",value:function(){var e=this;l.default.event.spreadsheetEvent.listen("DataVersionTooLow",function(t){S.default.monitor(33872862),e.parent.event.errorCode.trigger("errorCode",{type:"front",code:E.errCodeType.DATA_VERSION_TOO_LOW})})}},{key:"listenAfterMutationRun",value:function(){var e=this;p.default.spreadsheetEvent.listen("afterMutationRun",function(t){if(e.isApplyingBehavior){var a=t.isReplay,n=t.isFromFormula,o=t.isCollab,i=t.isLocal;if(!a&&!n&&(i||o)){var r=t.mutation,s=t.sheetId;void 0===e.mutationsWillSyncToWorker[s]&&(e.mutationsWillSyncToWorker[s]=[]),e.mutationsWillSyncToWorker[s].push(r)}}})}},{key:"listenApplyBehavior",value:function(){var e=this;p.default.spreadsheetEvent.listen("applyBehaviorStart",function(t){void 0===e.mutationsWillSyncToWorker[t]&&(e.mutationsWillSyncToWorker[t]=[]),e.isApplyingBehavior=!0}),p.default.spreadsheetEvent.listen("applyBehaviorEnd",function(t){e.isApplyingBehavior=!1,e.mutationsSyncToWorker(t),e.mutationsWillSyncToWorker[t]=[]})}},{key:"mutationsSyncToWorker",value:function(e){void 0!==this.mutationsWillSyncToWorker[e]&&0!==this.mutationsWillSyncToWorker[e].length&&this.parent.getCurrentMainThreadWorker().mutationData.syncActiveSheetMutations({sheetId:e,mutations:this.mutationsWillSyncToWorker[e].map(function(e){return e})})}}]),e}();t.default=I},436:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.WorkerController=void 0;var n=u(a(3)),o=u(a(0)),i=u(a(4)),r=u(a(5)),s=u(a(713)),l=u(a(714));function u(e){return e&&e.__esModule?e:{default:e}}var d=new(t.WorkerController=function(e){function t(){(0,o.default)(this,t);var e=(0,i.default)(this,(t.__proto__||(0,n.default)(t)).call(this)),a=self;return e.channel=new l.default(a,e),e}return(0,r.default)(t,e),t}(s.default));t.default=d},437:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isInWorker=void 0,t.getCrossWorkerCellDataForFormulaFromCellData=function(e,t,a,i){var r=void 0;if(e){var s=e.getEffectiveValue(),l=(0,o.getExportFormat)(e),u=l?l.getNumberFormat():null,d=e.getEditValue();r={row:t,col:a,sheetId:i,effectiveValue:s?(0,n.serialize)(s):"",numberFormat:u?(0,n.serialize)(u):"",editValue:d}}else r={row:t,col:a,sheetId:i,effectiveValue:"",numberFormat:"",editValue:""};return r},t.isIE=function(){return-1!==navigator.userAgent.indexOf("msie")||-1!==navigator.userAgent.indexOf("rv:11")||!!window.ActiveXObject||"ActiveXObject"in window};var n=a(160),o=a(55);t.isInWorker=!1},438:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=d(a(24));t.getMisschange=function e(t,a,d,h){var f=[];function p(e,t,a,o){e&&Array.isArray(t)?(f.push.apply(f,(0,n.default)(t)),h(e,f,a,o)):h(e,void 0,a,o)}var v="";if(void 0!==d&&(v="&to="+d,d<a))return l.default.run(u.CONFIG.FETCH_USERCHANGE_ARGUMENT,[a,d]),void p(!1,void 0,r.errCodeType.FETCH_USER_CHANGE_TO_LESS_THAN_FROM,"\u53c2\u6570to\u5c0f\u4e8efrom");var _="/dop-api/get/changes?padId="+t+"&from="+a+v+"&xsrf="+o.default.getXsrf();l.default.run(u.CONFIG.FETCH_USERCHANGES,[a,d,c]);(0,i.default)({method:"get",url:_,responseType:"json"}).then(function(a){if(1===c&&l.default.monitor(34276670),c=0,!a||!a.data)return p(!1,void 0,r.errCodeType.FETCH_USER_CHANGE_RESPONSE_DATA_EMPTY,a&&a.statusText||"response is void"),void l.default.run(u.CONFIG.FETCH_USERCHANGES_3,[a&&a.status,a&&a.data]);var o=a&&a.data;if(0==o.retcode){var i=o.result,s=i.to,h=i.rev,v=i.changes;if(0===v.length)return l.default.monitor(33633645),void p(!1,void 0,r.errCodeType.FETCH_USER_CHANGE_RESPONSE_ARRAY_EMPTY,"retcode="+o.retcode);var _=v.map(function(e,t,a){var n=e.data;return{sheetId:n.subId,newVersion:n.newRev,changeset:n.changeset,isNeedKeyframe:n.need,head:n.head,revert:n.revert,commitId:n.commitId}});void 0===d&&h>s?(f.push.apply(f,(0,n.default)(_)),e(t,s+1,h,p)):void 0!==d&&d>s?(f.push.apply(f,(0,n.default)(_)),e(t,s+1,d,p)):p(!0,_,"","")}else{var E=o.retcode;E&&l.default.monitor({100000:33612375,100002:33612376,100003:33612377,200105:33612378,200200:33612379}[E]),p(!1,void 0,r.errCodeType.FETCH_USER_CHANGE_RESPONSE_ERROR_CODE,"retcode="+o.retcode)}}).catch(function(n){1===c?(c=0,p(!1,void 0,r.errCodeType.FETCH_USER_CHANGE_CGI_HTTP_ERROR,"fetch cgi error.")):(c++,s.default.wait(5e3).run(function(){e(t,a,d,h)}))})},t.getDocumentMutations=function e(t,a,r,s){s||(o.default.window.mutationListWithVersion=[],o.default.window.mutationsByList=[]);var l=o.default.window.clientVars.collab_client_vars.globalPadId;var u=[];function d(e,t,a,i){e&&Array.isArray(t)?(u.push.apply(u,(0,n.default)(t)),s||(console.log(o.default.window.mutationListWithVersion),console.log(o.default.window.mutationsByList)),r&&r(e,u,a,i)):r&&r(e,void 0,a,i)}var c="";if(void 0!==a&&(c="&to="+a,a<t))return void console.error("\u53c2\u6570\u8303\u56f4\u4e0d\u5bf9 to < from");var h="/dop-api/get/changes?padId="+l+"&from="+t+c+"&xsrf="+o.default.getXsrf();(0,i.default)({method:"get",url:h,responseType:"json"}).catch(function(e){console.error(e)}).then(function(t){var i=t&&t.status||-1;if(200===i){var r=t&&t.data;if(0==r.retcode){var s=r.result,l=s.to,c=s.rev,h=s.changes;if(0===h.length)return void console.error("F0005","retcode="+r.retcode);var f=h.map(function(e,t,a){var n=e.data;return{sheetId:n.subId,newVersion:n.newRev,changeset:n.changeset,isNeedKeyframe:n.need,head:n.head,revert:n.revert}});h.forEach(function(e,t,a){var n=e.data;o.default.window.mutationListWithVersion[n.newRev]={ver:n.newRev,author:n.author,commitId:n.commitId,sheetId:n.subId,changeset:n.changeset},o.default.window.mutationsByList[n.subId]||(o.default.window.mutationsByList[n.subId]=[]),o.default.window.mutationsByList[n.subId].push(n.changeset)}),void 0===a&&c>l?(u.push.apply(u,(0,n.default)(f)),e(l+1,c,d,"continue")):void 0!==a&&a>l?(u.push.apply(u,(0,n.default)(f)),e(l+1,a,d,"continue")):d(!0,f,"","")}else console.error("F0006","retcode="+r.retcode)}else console.error(t&&t.statusText||"response is void")})};var o=d(a(7)),i=d(a(100)),r=a(90),s=d(a(12)),l=d(a(8)),u=a(26);function d(e){return e&&e.__esModule?e:{default:e}}var c=0;o.default.window.mutationListWithVersion=[],o.default.window.mutationsByList=[]},439:function(e,t,a){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.getWindowScrollTop=function(){var e=window.scrollY;void 0===e&&(e=document.documentElement.scrollTop);return e},t.getScrollbarWidth=function(){void 0===n&&(n=function(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var a=e.offsetWidth;t.style.overflow="scroll";var n=e.offsetWidth;a==n&&(n=t.clientWidth);return(document.body||document.documentElement).removeChild(t),a-n}());return n},t.getWindowScrollLeft=function(){var e=window.scrollX;void 0===e&&(e=document.documentElement.scrollLeft);return e}},440:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(a(41));t.colNum2CharHeader=s,t.charHeader2ColNum=l,t.range2RelativeHex=function(e){var t=e.startRowIndex,a=e.endRowIndex,n=e.startColIndex,o=e.endColIndex,i=s(n),r=s(o),l=""+i+(t+1);t===a&&n===o||(l=l+":"+r+(a+1));return l},t.range2AbsoluteHex=function(e){var t=e.startRowIndex,a=e.endRowIndex,n=e.startColIndex,o=e.endColIndex,i=s(n),r=s(o),l="$"+i+"$"+(t+1);t===a&&n===o||(l=l+":$"+r+"$"+(a+1));return l},t.absoluteHex2Range=function(e,t){var a=function(e){var t=/^([A-Z]+)(\d*)$/.exec(e);if(t){var a=l(t[1]),n=""===t[2]?0:parseInt(t[2],10)-1;return[n,a]}return[0,0]},r=i.default.window.SpreadsheetApp,s=r.spreadsheet.activeSheet.getColCount()-1,u=r.spreadsheet.activeSheet.getRowCount()-1,d=e.replace(/[\$\s]/g,"").replace(/^=?(.*)/,"$1").toUpperCase().split(":");if(d.length>1){var c=(0,n.default)(d,2),h=c[0],f=c[1],p=0,v=0,_=0,E=0;if(/[A-Z]+\d+/.test(h)){var T=a(h),m=(0,n.default)(T,2);p=m[0],_=m[1];var g=a(f),S=(0,n.default)(g,2);v=S[0],E=S[1]}else/\d+/.test(h)?(_=0,E=s,p=parseInt(h,10)-1,v=parseInt(f,10)-1):/[A-Z]+/.test(h)&&(p=0,v=u,_=l(h),E=l(f));if(p>v){var R=[v,p];p=R[0],v=R[1]}if(_>E){var A=[E,_];_=A[0],E=A[1]}return new o.default.Range.GridRange(t,p,v,_,E)}var w=a(d[0]),I=(0,n.default)(w,2),C=I[0],y=I[1];return new o.default.Range.GridRange(t,C,C,y,y)},t.isValidHexRange=function(e){var t=e.replace(/\uff1a/g,":");if(/^\$?\d+:\$?\d+$/i.test(t)||/^\$?[A-Z]+:\$?[A-Z]+$/i.test(t)||/^\$?[A-Z]+\$?\d+(:\$?[A-Z]+\$?\d+)?$/i.test(t))return!0;return!1},t.mergeMultiRanges=function(e){var t=e.map(function(e){return e.clone()}),a=[];t.sort(function(e,t){return e.startColIndex-t.startColIndex});for(var n=t.length,i=null,r=0;r<n;r++){var s=t[r],l=!1;i?(i.contain(s)||(s.contain(i)?i=s:s.startRowIndex===i.startRowIndex&&s.endRowIndex===i.endRowIndex?s.startColIndex>=i.startColIndex&&s.startColIndex<=i.endColIndex?(i=new o.default.Range.GridRange(i.sheetId,i.startRowIndex,i.endRowIndex,i.startColIndex,Math.max(i.endColIndex,s.endColIndex)),l=!0):i.startColIndex===s.endColIndex+1?(i=new o.default.Range.GridRange(i.sheetId,i.startRowIndex,i.endRowIndex,s.startColIndex,i.endColIndex),l=!0):i.endColIndex===s.startColIndex-1&&(i=new o.default.Range.GridRange(i.sheetId,i.startRowIndex,i.endRowIndex,i.startColIndex,s.endColIndex),l=!0):s.startColIndex===i.startColIndex&&s.endColIndex===i.endColIndex&&(s.startRowIndex>=i.startRowIndex&&s.startRowIndex<=i.endRowIndex?(i=new o.default.Range.GridRange(i.sheetId,i.startRowIndex,Math.max(i.endRowIndex,s.endRowIndex),i.startColIndex,i.endColIndex),l=!0):i.startRowIndex===s.endRowIndex+1?(i=new o.default.Range.GridRange(i.sheetId,s.startRowIndex,i.endRowIndex,i.startColIndex,i.endColIndex),l=!0):i.endRowIndex===s.startRowIndex-1&&(i=new o.default.Range.GridRange(i.sheetId,i.startRowIndex,s.endRowIndex,i.startColIndex,i.endColIndex),l=!0))),l?r===n-1&&a.push(i):(a.push(i,s),i=null)):(r===n-1&&a.push(s),i=s)}return a};var o=r(a(89)),i=r(a(7));function r(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e,a="";for(t++;t>0;){var n=t%26;0===n&&(n=26),a=String.fromCharCode(64+Math.floor(n))+a,t=(t-n)/26}return a}function l(e){return e.toUpperCase().split("").reverse().reduce(function(e,t,a){return e+(t.charCodeAt(0)-64)*Math.pow(26,a)},0)-1}},441:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=f(a(41));t.getDelMessage=function(e,t){var a="",n=i.default.plugins.rmap&&i.default.plugins.rmap.isRelated(e);n&&(a="\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5de5\u4f5c\u8868\u5417\uff1f\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\u3002\u7ed1\u5b9a\u7684\u6536\u96c6\u8868\u4e5f\u5c06\u53d6\u6d88\u5173\u8054\uff0c\u6536\u96c6\u7ed3\u679c\u4e0d\u518d\u81ea\u52a8\u66f4\u65b0\u5230\u8868\u683c\u3002");n&&!t&&(l.default.dialog.dialog.info("\u5220\u9664\u5de5\u4f5c\u8868","\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5220\u9664\u5173\u8054\u4e86\u6536\u96c6\u8868\u7684\u5de5\u4f5c\u8868\u3002\u8bf7\u8054\u7cfb\u8868\u683c\u6240\u6709\u8005\u5220\u9664\u3002"),a=!1);return{isRelated:n,message:a}},t.getNewId=function(){return Math.random().toString(36).substr(2,6)},t.getNewName=function(e){var t=new Array;e.forEach(function(e){var a=e.getProperties().getTitle()||"";if(a.indexOf("\u5de5\u4f5c\u8868")>-1){var n=parseInt(a.substring(3));isNaN(n)||t.push(n)}}),t.length||t.push(0);return"\u5de5\u4f5c\u8868"+(Math.max.apply(null,t)+1)},t.getCopyName=function(e,t){var a=new RegExp("(.*)\\(\u526f\u672c(\\d*)\\)"),n=0,o="",i="";if(a.test(t)){var r=t.match(a);r&&(i=r[1])}else i=t;e.forEach(function(e){var t=(e.getProperties().getTitle()||"").match(a);if(t&&i===t[1]){var o=t[2];if(o){var r=Number(o);r>=n&&(n=r+1)}else n=n||1}}),o=n?i+"(\u526f\u672c"+n+")":t+"(\u526f\u672c)";return o},t.initTooltip=function(){(0,d.showTooltip)("#sheet-bottom-wrapper [data-tooltip]",{tooltipArrowClass:"tooltip-after"})},t.getSheetsForCommit=function(e){for(var t,a=[],n=0;t=e[n++];)a.push({id:t.getSheetId(),name:t.getTitle(),type:t.getProperties().getSheetType(),hidden:t.getProperties().getHidden()});return[a]},t.getLessSheetId=function(e,t){if(e.length<=t.length)return null;for(var a,n=t.map(function(e){return e.id}),i=0;a=e[i++];)if(!(0,o.inArray)(n,a.getSheetId()))return a.getSheetId();return null},t.getIndexFromListByProperty=function(e,t,a){if(e.length<=0)return 0;for(var n=0;n<e.length;n++)if(e[n].hasOwnProperty(t)&&e[n][t]&&e[n][t]==a)return n;return 0},t.setHash=function(e){location.hash=e},t.getRangeData=function(){var e=(0,u.singleRange)(i.default),t=[0,0,0];if(!e){var a=i.default.view.getSelection().rangeSelections[0],o=(0,s.convertGridRangeToCellId)(a);t=[109,101,103].map(function(e,t){var a=i.default.calcController.getResultBySingleFormula("SUBTOTAL("+e+","+o+")",i.default.spreadsheet.getActiveSheetId()),n=a.isError||"number"!==typeof a.result?0:a.result,s=function(e){e>99999999999&&(e=(0,r.extToExponential)(e,9));"string"!==typeof e&&(e=e.toString());var t=e.indexOf("e+"),a=e.split("e+"),n=11,o=e.indexOf("."),i="",s="";a.length>=2&&(n=11-a[1].length-2,i="e+"+a[1]);if(-1!==o&&-1!==t){var l=n-e.slice(0,o).length-1;s=Number(a[0]).toFixed(Math.min(n,l))+i}else if(-1!==o&&-1==t){var u=e.slice(o+1,e.length).length,d=n-e.slice(0,o).length-1;d<=0&&(d=0),s=Number(a[0]).toFixed(Math.min(u,d))}else s=a[0];return s}(n);return 2!==t?function(e){var t=i.default.view.getSelection().activeCell,a=t.rowIndex,n=t.colIndex,o=i.default.spreadsheet.activeSheet.getCellDataAtPosition(a,n);if(!o)return e;var s=new c.default.Cell.ExtendedValue({value:e}),l=(0,h.getExportFormat)(o),u=l?l.getNumberFormat():null;return(0,r.getCellFormattedValue)(s,u).value}(s):s})}var l=t,d=(0,n.default)(l,3),f=d[0],p=d[1],v=d[2];return{sum:f,avg:p,count:v,singleRange:e}};var o=a(174),i=f(a(172)),r=a(48),s=a(44),l=f(a(198)),u=a(286),d=a(245),c=f(a(89)),h=a(55);function f(e){return e&&e.__esModule?e:{default:e}}},442:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createAlertViewBox=t.showAlert=void 0;var n=i(a(47)),o=i(a(1138));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(){return n.default.resolve().then(function(){return{default:o.default}})};t.showAlert=function(e){r().then(function(t){new t.default(e).show()})},t.createAlertViewBox=function(e){return r().then(function(t){return new t.default(e)})}},445:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.escapeHTML=function(e){var t=/[&<>'"]/g;t.MAP||(t.MAP={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&#34;","'":"&#39;"});return e.replace(t,function(e){return t.MAP[e]})}},451:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SheetControlType=void 0;var n=r(a(0)),o=r(a(1)),i=r(a(7));function r(e){return e&&e.__esModule?e:{default:e}}var s=t.SheetControlType=void 0;!function(e){e[e.local=1]="local",e[e.collab=2]="collab"}(s||(t.SheetControlType=s={}));var l=function(){function e(t){(0,n.default)(this,e),this.app=t}return(0,o.default)(e,[{key:"addSheet",value:function(e,t){var a=t.sheetIndex,n=t.autoSwitch,o=void 0===n||n,r=t.sheetId,s=t.sheetName,l=t.sheetType,u=r,d=this.app.spreadsheet.createSheet(u,s);return d.setSheetType(l),this.app.spreadsheet.insertSheet(d,a),this.app.handleData.setDataCache(u,""),this.updateSheetsIndex(),o&&i.default.event.sheetsBar.trigger("switchSheet",u),r}},{key:"delSheet",value:function(e,t){var a=this.app.spreadsheet.sheetCount,n=this.app.spreadsheet.getNextDisplaySheetId(t);if(a<=1||n===t)throw new Error("sheets must have at least one sheet");if(!this.app.spreadsheet.getSheetBySheetId(t))throw new Error("sheetId is not exsited");if(s.local===e)i.default.event.sheetsBar.trigger("switchSheet",n);else if(s.collab===e){t===this.app.spreadsheet.activeSheet.getSheetId()&&(i.default.event.sheetsBar.trigger("switchSheet",n),i.default.event.sheetsBar.trigger("listenDelSheetEvent"))}return this.app.spreadsheet.deleteSheetBySheetId(t),this.app.handleData.delSheetSeletion(t),this.app.handleData.delSheetHeights(t),this.updateSheetsIndex(),n}},{key:"moveSheet",value:function(e){var t=e.sheetId,a=e.index;this.app.spreadsheet.moveSheet(t,a);this.updateSheetsIndex()}},{key:"renameSheetBySheetId",value:function(e,t){var a=this.app.spreadsheet.getSheetBySheetId(e);if(!a)throw new Error("sheet\u91cd\u547d\u540d\uff0csheetId\u5f02\u5e38");a.setTitle(t)}},{key:"hideSheet",value:function(e,t,a){var n=this.app.spreadsheet.getSheetBySheetId(t);if(n){var o=t;return a&&(o=this.app.spreadsheet.getNextDisplaySheetId(t),t===this.app.spreadsheet.activeSheetId&&i.default.event.sheetsBar.trigger("listenHideSheetEvent",s.local===e)),n.hide(a),(a&&t===this.app.spreadsheet.activeSheetId||!a&&s.local===e)&&i.default.event.sheetsBar.trigger("switchSheet",o),o}console.error("sheet\u9690\u85cf\uff0csheetId\u5f02\u5e38")}},{key:"updateSheetsIndex",value:function(){var e=this.app.spreadsheet.getSheets(),t=[];e.forEach(function(e,a){t.push({id:e.getSheetId(),name:e.getTitle()})}),this.app.handleData.updateHeader(t)}},{key:"setSheetsBySingleOperation",value:function(e){var t=this.app.spreadsheet.getSheets(),a=t.map(function(e){return e.getSheetId()}),n=e.map(function(e){return e.getSheetId()}),o=void 0,i=void 0,r=void 0;for(o=0,i=a.length;o<i;o++){if(-1===(r=n.indexOf(a[o]))){this.delSheet(s.collab,a[o]);break}if(r>o){if(n[o]===a[o+1]){this.moveSheet({sheetId:a[o],index:r});break}}else if(n[o]===a[o-1]){this.moveSheet({sheetId:a[o],index:r});break}}for(o=0,i=n.length;o<i;o++){if(-1===a.indexOf(n[o])){this.addSheet(s.collab,{sheetId:e[o].getSheetId(),sheetName:e[o].getTitle(),sheetIndex:o,sheetType:e[o].getSheetType(),autoSwitch:!1});break}if(e[o].getTitle()!==t[o].getTitle()){this.renameSheetBySheetId(n[o],e[o].getTitle());break}if(e[o].getDisplayHidden()!==t[o].getDisplayHidden()){this.hideSheet(s.collab,n[o],e[o].getDisplayHidden());break}}return this}}]),e}();t.default=l},46:function(e,t){e.exports=window.React},490:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=J(a(3)),o=J(a(0)),i=J(a(1)),r=J(a(4)),s=J(a(5)),l=J(a(500)),u=J(a(1019)),d=a(7),c=J(d),h=J(a(230)),f=J(a(1154)),p=J(a(410)),v=J(a(415)),_=J(a(1413)),E=a(160),T=J(a(1433)),m=J(a(1437)),g=a(697),S=a(79),R=a(193),A=J(a(1603)),w=J(a(1616)),I=a(1617),C=a(188),y=a(137),O=J(a(753)),D=J(a(1627)),N=a(438),M=J(a(100)),k=J(a(40)),b=a(98),P=J(a(238)),L=a(143),F=J(a(1632)),x=J(a(761)),U=J(a(311)),V=J(a(12)),H=J(a(1634)),B=a(71),G=J(a(8)),W=a(26),j=J(a(89)),Y=J(a(307)),z=J(a(451)),Q=J(a(416)),q=J(a(1636)),K=J(a(396)),Z=a(57);function J(e){return e&&e.__esModule?e:{default:e}}var X=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.isSheetIdDuplicate=!1,e.debugger?(0,r.default)(a):(a.isInited=!1,a.modules=[],a.event=k.default,a.hook=e.hook||[],a.Model=j.default,a.behaviorApi=Y.default.Api,a.featureApi=x.default,a.utils=U.default,a)}return(0,s.default)(t,e),(0,i.default)(t,[{key:"initBaseData",value:function(){var e=c.default.window.clientVars;(0,d.reInitCoreData)(e),this.sheetStatus.permission.init();var t=e.collab_client_vars,a=e.globalPadId,n=c.default.window.clientVars.initialTitle,o=t.header[0].d.slice(),i=t.initialAttributedText.text,r=t.padSubId;e.oPadSubId=(0,L.getQuery)("tab")||r;var s=e.userDomain,l=e.userId,u=e.userName,h=e.userPic,f=t.rev,p=(0,C.uuIdGenerate)(e.userId,e.client&&e.client.sid);r&&c.default.History.replace(r),G.default.run(W.CONFIG.PAGE_LOAD,[r,a,n,f,o]),this.data={activeSheetData:i,activeSheetId:r,header:o,spreadsheetId:a,title:n,baseVersion:f,userDomain:s,uuid:p,userId:l,userName:u,userAvatar:h}}},{key:"initSpreadsheetAppInWorker",value:function(e){O.default.sheetData.initSpreadsheetApp({activeSheetData:e.activeSheetData,activeSheetId:e.activeSheetId,header:e.header,spreadsheetId:e.spreadsheetId,title:e.title,waitForFormulaLayerToBeInitialized:!0})}},{key:"init",value:function(){var e=this;window.performanceData&&(window.performanceData.spreadInitStart=+new Date),P.default.info("SpreadsheetApp init"),this.sheetStatus=new T.default,this.initBaseData();var t=this.data;this.initEnvironment(),this.sheetStatus=new T.default,this.initSpreadsheet({sheetsList:t.header,spreadsheetId:t.spreadsheetId,activeSheetId:t.activeSheetId}),this.handleData=new u.default({app:this,spreadsheetId:t.spreadsheetId,header:t.header,activeSheetId:t.activeSheetId,activeSheetData:t.activeSheetData,uuid:t.uuid}),K.default.report("data_process"),this.preview=new m.default(this),this.view=new f.default(this),this.sheetControl=new z.default(this),this.inactiveView=null,new v.default(this),this.plugins=new _.default(this),this.calcController=new Q.default(this),this.uiCenter=new H.default(this),this.messageOfflineStore=new D.default({app:this,baseVersion:t.baseVersion,globalPadId:t.spreadsheetId,userDomain:t.userDomain,userId:t.userId,isNeedInitOfflineData:this.sheetStatus.permission.gEditable}),this.messageCenter=new w.default(this,t);var a={messageHandler:this.messageCenter};this.socket=new A.default(this,a),this.behavior=new p.default(this),window.performanceData&&(window.performanceData.spreadInitDataStart=+new Date),this.initData(t.activeSheetId,function(a){var n=new Date;window.performanceData&&(window.performanceData.spreadInitDataEnd=+new Date),V.default.wait(0).run(function(){e.initSpreadsheetAppInWorker(t),c.default.window.__global.event.default.trigger("spreadInitFinished"),e.hasDuplicateSheetId(t.header)&&(e.isSheetIdDuplicate=!0,G.default.run(W.CONFIG.DUPLICATE_SHEET_ID,[t.header])),G.default.run(W.CONFIG.LOAD_DATA_SUCC,a,n,3),G.default.run(W.CONFIG.REPORT_FILES_TIMES)})}),window.performanceData&&(window.performanceData.spreadInitEnd=+new Date),this.feature=new F.default(this),this.isInited=!0}},{key:"hasDuplicateSheetId",value:function(e){for(var t={},a=0;a<e.length;a++){var n=e[a].id;if(t[n])return!0;t[n]=!0}return!1}},{key:"initData",value:function(e,t){var a=new Date;c.default.window.needOpenSpeedReport=!0,this.handleData.loadSheet(e,{onSuccess:function(){"function"===typeof t&&t(a)}})}},{key:"initSpreadsheet",value:function(e){var t=this;this.spreadsheet=new h.default({parent:this,spreadsheetId:e.spreadsheetId,isReadonly:!this.sheetStatus.permission.gEditable,activeSheetId:e.activeSheetId,mainThreadWorker:O.default}),this.spreadsheet.properties.title=e.title,e.sheetsList.forEach(function(e,a){var n=e.id,o=e.name,i=e.hidden,r=t.spreadsheet.createSheet(n,o,i);t.spreadsheet.insertSheet(r,a)})}},{key:"updateSpreadsheet",value:function(e){var t=this;O.default.sheetData.updateSpreadsheet({sheetsList:e}),this.spreadsheet.clearSheets(),this.handleData.updateHeader(e),e.forEach(function(e,a){var n=e.id,o=e.name,i=e.hidden,r=t.spreadsheet.createSheet(n,o,i);t.spreadsheet.insertSheet(r,a)});var a=e[0].id;this.spreadsheet.setActiveSheetId(a),this.handleData.init({header:e,activeSheetId:a}),this.event.default.trigger("update-spread-sheet")}},{key:"revertSpreadSheet",value:function(){var e=this,t="/dop-api/get/tabs?padId="+this.spreadsheet.spreadsheetId+"&rev=&xsrf="+c.default.getXsrf();(0,M.default)({method:"get",url:t,responseType:"json"}).then(function(t){t.status;var a=t.data;if(0==a.retcode){var n=a.header&&a.header[0].d;e.updateSpreadsheet(n)}})}},{key:"applySheetsChanges",value:function(e){var t=this,a=[],n=[];e.forEach(function(e,o){var i=t.spreadsheet.createSheet(e.id,e.name,e.hidden);a.push(i),n.push(e.id)}),this.sheetControl.setSheetsBySingleOperation(a),k.default.sheetsBar.trigger("refresh"),-1===n.indexOf(this.spreadsheet.activeSheetId)&&(0,B.showToast)("\u6587\u6863\u5df2\u88ab\u66f4\u65b0"),k.default.default.trigger("headerUpdateSync",e)}},{key:"initEnvironment",value:function(){}},{key:"getCurrentMainThreadWorker",value:function(){return(this.preview&&this.preview.isActive?this.preview.previewsheet:this.spreadsheet).mainThreadWorker}},{key:"tools",get:function(){return{transform:g.transform,deserializeMutation:S.deserializeMutation,follow:R.followRequests,serialize:E.serialize,createMutationFromSerialize:y.createMutationFromSerialize,dispatchKeyframe2Sheet:C.dispatchKeyframe2Sheet,createZipKeyframe:C.createZipKeyframe,__sendChangeForTest:this.messageCenter.__sendChangeForTest.bind(this.messageCenter),getDocumentMutations:N.getDocumentMutations,getMisschange:N.getMisschange,isActiveCellContainDV:b.isActiveCellContainDV,showColIndexFilterBoard:function(e){(0,I.__showFilterBoard)({xIndex:e,yIndex:0})},searchInPreview:C.searchInPreview,isTwoSheetConsistent:q.default,parseValueWithStyle:Z.parseValueWithStyle}}}]),t}(l.default);t.default=X},500:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}var r=function(){function e(t){(0,n.default)(this,e),t.debugger||(this.data=t)}return(0,o.default)(e,[{key:"revertSpreadSheet",value:function(){}},{key:"applySheetsChanges",value:function(e){}},{key:"getCurrentMainThreadWorker",value:function(){return{}}},{key:"addModule",value:function(e,t){if(e&&t){if(this[e])throw new Error("["+e+"] module have been mounted!");this.modules.push(e),this[e]=t}return this}},{key:"removeModule",value:function(e){if(this[e]){"function"===typeof this[e].destroy&&this[e].destroy(),delete this[e];var t=this.module.indexOf(e);this.modules.splice(t,1)}return this}},{key:"runModule",value:function(e){return this[e]&&"function"===typeof this[e].init&&this[e].init(),this}},{key:"runAllModules",value:function(e){var t=this;return(e&&Array.isArray(e)?e:this.modules).forEach(function(e){t.runModule(e)}),this}},{key:"addHook",value:function(e,t){this.hook[e]&&console.warn("try add exist spreadsheetapp hoo "+e+"!!!"),this.hook[e]=t}}]),e}();t.default=r},665:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(24),i=(n=o)&&n.__esModule?n:{default:n};t.polyfillFontFamily=function(e){if(!e)return"Microsoft YaHei,\u5fae\u8f6f\u96c5\u9ed1";for(var t=e,a=0;a<u.length;a++){var n=u[a].name,o=u[a].index;t===n&&(t=l[o].join(","))}return t};var r=a(769),s=a(22);var l=s.browser.isMac?r.fontFamilyConfigDataMac:s.browser.isios?r.fontFamilyConfigDataPad:r.fontFamilyConfigDataWin,u=function(){for(var e=[],t=0;t<l.length;t++)l[t]instanceof Array&&l[t].length>1&&e.push.apply(e,(0,i.default)(l[t].map(function(e){return{name:e,index:t}})));return e}()},671:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=function(){return a.e("bundle_ui_padmodal").then(a.t.bind(null,1656,7))};t.showModal=function(e,t,a){n().then(function(n){n.default.showModal(e,t,a)})},t.hideModal=function(e,t){n().then(function(a){a.default.hideModal(e,t)})},t.showAuthChangeModal=function(){n().then(function(e){e.default.showAuthChangeModal()})}},673:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Raven=void 0;var n,o=a(7),i=(n=o)&&n.__esModule?n:{default:n};t.Raven=i.default.window.Raven},674:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(0)),o=h(a(1)),i=h(a(1155)),r=h(a(7)),s=h(a(379)),l=h(a(378)),u=h(a(11)),d=a(188),c=a(82);function h(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,n.default)(this,e),this.parent=t,this.init()}return(0,o.default)(e,[{key:"refreshExcelView",value:function(){this.canvas.initData("#canvasContainer"),this.reportLocation()}},{key:"resizeExcelView",value:function(){}},{key:"getSelection",value:function(){for(var e=this.canvas.excel.selectData,t=void 0,a=e.selectQueue,n=0,o=this.parent.spreadsheet.getActiveSheetId(),i=new l.default(o,e.active.yIndex,e.active.xIndex),r=[];n<a.length;n++)t=a[n],r.push(new u.default(o,t.yRange[0],t.yRange[1],t.xRange[0],t.xRange[1]));return new s.default(i,r,[],!1)}},{key:"setSelection",value:function(e,t){if("string"===typeof e)try{e=u.default.from(e)}catch(g){throw g}var a=t||{},n=a.scrollToTop,o=void 0!==n&&n,i=a.scrollToLeft,s=void 0!==i&&i,l=a.visible,d=void 0===l||l,c=this.canvas.excel,h=this.parent.spreadsheet.getActiveSheetId(),f=e,p=f.sheetId,v=f.startColIndex,_=f.endColIndex,E=f.startRowIndex,T=f.endRowIndex,m=function(){c.selectAreaCell({xRange:[v,_],yRange:[E,T]},{x:v,y:E},d,{sheetIds:[p,p]}),(o||s)&&c.scrollToRowCol({row:o?E:void 0,col:s?v:void 0})};h===p?m():r.default.event.sheetsBar.trigger("switchSheet",p,h,{onSuccess:m})}},{key:"initAfterCanvasLoaded",value:function(){this.initInputBox(),this.initPlugins(),window.performanceData&&(window.performanceData.initAfterCanvasLoaded=+new Date),r.default.event.default.trigger("alloyExcelFirstRender");var e=document.querySelector(".snapshot-img-standalone")||document.querySelector(".snapshot-img-container");e&&document.body.removeChild(e)}},{key:"getSheetLocation",value:function(){var e=this.canvas.excel,t={xRange:[0,0],yRange:[0,0],row:{frozen:0,flow:0},col:{frozen:0,flow:0}};if(e&&e.selectData.select.xRange&&e.selectData.select.yRange){var a=e.selectData.select;t={xRange:[(0,d.getNonnegative)(a.xRange[0]),(0,d.getNonnegative)(a.xRange[1])],yRange:[(0,d.getNonnegative)(a.yRange[0]),(0,d.getNonnegative)(a.yRange[1])],row:{frozen:e.areaData.row.frozen.offsetY,flow:e.areaData.row.flow.offsetY},col:{frozen:e.areaData.col.frozen.offsetX,flow:e.areaData.col.flow.offsetX}}}return t}},{key:"afterSelectionEnd",value:function(e,t,a){var n={coords:[t,e,t,e],isEditing:a};r.default.event.network.trigger("userCaretChange",n)}},{key:"afterPickShape",value:function(e){var t={shapeId:e};r.default.event.network.trigger("userCaretChange",t)}},{key:"reportLocation",value:function(){if(this.canvas.excel){var e=this.canvas.excel.selectData.active.xIndex,t=this.canvas.excel.selectData.active.yIndex,a={coords:[t,e,t,e],isEditing:this.canvas.isEditing};r.default.event.network.trigger("userCaretChange",a)}}},{key:"getCurrentPosition",value:function(){var e=this.canvas.excel;return{rowIndex:e.areaData.row.flow.from,colIndex:e.areaData.col.flow.from}}},{key:"init",value:function(){this.initCanvas()}},{key:"initCanvas",value:function(){var e=this;this.canvas=new i.default({spreadsheetApp:this.parent,callback:function(){e.initAfterCanvasLoaded(),e.parent.event.init.trigger(c.EVENT_NAME.AFTER_FIRST_RENDER)},endRenderCallback:function(){e.parent.event.init.trigger(c.EVENT_NAME.AFTER_ALL_RENDER)}})}},{key:"initPlugins",value:function(){this.plugins={}}},{key:"initInputBox",value:function(){}}]),e}();t.default=f},691:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(47));t.randomString=u,t.getRandomAttachmentId=d,t.handleImage=c;var o=l(a(100)),i=l(a(81)),r=l(a(198)),s=l(a(1310));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){var t="",a=void 0;for(e=void 0!==e?e:4,a=0;a<e;a++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t}function d(){return"attachment-"+Date.now()+"-"+u()}function c(e,t){var a=d();return new n.default(function(l,u){return function(e,t,a,l,u){var d=void 0,c=void 0,h=void 0,f=void 0,p=void 0,v=e.size,_=void 0;if(e.size>20971520)return void"\u8bf7\u9009\u62e920M\u4ee5\u5185\u7684\u56fe\u7247\u63d2\u5165";function E(e){var d=window.clientVars,E=Date.now(),T=r.default.toast.showVipToast({errorCode:70002,fileSize:e.size,source:u?"picture_Paste":"picture_insect_menu"});T||s.default.maybeShrinkImage(e,function(s,u,T,m,g){var S="/ep/api/attach_local?globalPadId="+d.globalPadId,R=location.hostname+"_"+d.padId+"_"+d.userId+"_"+ +new Date+"_"+e.name,A=new FormData;A.append("file",s),_=s.size,c=m,h=g,o.default.post(S,A,{responseType:"json"}).then(function(o){o.data.retcode;var r=o.data.url;new n.default(function(t,a){!function(e,t,a,n,o){"undefined"!==typeof n&&"undefined"!==typeof o&&(f=n,p=o,e({width:n,height:o}));var i=new FileReader;i.readAsDataURL(a),i.onload=function(a){var n=this.result,o=new Image;o.onload=function(){c=o.width,h=o.height,f=o.width,p=o.height,e({width:o.width,height:o.height})},o.onerror=function(){t()},o.src=n},i.onerror=function(){t()}}(t,a,e,u,T)}).then(function(e){var n=e.width,o=e.height,s=n/o;n>o?n>400&&(o=(n=400)/s):o>400&&(n=(o=400)*s),a({url:r,id:t,width:n,height:o}),i.default.util.timer.wait(500).run(function(){i.default.event.toolBar.trigger("upload-image-successed",{url:r,key:R,id:t,replaceHolder:!0})}),i.default.report.tdwReport({opername:"doc_excel",module:"pic",action:"updown_succe",ver2:c,ver3:h,ver4:f,ver5:p,ver6:v,ver7:_,ver8:Date.now()-E})},function(){console.warn("\u83b7\u53d6\u4e0a\u4f20\u56fe\u7247\u5bbd\u9ad8\u5931\u8d25")})}).catch(function(e){return r.default.toast.showToast("\u7f51\u7edc\u5f02\u5e38\uff0c\u4e0d\u652f\u6301\u63d2\u5165\u56fe\u7247\uff0c\u8bf7\u5728\u7f51\u7edc\u6b63\u5e38\u540e\u518d\u8bd5\u3002",void 0,{toolToastCloseTime:5e3}),i.default.report.tdwReport({opername:"doc_excel",module:"pic",action:"updown_fail",ver2:c,ver3:h,ver4:f,ver5:p,ver6:v,ver7:_,ver8:Date.now()-E}),l(e)})})}window.CoreSheet&&window.CoreSheet.lib.getExif().then(function(t){t.getData(e,function(){d=t.getAllTags(this),6===d.Orientation?function(e,t,a){var n=new FileReader;n.readAsDataURL(e),n.onload=function(n){var o=this.result,i=new Image;i.onload=function(){c=i.width,h=i.height;var o=i.width/1280,r=i.width>1280,s=r?1280:i.width,l=r?Math.floor(i.height/o):i.height,u=document.createElement("canvas"),d=u.getContext("2d"),f=void 0,p=void 0,v=void 0,_=void 0,E=void 0;u.width=l,u.height=s,d.rotate(90*Math.PI/180),d.drawImage(i,0,-l,s,l);try{u.toBlob(function(e){t(e)})}catch(n){try{for(p=e&&e.type||"image/jpeg",v=atob(u.toDataURL(p,1).split(",")[1]),_=v.length,f=new Uint8Array(_),E=0;E<_;E++)f[E]=v.charCodeAt(E);t(new Blob([f],{type:p}))}catch(T){a(new Blob([],{type:p}))}}},i.src=o}}(e,E,E):E(e)})})}(e,a,l,u,t)})}t.default=function(e){var t,a=void 0,o=[],i=null;return null===i&&((i=document.createElement("input")).setAttribute("id","hideImgSelector"),i.setAttribute("type","file"),"undefined"!=typeof external&&"undefined"!=typeof external.nativeCall?i.setAttribute("accept","*.*"):i.setAttribute("accept","image/jpeg,image/jpg,image/png,image/gif"),i.setAttribute("style","display:none"),document.body.appendChild(i)),"camera"===e&&i.setAttribute("capture","camera"),window.FileReader?(t=new n.default(function(e,t){i.addEventListener("change",function(){if(console.log(40,"change"),this.files){for(a=0;a<this.files.length;a++)o.push(c(this.files[a]));n.default.all(o).then(function(t){e(t)}).catch(function(){t()})}else t()})}),i.click(),t):(console.warn("can't upload image"),null)}},698:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(24)),o=u(a(0)),i=u(a(1)),r=u(a(7)),s=u(a(8)),l=a(26);function u(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,o.default)(this,e),this.redo=t.redo||[],this.undo=t.undo||[],this.local=!!t.local,this.sheetId=t.sheetId}return(0,i.default)(e,[{key:"add",value:function(e){var t=r.default.window.SpreadsheetApp,a=0;this.redo=this.redo.concat(e);try{if(this.local)for(var n=void 0;a<e.length;a++)(n=e[a].invert(t.spreadsheet)).forEach(function(t){t.parentRequestId=e[a].parentRequestId}),this.undo=n.concat(this.undo)}catch(o){s.default.run(l.CONFIG.INVER_MUTATION_ERROR,e,o),console.log(o)}}},{key:"invertRedo",value:function(){var e=r.default.window.SpreadsheetApp,t=void 0;for(this.redo.length=0,t=this.undo.length-1;t>=0;t--)Array.prototype.push.apply(this.redo,this.undo[t].invert(e.spreadsheet))}},{key:"run",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=(this.undo.length,r.default.window.SpreadsheetApp);t&&(this.redo=[]),this.undo.forEach(function(o){t&&(e.redo=[].concat((0,n.default)(o.invert(a.spreadsheet)),(0,n.default)(e.redo))),o.run(a.spreadsheet,{isLocal:!0})})}},{key:"reverse",value:function(){return new e({sheetId:this.sheetId,redo:this.undo,undo:this.redo,local:this.local})}},{key:"transform",value:function(t){if(this.sheetId!==t.sheetId)return{local:this,sync:t};var a,n=[],o=void 0,i=void 0,r=void 0,s=void 0,l=[],u=void 0,d=[];for(r=0;r<t.redo.length;r++){for(s=[t.redo[r]];this.undo.length>0;)u=this.undo.shift(),s.forEach(function(e){i=e.transform(u,!1),o=u.transform(e,!0),Array.prototype.push.apply(l,i),Array.prototype.push.apply(d,o)}),s=l,l=[];this.undo=d,d=[],Array.prototype.push.apply(n,s)}return a=this.undo,{local:new e({sheetId:this.sheetId,undo:a,redo:[],local:!0}),sync:new e({sheetId:t.sheetId,redo:n,local:!1})}}}]),e}();t.default=d},7:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reInitCoreData=function(e){u.clientVars=e};var n,o=a(40),i=(n=o)&&n.__esModule?n:{default:n},r=a(124);var s=window;var l={replace:function(e){var t=s.location.href.split("?")[1],a="",n=s.location.hash;a=t&&(t=(t=t.split("&")).filter(function(e){return e.indexOf("tab=")<0&&e.indexOf("#")<0})).length?"?"+t.join("&")+"&tab="+e:"?tab="+e,n&&(a+=n),s.history.replaceState(e,"",a)},pop:function(e){i.default.windowEvent.listen("popState",e)}},u={window:s,document:s.document,event:i.default,setHash:function(e){s.location.hash=e},getXsrf:function(){return(0,r.getCookie)("TOK")||""},getUrl:function(){return s.clientVars.shortLink},resized:function(e,t){i.default.windowEvent.listen("resize",function(){e()})},sheetNode:s.sheetNode,clientVars:s.clientVars,windowEvent:i.default.windowEvent,bodyEvent:i.default.bodyEvent,pad:s.pad,History:l};s.__core=u,t.default=u},706:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.default={QUICKLOOK_STEP:6e5,QUICKLOOK_STEP_PC:6e5,QUICKLOOK_STEP_PAD:6e5,QUICKLOOK_STEP_MOBILE:6e5,QUICKLOOK_MAX_COSTTIME:2e3,QUICKLOOK_INIT_TIME:5e3}},707:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(0)),o=s(a(1)),i=a(414),r=s(a(12));function s(e){return e&&e.__esModule?e:{default:e}}var l=Math.max(window.devicePixelRatio||1,2),u=function(){function e(t){var a=this;(0,n.default)(this,e),this._hideCard=function(){a.cardVisiable=!1,a.hideTimer&&a.hideTimer.stop(),a.hideTimer=null;var t=e.stage;t.renderNextTick&&t.renderNextTick()},this.users=[],this._drawCacheCard=(0,i.debounce)(this._drawCacheCard,0),this.x=t.x,this.y=t.y,this.cacheImage=new Image,this.cardVisiable=!1,t.users&&t.users.forEach(function(e){a.insertUser(e)})}return(0,o.default)(e,[{key:"_drawCacheCard",value:function(){var t=e.ctx,a=this.users[0];if(a){this.color=a.color;var n=(0,i.calcText)(this.users),o=e.ctx.measureText(n).width+11*l*2,r=23*l;t.clearRect(0,0,o,r),t.save(),t.beginPath(),t.fillStyle=this.color,t.rect(0,0,o,r),t.fill(),t.closePath(),t.beginPath(),t.fillStyle="#ffffff",t.fillText(n,11*l,r/2),t.closePath(),t.restore();var s=e.canvas.toDataURL("image/jpeg");this.cacheImage.src=s,this.textWidth=o/l>>0,this._showCard()}}},{key:"_showCard",value:function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.cardVisiable=!0,this.hideTimer&&this.hideTimer.stop(),t&&(this.hideTimer=r.default.wait(5e3).run(this._hideCard));var a=e.stage;a.renderNextTick&&a.renderNextTick()}},{key:"_renderBorder",value:function(t,a,n,o){var i=e.stage.ctx;i.save(),i.beginPath(),i.strokeStyle=this.color,i.lineWidth=2,i.rect(t,a,n,o),i.stroke(),i.closePath(),i.restore()}},{key:"_renderCard",value:function(t,a,n,o){var i=e.stage,r=i.ctx,s=i.tableData.scale,u=23*s;a>u?a-=u:a+=o,t=t+n-this.textWidth*s,t=Math.max(i.configData.rowHeadWidth,t),r.save(),r.beginPath(),r.drawImage(this.cacheImage,0,0,this.textWidth*l,23*l,t,a,this.textWidth*s,u),r.closePath(),r.restore()}},{key:"_isVisiable",value:function(){var t=e.stage.areaData,a=this.x,n=this.y;if(a<t.col.frozen.length){if(a<t.col.frozen.from)return!1;if(a>t.col.frozen.to)return!1}else{if(a<t.col.flow.from)return!1;if(a>t.col.flow.to)return!1}if(n<t.row.frozen.length){if(n<t.row.frozen.from)return!1;if(n>t.row.frozen.to)return!1}else{if(n<t.row.flow.from)return!1;if(n>t.row.flow.to)return!1}return!0}},{key:"insertUser",value:function(e){e.isEditing?this.users.unshift(e):this.users.push(e),this._drawCacheCard()}},{key:"eraseUser",value:function(e){var t=this.users.indexOf(e);t>-1&&this.users.splice(t,1),0!==this.users.length?this._drawCacheCard():this._hideCard()}},{key:"render",value:function(){if(this._isVisiable()){var t=e.stage,a=t.ctx,n=t.areaData.col.getViewportLeft(this.x),o=t.areaData.row.getViewportTop(this.y),i=t.tableData.getCellDataAtPosition(this.y,this.x),r=void 0,s=void 0;i&&i.parent?(r=i.parent.mergeData.xRange,s=i.parent.mergeData.yRange):(r=[this.x,this.x],s=[this.y,this.y]);var l=t.tableData.col.getRangeWidth(r),u=t.tableData.row.getRangeHeight(s),d=t.areaData.col.getArea(this.x),c=t.areaData.row.getArea(this.y);a.save(),a.beginPath(),a.rect(d.viewStart,c.viewStart,d.maxDistance,c.maxDistance),a.closePath(),a.clip(),this._renderBorder(n,o,l,u),this.cardVisiable&&this._renderCard(n,o,l,u),a.restore()}}},{key:"usersAmount",value:function(){return this.users.length}},{key:"usersEditingAmount",value:function(){var e=0;return this.users.forEach(function(t){t.isEditing&&e++}),e}},{key:"active",value:function(){this._showCard()}},{key:"inactive",value:function(){this._hideCard()}}],[{key:"init",value:function(t){e.stage=t.alloyExcel,e.canvas=document.createElement("canvas"),e.canvas.height=23*l,e.canvas.width=500*l,e.canvas.dir="ltr",e.ctx=e.canvas.getContext("2d"),e.ctx.font=13*l+"px Microsoft YaHei",e.ctx.textAlign="left",e.ctx.textBaseline="middle"}}]),e}();t.default=u},708:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(14)),o=l(a(0)),i=l(a(1)),r=a(414),s=l(a(12));function l(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(t){var a=this;(0,o.default)(this,e),this._hideCard=function(){a.hideTimer&&a.hideTimer.stop(),a.hideTimer=null,a.topLeftFrame.children[0].style.display="none",a.topRightFrame.children[0].style.display="none",a.bottomLeftFrame.children[0].style.display="none",a.bottomRightFrame.children[0].style.display="none"},this.users=[],this.shapeId=t.shapeId;var i=document.createElement("div");(0,n.default)(i.style,{position:"absolute",borderWidth:"2px",borderStyle:"solid",top:0,left:0,width:"100%",height:"100%",boxSizing:"border-box",fontSize:"0px"}),this.topLeftFrame=i.cloneNode(),this.topRightFrame=i.cloneNode(),this.bottomLeftFrame=i.cloneNode(),this.bottomRightFrame=i.cloneNode(),this._addShapeBorder()}return(0,i.default)(e,[{key:"_addShapeBorder",value:function(){var t=this.shapeId,a=e.stage.imageCenter,o=document.createElement("span");function i(e,a){var n=o.cloneNode();a.appendChild(n),e.images&&e.images[t]&&e.images[t].wrap.appendChild(a)}(0,n.default)(o.style,{position:"absolute",padding:"0 22px 0 22px",top:"100%",height:"46px",lineHeight:"46px",fontSize:"26px",color:"white",transformOrigin:"left top",transform:"scale(0.5, 0.5)",display:"none"}),i(a.topLeft,this.topLeftFrame),i(a.topRight,this.topRightFrame),i(a.bottomLeft,this.bottomLeftFrame),i(a.bottomRight,this.bottomRightFrame)}},{key:"_updateShapeBorder",value:function(){var t=this.shapeId;if(e.stage.tableData.shapes[t])if(void 0!==this.users[0]){var a=(0,r.calcText)(this.users),n=this.users[0].color;o(this.topLeftFrame),o(this.topRightFrame),o(this.bottomLeftFrame),o(this.bottomRightFrame),this._showCard()}else this._removeShapeBorder();function o(e){e.style.borderColor=n,e.children[0].innerText=a,e.children[0].style.backgroundColor=n,e.children[0].style.display="inline"}}},{key:"_removeShapeBorder",value:function(){var t=this.shapeId,a=e.stage.imageCenter;function n(e,a){var n=void 0;e.images&&e.images[t]&&(n=e.images[t].wrap).contains(a)&&n.removeChild(a)}n(a.topLeft,this.topLeftFrame),n(a.topRight,this.topRightFrame),n(a.bottomLeft,this.bottomLeftFrame),n(a.bottomRight,this.bottomRightFrame)}},{key:"_showCard",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.hideTimer&&this.hideTimer.stop(),e&&(this.hideTimer=s.default.wait(5e3).run(this._hideCard))}},{key:"insertUser",value:function(e){this.users.unshift(e),this._updateShapeBorder()}},{key:"eraseUser",value:function(e){var t=this.users.indexOf(e);t>-1&&this.users.splice(t,1),this._updateShapeBorder()}},{key:"userAmount",value:function(){return this.users.length}},{key:"active",value:function(){this._showCard()}}],[{key:"init",value:function(t){e.stage=t.alloyExcel}}]),e}();t.default=u},71:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hideToast=t.showToast=t.getToast=void 0,t.showVipToast=function(e){if(!r){var t=a(1137);r=i.default.util.userAgent.isMobile||i.default.util.userAgent.isPad?t.MobileVipToast:t.PcVipToast}return r.showToast(e)};var n,o=a(81),i=(n=o)&&n.__esModule?n:{default:n};var r=null;var s=t.getToast=function(){return Promise.resolve().then(a.t.bind(null,751,7))};t.showToast=function(e,t,a,n){s().then(function(o){o.showToast(e,t,a,n)})},t.hideToast=function(){s().then(function(e){e.hideToast()})}},712:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(a(16)),o=_(a(0)),i=_(a(1)),r=a(1442),s=a(1444),l=a(1445),u=a(1446),d=a(1447),c=a(1448),h=a(1449),f=a(1451),p=_(a(8)),v=a(1452);function _(e){return e&&e.__esModule?e:{default:e}}var E=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";(0,o.default)(this,e),this.mainThreadController=new r.MainThreadController(t),this.workerAbilityTest=new s.WorkerAbilityTest(this.mainThreadController),this.report=new l.Report(this.mainThreadController),this.raven=new u.Raven(this.mainThreadController),this.cookie=new d.Cookie(this.mainThreadController),this.sheetData=new c.SheetData(this.mainThreadController),this.mutationData=new h.MutationData(this.mainThreadController),this.sheetList=new f.SheetList(this.mainThreadController),this.snapshot=new v.Snapshot(this.mainThreadController)}return(0,i.default)(e,[{key:"terminateWorker",value:function(){this.mainThreadController.worker.terminate()}},{key:"reportWorkerStatus",value:function(){if(!0!==this.hasReportWorkerStatus){this.hasReportWorkerStatus=!0;var e=r.MainThreadController.isSupportWorker,t=this.mainThreadController.isSupportWorker,a=!!this.timeWorkerReplyMessage,o=-1;a&&(o=this.timeWorkerReplyMessage-this.mainThreadController.timeBeforeNewWorker);var i={hasWorkerObject:e,canNewWorker:t,canPostMessage:a,workerReadyDuration:o,newWorkerDurationMainThread:this.mainThreadController.timeAfterNewWorker-this.mainThreadController.timeBeforeNewWorker};p.default.tdwReport({opername:"tech_doc",module:"formula_worker",action:"worker_status",ver5:(0,n.default)(i)}),t||p.default.monitor(33848585),a||p.default.monitor(33848586)}else p.default.monitor(34097396)}}]),e}();t.default=E},713:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=u(a(114)),o=u(a(0)),i=u(a(1)),r=u(a(47)),s=u(a(7)),l=(u(a(12)),u(a(8)));function u(e){return e&&e.__esModule?e:{default:e}}var d=function(e,t,a,n){return new(a||(a=r.default))(function(o,i){function r(e){try{l(n.next(e))}catch(t){i(t)}}function s(e){try{l(n.throw(e))}catch(t){i(t)}}function l(e){e.done?o(e.value):new a(function(t){t(e.value)}).then(r,s)}l((n=n.apply(e,t||[])).next())})},c=(s.default.window,function(){function e(){(0,o.default)(this,e),this.handlerList={}}return(0,i.default)(e,[{key:"requestPromise",value:function(e,t,a){return this.channel?this.channel.requestPromise(e,t,a):r.default.reject("\u6ca1\u6709 worker \u901a\u4fe1\u901a\u9053.")}},{key:"request",value:function(e,t){return this.channel?this.channel.request(e,t):r.default.reject("\u6ca1\u6709 worker \u901a\u4fe1\u901a\u9053.")}},{key:"receive",value:function(e,t){return d(this,void 0,void 0,n.default.mark(function a(){var o,i;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(o=e.data,!this.hasAction(o.actionType)){a.next=8;break}return a.next=4,this.trigger(o.actionType,o.payload).catch(function(e){l.default.monitor(34094592)});case 4:i=a.sent,t(i),a.next=9;break;case 8:throw new Error(o.actionType+" \u6ca1\u6709\u5339\u914d\u7684 action \u5904\u7406\u51fd\u6570");case 9:case"end":return a.stop()}},a,this)}))}},{key:"listen",value:function(e,t){if(void 0!==this.handlerList[e])throw new Error("\u5df2\u7ecf\u6ce8\u518c\u4e86 action \u56de\u8c03, \u4e0d\u80fd\u91cd\u590d\u6ce8\u518c");this.handlerList[e]=t}},{key:"hasAction",value:function(e){return!!this.handlerList[e]}},{key:"trigger",value:function(e,t){return d(this,void 0,void 0,n.default.mark(function a(){var o;return n.default.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:if(!this.handlerList[e]){a.next=7;break}return a.next=3,this.handlerList[e](t);case 3:return o=a.sent,a.abrupt("return",o);case 7:throw new Error("action `"+e+"`\u6ca1\u6709\u6ce8\u518c\u56de\u8c03");case 8:case"end":return a.stop()}},a,this)}))}}]),e}());t.default=c},714:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(16)),o=c(a(47)),i=c(a(0)),r=c(a(1)),s=c(a(1443)),l=c(a(7)),u=c(a(12)),d=c(a(8));function c(e){return e&&e.__esModule?e:{default:e}}var h;l.default.window;!function(e){e.REQUEST="REQUEST",e.REPLY="REPLY"}(h||(h={}));var f=function(){function e(t,a){(0,i.default)(this,e),this.handlerList=[],this.channel=t,this.parent=a,this.channel.onmessage=this.onmessage.bind(this)}return(0,r.default)(e,[{key:"onmessage",value:function(e){var t=e.data;if(h.REQUEST===t.messageType){var a=this.reply.bind(this,t.sessionId);this.parent.receive(e,a)}else h.REPLY===t.messageType&&this.handlerList.forEach(function(e){return e(t)})}},{key:"reply",value:function(e,t){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";this.workerPostMessage({messageType:h.REPLY,actionType:a,payload:t,sessionId:e})}},{key:"requestPromise",value:function(e,t){var a=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3e4,i=Date.now();return new o.default(function(o,r){var s=a.getNewSessionId(),l={messageType:h.REQUEST,actionType:e,payload:t,sessionId:s},d=void 0,c=0;d=function(t){if(t.sessionId===s){a.clearListener(d),u.default.erase(c),o(t.payload);var r=Date.now()-i;r>n&&a.longTimeReport({actionType:e,postMessageTime:r,isInWorker:!1})}},a.addListener(d),a.workerPostMessage(l),c=u.default.wait(n).run(function(){u.default.erase(c),a.timeoutReport({actionType:e,isInWorker:!1})})})}},{key:"request",value:function(e,t){var a=this.getNewSessionId();this.workerPostMessage({messageType:h.REQUEST,actionType:e,payload:t,sessionId:a})}},{key:"getNewSessionId",value:function(){return(0,s.default)()}},{key:"workerPostMessage",value:function(e){this.channel.postMessage(e)}},{key:"addListener",value:function(e){this.handlerList.indexOf(e)>=0||this.handlerList.push(e)}},{key:"clearListener",value:function(e){var t=this.handlerList.indexOf(e);t>=0&&this.handlerList.splice(t,1)}},{key:"timeoutReport",value:function(e){d.default.tdwReport({opername:"tech_doc",module:"webworker",action:"channel_time_out",ver5:(0,n.default)(e)})}},{key:"longTimeReport",value:function(e){d.default.tdwReport({opername:"tech_doc",module:"webworker",action:"channel_long_time",ver5:(0,n.default)(e)})}}]),e}();t.default=f},749:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a(0)),o=v(a(1)),i=v(a(436)),r=a(97),s=v(a(1591)),l=a(137),u=a(79),d=a(17),c=v(d),h=v(a(138)),f=v(a(7)),p=v(a(8));function v(e){return e&&e.__esModule?e:{default:e}}var _=new(function(){function e(){(0,n.default)(this,e),this.addActionListener(),this.mutationQueueIdMap={}}return(0,o.default)(e,[{key:"setMutationQueueId",value:function(e,t){this.mutationQueueIdMap[t]=e,this.mutationQueueIdRelatedSheetId=t}},{key:"getMutationQueueId",value:function(e){var t=this.mutationQueueIdMap[e];return"number"===typeof t?t:-1}},{key:"addActionListener",value:function(){i.default.listen(r.MutationActionTypes.SyncActiveSheetMutations,this.syncActiveSheetMutations.bind(this)),i.default.listen(r.MutationActionTypes.SyncHistoryMutations,this.syncHistoryMutations.bind(this))}},{key:"syncActiveSheetMutations",value:function(e){var t=this;if(!s.default.isSheetDataReady)return!1;var a=e.sheetId,n=e.serializedMutations,o=e.mutationQueueId;this.setMutationQueueId(o,a);var i=s.default.spreadsheet.getSheetBySheetId(a);if(!i)return p.default.monitor(34467196),f.default.window.log&&f.default.window.log.error&&f.default.window.log.error("WorkerSheetStatusError","worker\u4e2d\u4e0d\u5b58\u5728"+a+"\u5b50\u8868"),!1;if(i.isFetching)return n.forEach(function(e){t.setLocalMutationCache(a,e)}),!1;if(!i.isLoaded)return!1;var r=!1,u=[];return n.forEach(function(e){var t=(0,l.createMutationFromSerialize)(e);if(!t)return!1;u.push(t),t.id===c.default.MAP_RANGE_MUTATION&&(r=!0)}),r&&s.default.calcController.markRowColMove(),u.forEach(function(e,a){try{t.muationQueueRunnedIndex=a,e.run(i,{isLocal:!0})}catch(n){}}),!0}},{key:"syncHistoryMutations",value:function(e){if(!s.default.isSheetDataReady)return!1;var t=e.sheetId,a=e.serializedMutations,n=s.default.spreadsheet.getSheetBySheetId(t);return!!n&&(a.forEach(function(e){var t=(0,l.createMutationFromSerialize)(e);if(!t)return!1;try{t.operationType=h.default.HISTORY,t.run(n,{isLocal:!0,ignoreCheck:-1===d.NOT_IGNORE_CHECK_MUTATIONS.indexOf(t.id)})}catch(a){}}),!0)}},{key:"syncNonPersistentMutationsToMainThread",value:function(e){var t=e.mutations,a=e.isFromFormula,n=e.mutationQueueIdRelatedSheetId,o=e.isFinalMutationToCurrentMutationQueueFromFormula,s=t.map(function(e){return(0,u.serializeMutation)(e)});return i.default.requestPromise(r.MutationActionTypes.SyncNonPersistentMutationsToMainThread,{serializedMutations:s,isFromFormula:a,latestMutationQueueIdInWorker:this.getMutationQueueId(n),mutationQueueIdRelatedSheetId:n,isFinalMutationToCurrentMutationQueueFromFormula:o,muationQueueRunnedIndex:this.muationQueueRunnedIndex})}},{key:"syncMutationWhichChangeFormulaModelToMainThread",value:function(e){var t=e.mutation,a=e.sheetId,n=(0,u.serializeMutation)(t);return i.default.requestPromise(r.MutationActionTypes.SyncMutationWhichChangeFormulaModelToMainThread,{serializedMutation:n,sheetId:a})}},{key:"setMutationCache",value:function(e,t){s.default.setMutationCache(e,t)}},{key:"setLocalMutationCache",value:function(e,t){s.default.setLocalMutationCache(e,t)}}]),e}());t.default=_},751:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=h(a(3)),o=h(a(0)),i=h(a(1)),r=h(a(4)),s=h(a(5));t.showToast=_,t.hideToast=E,t.changeToastText=function(e){_(e)};var l=a(46),u=h(l),d=a(123),c=h(a(1608));function h(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.state={show:!1,options:null,hideFunc:null,type:"TOAST"},a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"componentDidMount",value:function(){this.props.mountCallback&&this.props.mountCallback(this)}},{key:"isShow",value:function(){return this.state.show}},{key:"show",value:function(e,t){this.setState({show:!0,options:e,hideFunc:t})}},{key:"hide",value:function(){this.setState({show:!1})}},{key:"render",value:function(){return this.state.show?u.default.createElement(c.default,this.state):null}}]),t}(l.Component),p=!1,v=null;function _(e,t,a,n){console.log(v),a&&!a.toolToastCloseTime&&(a.manualClose=!0);var o,i={messageContent:e,cssParam:t||{},extendParam:a};v?(E(),v.show(i,E)):(n?o=n:(!p&&$("body").append("<div id='toastContainer'></div>"),p=!0,o=document.getElementById("toastContainer")),(0,d.render)(u.default.createElement(f,{ref:function(e){v=e},mountCallback:function(e){e&&e.show(i,E)}}),o))}function E(){v&&v.hide()}},752:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.UserChangeStatus=void 0;var n,o=c(a(16)),i=c(a(0)),r=c(a(1)),s=a(79),l=a(137),u=c(a(8)),d=a(26);function c(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.WATING=0]="WATING",e[e.COMMITING=1]="COMMITING",e[e.ACCEPT=2]="ACCEPT"}(n||(t.UserChangeStatus=n={}));var h=function(){function e(t,a){var o=this;(0,i.default)(this,e),this.head=!1,this.status=n.WATING,this.taskId=0,this.isOfflineMessage=!1,this.allowAutoMerge=!1,this.commitTimes=0,this.app=t,this.baseVersion=a&&a.baseVersion||t.messageCenter.currentVersion,this.sheetId=a&&a.sheetId||t.spreadsheet.activeSheet.getSheetId(),this.mutations=[],a&&a.data&&(a.data.mutations&&a.data.mutations.forEach(function(e){if(e&&Array.isArray(e)){var t=[];e.forEach(function(e){var a=(0,l.createMutationFromSerialize)(e);a&&t.push(a)}),o.mutations.push(t)}else u.default.run(d.CONFIG.INIT_DATA_ERROR,[a.data.mutations])}),this.changeData=a.data.changedata||a.data.changeData||null,this.head=a.data.head||!1,this.originSheetId=a.data.oSubId||null,this.taskId=a.data.taskId||0),this.isOfflineMessage=a&&a.isOfflineMessage||!1,this.allowAutoMerge=a&&a.allowAutoMerge||!1,this.time=a&&a.time||(new Date).getTime(),this.workbook=a&&a.workbook||t.messageCenter.getWorkBookInfo()||"",this.status=a&&a.status||n.WATING}return(0,r.default)(e,[{key:"apply",value:function(){var e=this;this.mutations&&this.mutations.length>0&&this.mutations.forEach(function(t){t.forEach(function(t){e.app.behavior.applyMutation(t,{isLocal:!1})})}),this.changeData&&this.changeData.forEach(function(t){if("revert"===t.type)e.app.revertSpreadSheet();else if("ms"===t.type){var a=t.d;e.app.applySheetsChanges(a)}})}},{key:"isMutationChange",value:function(){return!this.changeData}},{key:"setChangeData",value:function(e){this.changeData=e}},{key:"setOrAppendMutations",value:function(e){this.mutations.push(e)}},{key:"setKeyData",value:function(e){this.keyData=e}},{key:"isWithKeyData",value:function(){return!!this.keyData}},{key:"prepareCommitMessage",value:function(){var e={type:"USER_CHANGES",baseRev:this.baseVersion,changeset:this.jsonData||"[]",keydata:this.keyData||!1,head:this.head,subId:this.sheetId,oSubId:this.originSheetId||!1,uuId:this.app.data.uuid,changeSetCount:this.requestCount,offlineMsg:this.isOfflineMessage,pver:1};return e.changeset=e.changeset+"\n",e.keydata&&(e.keydata=e.keydata+"\n"),(0,o.default)(e)}},{key:"prepareMessageForReport",value:function(){var e={type:"USER_CHANGES",baseRev:this.baseVersion,changeset:this.jsonData||"[]",keydata:this.keyData||!1,head:this.head,subId:this.sheetId,oSubId:this.originSheetId||!1,uuId:this.app.data.uuid,changeSetCount:this.requestCount,offlineMsg:this.isOfflineMessage,pver:1};return e.changesetLength=e.changeset.length,e.keydataLength=e.keydata?e.keydata.length:0,e.changeset=e.changeset.substr(0,100),e.keydata=!!e.keydata,e}},{key:"requestCount",get:function(){return this.isMutationChange()?this.mutations&&this.mutations.length||0:1}},{key:"jsonData",get:function(){if(this.changeData)return(0,o.default)(this.changeData);var e=[];return this.mutations&&this.mutations.forEach(function(t){var a=[];t.forEach(function(e){var t=(0,s.serializeMutation)(e);a.push(t)}),e.push(a)}),(0,o.default)(e)}},{key:"storeData",get:function(){var e=this,t=new Object;t.baseVersion=this.baseVersion,t.sheetId=this.sheetId;var a,n=[];this.mutations&&this.mutations.forEach(function(t){var a=[];t.forEach(function(t){var n=(0,s.serializeMutation)(t);n?a.push(n):u.default.run(d.CONFIG.STORE_DATA_ERROR,[e.mutations])}),n.push(a)});var o=this.changeData||null;return a={type:"USER_CHANGES",taskId:this.taskId,baseRev:this.baseVersion,mutations:n,changeData:o,head:this.head,subId:this.sheetId,oSubId:this.originSheetId||!1,uuId:this.app.data.uuid,pver:1},t.isOfflineMessage=!0,t.data=a,t.time=this.time,t.workbook=this.workbook,t.status=this.status,t}},{key:"isEmpty",get:function(){return(!this.mutations||0===this.mutations.length)&&!this.changeData}},{key:"key",get:function(){return this.app.messageCenter.getWorkBookInfo()+"_"+this.sheetId+"_"+this.time}}],[{key:"compare",value:function(e,t){return e.time-t.time}}]),e}();t.default=h,t.UserChangeStatus=n},753:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(0)),o=l(a(1)),i=l(a(712)),r=l(a(12)),s=l(a(8));function l(e){return e&&e.__esModule?e:{default:e}}var u=new i.default("defaultWorker"),d=function(){function e(t){(0,n.default)(this,e),this.isHeartBeatTesting=!1,this.heartBeatNow=0,this.timeOutHeartBeat=[],this.interValDuration=5e3,this.timeOutDuration=3e4,console.log(5),this.mainThreadWorker=t}return(0,o.default)(e,[{key:"start",value:function(){var e=this;this.interVal=setInterval(function(){e.checkHeartBeat()},this.interValDuration)}},{key:"stop",value:function(){clearInterval(this.interVal)}},{key:"checkHeartBeat",value:function(){var e=this;if(!0!==this.isHeartBeatTesting){this.isHeartBeatTesting=!0,this.heartBeatNow+=1;var t=Date.now();this.mainThreadWorker.workerAbilityTest.heartBeatTest(this.heartBeatNow).then(function(){e.isHeartBeatTesting=!1,r.default.erase(e.timeOut);var a=Date.now()-t;e.durationReport(a)}),this.timeOut=r.default.wait(this.timeOutDuration).run(function(){e.isHeartBeatTesting=!1,r.default.erase(e.timeOut),e.timeOutHeartBeat.push(e.heartBeatNow),e.checkStatus()})}}},{key:"checkStatus",value:function(){var e=this.timeOutHeartBeat.length;e>=2&&this.timeOutHeartBeat[e-2]+1===this.timeOutHeartBeat[e-1]&&(this.stop(),this.deadReport())}},{key:"durationReport",value:function(e){e>3e4&&(s.default.monitor(33969412),s.default.tdwReport({opername:"tech_doc",module:"webworker",action:"worker_heartbeat_duration",ver5:e}))}},{key:"deadReport",value:function(){s.default.monitor(33969414),s.default.tdwReport({opername:"tech_doc",module:"webworker",action:"worker_heartbeat_dead",ver5:this.timeOutHeartBeat[this.checkHeartBeat.length-1]})}}]),e}();if(u.mainThreadController.isSupportWorker){var c=void 0;u.workerAbilityTest.runTest().then(function(e){u.timeWorkerReplyMessage=Date.now(),r.default.erase(c),u.reportWorkerStatus()}).catch(function(e){console.log("worker error:",e)}),c=r.default.wait(3e4).run(function(){u.reportWorkerStatus()}),r.default.wait(1e4).run(function(){new d(u).start()})}else u.reportWorkerStatus();t.default=u},756:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.reportError=function(e){(0,n.dataFlowReport)({level:n.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"dataErrorTip",ver5Value:e})},t.reportWarn=function(e){(0,n.dataFlowReport)({level:n.DataFlowLogLevel.IMPORTANT,moduleValue:"messageCenter",actionValue:"reloadTip",ver5Value:e})};var n=a(398)},760:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DATE_OPERATE_MAP=t.TEXT_OPERATE_MAP=t.NUMBER_OPERATE_MAP=t.NUMBER_DATA_TYPE_MAP=void 0;var n=l(a(63));t.isFormulaString=u,t.isFormulaAndError=d,t.getErrorMessage=function(e,t){var a=(0,o.getUIDVAtPosition)(e,t);if(!a)return null;var n=a.validType,r=a.dataType,s=a.operator,l=a.argTokens,u=l&&l[0]&&l[0].userEnteredValue,d=l&&l[1]&&l[1].userEnteredValue,c={dataType:r||null,operate:s||null,inputOne:u||null,inputTwo:d||null};switch(n){case i.VALID_TYPE.LIST:return E();case i.VALID_TYPE.NUMBER:return p(c);case i.VALID_TYPE.TEXT:return _(c);case i.VALID_TYPE.DATE:return g(c);case i.VALID_TYPE.AVAILABLE:return T();default:return null}},t.isLeagalNumber=function(e){if(c(e))return!0;return!1},t.stringToNumber=c,t.compareMaxMinError=function(e,t,a){var n=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).fractionFirst,o=void 0!==n&&n,i=e.inputOne,r=e.inputTwo,l=e.operate;if(!e.inputTwoShow)return null;if(l!==s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&l!==s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)return null;if(""===i.trim()||""===r.trim())return null;if(u(i)||u(r))return null;var d=c(i,{fractionFirst:o}),h=c(r,{fractionFirst:o});if(!d||!h)return null;var f=d.numericValue,p=h.numericValue;if("number"!==typeof f||"number"!==typeof p)return null;if(p-f<0)return 1===t?{inputOneIsError:!0,inputOneErrorTip:"\u8bf7\u8f93\u5165\u5c0f\u4e8e\u6700\u5927\u503c\u7684"+a,inputTwoIsError:!1}:{inputOneIsError:!1,inputTwoIsError:!0,inputTwoErrorTip:"\u8bf7\u8f93\u5165\u5927\u4e8e\u6700\u5c0f\u503c\u7684"+a};return null},t.getNumberErrorMessage=p,t.getTextErrorMessage=_,t.getListErrormessage=E,t.getAvailableErrorMessage=T,t.getDateErrorMessage=g;var o=a(98),i=a(310),r=a(57),s=l(a(89));function l(e){return e&&e.__esModule?e:{default:e}}function u(e){return!!(e&&"="===e.slice(0,1)&&e.length>1)}function d(e){return!!u(e)&&!(0,o.isLegalFormula)(e)}function c(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).fractionFirst,a=void 0!==t&&t;return(0,r.parseNumber)(e,{})||(0,r.parsePercentage)(e,{})||(0,r.parseCurrency)(e,{})||(0,r.parseExponential)(e,{})||(0,r.parseThousandNumber)(e,{})||(0,r.parseFractionValue)(e,a?{numberFormat:"fraction"}:{})||(0,r.parseDateTimeValue)(e,{})}var h=t.NUMBER_DATA_TYPE_MAP=new n.default([[i.DATA_TYPE.NONE,"\u6570\u503c"],[i.DATA_TYPE.INT,"\u6574\u6570"],[i.DATA_TYPE.FLOAT,"\u5c0f\u6570"]]),f=t.NUMBER_OPERATE_MAP=new n.default([[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,"\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,"\u4e0d\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.EQUAL,"\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,"\u4e0d\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS,"\u5c0f\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,"\u5c0f\u4e8e\u6216\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT,"\u5927\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,"\u5927\u4e8e\u6216\u7b49\u4e8e"]]);function p(e){var t=e.dataType,a=e.operate,n=e.inputOne,o=e.inputTwo,i="\u65e0\u6548\u7684\u8f93\u5165";return a&&t?(o=o||" ",d(n=n||" ")||d(o)?"\u6821\u9a8c\u6761\u4ef6\u4e2d\u5b58\u5728\u975e\u6cd5\u516c\u5f0f":i=a===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||a===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u4f60\u8f93\u5165\u7684\u4e0d\u662f"+f.get(a)+n+"\u548c"+o+"\u4e4b\u95f4\u7684"+h.get(t)+"\u3002":"\u4f60\u8f93\u5165\u7684\u4e0d\u662f"+f.get(a)+n+"\u7684"+h.get(t)+"\u3002"):i}var v=t.TEXT_OPERATE_MAP=new n.default([[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,"\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,"\u4e0d\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.EQUAL,"\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,"\u4e0d\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS,"\u5c0f\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,"\u5c0f\u4e8e\u6216\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT,"\u5927\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,"\u5927\u4e8e\u6216\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,"\u5305\u62ec"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_INCLUDE,"\u4e0d\u5305\u62ec"]]);function _(e){var t=e.dataType,a=e.operate,n=e.inputOne,o=e.inputTwo,r="\u65e0\u6548\u7684\u8f93\u5165";return a&&t?(o=o||" ",d(n=n||" ")||d(o)?"\u6821\u9a8c\u6761\u4ef6\u4e2d\u5b58\u5728\u975e\u6cd5\u516c\u5f0f":r=t===i.DATA_TYPE.CONTENT?"\u4f60\u8f93\u5165\u7684\u4e0d\u662f\u5185\u5bb9"+v.get(a)+n+"\u7684\u6587\u672c\u3002":a===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||a===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u4f60\u8f93\u5165\u7684\u4e0d\u662f\u957f\u5ea6"+v.get(a)+n+"\u548c"+o+"\u4e4b\u95f4\u7684\u6587\u672c\u3002":"\u4f60\u8f93\u5165\u7684\u4e0d\u662f\u957f\u5ea6"+v.get(a)+n+"\u7684\u6587\u672c\u3002"):r}function E(){return"\u4f60\u9009\u62e9\u7684\u4e0d\u662f\u4e0b\u62c9\u5217\u8868\u4e2d\u7684\u9009\u9879\u3002"}function T(){return"\u4f60\u8f93\u5165\u7684\u4e0d\u662f\u4e00\u4e2a\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u3002"}var m=t.DATE_OPERATE_MAP=new n.default([[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,"\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN,"\u4e0d\u4ecb\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.EQUAL,"\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL,"\u4e0d\u7b49\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS,"\u65e9\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL,"\u4e0d\u665a\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT,"\u665a\u4e8e"],[s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL,"\u4e0d\u65e9\u4e8e"]]);function g(e){var t=e.operate,a=e.inputOne,n=e.inputTwo,o="\u65e0\u6548\u7684\u8f93\u5165";return t?(n=n||" ",d(a=a||" ")||d(n)?"\u6821\u9a8c\u6761\u4ef6\u4e2d\u5b58\u5728\u975e\u6cd5\u516c\u5f0f":o=t===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||t===s.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u4f60\u8f93\u5165\u7684\u4e0d\u662f"+m.get(t)+a+"\u548c"+n+"\u4e4b\u95f4\u7684\u65e5\u671f\u3002":"\u4f60\u8f93\u5165\u7684\u4e0d\u662f"+m.get(t)+a+"\u7684\u65e5\u671f\u3002"):o}},764:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.LIST_TRIGGER_BY=void 0;!function(e){e[e.CLICK_HEADER=1]="CLICK_HEADER",e[e.ENTER_EDIT=2]="ENTER_EDIT"}(n||(t.LIST_TRIGGER_BY=n={}))},765:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=_(a(3)),o=_(a(0)),i=_(a(1)),r=_(a(4)),s=_(a(5)),l=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}(a(46)),u=_(a(1639)),d=_(a(40)),c=_(a(7)),h=a(22),f=a(441),p=a(82),v=_(a(198));function _(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,o.default)(this,t);var a=(0,r.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));return a.sheetBox=l.createRef(),a}return(0,s.default)(t,e),(0,i.default)(t,[{key:"mouseup",value:function(e){e.pageX!==this.startX&&this.props.mouseUpCallback(e,this.props.index)}},{key:"mousedown",value:function(e){var t=this;if(0===e.button||1===e.bitton)this.props.mouseDownCallback(this.props.index,e.pageX),this.click(e);else{var a=d.default.sheetsBar;this.props.renameSheetId!==this.props.id&&(a.one("switchSheetEnd",function(){t.showMenu(e)}),this.props.activeSheetId===this.props.id&&this.showMenu(e),this.props.updateIndex(this.props.index),this.click(e))}}},{key:"keyPress",value:function(e){var t=this,a=e.nativeEvent,n=c.default.event.sheetsBar;if(e&&"Enter"===e.key)this.click(e);else if(a&&a.altKey&&(174===a.keyCode||114===a.keyCode))n.trigger("startReName",this.props.id);else if(a&&a.altKey&&(8706===a.keyCode||100===a.keyCode)){var o=(0,f.getDelMessage)(this.props.id,c.default.clientVars.isCreator),i=o.isRelated,r=o.message;if(!1===r)return;var s=function(){n.trigger("deleteSheet",t.props.id)},l=this.props.app;v.default.dialog.dialog.delSheet(function(){i?l.plugins.rmap&&l.plugins.rmap.handle("cancel_form_sheetbar",t.props.id,s):s()},r)}}},{key:"click",value:function(e){e.preventDefault(),e.stopPropagation(),console.log("---click switch sheet----");var t=c.default.event.sheetsBar;void 0!==this.props.activeSheetId&&void 0!==this.props.id&&this.props.activeSheetId!==this.props.id&&(t.trigger("switchSheet",this.props.id,this.props.activeSheetId,{isThreeDimensionClick:e.shiftKey}),h.isMobile&&c.default.event.default.trigger(p.EVENT_NAME.UI_SHOW,"switch-sheet"),this.startX=e.pageX)}},{key:"contextMenu",value:function(e){e.preventDefault(),e.stopPropagation()}},{key:"showMenu",value:function(e){if(e&&e.target&&(!0!==this.props.readonly&&this.props.app.spreadsheet.getActiveSheetId()===this.props.id)){var t=e.target;t&&-1!==(t.className+"").indexOf("sheet-box")||(t=t.parentNode),t&&-1!==(t.className+"").indexOf("meun-iconbox")&&(t=t.parentNode),d.default.sheetsBar.trigger("showMenu",t,this.props.id)}}},{key:"hideMenu",value:function(e){d.default.sheetsBar.trigger("hideMenu")}},{key:"readonlyChange",value:function(){}},{key:"getLabel",value:function(){var e=this.props.app,t=this.props.name,a="Alt";return h.isMac&&(a="Option"),e?""+t+(e.spreadsheet.getSheets().length>1?a+"+D\u5220\u9664sheet "+a+"+r\u91cd\u547d\u540dsheet":a+"+r\u91cd\u547d\u540dsheet"):t}},{key:"render",value:function(){var e=this.props.activeSheetId===this.props.id?"sheet-focus":"sheet-blur",t="";"undefined"!==typeof this.props.moveIndex&&this.props.isMoveingStatus&&"undefined"!==typeof this.props.moveOrginIndex&&(t=this.props.moveIndex>this.props.moveOrginIndex?this.props.index===this.props.moveIndex?" sheet-tab-placeItem":"":this.props.index===this.props.moveIndex-1?" sheet-tab-placeItem":"");var a=this.props.isMoveingStatus&&this.props.activeSheetId===this.props.id?" sheet-moving":"",n=this.props.isMoving?10004:0,o=this.props.width,i=this.props.left;return l.createElement("div",{className:"sheet-box sheet "+e+t+a,ref:this.sheetBox,style:{zIndex:n,left:i,width:o,display:this.props.hidden?"none":"block"},"data-id":this.props.id,"aria-label":this.props.name,role:"button",tabIndex:4,onMouseUp:this.mouseup.bind(this),onContextMenu:this.contextMenu.bind(this),onKeyPress:this.keyPress.bind(this),onMouseDown:this.mousedown.bind(this)},this.props.bindForm?l.createElement("div",{className:"coreFormIcon"}):null,l.createElement(u.default,{"aria-label":"\u4fee\u6539\u5b50\u8868:"+this.props.name+"\u540d\u79f0",tabIndex:4,readonly:this.props.readonly,index:this.props.index,id:this.props.id,renameSheetId:this.props.renameSheetId,val:this.props.name,inputWidth:this.props.inputWidth,renameCallback:this.props.renameCallback}),this.props.readonly?null:l.createElement("div",{onMouseDown:this.showMenu.bind(this),className:"meun-iconbox"}," ",l.createElement("div",{className:"menu-icon"})))}}]),t}(l.Component);t.default=E},766:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getHeaderHeight=o,t.getEditorTop=function(){var e=document.getElementById("padpage"),t=n.isPad?o():0;return e?e.getBoundingClientRect().top+t:t},t.getCanvasTop=function(){var e=document.getElementById("padeditor"),t=n.isPad?o():0;return e?e.getBoundingClientRect().top+t:t},t.getEditorBottom=function(){return n.isMobile||n.isPad?$("#mobile-sheetbox").outerHeight()||0:$(".tsSheetbox").outerHeight()||0};var n=a(22);function o(){return $("header").outerHeight()||54}},767:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=i(a(0)),o=i(a(1));function i(e){return e&&e.__esModule?e:{default:e}}t.optimizedResize=function(e){r.addCallback(e)},t.stopSpringBack=function(e){if(!e||!e.tagName)return;var t=0;e.addEventListener("touchstart",function(e){t=e.changedTouches[0].pageY}),e.addEventListener("touchmove",function(a){var n=e.offsetHeight,o=e.scrollTop,i=e.scrollHeight,r=a.changedTouches[0].pageY,s=r-t<0,l=r-t>0,u=l&&o<=0||s&&n+o>=i;u&&a.preventDefault()})};var r=new(function(){function e(){(0,n.default)(this,e),this.callbacks=[],this.running=!1,window.addEventListener("resize",this.resize.bind(this))}return(0,o.default)(e,[{key:"resize",value:function(){this.running||(this.running=!0,window.requestAnimationFrame?window.requestAnimationFrame(this.runCallbacks.bind(this)):setTimeout(this.runCallbacks.bind(this),66))}},{key:"runCallbacks",value:function(){this.callbacks.forEach(function(e){e()}),this.running=!1}},{key:"addCallback",value:function(e){e&&this.callbacks.push(e)}}]),e}())},769:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.fontFamilyConfigDataWin=[["Microsoft YaHei","\u5fae\u8f6f\u96c5\u9ed1"],["SimSun","\u5b8b\u4f53"],["SimHei","\u9ed1\u4f53"],["FangSong","\u4eff\u5b8b"],["KaiTi","\u6977\u4f53"],["DFKai-SB","\u6807\u6977\u4f53"],["STFangsong","\u534e\u6587\u4eff\u5b8b"],["STKaiti","\u534e\u6587\u6977\u4f53"],["STSong","\u534e\u6587\u5b8b\u4f53"],["NSimSun","\u65b0\u5b8b\u4f53"],["Microsoft JhengHei","\u5fae\u8f6f\u6b63\u9ed1\u4f53"],["PMingLiU","\u65b0\u7ec6\u660e\u4f53"],"Arial","Times New Roman","Times New Roman Special","Calibri","Comic Sans MS","Courier New","Georgia","Microsoft Uighur","Impact","Trebuchet MS","Verdana","Abadi MT Condensed","Agency FB","Aharoni","Aldhabi","Algerian","Almanac MT","American Uncial","Andale Mono","Andalus","Andy","AngsanaUPC","Angsana New","Aparajita","Arabic Transparent","Arabic Typesetting","Arial Black","Arial Narrow","Arial Narrow Special","Arial Rounded MT","Arial Special","Arial Unicode MS","Augsburger Initials","Baskerville Old Face","Batang","BatangChe","Bauhaus","Beesknees ITC","Bell MT","Berlin Sans FB","Bernard MT Condensed","Bickley Script","Blackadder ITC","Bodoni MT","Bodoni MT Condensed","Bon Apetit MT","Bookman Old Style","Bookshelf Symbol","Book Antiqua","Bradley Hand ITC","Braggadocio","BriemScript","Britannic Bold","Broadway","BrowalliaUPC","Browallia New","Brush Script MT","Californian FB","Calisto MT","Cambria","Cambria Math","Candara","Cariadings","Castellar","Centaur","Century","Century Gothic","Century Schoolbook","Chiller","Colonna MT","Consolas","Constantia","Contemporary Brush","Cooper Black","Copperplate Gothic","Corbel","CordiaUPC","Cordia New","Curlz MT","DaunPenh","David","Desdemona","DilleniaUPC","Directions MT","DokChampa","Dotum","DotumChe","Ebrima","Eckmann","Edda","Edwardian Script ITC","Elephant","Engravers MT","Enviro","Eras ITC","Estrangelo Edessa","EucrosiaUPC","Euphemia","Eurostile","Felix Titling","Fine Hand","Fixed Miriam Transparent","Flexure","Footlight MT","Forte","Franklin Gothic","Franklin Gothic Medium","FrankRuehl","FreesiaUPC","Freestyle Script","French Script MT","Futura","Gabriola","Gadugi","Garamond","Garamond MT","Georgia Ref","Gigi","Gill Sans MT","Gill Sans MT Condensed","Gisha","Gloucester","Goudy Old Style","Goudy Stout","Gradl","Gulim","GulimChe","Gungsuh","GungsuhChe","Haettenschweiler","Harlow Solid Italic","Harrington","High Tower Text","Holidays MT","Imprint MT Shadow","Informal Roman","IrisUPC","Iskoola Pota","JasmineUPC","Jokerman","Juice ITC","Kalinga","Kartika","Keystrokes MT","Khmer UI","Kino MT","KodchiangUPC","Kokila","Kristen ITC","Kunstler Script","Lao UI","Latha","LCD","Leelawadee","Levenim MT","LilyUPC","Lucida Blackletter","Lucida Bright","Lucida Bright Math","Lucida Calligraphy","Lucida Console","Lucida Fax","Lucida Handwriting","Lucida Sans","Lucida Sans Typewriter","Lucida Sans Unicode","Magneto","Maiandra GD","Malgun Gothic","Malgun Gothic Semilight","Mangal","Map Symbols","Marlett","Matisse ITC","Matura MT Script Capitals","McZee","Mead Bold","Meiryo","Meiryo UI","Mercurius Script MT Bold","Microsoft Himalaya","Microsoft JhengHei UI","Microsoft JhengHei UI Light","Microsoft New Tai Lue","Microsoft PhagsPa","Microsoft Sans Serif","Microsoft Tai Le","Microsoft YaHei UI","Microsoft YaHei UI Light","Microsoft Yi Baiti","MingLiU-ExtB","MingLiU_HKSCS-ExtB","MingLiU_HKSCS","Miriam","Miriam Fixed","Mistral","Minion Web","Modern No.","Mongolian Baiti","Monotype.com","Monotype Corsiva","Monotype Sorts","MoolBoran","MS Gothic","MS LineDraw","MS Mincho","MS Outlook","MS PGothic","MS PMincho","MS Reference","MS UI Gothic","MT Extra","MV Boli","Myanmar Text","Narkisim","News Gothic MT","New Caledonia","Niagara","Nirmala UI","Nyala","OCR-B-Digits","OCRB","OCR A Extended","Old English Text MT","Onyx","Palace Script MT","Palatino Linotype","Papyrus","Parade","Parchment","Parties MT","Peignot Medium","Pepita MT","Perpetua","Perpetua Titling MT","Placard Condensed","Plantagenet Cherokee","Playbill","PMingLiU-ExtB","Poor Richard","Pristina","Raavi","Rage Italic","Ransom","Ravie","RefSpecialty","Rockwell","Rockwell Condensed","Rockwell Extra Bold","Rod","Runic MT Condensed","Sakkal Majalla","Script MT Bold","Segoe Chess","Segoe Print","Segoe Pseudo","Segoe Script","Segoe UI Symbol","Shonar Bangla","Showcard Gothic","Shruti","Signs MT","Simplified Arabic Fixed","Snap ITC","Sports MT","Stencil","Stop","Sylfaen","Symbol","Tahoma","Tempo Grunge","Tempus Sans ITC","Temp Installer Font","Traditional Arabic","Transport MT","Tunga","Tw Cen MT","Tw Cen MT Condensed","Urdu Typesetting","Utsaah","Vacation MT","Vani","Verdana Ref","Vijaya","Viner Hand ITC","Vivaldi","Vixar ASCI","Vladimir Script","Vrinda","Webdings","Westminster","Wide Latin","Wingdings","Yu Gothic","Yu Gothic Light","Yu Gothic Medium","Yu Gothic UI","Yu Gothic UI Light","Yu Gothic UI Semibold","Yu Gothic UI Semilight"],t.fontFamilyConfigDataMac=[["Microsoft YaHei","\u5fae\u8f6f\u96c5\u9ed1"],["SimSun","\u5b8b\u4f53"],["SimHei","\u9ed1\u4f53","PingFang SC"],["Hiragino Sans GB","\u51ac\u9752\u9ed1\u7b80\u4f53\u4e2d\u6587"],["PingFang SC","\u82f9\u65b9"],["STSong","\u534e\u6587\u5b8b\u4f53"],["STFangsong","\u534e\u6587\u4eff\u5b8b"],["STKaiti","\u534e\u6587\u6977\u4f53"],"Arial","Times New Roman","Calibri","Comic Sans MS","Courier New","Georgia","Microsoft Uighur","Impact","Trebuchet MS","Verdana","Al Bayan","Al Nile","Al Tarikh","American Typewriter","Andale Mono","Arial Black","Arial Hebrew","Arial Hebrew Scholar","Arial Narrow","Arial Rounded MT Bold","Arial Unicode MS","Athelas","Avenir","Avenir Next","Avenir Next Condensed","Ayuthaya","Baghdad","Bangla MN","Bangla Sangam MN","Baskerville","Beirut","Big Caslon","Bodoni","Bodoni 72 Oldstyle","Bodoni 72 Smallcaps","Bodoni Ornaments","Bradley Hand","Brush Script MT","Chalkboard","Chalkboard SE","Chalkduster","Charter","Cochin","Copperplate","Corsiva Hebrew","Courier","Damascus","DecoType Naskh","Devanagari MT","Devanagari Sangam MN","Didot","DIN Alternate","DIN Condensed","Diwan Kufi","Diwan Thuluth","Euphemia UCAS","Farah","Farisi","Futura","GB18030 Bitmap","Geeza Pro","Geneva","Gill Sans","Gujarati MT","Gujarati Sangam MN","Gurmukhi MN","Gurmukhi MT","Gurmukhi Sangam MN","Hei","Helvetica","Helvetica Neue","Herculanum","Hiragino Kaku Gothic Pro","Hiragino Kaku Gothic ProN","Hiragino Kaku Gothic Std","Hiragino Kaku Gothic StdN","Hiragino Maru Gothic Pro","Hiragino Maru Gothic ProN","Hiragino Mincho Pro","Hiragino Mincho ProN","Hiragino Sans","Hoefler Text","InaiMathi","Iowan Old Style","ITF Devanagari","ITF Devanagari Marathi","Kai","Kailasa","Kannada MN","Kannada Sangam MN","Kefa","Khmer MN","Khmer Sangam MN","Kohinoor Bangla","Kohinoor Devanagari","Kohinoor Telugu","Kokonor","Krungthep","KufiStandardGK","Lao MN","Lao Sangam MN","Lucida Grande","Luminari","Malayalam MN","Malayalam Sangam MN","Marion","Marker Felt","Menlo","Microsoft Sans Serif","Mishafi","Mishafi Gold","Monaco","Mshtakan","Muna","Myanmar MN","Myanmar Sangam MN","Nadeem","New Peninim MT","Noteworthy","Noto Nastaliq Urdu","Optima","Oriya MN","Oriya Sangam MN","Palatino","Papyrus","Phosphate","Plantagenet Cherokee","PT Mono","PT Sans","PT Sans Caption","PT Sans Narrow","PT Serif","PT Serif Caption","Raanana","Sana","Sathu","Savoye LET","Seravek","Shree Devanagari","SignPainter","Silom","Sinhala MN","Sinhala Sangam MN","Skia","Snell Roundhand","STIXGeneral","STIXIntegralsD","STIXIntegralsSm","STIXIntegralsUp","STIXIntegralsUpD","STIXIntegralsUpSm","STIXNonUnicode","STIXSizeFiveSym","STIXSizeFourSym","STIXSizeOneSym","STIXSizeThreeSym","STIXSizeTwoSym","STIXVariants","Sukhumvit Set","Superclarendon","Symbol","Tahoma","Tamil MN","Tamil Sangam MN","Telugu MN","Telugu Sangam MN","Thonburi","Times","Trattatello","Waseem","Webdings","Wingdings","Zapf Dingbats","Zapfino","Apple Braille","Apple Chancery","Apple Color Emoji","Apple SD Gothic Neo","Apple Symbols","AppleGothic","AppleMyungjo"],t.fontFamilyConfigDataPad=[["Microsoft YaHei","\u5fae\u8f6f\u96c5\u9ed1"],"Times New Roman","Courier New","Futrua","Papyrus","Rockwell","Trebuchet MS","Verdana"]},774:function(e,t,a){var n=a(1619);"string"===typeof n&&(n=[[e.i,n,""]]);var o={hmr:!0,transform:void 0,insertInto:void 0};a(37)(n,o);n.locals&&(e.exports=n.locals)},775:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.ARROW_UP_KEYCODE=38,t.ARROW_DOWN_KEYCODE=40,t.ESCAPE=27,t.ENTER=13},776:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(9),i=(n=o)&&n.__esModule?n:{default:n};t.addUp=function(e,t,a){var n=a.activeSheet,o=e.getRange(),c=e.criteriaMap,h=o.startRowIndex+1,f=o.endRowIndex,p=[],v={},_=[];if(h>=f)return{resultList:_,currentColValue:v};d(n,t,h,f,function(e,t){v[t]=e,p.push(e)});var E=e.getHiddenRows(),T=(0,l.arrToObjectKey)(E),m=p.reduce(function(e,t,a){var n=a+h;return 1===T[n]?e:(e[t]?e[t]+=1:e[t]=1,e)},{}),g={},S={};c.forEach(function(e,a){var o=e.getHiddenValues(),i=e.getVisibleValues(),s=((0,r.obj2Arr)(v),d(n,a,h,f)),c=(0,r.unique)(s);i&&i.length?o=(0,r.diff)(c,i):i=(0,r.diff)(c,o);for(var p=(0,l.arrToObjectKey)(o),_=h;_<=f;_++){var E=u(n,_,a);1!==p[E]&&1!==p[E.trim()]||(a===t?g[_]=!0:S[_]||(S[_]=!0))}});var R=[];(0,i.default)(g).forEach(function(e){if(!S[e]){var t=v[e];R.push(t)}});var A=(0,r.unique)(R),w=(0,l.arrToObjectKey)(A);(0,i.default)(m).forEach(function(e){1!==w[e]&&_.push({key:e,count:m[e],visible:!0})});var I=!1;return A.forEach(function(e){if(null===e||void 0===e||(0,r.isEmptyValue)(e)){if(I)return;I=!0,e=s.EMPTY_KEY_VALUE}e.replace&&(e=e.replace(/\ufeff/g,"")),_.push({key:e,count:0,visible:!1})}),{resultList:_=_.sort(function(e,t){var a=e.key,n=e.visible,o=t.key,i=t.visible;return n===i?a===s.EMPTY_KEY_VALUE&&o===s.EMPTY_KEY_VALUE?0:a===s.EMPTY_KEY_VALUE?1:o===s.EMPTY_KEY_VALUE?-1:(0,r.naturalCompare)(a,o):!0===n?-1:!0===i?1:void 0}),currentColValue:v}};var r=a(292),s=a(293),l=a(174);function u(e,t,a){return(0,r.handleRenderValue)((0,r.getRenderResult)(e,t,a))}function d(e,t,a,n,o){for(var i=[],s=a;s<=n;s++)if(!(0,r.isHiddenRowByUser)(e,s)){var l=u(e,s,t);o&&o(l,s),i.push(l)}return i}},777:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=l(a(9)),o=l(a(31));t.filterPanelConfirmHandler=function(e){var t=e.tempResultList,a=e.keyWord,n=e.currentColValue,o=e.col,r=e.hot,s=u({tempResultList:t,keyWord:a,currentColValue:n,col:o,hot:r}),l=s.basicFilter,d=s.activeSheetId,c=s.isClearColCriteria,h=s.visibleValues;l&&(0,i.updateFilterCriteria)({sheetId:d,delta:{defaultFilterId:l.workbookRangeId,updateColumnCriteriaDelta:{criteria:c?void 0:{visibleValues:h},clear:c,columnIndex:o}},rangeFilterId:l.workbookRangeId})},t.reorderWithFilterHandler=function(e,t){var a=e.tempResultList,n=e.keyWord,o=e.currentColValue,r=e.col,s=e.hot,l=t.options,d=t.hasTitle,c=t.gridRange,h=u({tempResultList:a,keyWord:n,currentColValue:o,col:r,hot:s}),f=h.basicFilter,p=h.activeSheetId,v=h.isClearColCriteria,_=h.visibleValues;f&&(0,i.reorderWithFilter)({sheetId:p,gridRange:c,filter:{delta:{defaultFilterId:f.workbookRangeId,updateColumnCriteriaDelta:{criteria:v?void 0:{visibleValues:_},clear:v,columnIndex:r}},rangeFilterId:f.workbookRangeId},reorder:{reorderInfos:l,hasTitle:d}})};var i=a(112),r=a(292),s=a(293);function l(e){return e&&e.__esModule?e:{default:e}}function u(e){var t=e.tempResultList,a=(e.keyWord,e.currentColValue),i=(e.col,e.hot),l=t.filter(function(e){return!0===e.visible}).map(function(e){return e.key});if(-1!==l.indexOf(s.EMPTY_KEY_VALUE)){var u=!0,d=!1,c=void 0;try{for(var h,f=(0,o.default)((0,n.default)(a));!(u=(h=f.next()).done);u=!0){var p=a[h.value];(0,r.isEmptyValue)(p)&&l.push(p)}}catch(E){d=!0,c=E}finally{try{!u&&f.return&&f.return()}finally{if(d)throw c}}}l=(0,r.unique)(l);(0,r.unique)((0,r.obj2Arr)(a));var v=!1;t.every(function(e){return e.visible})&&(v=!0);var _=i.activeSheet.getSheetId();return{basicFilter:i.activeSheet.getBasicFilter(),activeSheetId:_,isClearColCriteria:v,visibleValues:l}}},8:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=window.reportProxy,o=window.T_SHEET||{};window.T_SHEET=o,o.Report=n,t.default=n},81:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a(82),o=S(a(40)),i=S(a(8)),r=g(a(200)),s=g(a(124)),l=g(a(766)),u=g(a(244)),d=g(a(203)),c=g(a(143)),h=g(a(445)),f=g(a(1067)),p=S(a(12)),v=g(a(113)),_=g(a(767)),E=g(a(22)),T=g(a(26)),m=S(a(1072));function g(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&(t[a]=e[a]);return t.default=e,t}function S(e){return e&&e.__esModule?e:{default:e}}var R={EVENT_NAME:n.EVENT_NAME,event:o.default,report:i.default,util:{browser:r,cookie:s,editor:l,html:u,object:d,query:c,safe:h,string:f,timer:p.default,type:v,ui:_,userAgent:E,LRUCache:m.default},config:{report:T}},A=window.T_SHEET||{};window.T_SHEET=A,A.Base=R,t.default=R},82:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.EVENT_NAME=void 0;!function(e){e.AFTER_FIRST_RENDER="after_first_render",e.AFTER_ALL_RENDER="after_all_render",e.SELECTION_CHANGE="selection_change",e.ACTIVATION_CHANGE="activation_change",e.SELECTION_ENTER_VIEW="selection_enter_view",e.SELECTION_LEAVE_VIEW="selection_view_view",e.SELECT_PIC="select_pic",e.DATA_CHANGE="dataChange",e.INPUT_END="input_end",e.INPUT_CHANGE="input_change",e.ENTER_INPUT_STATUS="enter_input_status",e.ENTER_ACTIVE_STATUS="enter_active_status",e.ENTER_NORMAL_STATUS="enter_normal_status",e.ENTER_SCAN_STATUS="enter_scan_status",e.UI_SHOW="ui_show",e.TITLE_CHANGE_LOCAL="title_change_local",e.TITLE_CHANGE_SERVER="title_change_server",e.TITLE_AUTO_CHANGE="title_auto_change"}(n||(t.EVENT_NAME=n={}))},90:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.errCodeType=void 0;!function(e){e.APPLY_NEW_CHANGE_ERROR="D0001",e.REQUEST_SIZE_LIMIT="D0002",e.DATA_VERSION_TOO_LOW="D0003",e.KEYFRAME_UNZIP_ERROR="K0001",e.SHEET_ID_ERROR_1="S0001",e.SHEET_ID_ERROR_2="S0002",e.SHEET_ID_ERROR_3="S0003",e.SHEET_ID_INIT_OLD_DUPLICATE="S0004",e.SHEET_ID_SHEET_BAR_OLD_DUPLICATE="S0005",e.SHEET_ID_SHEET_BAR_NEW_DUPLICATE="S0006",e.SHEET_FETCH_ERROR="S0007",e.NOT_VIP_FULL="70001",e.KICK="N0001",e.RELOAD="N0002",e.SOCKET_NOT_SET_UP="N0003",e.OFFLINE_INDEXDB_NOT_AVAILABLE="N0004",e.COMMIT_ERROR_CODE_UNDEFINED="N0005",e.COMMITING_QUEUE_BLOCK="N0006",e.FRONTEND_SOCKET_ERROR_CODE_UNDEFINED="N0007",e.PERMISSION_CHANGE="N0008",e.FETCH_USER_CHANGE_RESPONSE_NOT_CONTINUE="F0001",e.FETCH_USER_CHANGE_TO_LESS_THAN_FROM="F0002",e.FETCH_USER_CHANGE_CGI_HTTP_ERROR="F0003",e.FETCH_USER_CHANGE_RESPONSE_DATA_EMPTY="F0004",e.FETCH_USER_CHANGE_RESPONSE_ARRAY_EMPTY="F0005",e.FETCH_USER_CHANGE_RESPONSE_ERROR_CODE="F0006"}(n||(t.errCodeType=n={}))},97:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=t.WorkerAbilityTestActionTypes=void 0;!function(e){e.MessageTest="MESSAGETEST",e.HeartBeatTest="HEARTBEATTEST"}(n||(t.WorkerAbilityTestActionTypes=n={}));var o=t.SheetDataActionTypes=void 0;!function(e){e.InitSpreadsheetApp="INITSPREADSHEETAPP",e.InitSpreadsheet="INITSPREADSHEET",e.InitSheet="INITSHEET",e.LoadSheet="LOADSHEET",e.FetchSheetOnMainThread="FETCHSHEETONMAINTHREAD",e.GetRangeDataFromMainThread="GETRANGEDATAFROMMAINTHREAD",e.UpdateDependentNodesOnMainThread="UPDATEDEPENDENTNODESONMAINTHREAD",e.UpdateSpreadsheet="UPDATESPREADSHEET",e.waittingForWorkerSpreadsheetReady="WAITTINGFORWORKERSPREADSHEETREADY",e.syncVisibleAreaToWorker="SYNCVISIBLEAREATOWORKER",e.resetSheetOnWorkerFormula="RESETSHEETONWORKERFORMULA",e.ClearAndReInitSheets="CLEARANDREINITSHEETS",e.ClearAndReInitOneSheet="ClearAndReInitOneSheet ",e.TransformSpreadsheetBySheetId="TRANSFORMSPREADSHEETBYSHEETID",e.TriggerAutoUpdateFormulaUpdate="TRIGGERAUTOUPDATEFORMULAUPDATE",e.InformNetworkChange="InformNetworkChange",e.CheckSheetFormulaLayerStatusBetweenThreads="CheckSheetFormulaLayerStatusBetweenThreads"}(o||(t.SheetDataActionTypes=o={}));var i=t.CookieActionTypes=void 0;!function(e){e.Xsrf="XSRFTOKEN"}(i||(t.CookieActionTypes=i={}));var r=t.MutationActionTypes=void 0;!function(e){e.SyncActiveSheetMutations="SYNCACTIVESHEETMUTATIONS",e.SyncMutationWhichChangeFormulaModelToMainThread="SYNCMUTATIONWHICHCHANGEFORMULAMODELTOMAINTHREAD",e.SyncNonPersistentMutationsToMainThread="SYNCNONPERSISTENTMUTATIONSTOMAINTHREAD",e.SyncHistoryMutations="SYNCHISTORYMUTATIONS"}(r||(t.MutationActionTypes=r={}));var s=t.SheetListActionTypes=void 0;!function(e){e.HeaderUpdateSync="HEADERUPDATESYNC",e.CopySheetData="COPYSHEETDATA"}(s||(t.SheetListActionTypes=s={}));var l=t.ReportActionTypes=void 0;!function(e){e.MonitorReport="MONITORREPORT ",e.TdwReport="TDWREPORT",e.HuatuoReport="HUATUOREPORT",e.TdwSingleReport="TDWSINGLEREPORT",e.DebuggerAlert="DEBUGGERALERT",e.RunReport="RunReport",e.SpeedMarkReport="SpreedMarkReport",e.FlowLogReport="FlowLogReport",e.SpeedRunReport="SpeedRunReport",e.SpeedhasInitReport="SpeedhasInitReport",e.SpeedRun="SpeedRun",e.WebLog="WebLog"}(l||(t.ReportActionTypes=l={}));var u=t.RavenActionTypes=void 0;!function(e){e.CaptureException="CAPTUREEXCEPTION",e.CaptureWorkerPromiseException="CAPTUREWORKERPROMISEEXCEPTION"}(u||(t.RavenActionTypes=u={}));var d=t.SnapShootTypes=void 0;!function(e){e.SaveSnapshotLocal="SAVE_SNAPSHOT_LOCAL",e.UploadSnaphotThumb="UPLOAD_SNAPHOT_THUMB"}(d||(t.SnapShootTypes=d={}))},99:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dialog=t.showDialog1=t.DefaultButtons=t.DIALOG_TYPE=t.getDialog=void 0,t.Custom_Dialog=d,t.showDialog2=h,t.showDialog3=f,t.showDialog4=function(e,t,a,n){u("showDialog4",e,t,a,n)},t.showDialog5=p,t.showDialog6=v,t.showMobileDialog1=function(e,t,a){u("showMobileDialog1",e,t,a)},t.showMobileDialog2=function(e,t,a,n){u("showMobileDialog2",e,t,a,n)},t.showMobileDialog3=function(e,t,a,n,o){u("showMobileDialog3",e,t,a,n,o)},t.showMobileDialog4=function(e,t,a,n){u("showMobileDialog4",e,t,a,n)},t.showMobileDialog5=_,t.showMobileDialog6=E,t.standardInformationDialogM=function(e){u("standardInformationDialogM",e)},t.inputDialog=function(e){r().then(function(t){t.InputDialog.create(e)})};var n=a(244),o=a(22),i=a(442),r=t.getDialog=function(){return a.e("bundle_ui_dialog").then(a.t.bind(null,1655,7))},s=t.DIALOG_TYPE={Confirmation:"confirmation",Error:"error",Question:"question",Information:"information",StandardConfirm:"standardConfirm",Warning:"warning",Waiting:"waiting"},l=t.DefaultButtons={OK:"\u786e\u5b9a",Cancel:"\u53d6\u6d88"},u=function(e){for(var t=arguments.length,a=Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];r().then(function(t){t[e].apply(t,a)})};function d(e,t){u("Custom_Dialog",e,t)}var c=t.showDialog1=function(e,t,a){u("showDialog1",e,t,a)};function h(e,t,a,n){u("showDialog2",e,t,a,n)}function f(e,t,a,n,o,i){u("showDialog3",e,t,a,n,o,i)}function p(e,t,a,n,o,i){u("showDialog5",e,t,a,n,o,i)}function v(e,t,a,n,o,i){u("showDialog6",e,t,a,n,o,i)}function _(e,t,a,n,o){u("showMobileDialog5",e,t,a,n,o)}function E(e,t,a,n,o){u("showMobileDialog6",e,t,a,n,o)}t.dialog={delSheet:function(e,t,a){var n=t&&""!==t?t:"\u786e\u5b9a\u8981\u5220\u9664\u8be5\u5de5\u4f5c\u8868\u5417\uff1f\u5220\u9664\u540e\u5c06\u65e0\u6cd5\u6062\u590d\u3002";o.isMobile||o.isPad?(0,i.showAlert)({type:"MessageBox",title:"\u5220\u9664\u5de5\u4f5c\u8868",content:n,isAria:a,buttons:[{type:"default",label:"\u53d6\u6d88",onclick:function(e,t){e&&e.close()}},{type:"primary",label:"\u786e\u5b9a",onclick:function(t,a){e(),t&&t.close()}}]}):d(n,{type:s.Question,title:"\u5220\u9664\u5de5\u4f5c\u8868",overlay_close:!1,onClose:function(t){t===l.OK&&e()}})},info:function(e,t){o.isMobile||o.isPad?(0,i.showAlert)({type:"MessageBox",title:e,content:t,buttons:[{type:"primary",label:"\u786e\u5b9a"}]}):c((0,n.escapeHTML)(e),(0,n.escapeHTML)(t),"confirmation")},alert:function(e,t,a){o.isMobile||o.isPad?(0,i.showAlert)({type:"MessageBox",title:e,content:t,buttons:[{type:"primary",label:"\u786e\u5b9a",onclick:function(e,t){a&&a(e,t),e.close()}}]}):h(e,t,"confirmation",a)},confirm:function(e,t,a,n,r){o.isMobile||o.isPad?(0,i.showAlert)({type:"MessageBox",title:e,content:t,onClose:r,buttons:[{type:"default",label:"\u53d6\u6d88",onclick:function(e,t){n&&n(e,t),e&&e.close()}},{type:"primary",label:"\u786e\u5b9a",onclick:function(e,t){a&&a(e,t),e&&e.close()}}]}):f(e,t,"confirmation",a,n,r)},waiting:function(e,t){return o.isMobile?d(e,{show_close_button:!1,overlay_close:!1,border_top:!1,buttons:!1,type:"waiting",overlay_class:"CustomDialogOverlay-Waiting",custom_class:"operate-waiting",only_mobile:!0,onClose:t}):d(e,{show_close_button:!1,overlay_close:!1,border_top:!1,buttons:!1,type:"waiting",overlay_class:"CustomDialogOverlay-Waiting",custom_class:"operate-waiting",onClose:t})},report:function(e,t,a,i,r){o.isMobile?_((0,n.escapeHTML)(e),(0,n.escapeHTML)(t),"confirmation",a,i):p((0,n.escapeHTML)(e),(0,n.escapeHTML)(t),"confirmation",a,i,r)},tucao:function(e,t,a,i,r){o.isMobile?E((0,n.escapeHTML)(e),(0,n.escapeHTML)(t),"confirmation",a,i):v((0,n.escapeHTML)(e),(0,n.escapeHTML)(t),"confirmation",a,i,r)}}},996:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,o=a(9),i=(n=o)&&n.__esModule?n:{default:n};var r=function(){Array.prototype.slice;var e,t,a,n=Array.prototype.shift,o=Array.prototype.unshift,r={},s=function(e,t){for(var a,n=0,o=e.length;n<o;n++){var i=e[n];a=t.call(i,n,i)}return a};return e=function(e,t,a){a[e]||(a[e]=[]),a[e].push(t)},a=function(e,t,a){if(t[e])if(a)for(var n=t[e].length;n>=0;n--)t[e][n]===a&&t[e].splice(n,1);else t[e]=[]},t=function(){var e=n.call(arguments),t=n.call(arguments),a=arguments,o=this,i=e[t];if(i&&i.length)return s(i,function(){return this.apply(o,a)})},{create:function(n){var l={},u=[],d={listen:function(t,a,n){e(t,a,l);var o=u[t];void 0!==o?"listened"!==o&&Array.isArray(o)&&("last"===n?o.length&&o.pop()():"ignoreOffline"===n||s(o,function(){this()}),u[t]="listened"):u[t]="listened"},one:function(e,t,n){a(e,l),this.listen(e,t,n)},remove:function(e,t){a(e,l,t)},removeAll:function(){(0,i.default)(l).forEach(function(e){delete l[e]})},trigger:function(){var e,a,n=this;o.call(arguments,l),e=function(){return t.apply(n,a)};var i=(a=arguments)[1];return"listened"===u[i]?e():(u[i]||(u[i]=[]),Array.isArray(u[i])?u[i].push(e):void 0)}};return(n=n||"default")?r[n]?r[n]:r[n]=d:d},one:function(e,t,a){this.create().one(e,t,a)},remove:function(e,t){this.create().remove(e,t)},listen:function(e,t,a){this.create().listen(e,t,a)},trigger:function(){this.create().trigger.apply(this,arguments)}}}(),s=function(){var e=function(e){return r.create(e)};return{create:e,init:function(){return e("default")}}}(),l=s;"undefined"!==typeof window&&(l=window.__eventCenter=window.__eventCenter?window.__eventCenter:s),t.default=l},997:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s(a(9)),o=s(a(0)),i=s(a(1)),r=a(113);function s(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,o.default)(this,e),this.parent=t,this.cache={}}return(0,i.default)(e,[{key:"listen",value:function(e,t){if(this.parent&&this.parent.addEventListener)switch(e){case"resize":return this.bind(e,t,200);case"mousemoveLazy":return this.bind("mousemove",t,200);case"mousedown":case"mousemove":case"mouseup":case"keyup":case"keydown":case"click":case"touchstart":case"touchmove":case"touchend":return this.bind(e,t);case"visibilitychange":case"mozvisibilitychange":case"msvisibilitychange":case"webkitvisibilitychange":return this.bind("visibilitychange",t);default:throw new Error(e+" is not found in DomEventModule")}}},{key:"remove",value:function(e,t){if(this.parent&&this.parent.addEventListener&&this.cache[e]){var a=this.cache[e];if(t)for(var n=a.length;n>=0;n--)a[n]===t&&a.splice(n,1);else a=[];0===a.length&&(this.parent.removeEventListener(e,a.eventCallback),delete this.cache[e])}}},{key:"trigger",value:function(e,t){if(this.cache[e]){var a=this.cache[e];a.length>0&&a.eventCallback(t)}}},{key:"one",value:function(e,t){this.listen(e,t),this.remove(e,t)}},{key:"bind",value:function(e,t,a){var n=this;this.cache[e]||(this.cache[e]=[]);var o=this.cache[e];if(a&&(t=(0,r.throttle)(t,a)),o.push(t),1===o.length){var i=function(e){o.forEach(function(t){t(e)})};this.parent.addEventListener(e,i,!1),o.eventCallback=i}return{remove:function(){return n.remove(e,t)}}}},{key:"removeAll",value:function(){var e=this;(0,n.default)(this.cache).forEach(function(t){e.parent.removeEventListener(t,e.cache[t].eventCallback,!1),delete e.cache[t]})}}]),e}();t.default=l}})};window.$&&window.React?t():window.spreadSheetEntryInit=function(){e||(e=!0,t())}}();
//# sourceMappingURL=spread-sheet-pc-ec37bb003c.js.map