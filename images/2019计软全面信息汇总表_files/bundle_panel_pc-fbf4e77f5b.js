(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_panel_pc"],{1658:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ConditionalFormatPanel=t.SidePanelMain=t.FormulaEditorPanel=t.SearchReplacePanel=t.SortRangePanel=t.FilterPanel=t.ValidationErrorPanel=t.DataValidationPanel=t.RangeSelectionPanel=t.CustomFormatPanel=void 0;var a=f(n(1773)),i=f(n(1779)),o=f(n(1791)),r=f(n(1795)),l=f(n(1799)),s=f(n(1807)),u=f(n(1814)),c=f(n(1821)),d=f(n(1822)),p=f(n(1825));function f(e){return e&&e.__esModule?e:{default:e}}t.CustomFormatPanel=s.default,t.RangeSelectionPanel=a.default,t.DataValidationPanel=i.default,t.ValidationErrorPanel=o.default,t.FilterPanel=r.default,t.SortRangePanel=l.default,t.SearchReplacePanel=u.default,t.FormulaEditorPanel=c.default,t.SidePanelMain=d.default,t.ConditionalFormatPanel=p.default},1673:function(e,t,n){"use strict";var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(46)),o=n(171);t.MenuItemContext=i.createContext({itemStyle:void 0,clickHandler:o.emptyFn,selectedIds:[]}),t.SubMenuContext=i.createContext({zIndex:1e4,visible:!0,type:"normal"})},1677:function(e,t,n){"use strict";function a(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}n.r(t);var i=n(46),o=n(141),r=n.n(o),l=r.a.shape({trySubscribe:r.a.func.isRequired,tryUnsubscribe:r.a.func.isRequired,notifyNestedSubs:r.a.func.isRequired,isSubscribed:r.a.func.isRequired}),s=r.a.shape({subscribe:r.a.func.isRequired,dispatch:r.a.func.isRequired,getState:r.a.func.isRequired});function u(e){var t;void 0===e&&(e="store");var n=e+"Subscription",o=function(t){a(r,t);var o=r.prototype;function r(n,a){var i;return(i=t.call(this,n,a)||this)[e]=n.store,i}return o.getChildContext=function(){var t;return(t={})[e]=this[e],t[n]=null,t},o.render=function(){return i.Children.only(this.props.children)},r}(i.Component);return o.propTypes={store:s.isRequired,children:r.a.element.isRequired},o.childContextTypes=((t={})[e]=s.isRequired,t[n]=l,t),o}var c=u();function d(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function p(){return(p=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function f(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}var h=n(1704),m=n.n(h),v=n(1706),g=n.n(v),b=n(1687),y=null,E={notify:function(){}};var _=function(){function e(e,t,n){this.store=e,this.parentSub=t,this.onStateChange=n,this.unsubscribe=null,this.listeners=E}var t=e.prototype;return t.addNestedSub=function(e){return this.trySubscribe(),this.listeners.subscribe(e)},t.notifyNestedSubs=function(){this.listeners.notify()},t.isSubscribed=function(){return Boolean(this.unsubscribe)},t.trySubscribe=function(){this.unsubscribe||(this.unsubscribe=this.parentSub?this.parentSub.addNestedSub(this.onStateChange):this.store.subscribe(this.onStateChange),this.listeners=function(){var e=[],t=[];return{clear:function(){t=y,e=y},notify:function(){for(var n=e=t,a=0;a<n.length;a++)n[a]()},get:function(){return t},subscribe:function(n){var a=!0;return t===e&&(t=e.slice()),t.push(n),function(){a&&e!==y&&(a=!1,t===e&&(t=e.slice()),t.splice(t.indexOf(n),1))}}}}())},t.tryUnsubscribe=function(){this.unsubscribe&&(this.unsubscribe(),this.unsubscribe=null,this.listeners.clear(),this.listeners=E)},e}(),w=0,T={};function I(){}function C(e,t){var n,o;void 0===t&&(t={});var r=t,u=r.getDisplayName,c=void 0===u?function(e){return"ConnectAdvanced("+e+")"}:u,h=r.methodName,v=void 0===h?"connectAdvanced":h,y=r.renderCountProp,E=void 0===y?void 0:y,C=r.shouldHandleStateChanges,x=void 0===C||C,A=r.storeKey,S=void 0===A?"store":A,O=r.withRef,N=void 0!==O&&O,k=f(r,["getDisplayName","methodName","renderCountProp","shouldHandleStateChanges","storeKey","withRef"]),D=S+"Subscription",M=w++,P=((n={})[S]=s,n[D]=l,n),R=((o={})[D]=l,o);return function(t){g()(Object(b.isValidElementType)(t),"You must pass a component to the function returned by "+v+". Instead received "+JSON.stringify(t));var n=t.displayName||t.name||"Component",o=c(n),r=p({},k,{getDisplayName:c,methodName:v,renderCountProp:E,shouldHandleStateChanges:x,storeKey:S,withRef:N,displayName:o,wrappedComponentName:n,WrappedComponent:t}),l=function(n){function l(e,t){var a;return(a=n.call(this,e,t)||this).version=M,a.state={},a.renderCount=0,a.store=e[S]||t[S],a.propsMode=Boolean(e[S]),a.setWrappedInstance=a.setWrappedInstance.bind(d(d(a))),g()(a.store,'Could not find "'+S+'" in either the context or props of "'+o+'". Either wrap the root component in a <Provider>, or explicitly pass "'+S+'" as a prop to "'+o+'".'),a.initSelector(),a.initSubscription(),a}a(l,n);var s=l.prototype;return s.getChildContext=function(){var e,t=this.propsMode?null:this.subscription;return(e={})[D]=t||this.context[D],e},s.componentDidMount=function(){x&&(this.subscription.trySubscribe(),this.selector.run(this.props),this.selector.shouldComponentUpdate&&this.forceUpdate())},s.componentWillReceiveProps=function(e){this.selector.run(e)},s.shouldComponentUpdate=function(){return this.selector.shouldComponentUpdate},s.componentWillUnmount=function(){this.subscription&&this.subscription.tryUnsubscribe(),this.subscription=null,this.notifyNestedSubs=I,this.store=null,this.selector.run=I,this.selector.shouldComponentUpdate=!1},s.getWrappedInstance=function(){return g()(N,"To access the wrapped instance, you need to specify { withRef: true } in the options argument of the "+v+"() call."),this.wrappedInstance},s.setWrappedInstance=function(e){this.wrappedInstance=e},s.initSelector=function(){var t=e(this.store.dispatch,r);this.selector=function(e,t){var n={run:function(a){try{var i=e(t.getState(),a);(i!==n.props||n.error)&&(n.shouldComponentUpdate=!0,n.props=i,n.error=null)}catch(o){n.shouldComponentUpdate=!0,n.error=o}}};return n}(t,this.store),this.selector.run(this.props)},s.initSubscription=function(){if(x){var e=(this.propsMode?this.props:this.context)[D];this.subscription=new _(this.store,e,this.onStateChange.bind(this)),this.notifyNestedSubs=this.subscription.notifyNestedSubs.bind(this.subscription)}},s.onStateChange=function(){this.selector.run(this.props),this.selector.shouldComponentUpdate?(this.componentDidUpdate=this.notifyNestedSubsOnComponentDidUpdate,this.setState(T)):this.notifyNestedSubs()},s.notifyNestedSubsOnComponentDidUpdate=function(){this.componentDidUpdate=void 0,this.notifyNestedSubs()},s.isSubscribed=function(){return Boolean(this.subscription)&&this.subscription.isSubscribed()},s.addExtraProps=function(e){if(!N&&!E&&(!this.propsMode||!this.subscription))return e;var t=p({},e);return N&&(t.ref=this.setWrappedInstance),E&&(t[E]=this.renderCount++),this.propsMode&&this.subscription&&(t[D]=this.subscription),t},s.render=function(){var e=this.selector;if(e.shouldComponentUpdate=!1,e.error)throw e.error;return Object(i.createElement)(t,this.addExtraProps(e.props))},l}(i.Component);return l.WrappedComponent=t,l.displayName=o,l.childContextTypes=R,l.contextTypes=P,l.propTypes=P,m()(l,t)}}var x=Object.prototype.hasOwnProperty;function A(e,t){return e===t?0!==e||0!==t||1/e===1/t:e!==e&&t!==t}function S(e,t){if(A(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),a=Object.keys(t);if(n.length!==a.length)return!1;for(var i=0;i<n.length;i++)if(!x.call(t,n[i])||!A(e[n[i]],t[n[i]]))return!1;return!0}var O=n(1680);function N(e){return function(t,n){var a=e(t,n);function i(){return a}return i.dependsOnOwnProps=!1,i}}function k(e){return null!==e.dependsOnOwnProps&&void 0!==e.dependsOnOwnProps?Boolean(e.dependsOnOwnProps):1!==e.length}function D(e,t){return function(t,n){n.displayName;var a=function(e,t){return a.dependsOnOwnProps?a.mapToProps(e,t):a.mapToProps(e)};return a.dependsOnOwnProps=!0,a.mapToProps=function(t,n){a.mapToProps=e,a.dependsOnOwnProps=k(e);var i=a(t,n);return"function"===typeof i&&(a.mapToProps=i,a.dependsOnOwnProps=k(i),i=a(t,n)),i},a}}var M=[function(e){return"function"===typeof e?D(e):void 0},function(e){return e?void 0:N(function(e){return{dispatch:e}})},function(e){return e&&"object"===typeof e?N(function(t){return Object(O.bindActionCreators)(e,t)}):void 0}];var P=[function(e){return"function"===typeof e?D(e):void 0},function(e){return e?void 0:N(function(){return{}})}];function R(e,t,n){return p({},n,e,t)}var L=[function(e){return"function"===typeof e?function(e){return function(t,n){n.displayName;var a,i=n.pure,o=n.areMergedPropsEqual,r=!1;return function(t,n,l){var s=e(t,n,l);return r?i&&o(s,a)||(a=s):(r=!0,a=s),a}}}(e):void 0},function(e){return e?void 0:function(){return R}}];function j(e,t,n,a){return function(i,o){return n(e(i,o),t(a,o),o)}}function B(e,t,n,a,i){var o,r,l,s,u,c=i.areStatesEqual,d=i.areOwnPropsEqual,p=i.areStatePropsEqual,f=!1;function h(i,f){var h=!d(f,r),m=!c(i,o);return o=i,r=f,h&&m?(l=e(o,r),t.dependsOnOwnProps&&(s=t(a,r)),u=n(l,s,r)):h?(e.dependsOnOwnProps&&(l=e(o,r)),t.dependsOnOwnProps&&(s=t(a,r)),u=n(l,s,r)):m?function(){var t=e(o,r),a=!p(t,l);return l=t,a&&(u=n(l,s,r)),u}():u}return function(i,c){return f?h(i,c):(l=e(o=i,r=c),s=t(a,r),u=n(l,s,r),f=!0,u)}}function F(e,t){var n=t.initMapStateToProps,a=t.initMapDispatchToProps,i=t.initMergeProps,o=f(t,["initMapStateToProps","initMapDispatchToProps","initMergeProps"]),r=n(e,o),l=a(e,o),s=i(e,o);return(o.pure?B:j)(r,l,s,e,o)}function V(e,t,n){for(var a=t.length-1;a>=0;a--){var i=t[a](e);if(i)return i}return function(t,a){throw new Error("Invalid value of type "+typeof e+" for "+n+" argument when connecting component "+a.wrappedComponentName+".")}}function Y(e,t){return e===t}var U=function(e){var t=void 0===e?{}:e,n=t.connectHOC,a=void 0===n?C:n,i=t.mapStateToPropsFactories,o=void 0===i?P:i,r=t.mapDispatchToPropsFactories,l=void 0===r?M:r,s=t.mergePropsFactories,u=void 0===s?L:s,c=t.selectorFactory,d=void 0===c?F:c;return function(e,t,n,i){void 0===i&&(i={});var r=i,s=r.pure,c=void 0===s||s,h=r.areStatesEqual,m=void 0===h?Y:h,v=r.areOwnPropsEqual,g=void 0===v?S:v,b=r.areStatePropsEqual,y=void 0===b?S:b,E=r.areMergedPropsEqual,_=void 0===E?S:E,w=f(r,["pure","areStatesEqual","areOwnPropsEqual","areStatePropsEqual","areMergedPropsEqual"]),T=V(e,o,"mapStateToProps"),I=V(t,l,"mapDispatchToProps"),C=V(n,u,"mergeProps");return a(d,p({methodName:"connect",getDisplayName:function(e){return"Connect("+e+")"},shouldHandleStateChanges:Boolean(e),initMapStateToProps:T,initMapDispatchToProps:I,initMergeProps:C,pure:c,areStatesEqual:m,areOwnPropsEqual:g,areStatePropsEqual:y,areMergedPropsEqual:_},w))}}();n.d(t,"Provider",function(){return c}),n.d(t,"createProvider",function(){return u}),n.d(t,"connectAdvanced",function(){return C}),n.d(t,"connect",function(){return U})},1678:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleClick=function(e){t.props.disabled||(e.nativeEvent._dui_dropdown_keep=!0)},t}return a(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,a=e.style,i=e.children,o=s.default(t,n);return r.createElement("div",{className:o,style:a,onClick:this.handleClick},i)},t}(r.Component);t.default=u,u.defaultProps={prefixCls:"dui-dropdown-keep",disabled:!1},u.propTypes={prefixCls:l.string,style:l.object,className:l.string,disabled:l.bool}},1679:function(e,t,n){var a=n(1781);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1680:function(e,t,n){"use strict";n.r(t),n.d(t,"createStore",function(){return l}),n.d(t,"combineReducers",function(){return u}),n.d(t,"bindActionCreators",function(){return d}),n.d(t,"applyMiddleware",function(){return h}),n.d(t,"compose",function(){return f}),n.d(t,"__DO_NOT_USE__ActionTypes",function(){return o});var a=n(1707),i=function(){return Math.random().toString(36).substring(7).split("").join(".")},o={INIT:"@@redux/INIT"+i(),REPLACE:"@@redux/REPLACE"+i(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+i()}};function r(e){if("object"!==typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function l(e,t,n){var i;if("function"===typeof t&&"function"===typeof n||"function"===typeof n&&"function"===typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function");if("function"===typeof t&&"undefined"===typeof n&&(n=t,t=void 0),"undefined"!==typeof n){if("function"!==typeof n)throw new Error("Expected the enhancer to be a function.");return n(l)(e,t)}if("function"!==typeof e)throw new Error("Expected the reducer to be a function.");var s=e,u=t,c=[],d=c,p=!1;function f(){d===c&&(d=c.slice())}function h(){if(p)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return u}function m(e){if("function"!==typeof e)throw new Error("Expected the listener to be a function.");if(p)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return f(),d.push(e),function(){if(t){if(p)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,f();var n=d.indexOf(e);d.splice(n,1)}}}function v(e){if(!r(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if("undefined"===typeof e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(p)throw new Error("Reducers may not dispatch actions.");try{p=!0,u=s(u,e)}finally{p=!1}for(var t=c=d,n=0;n<t.length;n++){(0,t[n])()}return e}return v({type:o.INIT}),(i={dispatch:v,subscribe:m,getState:h,replaceReducer:function(e){if("function"!==typeof e)throw new Error("Expected the nextReducer to be a function.");s=e,v({type:o.REPLACE})}})[a.a]=function(){var e,t=m;return(e={subscribe:function(e){if("object"!==typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(h())}return n(),{unsubscribe:t(n)}}})[a.a]=function(){return this},e},i}function s(e,t){var n=t&&t.type;return"Given "+(n&&'action "'+String(n)+'"'||"an action")+', reducer "'+e+'" returned undefined. To ignore an action, you must explicitly return the previous state. If you want this reducer to hold no value, you can return null instead of undefined.'}function u(e){for(var t=Object.keys(e),n={},a=0;a<t.length;a++){var i=t[a];0,"function"===typeof e[i]&&(n[i]=e[i])}var r,l=Object.keys(n);try{!function(e){Object.keys(e).forEach(function(t){var n=e[t];if("undefined"===typeof n(void 0,{type:o.INIT}))throw new Error('Reducer "'+t+"\" returned undefined during initialization. If the state passed to the reducer is undefined, you must explicitly return the initial state. The initial state may not be undefined. If you don't want to set a value for this reducer, you can use null instead of undefined.");if("undefined"===typeof n(void 0,{type:o.PROBE_UNKNOWN_ACTION()}))throw new Error('Reducer "'+t+"\" returned undefined when probed with a random type. Don't try to handle "+o.INIT+' or other actions in "redux/*" namespace. They are considered private. Instead, you must return the current state for any unknown actions, unless it is undefined, in which case you must return the initial state, regardless of the action type. The initial state may not be undefined, but can be null.')})}(n)}catch(u){r=u}return function(e,t){if(void 0===e&&(e={}),r)throw r;for(var a=!1,i={},o=0;o<l.length;o++){var u=l[o],c=n[u],d=e[u],p=c(d,t);if("undefined"===typeof p){var f=s(u,t);throw new Error(f)}i[u]=p,a=a||p!==d}return a?i:e}}function c(e,t){return function(){return t(e.apply(this,arguments))}}function d(e,t){if("function"===typeof e)return c(e,t);if("object"!==typeof e||null===e)throw new Error("bindActionCreators expected an object or a function, instead received "+(null===e?"null":typeof e)+'. Did you write "import ActionCreators from" instead of "import * as ActionCreators from"?');for(var n=Object.keys(e),a={},i=0;i<n.length;i++){var o=n[i],r=e[o];"function"===typeof r&&(a[o]=c(r,t))}return a}function p(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function f(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce(function(e,t){return function(){return e(t.apply(void 0,arguments))}})}function h(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),a=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},i={getState:n.getState,dispatch:function(){return a.apply(void 0,arguments)}},o=t.map(function(e){return e(i)});return function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},a=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(a=a.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),a.forEach(function(t){p(e,t,n[t])})}return e}({},n,{dispatch:a=f.apply(void 0,o)(n.dispatch)})}}}},1683:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1783));t.Select=i.default,n(197).injectStyle(".dui-select-disabled{opacity:.6}.dui-select{-webkit-box-sizing:border-box;box-sizing:border-box;border:1px solid #e3e3e3;border-radius:2px;padding:8px 9px;height:34px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;cursor:pointer;font-size:14px}.dui-select:hover{border-color:#d0d0d0}.dui-select-text{color:rgba(0,0,0,.88)}.dui-select-placeholder{color:rgba(0,0,0,.24)}.dui-select-arrow{display:inline-block;width:16px;height:16px;background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20xmlns%3Axlink%3D%22http%3A%2F%2Fwww.w3.org%2F1999%2Fxlink%22%20width%3D%2216%22%20height%3D%2216%22%3E%3Cpath%20fill%3D%22%23000%22%20opacity%3D%22.4%22%20id%3D%22A%22%20d%3D%22M5%206h6l-2.988%204z%22%2F%3E%3C%2Fsvg%3E)}.dui-select-list{overflow-y:auto;overflow-x:hidden}");var o=a(n(1737));i.default.Option=o.default,t.default=i.default},1684:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=n(171),c=n(1690),d=n(1673),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootRef=r.createRef(),t.clickedIds=[],t.handleClick=function(e){if(0!==t.clickedIds.length){var n=t.clickedIds.shift();t.clickedIds=[],t.props.onClick(n,e)}},t.handleItemClick=function(e){t.clickedIds.push(e)},t}return a(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,i=n.className,o=n.style,l=n.children,u=n.itemStyle,p=n.selectedIds,f=n.visible,h=n.type,m=s.default(a,a+"-"+h,i,((e={})[a+"-hidden"]=!f,e));return r.createElement(c.DropdownContext.Consumer,null,function(e){var n=e.visible;return r.createElement(d.MenuItemContext.Provider,{value:{itemStyle:u,clickHandler:t.handleItemClick,selectedIds:p}},r.createElement(d.SubMenuContext.Provider,{value:{zIndex:1e4,visible:n&&f,type:h}},r.createElement("ul",{className:m,style:o,onClick:t.handleClick},l)))})},t}(r.Component);t.default=p,p.defaultProps={prefixCls:"dui-menu",onClick:u.emptyFn,selectedIds:[],visible:!0,type:"normal"},p.propTypes={prefixCls:l.string,style:l.object,className:l.string,onClick:l.func,itemStyle:l.object,selectedIds:l.arrayOf(l.string),visible:l.bool,type:l.oneOf(["normal","compact"])}},1685:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(46)),s=o(n(141)),u=r(n(142)),c=n(171),d=n(1673),p=r(n(1678)),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.domRef=l.createRef(),t.handleClick=function(e){var n=t.context.clickHandler,a=t.props,i=a.disabled,o=a.onClick;if(!i){o(e);var r=e.nativeEvent;r._dui_submenu_click?delete r._dui_submenu_click:n(t.props.id)}},t}return a(t,e),t.prototype.isSelected=function(){return-1!==this.context.selectedIds.indexOf(this.props.id)},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,a=t.className,o=t.style,r=t.children,s=t.onMouseEnter,c=t.onMouseLeave,d=t.disabled,f=t.description,h=this.context.itemStyle,m=u.default(n,a,((e={})[n+"-disabled"]=d,e[n+"-selected"]=this.isSelected(),e));return l.createElement(p.default,{disabled:!d},l.createElement("li",{className:m,style:i({},h,o),onClick:this.handleClick,ref:this.domRef,onMouseEnter:s,onMouseLeave:c},r,f?l.createElement("span",{className:n+"-description"},f):null))},t.contextType=d.MenuItemContext,t}(l.Component);t.default=f,f.defaultProps={prefixCls:"dui-menu-item",id:"",onMouseEnter:c.emptyFn,onMouseLeave:c.emptyFn,onClick:c.emptyFn,disabled:!1},f.propTypes={prefixCls:s.string,style:s.object,className:s.string,id:s.string,onMouseEnter:s.func,onMouseLeave:s.func,onClick:s.func,disabled:s.bool,description:s.string}},1686:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=n(171),u=o(n(142)),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.trigger=function(e){if(!t.props.disabled){if(e._dui_trigger_instances){var n=e._dui_trigger_instances.indexOf(t);if(-1!==n)return e._dui_trigger_instances.splice(n,1),void(0===e._dui_trigger_instances.length&&delete e._dui_trigger_instances)}t.props.action()}},t.cancel=function(e){if(!t.props.disabled){var n=e.nativeEvent;n._dui_trigger_instances?n._dui_trigger_instances.push(t):n._dui_trigger_instances=[t]}},t}return a(t,e),t.prototype.componentDidMount=function(){document.addEventListener("click",this.trigger),this.props.disableContextMenu||document.addEventListener("contextmenu",this.trigger)},t.prototype.componentWillUnmount=function(){document.removeEventListener("click",this.trigger),this.props.disableContextMenu||document.removeEventListener("contextmenu",this.trigger)},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,a=e.style,i=e.children,o=e.domRef,l=e.disableContextMenu,s=u.default(t,n);return r.createElement("div",{className:s,style:a,onClick:this.cancel,onContextMenu:l?void 0:this.cancel,ref:o},i)},t}(r.Component);t.default=c,c.defaultProps={prefixCls:"dui-trigger",action:s.emptyFn,disabled:!1,disableContextMenu:!1},c.propTypes={className:l.string,prefixCls:l.string,style:l.object,action:l.func,disabled:l.bool,domRef:l.object,disableContextMenu:l.bool}},1687:function(e,t,n){"use strict";e.exports=n(1705)},1689:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1684));t.Menu=i.default;var o=a(n(1685)),r=a(n(1700));n(197).injectStyle(".dui-menu,.dui-menu-submenu-content{-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16);list-style:none;background:#fff;padding:8px 0;margin:0;border:1px solid rgba(0,0,0,.12);border-radius:3px;-webkit-tap-highlight-color:transparent;overflow-y:auto;overflow-x:hidden;-webkit-box-sizing:border-box;box-sizing:border-box}.dui-menu-hidden{visibility:hidden}.dui-menu-item{position:relative;-webkit-box-sizing:content-box;box-sizing:content-box;white-space:nowrap;-webkit-transition:background-color .2s linear;transition:background-color .2s linear;padding:9px 12px 9px 28px;font-size:14px;height:14px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:justify;-webkit-justify-content:space-between;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;color:rgba(0,0,0,.8);cursor:pointer}.dui-menu-item-disabled{opacity:.3}.dui-menu-item-description{color:rgba(0,0,0,.4)}.dui-menu-item-disabled .dui-menu-item-description{color:rgba(0,0,0,.8)}.dui-menu-item-selected::before{content:'';position:absolute;display:inline-block;width:16px;height:16px;left:6px;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);background-repeat:no-repeat;background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2216%22%20height%3D%2216%22%3E%3Cpath%20fill%3D%22%23000%22%20d%3D%22M5.368%2011.575L2.75%209.04l.753-1%202.73%201.88%206.914-6.526.852.854-7.808%208.186-.824-.86z%22%20opacity%3D%22.638%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E);background-size:contain;background-position:center}:not(.dui-menu-item-disabled).dui-menu-item:hover{background-color:rgba(0,0,0,.04)}:not(.dui-menu-item-disabled).dui-menu-item:active{background-color:rgba(0,0,0,.08)}.dui-menu-submenu::after{content:'';background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%224%22%20height%3D%226%22%3E%3Cpath%20d%3D%22M3.936%203.123L.374%205.95a.261.261%200%200%201-.31%200A.158.158%200%200%201%200%205.826V.174C0%20.078.098%200%20.22%200a.25.25%200%200%201%20.154.05l3.562%202.827a.15.15%200%200%201%200%20.246z%22%20opacity%3D%22.4%22%2F%3E%3C%2Fsvg%3E);display:inline-block;width:4px;height:6px;background-position:center;background-size:contain;margin-left:24px}.dui-menu-submenu:active{background-color:rgba(0,0,0,.04)}.dui-menu-submenu-wrapper{padding:0;background:0 0;position:absolute;-webkit-transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,-webkit-transform;transition-property:visibility,opacity,transform;transition-property:visibility,opacity,transform,-webkit-transform;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1)}.dui-menu-submenu-wrapper-visible{visibility:visible;-webkit-transition-duration:.16s;transition-duration:.16s;opacity:1;-webkit-transform:scale3d(1,1,1) translate(0);transform:scale3d(1,1,1) translate(0)}.dui-menu-submenu-wrapper-hidden-bottom,.dui-menu-submenu-wrapper-hidden-top{visibility:hidden;-webkit-transition-duration:.12s;transition-duration:.12s}.dui-menu-submenu-wrapper-hidden-bottom{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(-5px);transform:scale3d(1,1,1) translateY(-5px)}.dui-menu-submenu-wrapper-hidden-top{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(5px);transform:scale3d(1,1,1) translateY(5px)}.dui-menu-contextmenu-popup{position:absolute;z-index:9999;overflow-y:auto;overflow-x:hidden;-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16)}.dui-menu-contextmenu-popup-hidden{visibility:hidden}.dui-menu-contextmenu-popup-left-top{-webkit-transform:translate(-100%,-100%);transform:translate(-100%,-100%)}.dui-menu-contextmenu-popup-left-bottom{-webkit-transform:translateX(-100%);transform:translateX(-100%)}.dui-menu-contextmenu-popup-right-top{-webkit-transform:translateY(-100%);transform:translateY(-100%)}.dui-menu-compact,.dui-menu-submenu-content-compact{padding:6px 0;border:1px solid rgba(0,0,0,.12);-webkit-box-shadow:0 2px 8px 2px rgba(68,73,77,.16);box-shadow:0 2px 8px 2px rgba(68,73,77,.16)}.dui-menu-compact .dui-menu-item,.dui-menu-submenu-content-compact .dui-menu-item{font-size:12px;height:12px;padding:8px 12px 8px 28px}");var l=a(n(1701));i.default.Item=o.default,i.default.SubMenu=r.default,i.default.ContextMenu=l.default,t.default=i.default},1690:function(e,t,n){"use strict";var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(46));t.DropdownContext=i.createContext({visible:!0,zIndex:9999})},1696:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1736));t.Input=i.default,n(197).injectStyle(".dui-input-disabled{opacity:.6}.dui-input{-webkit-tap-highlight-color:transparent;position:relative}.dui-input-disabled::before{content:'';position:absolute;background-color:rgba(0,0,0,.05);top:0;left:0;right:0;bottom:0}.dui-input-input{display:block;outline:0;font-size:14px;height:34px;width:100%;-webkit-box-sizing:border-box;box-sizing:border-box;padding:8px 9px 9px 9px;border:1px solid rgba(0,0,0,.16);border-radius:2px;-webkit-appearance:none;-moz-appearance:none;appearance:none;margin:0}.dui-input-input::-webkit-input-placeholder{color:rgba(0,0,0,.24);letter-spacing:normal}.dui-input-input:-ms-input-placeholder{color:rgba(0,0,0,.24);letter-spacing:normal}.dui-input-input::-ms-input-placeholder{color:rgba(0,0,0,.24);letter-spacing:normal}.dui-input-input::placeholder{color:rgba(0,0,0,.24);letter-spacing:normal}.dui-input-input:hover{border-color:rgba(0,0,0,.3)}.dui-input-input:focus{border-color:#0188fb}.dui-input-input-underline{padding:6px 0;border-color:transparent;border-bottom-color:rgba(0,0,0,.08)}.dui-input-input-underline:hover{border-color:transparent;border-bottom-color:rgba(0,0,0,.3)}.dui-input-input-underline:focus{border-color:transparent;border-bottom-color:#0188fb}.dui-input-input-error{border-color:#ff7272}.dui-input-input-error.dui-input-input-underline{border-color:transparent;border-bottom-color:#ff7272}.dui-input-input:focus+.dui-input-indicator{-webkit-transform:scaleX(1);transform:scaleX(1)}.dui-input-indicator{position:absolute;display:inline-block;left:0;bottom:-1px;width:100%;height:2px;background:#0188fb;-webkit-transform-origin:left center;transform-origin:left center;-webkit-transition:all .2s ease-out;transition:all .2s ease-out;-webkit-transform:scaleX(0);transform:scaleX(0)}.dui-input-indicator-error{background:#ff7272}.dui-input-clear{display:inline-block;width:10px;height:10px;background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%2210%22%3E%3Cpath%20fill-rule%3D%22evenodd%22%20d%3D%22M6.015%205.13l3.447%203.447-.884.884L5.13%206.015%201.684%209.462.8%208.578%204.247%205.13.8%201.684%201.684.8%205.13%204.247%208.578.8l.884.884L6.015%205.13z%22%20opacity%3D%22.237%22%2F%3E%3C%2Fsvg%3E);background-position:center;background-repeat:no-repeat;visibility:hidden}.dui-input-clear-visible{visibility:visible}.dui-input-icon-container,.dui-input-icon-left{position:absolute;height:100%;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.dui-input-icon,.dui-input-icon-container{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center}.dui-input-icon{width:39px;height:100%;border-radius:1px}.dui-input-icon-container{right:0}.dui-input-icon-container-underline>:not(:last-child){margin-right:7px}.dui-input-icon-underline{width:auto;height:auto}.dui-input-icon-clickable{cursor:pointer}.dui-input-icon-clickable:not(.dui-input-icon-underline):not(.dui-input-clear-underline):hover{background-color:rgba(0,0,0,.04)}.dui-input-icon-clickable:not(.dui-input-icon-underline):not(.dui-input-clear-underline):active{background-color:rgba(0,0,0,.08)}.dui-input-icon-img{display:inline-block;width:16px;height:16px;background-size:cover;background-position:center;background-repeat:no-repeat}.dui-input-icon-left{left:0}.dui-input-icon-right{height:100%;right:0}");var o=a(n(1776));i.default.Password=o.default,t.default=i.default},1697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.SR_TYPE=void 0;!function(e){e.SEARCH="SEARCH",e.REPLACE="REPLACE"}(a||(t.SR_TYPE=a={}))},1698:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1699));t.Checkbox=i.default;var o=a(n(1721));n(197).injectStyle(".dui-checkbox{position:relative;padding-left:20px;font-size:14px;line-height:20px;-webkit-tap-highlight-color:transparent}.dui-checkbox-multi-line{padding-left:24px}.dui-checkbox-icon{position:absolute;z-index:1;left:0;top:2px;width:16px;height:16px;border:1px solid rgba(0,0,0,.16);-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background:#fff}.dui-checkbox-icon-square{border-radius:2px}.dui-checkbox-icon-circle{border-radius:50%}.dui-checkbox-input:hover+.dui-checkbox-icon{border-color:#0188fb}.dui-checkbox-normal.dui-checkbox-checked .dui-checkbox-icon{background-color:#0188fb}.dui-checkbox-hollow.dui-checkbox-checked .dui-checkbox-icon{background-color:#fff}.dui-checkbox-checked .dui-checkbox-icon,.dui-checkbox-checked:hover .dui-checkbox-icon{border-color:#0188fb}.dui-checkbox-checked .dui-checkbox-icon::after{content:'';display:block;left:0;top:0;width:100%;height:100%;background-position:center;background-repeat:no-repeat}.dui-checkbox-normal.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-hollow.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%230188fb%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-disabled .dui-checkbox-label{opacity:.36}.dui-checkbox-disabled .dui-checkbox-icon,.dui-checkbox-disabled:hover .dui-checkbox-icon{border-color:rgba(0,0,0,.08)}.dui-checkbox-normal.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon{background:rgba(0,0,0,.08);border-color:transparent}.dui-checkbox-normal.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20fill%3D%22%23fff%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox-hollow.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon{background:#fff}.dui-checkbox-hollow.dui-checkbox-disabled.dui-checkbox-checked .dui-checkbox-icon::after{background-image:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%2210%22%20height%3D%228%22%3E%3Cpath%20opacity%3D%22.08%22%20d%3D%22M3.64%205.6L8.9%200%2010%201.168%203.57%208%200%204.204l1.17-1.242z%22%20fill-rule%3D%22evenodd%22%2F%3E%3C%2Fsvg%3E)}.dui-checkbox:not(.dui-checkbox-disabled) .dui-checkbox-input{cursor:pointer}.dui-checkbox-input{position:absolute;z-index:2;margin:0;opacity:0;left:0;top:0;height:100%;width:16px}.dui-checkbox-input-full{width:100%}"),i.default.Group=o.default,t.default=i.default},1699:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),u=r(n(141)),c=l(n(142)),d=n(171),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={checked:!!t.props.defaultChecked},t.handleChange=function(e){var n=t.props;n.disabled||("checked"in n||t.setState({checked:e.target.checked}),n.onChange(e.target.checked,{target:i({},n,{checked:e.target.checked}),stopPropagation:e.stopPropagation.bind(e),preventDefault:e.preventDefault.bind(e),nativeEvent:e.nativeEvent}))},t}return a(t,e),t.prototype.render=function(){var e,t,n=this.props,a=n.prefixCls,r=n.className,l=n.style,u=n.children,d=n.disabled,p=n.hollow,f=n.labelClickable,h=n.shape,m=o(n,["prefixCls","className","style","children","disabled","hollow","labelClickable","shape"]),v="checked"in this.props?this.props.checked:this.state.checked,g=c.default(a,r,a+"-"+(p?"hollow":"normal"),((e={})[a+"-multi-line"]=s.Children.count(u)>1,e[a+"-checked"]=v,e[a+"-disabled"]=d,e)),b=c.default(a+"-input",((t={})[a+"-input-full"]=f,t)),y=c.default(a+"-icon",a+"-icon-"+h);return s.createElement("div",{className:g,style:l},s.createElement("input",i({},m,{type:"checkbox",className:b,onChange:this.handleChange})),s.createElement("span",{className:y}),s.createElement("div",{className:a+"-label"},u))},t}(s.Component);t.default=p,p.defaultProps={prefixCls:"dui-checkbox",onChange:d.emptyFn,disabled:!1,hollow:!1,labelClickable:!0,shape:"square"},p.propTypes={prefixCls:u.string,style:u.object,className:u.string,onChange:u.func,hollow:u.bool,labelClickable:u.bool,shape:u.oneOf(["circle","square"])}},1700:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(46)),s=r(n(123)),u=o(n(141)),c=r(n(142)),d=r(n(1685)),p=n(1673),f=r(n(1678)),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._hidePrevented=!1,t._restoringHeight=!1,t.itemRef=l.createRef(),t.popupWrapperRef=l.createRef(),t.popupContentRef=l.createRef(),t.state={visible:!1},t.handleMouseEnter=function(){t.props.disabled||t.setState({visible:!0})},t.handleMouseLeave=function(){t.props.disabled||t._hidePrevented||t.setState({visible:!1})},t.preventHide=function(){t._hidePrevented=!0,setTimeout(function(){t._hidePrevented=!1},10)},t.handleSubmenuClick=function(e){e.nativeEvent._dui_submenu_click=!0},t}return a(t,e),t.prototype.getPopoutMetrics=function(){var e={placement:"bottom",location:{left:"0px",top:"0px"},forcedHeight:0},t=this.itemRef.current;if(!t)return e;var n=t.domRef.current;if(!n)return e;var a=this.popupWrapperRef.current;if(!a)return e;var i=window.innerWidth,o=window.innerHeight,r=n.getBoundingClientRect(),l=r.right,s=r.left,u=r.top,c=r.bottom,d=a.getBoundingClientRect(),p=d.width,f=d.height,h=l+p<i?"right":"left",m=o-u-2,v=c-2,g="bottom",b=0;return f>=m?f>=v?m>=v?(g="bottom",b=m):(g="top",b=v):g="top":g="bottom",e={placement:g,location:{left:window.pageXOffset+("right"===h?l+-2:s-p- -2)+"px",top:window.pageYOffset+("bottom"===g?u:c-(b||f))+"px"},forcedHeight:b}},t.prototype.isVisible=function(){var e=this.state.visible,t=this.context.visible,n=this.props.disabled;return t&&e&&!n},t.prototype.componentDidUpdate=function(e,t){var n=this;t.visible&&!this.state.visible&&setTimeout(function(){n._restoringHeight=!0,n.forceUpdate(function(){n._restoringHeight=!1})},120)},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,a=t.className,o=t.style,r=t.children,u=t.id,h=t.title,m=t.disabled,v=t.popupStyle,g=this.context,b=g.zIndex,y=g.type,E=this.isVisible(),_=c.default(n,a,((e={})[n+"-disabled"]=m,e)),w=this.getPopoutMetrics(),T=w.location,I=w.placement,C=w.forcedHeight,x=c.default(n+"-wrapper",n+"-wrapper-"+(E?"visible":"hidden-"+I)),A=c.default(n+"-content",n+"-content-"+y);return l.createElement(p.SubMenuContext.Provider,{value:{zIndex:b+1,visible:E,type:y}},l.createElement("div",{onMouseEnter:this.handleMouseEnter,onMouseLeave:this.handleMouseLeave,onClick:this.preventHide},l.createElement(f.default,null,l.createElement(d.default,{id:u,className:_,style:o,ref:this.itemRef,disabled:m,onClick:this.handleSubmenuClick},h||u)),s.default.createPortal(l.createElement("div",{className:x,ref:this.popupWrapperRef,style:i({},T,{zIndex:b})},l.createElement("ul",{className:A,style:i({height:C&&!this._restoringHeight?C+"px":void 0},v),ref:this.popupContentRef},r)),document.body)))},t.contextType=p.SubMenuContext,t}(l.Component);t.default=h,h.defaultProps={prefixCls:"dui-menu-submenu",id:"",disabled:!1},h.propTypes={prefixCls:u.string,style:u.object,className:u.string,id:u.string,title:u.node,disabled:u.bool,popupStyle:u.object}},1701:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(46)),s=r(n(123)),u=o(n(141)),c=r(n(142)),d=r(n(1684)),p=r(n(1686)),f=n(171),h=l.createElement(d.default,null).type,m={horizontal:"right",vertical:"bottom",height:0},v=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.popupRef=l.createRef(),t.anchorRef=l.createRef(),t.state={visible:!1,menu:null,location:{left:0,top:0},metrics:i({},m)},t.handleContextMenu=function(e){e.preventDefault();var n=t.props,a=n.menu,o=n.disabled,r=n.onVisibleChange;o||t.setState({menu:"function"===typeof a?a(e):a,visible:!1,location:{left:e.pageX,top:e.pageY},metrics:i({},t.state.metrics,{height:0})},function(){t.updatePopoutMetrics(),t.setState({visible:!0},function(){r(!0)})})},t.hide=function(){t.isVisible()&&t.setState({visible:!1},function(){t.props.onVisibleChange(!1)})},t}return a(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},t.prototype.componentDidMount=function(){document.addEventListener("scroll",this.hide,{passive:!0})},t.prototype.componentWillUnmount=function(){document.removeEventListener("scroll",this.hide)},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.visible;return"boolean"===typeof t?t:n},t.prototype.updatePopoutMetrics=function(){var e=this.props,t=e.popupBoundary,n=e.popupMargin,a=this.anchorRef.current,i=this.popupRef.current;if(i&&a){var o=this.state.location,r=o.left,l=o.top,s=r-window.pageXOffset,u=l-window.pageYOffset,c=0,d=window.innerWidth,p=0,f=window.innerHeight,h=a.getBoundingClientRect(),m=h.left,v=h.right,g=h.top,b=h.bottom;"container"===t&&(c=Math.max(c,m),d=Math.min(d,v),p=Math.max(p,g),f=Math.min(f,b)),c+=n,d-=n,p+=n,f-=n;var y=i.getBoundingClientRect(),E=y.width,_=y.height,w=f-u,T=u-p,I="bottom",C=0;_>w?_>T?w>=T?(I="bottom",C=w):(I="top",C=T):I="top":I="bottom";var x={horizontal:s+E<=d?"right":s<=(d+c)/2?"right":"left",vertical:I,height:C};this.setState({metrics:x})}},t.prototype.render=function(){var e,t=this,n=this.props,a=n.prefixCls,o=n.className,r=n.style,u=n.children,d=n.disabled,f=n.popupStyle,m=this.isVisible(),v=c.default(a,o,((e={})[a+"-disabled"]=d,e)),g=this.state,b=g.location,y=b.left,E=b.top,_=g.menu,w=g.metrics,T=w.height,I=w.vertical,C=w.horizontal,x=c.default(a+"-popup",a+"-popup-"+C+"-"+I,a+"-popup-"+(m?"visible":"hidden")),A=l.Children.map(_,function(e){return l.isValidElement(e)&&e.type===h?l.cloneElement(e,{visible:m,onClick:function(n,a){e.props.onClick(n,a),t.hide()}}):e});return l.createElement(p.default,{action:this.hide},l.createElement("div",{className:v,style:r,onContextMenu:this.handleContextMenu,ref:this.anchorRef},u),s.default.createPortal(l.createElement(p.default,{className:x,style:i({left:y+"px",top:E+"px",height:T?T+"px":void 0},f),action:this.hide,domRef:this.popupRef,disableContextMenu:!0},A),document.body))},t}(l.Component);t.default=v,v.defaultProps={prefixCls:"dui-menu-contextmenu",disabled:!1,popupBoundary:"viewport",popupMargin:0,onVisibleChange:f.emptyFn},v.propTypes={prefixCls:u.string,style:u.object,className:u.string,menu:u.any,disabled:u.bool,popupStyle:u.object,visible:u.bool,popupBoundary:u.oneOf(["container","viewport"]),popupMargin:u.number,onVisibleChange:u.func}},1702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(14)),i=p(n(3)),o=p(n(0)),r=p(n(1)),l=p(n(4)),s=p(n(5)),u=p(n(1723)),c=p(n(46)),d=p(n(1696));function p(e){return e&&e.__esModule?e:{default:e}}n(1679);var f=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof u.default){var i=0;for(a=(0,u.default)(e);i<a.length;i++)t.indexOf(a[i])<0&&(n[a[i]]=e[a[i]])}return n},h=function(e){function t(e){return(0,o.default)(this,t),(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this.props,t=e.isError,n=e.errorTip,i=e.wrapStyle,o=e.style,r=f(e,["isError","errorTip","wrapStyle","style"]),l=t?"input-error-wrap":"";return c.default.createElement("div",{className:l,style:i},c.default.createElement(d.default,(0,a.default)({},r,{style:o})),c.default.createElement("div",{style:{visibility:t?"visible":"hidden"},className:"validation-input-tip"},n))}}]),t}(c.default.Component);t.default=h},1703:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PAINT_COLOR_REQPRT_MAP=t.PAINT_COLOR_MAP=t.PAINT_COLOR=t.CUSTOM_TYPE_KEY=t.DATE_TYPE_KEY=t.TEXT_TYPE_KEY=t.NUMBER_TYPE_KEY=t.COND_REPORT_MAP=t.COND_TYPE_MAP=t.CUSTEOM_TYPE=t.DATE_TYPE=t.TEXT_TYPE=t.NUMBER_TYPE=t.COND_TYPE=void 0;var a=r(n(9)),i=r(n(63));t.shouldElementShow=function(e){var t=!1;switch(!0,e){case o.default.NUMBER_BETWEEN:case o.default.NUMBER_NOT_BETWEEN:t=!0;break;default:t=!1}return{inputOneShow:!0,inputTwoShow:t}};var o=r(n(315));function r(e){return e&&e.__esModule?e:{default:e}}t.COND_TYPE=o.default;var l=t.NUMBER_TYPE=void 0;!function(e){e[e.GREATER=o.default.NUMBER_GREATER]="GREATER",e[e.GREATER_THAN_EQ=o.default.NUMBER_GREATER_THAN_EQ]="GREATER_THAN_EQ",e[e.LESS=o.default.NUMBER_LESS]="LESS",e[e.LESS_THAN_EQ=o.default.NUMBER_LESS_THAN_EQ]="LESS_THAN_EQ",e[e.EQ=o.default.NUMBER_EQ]="EQ",e[e.NOT_EQ=o.default.NUMBER_NOT_EQ]="NOT_EQ",e[e.BETWEEN=o.default.NUMBER_BETWEEN]="BETWEEN",e[e.NOT_BETWEEN=o.default.NUMBER_NOT_BETWEEN]="NOT_BETWEEN"}(l||(t.NUMBER_TYPE=l={}));var s=t.TEXT_TYPE=void 0;!function(e){e[e.CONTAINS=o.default.TEXT_CONTAINS]="CONTAINS",e[e.NOT_CONTAINS=o.default.TEXT_NOT_CONTAINS]="NOT_CONTAINS",e[e.STARTS_WITH=o.default.TEXT_STARTS_WITH]="STARTS_WITH",e[e.ENDS_WITH=o.default.TEXT_ENDS_WITH]="ENDS_WITH",e[e.EQ=o.default.TEXT_EQ]="EQ",e[e.BLANK=o.default.BLANK]="BLANK",e[e.NOT_BLANK=o.default.NOT_BLANK]="NOT_BLANK"}(s||(t.TEXT_TYPE=s={}));var u=t.DATE_TYPE=void 0;!function(e){e[e.EQ=o.default.DATE_EQ]="EQ",e[e.BEFORE=o.default.DATE_BEFORE]="BEFORE",e[e.AFTER=o.default.DATE_AFTER]="AFTER",e[e.ON_OR_BEFORE=o.default.DATE_ON_OR_BEFORE]="ON_OR_BEFORE",e[e.ON_OR_AFTER=o.default.DATE_ON_OR_AFTER]="ON_OR_AFTER",e[e.BETWEEN=o.default.NUMBER_BETWEEN]="BETWEEN",e[e.NOT_BETWEEN=o.default.DATE_NOT_BETWEEN]="NOT_BETWEEN"}(u||(t.DATE_TYPE=u={}));var c=t.CUSTEOM_TYPE=void 0;!function(e){e[e.FORMULA=o.default.CUSTOM_FORMULA]="FORMULA"}(c||(t.CUSTEOM_TYPE=c={}));t.COND_TYPE_MAP=new i.default([[o.default.NUMBER_GREATER,"\u5927\u4e8e"],[o.default.NUMBER_GREATER_THAN_EQ,"\u5927\u4e8e\u6216\u7b49\u4e8e"],[o.default.NUMBER_LESS,"\u5c0f\u4e8e"],[o.default.NUMBER_LESS_THAN_EQ,"\u5c0f\u4e8e\u6216\u7b49\u4e8e"],[o.default.NUMBER_EQ,"\u7b49\u4e8e"],[o.default.NUMBER_NOT_EQ,"\u4e0d\u7b49\u4e8e"],[o.default.NUMBER_BETWEEN,"\u4ecb\u4e8e"],[o.default.NUMBER_NOT_BETWEEN,"\u4e0d\u4ecb\u4e8e"],[o.default.TEXT_CONTAINS,"\u6587\u672c\u5305\u542b"],[o.default.TEXT_NOT_CONTAINS,"\u6587\u672c\u4e0d\u5305\u542b"],[o.default.TEXT_STARTS_WITH,"\u6587\u672c\u5f00\u59cb\u4e8e"],[o.default.TEXT_ENDS_WITH,"\u6587\u672c\u7ed3\u5c3e\u4e3a"],[o.default.TEXT_EQ,"\u6587\u672c\u76f8\u7b26"],[o.default.TEXT_IS_EMAIL,"\u90ae\u4ef6"],[o.default.TEXT_IS_URL,"\u8d85\u94fe\u63a5"],[o.default.DATE_DURING,"\u65e5\u671f\u4ecb\u4e8e"],[o.default.DATE_EQ,"\u65e5\u671f\u4e3a"],[o.default.DATE_BEFORE,"\u65e5\u671f\u65e9\u4e8e"],[o.default.DATE_AFTER,"\u65e5\u671f\u665a\u4e8e"],[o.default.DATE_ON_OR_BEFORE,"\u65e5\u671f\u4e0d\u665a\u4e8e"],[o.default.DATE_ON_OR_AFTER,"\u65e5\u671f\u4e0d\u65e9\u4e8e"],[o.default.DATE_BETWEEN,"\u65e5\u671f\u4ecb\u4e8e"],[o.default.DATE_NOT_BETWEEN,"\u65e5\u671f\u4e0d\u4ecb\u4e8e"],[o.default.DATE_IS_VALID,"\u5408\u6cd5\u65e5\u671f"],[o.default.ONE_OF_RANGE,""],[o.default.ONE_OF_LIST,""],[o.default.BLANK,"\u7a7a\u767d\u5355\u5143\u683c"],[o.default.NOT_BLANK,"\u6709\u5185\u5bb9\u7684\u5355\u5143\u683c"],[o.default.CUSTOM_FORMULA,"\u81ea\u5b9a\u4e49\u516c\u5f0f"],[o.default.BOOLEAN,""],[o.default.ERROR,""],[o.default.NOT_ERROR,""]]),t.COND_REPORT_MAP=new i.default([[o.default.NUMBER_GREATER,"num_greater"],[o.default.NUMBER_GREATER_THAN_EQ,"num_greater_equal"],[o.default.NUMBER_LESS,"num_less"],[o.default.NUMBER_LESS_THAN_EQ,"num_less_equal"],[o.default.NUMBER_EQ,"num_equal"],[o.default.NUMBER_NOT_EQ,"num_not_equal"],[o.default.NUMBER_BETWEEN,"num_between"],[o.default.NUMBER_NOT_BETWEEN,"num_not_between"],[o.default.TEXT_CONTAINS,"text_contain"],[o.default.TEXT_NOT_CONTAINS,"text_not_contain"],[o.default.TEXT_STARTS_WITH,"text_start_with"],[o.default.TEXT_ENDS_WITH,"text_end_with"],[o.default.TEXT_EQ,"text_equal"],[o.default.TEXT_IS_EMAIL,"text_email"],[o.default.TEXT_IS_URL,"text_url"],[o.default.DATE_DURING,""],[o.default.DATE_EQ,"date_equal"],[o.default.DATE_BEFORE,"date_before"],[o.default.DATE_AFTER,"date_after"],[o.default.DATE_ON_OR_BEFORE,"date_not_after"],[o.default.DATE_ON_OR_AFTER,"date_not_before"],[o.default.DATE_BETWEEN,"date_between"],[o.default.DATE_NOT_BETWEEN,"date_not_between"],[o.default.DATE_IS_VALID,"date_valid"],[o.default.ONE_OF_RANGE,""],[o.default.ONE_OF_LIST,""],[o.default.BLANK,"text_blank"],[o.default.NOT_BLANK,"text_not_blank"],[o.default.CUSTOM_FORMULA,"custom_formual"],[o.default.BOOLEAN,""],[o.default.ERROR,""],[o.default.NOT_ERROR,""]]);function d(e){return(0,a.default)(e).filter(function(e){return Number(e)}).map(function(e){return parseInt(e,10)})}t.NUMBER_TYPE_KEY=d(l),t.TEXT_TYPE_KEY=d(s),t.DATE_TYPE_KEY=d(u),t.CUSTOM_TYPE_KEY=d(c),t.PAINT_COLOR=["ffbfbf","b9e19e","dbdbdb"],t.PAINT_COLOR_MAP=["\u7ea2\u8272","\u7eff\u8272","\u7070\u8272"],t.PAINT_COLOR_REQPRT_MAP=["rule_panel_format_red","rule_panel_format_green","rule_panel_format_grey"]},1704:function(e,t,n){"use strict";var a=n(1687),i={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},o={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},l={};function s(e){return a.isMemo(e)?r:l[e.$$typeof]||i}l[a.ForwardRef]={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0};var u=Object.defineProperty,c=Object.getOwnPropertyNames,d=Object.getOwnPropertySymbols,p=Object.getOwnPropertyDescriptor,f=Object.getPrototypeOf,h=Object.prototype;e.exports=function e(t,n,a){if("string"!==typeof n){if(h){var i=f(n);i&&i!==h&&e(t,i,a)}var r=c(n);d&&(r=r.concat(d(n)));for(var l=s(t),m=s(n),v=0;v<r.length;++v){var g=r[v];if(!o[g]&&(!a||!a[g])&&(!m||!m[g])&&(!l||!l[g])){var b=p(n,g);try{u(t,g,b)}catch(y){}}}return t}return t}},1705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a="function"===typeof Symbol&&Symbol.for,i=a?Symbol.for("react.element"):60103,o=a?Symbol.for("react.portal"):60106,r=a?Symbol.for("react.fragment"):60107,l=a?Symbol.for("react.strict_mode"):60108,s=a?Symbol.for("react.profiler"):60114,u=a?Symbol.for("react.provider"):60109,c=a?Symbol.for("react.context"):60110,d=a?Symbol.for("react.async_mode"):60111,p=a?Symbol.for("react.concurrent_mode"):60111,f=a?Symbol.for("react.forward_ref"):60112,h=a?Symbol.for("react.suspense"):60113,m=a?Symbol.for("react.memo"):60115,v=a?Symbol.for("react.lazy"):60116;function g(e){if("object"===typeof e&&null!==e){var t=e.$$typeof;switch(t){case i:switch(e=e.type){case d:case p:case r:case s:case l:case h:return e;default:switch(e=e&&e.$$typeof){case c:case f:case u:return e;default:return t}}case v:case m:case o:return t}}}function b(e){return g(e)===p}t.typeOf=g,t.AsyncMode=d,t.ConcurrentMode=p,t.ContextConsumer=c,t.ContextProvider=u,t.Element=i,t.ForwardRef=f,t.Fragment=r,t.Lazy=v,t.Memo=m,t.Portal=o,t.Profiler=s,t.StrictMode=l,t.Suspense=h,t.isValidElementType=function(e){return"string"===typeof e||"function"===typeof e||e===r||e===p||e===s||e===l||e===h||"object"===typeof e&&null!==e&&(e.$$typeof===v||e.$$typeof===m||e.$$typeof===u||e.$$typeof===c||e.$$typeof===f)},t.isAsyncMode=function(e){return b(e)||g(e)===d},t.isConcurrentMode=b,t.isContextConsumer=function(e){return g(e)===c},t.isContextProvider=function(e){return g(e)===u},t.isElement=function(e){return"object"===typeof e&&null!==e&&e.$$typeof===i},t.isForwardRef=function(e){return g(e)===f},t.isFragment=function(e){return g(e)===r},t.isLazy=function(e){return g(e)===v},t.isMemo=function(e){return g(e)===m},t.isPortal=function(e){return g(e)===o},t.isProfiler=function(e){return g(e)===s},t.isStrictMode=function(e){return g(e)===l},t.isSuspense=function(e){return g(e)===h}},1706:function(e,t,n){"use strict";e.exports=function(e,t,n,a,i,o,r,l){if(!e){var s;if(void 0===t)s=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var u=[n,a,i,o,r,l],c=0;(s=new Error(t.replace(/%s/g,function(){return u[c++]}))).name="Invariant Violation"}throw s.framesToPop=1,s}}},1707:function(e,t,n){"use strict";(function(e,a){var i,o=n(1709);i="undefined"!==typeof self?self:"undefined"!==typeof window?window:"undefined"!==typeof e?e:a;var r=Object(o.a)(i);t.a=r}).call(this,n(199),n(1708)(e))},1708:function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},1709:function(e,t,n){"use strict";function a(e){var t,n=e.Symbol;return"function"===typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}n.d(t,"a",function(){return a})},1710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapDispatchToProps=void 0;var a,i=n(14),o=(a=i)&&a.__esModule?a:{default:a},r=n(1744),l=n(1680);var s={resetState:function(){return{type:r.ACTION.RESET_STATE}},setRulesNumber:function(e){return{type:r.ACTION.SET_RULES_NUMBER,payload:{rulesNumber:e}}},setLastEditRuleId:function(e){return{type:r.ACTION.SET_LAST_RULE_ID,payload:{lastEditRuleId:e}}},switchEditorManage:function(){return{type:r.ACTION.SWITCH_EDITOR_MANAGE}},setEditorStatus:function(e){return{type:r.ACTION.SET_EDITOR_STATUS,payload:{editorIsShow:e}}},setManageStatus:function(e){return{type:r.ACTION.SET_MANAGE_STATUS,payload:{manageIsShow:e}}},setPaintColor:function(e){return{type:r.ACTION.SET_PAINT_COLOR,payload:{paintColor:e}}},setRange:function(e){return{type:r.ACTION.SET_RANGE,payload:{ranges:e}}},setConditionType:function(e){return{type:r.ACTION.SET_CONDITION_TYPE,payload:{type:e}}},setInputOneStatus:function(e){return{type:r.ACTION.SET_INPUTONE_STATUS,payload:{show:e}}},setInputTwoStatus:function(e){return{type:r.ACTION.SET_INPUTTWO_STATUS,payload:{show:e}}},setInputOneValue:function(e){return{type:r.ACTION.SET_INPUTONE_VALUE,payload:{value:e}}},setInputTwoValue:function(e){return{type:r.ACTION.SET_INPUTTWO_VALUE,payload:{value:e}}},resetEditor:function(){return{type:r.ACTION.RESET_EDITOR}},setEditor:function(e){return{type:r.ACTION.SET_EDITOR,payload:e}}};t.default=s;t.mapDispatchToProps=function(e){return(0,l.bindActionCreators)((0,o.default)({},s),e)}},1714:function(e,t,n){"use strict";var a=this&&this.__assign||function(){return(a=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var o=i(n(46));t.renderChildren=function(e,t,n,i,r){var l=e.children,s=e.options||[],u=e.disabled,c=a({paddingBottom:22},r);return s.length?s.map(function(e,r){return"string"===typeof e?o.createElement(i,{key:r,value:e,onChange:n,checked:-1!==t.indexOf(e),disabled:u,style:a({},c)},e):o.createElement(i,a({},e,{key:r,value:e.value,onChange:n,checked:-1!==t.indexOf(e.value),disabled:e.disabled||u,style:a({},c,e.style)}),e.label)}):o.Children.map(l,function(e){return o.cloneElement(e,{checked:-1!==t.indexOf(e.props.value),onChange:n,disabled:e.props.disabled||u,style:a({},c,e.props.style)})})}},1715:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1722));t.Dropdown=i.default,n(197).injectStyle(".dui-dropdown-disabled{opacity:.6}.dui-dropdown{position:relative;display:inline-block;-webkit-tap-highlight-color:transparent}.dui-dropdown-content{position:absolute;z-index:9999;-webkit-transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,visibility,-webkit-transform;transition-property:opacity,transform,visibility;transition-property:opacity,transform,visibility,-webkit-transform;-webkit-transition-timing-function:cubic-bezier(.4,0,.2,1);transition-timing-function:cubic-bezier(.4,0,.2,1);-webkit-tap-highlight-color:transparent}.dui-dropdown-content-visible{-webkit-transition-duration:.24s;transition-duration:.24s;visibility:visible;opacity:1;-webkit-transform:scale3d(1,1,1) translate(0);transform:scale3d(1,1,1) translate(0)}.dui-dropdown-content-hidden{-webkit-transition-duration:.12s;transition-duration:.12s;visibility:hidden}.dui-dropdown-content-hidden.dui-dropdown-content-bottom{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(-20px);transform:scale3d(1,1,1) translateY(-20px)}.dui-dropdown-content-hidden.dui-dropdown-content-top{opacity:0;-webkit-transform:scale3d(1,1,1) translateY(20px);transform:scale3d(1,1,1) translateY(20px)}");var o=a(n(1678));i.default.Keep=o.default,t.default=i.default},1721:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=n(1714),c=n(171),d=o(n(1699)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={values:t.props.defaultValues||[]},t.handleSingleChange=function(e,n){if(!t.props.disabled){var a=t.state.values,i=[];a.indexOf(n.target.value)>=0&&!e?(i=a.filter(function(e){return e!==n.target.value}),t.setState({values:i}),t.props.onChange(i,n)):-1===a.indexOf(n.target.value)&&e&&(i=a.concat(n.target.value),t.setState({values:i}),t.props.onChange(i,n))}},t}return a(t,e),t.getDerivedStateFromProps=function(e,t){return"values"in e?{values:e.values}:null},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,a=e.style,i=e.itemStyle,o=s.default(t,n);return r.createElement("div",{className:o,style:a},u.renderChildren(this.props,this.state.values,this.handleSingleChange,d.default,i))},t}(r.Component);t.default=p,p.defaultProps={prefixCls:"dui-checkbox-group",disabled:!1,onChange:c.emptyFn},p.propTypes={prefixCls:l.string,style:l.object,className:l.string,options:l.array,disabled:l.bool,values:l.array,children:l.node,defaultValues:l.array,onChange:l.func,itemStyle:l.object}},1722:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var l=o(n(46)),s=r(n(123)),u=o(n(141)),c=r(n(142)),d=n(171),p=r(n(1686)),f=n(1690),h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootDomRef=l.createRef(),t.dropContentRef=l.createRef(),t.state={visible:!1},t.hide=function(e){if(e&&e.nativeEvent){var n=e.nativeEvent;if(n._dui_dropdown_keep)return void delete n._dui_dropdown_keep}t.isVisible()&&t.setState({visible:!1},function(){t.props.onVisibleChange(!1)})},t.toggle=function(){if(!t.props.disabled){var e=!t.isVisible();t.setState({visible:e},function(){t.props.onVisibleChange(e)})}},t}return a(t,e),t.getDerivedStateFromProps=function(e,t){return e.disabled?{visible:!1}:null},t.prototype.componentDidMount=function(){this.forceUpdate(),window.addEventListener("resize",this.hide)},t.prototype.componentWillUnmount=function(){window.removeEventListener("resize",this.hide)},t.prototype.isVisible=function(){var e=this.props,t=e.visible;if(e.disabled)return!1;var n=this.state.visible;return"boolean"===typeof t?t:n},t.prototype.calcDropContentMetric=function(){var e=this.rootDomRef.current,t=this.dropContentRef.current;if(!e||!t)return{left:"0",top:"0"};var n,a=this.props,i=a.placement,o=a.alignment,r=a.matchWidth,l=e.getBoundingClientRect(),s=l.width,u=l.bottom,c=l.top,d=l.left,p=l.right,f=t.getBoundingClientRect(),h=f.width,m=f.height,v=window.pageXOffset,g=window.pageYOffset;return r?(n=s,v+=d):"left"===o?v+=d:"right"===o&&(v+=p-h),"top"===i?g+=c-m-5:"bottom"===i&&(g+=u+5),{left:v+"px",top:g+"px",width:n&&n+"px"}},t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,a=t.className,o=t.style,r=t.children,u=t.dropContent,d=t.disabled,h=t.dropContentStyle,m=t.placement,v=this.isVisible(),g=c.default(n,a,((e={})[n+"-disabled"]=d,e)),b=c.default(n+"-content",n+"-content-"+m,n+"-content-"+(v?"visible":"hidden")),y=this.calcDropContentMetric(),E=this.context.zIndex;return l.createElement(p.default,{action:this.hide,className:g,style:o,domRef:this.rootDomRef},l.createElement("div",{onClick:this.toggle},r),l.createElement(f.DropdownContext.Provider,{value:{visible:v,zIndex:E+1}},s.default.createPortal(l.createElement("div",{className:b,style:i({zIndex:E},y,h),onClick:this.hide,ref:this.dropContentRef},u),document.body)))},t.contextType=f.DropdownContext,t}(l.Component);t.default=h,h.defaultProps={prefixCls:"dui-dropdown",alignment:"left",matchWidth:!1,disabled:!1,onVisibleChange:d.emptyFn,placement:"bottom"},h.propTypes={prefixCls:u.string,style:u.object,className:u.string,dropContent:u.element,alignment:u.string,matchWidth:u.bool,disabled:u.bool,onVisibleChange:u.func,visible:u.bool,dropContentStyle:u.object,placement:u.oneOf(["top","bottom"])}},1723:function(e,t,n){e.exports={default:n(1724),__esModule:!0}},1724:function(e,t,n){n(762),e.exports=n(34).Object.getOwnPropertySymbols},1725:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(1680),o=n(1831),r=(a=o)&&a.__esModule?a:{default:a};var l=(0,i.createStore)(r.default);t.default=l},1726:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.dataRule2UIRule=l,t.getAllRulesWithSelection=function(e){return e.plugins.conditionalFormat.getRuleListWithCurrentSelection()},t.getAllRulesWithSelectionForUI=function(e){return e.plugins.conditionalFormat.getRuleListWithCurrentSelection().map(function(e){return l(e)}).filter(function(e){return null!==e})},t.getRuleById=s,t.getRuleIndexByRuleId=function(e,t){var n=s(e,t);if(!n)return-1;return n.index},t.condFormatReport=function(e){r.default.tdwReport({opername:"doc_excel_editor",module:"excel_con_format",action:e})};var a,i=n(440),o=n(8),r=(a=o)&&a.__esModule?a:{default:a};function l(e){var t=e.rule.booleanConditionalFormat;if(!t)return null;var n=t.condition,a=t.format,o=n.values,r=o&&o[0]&&o[0].userEnteredValue||"",l=o&&o[1]&&o[1].userEnteredValue||"",s=a.getBackgroundColor(),u="";return s&&(u=s.toHex().slice(1)),{ruleId:e.id,ranges:e.rule.ruleRanges.map(function(e){return(0,i.range2RelativeHex)(e)}).join(","),ruleIndex:e.index,booleanCondition:{condition:{conditionType:n.type,inputOne:r,inputTwo:l},format:{paintColor:u}}}}function s(e,t){var n=e.spreadsheet.activeSheet.getConditionalFormatRule();return n&&n.getConditionalFormatRuleWithIndexById(t)}},1736:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),u=r(n(141)),c=l(n(142)),d=n(171),p=n(1775),f=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.leftIconRef=s.createRef(),t.rightIconsRef=s.createRef(),t.state={value:t.props.defaultValue},t.handleChange=function(e){if(!t.props.disabled){var n=e.target.value;t.props.onChange(n,e),t.setState({value:n})}},t.preventLoseFocus=function(e){e.preventDefault()},t.handleClear=function(){t.setState({value:""},function(){t.props.onChange("")})},t}return a(t,e),t.prototype.componentDidMount=function(){this.forceUpdate()},t.prototype.getIconPaddings=function(){var e=this.leftIconRef.current,t=this.rightIconsRef.current,n={};return e&&(n.paddingLeft=e.getBoundingClientRect().width+2+"px"),t&&(n.paddingRight=t.getBoundingClientRect().width+2+"px"),n},t.prototype.renderSingleIcon=function(e){var t,n=e.prop,a=e.description,i=e.handler,o=e.ref,r=this.props,l=r.prefixCls,u=r.underline,d=c.default(l+"-icon",((t={})[l+"-icon-"+a]=a,t[l+"-icon-clickable"]=i,t[l+"-icon-underline"]=u,t));return n?s.createElement("div",{className:d,onMouseDown:this.preventLoseFocus,onClick:i,ref:o},"string"===typeof n?s.createElement("span",{className:l+"-icon-img",style:{backgroundImage:"url("+n+")"}}):n):null},t.prototype.renderRightIcons=function(e){var t,n,a=this.props,i=a.prefixCls,o=a.showClear,r=a.icon,l=a.onClickIcon,u=a.underline,d=c.default(i+"-clear",i+"-icon-clickable",((t={})[i+"-clear-visible"]=e,t[i+"-icon"]=!u,t[i+"-clear-underline"]=u,t)),p=c.default(i+"-icon-container",((n={})[i+"-icon-container-underline"]=u,n));return o||r?s.createElement("div",{className:p,ref:this.rightIconsRef},o?s.createElement("span",{className:d,onMouseDown:this.preventLoseFocus,onClick:this.handleClear}):null,this.renderSingleIcon({prop:r,handler:l})):null},t.prototype.render=function(){var e,t,n=this.props,a=n.prefixCls,r=n.className,l=n.style,u=n.disabled,d=n.underline,p=(n.icon,n.leftIcon),f=(n.onClickIcon,n.onClickLeftIcon),h=(n.onChange,n.inputStyle),m=(n.showClear,n.value),v=(n.defaultValue,n.inputRef),g=o(n,["prefixCls","className","style","disabled","underline","icon","leftIcon","onClickIcon","onClickLeftIcon","onChange","inputStyle","showClear","value","defaultValue","inputRef"]),b=this.state.value,y=this.context.status,E="string"===typeof m?m:b,_=c.default(a,r,((e={})[a+"-disabled"]=u,e)),w=c.default(a+"-input",a+"-input-"+y,((t={})[a+"-input-underline"]=d,t)),T=c.default(a+"-indicator",a+"-indicator-"+y),I=!(!E||u);return s.createElement("div",{className:_,style:l},this.renderSingleIcon({prop:p,description:"left",handler:f,ref:this.leftIconRef}),s.createElement("input",i({className:w,style:i({},this.getIconPaddings(),h),onChange:this.handleChange,value:E,disabled:u,ref:v},g)),d?s.createElement("span",{className:T}):null,this.renderRightIcons(I))},t.contextType=p.FormItemContext,t}(s.Component);t.default=f,f.defaultProps={prefixCls:"dui-input",onChange:d.emptyFn,showClear:!1,defaultValue:""},f.propTypes={prefixCls:u.string,style:u.object,className:u.string,disabled:u.bool,underline:u.bool,icon:u.node,onClickIcon:u.func,leftIcon:u.node,onClickLeftIcon:u.func,inputStyle:u.object,showClear:u.bool,value:u.string,defaultValue:u.string}},1737:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=o(n(1689)),c=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return a(t,e),t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,a=e.style,i=e.children,o=e.value,l=e.disabled,c=s.default(t,n);return r.createElement(u.default.Item,{className:c,style:a,id:o,disabled:l},i)},t}(r.Component);t.default=c,c.defaultProps={prefixCls:"dui-option",disabled:!1},c.propTypes={prefixCls:l.string,style:l.object,className:l.string,value:l.string,disabled:l.bool}},1738:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.tableIconUrl="data:image/svg+xml;base64,PHN2ZyBpZD0i5Zu+5bGCXzIiIGRhdGEtbmFtZT0i5Zu+5bGCIDIiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyIgdmlld0JveD0iMCAwIDIyIDIyIj48ZGVmcz48c3R5bGU+LmNscy0xe2ZpbGw6IzdkN2Q3ZDt9PC9zdHlsZT48L2RlZnM+PHRpdGxlPldkPC90aXRsZT48cGF0aCBjbGFzcz0iY2xzLTEiIGQ9Ik04LDZWOUg1VjZIOE05LDVINHY1SDlWNUg5WiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEyLDZWOUg5VjZoM20xLTFIOHY1aDVWNWgwWiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTE2LDZWOUgxM1Y2aDNtMS0xSDEydjVoNVY1aDBaIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNOCwxMHYzSDVWMTBIOE05LDlINHY1SDlWOUg5WiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTEyLDEwdjNIOVYxMGgzbTEtMUg4djVoNVY5aDBaIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTYsMTB2M0gxM1YxMGgzbTEtMUgxMnY1aDVWOWgwWiIvPjxwYXRoIGNsYXNzPSJjbHMtMSIgZD0iTTgsMTR2M0g1VjE0SDhtMS0xSDR2NUg5VjEzSDlaIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTIsMTR2M0g5VjE0aDNtMS0xSDh2NWg1VjEzaDBaIi8+PHBhdGggY2xhc3M9ImNscy0xIiBkPSJNMTYsMTR2M0gxM1YxNGgzbTEtMUgxMnY1aDVWMTNoMFoiLz48L3N2Zz4="},1739:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),u=r(n(141)),c=l(n(142)),d=n(171),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={checked:!!t.props.defaultChecked},t.handleChange=function(e){var n=t.props;n.disabled||("checked"in n||t.setState({checked:e.target.checked}),n.onChange(e.target.checked,{target:i({},n,{checked:e.target.checked}),stopPropagation:e.stopPropagation.bind(e),preventDefault:e.preventDefault.bind(e),nativeEvent:e.nativeEvent}))},t}return a(t,e),t.prototype.render=function(){var e,t=this.props,n=t.prefixCls,a=t.className,r=t.style,l=t.children,u=t.disabled,d=t.hollow,p=o(t,["prefixCls","className","style","children","disabled","hollow"]),f="checked"in this.props?this.props.checked:this.state.checked,h=c.default(n,a,n+"-"+(d?"hollow":"normal"),((e={})[n+"-multi-line"]=s.Children.count(l)>1,e[n+"-checked"]=f,e[n+"-disabled"]=u,e));return s.createElement("div",{className:h,style:r},s.createElement("span",{className:n+"-icon"}),s.createElement("div",{className:n+"-label"},l),s.createElement("input",i({},p,{type:"radio",className:n+"-input",onChange:this.handleChange})))},t}(s.Component);t.default=p,p.defaultProps={prefixCls:"dui-radio",onChange:d.emptyFn,hollow:!0},p.propTypes={prefixCls:u.string,style:u.object,className:u.string,onChange:u.func,hollow:u.bool}},1740:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(16)),i=l(n(25)),o=l(n(9));t.addClick=function(e,t){return e&&t&&e.addEventListener("click",t),e},t.objectMap=function(e,t){return(0,o.default)(e).map(function(n,a){return t(e[n],n)})},t.isString=s,t.isObject=u,t.isElement=c,t.generator=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"div";return function(){var n=void 0,a=void 0,i=void 0;for(n=arguments.length,a=Array(n),i=0;i<n;i++)a[i]=arguments[i];var r=document.createElement(t),l=u(e)?e:{class:e};return 1==l.class&&l.id&&(l.class=l.id),1!=l.class||l.id||(l.class=""),(0,o.default)(l).forEach(function(e){r.setAttribute(e,l[e].replace(/\r\n/g,"").replace(/\n/g,"").replace(/\s\s/g,""))}),a.forEach(function(e){c(e)?r.appendChild(e):"img"===t.toLowerCase()&&s(e)?r.setAttribute("src",e):r.innerText=e}),r}},t.cloneObj=d,t._parseDecimalDigits=function(e){return SpreadsheetApp.view.plugins.customFormatPanel.formatMap.parseDecimalDigits(e)},t._parseCurrencySymbol=function(e){var t=e.split(";");if(1==t.length)return SpreadsheetApp.view.plugins.customFormatPanel.formatMap.parseCurrencySymbol(t[0]);var n=SpreadsheetApp.view.plugins.customFormatPanel.formatMap.parseCurrencySymbol(t[0]),a=SpreadsheetApp.view.plugins.customFormatPanel.formatMap.parseCurrencySymbol(t[1]);return n==a&&n||""},t._formatChange=function(e,t){return SpreadsheetApp.view.plugins.customFormatPanel.formatMap.formatChange(e,t)},t._getCustomFmtList=function(){return SpreadsheetApp.view.plugins.customFormatPanel.formatMap.getCustomFmtList()||[]},t._unEscapeCssSequence=function(e){return(SpreadsheetApp.view.plugins.customFormatPanel.formatMap.unEscapeCssSequence(e)||e).replace(/"/g,"").replace(/'/g,"")},t._parseHasThousandSep=function(e){return!!e.match(/#,##/g)},t._generateDecimalPart=p,t._generateDecimalWithDigits=f,t._generateCurrencyList=function(e,t,n){if(!e||!e.length)return[];return e.map(function(e){var a=d(e),i=a.label;return i=(i=f(i,t)).replace(/\$|\xa5|\uffe5|HK\$/g,n||""),a.label=i,a})},t._generateNumberFormatData=function(e,t,n){var e=e||"";if(n){var a=e.split(";");a.forEach(function(e,t,n){n[t]=e.replace(/(#,##)?0/,"#,##0")}),e=a.join(";")}else e=e.replace(/#,##/g,"");var i=t&&t>0?"."+new Array(t+1).join("0"):"";return e=e.match(/\.0*/g)?e.replace(/\.0*/g,i):e.replace(/0/g,"0"+i)},t._generateNumberLabel=h,t._generateNumberList=function(e,t,n){if(!e||!e.length)return[];return e.map(function(e){return h(e,t,n)})},t._generateCurrencyFormatData=function(e,t,n){var e=e||"",a=t&&t>0?"."+new Array(t+1).join("0"):"";e=e.replace(/\.0*/g,a);var i=n;switch(n){case"$":i="\\"+n;break;case"\xa5":case"\uffe5":i='"'+n+'"';break;case"HK$":i="[$HK$-C04]"}return e=e.replace(/\xa5/g,i)},t._generatePercentageFormatData=function(e){return"0"+(e&&e>0?"."+new Array(e+1).join("0"):"")+"%"},t._generateExponentialFormatData=function(e){return"0."+(e&&e>0?new Array(e+1).join("0"):"")+"E+00"},t.appendCustomFormatList=function(e){for(var t=r.formatMap.custom,n=!1,a=0;a<t.length;a++){var i=t[a];if(i.formatData===e){n=!0;break}}n||t.push({label:e,formatData:e})};var r=n(1741);function l(e){return e&&e.__esModule?e:{default:e}}function s(e){return"String"===Object.prototype.toString.call(e).slice(8,-1)}function u(e){return"Object"===Object.prototype.toString.call(e).slice(8,-1)}function c(e){return e&&1===e.nodeType&&e&&"object"==("undefined"===typeof e?"undefined":(0,i.default)(e))&&Object.prototype.toString.call(e).indexOf("Element")>-1}function d(e){return e?JSON.parse((0,a.default)(e)):e}function p(e){if(!e||"number"!==typeof e||e<0)return"";var t="9876543210",n=t.length,a=parseInt(e/n),i=e%n,o=String(new Array(a+1).join(t));return o=t.substring(n-i,n)+o}function f(e,t){if(!e||"string"!==typeof e)return e;var n=p(t);return e.replace(/(\D*)([\d|\,]*)(\.\d*)?(\D*)/,function(e,a,i,o,r){var l="";return l+=a||"",l+=i||"0",t>0&&(l+="."+n),l+=r||""})||""}function h(e,t,n){var a=f(e.label,t);return e.label=n?a.replace(/1(,)?234/,"1,234"):a.replace(/1(,)?234/,"1234"),e}},1741:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.dialogHtml='\n<div id="custom-dataformat-dialog-container" class="pad-ui-dialog-mask" style="display: none;">\n  <div id="custom-dataformat-dialog" class="pad-ui-dialog common-web-popup-boxshadow">\n    <div class="pad-ui-dialog-close custom-dataformat-dialog-close"></div>\n    <div class="pad-ui-dialog-header cdd-header">\n      <span class="pad-ui-dialog-title">\u8bbe\u7f6e\u5355\u5143\u683c\u683c\u5f0f</span>\n    </div>\n    <div class="pad-ui-dialog-content cdd-body">\n      \x3c!-- \u6570\u636e\u683c\u5f0f\u7c7b\u522b --\x3e\n      <div class="cdd-body-content">\n          <div class="cdd-body-content-number">\n              <div class="cdd-body-content-number-left">\n              </div>\n              <div class=\'cdd-body-content-number-right\'>\n              </div>\n          </div>\n          <div class="cdd-body-content-tips"></div>\n      </div>\n    </div>\n    <div class="cdd-footer">\n      <div class="btn pad-ui-btn  pad-ui-btn-normal pad-ui-btn-white custom-dataformat-dialog-cancel-btn">\u53d6\u6d88</div>\n      <div class="btn pad-ui-btn pad-ui-btn-normal pad-ui-btn-blue custom-dataformat-dialog-confirm-btn">\u786e\u5b9a</div>\n    </div>\n  </div>\n</div>\n',t.defaultPromptHtml='\n  <div class="ac-prompt-text">\n      \u5e38\u89c4\u5355\u5143\u683c\u683c\u5f0f\u4e0d\u5305\u542b\u4efb\u4f55\u7279\u5b9a\u7684\u6570\u5b57\u683c\u5f0f\u3002\n  </div>\n',t.textPromptHtml='\n  <div class="ac-prompt-text">\n      \u5728\u6587\u672c\u5355\u5143\u683c\u683c\u5f0f\u4e2d\uff0c\u6570\u5b57\u4f5c\u4e3a\u6587\u672c\u5904\u7406\u3002\u5355\u5143\u683c\u663e\u793a\u7684\u5185\u5bb9\u4e0e\u8f93\u5165\u7684\u5185\u5bb9\u5b8c\u5168\u4e00\u81f4\u3002\n  </div>\n',t.fmtCategory=[{type:"auto",label:"\u5e38\u89c4"},{type:"number",label:"\u6570\u503c"},{type:"currency",label:"\u8d27\u5e01"},{type:"date",label:"\u65e5\u671f"},{type:"time",label:"\u65f6\u95f4"},{type:"percent",label:"\u767e\u5206\u6bd4"},{type:"fraction",label:"\u5206\u6570"},{type:"scientific",label:"\u79d1\u5b66\u8bb0\u6570"},{type:"text",label:"\u6587\u672c"},{type:"special",label:"\u7279\u6b8a"},{type:"custom",label:"\u81ea\u5b9a\u4e49"}],t.symbolList=[{label:"\u65e0",value:""},{label:"\xa5",value:"\xa5"},{label:"$",value:"$"},{label:"HK$",value:"HK$"}],t.fmtTablist={number:"\u6570\u5b57"},t.formatMap={currency:[{label:"(\xa51234.10)",formatData:"\xa5#,##0.00_);[Red]\\(\xa5#,##0.00\\)",color:"red"},{label:"(\xa51234.10)",formatData:"\xa5#,##0.00_);\\(\xa5#,##0.00\\)"},{label:"\xa51234.10",formatData:"\xa5#,##0.00;[Red]\xa5#,##0.00",color:"red"},{label:"\xa5-1234.10",formatData:"\xa5#,##0.00"},{label:"\xa5-1234.10",formatData:"\xa5#,##0.00;[Red]-\xa5#,##0.00",color:"red"}],number:[{label:"(1234.10)",formatData:"0.00_);[Red]\\(0.00\\)",color:"red"},{label:"(1234.10)",formatData:"0.00_);\\(0.00\\)"},{label:"1234.10",formatData:"0.00;[Red]0.00",color:"red"},{label:"-1234.10",formatData:"0.00_ "},{label:"-1234.10",formatData:"0.00_ ;[Red]\\-0.00\\ ",color:"red"}],date:[{label:"*2018/4/18",formatData:"yyyy/m/d"},{label:"*2018\u5e744\u670818\u65e5 \u661f\u671f\u4e09",formatData:"[$-F800]dddd, mmmm dd, yyyy"},{label:"2018-04-18",formatData:"yyyy-mm-dd;@"},{label:"\u4e8c\u3007\u4e00\u516b\u5e74\u56db\u6708\u5341\u516b\u65e5",formatData:'[DBNum1][$-804]yyyy"\u5e74"m"\u6708"d"\u65e5";@'},{label:"\u4e8c\u3007\u4e00\u516b\u5e74\u56db\u6708",formatData:'[DBNum1][$-804]yyyy"\u5e74"m"\u6708";@'},{label:"\u56db\u6708\u5341\u516b\u65e5",formatData:'[DBNum1][$-804]m"\u6708"d"\u65e5";@'},{label:"2018\u5e744\u670818\u65e5",formatData:'yyyy"\u5e74"m"\u6708"d"\u65e5";@'},{label:"2018\u5e744\u6708",formatData:'yyyy"\u5e74"m"\u6708";@'},{label:"4\u670818\u65e5",formatData:'m"\u6708"d"\u65e5";@'},{label:"\u661f\u671f\u4e09",formatData:"[$-804]aaaa;@"},{label:"\u5468\u4e09",formatData:"[$-804]aaa;@"},{label:"2018/4/18",formatData:"yyyy/m/d;@"},{label:"2018/04/18",formatData:"yyyy/mm/dd;@"},{label:"2018/4/18 2:30 PM",formatData:"[$-409]yyyy/m/d h:mm AM/PM;@"},{label:"2018/4/18 14:30",formatData:"yyyy/m/d h:mm;@"},{label:"18/4/18",formatData:"yy/m/d;@"},{label:"4/18",formatData:"m/d;@"},{label:"4/18/18",formatData:"m/d/yy;@"},{label:"04/18/18",formatData:"mm/dd/yy;@"},{label:"18-Apr",formatData:"[$-409]d-mmm;@"},{label:"18-Apr-18",formatData:"[$-409]d-mmm-yy;@"},{label:"18-Apr-18",formatData:"[$-409]dd-mmm-yy;@"},{label:"Apr-18",formatData:"[$-409]mmm-yy;@"},{label:"April-18",formatData:"[$-409]mmmm-yy;@"},{label:"A",formatData:"[$-409]mmmmm;@"},{label:"A-18",formatData:"[$-409]mmmmm-yy;@"}],time:[{label:"*\u4e0b\u5348 2:30:30",formatData:"[$-F400]h:mm:ss\\ AM/PM"},{label:"14:30",formatData:"h:mm;@"},{label:"2:30 PM",formatData:"[$-409]h:mm\\ AM/PM;@"},{label:"14:30:30",formatData:"h:mm:ss;@"},{label:"2:30:30 PM",formatData:"[$-409]h:mm:ss\\ AM/PM;@"},{label:"14\u65f630\u5206",formatData:'h"\u65f6"mm"\u5206";@'},{label:"14\u65f630\u520630\u79d2",formatData:'h"\u65f6"mm"\u5206"ss"\u79d2";@'},{label:"\u4e0b\u53482\u65f630\u5206",formatData:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'},{label:"\u4e0b\u53482\u65f630\u520630\u79d2",formatData:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@'},{label:"\u5341\u56db\u65f6\u4e09\u5341\u5206",formatData:'[DBNum1][$-804]h"\u65f6"mm"\u5206";@'},{label:"\u4e0b\u5348\u4e8c\u65f6\u4e09\u5341\u5206",formatData:'[DBNum1][$-804]\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@'}],fraction:[{label:"\u5206\u6bcd\u4e3a\u4e00\u4f4d\u6570(1/4)",formatData:"# ?/?"},{label:"\u5206\u6bcd\u4e3a\u4e24\u4f4d\u6570(21/25)",formatData:"# ??/??"},{label:"\u5206\u6bcd\u4e3a\u4e09\u4f4d\u6570(312/943)",formatData:"# ???/???"},{label:"\u4ee5 2 \u4e3a\u5206\u6bcd(1/2)",formatData:"# ?/2"},{label:"\u4ee5 4 \u4e3a\u5206\u6bcd(2/4)",formatData:"# ?/4"},{label:"\u4ee5 8 \u4e3a\u5206\u6bcd(4/8)",formatData:"# ?/8"},{label:"\u4ee5 16 \u4e3a\u5206\u6bcd(8/16)",formatData:"# ?\\?/16"},{label:"\u4ee5 10 \u4e3a\u5206\u6bcd(3/10)",formatData:"# ?/10"},{label:"\u767e\u5206\u4e4b\u51e0(30/100)",formatData:"# ?\\?/100"}],special:[{label:"\u90ae\u653f\u7f16\u7801",formatData:"000000"},{label:"\u4e2d\u6587\u5c0f\u5199\u6570\u5b57",formatData:"[DBNum1][$-804]General"},{label:"\u4e2d\u6587\u5927\u5199\u6570\u5b57",formatData:"[DBNum2][$-804]General"}],custom:null}},1742:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(14)),i=r(n(0)),o=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,i.default)(this,e);this.opts={},(0,a.default)(this.opts,{hasTitle:!0,slideBar:!1,title:"",underscroeLetter:null,items:[],selectedIndex:0,parent:null,callback:function(e){}},t),this.initDoms(),this.bindEvents(),this.scrollSelectedItemIntoView()}return(0,o.default)(e,[{key:"initDoms",value:function(){this.listDom=$(this.render()),this.opts.parent.append(this.listDom)}},{key:"bindEvents",value:function(){var e=this;this.listDom.find(".ac-list-content").eq(0).on("click",function(t){if(t.stopPropagation(),t||t.target){var n=t.target.getAttribute("index");(n=parseInt(n))>=0&&e.setSelect(n)}})}},{key:"scrollSelectedItemIntoView",value:function(){var e=this,t=this.opts.selectedIndex,n=this.listDom.find(".ac-list-content-item").eq(t);setTimeout(function(){var a=e.listDom.find(".ac-list-content-ul").eq(0),i=a.height(),o=n.height(),r=a.scrollTop(),l=t*o;l+o>r+i&&l<r+i&&a.scrollTop(r+o+l-(r+i)),(l<r||l>=r+i)&&a.scrollTop(l)},10)}},{key:"setSelect",value:function(e){if(!(e>=this.opts.items.length||e<-1)){this.opts.selectedIndex=e;var t=this.listDom.find(".ac-list-content-item");if(t.removeClass("ac-list-content-item-selected"),-1!==e){var n=t.eq(e);n&&n.addClass("ac-list-content-item-selected")}this.scrollSelectedItemIntoView(),this.opts.callback&&this.opts.callback(e)}}},{key:"updateItems",value:function(e){if(e&&e.length){this.opts.items=e;var t=this.listDom.find(".ac-list-content-ul").eq(0),n=$(this.renderList(this.opts.items,this.opts.selectedIndex));t.replaceWith(n)}}},{key:"render",value:function(){return'\n    <div class="ac-list '+(this.opts.slideBar?"fmt-panel-list":"")+'">\n      '+(this.opts.hasTitle?this.renderTitle(this.opts.title,this.opts.underscroeLetter):"")+'\n      <div class="ac-list-content">\n        '+this.renderList(this.opts.items,this.opts.selectedIndex)+"\n      </div>\n    </div>\n  "}},{key:"renderTitle",value:function(e,t){return'\n    <div class="ac-list-title">\n      <span>'+e+"</span>\n      "+(t?'\n      <span>(<span class="ac-list-title-underscore">'+t+"</span>)</span>\n    ":"")+"\n    </div>\n  "}},{key:"renderList",value:function(e,t){var n=this;return'\n    <ul class="ac-list-content-ul">\n      '+e.map(function(e,a){return'<li\n      class="ac-list-content-item '+(t==a?"ac-list-content-item-selected":"")+" "+(n.opts.slideBar?"cmpt-list-item":"")+'"\n      style="'+(e.color?"color: "+e.color:"")+'"\n      index="'+a+'">'+e.label+"</li>"}).join("")+"\n    </ul>\n  "}}]),e}();t.default=l},1743:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkIsRelease=void 0,t.getSearchCurrentSelect=function(){return s},t.queryMethod=c,t.highlightSearchCell=d,t.searchDataSource=p,t.isRelate=f,t.selectNextSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.direction,n=void 0===t?"NEXT":t,i=e.forceStartFromFirst,o=void 0!==i&&i,r=e.selection,l=void 0===r?null:r;if(!w())return;var s=a.default.view.canvas.excel;if(s.enterActiveState(),o)v(0);else{var c=l||_(),d=y(c,n);if(d){var p=d.x,f=d.y;s.selectCell(p,f,!0,0,0,5),u(p,f)}else u(-1,-1)}return},t.replaceOne=h,t.replaceAll=m,t.selectSearchCell=v,t.search=function(e){if(!w())return;d(e,o.SR_TYPE.SEARCH),v(0)},t.replaceSearchText=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!w())return;var i=a.default.view.canvas.pluginsApi.search.lastList();if(!i||!i.length)return void console.error("\u4e0d\u5b58\u5728\u67e5\u627e\u5185\u5bb9, replace \u884c\u4e3a\u4e0d\u53ef\u7528");if(!e)return void console.error("\u672a\u8f93\u5165\u67e5\u627e\u6587\u5b57");var o=i.map(function(n){var i=n[0],o=n[1],r=a.default.spreadsheet.activeSheet.getCellDataAtPosition(o,i);if(null===r||null===r.effectiveValue)return{x:-1,y:-1};var l=void 0;return"string"!==typeof(l=r.getFormula()?r.getFormula().toString(o,i):r.getEditValue())&&"number"!==typeof l?{x:-1,y:-1}:(l=""+l,{x:i,y:o,replaceText:function(){var n=l.toUpperCase(),a=e.toUpperCase();if(n.indexOf(a)>=0){var i=n.split(a),o=i.length,r=i.reduce(function(e,t,n){var i=l.slice(e.length,e.length+t.length);return n===o-1?e+=i:e=e+i+a},"");return r.split(a).join(t)}return l}(),searchText:e})})||[];if(!o||0===o.length)return;if(n)return m(o,g);return h(o,g)},t.dataChangeCb=g,t.compareCell=b,t.getSearchNextCell=y,t.isValid=E,t.getSelect=_,t.supportAction=w,t.findSearchResultIndex=function(e){if(!w())return-1;var t=e||_(),n=-1;return a.default.view.canvas.pluginsApi.search.lastList().forEach(function(e,a){t&&e[0]===t.x&&e[1]===t.y&&(n=a)}),n},t.getSearchList=function(){return a.default.view.canvas.pluginsApi.search.lastList()},t.updateString=function(e,t){var n=a.default.spreadsheet.activeSheet.getBasicFilter(),i=void 0;n&&n.range&&(i=n.hiddenRows);var o=a.default.view.canvas.pluginsApi.search.lastList(),r=0;return o.map(function(e){var t=e[0],n=e[1],o=a.default.spreadsheet.activeSheet.data.rowData[n]&&a.default.spreadsheet.activeSheet.data.rowData[n].values[t],l=o?o.getEditValue():null;return function(e,t){if(!t)return!1;for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1}(n,i)||E(t,n,l)&&r++,!1}),"\u786e\u5b9a\u5c06\u6b64\u5de5\u4f5c\u8868\u5185\u7684 "+r+" \u5904 \u201c"+e+"\u201d \u5168\u90e8\u66ff\u6362\u4e3a \u201c"+t+"\u201d \u5417?"};var a=l(n(172)),i=n(112),o=n(1697),r=l(n(8));function l(e){return e&&e.__esModule?e:{default:e}}var s=void 0;function u(e,t){s=-1===e||-1===t?null:{x:e,y:t}}function c(e,t){return!("undefined"===typeof e||null===e||!e.toLowerCase||0===e.length)&&("undefined"!==typeof t&&null!==t&&(/^\d*\.\d+$/.test(t)&&(t=t.toString().replace(/0*$/,"")),t.toString().replace("","").toLowerCase().indexOf(e.toLowerCase())>-1))}function d(e,t){if(a.default.view.canvas.excel){var n=a.default.view.canvas.pluginsApi.search;if(""!==e){r.default.jank.log({moduleValue:"search",actionValue:"traverse"});var i=p(e,t);if(i){var o=i.map(function(e){return[e.x,e.y]});return n.showSearch(o),i}n.hideSearch()}else n.hideSearch()}}function p(e,t){if(w()){var n=a.default.plugins.rmap,i=a.default.spreadsheet.activeSheet,r=i.data.rowData,l=i.getRowCount(),s=i.getColCount(),u=[],d=i.getBasicFilter(),p=void 0;d&&d.range&&(p=d.getHiddenRows());for(var h=function(e,t){if(!t)return!1;for(var n=0;n<t.length;n++)if(e===t[n])return!0;return!1},m=0;m<l;m++)if(!h(m,p))for(var v=0;v<s;v++){var g=r[m]&&r[m].values[v];if((t!==o.SR_TYPE.REPLACE||!f(g))&&(!g||t!==o.SR_TYPE.REPLACE||!n||1!==n.checkReleaseCell(m,v,a.default.spreadsheet.activeSheet))){var b=g?g.getEditValue():null;if(E(v,m,b))if(t===o.SR_TYPE.REPLACE)c(e,b)&&u.push({x:v,y:m});else{var y=g?g.getEffectiveValue():null;y=y?y.value:null,(c(e,b)||c(e,y))&&u.push({x:v,y:m})}}}return u}}function f(e){if(e&&e.workbookRange)for(var t=0,n=e.workbookRange.length;t<n;t++){var a=e.workbookRange[t];if(a.id&&5===a.type)return!0}return!1}function h(e,t){if(w()){for(var n=a.default.view.canvas.pluginsApi.search,i=_(),o=null,r=(e[0].searchText,0);r<e.length;r++){var l=e[r];0===b(i,l)&&(o=l)}if(o){var s=o.replaceText;t([{x:o.x,y:o.y,newValue:s}])}n.hideSearch()}}function m(e,t){t(e.map(function(e){var t=e.replaceText;return{x:e.x,y:e.y,newValue:t}})),a.default.view.canvas.pluginsApi.search.hideSearch()}function v(e){if(w()){var t=a.default.view.canvas.excel,n=a.default.view.canvas.pluginsApi.search.lastList();if(n&&n.length>e){var i=n[e];i&&t.selectCell(i[0],i[1],!0,0,0,5),i?u(i[0],i[1]):u(-1,-1)}}}t.checkIsRelease=function(e){if(e.workbookRange){var t=!1;return e.workbookRange.map(function(e){return 6===e.type&&(t=!0),!0}),t}return!1};function g(e){var t=a.default.spreadsheet.getActiveSheetId(),n=e.map(function(e){var n=e.y;return{x:e.x,y:n,value:e.newValue,sheetId:t}});console.log("\u63d0\u4ea4 replace request,todo"),(0,i.replace)(n)}function b(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x===t.x?0:1}function y(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"NEXT";if(!w())return null;var n=a.default.view.canvas.pluginsApi.search.lastList().map(function(e){return{x:e[0],y:e[1]}})||[];if(!e||1===n.length)return n[0];var i=null,o=null,r=-1;"PREV"===t&&(n.reverse(),r=1);for(var l=0;l<n.length;l++)if(o=n[l],0!==l)if(l!==n.length-1){if((b(i,e)===r||0===b(i,e))&&b(e,o)===r)return o;i=o}else{if(0===b(o,e)||b(o,e)===r)return n[0];if(b(o,e))return o;i=o}else{if(b(e,o)===r)return n[0];i=o}return null}function E(e,t,n){if(0===n||!n)return!1;var i=a.default.spreadsheet.activeSheet.getBasicFilter();if(null==i)return!0;var o=i.getHiddenRows();if(o)for(var r=0;r<o.length;r++)if(t===o[r])return!1;return!0}function _(){if(!w())return null;var e=a.default.view.canvas.excel.selectData.getSelectQueue();if(!e.length)return null;return{x:e[0].xRange[0],y:e[0].yRange[0]}}function w(){var e=a.default.spreadsheet;if(!e)return console.error("\u6570\u636e\u5c42\u672a\u52a0\u8f7d, \u884c\u4e3a\u4e0d\u53ef\u7528"),null;if(!a.default.view)return console.error("view \u672a\u52a0\u8f7d, \u884c\u4e3a\u4e0d\u53ef\u7528"),null;var t=a.default.view.canvas.excel;return t?a.default.view.canvas.plugins?[t,e]:void console.error("search \u6a21\u5757\u672a\u52a0\u8f7d, \u884c\u4e3a\u4e0d\u53ef\u7528"):(console.error("excel \u672a\u52a0\u8f7d, \u884c\u4e3a\u4e0d\u53ef\u7528"),null)}},1744:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.ACTION=void 0;!function(e){e[e.RESET_STATE=0]="RESET_STATE",e[e.SET_RULES_NUMBER=1]="SET_RULES_NUMBER",e[e.SET_LAST_RULE_ID=2]="SET_LAST_RULE_ID",e[e.SET_EDITOR_STATUS=3]="SET_EDITOR_STATUS",e[e.SET_MANAGE_STATUS=4]="SET_MANAGE_STATUS",e[e.SWITCH_EDITOR_MANAGE=5]="SWITCH_EDITOR_MANAGE",e[e.SET_RANGE=6]="SET_RANGE",e[e.SET_CONDITION_TYPE=7]="SET_CONDITION_TYPE",e[e.SET_OPERATOR=8]="SET_OPERATOR",e[e.SET_OPERATOR_OPTION=9]="SET_OPERATOR_OPTION",e[e.SET_INPUTONE_STATUS=10]="SET_INPUTONE_STATUS",e[e.SET_INPUTTWO_STATUS=11]="SET_INPUTTWO_STATUS",e[e.SET_INPUTONE_VALUE=12]="SET_INPUTONE_VALUE",e[e.SET_INPUTTWO_VALUE=13]="SET_INPUTTWO_VALUE",e[e.RESET_EDITOR=14]="RESET_EDITOR",e[e.SET_EDITOR=15]="SET_EDITOR",e[e.SET_PAINT_COLOR=16]="SET_PAINT_COLOR"}(a||(t.ACTION=a={}))},1773:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(0)),i=u(n(1)),o=u(n(46)),r=u(n(759)),l=u(n(308)),s=u(n(1774));function u(e){return e&&e.__esModule?e:{default:e}}n(1777);var c=function(){function e(t){var n=this;(0,a.default)(this,e),this.show=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n.value=a.defaultValue?a.defaultValue:"",n.okCb=e,n.cancelCb=t,n.absolute=!(!a||!0!==a.absolute),n.appendEqual=!(!a||!0!==a.appendEqual);var i=n.app.view.canvas.excel.configData,o=i.distanceY+i.colHeadHeight+2;n.dialog=l.default.confirm({title:null,style:{width:379,position:"absolute",top:o+"px",right:"14px",padding:20},className:"range-selection-dialog",mask:!1,closable:!1,draggable:!0,content:n.renderContent(),footer:n.renderFooter(),destroyOnClose:!0}),n.showing=!0,n.app.event.default.trigger("range-selection-panel-show")},this.hide=function(){n.dialog&&n.dialog.close(),n.showing=!1,n.app.event.default.trigger("range-selection-panel-hide")},this.clickOk=function(){n.hide(),n.okCb(n.value)},this.clickCancel=function(){n.hide(),n.cancelCb()},this.app=t,this.dialog=null,this.value="",this.okCb=function(){},this.cancelCb=function(){},this.showing=!1}return(0,i.default)(e,[{key:"renderContent",value:function(){var e=this;return o.default.createElement("div",{style:{width:"100%",height:"34px"}},o.default.createElement(s.default,{app:this.app,value:this.value,absolute:this.absolute,appendEqual:this.appendEqual,onChange:function(t){e.value=t}}))}},{key:"renderFooter",value:function(){return o.default.createElement("div",{className:"range-selection-footer-wrap"},o.default.createElement("div",{className:"button-group-wrap"},o.default.createElement(r.default,{className:"common-button",onClick:this.clickCancel,onMouseDown:function(e){return e.stopPropagation()}},"\u53d6\u6d88"),o.default.createElement(r.default,{type:"primary",className:"common-button ml-16",onClick:this.clickOk,onMouseDown:function(e){return e.stopPropagation()}},"\u786e\u5b9a")))}},{key:"onSelecting",get:function(){return this.showing}}]),e}();t.default=c},1774:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),i=f(n(0)),o=f(n(1)),r=f(n(4)),l=f(n(5)),s=f(n(46)),u=f(n(1696)),c=f(n(7)),d=n(440),p=n(82);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.setRangeWhenSelection=function(){var e=n.app.view.getSelection().rangeSelections[0],t=(n.props.appendEqual?"=":"")+(n.props.absolute?(0,d.range2AbsoluteHex)(e):(0,d.range2RelativeHex)(e));n.setState({value:t}),n.props.onChange(t)},n.inputChanged=function(e){n.setState({value:e}),n.props.onChange(e)},n.app=n.props.app,n.state={value:n.props.value||""},n.selectionListener=null,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.selectionListener=c.default.event.view.listen(p.EVENT_NAME.SELECTION_CHANGE,this.setRangeWhenSelection)}},{key:"componentWillUnmount",value:function(){this.selectionListener&&this.selectionListener.remove()}},{key:"render",value:function(){return s.default.createElement("div",{style:{width:"100%"}},s.default.createElement(u.default,{label:"",placeholder:"\u5728\u5de5\u4f5c\u8868\u4e2d\u6846\u9009\u8303\u56f4",value:this.state.value,onChange:this.inputChanged,onMouseDown:function(e){return e.stopPropagation()},autoFocus:!0}))}}]),t}(s.default.Component);t.default=h},1775:function(e,t,n){"use strict";var a=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(46));t.FormItemContext=i.createContext({status:"default"})},1776:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__assign||function(){return(i=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},o=this&&this.__rest||function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n},r=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var s=r(n(46)),u=r(n(141)),c=l(n(1736)),d=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={passwordVisible:!1},t.togglePasswordVisibility=function(){t.setState(function(e){return{passwordVisible:!e.passwordVisible}})},t}return a(t,e),t.prototype.render=function(){var e=this.props,t=e.showToggle,n=o(e,["showToggle"]),a=this.state.passwordVisible,r=a?"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCIgZmlsbC1ydWxlPSJldmVub2RkIiBvcGFjaXR5PSIuNjM3Ij48cGF0aCBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS4yNSIgZD0iTTE1Ljk0NiA5LjIyOEE3LjcyIDcuNzIgMCAwIDAgMi4zNTEgOS4xM2E3LjcxNyA3LjcxNyAwIDAgMCAxMy41OTUuMDk4eiIvPjxwYXRoIHN0cm9rZT0iI2ZmZiIgZD0iTTkuMTUgMTIuMjAyYTMgMyAwIDEgMCAwLTYgMyAzIDAgMCAwIDAgNnoiLz48L3N2Zz4=":"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxOCIgaGVpZ2h0PSIxOCI+PHBhdGggZD0iTTEuODU2IDEwLjc5NGwyLjIxMy0zLjMzTTYuNDE3IDEzbC45MTItMy43NDNtOC44NjcgMS41ODVsLTIuMDYtMy40MjdtLTIuNTcyIDUuNTkzbC0uOTM0LTMuNzZNMS44NTYgNmMyLjAzIDIuMzkzIDQuMzc0IDMuNjQ0IDcuMDMgMy43NTRzNS4wOS0xLjE0MiA3LjMxLTMuNzU0IiBmaWxsPSJub25lIiBzdHJva2U9IiMwMDAiIHN0cm9rZS13aWR0aD0iMS4yNSIgb3BhY2l0eT0iLjY0MiIvPjwvc3ZnPg==";return s.createElement(c.default,i({icon:t?r:void 0,inputStyle:{letterSpacing:a?"2px":"4px"},onClickIcon:this.togglePasswordVisibility,type:a?"text":"password"},n))},t}(s.Component);t.default=d,d.defaultProps={showToggle:!0},d.propTypes={showToggle:u.bool}},1777:function(e,t,n){var a=n(1778);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1778:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'.range-selection-dialog {\n  font-family: "PingFangSC-Regular", "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  font-size: 14px;\n}\n.range-selection-dialog .dui-modal-content {\n  min-height: unset;\n}\n.range-selection-footer-wrap {\n  display: flex;\n  justify-content: space-between;\n  flex-direction: row-reverse;\n  margin-top: 20px;\n}\n.range-selection-footer-wrap .button-group-wrap {\n  display: flex;\n}\n.range-selection-footer-wrap .button-group-wrap .common-button {\n  height: 34px;\n  width: 76px;\n  padding: 0;\n}\n.range-selection-footer-wrap .button-group-wrap .ml-16 {\n  margin-left: 16px;\n}\n/* \u6682\u65f6\u53bb\u9664\u52a8\u753b */\n.dui-modal-mask,\n.dui-modal-mask div {\n  -webkit-animation: none !important;\n          animation: none !important;\n  transition-property: all !important;\n  transition-duration: 0s !important;\n}\n.dui-modal,\n.dui-modal div {\n  -webkit-animation: none !important;\n          animation: none !important;\n  transition-property: all !important;\n  transition-duration: 0s !important;\n}\n.dui-dropdown div {\n  transition: none !important;\n}\n',""])},1779:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(0)),i=v(n(1)),o=v(n(46)),r=v(n(308)),l=v(n(1780)),s=n(1788),u=v(s),c=n(112),d=n(440);n(1679);var p=v(n(7)),f=n(244),h=n(22),m=v(n(89));function v(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){var n=this;(0,a.default)(this,e),this.handleIpadKeyboardHide=function(){h.isPad&&h.isTencentDocsApp&&p.default.window.scrollTo(0,0)},this.footClickCb=function(e){if(e===s.BUTTON_TYPE.CONFORM)n.body.current.verifyInput()&&(n.setDataValidation(),n.close());else if(e===s.BUTTON_TYPE.DELETE){n.body.current.verifyRange()&&(n.clearDataValidation(),n.close())}else n.close()},this.app=t,this.dialog=null,this.body=o.default.createRef()}return(0,i.default)(e,[{key:"create",value:function(){var e=this;return this.sheetId=this.app.spreadsheet.getActiveSheetId(),this.dialog=r.default.confirm({title:"\u6570\u636e\u9a8c\u8bc1",className:"validation-dialog",destroyOnClose:!0,style:{width:620},content:this.renderContent(),footer:this.renderFooter(),onCancel:function(){e.app&&e.app.view&&e.app.view.canvas&&e.app.view.canvas.excel.focusInput()}}),this.app&&this.app.view.plugins&&this.app.view.plugins.rangeSelectionPanel&&this.app.view.plugins.rangeSelectionPanel.hide(),this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.blurInput(),(0,f.addEvent)(p.default.document,"focusout",this.handleIpadKeyboardHide,!0),this.dialog}},{key:"close",value:function(){this.dialog&&this.dialog.close(),this.dialog=null,(0,f.removeEvent)(p.default.document,"focusout",this.handleIpadKeyboardHide,!0),this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.focusInput()}},{key:"hide",value:function(){this.dialog&&this.dialog.update({mask:!1,style:{display:"none"}}),(0,f.removeEvent)(p.default.document,"focusout",this.handleIpadKeyboardHide,!0)}},{key:"show",value:function(){this.dialog&&this.dialog.update({mask:!0,style:{display:"block",width:620}}),this.app&&this.app.view.plugins&&this.app.view.plugins.rangeSelectionPanel&&this.app.view.plugins.rangeSelectionPanel.hide(),(0,f.addEvent)(p.default.document,"focusout",this.handleIpadKeyboardHide,!0)}},{key:"handleOverRange",value:function(e){var t=this.app.spreadsheet.activeSheet.getColCount()-1,n=this.app.spreadsheet.activeSheet.getRowCount()-1,a=e.startRowIndex,i=e.endRowIndex,o=e.startColIndex,r=e.endColIndex;return a=Math.max(0,a),i=Math.min(n,i),o=Math.max(0,o),r=Math.min(t,r),new m.default.Range.GridRange(e.sheetId,a,i,o,r)}},{key:"setDataValidation",value:function(){var e=this.body.current.getValue(),t={selection:this.handleOverRange((0,d.absoluteHex2Range)(e.range,this.sheetId)),validType:e.validType,dataType:e.dataType?e.dataType:null,inputMessage:e.userDefineTip?e.userInputTip:null,isStrict:e.forbidInput,showDropDown:!0,operator:e.operate?e.operate:null,argTokens:""===e.inputOne&&""===e.inputTwo?null:[{userEnteredValue:""===e.inputOne?null:e.inputOne},{userEnteredValue:""===e.inputTwo?null:e.inputTwo}]};(0,c.dataValidation)(t)}},{key:"clearDataValidation",value:function(){var e=this.body.current.getValue().range,t=this.handleOverRange((0,d.absoluteHex2Range)(e,this.sheetId));(0,c.clearDataValidation)(t)}},{key:"renderContent",value:function(){return o.default.createElement(l.default,{ref:this.body,app:this.app})}},{key:"renderFooter",value:function(){var e=this;return o.default.createElement(u.default,{app:this.app,clickCb:function(t){e.footClickCb(t)}})}}]),e}();t.default=g},1780:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=_(n(14)),i=_(n(3)),o=_(n(0)),r=_(n(1)),l=_(n(4)),s=_(n(5)),u=_(n(46)),c=_(n(1698));n(1679);var d=_(n(1782)),p=_(n(1784)),f=_(n(1785)),h=_(n(1786)),m=_(n(1787)),v=n(1738),g=_(n(1702)),b=n(310),y=n(440),E=n(98);function _(e){return e&&e.__esModule?e:{default:e}}var w=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleValidTypeChange=function(e){n.setState({validType:e})},n.receiveUserInputTip=function(e){n.setState({userInputPlaceholder:e})},n.verifyRange=function(e,t){var a=n.state.range;if("string"===typeof t&&(a=t),!e||""!==a){var i=""===a?"":"\u8bf7\u8f93\u5165\u4e00\u4e2a\u5355\u5143\u683c\u8303\u56f4",o=a.replace(/^=/,"").trim(),r=(0,y.isValidHexRange)(o);return r?n.setState({rangeIsError:!1}):n.setState({rangeIsError:!0,rangeErrorTip:i}),r}},n.getValue=function(){var e=void 0;switch(n.state.validType){case b.VALID_TYPE.LIST:e=n.listChild.current.getValue();break;case b.VALID_TYPE.NUMBER:e=n.numberChild.current.getValue();break;case b.VALID_TYPE.TEXT:e=n.textChild.current.getValue();break;case b.VALID_TYPE.DATE:e=n.dateChild.current.getValue();break;case b.VALID_TYPE.AVAILABLE:e=n.availableChild.current.getValue()}var t=e,a=t.validType,i=t.dataType,o=t.operate,r=t.inputOne,l=t.inputTwo,s=n.state,u=s.forbidInput,c=s.userDefineTip,d=n.state.range.replace(/[\$\s]/g,"").replace(/\uff1a/g,":").toUpperCase(),p=n.state.userInputTip;return{range:d,validType:a,dataType:i,operate:o,inputOne:r,inputTwo:l,forbidInput:u,userDefineTip:c,userInputTip:p=n.state.userDefineTip&&""===n.state.userInputTip?n.state.userInputPlaceholder:"$"+p}},n.verifyInput=function(){var e=!0,t=!0;switch(n.state.validType){case b.VALID_TYPE.LIST:t=n.listChild.current.verifyInput();break;case b.VALID_TYPE.NUMBER:t=n.numberChild.current.verifyInput();break;case b.VALID_TYPE.TEXT:t=n.textChild.current.verifyInput();break;case b.VALID_TYPE.DATE:t=n.dateChild.current.verifyInput();break;case b.VALID_TYPE.AVAILABLE:t=n.availableChild.current.verifyInput();break;default:t=!1}var a=n.verifyRange(),i=n.verifyUserDefineTip();if((e=!!(t&&a&&i))&&n.state.validType===b.VALID_TYPE.LIST){var o=n.listChild.current.getValue().inputOne;if((0,y.isValidHexRange)(o.replace(/^=/,"").trim())){var r=n.app.spreadsheet.getActiveSheetId(),l=(0,y.absoluteHex2Range)(o,r),s=(0,y.absoluteHex2Range)(n.state.range.replace(/^=/,"").trim(),r);l.isCross(s)&&(e=!1,n.setState({rangeIsError:!0,rangeErrorTip:"\u6240\u9009\u533a\u57df\u4e0d\u80fd\u76f8\u4ea4"}),n.listChild.current.rangeIsCross())}}return e},n.handerTipCheckbox=function(e){n.setState({userDefineTip:e})},n.handleClickRangeIcon=function(){n.app.view.plugins.dataValidationPanel.hide(),n.app.view.plugins.rangeSelectionPanel.show(function(e){n.setState({range:e,rangeIsError:!1}),n.app.view.plugins.dataValidationPanel.show(),n.verifyRange(!0,e)},function(){n.app.view.plugins.dataValidationPanel.show()},{defaultValue:n.state.range})},n.app=n.props.app,n.state={range:"",rangeErrorTip:"",rangeIsError:!1,validType:b.VALID_TYPE.LIST,dataType:"",operate:"",inputOne:"",inputTwo:"",userDefineTip:!1,forbidInput:!1,userInputTip:"",userInputIsError:!1,userInputPlaceholder:"\u8bf7\u8f93\u5165\u63d0\u793a\u8bed"},n.listChild=u.default.createRef(),n.numberChild=u.default.createRef(),n.textChild=u.default.createRef(),n.dateChild=u.default.createRef(),n.availableChild=u.default.createRef(),n.initValue(),n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"initValue",value:function(){var e=this.app.view.getSelection(),t=e.activeCell,n=t.rowIndex,a=t.colIndex,i=(0,E.getUIDVAtPosition)(n,a),o=e.rangeSelections[0],r=(0,y.range2RelativeHex)(o),l=b.VALID_TYPE.LIST,s="",u="",c="",d="",p=!1,f=!1,h="";if(i){var m=i.argTokens&&i.argTokens[0]&&i.argTokens[0].userEnteredValue,v=i.argTokens&&i.argTokens[1]&&i.argTokens[1].userEnteredValue;l=i.validType?i.validType:b.VALID_TYPE.LIST,s=i.dataType?i.dataType:"",u=i.operator?i.operator:"",c=m||"",d=v||"",p=!!i.inputMessage,f=!!i.isStrict,h=(h=i.inputMessage?i.inputMessage:"").slice&&"$"===h.slice(0,1)?h.slice(1):""}this.storedValue={range:r,userDefineTip:p,forbidInput:f,userInputTip:h,validType:l,dataType:s,operate:u,inputOne:c,inputTwo:d}}},{key:"componentDidMount",value:function(){this.setState({range:this.storedValue.range,userDefineTip:this.storedValue.userDefineTip,forbidInput:this.storedValue.forbidInput,userInputTip:this.storedValue.userInputTip,validType:this.storedValue.validType})}},{key:"verifyUserDefineTip",value:function(){return!0}},{key:"commonProps",value:function(){return{app:this.app,validTypeCb:this.handleValidTypeChange,userInputTipCb:this.receiveUserInputTip,dataType:this.storedValue.dataType,operate:this.storedValue.operate,inputOne:this.storedValue.inputOne,inputTwo:this.storedValue.inputTwo,validType:this.storedValue.validType}}},{key:"render",value:function(){var e=this,t=u.default.createElement(d.default,(0,a.default)({},this.commonProps(),{ref:this.listChild}));switch(this.state.validType){case b.VALID_TYPE.NUMBER:t=u.default.createElement(f.default,(0,a.default)({},this.commonProps(),{ref:this.numberChild}));break;case b.VALID_TYPE.TEXT:t=u.default.createElement(h.default,(0,a.default)({},this.commonProps(),{ref:this.textChild}));break;case b.VALID_TYPE.DATE:t=u.default.createElement(p.default,(0,a.default)({},this.commonProps(),{ref:this.dateChild}));break;case b.VALID_TYPE.AVAILABLE:t=u.default.createElement(m.default,(0,a.default)({},this.commonProps(),{ref:this.availableChild}))}return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u5355\u5143\u683c\u8303\u56f4"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement(g.default,{value:this.state.range,placeholder:"\u8bf7\u8f93\u5165\u4e00\u4e2a\u5355\u5143\u683c\u8303\u56f4",errorTip:this.state.rangeErrorTip,isError:this.state.rangeIsError,className:"input-common-style",icon:v.tableIconUrl,onClickIcon:this.handleClickRangeIcon,wrapStyle:{width:"135px"},onChange:function(t){e.setState({range:t,rangeIsError:!1})},onBlur:function(){e.verifyRange(!0)}}))),t,u.default.createElement("div",{className:"form-item-wrap",style:{height:40}},u.default.createElement("div",null,u.default.createElement(c.default,{checked:this.state.forbidInput,onChange:function(t){e.setState({forbidInput:t})}},u.default.createElement("span",{className:"checkbox-label"},"\u8f93\u5165\u6570\u636e\u65e0\u6548\u65f6\u7981\u6b62\u8f93\u5165")))),u.default.createElement("div",{className:"form-item-wrap",style:{height:59}},u.default.createElement("div",{className:"form-item-label",style:{width:"auto"}},u.default.createElement("div",{style:{display:"inline-block",lineHeight:34}},u.default.createElement(c.default,{onChange:this.handerTipCheckbox,checked:this.state.userDefineTip},u.default.createElement("span",{className:"checkbox-label"},"\u9009\u4e2d\u5355\u5143\u683c\u65f6\u663e\u793a\u63d0\u793a\u8bed")))),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement(g.default,{placeholder:this.state.userInputPlaceholder,errorTip:"",isError:this.state.userInputIsError,className:"input-common-style",wrapStyle:{width:"376px",display:this.state.userDefineTip?"inline-block":"none"},value:this.state.userInputTip,onChange:function(t){e.setState({userInputTip:t,userInputIsError:!1})},maxLength:60}))))}}]),t}(u.default.Component);t.default=w},1781:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'/* dialog start */\n.validation-dialog .dui-dialog-title {\n  font-family: "PingFangSC-Medium", "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  font-size: 16px;\n  color: #333333;\n}\n.validation-dialog .dui-dialog-content,\n.validation-dialog .validation-footer-wrap {\n  font-family: "PingFangSC-Regular", "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  font-size: 14px;\n}\n/* dialog end */\n/* body start */\n.form-item-wrap {\n  height: 64px;\n  display: flex;\n}\n.form-item-wrap .form-item-label {\n  display: inline-block;\n  line-height: 34px;\n}\n.form-item-wrap .form-item-collection {\n  display: flex;\n  position: relative;\n  left: 16px;\n}\n.form-item-wrap .form-item-collection > div {\n  display: inline-block;\n}\n.form-item-wrap .form-item-collection .wh-135 {\n  width: 135px;\n}\n.form-item-wrap .form-item-collection .ml-16 {\n  margin-left: 16px;\n}\n.form-item-wrap .form-item-collection .line {\n  display: inline-block;\n}\n.form-item-wrap .form-item-collection .line-34 {\n  line-height: 34px;\n}\n.form-item-wrap .input-common-style {\n  height: 34px;\n}\n.form-item-wrap .form-item-label {\n  width: 84px;\n  font-size: 14px;\n  display: inline-block;\n}\n.form-item-wrap .checkbox-label {\n  color: #202020;\n}\n.validation-input-tip {\n  line-height: 17px;\n  font-size: 12px;\n  color: #EF4E2F;\n  margin-top: 3px;\n}\n.input-error-wrap .dui-input-input {\n  border: 1px solid #EF4E2F !important;\n}\n.input-error-wrap .dui-input-input:focus {\n  border: 1px solid #EF4E2F !important;\n}\n/* body end */\n/* foot start */\n.validation-footer-wrap .button-group-wrap {\n  float: right;\n  display: flex;\n}\n.validation-footer-wrap .button-group-wrap .common-button {\n  height: 30px;\n  width: 76px;\n  padding: 0;\n}\n.validation-footer-wrap .button-group-wrap .ml-16 {\n  margin-left: 16px;\n}\n/* foot end */\n/* \u6682\u65f6\u53bb\u9664\u52a8\u753b */\n.dui-modal-mask,\n.dui-modal-mask div {\n  -webkit-animation: none !important;\n          animation: none !important;\n  transition-property: all !important;\n  transition-duration: 0s !important;\n}\n.dui-modal,\n.dui-modal div {\n  -webkit-animation: none !important;\n          animation: none !important;\n  transition-property: all !important;\n  transition-duration: 0s !important;\n}\n.dui-dropdown div {\n  transition: none !important;\n}\n/* checkbox \u504f\u79fb\u4e86\u4e00\u4e2a\u50cf\u7d20\uff0c\u5148\u5728\u8fd9\u91cc\u8986\u76d6\u6837\u5f0f  add by sigmaliu */\n.validation-dialog .dui-checkbox-checked .dui-checkbox-icon:after {\n  margin-top: -2px !important;\n}\n',""])},1782:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(14)),i=v(n(3)),o=v(n(0)),r=v(n(1)),l=v(n(4)),s=v(n(5)),u=v(n(46)),c=v(n(1683));n(1679);var d=n(1738),p=n(310),f=v(n(1702)),h=n(760),m=n(440);function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleInputOneChange=function(e){n.setState({inputOne:e,inputOneIsError:!1})},n.handleClickRangeIcon=function(){n.app.view.plugins.dataValidationPanel.hide(),n.app.view.plugins.rangeSelectionPanel.show(function(e){var t=e.trim();t="="===t.slice(0,1)?t:"="+t,n.handleInputOneChange(t),n.app.view.plugins.dataValidationPanel.show(),n.verifyInput(!0,t)},function(){n.app.view.plugins.dataValidationPanel.show()},{appendEqual:!0,absolute:!0,defaultValue:n.state.inputOne})},n.getValue=function(){var e=n.state.inputOne;return(0,m.isValidHexRange)(e.replace(/^=/,"").trim())&&(e=e.toUpperCase().trim().replace(/\uff1a/g,":")),{validType:p.VALID_TYPE.LIST,dataType:n.state.dataType,operate:n.state.operate,inputOne:e,inputTwo:n.state.inputTwo}},n.verifyInput=function(e,t){var a=n.state.inputOne;if("string"===typeof t&&(a=t),!e||""!==a)return""===a?(n.setState({inputOneIsError:!0,inputOneErrorTip:""}),!1):(0,m.isValidHexRange)(a.replace(/^=/,"").trim())?(n.setState({inputOneIsError:!1}),!0):(0,h.isFormulaAndError)(a)?(n.setState({inputOneIsError:!0,inputOneErrorTip:"\u8f93\u5165\u7684\u5355\u5143\u683c\u8303\u56f4\u65e0\u6548\uff0c\u8bf7\u91cd\u65b0\u8f93\u5165"}),!1):(n.setState({inputOneIsError:!1}),!0)},n.app=n.props.app,n.state=(0,a.default)({inputOneIsError:!1,inputOneErrorTip:""},n.loadValues(n.props)),n.userInputTipCb=n.props.userInputTipCb,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.userInputTipCb("\u8bf7\u9009\u62e9\u4e0b\u62c9\u5217\u8868\u4e2d\u7684\u9009\u9879\u3002")}},{key:"loadValues",value:function(e){return e.validType===p.VALID_TYPE.LIST?{dataType:e.dataType,operate:e.operate,inputOne:e.inputOne,inputTwo:e.inputTwo}:{dataType:"",operate:"",inputOne:"",inputTwo:""}}},{key:"rangeIsCross",value:function(){this.setState({inputOneIsError:!0,inputOneErrorTip:""})}},{key:"render",value:function(){var e=this;return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u9a8c\u8bc1\u6761\u4ef6"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:p.VALID_TYPE.LIST,className:"wh-135",onChange:this.props.validTypeCb},u.default.createElement(c.default.Option,{value:p.VALID_TYPE.LIST},"\u4e0b\u62c9\u5217\u8868"),u.default.createElement(c.default.Option,{value:p.VALID_TYPE.NUMBER},"\u6570\u5b57"),u.default.createElement(c.default.Option,{value:p.VALID_TYPE.TEXT},"\u6587\u672c"),u.default.createElement(c.default.Option,{value:p.VALID_TYPE.DATE},"\u65e5\u671f"),u.default.createElement(c.default.Option,{value:p.VALID_TYPE.AVAILABLE},"\u6709\u6548\u6027"))))),u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"}),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",{style:{width:"472px"}},u.default.createElement(f.default,{value:this.state.inputOne,placeholder:"\u8bf7\u8f93\u5165\u9009\u9879\uff0c\u4ee5\u82f1\u6587\u9017\u53f7\u5206\u9694\uff0c\u59821,2,3,4,5",className:"input-common-style",icon:d.tableIconUrl,onClickIcon:this.handleClickRangeIcon,onChange:this.handleInputOneChange,errorTip:this.state.inputOneErrorTip,isError:this.state.inputOneIsError,onBlur:function(){e.verifyInput(!0)}})))))}}]),t}(u.default.Component);t.default=g},1783:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=o(n(1737)),c=o(n(1715)),d=o(n(1689)),p=n(171),f=r.createElement(u.default,null).type,h=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={currentValue:t.props.defaultValue},t.handleClick=function(e){t.props.disabled||t.setState({currentValue:e},function(){t.props.onChange(e)})},t}return a(t,e),t.prototype.render=function(){for(var e,t,n=this.props,a=n.prefixCls,i=n.className,o=n.style,l=n.children,u=n.value,p=n.disabled,h=n.dropdownAlignment,m=n.dropdownMatchSelectWidth,v=n.showArrow,g=n.listStyle,b=n.arrowStyle,y=n.textStyle,E=n.placeholder,_=n.onVisibleChange,w=s.default(a,i,((e={})[a+"-disabled"]=p,e)),T=void 0!==u?u:this.state.currentValue,I=!0,C=E,x=0,A=r.Children.toArray(l);x<A.length;x++){var S=A[x];if(r.isValidElement(S)&&S.type===f){var O=S.props;if(T&&O.value===T){C=O.children,I=!1;break}}}var N=s.default(a+"-text",((t={})[a+"-placeholder"]=I,t)),k=r.createElement(d.default,{className:a+"-list",style:g,onClick:this.handleClick,selectedIds:[T]},l);return r.createElement(c.default,{dropContent:k,alignment:h,matchWidth:m,disabled:p,onVisibleChange:_},r.createElement("div",{className:w,style:o},r.createElement("span",{className:N,style:y},C),v?r.createElement("span",{className:a+"-arrow",style:b}):null))},t}(r.Component);t.default=h,h.defaultProps={prefixCls:"dui-select",onChange:p.emptyFn,showArrow:!0,dropdownMatchSelectWidth:!0,disabled:!1,dropdownAlignment:"left",placeholder:"\u8bf7\u9009\u62e9",defaultValue:"",onVisibleChange:p.emptyFn},h.propTypes={prefixCls:l.string,style:l.object,className:l.string,onChange:l.func,value:l.string,defaultValue:l.string,disabled:l.bool,dropdownAlignment:l.string,dropdownMatchSelectWidth:l.bool,placeholder:l.string,showArrow:l.bool,listStyle:l.object,arrowStyle:l.object,textStyle:l.object,onVisibleChange:l.func}},1784:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(14)),i=v(n(3)),o=v(n(0)),r=v(n(1)),l=v(n(4)),s=v(n(5)),u=v(n(46)),c=v(n(1683));n(1679);var d=n(310),p=v(n(1702)),f=n(57),h=n(760),m=v(n(89));function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleInputOneChange=function(e){n.setState({inputOne:e,inputOneIsError:!1})},n.handleInputTwoChagne=function(e){n.setState({inputTwo:e,inputTwoIsError:!1})},n.handleOperateChange=function(e){n.setState({operate:e,inputTwoShow:e===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN})},n.getValue=function(){return{validType:d.VALID_TYPE.DATE,dataType:n.state.dataType,operate:n.state.operate,inputOne:n.state.inputOne,inputTwo:n.state.inputTwo}},n.verifyInputOne=function(e){var t={},a=n.state.inputOne;if(e&&(n.lastBlurInput=1),!e||""!==a){if((0,h.isFormulaAndError)(a)||!(0,h.isFormulaString)(a)&&!(0,f.parseDateTimeValue)(a,void 0))return t.inputOneIsError=!0,t.inputOneErrorTip=""===n.state.inputOne?"":"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",n.setState(t),!1;var i=(0,h.compareMaxMinError)(n.state,1,"\u65e5\u671f");return!i||(n.setState(i),!1)}},n.verifyInputTwo=function(e){var t={},a=n.state,i=a.inputTwo,o=a.inputTwoShow;if(e&&(n.lastBlurInput=2),!e||""!==i){if(o&&((0,h.isFormulaAndError)(i)||!(0,h.isFormulaString)(i)&&!(0,f.parseDateTimeValue)(i,void 0)))return t.inputTwoIsError=!0,t.inputTwoErrorTip=""===n.state.inputTwo?"":"\u8bf7\u8f93\u5165\u6b63\u786e\u683c\u5f0f\u7684\u65e5\u671f",n.setState(t),!1;var r=(0,h.compareMaxMinError)(n.state,2,"\u65e5\u671f");return!r||(n.setState(r),!1)}},n.verifyInput=function(){return!!(1!==n.lastBlurInput||n.verifyInputOne()&&n.verifyInputTwo())&&!(!n.verifyInputTwo()||!n.verifyInputOne())},n.app=n.props.app,n.state=(0,a.default)({inputOneIsError:!1,inputOneErrorTip:"",inputTwoIsError:!1,inputTwoErrorTip:"",inputOneLabel:"2018/4/18",inputTwoLabel:"2018/4/18"},n.loadValues(n.props)),n.userInputTipCb=n.props.userInputTipCb,n.lastBlurInput=1,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"getUserInputTip",value:function(){var e=this.state.operate,t=""===this.state.inputOne?" ":this.state.inputOne,n=""===this.state.inputTwo?" ":this.state.inputTwo;return e===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u8bf7\u8f93\u5165"+h.DATE_OPERATE_MAP.get(e)+t+"\u548c"+n+"\u4e4b\u95f4\u7684\u65e5\u671f\u3002":"\u8bf7\u8f93\u5165"+h.DATE_OPERATE_MAP.get(e)+t+"\u7684\u65e5\u671f\u3002"}},{key:"componentDidMount",value:function(){this.userInputTipCb(this.getUserInputTip())}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=t;n.dataType===a.dataType&&n.operate===a.operate&&n.inputOne===a.inputOne&&n.inputTwo===a.inputTwo||this.userInputTipCb(this.getUserInputTip())}},{key:"loadValues",value:function(e){return e.validType===d.VALID_TYPE.DATE?{dataType:e.dataType,operate:e.operate,inputOne:e.inputOne,inputTwo:e.inputTwo,inputTwoShow:e.operate===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e.operate===m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN}:{dataType:"",operate:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,inputOne:"",inputTwo:"",inputTwoShow:!0}}},{key:"render",value:function(){var e=this;return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u9a8c\u8bc1\u6761\u4ef6"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:d.VALID_TYPE.DATE,className:"wh-135",onChange:this.props.validTypeCb},u.default.createElement(c.default.Option,{value:d.VALID_TYPE.LIST},"\u4e0b\u62c9\u5217\u8868"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.NUMBER},"\u6570\u5b57"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.TEXT},"\u6587\u672c"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.DATE},"\u65e5\u671f"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.AVAILABLE},"\u6709\u6548\u6027"))))),u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"}),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,value:this.state.operate,className:"wh-135",onChange:this.handleOperateChange},u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN},"\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN},"\u4e0d\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.EQUAL},"\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_EQUAL},"\u4e0d\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS},"\u65e9\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT_EQUAL},"\u4e0d\u65e9\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.GREAT},"\u665a\u4e8e"),u.default.createElement(c.default.Option,{value:m.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.LESS_EQUAL},"\u4e0d\u665a\u4e8e"))),u.default.createElement("div",{className:"wh-135 ml-16"},u.default.createElement(p.default,{placeholder:this.state.inputOneLabel,value:this.state.inputOne,className:"input-common-style",onChange:this.handleInputOneChange,errorTip:this.state.inputOneErrorTip,isError:this.state.inputOneIsError,onBlur:function(){e.verifyInputOne(!0)}})),u.default.createElement("div",{style:{display:this.state.inputTwoShow?"flex":"none"}},u.default.createElement("div",{className:"ml-16 line line-34"},"\u548c"),u.default.createElement("div",{className:"wh-135 ml-16 line"},u.default.createElement(p.default,{placeholder:this.state.inputTwoLabel,value:this.state.inputTwo,className:"input-common-style",onChange:this.handleInputTwoChagne,errorTip:this.state.inputTwoErrorTip,isError:this.state.inputTwoIsError,onBlur:function(){e.verifyInputTwo(!0)}}))))))}}]),t}(u.default.Component);t.default=g},1785:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(14)),i=m(n(3)),o=m(n(0)),r=m(n(1)),l=m(n(4)),s=m(n(5)),u=m(n(46)),c=m(n(1683));n(1679);var d=n(310),p=m(n(1702)),f=n(760),h=m(n(89));function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleDataTypeChange=function(e){var t=n.getLabelString(e,n.state.operate);n.setState({dataType:e,inputOneLabel:t.labelOne,inputLabelTwo:t.labelTwo})},n.handleInputOneChange=function(e){n.setState({inputOne:e,inputOneIsError:!1})},n.handleInputTwoChagne=function(e){n.setState({inputTwo:e,inputTwoIsError:!1})},n.handleOperateChange=function(e){var t=!1,a=n.getLabelString(n.state.dataType,e);e!==h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&e!==h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN||(t=!0),n.setState({operate:e,inputTwoShow:t,inputOneLabel:a.labelOne,inputTwoLabel:a.labelTwo})},n.getValue=function(){return{validType:d.VALID_TYPE.NUMBER,dataType:n.state.dataType,operate:n.state.operate,inputOne:n.state.inputOne,inputTwo:n.state.inputTwo}},n.verifyInputOne=function(e){var t=n.state.inputOne;if(e&&(n.lastBlurInput=1),!e||""!==t){if((0,f.isFormulaAndError)(t)||!(0,f.isFormulaString)(t)&&!(0,f.isLeagalNumber)(t))return n.setState({inputOneIsError:!0,inputOneErrorTip:""===t?"":"\u8bf7\u8f93\u5165\u6570\u5b57"}),!1;var a=(0,f.compareMaxMinError)(n.state,1,"\u6570\u503c",{fractionFirst:!0});return!a||(n.setState(a),!1)}},n.verifyInputTwo=function(e){var t=n.state,a=t.inputTwo,i=t.inputTwoShow;if(e&&(n.lastBlurInput=2),!e||""!==a){if(i&&((0,f.isFormulaAndError)(a)||!(0,f.isFormulaString)(a)&&!(0,f.isLeagalNumber)(a)))return n.setState({inputTwoIsError:!0,inputTwoErrorTip:""===a?"":"\u8bf7\u8f93\u5165\u6570\u5b57"}),!1;var o=(0,f.compareMaxMinError)(n.state,2,"\u6570\u503c",{fractionFirst:!0});return!o||(n.setState(o),!1)}},n.verifyInput=function(){return!!(1!==n.lastBlurInput||n.verifyInputOne()&&n.verifyInputTwo())&&!(!n.verifyInputTwo()||!n.verifyInputOne())},n.app=n.props.app,n.state=(0,a.default)({inputOneIsError:!1,inputOneErrorTip:"",inputTwoIsError:!1,inputTwoErrorTip:"",inputOneLabel:"1",inputTwoLabel:"100"},n.loadValues(n.props)),n.userInputTipCb=n.props.userInputTipCb,n.lastBlurInput=1,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"getUserInputTip",value:function(){var e=this.state.operate,t=this.state.dataType,n=""===this.state.inputOne?" ":this.state.inputOne,a=""===this.state.inputTwo?" ":this.state.inputTwo;return e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u8bf7\u8f93\u5165"+f.NUMBER_OPERATE_MAP.get(e)+n+"\u548c"+a+"\u4e4b\u95f4\u7684"+f.NUMBER_DATA_TYPE_MAP.get(t)+"\u3002":"\u8bf7\u8f93\u5165"+f.NUMBER_OPERATE_MAP.get(e)+n+"\u7684"+f.NUMBER_DATA_TYPE_MAP.get(t)+"\u3002"}},{key:"componentDidMount",value:function(){this.userInputTipCb(this.getUserInputTip())}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=t;n.dataType===a.dataType&&n.operate===a.operate&&n.inputOne===a.inputOne&&n.inputTwo===a.inputTwo||this.userInputTipCb(this.getUserInputTip())}},{key:"loadValues",value:function(e){return e.validType===d.VALID_TYPE.NUMBER?{dataType:e.dataType,operate:e.operate,inputOne:e.inputOne,inputTwo:e.inputTwo,inputTwoShow:e.operate===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e.operate===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN}:{dataType:d.DATA_TYPE.NONE,operate:h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,inputOne:"",inputTwo:"",inputTwoShow:!0}}},{key:"getLabelString",value:function(e,t){var n="1",a="100",i="\u6570\u503c",o="10";return e===d.DATA_TYPE.FLOAT?(n="1",a="100",i="\u5c0f\u6570",o="10"):e===d.DATA_TYPE.INT&&(n="1",a="100",i="\u6574\u6570",o="10"),t!==h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN&&t!==h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN&&(n=i+"\uff0c\u5982"+o),{labelOne:n,labelTwo:a}}},{key:"render",value:function(){var e=this,t=h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE;return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u9a8c\u8bc1\u6761\u4ef6"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:d.VALID_TYPE.NUMBER,className:"wh-135",onChange:this.props.validTypeCb},u.default.createElement(c.default.Option,{value:d.VALID_TYPE.LIST},"\u4e0b\u62c9\u5217\u8868"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.NUMBER},"\u6570\u5b57"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.TEXT},"\u6587\u672c"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.DATE},"\u65e5\u671f"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.AVAILABLE},"\u6709\u6548\u6027"))),u.default.createElement("div",{className:"ml-16"},u.default.createElement(c.default,{defaultValue:d.DATA_TYPE.NONE,value:this.state.dataType,className:"wh-135",onChange:this.handleDataTypeChange},u.default.createElement(c.default.Option,{value:d.DATA_TYPE.NONE},"--"),u.default.createElement(c.default.Option,{value:d.DATA_TYPE.INT},"\u6574\u6570"),u.default.createElement(c.default.Option,{value:d.DATA_TYPE.FLOAT},"\u5c0f\u6570"))))),u.default.createElement("div",{className:"form-item-wrap",style:{display:"flex"}},u.default.createElement("div",{className:"form-item-label"}),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:t.BETWEEN,value:this.state.operate,className:"wh-135",onChange:this.handleOperateChange},u.default.createElement(c.default.Option,{value:t.BETWEEN},"\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:t.NOT_BETWEEN},"\u4e0d\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:t.EQUAL},"\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.NOT_EQUAL},"\u4e0d\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.GREAT},"\u5927\u4e8e"),u.default.createElement(c.default.Option,{value:t.LESS},"\u5c0f\u4e8e"),u.default.createElement(c.default.Option,{value:t.GREAT_EQUAL},"\u5927\u4e8e\u6216\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.LESS_EQUAL},"\u5c0f\u4e8e\u6216\u7b49\u4e8e"))),u.default.createElement("div",{className:"wh-135 ml-16"},u.default.createElement(p.default,{placeholder:this.state.inputOneLabel,value:this.state.inputOne,className:"input-common-style",onChange:this.handleInputOneChange,errorTip:this.state.inputOneErrorTip,isError:this.state.inputOneIsError,onBlur:function(){e.verifyInputOne(!0)}})),u.default.createElement("div",{style:{display:this.state.inputTwoShow?"flex":"none"}},u.default.createElement("div",{className:"ml-16 line line-34"},"\u548c"),u.default.createElement("div",{className:"wh-135 ml-16 line"},u.default.createElement(p.default,{placeholder:this.state.inputTwoLabel,value:this.state.inputTwo,className:"input-common-style",onChange:this.handleInputTwoChagne,errorTip:this.state.inputTwoErrorTip,isError:this.state.inputTwoIsError,onBlur:function(){e.verifyInputTwo(!0)}}))))))}}]),t}(u.default.Component);t.default=v},1786:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(14)),i=m(n(3)),o=m(n(0)),r=m(n(1)),l=m(n(4)),s=m(n(5)),u=m(n(46)),c=m(n(1683));n(1679);var d=n(310),p=m(n(1702)),f=n(760),h=m(n(89));function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleDataTypeChange=function(e){var t=e===d.DATA_TYPE.LENGTH?h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN:h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,a=e===d.DATA_TYPE.LENGTH?"\u8bf7\u8f93\u5165\u6307\u5b9a\u7684\u957f\u5ea6":"\u8bf7\u8f93\u5165\u6307\u5b9a\u7684\u6587\u672c";n.setState({dataType:e,operate:t,inputTwoShow:t===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN,inputOneLabel:a,inputTwoLabel:a})},n.handleInputOneChange=function(e){n.setState({inputOne:e,inputOneIsError:!1})},n.handleInputTwoChagne=function(e){n.setState({inputTwo:e,inputTwoIsError:!1})},n.handleOperateChange=function(e){n.setState({operate:e,inputTwoShow:n.state.dataType===d.DATA_TYPE.LENGTH&&(e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)})},n.getValue=function(){return{validType:d.VALID_TYPE.TEXT,dataType:n.state.dataType,operate:n.state.operate,inputOne:n.state.inputOne,inputTwo:n.state.inputTwo}},n.verifyInputOne=function(e){var t={},a=n.state,i=a.inputOne,o=a.dataType,r=!0;if(e&&(n.lastBlurInput=1),!e||""!==i){if(o===d.DATA_TYPE.LENGTH?((0,f.isFormulaAndError)(i)||!(0,f.isFormulaString)(i)&&!1===/^\s*\d+\s*?$/.test(i))&&(t.inputOneIsError=!0,t.inputOneErrorTip="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6587\u672c\u957f\u5ea6",r=!1):o===d.DATA_TYPE.CONTENT&&((0,f.isFormulaAndError)(i)?(t.inputOneIsError=!0,t.inputOneErrorTip="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u516c\u5f0f",r=!1):""===i&&(t.inputOneIsError=!0,t.inputOneErrorTip="",r=!1)),!r)return n.setState(t),!1;if(o===d.DATA_TYPE.LENGTH){var l=(0,f.compareMaxMinError)(n.state,1,"\u957f\u5ea6");if(l)return n.setState(l),!1}return!0}},n.verifyInputTwo=function(e){var t={},a=n.state,i=a.inputTwo,o=a.inputTwoShow,r=a.dataType,l=!0;if(e&&(n.lastBlurInput=2),!e||""!==i){if(!o)return!0;if(r===d.DATA_TYPE.LENGTH?((0,f.isFormulaAndError)(i)||!(0,f.isFormulaString)(i)&&!1===/^\s*\d+\s*?$/.test(i))&&(t.inputTwoIsError=!0,t.inputTwoErrorTip="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6587\u672c\u957f\u5ea6",l=!1):r===d.DATA_TYPE.CONTENT&&((0,f.isFormulaAndError)(i)?(t.inputTwoIsError=!0,t.inputTwoErrorTip="\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u516c\u5f0f",l=!1):""===i&&(t.inputTwoIsError=!0,t.inputTwoErrorTip="",l=!1)),!l)return n.setState(t),!1;if(r===d.DATA_TYPE.LENGTH){var s=(0,f.compareMaxMinError)(n.state,2,"\u957f\u5ea6");if(s)return n.setState(s),!1}return!0}},n.verifyInput=function(){return!!(1!==n.lastBlurInput||n.verifyInputOne()&&n.verifyInputTwo())&&!(!n.verifyInputTwo()||!n.verifyInputOne())},n.app=n.props.app,n.state=(0,a.default)({inputOneIsError:!1,inputOneErrorTip:"",inputTwoIsError:!1,inputTwoErrorTip:"",inputOneLabel:"\u8bf7\u8f93\u5165\u6307\u5b9a\u7684\u6587\u672c",inputTwoLabel:"\u8bf7\u8f93\u5165\u6307\u5b9a\u7684\u6587\u672c"},n.loadValues(n.props)),n.userInputTipCb=n.props.userInputTipCb,n.lastBlurInput=1,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"getUserInputTip",value:function(){var e=this.state.operate,t=this.state.dataType,n=""===this.state.inputOne?" ":this.state.inputOne,a=""===this.state.inputTwo?" ":this.state.inputTwo;return t===d.DATA_TYPE.CONTENT?"\u8bf7\u8f93\u5165\u5185\u5bb9"+f.TEXT_OPERATE_MAP.get(e)+n+"\u7684\u6587\u672c\u3002":e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN?"\u8bf7\u8f93\u5165\u957f\u5ea6"+f.TEXT_OPERATE_MAP.get(e)+n+"\u548c"+a+"\u4e4b\u95f4\u7684\u6587\u672c\u3002":"\u8bf7\u8f93\u5165\u957f\u5ea6"+f.TEXT_OPERATE_MAP.get(e)+n+"\u7684\u6587\u672c\u3002"}},{key:"componentDidMount",value:function(){this.userInputTipCb(this.getUserInputTip())}},{key:"componentDidUpdate",value:function(e,t){var n=this.state,a=t;n.dataType===a.dataType&&n.operate===a.operate&&n.inputOne===a.inputOne&&n.inputTwo===a.inputTwo||this.userInputTipCb(this.getUserInputTip())}},{key:"loadValues",value:function(e){return e.validType===d.VALID_TYPE.TEXT?{dataType:e.dataType,operate:e.operate,inputOne:e.inputOne,inputTwo:e.inputTwo,inputTwoShow:e.dataType===d.DATA_TYPE.LENGTH&&(e.operate===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.BETWEEN||e.operate===h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.NOT_BETWEEN)}:{dataType:d.DATA_TYPE.CONTENT,operate:h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE.INCLUDE,inputOne:"",inputTwo:"",inputTwoShow:!1}}},{key:"render",value:function(){var e=this,t=h.default.Cell.Format.DATA_VALIDATION_CONDITION_TYPE;return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u9a8c\u8bc1\u6761\u4ef6"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:d.VALID_TYPE.TEXT,className:"wh-135",onChange:this.props.validTypeCb},u.default.createElement(c.default.Option,{value:d.VALID_TYPE.LIST},"\u4e0b\u62c9\u5217\u8868"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.NUMBER},"\u6570\u5b57"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.TEXT},"\u6587\u672c"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.DATE},"\u65e5\u671f"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.AVAILABLE},"\u6709\u6548\u6027"))),u.default.createElement("div",{className:"ml-16"},u.default.createElement(c.default,{defaultValue:d.DATA_TYPE.CONTENT,value:this.state.dataType,className:"wh-135",onChange:this.handleDataTypeChange},u.default.createElement(c.default.Option,{value:d.DATA_TYPE.CONTENT},"\u5185\u5bb9"),u.default.createElement(c.default.Option,{value:d.DATA_TYPE.LENGTH},"\u957f\u5ea6"))))),u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"}),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",{style:{display:this.state.dataType===d.DATA_TYPE.CONTENT?"inline-block":"none"}},u.default.createElement(c.default,{defaultValue:t.INCLUDE,value:this.state.operate,className:"wh-135",onChange:this.handleOperateChange},u.default.createElement(c.default.Option,{value:t.INCLUDE},"\u5305\u62ec"),u.default.createElement(c.default.Option,{value:t.NOT_INCLUDE},"\u4e0d\u5305\u62ec"),u.default.createElement(c.default.Option,{value:t.EQUAL},"\u7b49\u4e8e"))),u.default.createElement("div",{style:{display:this.state.dataType===d.DATA_TYPE.LENGTH?"inline-block":"none"}},u.default.createElement(c.default,{defaultValue:t.BETWEEN,value:this.state.operate,className:"wh-135",onChange:this.handleOperateChange},u.default.createElement(c.default.Option,{value:t.BETWEEN},"\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:t.NOT_BETWEEN},"\u4e0d\u4ecb\u4e8e"),u.default.createElement(c.default.Option,{value:t.EQUAL},"\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.NOT_EQUAL},"\u4e0d\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.GREAT},"\u5927\u4e8e"),u.default.createElement(c.default.Option,{value:t.LESS},"\u5c0f\u4e8e"),u.default.createElement(c.default.Option,{value:t.GREAT_EQUAL},"\u5927\u4e8e\u6216\u7b49\u4e8e"),u.default.createElement(c.default.Option,{value:t.LESS_EQUAL},"\u5c0f\u4e8e\u6216\u7b49\u4e8e"))),u.default.createElement("div",{className:"wh-135 ml-16"},u.default.createElement(p.default,{placeholder:this.state.inputOneLabel,value:this.state.inputOne,className:"input-common-style",onChange:this.handleInputOneChange,style:{width:this.state.dataType===d.DATA_TYPE.CONTENT?286:135},errorTip:this.state.inputOneErrorTip,isError:this.state.inputOneIsError,onBlur:function(){e.verifyInputOne(!0)}})),u.default.createElement("div",{style:{display:this.state.inputTwoShow?"flex":"none"}},u.default.createElement("div",{className:"ml-16 line line-34"},"\u548c"),u.default.createElement("div",{className:"wh-135 ml-16 line"},u.default.createElement(p.default,{placeholder:this.state.inputTwoLabel,value:this.state.inputTwo,className:"input-common-style",onChange:this.handleInputTwoChagne,errorTip:this.state.inputTwoErrorTip,isError:this.state.inputTwoIsError,onBlur:function(){e.verifyInputTwo(!0)}}))))))}}]),t}(u.default.Component);t.default=v},1787:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(14)),i=p(n(3)),o=p(n(0)),r=p(n(1)),l=p(n(4)),s=p(n(5)),u=p(n(46)),c=p(n(1683));n(1679);var d=n(310);function p(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.handleDataTypeChange=function(e){n.setState({dataType:e})},n.getValue=function(){return{validType:d.VALID_TYPE.AVAILABLE,dataType:n.state.dataType,operate:n.state.operate,inputOne:n.state.inputOne,inputTwo:n.state.inputTwo}},n.verifyInput=function(){return!0},n.app=n.props.app,n.state=(0,a.default)({inputOneIsError:!1,inputOneErrorTip:"",inputTwoIsError:!1,inputTwoErrorTip:"",inputOneLabel:"\u6700\u5c0f\u503c\uff0c\u59821",inputTwoLabel:"\u6700\u5927\u503c\uff0c\u5982100"},n.loadValues(n.props)),n.userInputTipCb=n.props.userInputTipCb,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"componentDidMount",value:function(){this.userInputTipCb("\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u8eab\u4efd\u8bc1\u53f7\u7801\u3002")}},{key:"loadValues",value:function(e){return e.validType===d.VALID_TYPE.AVAILABLE?{dataType:e.dataType,operate:e.operate,inputOne:e.inputOne,inputTwo:e.inputTwo}:{dataType:d.DATA_TYPE.ID_CARD,operate:"",inputOne:"",inputTwo:""}}},{key:"render",value:function(){return u.default.createElement("div",null,u.default.createElement("div",{className:"form-item-wrap"},u.default.createElement("div",{className:"form-item-label"},"\u9a8c\u8bc1\u6761\u4ef6"),u.default.createElement("div",{className:"form-item-collection"},u.default.createElement("div",null,u.default.createElement(c.default,{defaultValue:d.VALID_TYPE.AVAILABLE,className:"wh-135",onChange:this.props.validTypeCb},u.default.createElement(c.default.Option,{value:d.VALID_TYPE.LIST},"\u4e0b\u62c9\u5217\u8868"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.NUMBER},"\u6570\u5b57"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.TEXT},"\u6587\u672c"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.DATE},"\u65e5\u671f"),u.default.createElement(c.default.Option,{value:d.VALID_TYPE.AVAILABLE},"\u6709\u6548\u6027"))),u.default.createElement("div",{className:"ml-16"},u.default.createElement(c.default,{defaultValue:d.DATA_TYPE.ID_CARD,value:this.state.dataType,className:"wh-135",onChange:this.handleDataTypeChange},u.default.createElement(c.default.Option,{value:d.DATA_TYPE.ID_CARD},"\u8eab\u4efd\u8bc1\u53f7\u7801"))))))}}]),t}(u.default.Component);t.default=f},1788:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BUTTON_TYPE=void 0;var a=d(n(3)),i=d(n(0)),o=d(n(1)),r=d(n(4)),l=d(n(5)),s=d(n(46)),u=d(n(759));n(1789),n(1679);var c=n(249);function d(e){return e&&e.__esModule?e:{default:e}}var p=t.BUTTON_TYPE=void 0;!function(e){e[e.HELP=1]="HELP",e[e.CANCEL=2]="CANCEL",e[e.DELETE=3]="DELETE",e[e.CONFORM=4]="CONFORM"}(p||(t.BUTTON_TYPE=p={}));var f=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.dialogClose=function(){n.app.view.plugins.dataValidationPanel.close()},n.clickCancel=function(){n.clickCb(p.CANCEL)},n.clickDelete=function(){n.clickCb(p.DELETE)},n.clickConform=function(){n.clickCb(p.CONFORM)},n.clickHelp=function(){(0,c.tencentDocOpenUrl)("https://docs.qq.com/doc/DSEZBR2ZWckR5bnh2","_blank")},n.app=n.props.app,n.clickCb=n.props.clickCb,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"validation-footer-wrap"},s.default.createElement("div",{className:"dialog-help-button",onClick:this.clickHelp},s.default.createElement("div",{className:"help-image"}),s.default.createElement("div",{className:"help-label"},"\u5e2e\u52a9")),s.default.createElement("div",{className:"button-group-wrap"},s.default.createElement(u.default,{className:"common-button",onClick:this.clickCancel},"\u53d6\u6d88"),s.default.createElement(u.default,{className:"common-button ml-16",onClick:this.clickDelete},"\u5220\u9664\u9a8c\u8bc1"),s.default.createElement(u.default,{type:"primary",className:"common-button ml-16",onClick:this.clickConform},"\u786e\u5b9a")))}}]),t}(s.default.Component);t.default=f},1789:function(e,t,n){var a=n(1790);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1790:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'.dialog-help-button {\n  cursor: pointer;\n  display: inline-block;\n  line-height: 30px;\n}\n.dialog-help-button .help-image {\n  float: left;\n  width: 16px;\n  height: 30px;\n  margin-right: 7px;\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAbdJREFUOBGNk79Lw0AUx1MtNPgDKiJdREilgoqbKGiRgM4ODlkcpBT3luJW6F9RyGAHB4fOHeqgUCEFwc2gFSxUxFYI2BLR1F+tfl/spQmJ0Aefu/fzcpd75+PcMg2XCJbAJCB5BioogUdgic/SOM4PfRdsArvflsL9wDgDx+CbAsM0QKj4AKyC/4oRMmNhzHPgAnSHMJDQlxdMDUM4HOYVRdkwDENqtVo72Wx2kcV6M+VSjbkDOvM+sL5cKBTWgsFgQJKk82az+ZZKpZar1aqmquorFfVEwHxJOxCBVQydC4VCI7Is35bL5ZdMJnPXbrc/I5HIKMVsQjUinZ3+tkOQfMIc6XR6lud5fz6ff2I+27xEO2BXZfP/qYlEYgYLrCSTSaVSqRiuBNTSNg5BwCPINRqN7WKxeB+Px6+84vB90DWug3GvBPzITi6Xe9A07csrDp9GR6AOc4kgCIFYLDYfjUYnXMG+Q6UFSoA6zCG6rndqtZper9ffHYG+QTUldn17MLb6sYG0U2QdsVa+hkHtOTVQKcfdIE8GXbZAFwb19hgQANsZVIewx0TF5mPySqTWFsFAz/kXt655MkDIA40AAAAASUVORK5CYII=") no-repeat center center;\n  background-size: 16px 16px;\n  position: relative;\n  top: 1px;\n}\n.dialog-help-button .help-label {\n  display: inline;\n  font-size: 12px;\n  color: #777;\n}\n.dialog-help-button:hover .help-image {\n  background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAAXNSR0IArs4c6QAAAZ9JREFUOBGVU79LAnEU10pqUBAjyLAlONA2uakIWhKuwTlosgPp/2gJGrTJkBY3J+GgORvuII5oLB2KGzRJlAw5kDtMex/vvnjylaQPfO593+e99/35zu/jESEpTowRg27YJNsk1olfrjYxfo+zTOM94q5Hmzd8JfGR+IMgigDYY+IOnAXYoPgm8Z04XnKTsfKWO/aJohiq1WrnlmVdm6Z5pSiKxGKuRS5qJivjzIdwGKrV6lmQkM1mb0ajUfeEQJO9aZrWZTlksRMDO8CFzSAcDkfK5fJ9pVL5lGVZtW17IAjC+kyS48RXyOK2ZxCNRi+ZUCwW9wOBwGqpVHphmsfGsAP2VB7dGeZyOTGTyZzm8/lbVVW/uQSqxTPKROyEQ6/Xu9B1/UmSpDsu6AhDPJ9AXJuXkEgkhoVC4dkwjMG8OGl9HAEdxiGZTIbS6fRRKpXa5oJToYkJ0J4cOp2O3W63W41Go88Fp0KdtfIBaYtaeFrmjNDSGmvlD3LQniEntvDboowH4phNMCYHvY3LRIf9BayM4snPxI7gLfjX7/wLLKN16SF+anAAAAAASUVORK5CYII=") no-repeat center center;\n  background-size: 16px 16px;\n}\n.dialog-help-button:hover .help-label {\n  color: #49affd;\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-resolution: 192dpi) {\n  .dialog-help-button {\n    cursor: pointer;\n    display: inline-block;\n    line-height: 30px;\n  }\n  .dialog-help-button .help-image {\n    float: left;\n    width: 16px;\n    height: 30px;\n    margin-right: 7px;\n    background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA85JREFUWAm1V11IU2EY1tT9qJguCEsYqOTEG8duVIpAuxmGaDBI8EZQkLqxS7Ebb6SLXThC6KIuuhG62IWCYaRCaDNEmqEzkZgozEkb2lxMZ9PseSZnnLlzds6WPvBwzr7v/fnO+73f+73LzVGPfIjWgRawAiwFy0DiFxgCd0A3+B08ARWRqyhx7qgDcndBnQp5ikRBFzgOcmGySLeAAmi1g1ZQK2sh/cQxpj+AE2BMSlRuAaUQfgZWSyllMeaFjgNMiUaehDEjxp6DtyXmsh0yQLEJ9IBhsZGLC+CX07mQXGLZ/33XwwAT+AvIHInjmvCCJ/ecYU/rvL6+vmhqaqppc3OzNRqNPg4Gg4/cbndLb2+vmojRNn3QVxziHLBhhEkni4GBgcqhoaEGrVbLI5mCycnJH21tbYspE6kDTEonh4UtYOifgpKGKWg2m4vGxsZa6Hxvby9it9vdo6Oja8vLyz9ra2uvl5SU6Gpqam5EIpHwwsJCiDppUIm5OTAqRKAbPx6AsmDYrVZrdSwWO8U2TKyvrx8KwiaTSb+ystKu0WjyFxcXfY2NjZ+EuTTPWcy9ZQ7wq1lk0gJO4rmxtLTkFzun0sbGxhFyYp/vVVVVjKYa0Ge+UF4VK9z29nY4EAhEZmZmdqSsFxYWajiOLYhJzUuM0WcdF8CjoYjm5ubPckJ9fX0VRqMx/uUejycoJycxbuEWVEhMqB6y2Ww3HQ7HPSrgWMYGBwfXVCvDNxegds9S7HZ1dZXzZOh0ugKE/rizs3N2dXU1kiIoP1DKU/AGzPiy4bHEcXuo1+s14XA42tra+tHlciWVWXm/iZljRiArjIyMmOn8DOjp6ZnLwjn9nnEBbCYyhsViuUWlra2tfafTGcjYwLlCiKeAVas8UwO4AyKoiIfT09O+THVF8iHmQDeYtgqKFC77dZZbwB4uIxgMhvz5+fn7Pp+vDZdTdUbKycJuRoDb8ApUrIaC7vDw8B2c9wb+PgWKi4vfoQacCfMqn+wJnjAC7F5dKpXiYl6vN3HWkQdHWTinHfo8yYtbRDLjyTxgNBSBK/h3CPD7/Qf9/f1fd3d3/ygqJQuwWX0JJq5jTis2JBS6JCQaEnEh4iC716sGfdBXHMIW8Mdf8BvI7pUN5FWARe8FmGhmxAugQ2YmbzNe0Ze9CDq3g0lV8+ICMJ9zALJ1NoEG8DLAsPPLk5zTsNQCOM5ICEezEu+qTgcVL4DZ/h58DSbCLpZhIVIC+4UOkD2c2mIlfMA4dEKgLNQsQFBmFOpA5ge7KC6sDCS4v3TEfjGjv+f/ADypKHwkZbcXAAAAAElFTkSuQmCC") no-repeat center center;\n    background-size: 16px 16px;\n    position: relative;\n    top: 1px;\n  }\n  .dialog-help-button .help-label {\n    font-size: 12px;\n    color: #777;\n    display: inline;\n  }\n  .dialog-help-button:hover .help-image {\n    background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAA8tJREFUWAm1V19IU2EUz9zmZuSQYQxn+LCUiBQWYYgRyMC3oLce/PNQYG+KiKBWD4NGYEzwwSDIB4c9lU8SgoHYDHxQ7B8NZM5QSNpK3Ya62dzs95vdcdV773bn+sHPe3e+851zvnPP933HgjPZoxCq5WAlWAoWg+dAYgfcBbfAVXAdTIAZUZBR49DRNehVgdos9KkSB33gIsjAZKEUAFdsA2tBjawF5YF9DH8BP4KSGZELgOltAi+A+UAQRqbAE9ngKo/DBMFtkN85X2CtWMEfYFRs9HgAXDmdC8Ul1j3tuw4GWMB+kDWSwlnhBU8Gw7QrOrfb7abFxcW2QCDwMB6PD0Uikad+v7/T4XBcFdmSe6Vt+kgvXFwD1zHAapfF8PDwjfb29maNRlMkpTQ/P++pq6t7JTV2TMbdsUCZEAlTbwfFGeF4Gk1NTabBwcEOOt/e3t4cGxt7Mzo6OrWysrJktVrNBoPhvMViqTSZTIHJycn19ETplzKIl8C4kIGb+HFFWvdQyrTbbLaGRCIRb2xsfDQ7OxsS9Ovr640ej+cJgtP5fL7P1dXVz4UxhacXYx+4YmaBh4wisLqLVFheXv4mdk7Z3NxcGDWxxnez2WzhMwvQZyEPGB6v2kwTgsFgIBQKbcHZVyldvV5voHxvb+/INpPS/Sejz3IGwK2RETU1NS/llJxOZy2+fWrlqInvcnoS8kp+glMdOF1dXZd6enru0zi2Zayvr29SwpGcqJQBcAfkhN7e3ssDAwOdWq1Wj9TvIJih6enpTRXGirkL7oGqLxtuy4mJicc6nc4Qi8UiLS0trvHx8Z8qnFN1nxnICS6X6w6dY3Kyv7//RQ7O6feAGbgLGvlLDaLR6DNUfgm3H7aeU81ckW6YqecVqTqAcDi8hXsgtLCw8ElkUO3rLjOQ8RRUa1WFvpc1sKpiQkq1oqKiyOv1PtjY2HCMjIw0qJ0v0l9lBngUt4EZT0NhotvtvtXa2trM38lkct9oNHbggpJsuYQ5Es84ZG5mgBN9EgqyIpx2G8IgHIdycM7p9Jng6onfIG/DrLblzMzMr5KSknUU4c/u7u7XaEhO9Ho0qgA2q+/A9HVM3YwNCZXyhHRDIl4xW+dgnhwomaEP+kpB+AT8cQCugVaQDeT/AP+Degv+EYyLA6CMlcl2ild0voOgc96UETCN4wFwgA0FW2czqNghYzxbMO1c+RHnnCwVAOXMBLcJUQaKayUlzPIPq51H9XswnXbxXB5EmVAMBbbrVWC2h5WwAFa74hbNJgDYSIHZYv/I+sjbv+d/AaiVI7/KJIo0AAAAAElFTkSuQmCC") no-repeat center center;\n    background-size: 16px 16px;\n  }\n  .dialog-help-button:hover .help-label {\n    color: #49affd;\n  }\n}\n',""])},1791:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(0)),i=p(n(1)),o=p(n(46)),r=p(n(308)),l=p(n(759)),s=n(760);n(1792);var u=n(1794),c=p(n(12)),d=n(442);function p(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){var n=this;(0,a.default)(this,e),this.clickRetry=function(){n.close(),n.app.view.canvas.excel.selectCell(n.col,n.row,!1),n.app.view.canvas.excel.inputShowAndSetValue(n.inputValue),n.clickedRetry=!0},this.clickCancel=function(){n.close()},this.app=t,this.dialog=null,this.clickedRetry=!1}return(0,i.default)(e,[{key:"verify",value:function(e,t,n,a){if(!1===a&&!1===this.clickedRetry)return!0;this.dialog&&this.close();var i=(0,s.getErrorMessage)(e,t);if(!i)return!0;this.message=i,this.row=e,this.col=t,this.inputValue=n,console.error("inputValue:",n);var o=(0,u.viewCheckDataValid)(t,e,n);return null==o||!1!==o.isDataValid||!0!==o.dataValidation.isStrict||(this.show(),this.showX=t,this.showY=e,!1)}},{key:"show",value:function(){var e=this;return this.clickedRetry=!1,this.dialog=r.default.confirm({title:"\u6570\u636e\u9a8c\u8bc1",className:"validation-error-dialog",destroyOnClose:!0,style:{width:450},content:this.renderContent(),footer:this.renderFooter(),onCancel:function(){e.app&&e.app.view&&e.app.view.canvas&&e.app.view.canvas.excel.focusInput()}}),c.default.wait(0).run(function(){e.app&&e.app.view&&e.app.view.canvas&&e.app.view.canvas.excel.blurInput()}),this.dialog}},{key:"showMobile",value:function(){var e=this;this.dialogMobile&&this.dialogMobile.showing&&this.dialogMobile.close();var t=this,n={type:"MessageBox",content:this.message,buttons:[{type:"default",label:"\u53d6\u6d88"},{type:"primary",label:"\u91cd\u8bd5",onclick:function(e){var n=t.app.view.canvas.excel;n.inputCenter.board.showing&&n.overActiveEditor(),n.selectCell(t.col,t.row,!1),n.inputShowAndSetValue(t.inputValue),t.clickedRetry=!0,t.dialogMobile.close(),t.dialog=null}}]};c.default.wait(0).run(function(){(0,d.createAlertViewBox)(n).then(function(t){e.dialogMobile=t,e.dialogMobile.show()})})}},{key:"close",value:function(){this.dialog&&this.dialog.close(),this.dialog=null,this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.focusInput()}},{key:"renderContent",value:function(){return o.default.createElement("div",{className:"validation-error-body"},this.message)}},{key:"renderFooter",value:function(){return o.default.createElement("div",{className:"validation-error-footer-wrap"},o.default.createElement("div",{className:"button-group-wrap"},o.default.createElement(l.default,{className:"common-button",onClick:this.clickCancel},"\u53d6\u6d88"),o.default.createElement(l.default,{type:"primary",className:"common-button m-16",onClick:this.clickRetry},"\u91cd\u8bd5")))}}]),e}();t.default=f},1792:function(e,t,n){var a=n(1793);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1793:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'.validation-error-dialog .dui-dialog-title {\n  font-family: "PingFangSC-Medium", "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  font-size: 16px;\n  color: #333333;\n}\n.validation-error-dialog .dui-dialog-content,\n.validation-error-dialog .validation-error-footer-wrap {\n  font-family: "PingFangSC-Regular", "PingFang SC", "Microsoft YaHei", "\u9ed1\u4f53", "\u5b8b\u4f53", sans-serif;\n  font-size: 14px;\n}\n.validation-error-dialog .m-16 {\n  margin-left: 16px;\n}\n.validation-error-dialog .validation-error-footer-wrap {\n  margin-top: 25px;\n}\n.validation-error-dialog .validation-error-footer-wrap .button-group-wrap {\n  float: right;\n}\n.validation-error-dialog .validation-error-footer-wrap .button-group-wrap .common-button {\n  height: 30px;\n  width: 76px;\n  padding: 0;\n}\n',""])},1794:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.rowColChangeUpdateUserEnter=t.viewCheckDataValid=t.removeDvNodeFromGraph=void 0;var a=n(313),i=n(98),o=n(44),r=d(n(60)),l=d(n(11)),s=d(n(7)),u=d(n(773)),c=n(448);function d(e){return e&&e.__esModule?e:{default:e}}new u.default(50,10);var p=new u.default(200,30);t.removeDvNodeFromGraph=function(e){};t.viewCheckDataValid=function(e,t,n){var r=s.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(t,e);if(null==r)return null;var l=r.getEffectiveValue();if(null==n&&(n=l&&l.value),""===n)return null;var u=r.getUserEnteredFormat(),d=u&&u.getDataValidation();if(d&&null!=n){var p=function(e,t,n,r,l){var u=s.default.window.SpreadsheetApp,c=l||u.spreadsheet.activeSheet.getSheetId(),d=(0,a.transformDV2Formula)(e),p=function(e,t){var n=e.sheetId,a=e.calculator;if(t){var i=t.calcController.getResultBySingleFormula(a,n).result;if(null!=i)return!0===i||"TRUE"===i}return null}({calculator:(0,i.replaceAll)(d,"$SLOT",(0,i.wrapValue)((0,i.getRealValue)(r),e)||(0,o.toCellId)(t,n)),col:n,row:t,sheetId:c},u);return p=!0===p}(d,t,e,n)&&(0,c.checkNumberFormat)(n,d);if(null!=p)return{isDataValid:p,dataValidation:d,cell:(0,o.toCellId)(t,e)}}return null},t.rowColChangeUpdateUserEnter=function(e,t,n){p.setTask(function(){var n=s.default.window.SpreadsheetApp;if(!n)return null;var a=!1,u=(e.row,e.col,e.sheetId),c=t.newRow,d=t.newCol,p=n.spreadsheet.activeSheet.getCellDataAtPosition(c,d),f=p&&p.getUserEnteredFormat(),h=f&&f.getDataValidation();if(null===h)return null;var m=h.argTokens&&h.argTokens.map(function(n){var l=n.userEnteredValue;if((0,o.isFormula)(l)){var s=function(e,t,n,a){var i=t.row,o=t.col,l=t.sheetId;return r.default.string2FormulaModel(e,i,o,l).toString(n.newRow,n.newCol)}(l,e,t);if(!(0,i.isFromulaError)(s))return{userEnteredValue:s};a=!0}return n});if(a)return null;var v={gridRange:new l.default(u,c,c,d,d),dataValidation:{ruleType:h.ruleType,inputMessage:h.inputMessage,isStrict:h.isStrict,showDropDown:h.showDropDown,operator:h.operator,argTokens:m}};s.default.event.spreadsheetEvent.trigger("updateCellDataDV",v)})}},1795:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=w(n(41)),i=w(n(14)),o=w(n(0)),r=w(n(1)),l=w(n(46));n(774);var s=w(n(7)),u=w(n(759)),c=w(n(308)),d=w(n(1796)),p=w(n(1797)),f=n(776),h=n(777),m=n(1798),v=n(200),g=n(82),b=w(n(12)),y=w(n(8)),E=n(22),_=w(n(89));function w(e){return e&&e.__esModule?e:{default:e}}var T=function(){function e(t){var n=this;(0,o.default)(this,e),this.resetPosition=function(){if(n.dialog&&n.app.view.canvas.plugins.filterHeader){var e=n.calcPosition(),t=e.top,a=e.left;n.dialog.update({style:{width:n.MODALWIDTH,position:"absolute",top:t+"px",left:a+"px"}})}},this.toggle=function(e){n.showing?n.hide():n.show(e)},this.show=function(e){if(!n.dialog&&n.app.view.canvas.plugins.filterHeader){var t=e.okCb,a=void 0===t?function(){}:t,i=e.cancelCb,o=void 0===i?function(){}:i,r=e.onClose,l=e.filter,u=e.row,d=e.col,p=e.range;n.okCb=a,n.cancelCb=o,n.onClose=r,n.range=p,n.col=d,n.row=u,n.addUp(l,d);var f=n.result.filter(function(e){return e.visible}).map(function(e){return e.key}),h=f.length===n.result.length;n.state={hidden:!1,tempResultList:n.result,filterResultList:n.result,lastListNotHideAll:n.result,keyWord:"",values:f,selectAll:h,isHideAll:!1};var m=n.calcPosition(),v=m.top,y=m.left;n.dialog=c.default.confirm({title:null,style:{width:n.MODALWIDTH,position:"absolute",top:v+"px",left:y+"px"},className:"filter-panel-container",mask:!1,closable:!1,draggable:!0,content:n.renderContent(),footer:n.renderFooter(),destroyOnClose:!0}),n.clickTimeId=b.default.wait(300).run(function(){n.registerDocumentClick()}),n.wheelTimeId=b.default.wait(150).run(function(){n.registerDocumentOnmousewheel()}),s.default.event.default.listen("enterInputStatus",n.clickCancel),s.default.event.toolBar.trigger(g.EVENT_NAME.UI_SHOW,"filter-panel-pc"),n.showing=!0}},this.addUp=function(e,t){var a=(0,f.addUp)(e,t,n.app.spreadsheet),i=a.resultList,o=a.currentColValue;n.result=i,n.currentColValue=o},this.close=function(){n.showing&&(n.dialog&&n.dialog.close(),n.dialog=null,E.isPad?(n.tapListener&&n.tapListener.removeListener(),n.tapListener=null):document.removeEventListener("click",n.oldDocumentClick),s.default.event.default.remove("enterInputStatus",n.clickCancel),s.default.event.default.remove("tableMove",n.hide),b.default.erase(n.clickTimeId),b.default.erase(n.wheelTimeId),n.onClose&&n.onClose(),s.default.event.toolBar.trigger("filterPanelHide"),n.showing=!1)},this.hide=function(){n.showing&&(n.close(),n.showing=!1)},this.clickOk=function(){n.confirmHandler(),n.hide(),n.okCb()},this.confirmHandler=function(){var e=n.state,t=e.tempResultList,a=e.keyWord,i=n.hot,o=n.col,r=n.currentColValue;n.isShowListStatusChagned()&&(0,h.filterPanelConfirmHandler)({tempResultList:t,keyWord:a,currentColValue:r,hot:i,col:o}),n.hide(),s.default.window.SpreadsheetApp&&s.default.window.SpreadsheetApp.view&&s.default.window.SpreadsheetApp.view.canvas.excel.focusInput()},this.clickCancel=function(){n.hide(),n.cancelCb(),s.default.window.SpreadsheetApp&&s.default.window.SpreadsheetApp.view&&s.default.window.SpreadsheetApp.view.canvas.excel.focusInput()},this.setStateTempResultList=function(e){var t=e.length===n.state.filterResultList.length,a=n.result.map(function(t){return(0,i.default)({},t,{visible:e.indexOf(t.key)>-1})});n.setLastListNotHideAll(a),n.setState((0,i.default)(n.state,{values:e,selectAll:t,tempResultList:a}))},this.setKeyword=function(e){var t=n.result.filter(function(t){return-1!==t.key.toLowerCase().indexOf(e.toLowerCase())}).map(function(e){return(0,i.default)({},e,{visible:!0})}),a=t.map(function(e){return e.key});n.setLastListNotHideAll(t),n.setState((0,i.default)(n.state,{filterResultList:t,keyWord:e,values:a,tempResultList:t}))},this.setSelectAll=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=(arguments[1],[]);return e&&(t=n.state.filterResultList.map(function(e){return e.key})),n.setStateTempResultList(t)},this.registerDocumentClick=function(){E.isPad?n.tapListener=(0,m.addTap2)(document,n._documentTouchEndHandler=n._onDocumentTouchEnd.bind(n)):document.addEventListener("click",n.oldDocumentClick=n._oldDocumentClick.bind(n))},this._oldDocumentClick=function(e){var t=document.querySelector(".filter-panel-container");if(!1!==e.isTrusted){var a=e.target;if(t){if(a===t||t.contains(a)||a.classList&&a.classList.contains("filter-span"))return;document.removeEventListener("click",n.oldDocumentClick),n.clickCancel()}}},this.registerDocumentOnmousewheel=function(){s.default.event.default.listen("tableMove",n.hide)},this.setOrder=function(e){var t=[],a=n.hot.getActiveSheetId(),i=new _.default.Range.GridRange(a,0,0,0,0),o=n.state,r=o.tempResultList,l=o.keyWord,s=n.hot,u=n.col,c=n.currentColValue;switch(e){case"asc":t.push({type:1,column:n.col}),i=n.range;break;case"desc":t.push({type:0,column:n.col}),i=n.range}(0,h.reorderWithFilterHandler)({tempResultList:r,keyWord:l,currentColValue:c,hot:s,col:u},{options:t,hasTitle:!0,gridRange:i}),n.hide(),n.okCb()},this.setAscOrder=function(){n.setOrder("asc"),s.default.window&&y.default.tdwReport({opername:"doc_edit",module:"excel_search",action:"clk_count_asc"})},this.setDescOrder=function(){n.setOrder("desc"),s.default.window&&y.default.tdwReport({opername:"doc_edit",module:"excel_search",action:"clk_count_desc"})},this.app=t,this.hot=t.spreadsheet,this.dialog=null,this.showing=!1,this.currentColValue={},this.MODALWIDTH=280,this.MODALHEIGHT=535,this.oldInnerInfo={innerHeight:s.default.window.innerHeight,innerWidth:s.default.window.innerWidth,isPortrait:(0,v.isPortrait)()}}return(0,r.default)(e,[{key:"isShowing",value:function(){return this.showing}},{key:"calcPosition",value:function(){var e=this.row,t=this.col,n=this.app.view.canvas.excel,i=this.app.view.canvas.plugins.filterHeader.getAABB(e,t),o=(0,a.default)(i,4),r=o[0],l=o[1],u=(o[2],o[3]);r+=n.configData.distanceX,l+=n.configData.distanceY+u+2;var c=s.default.window.innerWidth,d=s.default.window.innerHeight;return r+this.MODALWIDTH>c&&(r=c-this.MODALWIDTH),l+this.MODALHEIGHT>d&&(l=d-this.MODALHEIGHT),{left:r=Math.max(n.configData.distanceX+2+n.configData.rowHeadWidth,r),top:l=Math.max(n.configData.distanceY+2+n.configData.colHeadHeight,l)}}},{key:"makeSureInputAtTop",value:function(e){var t=e+160,n=(0,v.isPortrait)()?390:450;E.isQQ?(n+=parseInt((document.body.offsetHeight/10).toString())+50,(0,v.isPortrait)()&&(n+=60)):(0,v.inWhichSplitView)()<.66&&(n+=44);var a=document.body.offsetHeight-(t+54);return e-=Math.max(n-a,0)}},{key:"setState",value:function(e){this.state=e,this.dialog.update({content:this.renderContent(),footer:this.renderFooter()})}},{key:"isShowListStatusChagned",value:function(){var e=this.result,t=this.state.tempResultList,n=function(e){var t={};return e.map(function(e){t[e.key]=e.visible}),t},a=n(e),i=n(t),o=t.every(function(e){return e.visible===a[e.key]}),r=e.every(function(e){return e.visible===i[e.key]});return!(o&&r)}},{key:"setLastListNotHideAll",value:function(e){var t=e.every(function(e){return!1===e.visible});if(!t){var n=e.map(function(e){return(0,i.default)({},e)});this.setState((0,i.default)(this.state,{lastListNotHideAll:n}))}this.setState((0,i.default)(this.state,{isHideAll:t}))}},{key:"_onDocumentTouchEnd",value:function(e,t){var n=document.querySelector(".filter-panel-container"),a=t.target;if(n){if(a===n||n.contains(a)||a.classList&&(a.classList.contains("filter-span")||a.classList.contains("select-area")))return;this.clickCancel()}}},{key:"renderContent",value:function(){return l.default.createElement("div",{style:{width:"100%"}},l.default.createElement("div",{className:"filterbox-list-title"},"\u6392\u5e8f"),l.default.createElement("div",{style:{marginBottom:20}},l.default.createElement(u.default,{style:{marginRight:16},onClick:this.setAscOrder},"\u5347\u5e8f"),l.default.createElement(u.default,{onClick:this.setDescOrder},"\u964d\u5e8f")),l.default.createElement("div",{className:"filterbox-list-title"},"\u6309\u641c\u7d22\u7b5b\u9009"),l.default.createElement("div",{className:"filterbox-menu"},l.default.createElement("div",{className:"goog-menu-filter"},l.default.createElement(p.default,{callback:this.setKeyword})),l.default.createElement(d.default,{data:this.state.filterResultList,values:this.state.values,selectAll:this.state.selectAll,handleClickItem:this.setStateTempResultList,handleClickSelectAll:this.setSelectAll})))}},{key:"renderFooter",value:function(){return l.default.createElement("div",{className:"range-selection-footer-wrap"},l.default.createElement("div",{className:"button-group-wrap"},l.default.createElement(u.default,{className:"common-button",onClick:this.clickCancel,onTouchEnd:this.clickCancel},"\u53d6\u6d88"),l.default.createElement(u.default,{type:"primary",className:"common-button m-16",style:{marginLeft:"10px"},onClick:this.clickOk,onTouchEnd:this.clickOk,disabled:this.state.isHideAll},"\u786e\u5b9a")))}}]),e}();t.default=T},1796:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),i=c(n(0)),o=c(n(1)),r=c(n(4)),l=c(n(5)),s=c(n(46)),u=c(n(1698));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.handleSelectAllChange=function(e,t){e.indexOf("filter_panel_selectAll")>-1?n.props.handleClickSelectAll():n.props.handleClickSelectAll(!1)},n.handleItemChange=function(e,t){n.props.handleClickItem(e)},n.state={data:n.props.data},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){var e={key:"filter_panel_selectAll",displayValue:"\u5168\u90e8"},t=e.key;return s.default.createElement("div",{className:"waffle-filterbox-list-body goog-zippy-content"},s.default.createElement(u.default.Group,{values:this.props.values.length===this.props.data.length?["filter_panel_selectAll"]:[],onChange:this.handleSelectAllChange},0!==this.props.data.length?function(e,t){return s.default.createElement(u.default,{value:e.key,key:t,style:{paddingBottom:"10px",paddingTop:0},hollow:!0},s.default.createElement("div",{className:"dui-checkbox-label"},e.displayValue||e.key||"\uff08\u7a7a\u767d\u5355\u5143\u683c\uff09"))}(e,t):s.default.createElement("div",{className:"empty-wrap"},s.default.createElement("div",{className:"empty-wording"},"\u6ca1\u6709\u5339\u914d\u7684\u6570\u636e"))),s.default.createElement(u.default.Group,{onChange:this.handleItemChange,values:this.props.values},this.props.data.map(function(e,t){return function(e,t){var n=e.key||"\uff08\u7a7a\u767d\u5355\u5143\u683c\uff09";return s.default.createElement(u.default,{value:e.key,key:t,style:{paddingBottom:"10px",paddingTop:0},hollow:!0},s.default.createElement("div",{className:"dui-checkbox-label"},n))}(e,t)})))}}]),t}(s.default.Component);t.default=d},1797:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),i=c(n(0)),o=c(n(1)),r=c(n(4)),l=c(n(5)),s=c(n(46)),u=n(775);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.onKeyDown=function(e){var t=!0;switch(e.keyCode){case u.ENTER:case u.ARROW_UP_KEYCODE:case u.ARROW_DOWN_KEYCODE:break;case u.ESCAPE:t=!1;break;default:t=!0}t&&e.stopPropagation()},n.onInputSearch=function(e){if(!n.state.searchHidden){var t=e.currentTarget.value.trim();n.props.callback(t),n.setState({search:t})}},n.onMouseDown=function(e){e.stopPropagation()},n.state={search:"",searchHidden:!1},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){}},{key:"render",value:function(){var e=this;return s.default.createElement("div",{className:"filter-search-container filter-search-container"},s.default.createElement("div",{className:"dropdown-search"},s.default.createElement("i",{className:"dropdown-search-icon"}),s.default.createElement("input",{placeholder:"",ref:function(t){return e.searchinput=t},className:"search-ipt",onChange:function(){},value:this.state.search,onKeyDown:this.onKeyDown,onInput:this.onInputSearch,onMouseDown:this.onMouseDown})))}}]),t}(s.default.Component);t.default=d},1798:function(e,t,n){"use strict";function a(e,t,n){var a=t.style,i=a.display,o=a.position,r=a.visibility;t.style.display="block",t.style.position="absolute",t.style.visibility="hidden";var l=e[n];return t.style.display=i,t.style.position=o,t.style.visibility=r,l}Object.defineProperty(t,"__esModule",{value:!0}),t.addTap=function(e,t){return e.addEventListener("touchstart",function(e){var t=e.touches[0];this.touchX=t.clientX,this.touchY=t.clientY,this.touchT=Date.now()}),e.addEventListener("touchend",function(t){var n=t.changedTouches[0],a=n.clientX,i=n.clientY;if(!(void 0===this.touchT||Date.now()>this.touchT+160||Math.abs(i-this.touchY)>30||Math.abs(a-this.touchX)>30))if(e.ontap)e.ontap();else{var o=void 0;"function"===typeof Event.prototype.initEvent?(o=document.createEvent("HTMLEvents")).initEvent("tap",!1,!0):o=new Event("tap",{bubbles:!1,cancelable:!0}),e.dispatchEvent(o)}}),e.addEventListener("tap",t,!1),e},t.addTap2=function(e,t){var n=void 0,a=void 0,i=void 0,o=void 0,r=function(e){var t=e.touches[0];n=t.clientX,a=t.clientY,i=Date.now()},l=function(t){var r=t.changedTouches[0],l=r.clientX,s=r.clientY;if(!(void 0===i||Date.now()>i+160||Math.abs(s-a)>30||Math.abs(l-n)>30))if(o=t,e.ontap)e.ontap();else{var u=void 0;"function"===typeof Event.prototype.initEvent?(u=document.createEvent("HTMLEvents")).initEvent("tap",!1,!0):u=new Event("tap",{bubbles:!1,cancelable:!0}),e.dispatchEvent(u)}},s=function(e){t(e,o)};return e.addEventListener("touchstart",r),e.addEventListener("touchend",l),e.addEventListener("tap",s,!1),{dom:e,removeListener:function(){e.removeEventListener("touchstart",r),e.removeEventListener("touchend",l),e.removeEventListener("tap",s,!1)}}},t.addClick=function(e,t){return e.addEventListener("click",t,!1),e},t.addClass=function(e,t){if(!e)return;e.classList.add(t)},t.removeClass=function(e,t){if(!e)return;e.classList.remove(t)},t.showComponent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"display";if(!e)return;switch(t){case"display":"none"!==e.style.display&&""!==e.style.display||(e.style.display="block");break;case"visibility":"hidden"!==e.style.visibility&&""!==e.style.visibility||(e.style.visibility="visible")}},t.hideComponent=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"display";if(!e)return;switch(t){case"display":e.style.display="none";break;case"visibility":e.style.visibility="hidden"}},t.setStyle=function(e,t,n){if(!e)return;e.style[t]=n},t.$$=function(e){return document.querySelector(e)},t.isPortrait=function(){if("number"==typeof window.orientation)return window.orientation/90%2==0;try{var e=window.screen.orientation.angle;if("number"==typeof e)return e/90%2==0}catch(t){}return!0},t.getHiddenClientWidth=function(e,t){return a(e,t,"clientWidth")},t.getHiddenClientHeight=function(e,t){return a(e,t,"clientHeight")}},1799:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.USER_OPTION=void 0;var a=c(n(0)),i=c(n(1)),o=c(n(46)),r=c(n(308)),l=c(n(1800));n(1802);var s=c(n(1804)),u=c(n(7));function c(e){return e&&e.__esModule?e:{default:e}}var d=t.USER_OPTION=void 0;!function(e){e.EXTEND="extend",e.NOT_EXTEND="not-extend"}(d||(t.USER_OPTION=d={}));var p=function(){function e(t){var n=this;(0,a.default)(this,e),this.showCustom=function(e){n.customPanel.show(e)},this.showBlankTips=function(){n.dialog=r.default.confirm({onOk:function(){},okText:"\u786e\u5b9a",style:{WebkitTapHighlightColor:"transparent"},cancelText:"",content:"\u4f60\u9009\u4e2d\u7684\u533a\u57df\u6ca1\u6709\u5185\u5bb9\uff0c\u65e0\u6cd5\u8fdb\u884c\u6392\u5e8f\u3002",className:"sort-relatvie-dialog",mask:!0,closable:!0,draggable:!1,destroyOnClose:!0})},this.showRelativeTips=function(e){var t=e.onCancel,a=e.onOk;n.dialog=r.default.confirm({title:"\u6392\u5e8f\u63d0\u793a",onOk:a,onCancel:t,style:{WebkitTapHighlightColor:"transparent"},okText:"\u786e\u5b9a",content:"\u4f60\u6392\u5e8f\u7684\u533a\u57df\u5f15\u7528\u4e86\u5176\u4ed6\u5355\u5143\u683c\uff08\u5982\u201c=A1\u201d\uff09\uff0c\u53ef\u80fd\u5bfc\u81f4\u6392\u5e8f\u540e\u5185\u5bb9\u53d1\u751f\u53d8\u5316\u3002\u5982\u5e0c\u671b\u5185\u5bb9\u4e0d\u53d8\uff0c\u8bf7\u4fee\u6539\u5f15\u7528\u683c\u5f0f\uff08\u5982\u201c=$A$1\u201d\uff09\u3002\u786e\u5b9a\u7ee7\u7eed\uff1f",className:"sort-relatvie-dialog",mask:!0,closable:!0,draggable:!1,destroyOnClose:!0})},this.show=function(e){n.initEvent();var t=e.onOk,a=void 0===t?function(){}:t,i=e.onCancel,o=void 0===i?function(){}:i;n.dialog=r.default.confirm({title:"\u6392\u5e8f\u8303\u56f4\u63d0\u9192",mask:!0,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){n.hide(),a(n.value)},onCancel:function(){n.hide(),o()},closable:!0,draggable:!1,content:n.renderContent()}),n.app.event.default.trigger("sort-panel-show")},this.hide=function(){n.dialog&&n.dialog.close(),n.removeEvent(),n.app.event.default.trigger("sort-panel-hide")},this.onChange=function(e){n.value=e,console.warn("\u5f53\u524d\u7684value",n.value)},this.app=t,this.value=d.EXTEND,this.customPanel=new s.default(t)}return(0,i.default)(e,[{key:"initEvent",value:function(){u.default.event.sheetsBar.listen("switchSheet",this.hide)}},{key:"removeEvent",value:function(){u.default.event.sheetsBar.remove("switchSheet",this.hide)}},{key:"renderContent",value:function(){return this.value=d.EXTEND,o.default.createElement("div",null,o.default.createElement("div",{className:"sort-range-panel-desc"},"\u4f60\u7684\u9009\u5b9a\u533a\u57df\u65c1\u8fb9\u8fd8\u6709\u6570\u636e\u3002\u7531\u4e8e\u4f60\u6ca1\u6709\u9009\u4e2d\u8fd9\u4e9b\u6570\u636e\uff0c\u6392\u5e8f\u65f6\u5c06\u4e0d\u518d\u5305\u62ec\u8fd9\u4e9b\u6570\u636e\u3002\u8bf7\u51b3\u5b9a\u5982\u4f55\u6392\u5e8f\uff1a"),o.default.createElement(l.default.Group,{onChange:this.onChange,defaultValue:d.EXTEND},o.default.createElement(l.default,{value:d.EXTEND},o.default.createElement("span",null,"\u6269\u5927\u9009\u5b9a\u8303\u56f4")),o.default.createElement(l.default,{value:d.NOT_EXTEND},o.default.createElement("span",null,"\u4fdd\u6301\u5f53\u524d\u9009\u5b9a\u8303\u56f4"))))}}]),e}();t.default=p},1800:function(e,t,n){"use strict";var a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var i=a(n(1739));t.Radio=i.default;var o=a(n(1801));n(197).injectStyle(".dui-radio{position:relative;padding-left:20px;font-size:14px;line-height:20px;color:rgba(0,0,0,.88);-webkit-tap-highlight-color:transparent}.dui-radio-multi-line{padding-left:24px}.dui-radio-icon{position:absolute;left:0;top:2px;width:16px;height:16px;border:1px solid rgba(0,0,0,.16);border-radius:50%;-webkit-box-sizing:border-box;box-sizing:border-box;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-webkit-align-items:center;-ms-flex-align:center;align-items:center;background:#fff}.dui-radio:hover .dui-radio-icon{border-color:rgba(0,0,0,.32)}.dui-radio-checked .dui-radio-icon,.dui-radio-checked:hover .dui-radio-icon{border-color:#0188fb}.dui-radio-hollow.dui-radio-checked .dui-radio-icon:after{content:'';display:block;width:6px;height:6px;border-radius:50%;background-color:#0188fb}.dui-radio-normal.dui-radio-checked .dui-radio-icon{border-width:5px}.dui-radio-disabled .dui-radio-label{opacity:.36}.dui-radio-disabled .dui-radio-icon,.dui-radio-disabled:hover .dui-radio-icon{border-color:rgba(0,0,0,.08)}.dui-radio-disabled.dui-radio-checked .dui-radio-icon:after{background-color:rgba(0,0,0,.08)}.dui-radio:not(.dui-radio-disabled) .dui-radio-input{cursor:pointer}.dui-radio-input{position:absolute;margin:0;opacity:0;left:0;top:0;height:100%;width:100%}"),i.default.Group=o.default,t.default=i.default},1801:function(e,t,n){"use strict";var a=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};return function(t,n){function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}(),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t},o=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(46)),l=i(n(141)),s=o(n(142)),u=n(171),c=n(1714),d=o(n(1739)),p=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={value:t.props.defaultValue},t.handleSingleChange=function(e,n){t.props.disabled||(t.setState({value:n.target.value}),t.props.onChange(n.target.value,n))},t}return a(t,e),t.getDerivedStateFromProps=function(e,t){return"value"in e?{value:e.value}:null},t.prototype.render=function(){var e=this.props,t=e.prefixCls,n=e.className,a=e.style,i=e.itemStyle,o=s.default(t,n);return r.createElement("div",{className:o,style:a},c.renderChildren(this.props,[this.state.value],this.handleSingleChange,d.default,i))},t}(r.Component);t.default=p,p.defaultProps={prefixCls:"dui-radio-group",disabled:!1,onChange:u.emptyFn},p.propTypes={prefixCls:l.string,style:l.object,className:l.string,options:l.array,disabled:l.bool,defaultValue:l.any,value:l.any,onChange:l.func,itemStyle:l.object,children:l.node}},1802:function(e,t,n){var a=n(1803);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1803:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".sort-range-panel-desc {\n  padding-bottom: 20px;\n}\n",""])},1804:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=b(n(24)),i=b(n(3)),o=b(n(0)),r=b(n(1)),l=b(n(4)),s=b(n(5)),u=b(n(46)),c=b(n(308)),d=b(n(1698)),p=b(n(1683));n(1805);var f=n(206),h=b(n(7)),m=n(450),v=b(n(12)),g=b(n(8));function b(e){return e&&e.__esModule?e:{default:e}}var y=function(e,t){var n=h.default.window.SpreadsheetApp.view.canvas.excel.tableData.getCellDataAtPosition(e,t),a=n&&n.text?n.text+"":"";return 0==a.length&&(a="(\u7a7a\u767d)"),a},E=function(e){for(var t=[],n=e.startColIndex;n<=e.endColIndex;n++){var a={column:n,columnTitle:(0,f.toColumnName)(n+1),firstRowContent:y(e.startRowIndex,n)};t.push(a)}var i={};return t.forEach(function(e){i[e.firstRowContent]||(i[e.firstRowContent]=0),i[e.firstRowContent]+=1}),t.forEach(function(e){var t=e.firstRowContent+"";e.firstRowContent=t.substr(0,4)+(t.length>4?"...":""),(i[t]>=2||"(\u7a7a\u767d)"===t)&&(e.firstRowContent+=" ("+e.columnTitle+"\u5217)")}),t},_=[],w=void 0,T=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));n.state={sortBasis:[]},n.renderSortBasisList=function(e,t){var i=u.default.createElement("div",{className:"sort-basis-label"},0===t?"\u6392\u5e8f\u4f9d\u636e":""),o=u.default.createElement("div",{className:"sort-column"},u.default.createElement(p.default,{value:e.column+"",onChange:function(e){n.state.sortBasis[t].column=parseInt(e),n.setState({sortBasis:[].concat((0,a.default)(n.state.sortBasis))})},style:{width:"180px"},listStyle:{maxHeight:"200px",height:"auto",width:"180px"}},n.sortColumns.map(function(t,a){return u.default.createElement(p.default.Option,{key:a,value:t.column+"",disabled:n.handleSortColumnSelectDisable(t.column,e.column)},u.default.createElement("div",{className:"select-column-option select-column-option-label"},t.firstRowContent))}))),r=u.default.createElement("div",{className:"sort-order"},u.default.createElement(p.default,{value:e.type+"",onChange:function(e){n.state.sortBasis[t].type=0===parseInt(e)?m.ReorderType.ReverseOrder:m.ReorderType.PositiveSequence,n.setState({sortBasis:[].concat((0,a.default)(n.state.sortBasis))})},style:{width:"150px"}},u.default.createElement(p.default.Option,{value:m.ReorderType.PositiveSequence+""},n.renderSortOrderSelectOption("\u5347\u5e8f","A\u2192Z")),u.default.createElement(p.default.Option,{value:m.ReorderType.ReverseOrder+""},n.renderSortOrderSelectOption("\u964d\u5e8f","Z\u2192A")))),l=0===t?"":u.default.createElement("div",{className:"delete-sort-basis-btn",onClick:n.deleteSortBasis.bind(n,t)});return u.default.createElement("div",{className:"sort-basis-list-item",key:t},i,o,r,l)},n.handleSortColumnSelectDisable=function(e,t){return!!n.state.sortBasis.find(function(n){return e===n.column&&e!==t})},n.renderSortOrderSelectOption=function(e,t){return u.default.createElement("div",{className:"sort-order-option"},u.default.createElement("div",{className:"sort-order-option-label"},e),u.default.createElement("div",{className:"sort-order-option-placeholder"},t))},n.deleteSortBasis=function(e){n.state.sortBasis.splice(e,1),n.setState({sortBasis:[].concat((0,a.default)(n.state.sortBasis))})},n.addSortBasis=function(){var e=n.sortColumns.find(function(e){return!n.state.sortBasis.find(function(t){return e.column===t.column})}),t=n.state.sortBasis;if(e){var i={type:t[t.length-1].type,column:e.column};n.setState({sortBasis:[].concat((0,a.default)(n.state.sortBasis),[i])}),v.default.wait(0).run(function(){var e=document.querySelector(".sort-basis-list .sort-basis-list-item:last-of-type");e&&e.scrollIntoView&&e.scrollIntoView()})}},n.title=e.title,n.range=e.range;var r=h.default.window.SpreadsheetApp.view.canvas.excel.selectData.active;n.currActive={xIndex:r.xIndex,yIndex:r.yIndex},n.sortColumns=E(n.range);var s={type:m.ReorderType.PositiveSequence,column:n.sortColumns[0].column};return n.state={sortBasis:[s]},n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"render",value:function(){var e=this;_=this.state.sortBasis,w=this.title;var t=u.default.createElement("div",{className:"first-row-participate-sort"},u.default.createElement(d.default,{onChange:function(t){e.title=t,w=e.title},defaultChecked:this.title,disabled:this.range.startRowIndex===this.range.endRowIndex},"\u9996\u884c\u662f\u6807\u9898\u884c")),n=u.default.createElement("div",{className:"sort-basis-list"},this.state.sortBasis.map(function(t,n){return e.renderSortBasisList(t,n)})),a=u.default.createElement("div",{className:"add-sort-basis",onClick:this.addSortBasis.bind(this)},u.default.createElement("div",{className:"add-sort-basis__button"}),u.default.createElement("div",{className:"add-sort-basis__label"},"\u6b21\u8981\u6392\u5e8f\u4f9d\u636e"));return u.default.createElement("div",null,t,n,a)}}]),t}(u.default.Component),I=function(){function e(t){var n=this;(0,o.default)(this,e),this.show=function(e){var t=e.onOk,a=void 0===t?function(){}:t,i=e.onCancel,o=void 0===i?function(){}:i,r=e.title,l=void 0!==r&&r;n.title=l;var s=n.app.view.canvas.excel;s.blurInput(),n.dialog=c.default.confirm({title:"\u81ea\u5b9a\u4e49\u6392\u5e8f",className:"custom-sort-dialog",mask:!0,okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88",onOk:function(){n.hide(),s.focusInput(),a(_,w),h.default.window&&g.default.tdwReport({opername:"doc_edit",module:"excel_rank",action:"clk_count_ok",ver1:_.length}),h.default.window&&g.default.tdwReport({opername:"doc_edit",module:"excel_rank",action:w?"clk_check":"clk_not_check"})},onCancel:function(){n.hide(),s.focusInput(),o()},closable:!0,draggable:!0,content:n.renderContent(e),onClickMask:function(e){var t=e.target;t&&(t.classList.add("active"),v.default.wait(500).run(function(){t.classList.remove("active")}))},maskStyle:{background:"transparent"}})},this.hide=function(){n.dialog&&n.dialog.close()},this.app=t,this.dialog=null,this.title=!1}return(0,r.default)(e,[{key:"renderContent",value:function(e){var t=e.range,n=e.title;return u.default.createElement(T,{range:t,title:n})}}]),e}();t.default=I},1805:function(e,t,n){var a=n(1806);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1806:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'.custom-sort-dialog {\n  width: 489px !important;\n  height: auto;\n}\n.active .custom-sort-dialog {\n  -webkit-animation: shake 100ms 1 linear !important;\n          animation: shake 100ms 1 linear !important;\n}\n.custom-sort-dialog,\n.custom-sort-dialog * {\n  outline: none;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  -webkit-tap-highlight-color: transparent;\n}\n@-webkit-keyframes shake {\n  0% {\n    -webkit-transform: translate(6px, 0);\n            transform: translate(6px, 0);\n  }\n  50% {\n    -webkit-transform: translate(-6px, 0);\n            transform: translate(-6px, 0);\n  }\n  100% {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n  }\n}\n@keyframes shake {\n  0% {\n    -webkit-transform: translate(6px, 0);\n            transform: translate(6px, 0);\n  }\n  50% {\n    -webkit-transform: translate(-6px, 0);\n            transform: translate(-6px, 0);\n  }\n  100% {\n    -webkit-transform: translate(0, 0);\n            transform: translate(0, 0);\n  }\n}\n.first-row-participate-sort {\n  display: inline-flex;\n  opacity: 0.88;\n  font-family: "PingFangSC-Regular";\n  font-size: 14px;\n  color: #000000;\n  line-height: 20px;\n}\n.select-column-option {\n  display: flex;\n  justify-content: space-between;\n  width: 120px;\n}\n.sort-order-option {\n  display: flex;\n  justify-content: space-between;\n  width: 114px;\n}\n.select-column-option-label,\n.sort-order-option-label {\n  opacity: 0.8;\n  font-family: "PingFangSC-Regular";\n  font-size: 14px;\n  color: #000000;\n  line-height: 20px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.sort-order-option-placeholder {\n  opacity: 0.4;\n  font-family: "PingFangSC-Regular";\n  font-size: 14px;\n  color: #000000;\n  line-height: 20px;\n  width: 56px;\n  text-align: right;\n  overflow: hidden;\n  white-space: nowrap;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.sort-basis-list {\n  margin-top: 18px;\n  margin-bottom: 12px;\n  max-height: 185px;\n  width: 464px;\n  overflow-y: auto;\n}\n.sort-basis-list .sort-basis-list-item:not(:first-of-type) {\n  margin-left: 56px;\n}\n.sort-basis-list .sort-basis-list-item:first-of-type {\n  margin-top: 0px;\n}\n.sort-basis-list .sort-basis-list-item {\n  display: flex;\n  justify-content: flex-start;\n  align-items: center;\n  margin-top: 8px;\n}\n.sort-basis-list .sort-basis-list-item .sort-basis-label {\n  opacity: 0.8;\n  font-family: "PingFangSC-Regular";\n  font-size: 14px;\n  color: #000000;\n  letter-spacing: 0;\n  margin-right: 16px;\n}\n.sort-basis-list .sort-basis-list-item .sort-column {\n  margin-right: 10px;\n}\n.sort-basis-list .sort-basis-list-item .sort-column .select-column-option {\n  width: 119px;\n}\n.sort-basis-list .sort-basis-list-item .sort-order {\n  margin-right: 12px;\n}\n.sort-basis-list .sort-basis-list-item .sort-order .sort-order-option {\n  width: 104px;\n}\n.sort-basis-list .sort-basis-list-item .delete-sort-basis-btn {\n  width: 17px;\n  height: 17px;\n  cursor: pointer;\n  background-size: 17px 17px;\n  transition: background-image 0.3s;\n  background-image: url(\'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTdweCIgaGVpZ2h0PSIxN3B4IiB2aWV3Qm94PSIwIDAgMTcgMTciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjEgKDcyNjMxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7liKDpmaTmjpLluo/kvp3mja4tbm9ybWFsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTMuMjDlrprnqL8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuMjM5OTk5OTk1Ij4KICAgICAgICA8ZyBpZD0iZXhjZWxf5aSa5p2h5Lu25o6S5bqPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODgyLjAwMDAwMCwgLTQwMi4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IuWIhue7hC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTguMDAwMDAwLCAyNDQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0i5Yig6Zmk5o6S5bqP5L6d5o2uLW5vcm1hbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzY0LjAwMDAwMCwgMTU4LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9IuakreWchuW9oiIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iOC41IiBjeT0iOC41IiByPSI4Ij48L2NpcmNsZT4KICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjMDAwMDAwIiB4PSI0IiB5PSI4IiB3aWR0aD0iOSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==\');\n}\n.sort-basis-list .sort-basis-list-item .delete-sort-basis-btn:hover {\n  background-size: 17px 17px;\n  background-image: url(\'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTdweCIgaGVpZ2h0PSIxN3B4IiB2aWV3Qm94PSIwIDAgMTcgMTciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjEgKDcyNjMxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7liKDpmaTmjpLluo/kvp3mja4tbm9ybWFsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTMuMjDlrprnqL8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuNDAwMDAwMDA2Ij4KICAgICAgICA8ZyBpZD0iZXhjZWxf5aSa5p2h5Lu25o6S5bqPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtODgyLjAwMDAwMCwgLTQwMi4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IuWIhue7hC0yIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSg1MTguMDAwMDAwLCAyNDQuMDAwMDAwKSI+CiAgICAgICAgICAgICAgICA8ZyBpZD0i5Yig6Zmk5o6S5bqP5L6d5o2uLW5vcm1hbCIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMzY0LjAwMDAwMCwgMTU4LjAwMDAwMCkiPgogICAgICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9IuakreWchuW9oiIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iOC41IiBjeT0iOC41IiByPSI4Ij48L2NpcmNsZT4KICAgICAgICAgICAgICAgICAgICA8cmVjdCBpZD0i55+p5b2iIiBmaWxsPSIjMDAwMDAwIiB4PSI0IiB5PSI4IiB3aWR0aD0iOSIgaGVpZ2h0PSIxIj48L3JlY3Q+CiAgICAgICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDwvZz4KICAgICAgICA8L2c+CiAgICA8L2c+Cjwvc3ZnPg==\');\n}\n.add-sort-basis {\n  display: inline-flex;\n  align-items: center;\n  cursor: pointer;\n  margin-left: 72px;\n}\n.add-sort-basis .add-sort-basis__button {\n  width: 17px;\n  height: 17px;\n  margin-right: 6px;\n  transition: background-image 0.3s;\n  background-size: 17px 17px;\n  background-image: url(\'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTdweCIgaGVpZ2h0PSIxN3B4IiB2aWV3Qm94PSIwIDAgMTcgMTciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjEgKDcyNjMxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7lop7liqDmjpLluo/kvp3mja4tbm9ybWFsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTMuMjDlrprnqL8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuMjM5OTk5OTk1Ij4KICAgICAgICA8ZyBpZD0iZXhjZWxf6Ieq5a6a5LmJ5o6S5bqPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjE0LjAwMDAwMCwgLTQ0MS4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IuWinuWKoOaOkuW6j+S+neaNri1ub3JtYWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYxNC4wMDAwMDAsIDQ0MS4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9IuakreWchuW9oiIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iOC41IiBjeT0iOC41IiByPSI4Ij48L2NpcmNsZT4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik04LDggTDgsNCBMOSw0IEw5LDggTDEzLDggTDEzLDkgTDksOSBMOSwxMyBMOCwxMyBMOCw5IEw0LDkgTDQsOCBMOCw4IFoiIGlkPSLlkIjlubblvaLnirYiIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+\');\n}\n.add-sort-basis .add-sort-basis__label {\n  opacity: 0.48;\n  font-family: "PingFangSC-Regular";\n  font-size: 14px;\n  color: #000000;\n  letter-spacing: 0;\n}\n.add-sort-basis:hover .add-sort-basis__button {\n  background-size: 17px 17px;\n  background-image: url(\'data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPHN2ZyB3aWR0aD0iMTdweCIgaGVpZ2h0PSIxN3B4IiB2aWV3Qm94PSIwIDAgMTcgMTciIHZlcnNpb249IjEuMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayI+CiAgICA8IS0tIEdlbmVyYXRvcjogU2tldGNoIDUzLjEgKDcyNjMxKSAtIGh0dHBzOi8vc2tldGNoYXBwLmNvbSAtLT4KICAgIDx0aXRsZT7lop7liqDmjpLluo/kvp3mja4tbm9ybWFsPC90aXRsZT4KICAgIDxkZXNjPkNyZWF0ZWQgd2l0aCBTa2V0Y2guPC9kZXNjPgogICAgPGcgaWQ9IlJELUV4Y2VsLTMuMjDlrprnqL8iIHN0cm9rZT0ibm9uZSIgc3Ryb2tlLXdpZHRoPSIxIiBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiIG9wYWNpdHk9IjAuNDAwMDAwMDA2Ij4KICAgICAgICA8ZyBpZD0iZXhjZWxf6Ieq5a6a5LmJ5o6S5bqPIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgtNjE0LjAwMDAwMCwgLTQ0MS4wMDAwMDApIj4KICAgICAgICAgICAgPGcgaWQ9IuWinuWKoOaOkuW6j+S+neaNri1ub3JtYWwiIHRyYW5zZm9ybT0idHJhbnNsYXRlKDYxNC4wMDAwMDAsIDQ0MS4wMDAwMDApIj4KICAgICAgICAgICAgICAgIDxjaXJjbGUgaWQ9IuakreWchuW9oiIgc3Ryb2tlPSIjMDAwMDAwIiBjeD0iOC41IiBjeT0iOC41IiByPSI4Ij48L2NpcmNsZT4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik04LDggTDgsNCBMOSw0IEw5LDggTDEzLDggTDEzLDkgTDksOSBMOSwxMyBMOCwxMyBMOCw5IEw0LDkgTDQsOCBMOCw4IFoiIGlkPSLlkIjlubblvaLnirYiIGZpbGw9IiMwMDAwMDAiPjwvcGF0aD4KICAgICAgICAgICAgPC9nPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+\');\n}\n',""])},1807:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(0)),i=c(n(1)),o=n(48),r=n(449),l=n(112),s=c(n(1808)),u=n(113);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,a.default)(this,e),this.parent=t,this.spreadSheet=this.parent.spreadsheet,this.dialog=new s.default(t),this.init()}return(0,i.default)(e,[{key:"init",value:function(){var e=this;this.formatMap={formatChange:o.format,parseDecimalDigits:o.getCurrentCellDotNum,parseCurrencySymbol:o.getCurrencySymbol,getCustomFmtList:function(){return o.custom_fmt},unEscapeCssSequence:r.unEscapeCssSequence},this.parent.view&&this.parent.view.canvas&&this.parent.view.canvas.excel&&this.parent.view.canvas.excel.event.eventCommon.listen("cell-enter",function(){e.dialog&&e.dialog._showcustomDataformatDialog&&e.dialog.onConfirm()})}},{key:"getCellFmtInfo",value:function(e,t){var n=this.spreadSheet.activeSheet.getCellDataAtPosition(e,t);if(n){var a=n.getUserEnteredFormat(),i=a&&a.getNumberFormat()||(0,o.getDefaultNumberFormat)(),r=n.getEffectiveValue();return{data:r&&r.value||"",format_type:i.type,format_data:i.pattern,format_id:i.id}}return null}},{key:"getSelectedCellFormatInfo",value:function(){var e=this.parent.view.canvas.excel.selectData.select,t=this.spreadSheet.activeSheet,n=void 0;if(null===t)return!1;var a=t.getMerges(),i=e.yRange[1],o=e.xRange[1];function r(e,t){for(n=0;n<a.length;n++)if(a[n].startColIndex===t&&a[n].endColIndex<=o&&a[n].startRowIndex===e&&a[n].endRowIndex<=i)return[e,a[n].endRowIndex,t,a[n].endColIndex]}for(var l,s,c=void 0,d=[],p=0,f=e.yRange[0];f<=e.yRange[1];f++,p++)for(var h=0,m=e.xRange[0];m<=e.xRange[1];m++,h++)if(d[p]||(d[p]=[]),!d[p][h]){var v=this.getCellFmtInfo(f,m);if(void 0===c)v&&(0,u.isObject)(v.data)&&v.data.displayText&&(v.data=v.data.displayText),c=v;else if((l=c)!==(s=v)&&(null===l||null===s||l.format_data!==s.format_data))return"";var g=r(f,m);if(g)for(var b=0;b<=g[1]-g[0];b++)for(var y=0;y<=g[3]-g[2];y++)d[p+b]||(d[p+b]=[]),d[p+b][h+y]=!0}return c}},{key:"show",value:function(){var e=this.getSelectedCellFormatInfo();this.dialog.show(e,function(e){(0,l.numberFormat)(e)})}}]),e}();t.default=d},1808:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(41)),i=v(n(31)),o=v(n(0)),r=v(n(1)),l=n(1740),s=n(1741),u=v(n(1742)),c=v(n(1809)),d=v(n(1810)),p=v(n(1811)),f=v(n(1812)),h=v(n(1813)),m=n(71);function v(e){return e&&e.__esModule?e:{default:e}}var g=function(){function e(t){(0,o.default)(this,e),this.app=t,this.doms=this.initDoms(),this.bindedFnArray=[],this._activeElement=null,this._formatInfo=null,this._newFormatType="",this._newFormatData="",this._confirmCallback=null,this._resetParams(),this.bindEvents()}return(0,r.default)(e,[{key:"_resetParams",value:function(){this.currentType="",this._digits=2,this._symbol="\xa5",this._numericalSelectIdx=0,this._normalSelectIdx=0,this._customSelectIdx=0,this._hasThousandSep=!1}},{key:"_initParams",value:function(e,t){if(e&&t){if(e.match(/(^number$|^currency$|^accounting$|^percent$|^scientific$)/)&&(this._digits=(0,l._parseDecimalDigits)(t)),e.match(/(^currency$|^accounting$)/))this._symbol=(0,l._parseCurrencySymbol)(t),"\uffe5"===this._symbol&&(this._symbol="\xa5"),s.symbolList.map(function(e){return e.value}).indexOf(this._symbol)<0&&(this._symbol="");"number"===e&&(this._hasThousandSep=(0,l._parseHasThousandSep)(t),this._numericalSelectIdx=this._getSelectedState(e,t,this._digits,this._hasThousandSep)),"currency"===e&&(this._numericalSelectIdx=this._getSelectedState(e,t,this._digits,this._symbol)),e.match(/(^date$|^time$|^fraction$|^special$)/)&&(this._normalSelectIdx=this._getSelectedState(e,t)),-1!==this._numericalSelectIdx&&-1!==this._normalSelectIdx||(this._newFormatType=e="custom",(0,l.appendCustomFormatList)(t)),("scientific"===e&&!/^0\.0*E\+00$/.test(t)||"percent"===e&&!/^0(\.0+)?%$/.test(t))&&(this._newFormatType=e="custom",(0,l.appendCustomFormatList)(t)),"custom"===e&&(this._customSelectIdx=this._getSelectedState(e,t))}}},{key:"initDoms",value:function(){var e=$(s.dialogHtml);$(document.body).append(e);var t=e.find(".custom-dataformat-dialog-close").eq(0),n=e.find(".custom-dataformat-dialog-cancel-btn").eq(0),a=e.find(".custom-dataformat-dialog-confirm-btn").eq(0),i={$wrapper:e,$closeBtn:t,$cancelBtn:n,$confirmBtn:a},o=e.find(".cdd-body-content-number-right").eq(0);return this.panel=o,this.initFmtCategoryList(),this.initTabList(),i}},{key:"getFormatData",value:function(){return this._newFormatData||""}},{key:"setFormatData",value:function(e){e&&e!==this._newFormatData&&(this._newFormatData=e)}},{key:"getCellData",value:function(){return this._formatInfo&&this._formatInfo.data||""}},{key:"getNewCellData",value:function(e,t){return e&&e.length?(0,l._formatChange)(e,t)[0]:t}},{key:"changeFmtDataAfterSwitchFmtType",value:function(e){var t="",n="",a="";switch(e){case"auto":t="General";break;case"text":t="@";break;case"number":case"currency":n=s.formatMap[e],(this._numericalSelectIdx>n.length-1||this._numericalSelectIdx<0)&&(this._numericalSelectIdx=0),a=n[this._numericalSelectIdx].formatData,t="number"==e?(0,l._generateNumberFormatData)(a,this._digits,this._hasThousandSep):(0,l._generateCurrencyFormatData)(a,this._digits,this._symbol);break;case"percent":case"scientific":t="percent"===e?(0,l._generatePercentageFormatData)(this._digits):(0,l._generateExponentialFormatData)(this._digits);break;case"date":case"time":case"fraction":case"special":n=s.formatMap[e],(this._normalSelectIdx>n.length-1||this._normalSelectIdx<0)&&(this._normalSelectIdx=0),t=n[this._normalSelectIdx].formatData;break;case"custom":t=this.getFormatData(),(0,l.appendCustomFormatList)(t),this._customSelectIdx=this._getSelectedState("custom",t)}this.setFormatData(t)}},{key:"switchPanel",value:function(e,t){switch(e[0].innerHTML="",t){case"auto":case"text":this.defaultTextPanel(e,t);break;case"number":this.numPanel(e,t);break;case"percent":case"scientific":this.percentageExponentialPanel(e,t);break;case"currency":case"accounting":this.currencyAccountPanel(e,t);break;case"date":case"time":case"fraction":case"special":this.dateTimeFractionSpecialPanel(e,t);break;case"custom":this.customPanel(e,t)}}},{key:"initFmtCategoryList",value:function(){var e=this;this.fmtList=new u.default({hasTitle:!0,slideBar:!0,title:"\u5206\u7c7b",items:s.fmtCategory,selectedIndex:0,parent:$("div.cdd-body-content-number-left"),callback:function(t){-1!==t?(e.currentType=s.fmtCategory[t].type,console.log("currentType:",e.currentType),e.changeFmtDataAfterSwitchFmtType(e.currentType),e.switchPanel(e.panel,e.currentType)):e.switchPanel(e.panel,"auto")}})}},{key:"initTabList",value:function(){var e=function(e){return function(t){console.log("----click: ",e)}},t={listClassName:"dataformat-tab-list",ulClassName:"",items:(0,l.objectMap)(s.fmtTablist,function(t,n){return{label:t,key:n,className:"fmt-tab-item fmt-tab-item-"+n,callback:e(n)}})},n=new c.default(t);this.fmtTab=n,$("div.dataformat-tab-wrapper").append(n.dom)}},{key:"defaultTextPanel",value:function(e,t){var n=this.getNewCellData(this.getFormatData(),this.getCellData());new h.default({parent:e,theme:"\u793a\u4f8b",content:this.currentType===t?n:""});if("auto"===t){var a=$(s.defaultPromptHtml);e.append(a)}else if("text"===t){var i=$(s.textPromptHtml);e.append(i)}$("div.cdd-body-content-tips").text("")}},{key:"numPanel",value:function(e,t){var n=this,a=null,i=function(e,t,n){var a=(0,l._generateNumberList)(s.formatMap.number,t,n);e.updateItems(a)},o=function(e,t,a){var i=s.formatMap.number[e].formatData,o=(0,l._generateNumberFormatData)(i,t,a);n.setFormatData(o)},r=function(e){var t=n.getNewCellData(n.getFormatData(),n.getCellData());$(e._dom).find(".ac-examplebox-content").eq(0).text(t)},c=new h.default({parent:e,theme:"\u793a\u4f8b",content:this.getNewCellData(this.getFormatData(),this.getCellData())});new f.default({min:0,max:30,value:this._digits,step:1,parent:e,onChange:function(e){n._digits=e,i(a,n._digits,n._hasThousandSep),o(n._numericalSelectIdx,n._digits,n._hasThousandSep),r(c)}}),new d.default({parent:e,text:"\u4f7f\u7528\u5343\u4f4d\u5206\u9694\u7b26(,)",ifChecked:this._hasThousandSep,onChange:function(e){n._hasThousandSep=e,i(a,n._digits,n._hasThousandSep),o(n._numericalSelectIdx,n._digits,n._hasThousandSep),r(c)}});a=new u.default({hasTitle:!0,title:"\u8d1f\u6570",items:(0,l._generateNumberList)(s.formatMap.number,this._digits,this._hasThousandSep),selectedIndex:this._numericalSelectIdx,parent:e,callback:function(e){e>s.formatMap.number.length-1||(n._numericalSelectIdx=e,o(n._numericalSelectIdx,n._digits,n._hasThousandSep),r(c))}}),$("div.cdd-body-content-tips").text("\u6570\u5b57\u683c\u5f0f\u7528\u4e8e\u663e\u793a\u4e00\u822c\u6570\u5b57\u3002\u8d27\u5e01\u5219\u63d0\u4f9b\u7279\u6b8a\u683c\u5f0f\u7684\u8d27\u5e01\u503c\u3002")}},{key:"percentageExponentialPanel",value:function(e,t){var n=this,a=new h.default({parent:e,theme:"\u793a\u4f8b",content:this.getNewCellData(this.getFormatData(),this.getCellData())});new f.default({min:0,max:30,value:this._digits,step:1,parent:e,onChange:function(e){n._digits=e,function(e,t){var a=null;"percent"===e?a=(0,l._generatePercentageFormatData)(t):"scientific"===e&&(a=(0,l._generateExponentialFormatData)(t)),a&&n.setFormatData(a)}(t,n._digits),function(e){var t=n.getNewCellData(n.getFormatData(),n.getCellData());$(e._dom).find(".ac-examplebox-content").eq(0).text(t)}(a)}});"percent"===t?$("div.cdd-body-content-tips").text("\u767e\u5206\u6bd4\u683c\u5f0f\u5c06\u5355\u5143\u683c\u4e2d\u6570\u503c\u4e58\u4ee5 100\uff0c\u5e76\u4ee5\u767e\u5206\u6570\u5f62\u5f0f\u663e\u793a\u3002"):$("div.cdd-body-content-tips").text("")}},{key:"currencyAccountPanel",value:function(e,t){var n=this,a=null,i=function(e,t,n){var a=(0,l._generateCurrencyList)(s.formatMap.currency,t,n);e.updateItems(a)},o=function(e,a,i){var o=s.formatMap.currency[e].formatData,r=(0,l._generateCurrencyFormatData)(o,a,i);n.setFormatData(r,t)},r=function(e){var t=n.getNewCellData(n.getFormatData(),n.getCellData());$(e._dom).find(".ac-examplebox-content").eq(0).text(t)},c=new h.default({parent:e,theme:"\u793a\u4f8b",content:this.getNewCellData(this.getFormatData(),this.getCellData())}),d=(new f.default({min:0,max:30,value:this._digits,step:1,parent:e,onChange:function(e){n._digits=e,i(a,n._digits,n._symbol),o(n._numericalSelectIdx,n._digits,n._symbol),r(c)}}),s.symbolList.map(function(e){return e.value}).indexOf(this._symbol));d<0&&(d=0);new p.default({parent:e,width:"237",theme:"\u8d27\u5e01\u7b26\u53f7(\u56fd\u5bb6/\u5730\u533a)",selectedIndex:d,items:s.symbolList,callback:function(e){e>s.symbolList.length-1||(n._symbol=s.symbolList[e].value,i(a,n._digits,n._symbol),o(n._numericalSelectIdx,n._digits,n._symbol),r(c))}});a=new u.default({hasTitle:!0,title:"\u8d1f\u6570",items:(0,l._generateCurrencyList)(s.formatMap.currency,this._digits,this._symbol),selectedIndex:this._numericalSelectIdx,parent:e,callback:function(e){e>s.formatMap.currency.length-1||(n._numericalSelectIdx=e,o(n._numericalSelectIdx,n._digits,n._symbol),r(c))}}),$("div.cdd-body-content-tips").text("\u8d27\u5e01\u683c\u5f0f\u7528\u4e8e\u8868\u793a\u4e00\u822c\u8d27\u5e01\u6570\u503c\u3002")}},{key:"dateTimeFractionSpecialPanel",value:function(e,t){var n=this,a=s.formatMap[t],i=new h.default({parent:e,theme:"\u793a\u4f8b",content:this.getNewCellData(this.getFormatData(),this.getCellData())});new u.default({hasTitle:!0,title:"\u7c7b\u578b",items:a,selectedIndex:this._normalSelectIdx,parent:e,callback:function(e){if(!(e>a.length-1)){n._normalSelectIdx=e;var t=a[e].formatData;n.setFormatData(t);var o=n.getNewCellData(n.getFormatData(),n.getCellData());$(i._dom).find(".ac-examplebox-content").eq(0).text(o)}}});"special"===t?$("div.cdd-body-content-tips").text("\u7279\u6b8a\u683c\u5f0f\u53ef\u7528\u4e8e\u8ddf\u8e2a\u6570\u636e\u5217\u8868\u53ca\u6570\u636e\u5e93\u7684\u503c\u3002"):"date"===t?$("div.cdd-body-content-tips").text("\u65e5\u671f\u683c\u5f0f\u5c06\u65e5\u671f\u548c\u65f6\u95f4\u7cfb\u5217\u6570\u503c\u663e\u793a\u4e3a\u65e5\u671f\u503c\u3002\u4ee5\u661f\u53f7\uff08*\uff09\u5f00\u5934\u7684\u65e5\u671f\u683c\u5f0f\u5bfc\u51fa\u540e\u54cd\u5e94\u64cd\u4f5c\u7cfb\u7edf\u7279\u5b9a\u7684\u533a\u57df\u65e5\u671f\u548c\u65f6\u95f4\u3002\u4e0d\u5e26\u661f\u53f7\u7684\u683c\u5f0f\u5bfc\u51fa\u540e\u4e0d\u53d7\u64cd\u4f5c\u7cfb\u7edf\u8bbe\u7f6e\u5f71\u54cd\u3002"):"time"===t?$("div.cdd-body-content-tips").text("\u65f6\u95f4\u683c\u5f0f\u5c06\u65e5\u671f\u548c\u65f6\u95f4\u7cfb\u5217\u6570\u503c\u663e\u793a\u4e3a\u65f6\u95f4\u503c\u3002\u4ee5\u661f\u53f7\uff08*\uff09\u5f00\u5934\u7684\u65f6\u95f4\u683c\u5f0f\u5bfc\u51fa\u540e\u54cd\u5e94\u64cd\u4f5c\u7cfb\u7edf\u7279\u5b9a\u7684\u533a\u57df\u65e5\u671f\u548c\u65f6\u95f4\u3002\u4e0d\u5e26\u661f\u53f7\u7684\u683c\u5f0f\u5bfc\u51fa\u540e\u4e0d\u53d7\u64cd\u4f5c\u7cfb\u7edf\u8bbe\u7f6e\u5f71\u54cd\u3002"):$("div.cdd-body-content-tips").text("")}},{key:"customPanel",value:function(e,t){var n=this,a=s.formatMap[t],i=new h.default({parent:e,theme:"\u793a\u4f8b",content:this.getNewCellData(this.getFormatData(),this.getCellData())});new u.default({hasTitle:!0,title:"\u7c7b\u578b",selectedIndex:this._customSelectIdx,items:a,parent:e,callback:function(e){if(!(e>a.length-1)){n._customSelectIdx=e;var o=a[e].formatData;n.setFormatData(o,t);var r=n.getNewCellData(o,n.getCellData());$(i._dom).find(".ac-examplebox-content").eq(0).text(r)}}});$("div.cdd-body-content-tips").text("\u4ee5\u73b0\u6709\u683c\u5f0f\u4e3a\u57fa\u7840\uff0c\u751f\u6210\u81ea\u5b9a\u4e49\u7684\u6570\u5b57\u683c\u5f0f\u3002")}},{key:"bindEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t={close:this.onClose,confirm:this.onConfirm,cancel:this.onCancel},n=e?"_off":"_on";for(var a in t){var i=this.doms["$"+a+"Btn"];i?this[n](i,"click",t[a]):console.error(a+"\u5bf9\u5e94\u7684\u8282\u70b9\u5e76\u4e0d\u5b58\u5728")}}},{key:"onClose",value:function(){this.hide(),(0,m.hideToast)()}},{key:"onConfirm",value:function(){if((""===this._digits||this._digits<0||this._digits>30)&&this.currentType.match(/(^number$|^currency$|^accounting$|^percent$|^scientific$)/))(0,m.showToast)("\u5c0f\u6570\u4f4d\u4e3a\u6b63\u6574\u6570\uff0c\u6700\u9ad830\uff0c\u5f53\u524d\u8f93\u5165\u4e0d\u5408\u6cd5 ",0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,m.hideToast)()}});else{var e=this._formatInfo&&this._formatInfo.format_data!==this.getFormatData()||!this._formatInfo&&""!==this.getFormatData();this._confirmCallback&&e&&this._confirmCallback(this._newFormatData),this.hide()}}},{key:"onCancel",value:function(){this.hide(),(0,m.hideToast)()}},{key:"show",value:function(e,t){var n=this;s.formatMap.custom||(s.formatMap.custom=(0,l._getCustomFmtList)()),this._showcustomDataformatDialog=!0,this._activeElement=document.activeElement,this._activeElement&&this._activeElement.blur(),this._formatInfo=e,this._newFormatData=e&&e.format_data||"",this._newFormatType=e&&e.format_type,this._confirmCallback=t,/^currency/.test(this._newFormatType)?this._newFormatType="currency":/^date/.test(this._newFormatType)?this._newFormatType="date":"custom"===this._newFormatType&&""!==this._newFormatData&&(0,l.appendCustomFormatList)(this._newFormatData),this._initParams(this._newFormatType,this._newFormatData);var a=s.fmtCategory.map(function(e){return e.type}).indexOf(this._newFormatType);console.log("----",a,this._newFormatType),this.fmtList.setSelect(a),setTimeout(function(){n.doms.$wrapper.css("display","block")})}},{key:"hide",value:function(){this._showcustomDataformatDialog=!1,this._activeElement&&this._activeElement.focus&&this._activeElement.focus(),this._resetParams(),this.doms.$wrapper.css("display","none")}},{key:"_on",value:function(e,t,n){var a=n.bind(this);this.bindedFnArray.push([n,a]),e.on(t,a)}},{key:"_off",value:function(e,t,n){var o=void 0,r=!0,l=!1,s=void 0;try{for(var u,c=(0,i.default)(this.bindedFnArray);!(r=(u=c.next()).done);r=!0){var d=(0,a.default)(u.value,2),p=d[0],f=d[1];if(p===n){o=f;break}}}catch(h){l=!0,s=h}finally{try{!r&&c.return&&c.return()}finally{if(l)throw s}}o&&e.off(t,n)}},{key:"_getCurrencySelectedState",value:function(e,t,n){for(var a=e.replace("[$HK$-3C09]","[$HK$-C04]"),i=s.formatMap.currency,o=0;o<i.length;o++){var r=i[o],u=(0,l._generateCurrencyFormatData)(r.formatData,t,n);if((0,l._unEscapeCssSequence)(u)===(0,l._unEscapeCssSequence)(a))return o}return-1}},{key:"_getNumberSelectedState",value:function(e,t,n){for(var a=s.formatMap.number,i=0;i<a.length;i++){var o=a[i],r=(0,l._generateNumberFormatData)(o.formatData,t,n);if((0,l._unEscapeCssSequence)(r)===(0,l._unEscapeCssSequence)(e))return i}return-1}},{key:"_getSelectedState",value:function(e,t,n,a){var i=void 0;switch(e){case"date":case"time":case"fraction":case"special":case"custom":i=s.formatMap[e];for(var o=0;o<i.length;o++){var r=i[o];if((0,l._unEscapeCssSequence)(r.formatData)===(0,l._unEscapeCssSequence)(t))return o}return-1;case"currency":return this._getCurrencySelectedState(t,n,a);case"number":return this._getNumberSelectedState(t,n,a);default:return-1}}}]),e}();t.default=g},1809:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(24)),i=l(n(0)),o=l(n(1)),r=n(1740);function l(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,i.default)(this,e),this.tabContentWrapper=null,this.tabItems=[],this.dom=this.render(t)}return(0,o.default)(e,[{key:"render",value:function(e){var t=this;if(e){var n=e.id,i=e.tabClassName,o=void 0===i?"":i,l=e.ulClassName,s=void 0===l?"":l,u=e.items,c=void 0===u?[]:u,d="cmpt-tab-content "+s,p={class:"cmpt-tab "+o};n&&(p.id=n);return(0,r.generator)(p)(this.tabContentWrapper=(0,r.generator)({class:d},"ul").apply(void 0,(0,a.default)(this.tabItems=c.map(function(e){return(0,r.addClick)((0,r.generator)({class:"cmpt-tab-item "+e.className},"li")(e.label),(n=e.callback,function(e){$(t.tabItems).removeClass("cmpt-tab-item-selected"),$(e.target).addClass("cmpt-tab-item-selected"),n(e)}));var n}))))}}}]),e}();t.default=s},1810:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(14)),i=r(n(0)),o=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,e),this.opts={};(0,a.default)(this.opts,{parent:null,ifChecked:!1,underlineletter:null,onChange:function(e){}},t),this.initDoms()}return(0,o.default)(e,[{key:"initDoms",value:function(){var e=this,t=$(this.render());this.opts.parent.append(t);var n=t.find("label").eq(0),a=$("input#ac-checkBox-separators");a.prop("checked",this.opts.ifChecked),n.on("click",function(){a.prop("checked")?e.opts.onChange&&e.opts.onChange(!1):e.opts.onChange&&e.opts.onChange(!0)})}},{key:"render",value:function(){var e='(<span class="ac-list-title-underscore">'+this.opts.underlineletter+"</span>)";return'\n            <div class="ac-checkBox">\n                <div class="ac-checkBox-container">\n                <input id="ac-checkBox-separators" type="checkbox" value=""/>\n                <label for="ac-checkBox-separators"> </label>\n                </div>\n                <span class="ac-checkBox-content"> '+this.opts.text+(this.opts.underlineletter?e:"")+"\n                </span>\n            </div>\n        "}}]),e}();t.default=l},1811:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(14)),i=l(n(0)),o=l(n(1)),r=l(n(1742));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,e),this.opts={};(0,a.default)(this.opts,{parent:null,selectedIndex:0,width:"",theme:"",underlineletter:null,items:[],callback:function(e){}},t),this.initDoms(),this.setSelectItem(this.opts.selectedIndex)}return(0,o.default)(e,[{key:"initDoms",value:function(){var e=this;this.$dropdownBox=$(this.render()),this.opts.parent.append(this.$dropdownBox),this.$dropdownBoxSelect=this.$dropdownBox.find(".ac-dropdown-box-select").eq(0),this.$dropdownBoxSelectList=this.$dropdownBoxSelect.find(".ac-dropdown-box-list").eq(0),this.$dropdownBoxSelectInput=this.$dropdownBoxSelect.find(".ac-dropdown-box-text").eq(0),this.dropdownList=new r.default({hasTitle:!1,items:this.opts.items,parent:this.$dropdownBoxSelectList,selectedIndex:this.opts.selectedIndex,callback:function(t){t>e.opts.items.length-1||(e.$dropdownBoxSelectList.addClass("ac-dropdown-box-list-hidden"),e.$dropdownBoxSelect.removeClass("ac-dropdown-box-select-focus"),e.$dropdownBoxSelectInput.text(e.opts.items[t].label),e.opts.callback&&e.opts.callback(t))}}),this.$dropdownBoxSelectList.append(this.dropdownList.dom),$(".ac-dropdown-box-select").on("click",function(t){t.stopPropagation(),e.$dropdownBoxSelectList.toggleClass("ac-dropdown-box-list-hidden"),e.$dropdownBoxSelect.toggleClass("ac-dropdown-box-select-focus")}),document.body.addEventListener("click",function(t){t.target&&$.contains(e.$dropdownBox.get(0),t.target)||(e.$dropdownBoxSelectList.addClass("ac-dropdown-box-list-hidden"),e.$dropdownBoxSelect.removeClass("ac-dropdown-box-select-focus"))},!0)}},{key:"setSelectItem",value:function(e){e>this.opts.items.length-1||this.$dropdownBoxSelectInput.text(this.opts.items[e].label)}},{key:"render",value:function(){return'\n            <div class="ac-dropdown-box">\n                <div class="ac-dropdown-box-theme-content" style="display:inline-block;">\n                    '+this.renderTheme(this.opts.theme,this.opts.underlineletter)+'\n                </div>\n                <div class="ac-dropdown-box-select">\n                    '+this.renderSelect(this.opts.width,this.opts.items,this.opts.items[this.opts.selectedIndex].value)+"\n                </div>\n            </div>\n        "}},{key:"renderTheme",value:function(e){var t='(<span class="ac-list-title-underscore">'+this.opts.underlineletter+"</span>)";return'\n            <span class="ac-dropdown-box-theme"> '+e+(this.opts.underlineletter?t:"")+"\n            </span>\n        "}},{key:"renderSelect",value:function(e,t){return'\n            <div class="ac-dropdown-box-text-parent">\n                <div class="ac-dropdown-box-text" style="width:'+e+'px;">'+t+'</div>\n                <span class="ac-dropdown-box-select-triangle"></span>\n                <span class="ac-dropdown-box-select-rectangle"></span>\n            </div>\n            <div class="ac-dropdown-box-list ac-dropdown-box-list-hidden"></div>\n        '}}]),e}();t.default=s},1812:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r(n(14)),i=r(n(0)),o=r(n(1));function r(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,e),this.opts={};(0,a.default)(this.opts,{min:null,max:null,value:0,step:1,parent:null,onChange:function(e){}},t),this.initDoms(),this.bindEvents()}return(0,o.default)(e,[{key:"initDoms",value:function(){if(this.opts.parent){var e=$(this.render());this.opts.parent.append(e);var t=e.find(".ac-input-number-input").eq(0),n=e.find(".ac-input-number-handler-up").eq(0),a=e.find(".ac-input-number-handler-down").eq(0);"number"===typeof this.opts.min&&t.attr("min",this.opts.min),"number"===typeof this.opts.min&&t.attr("max",this.opts.max),t.attr("value",this.opts.value),this._doms={$input:t,$inputHandlerUp:n,$inputHandlerDown:a}}}},{key:"bindEvents",value:function(){var e=this,t=this._doms,n=t.$input,a=t.$inputHandlerUp,i=t.$inputHandlerDown;n.on("keyup",function(e){-1!==$.inArray(e.keyCode,[46,8,9,27,13,110])||65===e.keyCode&&(!0===e.ctrlKey||!0===e.metaKey)||e.keyCode>=35&&e.keyCode<=40||(e.shiftKey||e.keyCode<48||e.keyCode>57)&&(e.keyCode<96||e.keyCode>105)&&e.preventDefault()}),n.on("input",function(t){var a=n.val();a&&a.length>0?(a=a.replace(/[^\d]/g,""),e.opts.value=parseInt(a,10)||0):e.opts.value=a,n.val(a),e.opts.onChange&&e.opts.onChange(e.opts.value)}),a.on("click",function(t){e.opts.value>=e.opts.min&&e.opts.value<e.opts.max&&(e.opts.value+=e.opts.step,e.opts.value=Math.min(e.opts.value,e.opts.max)),e.opts.value>e.opts.max&&(e.opts.value=e.opts.max),n.val(e.opts.value),e.opts.onChange&&e.opts.onChange(e.opts.value)}),i.on("click",function(t){e.opts.value>e.opts.min&&e.opts.value<=e.opts.max&&(e.opts.value-=e.opts.step,e.opts.value=Math.max(e.opts.value,e.opts.min)),e.opts.value>e.opts.max&&(e.opts.value=e.opts.max),n.val(e.opts.value),e.opts.onChange&&e.opts.onChange(e.opts.value)})}},{key:"render",value:function(){return'\n      <div class="ac-input-number-wrapper">\n        <span class="ac-input-number-prompt">\n          \u5c0f\u6570\u4f4d\u6570\n        </span>\n        <div class="ac-input-number">\n          <div class="ac-input-number-handler-wrap">\n            <span class="ac-input-number-handler ac-input-number-handler-up">\n            </span>\n            <span class="ac-input-number-handler ac-input-number-handler-down">\n            </span>\n          </div>\n          <div class="ac-input-number-input-wrap">\n            <input class="ac-input-number-input" autocomplete="off" maxlength=2/>\n          </div>\n        </div>\n      </div>\n      '}}]),e}();t.default=l},1813:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(14)),i=l(n(0)),o=l(n(1)),r=n(445);function l(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,i.default)(this,e),this.opts={};(0,a.default)(this.opts,{parent:null},t),this.initDoms()}return(0,o.default)(e,[{key:"initDoms",value:function(){var e=$(this.render());this.opts.parent.append(e),this._dom=e}},{key:"render",value:function(){return'\n        <div class="ac-examplebox">\n            <div class="ac-examplebox-theme">\n            '+(0,r.escapeHTML)(this.opts.theme)+'\n            </div>\n            <div class="ac-examplebox-content">\n            '+(0,r.escapeHTML)(this.opts.content)+"\n            </div>\n        </div>\n        "}}]),e}();t.default=s},1814:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(0)),i=g(n(1)),o=g(n(46)),r=g(n(308)),l=g(n(7)),s=n(244),u=n(22),c=g(n(40)),d=g(n(8)),p=g(n(1815)),f=g(n(1816));n(1819);var h=n(1697),m=n(82),v=n(143);function g(e){return e&&e.__esModule?e:{default:e}}var b=function(){function e(t){var n=this;(0,a.default)(this,e),this.close=function(){n.isShow()&&(n.dialog.close(),n.dialog=null,n.removeListen(),n.app.view.canvas.pluginsApi.search.hideSearch(),n.app.view.canvas.excel.focusInput())},this.addListener=function(){(0,s.addEvent)(l.default.document,"keyup",n.panelKeyupEvent,!1),(0,s.addEvent)(l.default.document,"focusout",n.handleIpadKeyboardHide,!0),c.default.sheetsBar.listen("switchSheetEnd",n.startNewSearch),c.default.spreadsheetEvent.listen("applyBehaviorEnd",n.startNewSearchAndKeepSelection)},this.removeListen=function(){(0,s.removeEvent)(l.default.document,"keyup",n.panelKeyupEvent,!1),(0,s.removeEvent)(l.default.document,"focusout",n.handleIpadKeyboardHide,!0),c.default.sheetsBar.remove("switchSheetEnd",n.startNewSearch),c.default.spreadsheetEvent.remove("applyBehaviorEnd",n.startNewSearchAndKeepSelection)},this.panelKeyupEvent=function(e){27===e.keyCode&&n.close()},this.handleIpadKeyboardHide=function(){u.isPad&&u.isTencentDocsApp&&l.default.window.scrollTo(0,0)},this.startNewSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.isShow()&&n.body.current.searchAction(e)},this.startNewSearchAndKeepSelection=function(){n.isShow()&&n.body.current.searchAction({keepSelectionIndex:!0})},this.hasReplaceType=function(){return n.app.sheetStatus.permission.gEditable},this.isShow=function(){return!!n.dialog},this.setType=function(e){e=n.hasReplaceType()?e:h.SR_TYPE.SEARCH,n.type=e,n.body.current.setType(e),n.title.current.setType(e)},this.app=t,this.dialog=null,this.title=o.default.createRef(),this.body=o.default.createRef(),this.listenPermissionsStatusChange()}return(0,i.default)(e,[{key:"listenPermissionsStatusChange",value:function(){var e=this;this.app.sheetStatus.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){this.close()}},{key:"switchToEditable",value:function(){}},{key:"create",value:function(e){if(e=e||h.SR_TYPE.SEARCH,!this.isShow())return this.app.event.default.trigger(m.EVENT_NAME.UI_SHOW,"search-panel-pc"),this.app.view.canvas.excel.overActiveEditor(),this.dialog=r.default.confirm({className:"search-replace-dialog",destroyOnClose:!0,mask:!1,draggable:!0,style:{width:376,top:103,right:10,position:"absolute",paddingLeft:"0px",paddingRight:"0px"},title:this.renderTitle(),content:this.renderBody(),footer:null,onCancel:this.close}),this.addListener(),this.setType(e),"1"==(0,v.getQuery)("inToastPreview")&&d.default.tdwReport({opername:"doc_preview",module:"pc_qqview",action:"cli_search"}),this.dialog;this.type!==e?this.setType(e):this.startNewSearch({value:""})}},{key:"renderTitle",value:function(){return o.default.createElement(p.default,{showReplace:this.hasReplaceType(),ref:this.title,clickCb:this.setType})}},{key:"renderBody",value:function(){return o.default.createElement(f.default,{ref:this.body,clickCancel:this.close})}}]),e}();t.default=b},1815:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(3)),i=d(n(0)),o=d(n(1)),r=d(n(4)),l=d(n(5)),s=d(n(46)),u=d(n(8)),c=n(1697);function d(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.clickSearchTab=function(){n.clickCb(c.SR_TYPE.SEARCH),n.setState({activeTabType:c.SR_TYPE.SEARCH}),u.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_find"})},n.clickReplaceTab=function(){n.clickCb(c.SR_TYPE.REPLACE),n.setState({activeTabType:c.SR_TYPE.REPLACE}),u.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_replace"})},n.setType=function(e){n.setState({activeTabType:e})},n.clickCb=n.props.clickCb,n.state={activeTabType:n.props.activeTabType||c.SR_TYPE.SEARCH},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return s.default.createElement("div",{className:"search-replace-tab-wrap"},s.default.createElement("li",{className:"replace "+(this.state.activeTabType===c.SR_TYPE.SEARCH?"active":""),onClick:this.clickSearchTab},"\u67e5\u627e"),this.props.showReplace?s.default.createElement("li",{className:"replace "+(this.state.activeTabType===c.SR_TYPE.REPLACE?"active":""),onClick:this.clickReplaceTab},"\u66ff\u6362"):"")}}]),t}(s.default.Component);t.default=p},1816:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),i=f(n(0)),o=f(n(1)),r=f(n(4)),l=f(n(5)),s=f(n(46)),u=f(n(1817)),c=f(n(1818)),d=f(n(172)),p=n(1697);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.clickCancel=function(){n.props.clickCancel()},n.setType=function(e){n.setState({type:e}),d.default.view.canvas.pluginsApi.search.hideSearch()},n.searchAction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};n.state.type===p.SR_TYPE.SEARCH?n.searchPannel.current.searchAction(e):n.replacePannel.current.searchAction(e)},n.state={type:n.props.type||p.SR_TYPE.SEARCH},n.searchPannel=s.default.createRef(),n.replacePannel=s.default.createRef(),n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return this.state.type===p.SR_TYPE.SEARCH?s.default.createElement(u.default,{ref:this.searchPannel,clickCancel:this.clickCancel}):s.default.createElement(c.default,{ref:this.replacePannel,clickCancel:this.clickCancel})}}]),t}(s.default.Component);t.default=h},1817:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(3)),i=y(n(0)),o=y(n(1)),r=y(n(4)),l=y(n(5)),s=y(n(46)),u=y(n(1696)),c=y(n(759)),d=y(n(247)),p=y(n(202)),f=n(22),h=y(n(40)),m=y(n(172)),v=y(n(8)),g=n(1743),b=n(1697);function y(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.clickCancel=function(){n.props.clickCancel()},n.clickNext=function(){if(n.nextAction(),f.isSafari){var e=document.querySelector(".search-button-wrap .next-button");e&&document.activeElement!==e&&e.focus()}v.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_find_next"})},n.nextAction=function(){(0,g.selectNextSearch)(),n.setInfo()},n.onChange=function(e,t){n.setState({searchText:e});var a=t&&t.nativeEvent;n.debounceChange(e,a)},n.onCompositionEnd=function(e){if(f.isFireFox){var t=e&&e.nativeEvent&&e.nativeEvent.target&&e.nativeEvent.target.value;t=t||n.state.searchText,n.onChange(t,e)}else n.onChange(n.state.searchText,e)},n.debounceChange=(0,d.default)(function(e,t){t&&t.isComposing||n.setSearchText(e)},200),n.onInputClick=function(){m.default.view.canvas.excel.hideInput(),n.searchInput&&n.searchInput.focus()},n.onInputKeyUp=function(e){13===e.keyCode&&n.nextAction()},n.setSearchText=function(e){e=n.state.searchText,(0,g.highlightSearchCell)(e,b.SR_TYPE.SEARCH),(0,g.selectSearchCell)(0),n.setInfo(),n.updateBtns()},n.searchAction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.state.searchText;void 0!==e.value&&(t=e.value,n.setState({searchText:t}),n.searchInput&&n.searchInput.focus());var a=e.keepSelectionIndex||!1,i=(0,g.getSearchCurrentSelect)();if((0,g.highlightSearchCell)(t,b.SR_TYPE.SEARCH),a&&i){var o=m.default.view.canvas.excel.tableData.tableStatus,r=m.default.view.canvas.excel.tableData.inputStatus;if(!(3===o&&(1===r||2===r))){var l=(0,g.findSearchResultIndex)(i),s=function(){-1===l?(0,g.selectNextSearch)({selection:i}):(0,g.selectSearchCell)(l),m.default.view.canvas.excel.blurInput(),n.setInfo(),n.updateBtns()};m.default.view.canvas.excel.mouseData.down?h.default.windowEvent.listen("mouseup",function e(){s(),h.default.windowEvent.remove("mouseup",e)}):s()}}else(0,g.selectSearchCell)(0),m.default.handleData.saveSheetSelection(m.default.spreadsheet.getActiveSheetId()),n.setInfo(),n.updateBtns()},n.updateBtns=function(){(0,g.getSearchList)().length?n.setState({nextButtonDisabled:!1}):n.setState({nextButtonDisabled:!0})},n.setInfo=function(){var e=(0,g.findSearchResultIndex)(),t=(0,g.getSearchList)(),a=t.length;if(0===t.length)n.setState({countInfo:""});else{var i=e+1+"/"+a;n.setState({countInfo:i})}},n.state={nextButtonDisabled:!0,searchText:"",countInfo:""},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.searchInput=document.querySelector("#search-panel-input"),this.searchInput&&this.searchInput.focus(),p.default.key.addNotFilter("search-panel-input")}},{key:"render",value:function(){var e=s.default.createElement("div",{className:"search-count-info"},s.default.createElement("div",{className:"search-count-info-content"},this.state.countInfo));return s.default.createElement("div",{className:"search-replace-content-wrap"},s.default.createElement(u.default,{placeholder:"\u8f93\u5165\u67e5\u627e\u5185\u5bb9",id:"search-panel-input",value:this.state.searchText,onChange:this.onChange,onCompositionEnd:this.onCompositionEnd,onClick:this.onInputClick,onKeyUp:this.onInputKeyUp,onMouseDown:function(e){return e.stopPropagation()},icon:e,autoComplete:"off"}),s.default.createElement("div",{className:"search-button-wrap"},s.default.createElement("div",{className:"button-group-wrap"},s.default.createElement(c.default,{className:"common-button",onClick:this.clickCancel},"\u53d6\u6d88"),s.default.createElement(c.default,{className:"next-button common-button ml-16",type:this.state.nextButtonDisabled?"default":"primary",disabled:this.state.nextButtonDisabled,onClick:this.clickNext},"\u4e0b\u4e00\u4e2a"))))}}]),t}(s.default.Component);t.default=E},1818:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),i=E(n(0)),o=E(n(1)),r=E(n(4)),l=E(n(5)),s=E(n(46)),u=E(n(1696)),c=E(n(759)),d=E(n(308)),p=E(n(247)),f=E(n(202)),h=n(22),m=E(n(8)),v=E(n(40)),g=E(n(172)),b=n(1743),y=n(1697);function E(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.clickCancel=function(){n.props.clickCancel()},n.clickNext=function(){if(n.nextAction(),h.isSafari){var e=document.querySelector(".replace-button-wrap .next-button");e&&document.activeElement!==e&&e.focus()}m.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_replace_next"})},n.nextAction=function(){(0,b.selectNextSearch)(),n.setInfo()},n.onChange=function(e,t){n.setState({searchText:e});var a=t&&t.nativeEvent;n.debounceChange(e,a)},n.onCompositionEnd=function(e){if(h.isFireFox){var t=e&&e.nativeEvent&&e.nativeEvent.target&&e.nativeEvent.target.value;t=t||n.state.searchText,n.onChange(t,e)}else n.onChange(n.state.searchText,e)},n.debounceChange=(0,p.default)(function(e,t){t&&t.isComposing||n.setSearchText(e)},200),n.onInputClick=function(){g.default.view.canvas.excel.hideInput(),n.searchInput&&n.searchInput.focus()},n.onInputKeyUp=function(e){13===e.keyCode&&n.nextAction()},n.setSearchText=function(e){e=n.state.searchText,(0,b.highlightSearchCell)(e,y.SR_TYPE.REPLACE),(0,b.selectSearchCell)(0),n.updateBtns(),n.setInfo()},n.searchAction=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=n.state.searchText;void 0!==e.value&&(t=e.value,n.setState({searchText:t}),n.searchInput&&n.searchInput.focus());var a=e.keepSelectionIndex||!1,i=(0,b.getSearchCurrentSelect)();if((0,b.highlightSearchCell)(t,y.SR_TYPE.SEARCH),a&&i){var o=g.default.view.canvas.excel.tableData.tableStatus,r=g.default.view.canvas.excel.tableData.inputStatus;if(!(3===o&&(1===r||2===r))){var l=(0,b.findSearchResultIndex)(i),s=function(){-1===l?(0,b.selectNextSearch)({selection:i}):(0,b.selectSearchCell)(l),g.default.view.canvas.excel.blurInput(),n.setInfo(),n.updateBtns()};g.default.view.canvas.excel.mouseData.down?v.default.windowEvent.listen("mouseup",function e(){s(),v.default.windowEvent.remove("mouseup",e)}):s()}}else(0,b.selectSearchCell)(0),g.default.handleData.saveSheetSelection(g.default.spreadsheet.getActiveSheetId()),n.setInfo(),n.updateBtns()},n.onDstChange=function(e){n.setState({replaceText:e})},n.updateBtns=function(){(0,b.getSearchList)().length?n.setState({nextButtonDisabled:!1}):n.setState({nextButtonDisabled:!0})},n.setInfo=function(){var e=(0,b.findSearchResultIndex)(),t=(0,b.getSearchList)(),a=t.length;if(0===t.length)n.setState({countInfo:""});else{var i=e+1+"/"+a;n.setState({countInfo:i})}},n.replaceAction=function(){var e=n.state,t=e.searchText,a=e.replaceText;(0,b.replaceSearchText)(t,a,!1),m.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_replace_replace"})},n.replaceAllAction=function(){var e=n.state,t=e.searchText,a=e.replaceText;n.showReplaceAllDialog(t,a),m.default.tdwReport({opername:"doc_excel_editor",module:"excel_search",action:"clk_replace_replace_all"})},n.showReplaceAllDialog=function(e,t){var a=(0,b.updateString)(e,t);d.default.confirm({destroyOnClose:!0,mask:!0,maskStyle:{backgroundColor:"rgba(0, 0, 0, 0.4)"},style:{},title:"\u63d0\u793a",content:a,onOk:n.doReplaceAllAction})},n.doReplaceAllAction=function(){var e=n.state,t=e.searchText,a=e.replaceText;(0,b.replaceSearchText)(t,a,!0),n.setSearchText(t)},n.state={nextButtonDisabled:!0,searchText:"",replaceText:"",countInfo:""},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.searchInput=document.querySelector("#replace-panel-search-input"),this.searchInput&&this.searchInput.focus(),f.default.key.addNotFilter("replace-panel-search-input"),f.default.key.addNotFilter("replace-panel-replace-input")}},{key:"render",value:function(){var e=s.default.createElement("div",{className:"search-count-info"},s.default.createElement("div",{className:"search-count-info-content"},this.state.countInfo));return s.default.createElement("div",{className:"search-replace-content-wrap"},s.default.createElement("div",{className:"replace-info"},"\u67e5\u627e\u66ff\u6362\u9879"),s.default.createElement(u.default,{placeholder:"\u8f93\u5165\u67e5\u627e\u5185\u5bb9",id:"replace-panel-search-input",value:this.state.searchText,onChange:this.onChange,onCompositionEnd:this.onCompositionEnd,onClick:this.onInputClick,onKeyUp:this.onInputKeyUp,onMouseDown:function(e){return e.stopPropagation()},icon:e,autoComplete:"off"}),s.default.createElement("div",{className:"replace-info__dst"},"\u66ff\u6362\u4e3a"),s.default.createElement(u.default,{placeholder:"\u8f93\u5165\u66ff\u6362\u5185\u5bb9",id:"replace-panel-replace-input",value:this.state.replaceText,onChange:this.onDstChange,onMouseDown:function(e){return e.stopPropagation()},autoComplete:"off"}),s.default.createElement("div",{className:"search-button-wrap replace-button-wrap"},s.default.createElement("div",{className:"button-group-wrap"},s.default.createElement(c.default,{className:"common-button",onClick:this.clickCancel},"\u53d6\u6d88"),s.default.createElement(c.default,{className:"next-button common-button ml-16",type:this.state.nextButtonDisabled?"default":"primary",disabled:this.state.nextButtonDisabled,onClick:this.clickNext},"\u4e0b\u4e00\u4e2a"),s.default.createElement(c.default,{className:"common-button ml-16",type:this.state.nextButtonDisabled?"default":"primary",disabled:this.state.nextButtonDisabled,onClick:this.replaceAction},"\u66ff\u6362"),s.default.createElement(c.default,{className:"common-button ml-16",type:this.state.nextButtonDisabled?"default":"primary",disabled:this.state.nextButtonDisabled,onClick:this.replaceAllAction},"\u5168\u90e8\u66ff\u6362"))))}}]),t}(s.default.Component);t.default=_},1819:function(e,t,n){var a=n(1820);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1820:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,"/* tab */\n.search-replace-tab-wrap {\n  font-size: 14px;\n  font-weight: 400;\n  color: #8c8c8c;\n  height: 28px;\n  padding-top: 4px;\n  padding-left: 23px;\n  padding-right: 23px;\n  border-bottom: 1px solid rgba(0, 0, 0, 0.05);\n}\n.search-replace-tab-wrap li {\n  height: 28px;\n  margin-right: 24px;\n  display: inline-block;\n  cursor: pointer;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n  font-size: 16px;\n}\n.search-replace-tab-wrap li.active {\n  color: #188bf7 !important;\n  border-bottom: 2px solid #188bf7;\n}\n.search-replace-tab-wrap li li:hover {\n  color: #188bf7 !important;\n}\n/* content */\n.search-replace-content-wrap {\n  width: 328px;\n  margin-top: 8px;\n  margin-left: 23px;\n  margin-right: 23px;\n}\n.search-count-info {\n  width: 34px;\n  display: flex;\n  justify-content: flex-end;\n}\n.search-count-info-content {\n  color: #bbb;\n  background: #FFF;\n  padding-left: 3px;\n}\n.search-button-wrap {\n  width: 100%;\n  margin-top: 26px;\n}\n.search-button-wrap .button-group-wrap {\n  float: right;\n  display: flex;\n}\n.search-button-wrap .button-group-wrap .common-button {\n  height: 30px;\n  width: 72px;\n  padding: 0;\n}\n.search-button-wrap .button-group-wrap .ml-16 {\n  margin-left: 16px;\n}\n.replace-info {\n  font-size: 14px;\n  margin-bottom: 8px;\n  color: #333;\n}\n.replace-info__dst {\n  margin-top: 14px;\n  font-size: 14px;\n  margin-bottom: 8px;\n  color: #333;\n}\n.replace-button-wrap {\n  margin-left: 4px;\n}\n",""])},1821:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(16)),i=h(n(9)),o=h(n(0)),r=h(n(1)),l=n(767),s=n(113),u=n(245),c=h(n(40)),d=n(22),p=n(82),f=n(766);function h(e){return e&&e.__esModule?e:{default:e}}var m=function(){function e(t){(0,o.default)(this,e),this.app=t,this.IS_VALUED_FORMULA=null,this.formulaCategoryMap={},this.categoryFormulaMap={},this._show=!1,this._dom=null,this._toolbarDrop_selector="#toolbar-sheet-calculate-group .dropdown-wrapper-box",this._width=308,this._duration=300,this._easing="linear",this._formula="",this._formulaDetail=null,this._searchText="",this._recentlyList=[],this._searchList=[],this._selectList=[],this._list=null,this._type="select",this._hasBind=!1,this.init()}return(0,r.default)(e,[{key:"init",value:function(){var e=this;this.formulaCategory=window._formulaCategory||[],this._formulaDetail=window._formulaConfig||{},this.IS_VALUED_FORMULA=(0,i.default)(this._formulaDetail),this.formulaCategory.forEach(function(t){e.formulaCategoryMap[t.key]=t.values,t.values.forEach(function(n){e.categoryFormulaMap[n]=t.key})}),c.default.default.listen("header-fold-toggle",this.updatePosition.bind(this)),c.default.default.listen("updateFormulaEditorPosition",this.updatePosition.bind(this)),c.default.default.listen("injectFormulaIntoFormulaHistory",this.injectFormulaIntoFormulaHistory.bind(this)),$(window).load(function(){setTimeout(function(){e.addDefaultRencentlyList()},1e3)})}},{key:"_mapType2Formula",value:function(e){return this.formulaCategoryMap[e]||[]}},{key:"_getFormulaCategory",value:function(e){return this.categoryFormulaMap[e]}},{key:"_getHTML",value:function(){var e=[];return this.formulaCategory.forEach(function(t){e.push('<li data-formula-type="'+t.key+'" class="formula-item">'+t.name+"<i></i></li>")}),'<div id="formula-editor-container">\n                <div class="formula-editor-title-container">\n                    <div class="title">\u51fd\u6570</div>\n                </div>\n                <div class="formula-editor">\n                    <div class="formula-editor-search-container">\n                        <input type="text" id="formula-editor-search-input" placeholder="\u8bf7\u8f93\u5165\u51fd\u6570\u641c\u7d22" />\n                        <span class="formula-editor-search-close"></span>\n                    </div>\n                    <div class="formula-editor-tab-container">\n                        <div class="formula-editor-tab">\n                            <div class="formula-editor-select formula-editor-table" style="display: none;">\n                                <div class="formula-part left">\n                                    <div class="tab-select">\n                                        <ul>\n                                            <li class="all formula-item">\u5168\u90e8<i></i></li>\n                                            <li class="recently formula-item">\u6700\u8fd1\u4f7f\u7528<i></i></li>\n                                        </ul>\n                                    </div>\n                                    <div class="line"></div>\n                                    <div class="tab-type">\n                                        <ul>'+e.join("")+'</ul>\n                                    </div>\n                                </div>\n                                <div class="formula-part right">\n                                    <ul class="formula-editor-list"></ul>\n                                    <div class="line"></div>\n                                </div>\n                            </div>\n                            <div class="formula-editor-search formula-editor-table" style="display: none;">\n                                <ul class="formula-editor-list"></ul>\n                            </div>\n                        </div>\n                    </div>\n                    <div class="formula-editor-button">\n                        <button id="formula-editor-inject-button" class="pad-ui-btn pad-ui-btn-normal pad-ui-btn-blue">\u63d2\u5165\u51fd\u6570</button>\n                    </div>\n                    <div id="formula-editor-line" class="formula-editor-line"></div>\n                    <div class="formula-editor-detail-container"></div>\n                </div>\n            </div>\n            <div id="formula-editor-close"></div>'}},{key:"_changeOffsetX",value:function(e){var t=this.app.view.canvas.excel;t&&t.changeOffsetX(e)}},{key:"_setType",value:function(e){if("search"===e||"select"===e){this._type!==e&&(this._type=e);var t=this,n=$(this._dom).find(".formula-editor-select"),a=$(this._dom).find(".formula-editor-search");if("search"===this._type){this._selectList=[],n.hide(),a.show();var i=this._getFormulaList(),o=[],r=[];i&&i.forEach(function(e){var n=e.indexOf(t._searchText);0===n?o.push(e):n>0&&r.push(e)});var l=o.concat(r);this._setSearchList(l),l.length?(t._enabledInjectBtn(),$(".formula-editor-search .formula-editor-list li:first-child").trigger("click")):($(".formula-editor-search .formula-editor-list").html('<li class="formula-item">\u65e0\u641c\u7d22\u7ed3\u679c\u3002</li>'),this._formula="",t._disabledInjectBtn(),t._updateDetail(""))}else this._searchList=[],n.show(),a.hide(),$("#formula-editor-container .formula-editor-select .all").trigger("click")}}},{key:"_getDetailObj",value:function(e){var t=this._getFormulaDetail();return t[e]||t[e.toUpperCase()]||t[e.toLowerCase()]}},{key:"_getFormulaDetail",value:function(){if(this._formulaDetail)return this._formulaDetail}},{key:"_getFormulaList",value:function(){var e=this;if(this._list)return this._list;var t=this._getFormulaDetail(),n=function(){var n=[];for(var a in t)if(e.IS_VALUED_FORMULA.indexOf(a.toLowerCase())>-1){var i=t[a];n.push(i.title)}return n}();return(n=n.join("").replace(/\(\*?\)/g,",").split(",")).pop(),this._list=n,n}},{key:"_setSearchList",value:function(e){if(!(0,s.arrayEqual)(this._searchList,e)){this._searchList=e;var t=$("#formula-editor-container .formula-editor-search .formula-editor-list"),n="";e.forEach(function(e){n+='<li class="formula-item">'+e+"</li>"}),t.html(n),t.find("li:first-child").trigger("click"),this._updateSplitHeight()}}},{key:"_updateDetail",value:function(e){var t=$(".formula-editor-detail-container"),n=$(".formula-detail-item-box");if(t.html(""),n.remove(),e){var a=e.title.replace(/\(\*?\)/,""),i=e.subItem[1].detail,o=function(){for(var t=e.titleParams,n=[],a=0;a<t.length;a++)n.push(t[a].name);return e.title.replace(/\*/,n.join(","))}(),r=e.subItem[0].detail,l='<div class="formula-detail-item"><p class="formula-item-title">'+a+'</p><p class="formula-item-sub-title formula-item-instruction">'+i+"</p></div>";n=$('<div class="formula-detail-item-box"><div class="formula-detail-item"><p class="formula-item-title">\u8bed\u6cd5\uff1a</p><p class="formula-item-sub-title formula-item-grammer">'+o+'</p></div><div class="formula-detail-item"><p class="formula-item-title">\u793a\u4f8b\uff1a</p><p class="formula-item-sub-title formula-item-example">'+r+"</p></div><div>"),t.append($(l)),t.append(n);for(var s=2;s<e.subItem.length;s++){var u=e.subItem[s],c='<div class="formula-detail-item"><p class="formula-item-title">'+u.title+'\uff1a</p><p class="formula-item-sub-title formula-item-param">'+u.detail+"</p></div>";n.append($(c))}this._formula=a,t.show()}}},{key:"_disabledInjectBtn",value:function(){$("#formula-editor-inject-button").attr("disabled","disabled")}},{key:"_enabledInjectBtn",value:function(){$("#formula-editor-inject-button").removeAttr("disabled")}},{key:"_updateRencentlyList",value:function(){if("rencently"===this._typeCode){var e=this._recentlyList;if(!(0,s.arrayEqual)(this._selectList,e)){this._selectList=this._recentlyList;var t=$("#formula-editor-container .formula-editor-select .formula-editor-list");if(e&&e.length){var n="";e.forEach(function(e){n+='<li class="formula-item">'+e+"</li>"}),t.html(n),t.find("li:first-child").trigger("click")}else t.html('<li class="formula-item">\u65e0</li>'),this._updateDetail("");this._updateSplitHeight()}}}},{key:"addDefaultRencentlyList",value:function(){this._typeCode="rencently",this._recentlyList&&0!=this._recentlyList.length||(this._recentlyList=["LOOKUP","INT","ISNA"]),this._updateRencentlyList(),c.default.default.trigger("updateFormulaHistory",this._recentlyList),this._typeCode=void 0}},{key:"gethistory",value:function(){var e=this;$.ajax({url:"/sdc/func/gethistory",type:"GET",success:function(t){t.retcode;var n=t.data||[];e._recentlyList=n,c.default.default.trigger("updateFormulaHistory",e._recentlyList),e._updateRencentlyList(),(0,u.horizontalTooltip)($(".formula-editor-drop"),{"min-width":66,left:10})},error:function(e,t){}}),e.bindToolBarEvent()}},{key:"_updatehistory",value:function(e){if(e){var t=e.toUpperCase();$.ajax({url:"/sdc/func/updatehistory",type:"POST",dataType:"json",data:{data:(0,a.default)([t.toUpperCase()])},success:function(e){var t=e.retcode,n=e.tips;0!=t&&console.error("/sdc/func/updatehistory error: ",n)},error:function(e){console.error("\u66f4\u65b0\u6700\u8fd1\u4f7f\u7528\u51fd\u6570\u5217\u8868\u51fa\u9519\u3002error: ",e)}})}}},{key:"_render",value:function(){var e=this._getHTML(),t=$(e),n=$("body"),a=(0,f.getEditorTop)()+1;t.css("top",a),t.css("z-index",666),$(n).append(t),this._dom=t[0]}},{key:"injectFormula",value:function(e){e=e.toUpperCase(),SpreadsheetApp.view.canvas.excel.insertFormula({formula:e}),this.injectFormulaIntoFormulaHistory(e),T_SHEET.Report.tdwReport({obj3:e,module:"insert",opername:"doc_function",action:this._getFormulaCategory(e)})}},{key:"injectFormulaIntoFormulaHistory",value:function(e){for(var t=[],n=0;n<this._recentlyList.length;n++)this._recentlyList[n]!==e&&t.push(this._recentlyList[n]);t.unshift(e),this._recentlyList=t,c.default.default.trigger("updateFormulaHistory",this._recentlyList),this._updateRencentlyList(),this._updatehistory(e)}},{key:"_bindEvent",value:function(){var e=this,t=this;c.default.toolBar.trigger("resize"),$(document).on("click","#formula-editor-close",function(e){t.hide(),c.default.toolBar.trigger("resize")});var n=$("#formula-editor-container .formula-editor-search-close");n.on("click",function(){t._setType("select"),$("#formula-editor-search-input").val(""),n.hide()}),$(document).on("input propertychange","#formula-editor-search-input",(0,s.throttle)(function(e){var a=e.target.value.toString().trim().toUpperCase();t._searchText=a,a?(t._setType("search"),n.show()):(t._setType("select"),n.hide())},200)),$("#formula-editor-search-input").on("keyup",this._selectFormulaByKeyboard.bind(this)),$(document).on("click","#formula-editor-inject-button",function(e){var n=t._formula;t.injectFormula(n)}),$(document).on("click","#formula-editor-container .formula-editor-list .formula-item",function(e){var n=$(e.target),a=n.text().toLowerCase();n.parent().find(".active").removeClass("active"),n.addClass("active");var i=t._getDetailObj(a);t._updateDetail(i)}),$(document).on("click",".formula-editor-select .all",function(e){$(".formula-editor-select li").removeClass("active"),$(".formula-editor-select .all").addClass("active"),t._typeCode="all";var n=t._getFormulaList();if(n&&n.length?t._enabledInjectBtn():t._disabledInjectBtn(),!(0,s.arrayEqual)(t._selectList,n)){t._selectList=n.sort();var a=$("#formula-editor-container .formula-editor-select .formula-editor-list"),i="";n.forEach(function(e){i+='<li class="formula-item">'+e+"</li>"}),a.html(i),a.find("li:first-child").trigger("click"),t._updateSplitHeight()}}),$(document).on("click",".formula-editor-select .recently",function(e){if("rencently"!==t._typeCode){$(".formula-editor-select li").removeClass("active"),$(".formula-editor-select .recently").addClass("active"),t._typeCode="rencently";var n=t._recentlyList;n&&n.length?t._enabledInjectBtn():t._disabledInjectBtn(),t._updateRencentlyList()}}),$(document).on("click",".formula-editor-select .tab-type li",function(n){var a=$(n.target);$(".formula-editor-select .left li").removeClass("active"),a.addClass("active");var i=a.data("formula-type");t._typeCode=i;var o=e._mapType2Formula(i);if(o&&o.length?t._enabledInjectBtn():t._disabledInjectBtn(),!(0,s.arrayEqual)(t._selectList,o)){t._selectList=o.sort();var r=$("#formula-editor-container .formula-editor-select .formula-editor-list"),l="";o.forEach(function(e){l+='<li class="formula-item">'+e+"</li>"}),r.html(l),r.find("li:first-child").trigger("click"),t._updateSplitHeight()}}),(0,l.optimizedResize)(function(){e._show&&e.updatePosition(!0)})}},{key:"_updateSplitHeight",value:function(){var e=$("#formula-editor-container .formula-part.right"),t=$("#formula-editor-container .formula-part.right .formula-editor-list"),n=$("#formula-editor-container .formula-part.right .line");if(t&&n&&e&&e.length&&t.length){var a=Math.max(e[0].offsetHeight,t[0].scrollHeight);n.css("height",a+"px")}}},{key:"_selectFormulaByKeyboard",value:function(e){var t=e.keyCode,n=38===t,a=40===t;if(13===t&&this._formula)this.injectFormula(this._formula);else if(n||a){var i=$(".formula-editor-search .formula-editor-list");if(!(i.children().length<2)){var o=i.find(".active");if(o.length&&-1!==o.index()){var r=n?o.prev():o.next();if(r=1===r.length?r:n?i.find(".formula-item").last():i.find(".formula-item").first()){r.addClass("active").siblings().removeClass("active");var l=r.text();e.target.value=l,this._updateDetail(this._getDetailObj(l));var s=$(".formula-editor-search.formula-editor-table"),u=s.prop("scrollHeight"),c=s.prop("clientHeight");if(!(u<=c)){var d=r.index(),p=parseInt(c/r.height());if(d+1>p){var f=(d-p+1)*r.height();s.scrollTop(f)}else s.scrollTop(0)}}}}}}},{key:"_init",value:function(){this._render(),this._bindEvent(),this._bindIpadEvent(),this.gethistory(),this._setType("select")}},{key:"bindToolBarEvent",value:function(){if(!this._hasBind){var e=this;$(document).on("click",e._toolbarDrop_selector+" li.formula-editor-drop",function(t){var n=$(t.currentTarget).find(".dropdown-content").text();e.injectFormula(n),function(e){try{T_SHEET.Report.tdwReport({opername:"doc_function",module:"imp_id",action:"clk_func",ver5:(0,a.default)({type:e,isRencent:!0})})}catch(t){console.warn(t)}}(n),$("#dropdown-wrapper-2").removeClass("open")}),this._hasBind=!0}}},{key:"_bindIpadEvent",value:function(){this._dom&&d.isPad&&!d.isTimOrQQFamily&&((0,l.stopSpringBack)(this._dom.querySelector(".formula-part.left")),(0,l.stopSpringBack)(this._dom.querySelector(".formula-part.right")),(0,l.stopSpringBack)(this._dom.querySelector(".formula-editor-detail-container")))}},{key:"getRecentlyFormulas",value:function(){return this._recentlyList}},{key:"show",value:function(){var e=this;if(!this._show){this._show=!0,c.default.toolBar.trigger("beforePCFormulaPanelShow"),this._dom||this._init();var t=$("#formula-editor-container")||$(this._dom);this.updatePosition(),this.app.event.default.trigger(p.EVENT_NAME.UI_SHOW,"formula-editor-panel"),t.animate({right:0},this._duration,this._easing,function(){$("#formula-editor-close").show(),c.default.toolBar.trigger("afterPCFormulaPanelShow")}),this._changeOffsetX(this._width-3),c.default.default.listen("discussShow",function(t){t&&e.hide()})}}},{key:"hide",value:function(){if(this._show){this._show=!1,c.default.toolBar.trigger("beforePCFormulaPanelHide"),$(this._dom).animate({right:-this._width},this._duration,this._easing,function(){c.default.toolBar.trigger("afterPCFormulaPanelHide")}),this._changeOffsetX(0),this.restoreToolbarAfterPanelHide(),$("#formula-editor-close").hide()}}},{key:"adaptToolbarWithFormulaPanel",value:function(e){$("#web_header_bottom");return this}},{key:"restoreToolbarAfterPanelHide",value:function(){return $("#web_header_bottom").css("width","100%"),this}},{key:"updatePosition",value:function(e){var t=this;if(this._show)return setTimeout(function(){var n=(0,f.getEditorTop)()+1,a=(0,f.getEditorBottom)();$("#formula-editor-container").css({top:n,bottom:a}),$("#formula-editor-close").css({top:n+12}),t.adaptToolbarWithFormulaPanel(e);var i=$("#formula-editor-line").position().top+20;$(".formula-editor-detail-container").css({top:Math.round(i)}).show()},200),this}},{key:"isShow",value:function(){return this._show}},{key:"getWidth",value:function(){return this._width}},{key:"setAnimation",value:function(e,t){this._duration=e,t&&(this._easing=t)}}]),e}();t.default=m},1822:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),i=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}n(1823);var r=function(){function e(t){(0,a.default)(this,e),this.app=t,this.inited=!1,this.components=[],this.showingComponent=null}return(0,i.default)(e,[{key:"initComponent",value:function(e){var t=this;if(!this.init())return null;var n=e.name,a=e.id,i=e.classname,o=this.getComponent(n);if(o)return o;var r=document.createElement("div");return a&&(r.id=a),i&&(r.className=i),this.root.appendChild(r),o={name:n,container:r,show:function(){t.show(n)},hide:function(){t.hide(n)}},this.components.push(o),o}},{key:"getShowPanelName",value:function(){return this.showingComponent&&this.showingComponent.name}},{key:"show",value:function(e){var t=this;this.showingComponent&&this.showingComponent.name!==e&&(this.showingComponent.container.style.display="none");var n=this.getComponent(e);n&&(n.container.style.display="block",this.root.style.display="block",this.root.classList.remove("side-panel-hide"),this.root.classList.add("side-panel-show"),this.showingComponent=n,document.body.classList.add("side-panel-show"),setTimeout(function(){t.app.view&&t.app.view.canvas.excel&&t.app.view.canvas.excel.resize()},0))}},{key:"hide",value:function(e){var t=this;if(this.showingComponent){var n=this.getComponent(e);n&&(n.container.style.display="none",this.root.style.display="none",this.root.classList.remove("side-panel-show"),this.root.classList.add("side-panel-hide"),this.showingComponent=null,document.body.classList.remove("side-panel-show"),setTimeout(function(){t.app.view&&t.app.view.canvas.excel&&t.app.view.canvas.excel.resize()},0))}}},{key:"getComponent",value:function(e){var t=this.components.filter(function(t){return t.name===e});return t.length<1?null:t[0]}},{key:"init",value:function(){if(this.inited)return!0;var e=document.createElement("div");e.id="side-panel-main",e.style.display="none";var t=document.getElementById("padpage"),n=document.getElementById("canvasContainer");return!(!t||!n)&&(t.appendChild(e),this.canvasContainer=n,this.root=e,this.inited=!0,!0)}}]),e}();t.default=r},1823:function(e,t,n){var a=n(1824);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1824:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,"#side-panel-main {\n  position: absolute;\n  width: 270px;\n  height: 100%;\n  top: 1px;\n  right: 0;\n  z-index: 666;\n  border-left: 1px solid rgba(0, 0, 0, 0.06);\n}\n#side-panel-main.side-panel-show {\n  -webkit-animation: show-from-right 0.2s linear;\n          animation: show-from-right 0.2s linear;\n}\n@-webkit-keyframes show-from-right {\n  0% {\n    -webkit-transform: translate(100%, 0);\n            transform: translate(100%, 0);\n  }\n  20% {\n    -webkit-transform: translate(80%, 0);\n            transform: translate(80%, 0);\n  }\n  40% {\n    -webkit-transform: translate(60%, 0);\n            transform: translate(60%, 0);\n  }\n  60% {\n    -webkit-transform: translate(40%, 0);\n            transform: translate(40%, 0);\n  }\n  80% {\n    -webkit-transform: translate(20%, 0);\n            transform: translate(20%, 0);\n  }\n  100% {\n    -webkit-transform: translate(0%, 0);\n            transform: translate(0%, 0);\n  }\n}\n@keyframes show-from-right {\n  0% {\n    -webkit-transform: translate(100%, 0);\n            transform: translate(100%, 0);\n  }\n  20% {\n    -webkit-transform: translate(80%, 0);\n            transform: translate(80%, 0);\n  }\n  40% {\n    -webkit-transform: translate(60%, 0);\n            transform: translate(60%, 0);\n  }\n  60% {\n    -webkit-transform: translate(40%, 0);\n            transform: translate(40%, 0);\n  }\n  80% {\n    -webkit-transform: translate(20%, 0);\n            transform: translate(20%, 0);\n  }\n  100% {\n    -webkit-transform: translate(0%, 0);\n            transform: translate(0%, 0);\n  }\n}\n#side-panel-main.side-panel-hide {\n  -webkit-animation: hide-to-right 0.2s linear;\n          animation: hide-to-right 0.2s linear;\n}\n@-webkit-keyframes hide-to-right {\n  0% {\n    -webkit-transform: translate(0%, 0);\n            transform: translate(0%, 0);\n  }\n  20% {\n    -webkit-transform: translate(20%, 0);\n            transform: translate(20%, 0);\n  }\n  40% {\n    -webkit-transform: translate(40%, 0);\n            transform: translate(40%, 0);\n  }\n  60% {\n    -webkit-transform: translate(60%, 0);\n            transform: translate(60%, 0);\n  }\n  80% {\n    -webkit-transform: translate(80%, 0);\n            transform: translate(80%, 0);\n  }\n  100% {\n    -webkit-transform: translate(100%, 0);\n            transform: translate(100%, 0);\n  }\n}\n@keyframes hide-to-right {\n  0% {\n    -webkit-transform: translate(0%, 0);\n            transform: translate(0%, 0);\n  }\n  20% {\n    -webkit-transform: translate(20%, 0);\n            transform: translate(20%, 0);\n  }\n  40% {\n    -webkit-transform: translate(40%, 0);\n            transform: translate(40%, 0);\n  }\n  60% {\n    -webkit-transform: translate(60%, 0);\n            transform: translate(60%, 0);\n  }\n  80% {\n    -webkit-transform: translate(80%, 0);\n            transform: translate(80%, 0);\n  }\n  100% {\n    -webkit-transform: translate(100%, 0);\n            transform: translate(100%, 0);\n  }\n}\n",""])},1825:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),i=h(n(0)),o=h(n(1)),r=h(n(4)),l=h(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=h(n(123)),c=h(n(1826)),d=n(1677),p=h(n(1725));n(1833);var f=h(n(7));function h(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.show=function(){n.init()&&(n.isShowing||(n.container&&(!n.container.children||n.container.children.length<1)&&u.default.render(n.render(),n.container),n.rulesContainerRef&&n.rulesContainerRef.panelLoad(),n.panelShow&&n.panelShow(),n.isShowing=!0,f.default.event.toolBar.trigger("conditionalFormatPanelShow")))},n.hide=function(){n.isShowing&&(n.panelHide&&n.panelHide(),n.isShowing=!1,n.rulesContainerRef&&n.rulesContainerRef.panelUnload(),f.default.event.toolBar.trigger("conditionalFormatPanelHide"))},n.app=e,n.inited=!1,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"init",value:function(){if(this.inited)return!0;var e=this.app.view.plugins.sidePanelMain;if(e){var t=e.initComponent({name:"conditional-format",id:"conditional-format-panel",classname:"conditional-format-panel"});return!!t&&(this.panelHide=t.hide,this.panelShow=t.show,this.container=t.container,this.inited=!0,u.default.render(this.render(),this.container),!0)}return!1}},{key:"render",value:function(){var e=this;return s.createElement(d.Provider,{store:p.default},s.createElement(c.default,{app:this.app,panelHide:this.hide,ref:function(t){e.rulesContainerRef=t}}))}}]),t}(s.Component);t.default=m},1826:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),i=c(n(0)),o=c(n(1)),r=c(n(4)),l=c(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=c(n(1827));function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={panelIsShow:!1},n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"panelLoad",value:function(){this.setState({panelIsShow:!0})}},{key:"panelUnload",value:function(){this.setState({panelIsShow:!1})}},{key:"render",value:function(){return s.createElement(u.default,{app:this.props.app,panelHide:this.props.panelHide,panelIsShow:this.state.panelIsShow})}}]),t}(s.Component);t.default=d},1827:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(3)),i=g(n(0)),o=g(n(1)),r=g(n(4)),l=g(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=g(n(1828)),c=g(n(1832)),d=n(1677),p=n(440),f=g(n(7)),h=n(1710),m=n(1726),v=n(82);function g(e){return e&&e.__esModule?e:{default:e}}var b=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.updateRulesNumber=function(){n.props.setRulesNumber(n.app.plugins.conditionalFormat.getRuleListCountWithCurrentSelection())},n.clickAddRules=function(){n.props.manageIsShow?(n.props.resetEditor(),n.props.switchEditorManage(),(0,m.condFormatReport)("rule_manage_panel_create")):(n.applyEditingRuleFunc&&n.applyEditingRuleFunc()&&(n.props.resetEditor(),n.setRangeWithSelection()),(0,m.condFormatReport)("rule_panel_more_rule"))},n.clickManageRules=function(){n.props.editorIsShow&&(0,m.condFormatReport)("rule_panel_clk_manage"),n.props.switchEditorManage()},n.getApplyEditingRuleFunc=function(e){n.applyEditingRuleFunc=e},n.app=e.app,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"shouldComponentUpdate",value:function(e){return e.panelIsShow!==this.props.panelIsShow&&(e.panelIsShow?((0,m.getAllRulesWithSelection)(this.app).length>0?(this.props.setManageStatus(!0),this.props.setEditorStatus(!1),(0,m.condFormatReport)("rule_manage_init_show")):(this.props.setRange(""),this.props.resetEditor(),this.props.setManageStatus(!1),this.props.setEditorStatus(!0),(0,m.condFormatReport)("rule_edit_init_show")),this.updateRulesNumber(),f.default.event.view.listen(v.EVENT_NAME.SELECTION_CHANGE,this.updateRulesNumber),f.default.event.spreadsheetEvent.listen(v.EVENT_NAME.DATA_CHANGE,this.updateRulesNumber)):(this.props.setEditorStatus(!1),this.props.setManageStatus(!1),f.default.event.view.remove(v.EVENT_NAME.SELECTION_CHANGE,this.updateRulesNumber),f.default.event.spreadsheetEvent.remove(v.EVENT_NAME.DATA_CHANGE,this.updateRulesNumber))),!0}},{key:"setRangeWithSelection",value:function(){var e=this.app.view.getSelection().rangeSelections[0],t=(0,p.range2RelativeHex)(e);this.props.setRange(t)}},{key:"render",value:function(){return s.createElement(s.Fragment,null,s.createElement("div",{className:"conditional-format-title"},s.createElement("p",null,"\u6761\u4ef6\u683c\u5f0f"),s.createElement("button",{className:"conditional-format-close",onClick:this.props.panelHide})),s.createElement("div",{className:"conditional-format-split"}),s.createElement("div",{className:"conditional-format-body"},s.createElement(u.default,{app:this.app,isShow:this.props.editorIsShow,getApplyEditingRuleFunc:this.getApplyEditingRuleFunc,panelHide:this.props.panelHide}),s.createElement(c.default,{app:this.app,isShow:this.props.manageIsShow}),s.createElement("div",{className:"conditional-format-split wh-230 ml-20"}),s.createElement("div",{className:"conditional-format-foot"},s.createElement("div",{className:"conditional-format-foot-line"},s.createElement("div",{className:"conditional-format-foot-btn",onClick:this.clickAddRules},s.createElement("i",{className:"conditional-format-add"}),s.createElement("span",null,this.props.rulesNumber<1&&this.props.manageIsShow?"\u6dfb\u52a0\u65b0\u89c4\u5219":"\u6dfb\u52a0\u5176\u4ed6\u89c4\u5219"))),s.createElement("div",{className:"conditional-format-foot-line",hidden:this.props.manageIsShow},s.createElement("div",{className:"conditional-format-foot-btn",onClick:this.clickManageRules},s.createElement("i",{className:"conditional-format-manage"}),s.createElement("span",null,"\u7ba1\u7406\u89c4\u5219",s.createElement("span",{className:"conditional-format-rules-number",hidden:this.props.rulesNumber<1},"(",this.props.rulesNumber,")")))))))}}]),t}(s.Component);t.default=(0,d.connect)(function(e){return{editorIsShow:e.editorIsShow,manageIsShow:e.manageIsShow,editingRule:e.editing,rulesNumber:e.rulesNumber}},h.mapDispatchToProps)(b)},1828:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(3)),i=T(n(0)),o=T(n(1)),r=T(n(4)),l=T(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=T(n(1696)),c=T(n(759)),d=n(440),p=T(n(7)),f=T(n(1829)),h=T(n(1830)),m=n(1677),v=T(n(1725)),g=n(1710),b=n(760),y=n(1726),E=n(82),_=n(1703),w=T(n(308));function T(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.handleSwitchSheet=function(){n.app.spreadsheet.getActiveSheetId()!==n.sheetId&&n.switchToManageToClearLastRuleId()},n.checkEditingRuleConflict=function(){if(!n.dataChangedBySelf){n.dataChangedBySelf=!1;var e=v.default.getState().editing.ruleId;!(0,y.getRuleById)(n.app,e)&&e&&n.switchToManageToClearLastRuleId()}},n.handleSelectionChangeListener=function(){n.inputRangeRef&&n.inputRangeRef!==document.activeElement||(n.setRangeWhenSelection(),(0,y.condFormatReport)("rule_panel_select_area"),setTimeout(function(){n.inputRangeRef&&n.inputRangeRef.focus()},0))},n.setRangeWhenSelection=function(){var e=n.app.view.getSelection().rangeSelections[0],t=(0,d.range2RelativeHex)(e);n.props.setRange(t)},n.rangeInputChange=function(e){n.props.setRange(e),(0,y.condFormatReport)("rule_panel_type_area"),-1!==e.indexOf(",")&&(0,y.condFormatReport)("rule_panel_type_nonadjacent_area")},n.applyEditingRule=function(e){if(!n.verifyInput())return!1;var t=v.default.getState(),a=t.editing,i=a.format,o=a.condition,r=n.app.spreadsheet.getActiveSheetId(),l={ranges:t.editing.ranges.split(",").map(function(e){return(0,d.absoluteHex2Range)(e,r)}),booleanCondition:{condition:{conditionType:o.conditionType,inputOne:o.inputOne,inputTwo:o.inputTwo},format:{bgColor:i.paintColor}},gradientCondition:null};n.dataChangedBySelf=!0;var s=t.editing.ruleId;if(s){var u=n.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleWithIndexById(s),c=u&&u.index;if("number"!==typeof c)return!1;n.app.plugins.conditionalFormat.updateRule(c,l),n.props.setLastEditRuleId(e?s:"")}else{n.app.plugins.conditionalFormat.addRule(l);var p=n.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleByRuleIndexWithId(0);p&&n.props.setLastEditRuleId(e?p.id:"")}return _.NUMBER_TYPE_KEY.indexOf(o.conditionType)&&(0,y.condFormatReport)("select_num"),(0,y.condFormatReport)(_.COND_REPORT_MAP.get(o.conditionType)),(0,y.condFormatReport)(_.PAINT_COLOR_REQPRT_MAP[_.PAINT_COLOR.indexOf(i.paintColor)]),!0},n.saveEditingAndAddNewOne=function(){var e=n.editBodyRef;return e&&e.classList&&(e.classList.add("edit-body-switch-animation"),setTimeout(function(){e.classList.remove("edit-body-switch-animation")},400)),n.applyEditingRule(!1)},n.clickCancelButton=function(){var e=v.default.getState().editing.ruleId,t=(0,y.getAllRulesWithSelectionForUI)(n.app);!e&&t.length<1?n.props.panelHide():(n.switchToManageToClearLastRuleId(),(0,y.condFormatReport)("rule_panel_cancel"))},n.clickConfirmButton=function(){n.applyEditingRule(!0)&&n.props.switchEditorManage(),(0,y.condFormatReport)("rule_panel_done")},n.app=e.app,n.dataChangedBySelf=!1,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidMount",value:function(){this.props.getApplyEditingRuleFunc(this.saveEditingAndAddNewOne)}},{key:"componentDidUpdate",value:function(e){var t=this;!e.isShow&&this.props.isShow?(0===this.props.ranges.length&&this.setRangeWhenSelection(),this.sheetId=this.app.spreadsheet.getActiveSheetId(),setTimeout(function(){t.inputRangeRef&&t.inputRangeRef.focus()},300),this.app.view.canvas.excel.event.eventSelection.listen("selectionShow",this.handleSelectionChangeListener),p.default.event.spreadsheetEvent.listen(E.EVENT_NAME.DATA_CHANGE,this.checkEditingRuleConflict),this.app.event.sheetsBar.listen("switchSheet",this.handleSwitchSheet),this.app.event.sheetsBar.listen("addSheet",this.handleSwitchSheet),this.app.event.sheetsBar.listen("deleteSheet",this.handleSwitchSheet)):e.isShow&&!this.props.isShow&&(this.app.view.canvas.excel.event.eventSelection.remove("selectionShow",this.handleSelectionChangeListener),p.default.event.spreadsheetEvent.remove(E.EVENT_NAME.DATA_CHANGE,this.checkEditingRuleConflict),this.app.event.sheetsBar.remove("switchSheet",this.handleSwitchSheet),this.app.event.sheetsBar.remove("addSheet",this.handleSwitchSheet),this.app.event.sheetsBar.remove("deleteSheet",this.handleSwitchSheet))}},{key:"switchToManageToClearLastRuleId",value:function(){this.props.switchEditorManage(),this.props.setLastEditRuleId("")}},{key:"inputInvalidAlert",value:function(e){w.default.confirm({title:"\u6761\u4ef6\u683c\u5f0f",className:"conditional-format-error-dialog",destroyOnClose:!0,style:{width:450},content:e})}},{key:"verifyInput",value:function(){var e=v.default.getState(),t=e.editing,n=t.format,a=t.condition;if(!n||!a)return!1;var i=!1,o=!1,r=e.editing.ranges.split(","),l=a.inputOne,s=a.inputTwo,u=a.inputTwoShow;return r.every(function(e){return(0,d.isValidHexRange)(e)})||(i=!0),(0,b.isLeagalNumber)(l)?u&&!(0,b.isLeagalNumber)(s)&&(o=!0):o=!0,i?(this.inputInvalidAlert("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u5e94\u7528\u8303\u56f4\uff0c\u5982\u201cC7:F19\u201d\u3002"),!1):!o||(this.inputInvalidAlert("\u8bf7\u8f93\u5165\u6709\u6548\u7684\u6570\u503c\u3002"),!1)}},{key:"render",value:function(){var e=this;return s.createElement("div",{className:"conditional-format-edit-body",hidden:!this.props.isShow,ref:function(t){e.editBodyRef=t}},s.createElement("div",{className:"conditional-format-edit-block"},s.createElement("p",{className:"conditional-format-edit-title"},"\u5e94\u7528\u8303\u56f4"),s.createElement(u.default,{placeholder:"\u5728\u5de5\u4f5c\u8868\u4e2d\u6846\u9009\u8303\u56f4",value:this.props.ranges,onChange:this.rangeInputChange,inputRef:function(t){e.inputRangeRef=t}})),s.createElement("div",{className:"conditional-format-edit-block"},s.createElement(f.default,{app:this.app}),s.createElement(h.default,{app:this.app})),s.createElement("div",{className:"conditional-format-edit-buttons"},s.createElement(c.default,{className:"common-button",onClick:this.clickCancelButton},"\u53d6\u6d88"),s.createElement(c.default,{type:"primary",className:"common-button ml-20",onClick:this.clickConfirmButton},"\u5b8c\u6210")),s.createElement("div",{className:"clear-float"}))}}]),t}(s.Component);t.default=(0,m.connect)(function(e){return{ranges:e.editing.ranges}},g.mapDispatchToProps)(I)},1829:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(14)),i=m(n(3)),o=m(n(0)),r=m(n(1)),l=m(n(4)),s=m(n(5)),u=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),c=m(n(1696)),d=m(n(1683)),p=n(1703),f=n(1677),h=n(1710);function m(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,i.default)(t)).call(this,e));return n.conditionTypeChange=function(e){var t=parseInt(e,10);n.props.setConditionType(t);var a=(0,p.shouldElementShow)(t);n.props.setInputTwoValue(""),n.props.setInputOneValue(""),a.inputTwoShow?n.props.setInputTwoStatus(!0):n.props.setInputTwoStatus(!1)},n.app=e.app,n}return(0,s.default)(t,e),(0,r.default)(t,[{key:"generateOperatorOption",value:function(e,t){return e.map(function(e){return u.createElement(d.default.Option,{value:e.toString(),key:e.toString()},t.get(e))})}},{key:"render",value:function(){var e=this.props.inputTwoShow?"wh-99":"wh-230";return u.createElement("div",null,u.createElement("p",{className:"conditional-format-edit-title"},"\u683c\u5f0f\u89c4\u5219"),u.createElement("div",{className:"conditional-format-editing-line"},u.createElement("div",{className:"conditional-format-rule-tip"},"\u7b26\u5408\u4ee5\u4e0b\u6761\u4ef6\u65f6\u4e3a\u5355\u5143\u683c\u5e94\u7528\u683c\u5f0f"),u.createElement("div",{className:"mb-8"},u.createElement(d.default,{value:this.props.conditionType.toString(),className:"common-select",onChange:this.conditionTypeChange},this.generateOperatorOption(p.NUMBER_TYPE_KEY,p.COND_TYPE_MAP))),u.createElement("div",{className:"conditional-format-inline-input ht-34",hidden:!this.props.inputOneShow&&!this.props.inputTwoShow},u.createElement(c.default,{className:e,placeholder:"\u6570\u503c",value:this.props.inputOne,hidden:!this.props.inputOneShow,onChange:this.props.setInputOneValue}),u.createElement("div",{className:"ml-8 mr-8",style:{display:this.props.inputTwoShow?"inline-block":"none"}},"\u4e0e"),u.createElement(c.default,{className:"wh-99",placeholder:"\u6570\u503c",value:this.props.inputTwo,style:{display:this.props.inputTwoShow?"inline-block":"none"},onChange:this.props.setInputTwoValue}))))}}]),t}(u.Component);t.default=(0,f.connect)(function(e){return(0,a.default)({},e.editing.condition)},h.mapDispatchToProps)(v)},1830:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),i=f(n(0)),o=f(n(1)),r=f(n(4)),l=f(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=f(n(1683)),c=n(1703),d=n(1677),p=n(1710);function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.app=e.app,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"render",value:function(){return s.createElement("div",{className:"conditional-format-editing-line"},s.createElement("div",{className:"conditional-format-rule-tip"},"\u80cc\u666f\u989c\u8272"),s.createElement(u.default,{value:this.props.paintColor,onChange:this.props.setPaintColor,className:"common-select"},c.PAINT_COLOR.map(function(e,t){return s.createElement(u.default.Option,{value:e,key:e},c.PAINT_COLOR_MAP[t])})))}}]),t}(s.Component);t.default=(0,d.connect)(function(e){return{paintColor:e.editing.format.paintColor}},p.mapDispatchToProps)(h)},1831:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,i=n(14),o=(a=i)&&a.__esModule?a:{default:a};t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:d,t=arguments[1],n=(0,o.default)({},e),a=t.type,i=t.payload;switch(a){case r.ACTION.RESET_STATE:return c();case r.ACTION.SET_RULES_NUMBER:n.rulesNumber=i.rulesNumber;break;case r.ACTION.SET_LAST_RULE_ID:n.lastEditRuleId=i.lastEditRuleId;break;case r.ACTION.SET_EDITOR_STATUS:n.editorIsShow=!!i.editorIsShow;break;case r.ACTION.SET_MANAGE_STATUS:n.manageIsShow=!!i.manageIsShow;break;case r.ACTION.SWITCH_EDITOR_MANAGE:n.editorIsShow=!e.editorIsShow,n.manageIsShow=!e.manageIsShow;break;case r.ACTION.SET_RANGE:n.editing.ranges=i.ranges;break;case r.ACTION.SET_CONDITION_TYPE:n.editing.condition.conditionType=i.type;break;case r.ACTION.SET_INPUTONE_STATUS:n.editing.condition.inputOneShow=i.show;break;case r.ACTION.SET_INPUTTWO_STATUS:n.editing.condition.inputTwoShow=i.show;break;case r.ACTION.SET_INPUTONE_VALUE:n.editing.condition.inputOne=i.value;break;case r.ACTION.SET_INPUTTWO_VALUE:n.editing.condition.inputTwo=i.value;break;case r.ACTION.RESET_EDITOR:n.editing=s();break;case r.ACTION.SET_EDITOR:n.editing=u(i);break;case r.ACTION.SET_PAINT_COLOR:n.editing.format.paintColor=i.paintColor}return n};var r=n(1744),l=n(1703);var s=function(){return{ruleId:"",ranges:"",condition:{conditionType:l.COND_TYPE.NUMBER_GREATER,inputOne:"",inputTwo:"",inputOneShow:!0,inputTwoShow:!1},format:{paintColor:l.PAINT_COLOR[0]}}},u=function(e){return e},c=function(){return{editorIsShow:!1,manageIsShow:!1,editing:s(),rulesNumber:0,lastEditRuleId:""}},d=c()},1832:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(3)),i=v(n(0)),o=v(n(1)),r=v(n(4)),l=v(n(5)),s=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46)),u=n(1703),c=v(n(7)),d=n(1677),p=n(1710),f=n(1726),h=n(82),m=v(n(1725));function v(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,i.default)(this,t);var n=(0,r.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.handleSelectionChange=function(){n.props.setLastEditRuleId(""),n.updateRulesList()},n.handleDataChange=function(){var e=m.default.getState();e.lastEditRuleId&&(n.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleWithIndexById(e.lastEditRuleId)||n.props.setLastEditRuleId(""));n.updateRulesList()},n.updateRulesList=function(){var e=(0,f.getAllRulesWithSelectionForUI)(n.app);e.sort(function(e,t){return e.ruleIndex-t.ruleIndex});var t=m.default.getState();if(t.lastEditRuleId){var a=n.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleWithIndexById(t.lastEditRuleId);if(a){var i=n.app.view.getSelection().rangeSelections[0];if(!a.rule.ruleRanges.some(function(e){return e.isCross(i)})){var o=(0,f.dataRule2UIRule)(a);o&&e.push(o),n.highLightRangesForAWhile(t.lastEditRuleId,2e3)}}}n.setState({ruleList:e})},n.handleMouseEnterForHover=function(e){n.hoverRuleId=e,n.highLightHoverRuleRanges()},n.handleMouseLeaveForHover=function(){n.hoverRuleId="",n.resetHighLight()},n.highLightHoverRuleRanges=function(){if(n.hoverRuleId){var e=(0,f.getRuleById)(n.app,n.hoverRuleId);e&&e.rule.ruleRanges.map(function(e){n.app.view.canvas.excel.highLightRangeOuterLineWithBorder({startRow:e.startRowIndex,endRow:e.endRowIndex,startCol:e.startColIndex,endCol:e.endColIndex})})}},n.app=e.app,n.state={ruleList:[]},n.hoverRuleId="",n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"componentDidUpdate",value:function(e,t){!e.isShow&&this.props.isShow?(this.updateRulesList(),c.default.event.view.listen(h.EVENT_NAME.SELECTION_CHANGE,this.handleSelectionChange),c.default.event.spreadsheetEvent.listen(h.EVENT_NAME.DATA_CHANGE,this.handleDataChange),this.app.view.canvas.excel.event.eventTable.listen("afterRender",this.highLightHoverRuleRanges)):e.isShow&&!this.props.isShow&&(c.default.event.view.remove(h.EVENT_NAME.SELECTION_CHANGE,this.handleSelectionChange),c.default.event.spreadsheetEvent.remove(h.EVENT_NAME.DATA_CHANGE,this.handleDataChange),this.app.view.canvas.excel.event.eventTable.remove("afterRender",this.highLightHoverRuleRanges))}},{key:"generageRuleSummary",value:function(e,t,n){return e===u.COND_TYPE.NUMBER_BETWEEN||e===u.COND_TYPE.NUMBER_NOT_BETWEEN?""+u.COND_TYPE_MAP.get(e)+t+"\u548c"+n:""+u.COND_TYPE_MAP.get(e)+t}},{key:"clickDeleteRule",value:function(e,t){var n=(0,f.getRuleIndexByRuleId)(this.app,t);-1!==n&&(this.app.plugins.conditionalFormat.deleteRule(n),e.preventDefault(),e.stopPropagation(),(0,f.condFormatReport)("rule_manage_panel_del"))}},{key:"clickEditRule",value:function(e,t){var n=(0,f.getRuleById)(this.app,t);if(n){var a=(0,f.dataRule2UIRule)(n);if(a){var i=a.ranges,o=a.booleanCondition,r=o.condition,l=(0,u.shouldElementShow)(r.conditionType);this.props.setEditor({ruleId:t,ranges:i,condition:{conditionType:r.conditionType,inputOne:r.inputOne,inputTwo:r.inputTwo,inputOneShow:l.inputOneShow,inputTwoShow:l.inputTwoShow},format:{paintColor:o.format.paintColor}}),this.props.switchEditorManage(),(0,f.condFormatReport)("rule_manage_panel_edit")}}}},{key:"highLightRangesForAWhile",value:function(e,t){var n=this;this.highLightRangesWithRuleId(e),setTimeout(function(){n.hoverRuleId="",n.resetHighLight()},t)}},{key:"highLightRangesWithRuleId",value:function(e){""===e?this.resetHighLight():(this.hoverRuleId=e,this.highLightHoverRuleRanges())}},{key:"resetHighLight",value:function(){this.app.view.canvas.excel.renderNextTick()}},{key:"renderRulesList",value:function(){var e=this,t=this.state.ruleList;return t.length<1?s.createElement("ul",{className:"conditional-format-rule-list"},s.createElement("li",{className:"conditional-format-rule-none"},"\u5f53\u524d\u672a\u8bbe\u7f6e\u4efb\u4f55\u683c\u5f0f\u89c4\u5219")):s.createElement("ul",{className:"conditional-format-rule-list"},t.map(function(n,a){var i=n.booleanCondition,o=n.ranges,r=i.condition,l=i.format,u=e.generageRuleSummary(r.conditionType,r.inputOne,r.inputTwo);return s.createElement(s.Fragment,{key:n.ruleId},s.createElement("li",{className:"conditional-format-one-rule",onClick:function(t){e.clickEditRule(t,n.ruleId)},onMouseEnter:function(){e.handleMouseEnterForHover(n.ruleId)},onMouseLeave:function(){e.handleMouseLeaveForHover()}},s.createElement("div",{className:"conditional-format-format-preview",style:{backgroundColor:"#"+l.paintColor}},s.createElement("span",{className:"conditional-format-format-font"},"\u6837\u5f0f")),s.createElement("div",{className:"conditional-format-rule-detail"},s.createElement("p",{className:"conditional-format-rule-summary"},u),s.createElement("p",{className:"conditional-format-rule-range"},o)),s.createElement("div",{className:"conditional-format-rule-delete"},s.createElement("button",{className:"conditional-format-delete-btn",onClick:function(t){e.clickDeleteRule(t,n.ruleId)}}))),a===t.length-1?null:s.createElement("li",{className:"conditional-format-split ml-20 wh-230"}))}))}},{key:"render",value:function(){return s.createElement("div",{className:"conditional-format-manage-body",hidden:!this.props.isShow},this.renderRulesList())}}]),t}(s.Component);t.default=(0,d.connect)(function(e){return{}},p.mapDispatchToProps)(g)},1833:function(e,t,n){var a=n(1834);"string"===typeof a&&(a=[[e.i,a,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,i);a.locals&&(e.exports=a.locals)},1834:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,"#conditional-format-panel {\n  height: 100%;\n  width: 100%;\n  background-color: #f8f8f8;\n  font-family: 'PingFang SC', 'Microsoft YaHei', '\u9ed1\u4f53', '\u5b8b\u4f53', sans-serif;\n  /* \u5934\u90e8\u6807\u9898\u548c\u5173\u95ed\u6309\u94ae */\n  /* \u89c4\u5219\u7f16\u8f91\u6a21\u5757 */\n  /* \u89c4\u5219\u7ba1\u7406\u6a21\u5757 */\n  /* \u5e95\u90e8\u6dfb\u52a0\u548c\u7ba1\u7406\u89c4\u5219\u6309\u94ae */\n  /* \u5206\u5272\u7ebf */\n}\n#conditional-format-panel .conditional-format-title {\n  height: 64px;\n  padding-left: 20px;\n  padding-right: 20px;\n}\n#conditional-format-panel .conditional-format-title p,\n#conditional-format-panel .conditional-format-title button {\n  display: inline-block;\n  line-height: 64px;\n  vertical-align: middle;\n}\n#conditional-format-panel .conditional-format-title p {\n  font-size: 14px;\n  font-weight: 500;\n  letter-spacing: 0.4px;\n  color: rgba(0, 0, 0, 0.56);\n}\n#conditional-format-panel .conditional-format-title button.conditional-format-close {\n  width: 16px;\n  height: 16px;\n  position: absolute;\n  top: 24px;\n  right: 20px;\n  border: none;\n  background-color: transparent;\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgIDxwYXRoIGZpbGw9IiM1QzVDNUMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTguNzU4IDhMMTQgMTMuMjQybC0uNzU4Ljc1OEw4IDguNzU4IDIuNzU4IDE0IDIgMTMuMjQyIDcuMjQyIDggNi4wMDYgNi43NjUgMiAyLjc1OCAyLjc1OCAyIDggNy4yNDIgMTMuMjQyIDJsLjc1OC43NTgtNC4wMDYgNC4wMDdMOC43NTggOHoiLz4KPC9zdmc+Cg==\");\n}\n#conditional-format-panel .conditional-format-title button.conditional-format-close:hover {\n  background-color: rgba(51, 51, 51, 0.1);\n  cursor: pointer;\n}\n#conditional-format-panel .conditional-format-body {\n  height: calc(100% - 65px);\n  overflow-x: hidden;\n}\n#conditional-format-panel .conditional-format-edit-body {\n  padding: 24px 20px 0px 20px;\n  /* \u7f16\u8f91\u5757 */\n  /* \u53d6\u6d88\u5b8c\u6210\u6309\u94ae */\n}\n#conditional-format-panel .conditional-format-edit-body.edit-body-switch-animation {\n  -webkit-animation: edit-body-switch-action 0.4s linear;\n          animation: edit-body-switch-action 0.4s linear;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block {\n  margin-bottom: 32px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block .conditional-format-edit-title {\n  font-size: 12px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.8);\n  margin-bottom: 16px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block .conditional-format-editing-line {\n  margin-bottom: 16px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block .conditional-format-editing-line .conditional-format-rule-tip {\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.64);\n  margin-bottom: 4px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block .conditional-format-editing-line .common-select {\n  width: 230px;\n  background-color: white;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-block .conditional-format-inline-input > div {\n  display: inline-block;\n  line-height: 34px;\n  vertical-align: middle;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-buttons {\n  float: right;\n  display: flex;\n  margin-bottom: 23px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-buttons .common-button {\n  height: 28px;\n  width: 70px;\n  padding: 0;\n  font-size: 14px;\n}\n#conditional-format-panel .conditional-format-edit-body .conditional-format-edit-buttons .ml-20 {\n  margin-left: 20px;\n}\n#conditional-format-panel .conditional-format-manage-body {\n  padding: 8px 0px;\n  max-height: calc(100% - 94px);\n  overflow-y: auto;\n  overflow-x: hidden;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule {\n  padding: 16px 20px;\n  width: 100%;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule:hover {\n  background-color: rgba(0, 0, 0, 0.04);\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule:hover .conditional-format-rule-delete {\n  display: inline-block;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule > div {\n  display: inline-block;\n  line-height: 58px;\n  vertical-align: middle;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-format-preview {\n  width: 50px;\n  height: 58px;\n  border-radius: 2px;\n  background-color: #ffbfbf;\n  text-align: center;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-format-preview span {\n  vertical-align: middle;\n  line-height: 58px;\n  font-size: 14px;\n  color: #000000;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-detail {\n  margin-left: 8px;\n  width: 155px;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-detail .conditional-format-rule-summary {\n  font-size: 12px;\n  font-weight: 500;\n  line-height: 1.33;\n  color: rgba(0, 0, 0, 0.8);\n  text-overflow: ellipsis;\n  white-space: nowrap;\n  overflow: hidden;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-detail .conditional-format-rule-range {\n  margin-top: 8px;\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.4);\n  line-height: 1;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-delete {\n  display: none;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-delete .conditional-format-delete-btn {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIxNiIgaGVpZ2h0PSIxNiIgdmlld0JveD0iMCAwIDE2IDE2Ij4KICAgIDxwYXRoIGZpbGw9IiM1QzVDNUMiIGZpbGwtcnVsZT0iZXZlbm9kZCIgZD0iTTMgNC41SDJWM2g0bDEtMmgybDEgMmg0djEuNWgtMXYxMC41NjZIM1Y0LjV6bTEuNSAwdjkuMDY2aDdWNC41aC03em0xLjUzMSA2LjQ0NVY4aC45Mzh2Mi45NDVINi4wM3ptMyAuMDU1VjguMDU1aC45MzhWMTFIOS4wM3oiLz4KPC9zdmc+Cg==\");\n  background-color: transparent;\n  background-size: 16px 16px;\n  border: none;\n  width: 20px;\n  height: 20px;\n  background-repeat: no-repeat;\n  background-position: center center;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-one-rule .conditional-format-rule-delete .conditional-format-delete-btn:hover {\n  border-radius: 1px;\n  background-color: rgba(0, 0, 0, 0.08);\n  cursor: pointer;\n}\n#conditional-format-panel .conditional-format-manage-body .conditional-format-rule-list .conditional-format-rule-none {\n  padding: 16px 20px;\n  width: 100%;\n  font-size: 12px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.4);\n}\n#conditional-format-panel .conditional-format-foot {\n  padding: 20px 20px 0px 20px;\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-foot-btn,\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-add,\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-manage {\n  display: inline-block;\n  line-height: 32px;\n  vertical-align: middle;\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-add,\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-manage {\n  width: 22px;\n  height: 22px;\n  border: none;\n  background-color: transparent;\n  position: absolute;\n  top: 4px;\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-add {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICAgIDxwYXRoIGZpbGw9IiM1QzVDNUMiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTExIDE5YTggOCAwIDEgMSAwLTE2IDggOCAwIDAgMSAwIDE2em0wLTEuMjVhNi43NSA2Ljc1IDAgMSAwIDAtMTMuNSA2Ljc1IDYuNzUgMCAwIDAgMCAxMy41em0tLjY1LTcuNFY3aDEuM3YzLjM1SDE1djEuM2gtMy4zNVYxNWgtMS4zdi0zLjM1SDd2LTEuM2gzLjM1eiIvPgo8L3N2Zz4K\");\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-manage {\n  background-image: url(\"data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMiIgaGVpZ2h0PSIyMiIgdmlld0JveD0iMCAwIDIyIDIyIj4KICAgIDxwYXRoIGZpbGw9IiM1QzVDNUMiIGZpbGwtcnVsZT0ibm9uemVybyIgZD0iTTExIDE5LjcxMUw0LjYzOSAxNi4wNGExIDEgMCAwIDEtLjUtLjg2NlY3LjgyN2ExIDEgMCAwIDEgLjUtLjg2NkwxMSAzLjI5YTEgMSAwIDAgMSAxIDBsNi4zNjEgMy42NzJhMSAxIDAgMCAxIC41Ljg2NnY3LjM0NmExIDEgMCAwIDEtLjUuODY2TDEyIDE5LjcxYTEgMSAwIDAgMS0xIDB6TTE3LjU2MSAxNVY4LjAwMUwxMS41IDQuNWwtNi4wNjEgMy41djYuOTk4bDYuMDYxIDMuNSA2LjA2MS0zLjV6TTExLjUgMTQuNjVhMy4xNSAzLjE1IDAgMSAxIDAtNi4zIDMuMTUgMy4xNSAwIDAgMSAwIDYuM3ptMC0xLjNhMS44NSAxLjg1IDAgMSAwIDAtMy43IDEuODUgMS44NSAwIDAgMCAwIDMuN3oiLz4KPC9zdmc+Cg==\");\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-foot-btn {\n  height: 32px;\n  width: 230px;\n  line-height: 32px;\n  cursor: pointer;\n  position: relative;\n  margin-bottom: 22px;\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-foot-btn:hover {\n  background-color: rgba(0, 0, 0, 0.04);\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-foot-btn span {\n  margin-left: 26px;\n  font-size: 12px;\n  font-weight: 500;\n  color: rgba(0, 0, 0, 0.8);\n  position: absolute;\n}\n#conditional-format-panel .conditional-format-foot .conditional-format-foot-line .conditional-format-foot-btn .conditional-format-rules-number {\n  margin-left: 4px;\n  font-size: 12px;\n  color: rgba(0, 0, 0, 0.4);\n}\n#conditional-format-panel .conditional-format-split {\n  height: 1px;\n  width: 100%;\n  background-color: rgba(0, 0, 0, 0.06);\n}\n@media (-webkit-min-device-pixel-ratio: 1.5), (min-device-pixel-ratio: 1.5) {\n  #conditional-format-panel .conditional-format-split {\n    -webkit-transform: scaleY(0.7);\n            transform: scaleY(0.7);\n  }\n}\n@media (-webkit-min-device-pixel-ratio: 2), (min-device-pixel-ratio: 2) {\n  #conditional-format-panel .conditional-format-split {\n    -webkit-transform: scaleY(0.5);\n            transform: scaleY(0.5);\n  }\n}\n#conditional-format-panel .clear-float {\n  clear: both;\n}\n#conditional-format-panel .mb-8 {\n  margin-bottom: 8px;\n}\n#conditional-format-panel .ml-8 {\n  margin-left: 8px;\n}\n#conditional-format-panel .mr-8 {\n  margin-right: 8px;\n}\n#conditional-format-panel .wh-99 {\n  width: 99px;\n}\n#conditional-format-panel .ht-34 {\n  height: 34px;\n}\n#conditional-format-panel .wh-230 {\n  width: 230px;\n}\n#conditional-format-panel .ml-20 {\n  margin-left: 20px;\n}\n@-webkit-keyframes edit-body-switch-action {\n  0% {\n    opacity: 0.8;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  40% {\n    opacity: 0.1;\n  }\n  45% {\n    opacity: 0.1;\n  }\n  60% {\n    opacity: 0.5;\n  }\n  80% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n@keyframes edit-body-switch-action {\n  0% {\n    opacity: 0.8;\n  }\n  20% {\n    opacity: 0.5;\n  }\n  40% {\n    opacity: 0.1;\n  }\n  45% {\n    opacity: 0.1;\n  }\n  60% {\n    opacity: 0.5;\n  }\n  80% {\n    opacity: 0.8;\n  }\n  100% {\n    opacity: 1;\n  }\n}\n",""])}}]);
//# sourceMappingURL=bundle_panel_pc-fbf4e77f5b.js.map