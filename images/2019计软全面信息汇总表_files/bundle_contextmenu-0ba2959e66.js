(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_contextmenu"],{1757:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.judgeForCopy=function(e){var t=e.plugins.copyPaste.copyPasteCache,a=e.view.canvas,n=o.default.copyPaste.CopyType,i=!a.excel.selectData.select.selectCol&&!a.excel.selectData.select.selectRow,l=t.getCacheData(),c=t.getCacheState(),s=c.valid,d=s&&c.pasteType==n.cut,r=l&&c.select&&c.select.selectRow,u=l&&c.select&&c.select.selectCol,m=!r&&!u&&!(l&&1==l.isSingle&&0==l.isMerge),p=!!a.excel.selectData.pickShape;return{canPaste:s,inValid:i,isCut:d,notSingle:m,cacheState:c,isSelectPic:p}},t.getInsertAmount=function(e,t){var a=t===i.default.Dimension.DIMENSION_TYPE.ROWS?"y":"x",n=e.view.canvas.excel.selectData.select,o=1,l=void 0,c=void 0,s=void 0,d=e.view.canvas.excel.tableData;n&&(l=n[a+"Range"][0],c=n[a+"Range"][1],o=c-l+1);if(t===i.default.Dimension.DIMENSION_TYPE.ROWS)for(s=l;s<=c;s++)(d.hideRowMap[s]||d.filterHideRowMap[s])&&o--;else for(s=l;s<=c;s++)d.hideColMap[s]&&o--;return o},t.getDefaultValue=function(e,t,a,n){var i=void 0,o=void 0,l=void 0;"width"===n?i=e.view.canvas.excel.tableData.col.getWidth:"height"===n&&(i=e.view.canvas.excel.tableData.row.getHeight);if(!i)return"";for(o=i(t,{ignoreScale:!0}),l=t;l<=a;l++)if(o!==i(l,{ignoreScale:!0}))return"";return o},t.canEnterDragFill=function(e){for(var t=e.view.canvas.excel,a=t.selectData,n=a.select,i=n.selectCol,o=n.selectRow,l=n.selectAll,c=a.select,s=c.xRange,d=c.yRange,r=!1,u=d[0];u<=d[1];u++){for(var m=s[0];m<=s[1];m++){var p=t.tableData.getCellDataAtPosition(u,m);if((!p||!p.merged)&&(p&&"string"===typeof p.text&&p.text.length)){r=!0;break}}if(r)break}if(i||o||l)return!1;if(t.selectionCenter.onSmartSelection)return!1;if(!r)return!1;return!0},t.doCopyM=function(e,t,a){o.default.copyPaste.syncMobileClipboard(function(){e.plugins.copyPaste.doCopy({copyType:t,previewActiveSheetId:a})})},t.doPasteM=function(e){var t=o.default.copyPaste.wxCopyPasteHacker;0;o.default.copyPaste.syncMobileClipboard(function(a){var i={},l=0,c=e.plugins.copyPaste,s=c.copyPasteCache.getCacheState().clipboardCopyData;parseInt(s.timeStamp)>l&&(l=parseInt(s.timeStamp),i=s);var d=o.default.copyPaste.getCopyPlainCache();if(parseInt(d.timeStamp)>l){l=parseInt(d.timeStamp),i=d;try{n.default.report.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"mob_picture_menu_paste"})}catch(u){}}if(a.timeStamp>l&&(l=a.timeStamp,i=a),t.isCopyInEnv()){var r=t.getServerCopyData();r.timeStamp>l&&r.plain!==i.plain&&(i=r)}e.plugins.copyPaste.doClipboardPaste({html:i.html||"",plain:i.plain||""})})},t.pasteAllRowColM=function(e,t,a,n){var i=e.plugins.copyPaste,l=i.copyPasteCache,c=o.default.copyPaste.handleCutDimension,s=o.default.copyPaste.handleCopyDimension,d=o.default.copyPaste.CopyType,r=e.spreadsheet.activeSheet.getSheetId(),u=l.getCacheState(),m=u.valid,p=l.getCacheData(),v=m&&u.pasteType==d.cut,f=u.sheetId,h=e.view.canvas.excel.selectData.select;if(v){var g=c({cacheState:u,currentSelect:h,pasteData:p,cutDataSheetId:f,activeSheetId:r,dimensionType:t,isSingle:!1}),C=g.pasteData,w=g.range;i.doPaste({pasteData:C,selectAreaCellRange:w});try{n&&n()}catch(I){}}else{var y=s({cacheState:u,currentSelect:h,pasteData:p,activeSheetId:r,dimensionType:t}),_=y.pasteData,x=y.range;i.doPaste({pasteData:_,selectAreaCellRange:x});try{a&&a()}catch(I){}}};var n=l(a(81)),i=l(a(89)),o=l(a(761));function l(e){return e&&e.__esModule?e:{default:e}}},1932:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=c(a(14)),i=c(a(0)),o=c(a(1)),l=c(a(81));function c(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,i.default)(this,e),this.app=t,this.itemLists={}}return(0,o.default)(e,[{key:"initDefault",value:function(e){}},{key:"init",value:function(){this.initDefault(this.app),this.generateConfig(),this.app.view.canvas.excel.setMenuConfig(this.config)}},{key:"generateConfig",value:function(){var e=this;for(var t in this.config)this.config.hasOwnProperty(t)&&function(){var a=e.config[t];a.forEach(function(t,i){l.default.util.type.isString(t)?a[i]=e.getItem(t):l.default.util.type.isObject(t)?a[i]=(0,n.default)(e.getItem(t.name),t):console.warn("\u53f3\u952e\u83dc\u5355\u914d\u7f6e\u9879\u53ea\u652f\u6301string\u6216\u8005object\u7c7b\u578b!",t)})}()}},{key:"setConfig",value:function(e){this.config=e,this.generateConfig(),this.app.view.canvas.excel.setMenuConfig(this.config)}},{key:"addItem",value:function(e,t){this.itemLists[e.name]&&console.warn("\u4f60\u6b63\u5728\u5c1d\u8bd5\u589e\u52a0\u5df2\u7ecf\u5b58\u5728\u7684\u53f3\u952e\u83dc\u5355\u9879\uff01",e.name),this.itemLists[e.name]=e,t&&(this.generateConfig(),this.app.view.canvas.excel.setMenuConfig(this.config))}},{key:"getItem",value:function(e){return this.itemLists[e]||console.warn("\u4f60\u6b63\u5728\u5c1d\u8bd5\u83b7\u53d6\u4e0d\u5b58\u5728\u7684\u53f3\u952e\u83dc\u5355\u9879\uff01",e),this.itemLists[e]||{}}}]),e}();t.default=s},1933:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.pcConfig={read:{all:["copy"],image:["imgCopy","imgView"]},edit:{all:["cut","copy","paste","copyLine","copyCutLine","line","insertRowAbove","insertRowUnder","hideRow","showRow","rowResize","removeRow","line","insertColLeft","insertColRight","hideCol","showCol","columnResize","removeCol","line","smartSplit","line","mergeCell","line","insertImage","insertLink","insertComment","line","cleanStyles","cleanContents","line","dataValidation","setFormat"],image:["imgCut","imgCopy","imgTrim","imgView","imgClear"]}},t.mobileConfig={read:{normal:["copy"],cell:["copy"],row:["copy"],col:["copy"],all:["copy"],image:["imgCopy","imgView"]},edit:{normal:["cut","copy","paste","clear"],cell:["cut","copy","paste","edit","fill","clear","cellOperation","comment"],row:["cut","copy","paste","pasteAllRow","showRow","clear","removeRow","rowOperation"],col:["cut","copy","paste","pasteAllCol","showCol","clear","removeCol","colOperation"],image:["imgCut","imgCopy","imgTrim","imgView","imgClear"],all:["cut","copy","paste","clear","styleOperation"]}}},1934:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyItem=function(e){return{name:"copy",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u590d\u5236",init:function(e){e.className=this.validClass,e.innerText=this.wording},callback:function(){var t=void 0,a=[{module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_copy"}];if(window.isRecordPreviewShowing){var n=e.preview.previewsheet.getActiveSheetId();t={copyType:l.default.copyPaste.CopyType.copy,previewActiveSheetId:n},a.push({opername:"doc_excel",module:"revise",action:"upv"})}else t={copyType:l.default.copyPaste.CopyType.copy};e.plugins.copyPaste.doCopy(t);try{for(var o in a)Object.prototype.hasOwnProperty.call(a,o)&&i.default.report.tdwReport(a[o])}catch(c){}},short:{pad:"c"}}},t.getCutItem=function(e){return{name:"cut",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u526a\u5207",init:function(e){e.className=this.validClass,e.innerText=this.wording},callback:function(){e.plugins.copyPaste.doCopy({copyType:l.default.copyPaste.CopyType.cut});try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_cut"})}catch(t){}},short:{pad:"x"}}},t.getPasteItem=function(e){return{name:"paste",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u7c98\u8d34",init:function(t){var a=l.default.copyPaste.CANPASTETYPE,n=l.default.copyPaste.wxCopyPasteHacker,i=(l.default.copyPaste.getCopyPlainCache,l.default.copyPaste.hasMobileClipboardContent,e.plugins.copyPaste.getPasteType()!==a.NONE),o=n.isCopyInEnv()&&n.isCopyDataAvailable();t.className=i||o?this.validClass:this.invalidClass,t.innerText=this.wording;e.view.canvas.excel.selectData.pickShape},callback:function(){o.default.Api.doPaste(e);try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_parse"})}catch(t){}},short:{pad:"v"}}},t.getCopyLineItem=function(e){return{name:"copyLine",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u63d2\u5165\u590d\u5236\u7684\u5355\u5143\u683c",init:function(t){var a=(0,n.judgeForCopy)(e),i=a.canPaste,o=a.inValid,l=a.isCut,c=a.notSingle,s=a.cacheState;a.isSelectPic;t.className=i?this.validClass:this.invalidClass,(!i||o||l||c||s.hasDonePaste)&&(t.style.display="none"),t.innerText=this.wording},callback:function(){var t=e.plugins.copyPaste,a=t.copyPasteCache,n=e.view.canvas,o=e.spreadsheet.activeSheet,d=o.getSheetId(),r=a.getCacheData(),u=a.getCacheState(),m=n.excel.selectData.select,p=u.select,v=l.default.copyPaste.handleCopyDimension,f=l.default.copyPaste.CopyHTMLType,h=c.default.Dimension.DIMENSION_TYPE;if(n.excel.selectData.select.selectRow){if(p.selectCol)return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");var g=v({cacheState:u,currentSelect:m,pasteData:r,activeSheetId:d,dimensionType:h.ROWS}),C=g.pasteData,w=g.range;t.doImageTextPaste({type:f.table,pasteData:C,selectAreaCellRange:w,pasteHtmlString:a.getCacheState().clipboardCopyData.html});try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_copy_row"})}catch(I){}}else if(n.excel.selectData.select.selectCol){if(p.selectRow)return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");var y=v({cacheState:u,currentSelect:m,pasteData:r,activeSheetId:d,dimensionType:h.COLUMNS}),_=y.pasteData,x=y.range;t.doImageTextPaste({type:f.table,pasteData:_,selectAreaCellRange:x,pasteHtmlString:a.getCacheState().clipboardCopyData.html});try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_copy_col"})}catch(I){}}},short:{pad:"a"}}},t.getCutLineItem=function(e){return{name:"copyCutLine",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u63d2\u5165\u526a\u5207\u7684\u5355\u5143\u683c",init:function(t){var a=(0,n.judgeForCopy)(e),i=a.canPaste,o=a.inValid,l=a.isCut,c=a.notSingle,s=a.cacheState;a.isSelectPic;t.className=i?this.validClass:this.invalidClass,(!i||o||!l||c||s.hasDonePaste)&&(t.style.display="none"),t.innerText=this.wording},callback:function(){var t=l.default.copyPaste.CopyType,a=e.plugins.copyPaste,n=a.copyPasteCache,o=e.view.canvas,d=e.spreadsheet.activeSheet,r=d.getSheetId(),u=n.getCacheState(),m=u.valid,p=n.getCacheData(),v=m&&u.pasteType==t.cut,f=u.sheetId,h=o.excel.selectData.select,g=l.default.copyPaste.handleCutDimension,C=l.default.copyPaste.CopyHTMLType,w=c.default.Dimension.DIMENSION_TYPE;if(p&&1==p.isSingle&&0==p.isMerge){if(h.selectRow&&v&&f){var y=g({cacheState:u,currentSelect:h,pasteData:p,cutDataSheetId:f,activeSheetId:r,dimensionType:w.ROWS,isSingle:!0}),_=y.pasteData,x=y.range;a.doImageTextPaste({type:C.table,pasteData:_,selectAreaCellRange:x,pasteHtmlString:n.getCacheState().clipboardCopyData.html});try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_cut_row"})}catch(E){}}else if(h.selectCol&&v&&f){var I=g({cacheState:u,currentSelect:h,pasteData:p,cutDataSheetId:f,activeSheetId:r,dimensionType:w.COLUMNS,isSingle:!0}),R=I.pasteData,S=I.range;a.doImageTextPaste({type:C.table,pasteData:R,selectAreaCellRange:S,pasteHtmlString:n.getCacheState().clipboardCopyData.html});try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_insert_cut_col"})}catch(E){}}}else if(p&&u.select.selectRow&&h.selectRow){if(h.yRange[0]>u.from.yRange[0]&&h.yRange[0]<=u.from.yRange[1])return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");if(h.selectCol)return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");if(h.selectRow&&v&&f){var D=g({cacheState:u,currentSelect:h,pasteData:p,cutDataSheetId:f,activeSheetId:r,dimensionType:w.ROWS,isSingle:!1}),b=D.pasteData,P=D.range;a.doImageTextPaste({type:C.table,pasteData:b,selectAreaCellRange:P,pasteHtmlString:n.getCacheState().clipboardCopyData.html})}}else{if(!(p&&u.select.selectCol&&h.selectCol))return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");if(h.xRange[0]>u.from.xRange[0]&&h.xRange[0]<=u.from.xRange[1])return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");if(h.selectRow)return void s.default.dialog.showDialog1("\u63d0\u793a","\u65e0\u6cd5\u7c98\u8d34\uff0c\u56e0\u4e3a\u590d\u5236\u533a\u57df\u4e0e\u7c98\u8d34\u533a\u57df\u5927\u5c0f\u4e0d\u4e00\u81f4\u3002");if(h.selectCol&&v&&f){var T=g({cacheState:u,currentSelect:h,pasteData:p,cutDataSheetId:f,activeSheetId:r,dimensionType:w.COLUMNS,isSingle:!1}),N=T.pasteData,k=T.range;a.doImageTextPaste({type:C.table,pasteData:N,selectAreaCellRange:k,pasteHtmlString:n.getCacheState().clipboardCopyData.html})}}},short:{pad:"b"}}};var n=a(1757),i=d(a(81)),o=d(a(307)),l=d(a(761)),c=d(a(89)),s=d(a(198));function d(e){return e&&e.__esModule?e:{default:e}}},1935:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMergeCellItem=function(e){return{name:"mergeCell",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component hidden",wording:["\u5408\u5e76\u5355\u5143\u683c","\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c"],init:function(t){var a=void 0,n=void 0,i=o.default.selection.hasMergeCell(e);o.default.selection.singleRange(e)&&!i||e.view.canvas.excel.selectData.select.selectAll?(a=!1,n=this.wording[0]):i?(a=!0,n=this.wording[1]):(a=!0,n=this.wording[0]),t.className=a?this.validClass:this.invalidClass,t.innerText=n},callback:function(){var t=o.default.selection.hasMergeCell(e);if(t){l.default.Api.unmergeCells();try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_unmerge"})}catch(a){}}else{l.default.Api.mergeCells();try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_merge"})}catch(a){}}},short:{pad:"n"}}},t.getInsertImageItem=function(e){return{name:"insertImage",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component hidden",wording:"\u63d2\u5165\u56fe\u7247",init:function(t){void 0===e.socket||void 0===e.socket.client||"RECONNECTING_In_CLOSED"===e.socket.client.getRoomState()?t.className=this.invalidClass:t.className=this.validClass,t.innerText=this.wording},callback:function(){l.default.Api.insertImage()},short:{pad:"o"}}},t.getInsertLinkItem=function(e){return{name:"insertLink",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component hidden",wording:"\u63d2\u5165\u94fe\u63a5",init:function(t){t.className=o.default.selection.singleRange(e)?this.validClass:this.invalidClass,t.innerText=this.wording},callback:function(){l.default.Api.insertLink(),i.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"clk_menu_insert_url"})},short:{pad:"p"}}},t.getInsertCommentItem=function(e){return{name:"insertComment",validClass:"component-vaild menu-component menu-component-comment",hideClass:"component-hide menu-component",invalidClass:"component-invaild menu-component hidden",wording:"\u6dfb\u52a0\u6279\u6ce8",init:function(t){t.className=o.default.selection.singleRange(e)?this.validClass:this.invalidClass,t.innerText=this.wording},callback:function(){var t=e.view.canvas.plugins.cardCenter;t&&t.addComment(),i.default.report.tdwReport({module:"excel_comment",opername:"doc_cooper",action:"cli_add"})}}},t.getCleanStylesItem=function(e){return{name:"cleanStyles",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u6e05\u9664\u683c\u5f0f"},callback:function(){l.default.Api.clearFormat();try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearformat"})}catch(e){}},short:{pad:"f"}}},t.getCleanContentsItem=function(e){return{name:"cleanContents",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u6e05\u9664\u5185\u5bb9"},callback:function(){l.default.Api.clearContent(),e.event.view.trigger(i.default.EVENT_NAME.INPUT_END);try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_clearcontent"})}catch(t){}},short:{pad:"s"}}},t.getDataValidationItem=function(e){return{name:"dataValidation",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(t){t.className=this.validClass;var a=e.view.getSelection().activeCell,n=a.rowIndex,i=a.colIndex;if(c.default.dataValidation.getUIDVAtPosition(n,i)){var o=document.createTextNode("\u6570\u636e\u9a8c\u8bc1"),l=document.createElement("div"),s=document.createTextNode("\u5df2\u5f00\u542f");l.className="component-status",l.appendChild(s),t.appendChild(o),t.appendChild(l)}else t.innerText="\u6570\u636e\u9a8c\u8bc1"},callback:function(){var e=n.default.window.SpreadsheetApp;e.view.plugins.dataValidationPanel.create()}}},t.getSetFormatItem=function(e){return{name:"setFormat",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u8bbe\u7f6e\u5355\u5143\u683c\u683c\u5f0f"},callback:function(){e.view.plugins.customFormatPanel.show();try{i.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_menu_formatpanel"})}catch(t){}},short:{pad:"t"}}};var n=s(a(7)),i=s(a(81)),o=s(a(311)),l=s(a(307)),c=s(a(761));function s(e){return e&&e.__esModule?e:{default:e}}},1936:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=p(a(9)),i=p(a(204));t.getInsertRowAboveItem=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Above",a=new l.default;return{name:"insertRow"+t,validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(n){var i=d.default.Dimension.DIMENSION_TYPE,o=!e.view.canvas.excel.selectData.select.selectCol;if(n.className=o?this.validClass:this.invalidClass,o){var l="\u5728\u4e0a\u65b9\u63d2\u5165";"Under"===t&&(l="\u5728\u4e0b\u65b9\u63d2\u5165");var s=document.createTextNode(l);a.setValue(""+(0,c.getInsertAmount)(e,i.ROWS));var r=document.createElement("div"),u=document.createTextNode("\u884c");r.style.float="right",r.appendChild(a.dom),r.appendChild(u),n.appendChild(s),n.appendChild(r)}else n.style.display="none"},callback:function(){var n=e.Model.Dimension.DIMENSION_TYPE,i=Number(a.getValue()),l=e.spreadsheet.activeSheet.getRowCount(),s=e.spreadsheet.activeSheet.getColCount(),p=e.view.canvas.excel.selectData.select.yRange[0],f=e.view.canvas.excel.selectData.select.yRange[1],h=e.view.canvas.excel.selectData.select.selectRow,g=e.spreadsheet.activeSheet,C=g.data,w=C.rowMetadata,y=0,_=void 0;for(_=p;_<p+i;_++)if(void 0===w[_]||null===w[_])y++;else{if(w[_]&&(!0===w[_].hiddenByFilter||!0===w[_].hiddenByUser))continue;y++}if((l+y)*s<d.default.config.MAX_CELL_COUNT){if(y<=0)return;"Under"===t&&(p+=(0,c.getInsertAmount)(e,n.ROWS)),r.default.Api.insertRows([{index:p,amount:y}]),"Under"===t&&p+y>=e.view.canvas.excel.tableData.row.length-y&&e.view.canvas.excel.tableScroll({areaY:o.default.constant.TABLE_AREA.FLOW,diffY:e.view.canvas.excel.areaData.row.flow.offsetY-e.view.canvas.excel.areaData.row.flow.maxOffsetY})}else u.default.dialog.dialog.confirm("\u63d2\u5165\u884c\u5217\u5931\u8d25","\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",function(){},function(){return v.getPadMultiSheetController&&v.getPadMultiSheetController().addNewSheet(),!0});try{if(h&&f-p===0){var x=y>1?"more":"one";m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+x+"_row"})}else h&&f-p>0?m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_row"}):m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_row"});i!==f-p+1&&m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_col"})}catch(I){}},short:{pad:"d"}}},t.getInsertColLeftItem=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Left",a=new l.default;return{name:"insertCol"+t,validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",init:function(n){var i=d.default.Dimension.DIMENSION_TYPE,o=!e.view.canvas.excel.selectData.select.selectRow;if(n.className=o?this.validClass:this.invalidClass,o){var l="\u5728\u5de6\u4fa7\u63d2\u5165";"Right"===t&&(l="\u5728\u53f3\u4fa7\u63d2\u5165");var s=document.createTextNode(l);a.setValue(""+(0,c.getInsertAmount)(e,i.COLUMNS));var r=document.createElement("div"),u=document.createTextNode("\u5217");r.style.float="right",r.appendChild(a.dom),r.appendChild(u),n.appendChild(s),n.appendChild(r)}else n.style.display="none"},callback:function(){var n=e.Model.Dimension.DIMENSION_TYPE,i=Number(a.getValue()),l=e.spreadsheet.activeSheet.getRowCount(),s=e.spreadsheet.activeSheet.getColCount(),p=e.view.canvas.excel.selectData.select.xRange[0],f=e.view.canvas.excel.selectData.select.xRange[0],h=e.view.canvas.excel.selectData.select.selectCol,g=e.spreadsheet.activeSheet,C=g.data,w=C.columnMetadata,y=0,_=void 0;for(_=p;_<p+i;_++)if(void 0===w[_]||null===w[_])y++;else{if(w[_]&&(!0===w[_].hiddenByFilter||!0===w[_].hiddenByUser))continue;y++}if(l*(s+y)<=d.default.config.MAX_CELL_COUNT){if(y<=0)return;"Right"===t&&(p+=(0,c.getInsertAmount)(e,n.COLUMNS)),r.default.Api.insertColumns([{index:p,amount:y}]),"Right"===t&&p+y>=e.view.canvas.excel.tableData.col.length-y&&e.view.canvas.excel.tableScroll({areaX:o.default.constant.TABLE_AREA.FLOW,diffX:e.view.canvas.excel.areaData.col.flow.offsetX-e.view.canvas.excel.areaData.col.flow.maxOffsetX})}else u.default.dialog.dialog.confirm("\u63d2\u5165\u884c\u5217\u5931\u8d25","\u5df2\u8fbe\u6700\u5927\u884c\u5217\u9650\u5236\uff0c\u662f\u5426\u4e3a\u4f60\u65b0\u5efa\u4e00\u4e2a\u5de5\u4f5c\u8868\uff1f",function(){},function(){return v.getPadMultiSheetController&&v.getPadMultiSheetController().addNewSheet(),!0});try{if(h&&f-p===0){var x=y>1?"more":"one";m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"insert_"+x+"_col"})}else h&&f-p>0?m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_insert_more_col"}):m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"select_cell_insert_col"});i!==f-p+1&&m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"type_insert_row"})}catch(I){}},short:{pad:"e"}}},t.getHideRowItem=function(e){return{name:"hideRow",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u9690\u85cf\u884c",init:function(t){var a=e.view.canvas.excel.selectData.select,o=e.view.canvas.excel.tableData,l=a.selectRow,c=!a.selectAllRow,s=new i.default,d=o.hideRowMap;(0,n.default)(d).forEach(function(e){s.add(parseInt(e))});for(var r=a.yRange,u=r[0];u<=r[1];u++)s.add(u);var m=o.row.length;s.size===m&&(c=!1),t.className=c?this.validClass:this.invalidClass,l?t.innerText=this.wording:t.style.display="none"},callback:function(){var t=d.default.Dimension.DIMENSION_TYPE,a=d.default.Range.DimensionRange,n=e.view.canvas.excel.selectData.select,i=e.spreadsheet.activeSheet.getSheetId(),o=new a(i,n.yRange[0],n.yRange[1],t.ROWS);r.default.Api.hideRows([o])},short:{pad:"f"}}},t.getShowRowItem=function(e){return{name:"showRow",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u53d6\u6d88\u9690\u85cf\u884c",init:function(t){var a=e.view.canvas.excel.selectData.select,n=e.view.canvas.excel.tableData.hideRowMap,i=a.selectRow,o=a.yRange[0],l=a.yRange[1],c=!1,s=void 0;for(s in n)+s>=o&&+s<=l&&(c=!0);t.style.display="none",t.className=this.validClass,i&&c&&(t.style.display="block"),t.innerText=this.wording},callback:function(){r.default.Api.showRows()},short:{pad:"g"}}},t.getHideColItem=function(e){return{name:"hideCol",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u9690\u85cf\u5217",init:function(t){var a=e.view.canvas.excel.selectData.select,o=e.view.canvas.excel.tableData,l=a.selectCol,c=!a.selectAllCol,s=new i.default,d=o.hideColMap;(0,n.default)(d).forEach(function(e){s.add(parseInt(e))});for(var r=a.xRange,u=r[0];u<=r[1];u++)s.add(u);var m=o.col.length;s.size===m&&(c=!1),t.className=c?this.validClass:this.invalidClass,l?t.innerText=this.wording:t.style.display="none"},callback:function(){var t=d.default.Dimension.DIMENSION_TYPE,a=d.default.Range.DimensionRange,n=e.view.canvas.excel.selectData.select,i=e.spreadsheet.activeSheet.getSheetId(),o=new a(i,n.xRange[0],n.xRange[1],t.COLUMNS);r.default.Api.hideColumns([o])},short:{pad:"h"}}},t.getShowColItem=function(e){return{name:"showCol",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u53d6\u6d88\u9690\u85cf\u5217",init:function(t){var a=e.view.canvas.excel.selectData.select,n=e.view.canvas.excel.tableData.hideColMap,i=a.selectCol,o=a.xRange[0],l=a.xRange[1],c=!1,s=void 0;for(s in n)+s>=o&&+s<=l&&(c=!0);t.style.display="none",t.className=this.validClass,i&&c&&(t.style.display="block"),t.innerText=this.wording},callback:function(){r.default.Api.showColumns()},short:{pad:"i"}}},t.getSmartSplitItem=function(e){return{name:"smartSplit",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component",wording:"\u667a\u80fd\u5206\u5217",init:function(e){e.className=this.validClass,e.innerText=this.wording},callback:function(){e.plugins.smartSplit.isSupportSmartSplit()?e.plugins.smartSplit.doManualSmartSplit():(e.plugins.smartSplit.showSplitGuideDialog(),m.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"not_split"})),m.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"clk_menu"})}}},t.getRemoveRowItem=function(e){return{name:"removeRow",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component hidden",wording:"\u5220\u9664\u6240\u5728\u884c",init:function(t){var a=e.view.canvas.excel.selectData.select,n=!a.selectCol&&!a.selectAll;t.className=n?this.validClass:this.invalidClass,t.innerText=this.wording},callback:function(){r.default.Api.deleteRows();try{m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_del_row"})}catch(e){}},short:{pad:"j"}}},t.getRemoveColItem=function(e){return{name:"removeCol",validClass:"component-vaild menu-component",invalidClass:"component-invaild menu-component hidden",wording:"\u5220\u9664\u6240\u5728\u5217",init:function(t){var a=e.view.canvas.excel.selectData.select,n=!a.selectRow&&!a.selectAll;t.className=n?this.validClass:this.invalidClass,t.innerText=this.wording},callback:function(){r.default.Api.deleteColumns();try{m.default.report.tdwReport({module:"excel_menu",opername:"doc_excel_editor",action:"clk_del_col"})}catch(e){}},short:{pad:"k"}}},t.getRowResizeItem=function(e){return{name:"rowResize",validClass:"component-vaild menu-component",hideClass:"component-hide menu-component",invalidClass:"component-invaild menu-component",wording:"\u8bbe\u7f6e\u884c\u9ad8",init:function(t){var a=e.view.canvas.excel.selectData.select,n=a.xRange[1]-a.xRange[0]+1,i=n!==e.view.canvas.excel.tableData.col.widths.length;t.className=i?this.hideClass:this.validClass,t.innerText=this.wording},callback:function(){var t=d.default.Dimension.DIMENSION_TYPE,a=d.default.Range.DimensionRange,n=e.view.canvas.excel,i=n.selectData.select,o=(0,c.getDefaultValue)(e,i.yRange[0],i.yRange[1],"height");u.default.dialog.inputDialog({title:"\u8bbe\u7f6e\u884c\u9ad8",info:"\u884c\u9ad8 ( \u9ed8\u8ba4\u503c: "+n.configData.rowHeight+"\u50cf\u7d20 )",defaultValue:o,min:10,errorInfo:"\u6709\u6548\u8303\u56f4\uff1a10-1000",callback:function(n){var o={from:i.yRange[0],to:i.yRange[1]},l=void 0,c=e.spreadsheet.getActiveSheetId();((l=new a(c,o.from,o.to,t.ROWS)).startIndex<0||l.endIndex<0||isNaN(l.startIndex)||isNaN(l.endIndex))&&m.default.report.monitor(33665914),r.default.Api.resizeRows([l],n);var s=o.from===o.to?"menu_1row_size":"menu_nrow_size";m.default.report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:s})}})},short:{pad:"l"}}},t.getColumnResizeItem=function(e){return{name:"columnResize",validClass:"component-vaild menu-component",hideClass:"component-hide menu-component",invalidClass:"component-invaild menu-component",wording:"\u8bbe\u7f6e\u5217\u5bbd",init:function(t){var a=e.view.canvas.excel.selectData.select,n=a.yRange[1]-a.yRange[0]+1,i=n!==e.view.canvas.excel.tableData.row.heights.length;t.className=i?this.hideClass:this.validClass,t.innerText=this.wording},callback:function(){var t=e.view.canvas.excel,a=t.selectData.select,n=(0,c.getDefaultValue)(e,a.xRange[0],a.xRange[1],"width");u.default.dialog.inputDialog({title:"\u8bbe\u7f6e\u5217\u5bbd",info:"\u5217\u5bbd ( \u9ed8\u8ba4\u503c: "+t.configData.colWidth+"\u50cf\u7d20 )",defaultValue:n,min:10,errorInfo:"\u6709\u6548\u8303\u56f4\uff1a10-1000",callback:function(t){var n=d.default.Dimension.DIMENSION_TYPE,i=d.default.Range.DimensionRange,o={from:a.xRange[0],to:a.xRange[1]},l=void 0,c=e.spreadsheet.getActiveSheetId();((l=new i(c,o.from,o.to,n.COLUMNS)).startIndex<0||l.endIndex<0||isNaN(l.startIndex)||isNaN(l.endIndex))&&m.default.report.monitor(33665914),r.default.Api.resizeColumns([l],t);var s=o.from===o.to?"menu_1col_size":"menu_ncol_size";m.default.report.tdwReport({module:"excel_dimension",opername:"doc_excel_editor",action:s})}})},short:{pad:"m"}}};var o=p(a(243)),l=p(a(1937)),c=a(1757),s=p(a(7)),d=p(a(89)),r=p(a(307)),u=p(a(198)),m=p(a(81));function p(e){return e&&e.__esModule?e:{default:e}}var v=s.default.window},1937:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(a(0)),i=o(a(1));function o(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){(0,n.default)(this,e),this.dom=this.initDom(),this.bindEvent()}return(0,i.default)(e,[{key:"initDom",value:function(){var e=document.createElement("input");return e.style.border="none",e.style.width="34px",e.style.height="18px",e.style.border="1px solid #dddddd",e.style.borderRadius="2px",e.style.textAlign="center",e.style.marginRight="10px",e}},{key:"bindEvent",value:function(){var e=this,t=this;this.dom.addEventListener("click",function(e){e.preventDefault(),e.stopPropagation()}),this.dom.addEventListener("dblclick",function(e){e.preventDefault(),e.stopPropagation()}),this.dom.addEventListener("touchstart",function(e){e.preventDefault(),e.stopPropagation(),t.dom.focus()}),this.dom.addEventListener("focus",function(){t.dom.select(),t.dom.style.border="1px solid #0188fb"}),this.dom.addEventListener("blur",function(){t.dom.style.border="1px solid #dddddd"}),this.dom.addEventListener("input",function(e){var a=e.target.value;/[0-9]+$/.test(a)||(a=void 0===a||""===a?"":t.defaultValue||"1"),Number(a)>999&&(a="999"),t.dom.value=a}),this.dom.addEventListener("keydown",function(t){if(13===t.keyCode){t.preventDefault(),t.stopPropagation();var a=document.createEvent("HTMLEvents");a.initEvent("click",!1,!0),e.dom.parentNode.parentNode.dispatchEvent(a)}else t.stopPropagation()}),this.dom.addEventListener("mouseup",function(e){e.preventDefault()})}},{key:"getValue",value:function(){return this.dom.value}},{key:"setType",value:function(e){["button","checkbox","file","hidden","image","password","radio","reset","submit","text","number"].indexOf(e)>-1?this.dom.type=e:this.dom.type="text"}},{key:"setValue",value:function(e){isNaN(Number(e))||(this.dom.value=this.defaultValue=e)}}]),e}();t.default=l},1938:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getImageCutItem=function(e){return{name:"imgCut",validClass:"component-vaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u526a\u5207"},callback:function(){var t=i.default.copyPaste.CopyType;e.plugins.copyPaste.doShapesCopy(t.cut);try{o.default.report.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_cut"})}catch(a){}},short:{pad:"x"}}},t.getImageCopyItem=function(e){return{name:"imgCopy",validClass:"component-vaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u590d\u5236"},callback:function(){var t=i.default.copyPaste.CopyType;e.plugins.copyPaste.doShapesCopy(t.copy);try{o.default.report.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_copy"})}catch(a){}if(window.isRecordPreviewShowing)try{o.default.report.tdwReport({opername:"doc_excel",module:"revise",action:"upv"})}catch(a){}},short:{pad:"c"}}},t.getImgTrimItem=function(e){return{name:"imgTrim",validClass:"component-vaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u88c1\u526a"},callback:function(){e.event.spreadsheetEvent.trigger("imageClip")},short:{pad:"k"}}},t.getImgViewItem=function(e){return{name:"imgView",validClass:"component-vaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u67e5\u770b\u539f\u56fe"},callback:function(){e.event.spreadsheetEvent.trigger("imageZoom",e.view.canvas.excel.selectData.pickShape)},short:{pad:"r"}}},t.getImgClearItem=function(e){return{name:"imgClear",validClass:"component-vaild menu-component",init:function(e){e.className=this.validClass,e.innerText="\u5220\u9664"},callback:function(){n.default.Api.deleteImage({id:e.view.canvas.excel.selectData.pickShape,sheetId:e.spreadsheet.getActiveSheetId()});try{o.default.report.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_del"})}catch(t){}},short:{pad:"d"}}};var n=l(a(307)),i=l(a(761)),o=l(a(81));function l(e){return e&&e.__esModule?e:{default:e}}},1939:function(e,t,a){var n=a(1940);"string"===typeof n&&(n=[[e.i,n,""]]);var i={hmr:!0,transform:void 0,insertInto:void 0};a(37)(n,i);n.locals&&(e.exports=n.locals)},1940:function(e,t,a){(e.exports=a(36)(!1)).push([e.i,".menu-component {\n  padding: 0 12px 0 28px;\n  font-size: 12px;\n  height: 28px;\n  line-height: 28px;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n.component-vaild {\n  color: rgba(0, 0, 0, 0.88);\n  cursor: pointer;\n}\n.component-vaild:hover {\n  background-color: #f5f5f5;\n}\n.component-invaild {\n  color: rgba(0, 0, 0, 0.32);\n  cursor: default;\n  pointer-events: none;\n}\n.component-hide {\n  display: none;\n}\n.component-line {\n  height: 1px;\n  width: 100%;\n  margin: 6px 1px;\n  background: rgba(0, 0, 0, 0.04);\n}\n.component-status {\n  font-size: 10px;\n  color: #9B9B9B;\n  line-height: 24px;\n  display: inline-block;\n  position: relative;\n  right: 0px;\n  float: right;\n}\n",""])},780:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=v(a(3)),i=v(a(0)),o=v(a(1)),l=v(a(4)),c=v(a(5)),s=v(a(1932)),d=a(1933),r=a(1934),u=a(1935),m=a(1936),p=a(1938);function v(e){return e&&e.__esModule?e:{default:e}}a(1939);var f=function(e){function t(e,a){(0,i.default)(this,t);var o=(0,l.default)(this,(t.__proto__||(0,n.default)(t)).call(this,e));if(a)o.config=a;else{var c=e.sheetStatus.permission.gEditable?"edit":"read";o.config=d.pcConfig[c]}return o.listenPermissionsStatusChange(),o}return(0,c.default)(t,e),(0,o.default)(t,[{key:"listenPermissionsStatusChange",value:function(){var e=this;this.app.sheetStatus.permission.listenEditChange(function(t){return t?e.switchToEditable():e.switchToReadonly()})}},{key:"switchToReadonly",value:function(){this.setConfig(d.pcConfig.read)}},{key:"switchToEditable",value:function(){this.setConfig(d.pcConfig.edit)}},{key:"initDefault",value:function(e){this.addItem((0,r.getCopyItem)(e)),this.addItem((0,r.getCutItem)(e)),this.addItem((0,r.getPasteItem)(e)),this.addItem((0,r.getCopyLineItem)(e)),this.addItem((0,r.getCutLineItem)(e)),this.addItem((0,u.getCleanContentsItem)(e)),this.addItem((0,u.getCleanStylesItem)(e)),this.addItem((0,u.getDataValidationItem)(e)),this.addItem((0,u.getInsertCommentItem)(e)),this.addItem((0,u.getInsertImageItem)(e)),this.addItem((0,u.getInsertLinkItem)(e)),this.addItem((0,u.getMergeCellItem)(e)),this.addItem((0,u.getSetFormatItem)(e)),this.addItem((0,m.getColumnResizeItem)(e)),this.addItem((0,m.getHideRowItem)(e)),this.addItem((0,m.getHideColItem)(e)),this.addItem((0,m.getInsertColLeftItem)(e)),this.addItem((0,m.getInsertColLeftItem)(e,"Right")),this.addItem((0,m.getInsertRowAboveItem)(e)),this.addItem((0,m.getInsertRowAboveItem)(e,"Under")),this.addItem((0,m.getRemoveColItem)(e)),this.addItem((0,m.getRemoveRowItem)(e)),this.addItem((0,m.getRowResizeItem)(e)),this.addItem((0,m.getShowColItem)(e)),this.addItem((0,m.getShowRowItem)(e)),this.addItem((0,m.getSmartSplitItem)(e)),this.addItem((0,p.getImageCopyItem)(e)),this.addItem((0,p.getImageCutItem)(e)),this.addItem((0,p.getImgClearItem)(e)),this.addItem((0,p.getImgTrimItem)(e)),this.addItem((0,p.getImgViewItem)(e)),this.addItem({name:"line",class:"component-line"})}}]),t}(s.default);t.default=f;var h=window.T_SHEET||{};window.T_SHEET=h,h.ContextMenu=f}}]);
//# sourceMappingURL=bundle_contextmenu-0ba2959e66.js.map