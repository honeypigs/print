(window.webpackJsonp=window.webpackJsonp||[]).push([["bundle_mentionplugin"],{1664:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var i=u(t(0)),o=u(t(1)),s=u(t(7)),a=t(71),d=t(124),c=t(143);function u(e){return e&&e.__esModule?e:{default:e}}var M=!1,l=(0,d.getCookie)("dev_route_id"),r=(0,c.getQuery)("devMode");l||r||(M=!0);var h=function(){function e(n,t){var o=this;(0,i.default)(this,e),this.initMentionModule=function(){s.default.window.CoreSheet.loadModule("AtMessage",function(e){var n=document.createElement("div");document.body.appendChild(n),e.init(n,{updateSource:function(e){return[]},onToastClick:function(e){var n=o.app.spreadsheet.getActiveSheetId(),t=e.targetId,i=e.mentionId;if(null!=t&&t!=n){if(-1===(o.app.spreadsheet.getSheets()?o.app.spreadsheet.getSheets():[]).map(function(e){return e.getSheetId?e.getSheetId():""}).indexOf(t))return void(0,a.showToast)("@\u4eba\u6240\u5728\u7684\u5b50\u8868\u5df2\u88ab\u5220\u9664");s.default.event.sheetsBar.trigger("switchSheet",t,n,{onSuccess:function(){o.moveToRowColForMention(i,n)},onFail:function(){}})}else o.moveToRowColForMention(i,n)}}),s.default.window.AtMessage=e,o.AtMessage=e,o.initEvent()})},this.moveToRowColForMention=function(e,n){var t=o.app.spreadsheet.activeSheet.mentionsMap;if(t&&t[e]){var i=t[e],s=i.rowIndex,d=i.colIndex;o.canvas.excel.preciousScrollToRowCol({row:s,col:d}),o.canvas.excel.selectAreaCell({xRange:[d,d],yRange:[s,s]},{x:d,y:s},!0,{sheetIds:[n,n]}),o.canvas.excel.highlightMentionWhenFocus(s,d,e)}else(0,a.showToast)("\u5f53\u524d\u5b50\u8868@\u4eba\u7684\u4fe1\u606f\u5df2\u88ab\u5220\u9664")},this.initEvent=function(){s.default.event.mentionEvent.listen("addMentionAction",o.addMentionAction),s.default.event.mentionEvent.listen("setMentionMenu",o.setMentionMenu),s.default.event.mentionEvent.listen("sendMentionAction",o.sendMentionAction),s.default.event.mentionEvent.listen("cancelMentionAction",o.cancelMentionAction),s.default.event.mentionEvent.listen("deleteMentionAction",o.deleteMentionAction),s.default.event.mentionEvent.listen("searchMention",o.searchMention),s.default.event.mentionEvent.listen("setQuickRemindMenu",o.setQuickRemindMenu),s.default.event.mentionEvent.listen("keyboardDown",o.keyboardDown),s.default.event.mentionEvent.listen("hideQuickRemindMenu",o.hideQuickRemindMenu),s.default.event.mentionEvent.listen("autoCreateMention",o.autoCreateMention),s.default.event.spreadsheetEvent.listen("addMention",o.sendMentionRemote),s.default.event.spreadsheetEvent.listen("deleteMention",o.deleteMentionRemote),s.default.event.spreadsheetEvent.listen("updateDocMention",o.debounceUpdateDocMention)},this.addMentionAction=function(e,n,t,i){o.AtMessage&&o.AtMessage.addMentionAction&&o.AtMessage.addMentionAction({pos:e,rowHeight:n,targetId:t},i)},this.setMentionMenu=function(e,n,t){o.AtMessage&&o.AtMessage.setMentionMenu&&o.AtMessage.setMentionMenu({visible:e,pos:n,rowHeight:t})},this.sendMentionAction=function(e,n){o.AtMessage&&o.AtMessage.sendMentionAction&&o.AtMessage.sendMentionAction(e,n)},this.cancelMentionAction=function(){o.AtMessage&&o.AtMessage.cancelMentionAction&&o.AtMessage.cancelMentionAction()},this.deleteMentionAction=function(e,n){o.AtMessage&&o.AtMessage.deleteMentionAction&&o.AtMessage.deleteMentionAction(e,n)},this.searchMention=function(e,n){o.AtMessage&&o.AtMessage.search&&o.AtMessage.search(e,n)},this.autoCreateMention=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{counts:0,targetId:""},n=arguments[1];o.AtMessage&&o.AtMessage.autoCreateMention&&o.AtMessage.autoCreateMention(e,n)},this.updateDocMention=function(){o.AtMessage&&o.AtMessage.updateDocMention&&o.AtMessage.updateDocMention()},this.setQuickRemindMenu=function(e){o.AtMessage&&o.AtMessage.setQuickRemindMenu&&o.AtMessage.setQuickRemindMenu(e)},this.keyboardDown=function(e){o.AtMessage&&o.AtMessage.keyboardDown&&o.AtMessage.keyboardDown({type:e})},this.hideQuickRemindMenu=function(){o.AtMessage&&o.AtMessage.hideQuickRemindMenu&&o.AtMessage.hideQuickRemindMenu()},this.sendMentionRemote=function(e,n){var t=[].concat(e),i=[];t.forEach(function(e){i.push({mentionId:e,targetId:n})}),i.length>0&&(o.AtMessage&&o.AtMessage.sendMentionAction&&o.AtMessage.sendMentionAction(i,function(e){0!==e.retcode&&(0,a.showToast)("\u8fdc\u7a0b\u589e\u52a0@\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u64a4\u9500\u540e\u91cd\u8bd5")}),console.info("%csend actionId:"+e,"color:red"))},this.deleteMentionRemote=function(e){o.hideQuickRemindMenu();var n=[].concat(e);0!==n.length&&(o.AtMessage&&o.AtMessage.deleteMentionAction&&o.AtMessage.deleteMentionAction(n,function(e){0!==e.retcode&&(0,a.showToast)("\u8fdc\u7a0b\u5220\u9664@\u4fe1\u606f\u5931\u8d25\uff0c\u8bf7\u64a4\u9500\u540e\u91cd\u8bd5")}),console.info("%cdelete actionId:"+e,"color:red"))},this.debounceUpdateDocMention=function(){o.timerhandle&&(clearTimeout(o.timerhandle),o.timerhandle=null),o.timerhandle=setTimeout(function(){this.updateDocMention()}.bind(o),500)},this.app=n,this.canvas=t}return(0,o.default)(e,[{key:"initDefault",value:function(){var e=this;s.default.window.SLR&&s.default.window.SLR.assetLoaded?this.initMentionModule():s.default.window.SLR&&s.default.window.SLR.listen("SL-INIT",function(){e.initMentionModule()}),M||t.e("mention_performance_plugin").then(t.t.bind(null,2073,7)).then(function(n){var t=n.default;e.mentionPerformace=new t(e.app,e.canvas),s.default.window.__initMentionPerformance__=e.mentionPerformace.initTable})}}]),e}();n.default=h}}]);
//# sourceMappingURL=bundle_mentionplugin-9d32b269f8.js.map