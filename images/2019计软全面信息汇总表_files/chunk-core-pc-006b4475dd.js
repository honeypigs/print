(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-core-pc"],{1059:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=t.k,s=t.startRow,u=t.startCol,f=t.sheetId,h=t.ver;if(h>o.default.KEYFRAME_VER&&4!==h)i.default.event.spreadsheetEvent.trigger("DataVersionTooLow",h);else if(h>=3)if(o.default.KEYFRAME_VER,e.getSheetId()===f)try{(0,r.keyframeV1)(e,n,s,u,h)}catch(I){l.default.run(d.CONFIG.DO_KEYFRAME_CATCH_ERROR_1,[h],I)}else l.default.run(d.CONFIG.DO_KEYFRAME_CATCH_ERROR_2,[h,e.getSheetId(),f]);else try{var c=new Date;(0,a.keyframeV0)(e,n,s,u),l.default.speed.hasInitReport()||l.default.speed.runReport(d.SPEED_REPORT_POINTS.KEYFRAME_V0_DESERIALIZATION,c,+new Date,!0)}catch(I){l.default.run(d.CONFIG.DO_KEYFRAME_CATCH_ERROR_3,I)}return l.default.run(d.CONFIG.DO_KEYFRAME,[h]),e};var a=n(1060),r=n(387),o=s(n(110)),i=s(n(7)),l=s(n(8)),d=n(26);function s(e){return e&&e.__esModule?e:{default:e}}},1060:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(9));t.importProcessFormula=E,t.keyframeV0=function(e,t,n,T){var m=void 0,_=void 0,y=void 0,x=void 0,S=void 0,O=void 0,C=void 0,D=void 0,M=void 0,w=t,A=w.r||I.DEFAULT_ROW_COUNT,F=w.c||I.DEFAULT_COL_COUNT,k=w.importVersion;"boolean"===typeof w.showgrid&&e.setHideGridlines(!w.showgrid);if(e.setRowCount(A),e.setColCount(F),t&&t.imm){m=(0,o.checkDataSource)(t.d)||[],_=(0,o.checkStyles)(t.s)||[],(0,o.checkHideDimension)(m,void 0,void 0);var L=(0,o.createGridData)({startCol:T,startRow:n,dataSource:m,styles:_,rowLen:A,colLen:F,sheetId:e.getSheetId()});e.setData(L)}else{m=w.d;var N=w.dt;_=w.s;var b=w.st;M=w.t;var P=void 0;if("set"===N&&"set"===b){m.length>0&&_.length&&(P=(0,o.createGridData)({startCol:T,startRow:n,dataSource:m,styles:_,rowLen:A,colLen:F,sheetId:e.getSheetId()}),e.setData(P))}else if("map"===N&&"map"===b){if(P=(0,o.createGridData)({startCol:T,startRow:n,rowLen:A,colLen:F,sheetId:e.getSheetId()}),e.setData(P),m&&Array.isArray(m)&&_&&Array.isArray(_)){var U={};m.forEach(function(t){var n=void 0,a=void 0,i="string",l=t[0],d=t[1],s=t[2];4===t.length&&(n=t[3],U[l+"_"+d]=n),(0,o.checkDimansionCount)(e,l,d),(a=e.getCellDataAtPosition(l,d))||(a=new r.default,e.setCellDataAtPosition(l,d,a)),s&&0===s.indexOf("=")&&"t"!==n&&(i="formula",s=E(s)),(0,o.setCellValue)(a,s,l,d,e.getSheetId(),i)}),_.forEach(function(t){var n=t[0],a=t[1],i=t[2]||{},d=void 0;if((0,o.checkDimansionCount)(e,n,a),(d=e.getCellDataAtPosition(n,a))||(d=new r.default,e.setCellDataAtPosition(n,a,d)),k&&1===k){var s=w.styleDetail&&w.styleDetail[t[2]]||{};(0,l.setCellStyle)(d,s,{cellType:U[n+"_"+a]})}else(0,l.setCellStyle)(d,i,{cellType:U[n+"_"+a]})}),U=null}(0,d.setImportHyperlink)(e,M)}}if(D=w.f){var B=D,G=(B.filteredLastRow,B.filteredRows),V=B.invisible,H=B.range;if(Array.isArray(H)){var W=new i.default(e.getSheetId(),H[0],H[2],H[1],H[3]),z=new p.default({range:W,hiddenRows:G,workbookRangeId:(0,s.getRandomWorkbookRangeId)()});V&&(0,a.default)(V).forEach(function(e){z.setColFilterCriteria(Number(e),new u.default({hiddenValues:V[e]}))}),e.setBasicFilter(z)}}(C=w.m)&&C.forEach(function(t){try{e.addMerge(new i.default(e.getSheetId(),t.row,t.row+t.rowspan-1,t.col,t.col+t.colspan-1))}catch(n){}});(y=w.rh)&&y.forEach(function(t,n){var a=Number(t)>0?Number(t):void 0;e.setRowHeight(n,a)});var Y=window.clientVars,j=+new Date(2019,4,24);Y&&Y.createdDate&&Y.createdDate>=j||(0,v.correctRowHeight)(e);(x=w.cw)&&x.forEach(function(t,n){e.setColWidth(n,Number(t))});(O=w.sp)&&(0,a.default)(O).forEach(function(t){var n=O[t];e.addImage({id:t,x:n.anchor.col,y:n.anchor.row,offsetX:n.offset.x,offsetY:n.offset.y,width:n.size.width,height:n.size.height,clipInfo:n.clipInfo,sheetId:e.getSheetId(),zIndex:n.top,url:n.url,type:"IMAGE"})});var K=w.rhi,$=w.chi,Q=void 0,Z=void 0;K&&(0,a.default)(K).forEach(function(t){(Q=e.getRowProperties(+t))||(Q=new R.default,e.setRowProperties(+t,Q)),Q.setHiddenByUser(!0)});$&&(0,a.default)($).forEach(function(t){(Z=e.getColProperties(+t))||(Z=new R.default,e.setColProperties(+t,Z)),Z.setHiddenByUser(!0)});var X=w.ts||{};S={},X.rowCount?S.rowCount=X.rowCount:X.fixedRowsTop?S.rowCount=X.fixedRowsTop:S.rowCount=0;X.colCount?S.colCount=X.colCount:X.fixedColumnsLeft?S.colCount=X.fixedColumnsLeft:S.colCount=0;e.setFrozenRowCount(S.rowCount),e.setFrozenColCount(S.colCount);var q=w.com;q&&Array.isArray(q)&&q.forEach(function(t){var n=t.ref,a=t.id,r=(0,f.toRC)(n);if(r&&r.row<A&&r.col<F){var o=new c.default({sheetId:e.getSheetId(),sheetRangeType:h.default.COMMENT_RANGE,gridRange:new i.default(e.getSheetId(),r.row,r.row,r.col,r.col),padId:window.clientVars.padId});e.addSheetRange(a,o)}});var J=w.dv||[];J&&Array.isArray(J)&&J.forEach(function(t){(0,l.setBatchValidation)(e,t)});var ee=w.sst;Array.isArray(ee)&&ee.forEach(function(t){var n=t[0],a=t[1],o=t[2],i=void 0;try{o=JSON.parse(o)}catch(l){return void console.error(l)}Array.isArray(o)&&o.length&&((i=e.getCellDataAtPosition(n,a))||(i=new r.default,e.setCellDataAtPosition(n,a,i)),(0,g.setFormatRuns)(i,o))})};var r=T(n(54)),o=n(653),i=T(n(11)),l=n(654),d=n(666),s=n(316),u=T(n(186)),f=n(51),h=T(n(173)),c=T(n(187)),I=n(33),g=n(1129),R=T(n(228)),v=n(387),p=T(n(376));function T(e){return e&&e.__esModule?e:{default:e}}function E(e){return e.replace(/(\_xlfn\.)|(\_xludf\.)/gi,"")}},108:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.OVERFLOW_CELL="nowrap",e.WRAP="normal"}(a||(a={})),t.default=a},1083:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(81);var o=new((a=r)&&a.__esModule?a:{default:a}).default.util.LRUCache(100);t.default=o},109:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(95));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.startIndex=null!=t.startIndex?t.startIndex:0,t.format=t.format||null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return this.format?[this.startIndex,this.format&&this.format.serialize()]:[this.startIndex]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.startIndex&&(this.startIndex=e.startIndex),"undefined"!==typeof e.format&&(this.format=e.format),this}},{key:"equal",value:function(e){return this.startIndex===e.startIndex&&this.equalTextFormat(e)}},{key:"equalTextFormat",value:function(e){return!this.format&&!e.format||!!(this.format&&e.format&&this.format.equal(e.format))}},{key:"clone",value:function(){return new e({startIndex:this.startIndex,format:this.format?this.format.clone():null})}}],[{key:"deserialize",value:function(t){var n={};return n.startIndex=t[0],t[1]&&(n.format=o.default.deserialize(t[1])),new e(n)}}]),e}();l.protoMap={0:{name:"startIndex",dataType:Number},1:{name:"format",dataType:o.default}},t.default=l},11:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(0)),r=l(n(1)),o=l(n(15)),i=n(51);function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t,n,r,o,i){(0,a.default)(this,e),this.sheetId=t,this.startRowIndex=n,this.endRowIndex=r,this.startColIndex=o,this.endColIndex=i}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]}},{key:"isValid",value:function(){return this.startRowIndex>=0&&this.startColIndex>=0&&this.startRowIndex<=this.endRowIndex&&this.startColIndex<=this.endColIndex}},{key:"isSingle",value:function(){return this.startRowIndex===this.endRowIndex&&this.startColIndex===this.endColIndex}},{key:"equals",value:function(e){return this.sheetId===e.sheetId&&this.startRowIndex===e.startRowIndex&&this.endRowIndex===e.endRowIndex&&this.startColIndex===e.startColIndex&&this.endColIndex===e.endColIndex}},{key:"insertRows",value:function(e,t){var n=!0;return this.startRowIndex>=e?(this.startRowIndex+=t,this.endRowIndex+=t):this.startRowIndex<=e&&e<=this.endRowIndex?this.endRowIndex+=t:n=!1,n}},{key:"insertCols",value:function(e,t){var n=!0;return this.startColIndex>=e?(this.startColIndex+=t,this.endColIndex+=t):this.startColIndex<=e&&e<=this.endColIndex?this.endColIndex+=t:n=!1,n}},{key:"deleteRows",value:function(e,t){var n=!0;return e<=this.startRowIndex?(this.startRowIndex=Math.max(e,this.startRowIndex-t),this.endRowIndex=this.endRowIndex-t):e<=this.endRowIndex?this.endRowIndex=Math.max(e-1,this.endRowIndex-t,this.startRowIndex):n=!1,n}},{key:"deleteCols",value:function(e,t){var n=!0;return e<=this.startColIndex?(this.startColIndex=Math.max(e,this.startColIndex-t),this.endColIndex=this.endColIndex-t):e<=this.endColIndex?this.endColIndex=Math.max(e-1,this.endColIndex-t,this.startColIndex):n=!1,n}},{key:"insertDimension",value:function(e){return e.type===o.default.ROWS?this.insertRows(e.index,e.amount):this.insertCols(e.index,e.amount)}},{key:"deleteDimension",value:function(e){return e.type===o.default.ROWS?this.deleteRows(e.index,e.amount):this.deleteCols(e.index,e.amount)}},{key:"move",value:function(e,t){return this.startRowIndex+=e,this.endRowIndex+=e,this.startColIndex+=t,this.endColIndex+=t,this}},{key:"isCross",value:function(e){return e.endRowIndex>=this.startRowIndex&&e.startRowIndex<=this.endRowIndex&&e.endColIndex>=this.startColIndex&&e.startColIndex<=this.endColIndex}},{key:"getCross",value:function(t){var n=null,a=void 0,r=void 0,o=void 0,i=void 0;return this.isCross(t)&&(a=Math.max(this.startRowIndex,t.startRowIndex),r=Math.max(this.startColIndex,t.startColIndex),o=-1!==this.endRowIndex?-1!==t.endRowIndex?Math.min(this.endRowIndex,t.endRowIndex):this.endRowIndex:t.endRowIndex,i=-1!==this.endColIndex?-1!==t.endColIndex?Math.min(this.endColIndex,t.endColIndex):this.endColIndex:t.endColIndex,n=new e(this.sheetId,a,o,r,i)),n}},{key:"contain",value:function(e){return this.startRowIndex<=e.startRowIndex&&this.startColIndex<=e.startColIndex&&this.endRowIndex>=e.endRowIndex&&this.endColIndex>=e.endColIndex}},{key:"getRowCount",value:function(){return this.endRowIndex-this.startRowIndex+1}},{key:"getColCount",value:function(){return this.endColIndex-this.startColIndex+1}},{key:"each",value:function(e){var t=void 0,n=void 0;for(t=this.startRowIndex;t<=this.endRowIndex;t++)for(n=this.startColIndex;n<=this.endColIndex;n++)e(t,n)}},{key:"some",value:function(e){for(var t=this.startRowIndex,n=this.endRowIndex,a=this.startColIndex,r=this.endColIndex,o=t;o<=n;o++)for(var i=a;i<=r;i++)if(e(o,i))return!0;return!1}},{key:"every",value:function(e){for(var t=this.startRowIndex,n=this.endRowIndex,a=this.startColIndex,r=this.endColIndex,o=t;o<=n;o++)for(var i=a;i<=r;i++)if(!e(o,i))return!1;return!0}},{key:"toString",value:function(){return(arguments.length>0&&void 0!==arguments[0]&&arguments[0]?this.sheetId+"!":"")+((0,i.toChar)(this.startColIndex)+(this.startRowIndex+1))+":"+((0,i.toChar)(this.endColIndex)+(this.endRowIndex+1))}},{key:"clone",value:function(){return new e(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex)}}],[{key:"from",value:function(t){var n=t.split(/!|:/);if(2!==n.length&&3!==n.length)throw new Error("\u4e0d\u5408\u6cd5range");var a=n.shift(),r=n.shift(),o=n.shift()||r,l={row:0,col:0},d=(0,i.toRC)(r)||l,s=d.row,u=d.col,f=(0,i.toRC)(o)||l;return new e(a,s,f.row,u,f.col)}},{key:"deserialize",value:function(t){return new e(t[0],t[1],t[2],t[3],t[4])}},{key:"newInstance",value:function(t){return new e(t.sheetId,t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)}}]),e}();d.protoMap={0:{name:"sheetId",dataType:"sheetId"},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.default=d},1110:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.handleBorderColors=function(e){if(!e)return[];var t=[],n=e,a=void 0,r=void 0,o=void 0,i=void 0;i=n.indexOf("--")>=0?n.split("--"):[n];for(var l=0;l<i.length;l++)switch(2===(a=i[l].split(":")).length&&(r=a[0],o=a[1]),r){case"border-top-attr":case"border-top-show":t[d]=o||null;break;case"border-right-attr":case"border-right-show":t[s]=o||null;break;case"border-bottom-attr":case"border-bottom-show":t[u]=o||null;break;case"border-left-attr":case"border-left-show":t[f]=o||null}return t},t.handleBorderStyles=function(e){if(!e)return[];var t=[],n={};e.split("-").forEach(function(e){var t=e.split(":");n[t[0]]=Number(t[1])});var a=function(e){return 1===e?3:3==e?1:e};return t[0]="number"===typeof n.t?a(n.t):null,t[1]="number"===typeof n.r?a(n.r):null,t[2]="number"===typeof n.b?a(n.b):null,t[3]="number"===typeof n.l?a(n.l):null,t},t.createBorders=function(e,t){var n=new a.default;return n.setTop(h(e[0],t[0])),n.setRight(h(e[1],t[1])),n.setBottom(h(e[2],t[2])),n.setLeft(h(e[3],t[3])),n},t.borderAll=function(e,t){var n=new a.default,i=new o.default({color:t});n.setTop(i),n.setLeft(i),n.setRight(i),n.setBottom(i);var l=e.getUserEnteredFormat()||new r.default;l.setBorders(n),e.setUserEnteredFormat(l)},t.borderInner=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});n!==l&&f.setTop(h);n!==s&&f.setBottom(h);i!==d&&f.setRight(h);i!==u&&f.setLeft(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderHorizontal=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});n!==l&&f.setTop(h);n!==s&&f.setBottom(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderVertical=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});i!==d&&f.setLeft(h);i!==u&&f.setRight(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderOuter=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});n===l&&f.setTop(h);n===s&&f.setBottom(h);i===d&&f.setLeft(h);i===u&&f.setRight(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderLeft=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});i===d&&f.setLeft(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderTop=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});n===l&&f.setTop(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderRight=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});i===u&&f.setRight(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderBottom=function(e,t,n,i,l,d,s,u){var f=new a.default,h=new o.default({color:t});n===s&&f.setBottom(h);var c=e.getUserEnteredFormat()||new r.default;c.setBorders(f),e.setUserEnteredFormat(c)},t.borderClear=function(e,t){var n=e.getUserEnteredFormat()||new r.default;n.setBorders(null),e.setUserEnteredFormat(n)};var a=l(n(156)),r=l(n(52)),o=l(n(224)),i=n(33);function l(e){return e&&e.__esModule?e:{default:e}}var d=0,s=1,u=2,f=3;function h(e,t){var n="string"===typeof e;return n||(e=null),"number"===typeof t||(t=n?i.BORDER_STYLE.THIN:null),{color:e,style:t}}},1116:function(e,t,n){"use strict";var a,r=n(15);(a=r)&&a.__esModule},1117:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.DIAG_DOWN="diagDown",e.DIAG_UP="diagUp"}(a||(a={})),t.default=a},1118:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NONE=0]="NONE",e[e.THIN=3]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.DASHED=1]="DASHED",e[e.DOTTED=4]="DOTTED",e[e.THICK=5]="THICK",e[e.DOUBLE=6]="DOUBLE",e[e.HAIR=7]="HAIR",e[e.MEDIUM_DASHED=8]="MEDIUM_DASHED",e[e.DASH_DOT=9]="DASH_DOT",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.DASH_DOT_DOT=11]="DASH_DOT_DOT",e[e.MEDIUM_DASH_DOT_DOT=12]="MEDIUM_DASH_DOT_DOT",e[e.SLANTED_DASH_DOT=13]="SLANTED_DASH_DOT"}(a||(a={})),t.default=a},1119:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.BETWEEN="between",e.NOT_BETWEEN="notBetween",e.EQUAL="equal",e.NOT_EQUAL="notEqual",e.GREAT="greaterThan",e.GREAT_EQUAL="greaterThanOrEqual",e.LESS="lessThan",e.LESS_EQUAL="lessThanOrEqual",e.INCLUDE="contains",e.NOT_INCLUDE="notContains"}(a||(a={})),t.default=a},1122:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ASCENDING=1]="ASCENDING",e[e.DESCENDING=2]="DESCENDING"}(a||(a={})),t.default=a},1123:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.DIAG_DOWN="diagDown",e.DIAG_UP="diagUp",e.MIDDLE="middle",e.CENTER="center"}(a||(a={})),t.default=a},1124:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IRowDataItem=t.RowData=void 0;var a,r=n(661),o=(a=r)&&a.__esModule?a:{default:a};t.RowData=o.default,t.IRowDataItem=r.IRowDataItem},1125:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(96)),i=d(n(15)),l=d(n(35));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,a.default)(this,e),this.parent=t.parent,this.conditionalFormatRules=t.conditionalFormatRules||[]}return(0,r.default)(e,[{key:"getConditionalFormatRuleByRuleIndex",value:function(e){var t=this.conditionalFormatRules.filter(function(t){return t.index===e});return t.length<1?null:t[0].rule}},{key:"getConditionalFormatRuleByRuleIndexWithId",value:function(e){var t=this.conditionalFormatRules.filter(function(t){return t.index===e});return t.length<1?null:t[0]}},{key:"getConditionalFormatRuleByRuleId",value:function(e){var t=this.getConditionalFormatRuleWithIndexById(e);return t&&t.rule}},{key:"getConditionalFormatRuleWithIndexById",value:function(e){var t=this.conditionalFormatRules.filter(function(t){return t.id===e});return t.length>0?t[0]:null}},{key:"getConditionalFormatRuleAll",value:function(){return this.conditionalFormatRules}},{key:"getAvailableRuleIndex",value:function(){return 0===this.conditionalFormatRules.length?0:this.conditionalFormatRules.reduce(function(e,t){return Math.max(e,t.index)},0)+1}},{key:"addConditionalFormatRule",value:function(e,t){var n=this,a=function(){var e=+new Date,t=void 0;return"xxxxxxxx-xxxx-4xxx-yxxx".replace(/[xy]/g,function(n){return t=(e+16*Math.random())%16|0,e=Math.floor(e/16),("x"==n?t:3&t|8).toString(16)})}(),r=t.clone(),o={index:e,rule:r,id:a};return this.conditionalFormatRules.splice(e,0,o),this.batchUpdateConditionalFormatRuleIndex(e+1),r.ruleRanges.forEach(function(e){e.positionCenterKey=n.parent.positionCenter.add({selfData:{xRange:new l.default(e.sheetId,e.startColIndex,e.endColIndex,i.default.COLUMNS),yRange:new l.default(e.sheetId,e.startRowIndex,e.endRowIndex,i.default.ROWS),gridRange:e},type:"sheet-sheetRange",calc:function(e,t,a){var i=e.xRange,l=e.yRange,d=e.gridRange,s=r.ruleRanges.map(function(e){return e.clone()});d.endRowIndex-d.startRowIndex===l.endIndex-l.startIndex&&d.endColIndex-d.startColIndex===i.endIndex-i.startIndex&&(d.startRowIndex=l.startIndex,d.endRowIndex=l.endIndex,d.startColIndex=i.startIndex,d.endColIndex=i.endIndex,n.parent.parent.parent.calcController.conditionalFormatApi.update(o.index,r,s))}})}),this}},{key:"deleteConditionalFormatRule",value:function(e){var t=this;if(e<this.conditionalFormatRules.length){var n=this.conditionalFormatRules[e];return n.rule.ruleRanges.forEach(function(e){e.positionCenterKey&&t.parent.positionCenter.remove(e.positionCenterKey)}),this.conditionalFormatRules.splice(e,1),this.batchUpdateConditionalFormatRuleIndex(e),n.rule}return null}},{key:"updateConditionalFormatRule",value:function(e,t){return this.deleteConditionalFormatRule(e),this.addConditionalFormatRule(e,t),this}},{key:"batchUpdateConditionalFormatRuleIndex",value:function(e){var t,n=void 0;for(n=e=null!=e?e:0,t=this.conditionalFormatRules.length;n<t;n++)this.conditionalFormatRules[n].index=n;return this}}]),e}();s.protoMap={0:{name:"conditionalFormatRules",dataType:{type:Array,subType:{type:Object,protoMap:{0:{name:"index",dataType:Number},1:{name:"rule",dataType:o.default}}}}}},t.default=s},1126:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.UNSPECIFIED=-1]="UNSPECIFIED",e[e.PAST_MONTH=0]="PAST_MONTH",e[e.PAST_WEEK=1]="PAST_WEEK",e[e.PAST_YEAR=2]="PAST_YEAR",e[e.TODAY=3]="TODAY",e[e.YESTERDAY=4]="YESTERDAY",e[e.TOMORROW=5]="TOMORROW",e[e.EXACT_DATE=6]="EXACT_DATE"}(a||(a={})),t.default=a},1127:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return[]}},{key:"setProperties",value:function(e){return this}},{key:"clone",value:function(){return new e}}],[{key:"deserialize",value:function(t){return new e}}]),e}();i.protoMap={},t.default=i},1128:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var i=o(n(7)).default.window,l=function(){function e(t){(0,a.default)(this,e),this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.rowIndex||0,this.colIndex||0,this.padId]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.rowIndex&&(this.rowIndex=e.rowIndex),"undefined"!==typeof e.colIndex&&(this.colIndex=e.colIndex),this.padId=i.clientVars.padId,this}},{key:"updatePositionCenterData",value:function(e){if("undefined"!==typeof this.positionCenterKey){var t=e.keyMap[this.positionCenterKey];if(void 0!==t){var n=e.queue[t].selfData.xRange,a=e.queue[t].selfData.yRange;n&&a&&(n.startIndex=this.colIndex,n.endIndex=this.colIndex,a.startIndex=this.rowIndex,a.endIndex=this.rowIndex)}}return this}}],[{key:"deserialize",value:function(t){if(t[2]&&t[2]==i.clientVars.padId){var n={};return n.rowIndex=t[0],n.colIndex=t[1],new e(n)}return null}}]),e}();l.protoMap={1:{name:"rowIndex",dataType:Number},2:{name:"colIndex",dataType:Number},3:{name:"padId",dataType:String}},t.default=l},1129:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFormatRuns=function(e,t){if(!e||!t)return;t=t.map(function(t){var n=e.getUserEnteredFormat()||new o.default;return t.format&&!function(e){for(var t in e)if(e.hasOwnProperty(t))return!1;return!0}(t.format)||(t.format=n.getTextFormat()),t=new r.default({startIndex:t.startIndex,format:new a.default(t.format)})}),e&&e.setTextFormatRuns(t)};var a=i(n(95)),r=i(n(109)),o=i(n(52));function i(e){return e&&e.__esModule?e:{default:e}}},1131:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(110),o=(a=r)&&a.__esModule?a:{default:a};var i=[{verLowestSupport:3,verTarget:6,convert:function(e){return e}}];t.default=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:o.default.MUTATION_VER,a=void 0,r=void 0;for(a=0,t=i.length;a<t&&(r=i[a],!(e.v>=n));a++)e.v>=r.verLowestSupport&&e.v<r.verTarget&&(e=r.convert(e));return e}},1132:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMutationsByAffectedData=t.getDirectlyAffectedDataWithCollabMutation=t.getDirectlyAffectedDataByDimensionOperation=t.DIMENSION_OPERATION_TYPE=void 0;var a,r=c(n(15)),o=c(n(35)),i=c(n(11)),l=c(n(29)),d=c(n(18)),s=n(229),u=c(n(17)),f=c(n(43)),h=c(n(80));function c(e){return e&&e.__esModule?e:{default:e}}function I(e,t,n,l,d){var s=void 0;switch(e){case 0:return(s=n===r.default.ROWS?new o.default(t.sheetId,t.startRowIndex,t.endRowIndex,r.default.ROWS):new o.default(t.sheetId,t.startColIndex,t.endColIndex,r.default.COLUMNS)).insert(l,d),n===r.default.ROWS?new i.default(t.sheetId,s.startIndex,s.endIndex,t.startRowIndex,t.endRowIndex):new i.default(t.sheetId,t.startRowIndex,t.endRowIndex,s.startIndex,s.endIndex);case 1:return(s=n===r.default.ROWS?new o.default(t.sheetId,t.startRowIndex,t.endRowIndex,r.default.ROWS):new o.default(t.sheetId,t.startColIndex,t.endColIndex,r.default.COLUMNS)).delete(l,d),n===r.default.ROWS?new i.default(t.sheetId,s.startIndex,s.endIndex,t.startRowIndex,t.endRowIndex):new i.default(t.sheetId,t.startRowIndex,t.endRowIndex,s.startIndex,s.endIndex);case a.UNDO_INSERT:case a.UNDO_DELETE:return t}return t}!function(e){e[e.INSERT=0]="INSERT",e[e.DELETE=1]="DELETE",e[e.UNDO_INSERT=2]="UNDO_INSERT",e[e.UNDO_DELETE=3]="UNDO_DELETE"}(a||(t.DIMENSION_OPERATION_TYPE=a={})),t.DIMENSION_OPERATION_TYPE=a,t.getDirectlyAffectedDataByDimensionOperation=function(e,t,n,a){return{mergeData:function(e,t,n){var a=e.getMerges(),o=[],i=void 0,l=void 0,d=void 0,s=void 0,u=void 0;for(i=0,l=a.length;i<l;i++)s=a[i],d=!1,t===r.default.ROWS?n>s.startRowIndex&&n<=s.endRowIndex&&(d=!0):t===r.default.COLUMNS&&n>s.startColIndex&&n<=s.endColIndex&&(d=!0),d&&(u=e.getCellDataAtPosition(s.startRowIndex,s.startColIndex),o.push({userEnterFormat:u&&u.getUserEnteredFormat()?u.getUserEnteredFormat():null,gridRange:s}));return o}(e,n,a)}},t.getDirectlyAffectedDataWithCollabMutation=function(e,t,n,a,o){var l=[];switch(e.id){case u.default.SET_RANGE_MUTATION:case u.default.SET_CELL_PROPERTIES_MUTATION:break;case u.default.MERGE_CELLS_MUTATION:l=function(e,t,n,a){var o=!1;return t===e.sheetId&&(n===r.default.ROWS?a>e.startRowIndex&&a<=e.endRowIndex&&(o=!0):n===r.default.COLUMNS&&a>e.startColIndex&&a<=e.endColIndex&&(o=!0)),o?[{userEnterFormat:null,gridRange:new i.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)}]:[]}(e,n,a,o);break;case u.default.UPDATE_FILTERS_MODEL_MUTATION:case u.default.ADD_EMBEDDED_OBJECT_MUTATION:case u.default.UPDATE_EMBEDDED_OBJECT_MUTATION:case u.default.COPY_PASTE_MUTATION:case u.default.REORDER_RANGE_MUTATION:}return{mergeData:l}},t.getMutationsByAffectedData=function(e,t,n,o,u){var c=[];return function(e,t,n,o,u,c){var g=void 0,R=void 0,v=void 0,p=void 0,T=void 0;for(g=0,R=e.mergeData.length;g<R;g++)v=e.mergeData[g],(p=I(t,v.gridRange,n,o,u)).isValid()&&!p.isSingle()&&c.push(new h.default({sheetId:p.sheetId,startRowIndex:p.startRowIndex,endRowIndex:p.endRowIndex,startColIndex:p.startColIndex,endColIndex:p.endColIndex})),T=n===r.default.ROWS?v.gridRange.startRowIndex:v.gridRange.startColIndex,t===a.DELETE&&v.userEnterFormat&&p.isValid()&&T>=o&&T<=o+u&&c.push(new f.default({gridRange:new i.default(p.sheetId,p.startRowIndex,p.startRowIndex,p.startColIndex,p.startColIndex),cellDataDelta:new l.default({setSlots:1<<d.default.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:(0,s.createCellFormatDelta)(null,v.userEnterFormat)}})}))}(e,t,n,o,u,c),c}},1133:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.INSERT_SHEET_MUTATION,e));return n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:""})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},1134:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.DELETE_SHEET_MUTATION,e));return n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:""})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},1135:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.MOVE_SHEET_MUTATION,e));return n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:""})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},1136:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.SET_WORKBOOK_PROPERTIES_MUTATION,e));return n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:""})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},115:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(25)),r=l(n(0)),o=l(n(1)),i=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(155));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t){(0,r.default)(this,e),"object"==("undefined"===typeof t?"undefined":(0,a.default)(t))&&(t.red=null!=t.red?t.red:255,t.green=null!=t.green?t.green:255,t.blue=null!=t.blue?t.blue:255,t.alpha=null!=t.alpha?t.alpha:1),"string"===typeof t&&(t=i.hex2rgba(t)),this.setProperties(t)}return(0,o.default)(e,[{key:"serialize",value:function(){return this.toHex()}},{key:"setProperties",value:function(e){return"string"===typeof e&&(e=i.hex2rgba(e)),"undefined"!==typeof e.red&&(this.red=e.red),"undefined"!==typeof e.green&&(this.green=e.green),"undefined"!==typeof e.blue&&(this.blue=e.blue),"undefined"!==typeof e.alpha&&(this.alpha=e.alpha),this}},{key:"equal",value:function(e){return this.red===e.red&&this.green===e.green&&this.blue===e.blue&&this.alpha===e.alpha}},{key:"clone",value:function(){return new e({red:this.red,green:this.green,blue:this.blue,alpha:this.alpha})}},{key:"toHex",value:function(){return i.rgba2hex(this.red,this.green,this.blue,this.alpha)}},{key:"toString",value:function(){return"{"+this.toHex()+"}"}},{key:"toStringRGB",value:function(){return"rgb("+this.red+", "+this.green+", "+this.blue+")"}},{key:"toStringRGBA",value:function(){return"rgba("+this.red+", "+this.green+", "+this.blue+", "+this.alpha+")"}},{key:"toKey",value:function(){return"C{0="+this.toString().replace("#","")+"}"}},{key:"_key",get:function(){return"C"+this.toString()}}]),e}();d.protoMap={0:{name:"red",dataType:Number},1:{name:"green",dataType:Number},2:{name:"blue",dataType:Number},3:{name:"alpha",dataType:Number}},t.default=d},121:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(0)),r=l(n(1)),o=l(n(221)),i=n(48);function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.setProperties(t)}return(0,r.default)(e,[{key:"id",get:function(){return this.__id||0}},{key:"pattern",get:function(){if(!this.__pattern&&null!==this.__id){var e=(0,i.getPatternByNumberFormatId)(this.__id)||i.FORMAT_DEFAULT;this.__pattern=e}return this.__pattern||i.FORMAT_DEFAULT}},{key:"type",get:function(){if(!this.__type){var e=(0,i.getCellNumberFormatType)(this.pattern);this.__type=e.group}return this.__type}}],[{key:"serialize",value:function(e){return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).simpleSerialize?[[0],[e.id]]:[[0,1],[e.id,e.pattern]]}},{key:"deserialize",value:function(t){return new e({id:t[1][0],pattern:t[1][1]})}}]),(0,r.default)(e,[{key:"serialize",value:function(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).simpleSerialize?[this.id]:[this.id,this.pattern]}},{key:"setProperties",value:function(e){return this.__id===e.id&&this.__pattern===e.pattern?this:(null!=e.id&&(this.__id=e.id),e.pattern&&/reserved-0x.+/g.test(e.pattern)&&(e.pattern=void 0),"undefined"!==typeof e.pattern&&(this.__pattern=e.pattern,e.pattern&&e.pattern!==i.FORMAT_DEFAULT&&(0,i.autoUpdateCustomNumberFormatMap)(e.pattern),null==e.id&&(this.__id=(0,i.getIdByNumberFormatPattern)(e.pattern)),this.__type=null),null==e.id&&"undefined"===typeof e.pattern&&(this.__id=0,this.__pattern=i.FORMAT_DEFAULT,this.__type=o.default.GENERAL),this)}},{key:"equals",value:function(e){return this.id===e.id&&this.type===e.type&&this.pattern===e.pattern}},{key:"clone",value:function(){return new e({id:this.__id,pattern:this.pattern})}},{key:"toString",value:function(){return"{"+this.id+","+this.pattern+"}"}},{key:"_key",get:function(){return"N"+this.toString()}}]),e}();t.default=d},13:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INSERT_DIMENSION_REQUEST=0]="INSERT_DIMENSION_REQUEST",e[e.DELETE_DIMENSION_REQUEST=1]="DELETE_DIMENSION_REQUEST",e[e.MOVE_DIMENSION_REQUEST=2]="MOVE_DIMENSION_REQUEST",e[e.SET_DIMENSION_SIZE_REQUEST=3]="SET_DIMENSION_SIZE_REQUEST",e[e.SET_DIMENSION_HIDE_REQUEST=4]="SET_DIMENSION_HIDE_REQUEST",e[e.SET_DIMENSION_SHOW_REQUEST=5]="SET_DIMENSION_SHOW_REQUEST",e[e.ADD_IMAGE_REQUEST=6]="ADD_IMAGE_REQUEST",e[e.DELETE_IMAGE_REQUEST=7]="DELETE_IMAGE_REQUEST",e[e.UPDATE_IMAGE_REQUEST=8]="UPDATE_IMAGE_REQUEST",e[e.MERGE_CELLS_REQUEST=9]="MERGE_CELLS_REQUEST",e[e.UNMERGE_CELLS_REQUEST=10]="UNMERGE_CELLS_REQUEST",e[e.SET_SHEETS_REQUEST=11]="SET_SHEETS_REQUEST",e[e.SET_FORMAT_REQUEST=12]="SET_FORMAT_REQUEST",e[e.REORDER_RANGE_REQUEST=13]="REORDER_RANGE_REQUEST",e[e.FREEZE_REQUEST=14]="FREEZE_REQUEST",e[e.SET_SINGLE_VALUE_REQUEST=15]="SET_SINGLE_VALUE_REQUEST",e[e.SET_BORDERS_REQUEST=16]="SET_BORDERS_REQUEST",e[e.COPY_PASTE_REQUEST=17]="COPY_PASTE_REQUEST",e[e.CUT_PASTE_REQUEST=18]="CUT_PASTE_REQUEST",e[e.PASTE_DATA_REQUEST=19]="PASTE_DATA_REQUEST",e[e.CLEAR_FORMAT_REQUEST=20]="CLEAR_FORMAT_REQUEST",e[e.REPLACE_ALL_REQUEST=21]="REPLACE_ALL_REQUEST",e[e.SET_LINK_REQUEST=22]="SET_LINK_REQUEST",e[e.CLEAR_LINK_REQUEST=23]="CLEAR_LINK_REQUEST",e[e.CLEAR_RANGE_REQUEST=24]="CLEAR_RANGE_REQUEST",e[e.SET_NUMBER_FORMAT_REQUEST=25]="SET_NUMBER_FORMAT_REQUEST",e[e.ADJUST_DECIMALS_REQUEST=26]="ADJUST_DECIMALS_REQUEST",e[e.AUTO_FILL_REQUEST=27]="AUTO_FILL_REQUEST",e[e.SET_BASIC_FILTER_REQUEST=28]="SET_BASIC_FILTER_REQUEST",e[e.CLEAR_BASIC_FILTER_REQUEST=29]="CLEAR_BASIC_FILTER_REQUEST",e[e.EXPAND_DIMENSION_REQUEST=30]="EXPAND_DIMENSION_REQUEST",e[e.UPDATE_FILTER_CRITERIA_REQUEST=31]="UPDATE_FILTER_CRITERIA_REQUEST",e[e.SET_RANGE_VALUE_REQUEST=32]="SET_RANGE_VALUE_REQUEST",e[e.MULTI_REQUEST=33]="MULTI_REQUEST",e[e.CLEAR_COMMENT_REQUEST=34]="CLEAR_COMMENT_REQUEST",e[e.UPDATE_COMMENT_REQUEST=35]="UPDATE_COMMENT_REQUEST",e[e.DEFINE_COMMENT_RANGE_REQUEST=36]="DEFINE_COMMENT_RANGE_REQUEST",e[e.DELETE_COMMENT_RANGE_REQUEST=37]="DELETE_COMMENT_RANGE_REQUEST",e[e.SET_DIMENSION_FORMDATA_REQUEST=38]="SET_DIMENSION_FORMDATA_REQUEST",e[e.SET_DATA_VALIDATION_REQUEST=39]="SET_DATA_VALIDATION_REQUEST",e[e.REORDER_FILTER_REQUEST=40]="REORDER_FILTER_REQUEST",e[e.SET_HIDE_GRIDLINES_REQUEST=41]="SET_HIDE_GRIDLINES_REQUEST",e[e.ADD_CONDITIONAL_FORMAT_REQUEST=42]="ADD_CONDITIONAL_FORMAT_REQUEST",e[e.UPDATE_CONDITIONAL_FORMAT_REQUEST=43]="UPDATE_CONDITIONAL_FORMAT_REQUEST",e[e.DELETE_CONDITIONAL_FORMAT_REQUEST=44]="DELETE_CONDITIONAL_FORMAT_REQUEST"}(a||(a={})),t.default=a},1347:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=A(n(24)),r=A(n(83)),o=A(n(3)),i=A(n(0)),l=A(n(1)),d=A(n(4)),s=A(n(5));t.intersectWithMergeAndForm=F;var u,f=A(n(7)),h=A(n(13)),c=A(n(20)),I=A(n(189)),g=A(n(15)),R=A(n(35)),v=n(51),p=A(n(80)),T=A(n(43)),E=A(n(18)),m=n(55),_=A(n(162)),y=n(163),x=A(y),S=n(164),O=A(S),C=A(n(11)),D=A(n(236)),M=A(n(96)),w=A(n(139));function A(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.add=0]="add",e[e.delete=1]="delete"}(u||(u={}));function F(e,t,n,a){var r=n.getSheetBySheetId(e),o=0,i=f.default.window.SpreadsheetApp.plugins.rmap;if(null===r||!i||!i.isRelated(e))return 3;if(!(r.data&&r.data.rowData||!1))return 3;var l=r.data.columnMetadata,d=r.data.rowMetadata;if(a===g.default.COLUMNS)for(var s=0,u=t.length;s<u;s++){var h=t[s],c=h.index,I=h.amount,R={sheetId:e,startRowIndex:0,endRowIndex:d.length,startColIndex:c,endColIndex:c+I};if(3===(o=i.checkReleaseRange(R,d,l,3)))return 2}else for(var v=0,p=t.length;v<p;v++){var T=t[v],E={sheetId:e,startRowIndex:c=T.index,endRowIndex:c+(I=T.amount),startColIndex:0,endColIndex:l.length};if(1===(o=i.checkReleaseRange(E,d,l,1)))return o}return 3}var k=function(e){function t(e,n){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,n));return a.sheetId=e.sheet.getSheetId(),a.type=e.type,e.deleteInfo?(e.deleteInfo=e.deleteInfo.map(function(t){return a.generateRange(e.sheet,t)}),a.behaviors=e.deleteInfo):n&&(a.type===g.default.ROWS?a.behaviors=a.getDeleteOption(e.sheet,n.getRows()):a.behaviors=a.getDeleteOption(e.sheet,n.getCols())),a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"do",value:function(e,t,n){var a=t.getSheetBySheetId(this.sheetId),r=void 0,o=void 0,i=void 0,l=void 0;if(null!==a){e.positionCenterKey&&a.positionCenter.remove(e.positionCenterKey);var d=new R.default(this.sheetId,e.index,e.index+e.amount-1,this.type),s=(0,v.divideDimensionRangeByFilter)([d],a.getBasicFilter()),u=void 0,f=[];for(l=0;l<s.length;l++)u={index:(d=s[l]).startIndex,amount:d.endIndex-d.startIndex+1},f.push(this.generateRange(a,u));for(l=0;l<f.length;l++)(u=f[l]).positionCenterKey&&a.positionCenter.remove(u.positionCenterKey),o=(r=this.beforeDeleteDimension(t,{index:u.index,amount:u.amount},this.type)).beforeMutations,i=r.afterMutations,o.forEach(function(e){n(e)}),n(new I.default({index:u.index,amount:u.amount,type:this.type,sheetId:this.sheetId})),i.forEach(function(e){n(e)})}}},{key:"check",value:function(e){var t=null,n=e.getSheetBySheetId(this.sheetId),a=0,r=void 0;if(null===n)return t;for(r=0;r<this.behaviors.length;r++)a+=this.behaviors[r].amount;switch(F(this.sheetId,this.behaviors,e,this.type)){case 1:t={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5220\u9664\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u7684\u884c\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}};break;case 2:t={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5220\u9664\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u7684\u5217\uff0c\u4f1a\u5bfc\u81f4\u6536\u96c6\u7ed3\u679c\u66f4\u65b0\u5931\u8d25\u3002\u53ef\u4ee5\u9690\u85cf\u5217\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}}}return this.type===g.default.ROWS?n.getRowCount()<=a&&(t={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u62b1\u6b49, \u65e0\u6cd5\u5220\u9664\u5de5\u4f5c\u8868\u4e0a\u7684\u6240\u6709\u884c\u3002"}}):n.getColCount()<=a&&(t={isWarningOnly:!1,error:{title:"\u5220\u9664\u884c\u5217",content:"\u62b1\u6b49, \u65e0\u6cd5\u5220\u9664\u5de5\u4f5c\u8868\u4e0a\u7684\u6240\u6709\u5217\u3002"}}),t}},{key:"getDeleteOption",value:function(e,t){for(var n=[],a=1,r=t[0],o=1,i=void 0;a<t.length;a++)t[a]===t[a-1]+1?o++:(i={index:r,amount:o},n.push(this.generateRange(e,i)),r=t[a],o=1);return i={index:r,amount:o},n.push(this.generateRange(e,i)),n}},{key:"generateRange",value:function(e,t){var n,a=new R.default(this.sheetId,t.index,t.index+t.amount-1,g.default.ROWS),o=this.type===g.default.ROWS?"yRange":"xRange";return t.positionCenterKey=e.positionCenter.add({selfData:(n={},(0,r.default)(n,o,a),(0,r.default)(n,"area",t),(0,r.default)(n,"dimension",o),n),type:"request-deleteDimensionBehavior",calc:function(e,t,n){e.area.index=e[e.dimension].startIndex}}),t}},{key:"beforeDeleteDimension",value:function(e,t,n){t.index,t.amount;var r=[],o=[],i=this.confictMerge(t,e);r.push.apply(r,(0,a.default)(i.beforeMutations)),o.push.apply(o,(0,a.default)(i.afterMutations));var l=this.confictFrozen(t,e);r.push.apply(r,(0,a.default)(l.beforeMutations)),o.push.apply(o,(0,a.default)(l.afterMutations));var d=this.confictFilter(t,e);r.push.apply(r,(0,a.default)(d.beforeMutations)),o.push.apply(o,(0,a.default)(d.afterMutations));var s=this.conflictConditionalFormat(t,e);return r.push.apply(r,(0,a.default)(s.beforeMutations)),o.push.apply(o,(0,a.default)(s.afterMutations)),{beforeMutations:r,afterMutations:o}}},{key:"confictMerge",value:function(e,t){var n=void 0,a=e.index,r=e.amount,o=t.getSheetBySheetId(this.sheetId),i=o.getMerges(),l=void 0,d={beforeMutations:[],afterMutations:[]},s=void 0;for(n=0;n<i.length;n++)if(l=i[n],this.type===g.default.ROWS)if(l.startRowIndex>=a&&l.startRowIndex<=a+r-1){if((s=l.clone()).deleteRows(a,r),s.endRowIndex>=s.startRowIndex){(s.getColCount()>1||s.getRowCount()>1)&&d.afterMutations.push(new p.default(s));var u=(0,m.createCellDataDelta)({cellData:o.getCellDataAtPosition(a+r,l.startColIndex),rowIndex:a+r,colIndex:l.startColIndex,sheetId:l.sheetId},{cellData:o.getCellDataAtPosition(l.startRowIndex,l.startColIndex),rowIndex:l.startRowIndex,colIndex:l.startColIndex,sheetId:l.sheetId},1<<E.default.SLOT_USER_ENTERED_FORMAT_DELTA);d.afterMutations.push(new T.default({gridRange:new C.default(l.sheetId,a,a,l.startColIndex,l.startColIndex),cellDataDelta:u}))}}else a>l.startRowIndex&&a<=l.endRowIndex&&((s=l.clone()).deleteRows(a,r),(s.getRowCount()>1||s.getColCount()>1)&&d.afterMutations.push(new p.default(s)));else if(this.type===g.default.COLUMNS)if(l.startColIndex>=a&&l.startColIndex<=a+r-1){if((s=l.clone()).deleteCols(a,r),s.endColIndex>=s.startColIndex){(s.getColCount()>1||s.getRowCount()>1)&&d.afterMutations.push(new p.default(s));var f=(0,m.createCellDataDelta)({cellData:o.getCellDataAtPosition(l.startRowIndex,a+r),rowIndex:l.startRowIndex,colIndex:a+r,sheetId:l.sheetId},{cellData:o.getCellDataAtPosition(l.startRowIndex,l.startColIndex),rowIndex:l.startRowIndex,colIndex:l.startColIndex,sheetId:l.sheetId},1<<E.default.SLOT_USER_ENTERED_FORMAT_DELTA);d.afterMutations.push(new T.default({gridRange:new C.default(l.sheetId,l.startRowIndex,l.startRowIndex,a,a),cellDataDelta:f}))}}else a>l.startColIndex&&a<=l.endColIndex&&((s=l.clone()).deleteCols(a,r),(s.getColCount()>1||s.getRowCount()>1)&&d.afterMutations.push(new p.default(s)));return d}},{key:"confictFrozen",value:function(e,t){var n=e.index,a=e.amount,r=t.getSheetBySheetId(this.sheetId).getProperties().getGridProperties(),o=r.frozenRowCount,i=r.frozenColCount,l={beforeMutations:[],afterMutations:[]};return o>0&&n<o&&this.type===g.default.ROWS&&(o=Math.max(n-1,o-1-a),0===++o&&l.beforeMutations.push(new x.default({type:y.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_ROWS,value:o,sheetId:this.sheetId}))),i>0&&n<i&&this.type===g.default.COLUMNS&&(i=Math.max(n-1,i-1-a),0===++i&&l.beforeMutations.push(new x.default({type:y.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_COLUMNS,value:i,sheetId:this.sheetId}))),l}},{key:"confictFilter",value:function(e,t){var n=e.index,a=e.amount,r=t.getSheetBySheetId(this.sheetId).getBasicFilter(),o={beforeMutations:[],afterMutations:[]};if(r){var i=r.workbookRangeId,l=r.getRange(),d=l.clone();if(this.type===g.default.ROWS&&(l.startRowIndex>=n&&l.startRowIndex<=n+a-1?o.beforeMutations.push(new _.default({sheetId:this.sheetId,delta:{defaultFilterId:r.workbookRangeId}})):(l.endRowIndex>=n||l.endRowIndex<=n+a-1)&&d.deleteRows(n,a)),this.type===g.default.COLUMNS&&(l.startColIndex>=n&&l.endColIndex<=n+a-1?o.beforeMutations.push(new _.default({sheetId:this.sheetId,delta:{defaultFilterId:r.workbookRangeId}})):(l.startColIndex<=n+a-1||l.endColIndex>=n)&&d.deleteCols(n,a)),(this.type===g.default.ROWS&&(l.endRowIndex>=n||l.endRowIndex<=n+a-1)||this.type===g.default.COLUMNS&&(l.startColIndex<=n+a-1||l.endColIndex>=n))&&(o.beforeMutations.push(new O.default({sheetId:this.sheetId,workbookRangeId:i,updateType:S.FiltersModelUpdateType.UPDATE,delta:{range:l,defaultFilterId:i}})),o.afterMutations.push(new O.default({sheetId:this.sheetId,workbookRangeId:i,updateType:S.FiltersModelUpdateType.UPDATE,delta:{range:d,defaultFilterId:i}}))),this.type===g.default.COLUMNS)(function(e){var t=e.type,n=e.index,a=e.amount,r=e.sheetId,o=e.workbookRangeId,i=e.criteriaMap,l=e.filter,d=(e.spreadsheet,[]),s=[];i.forEach(function(e,i){var l=i+a;if(i>=n){var f={columnIndex:i,clear:!0};if(d.push(new O.default({sheetId:r,workbookRangeId:o,updateType:S.FiltersModelUpdateType.UPDATE,delta:{defaultFilterId:o,updateColumnCriteriaDelta:f}})),s.push(f),t===u.add){var h=i+(t===u.add?a:-a),c={columnIndex:h,criteria:e};d.push(new O.default({sheetId:r,workbookRangeId:o,updateType:S.FiltersModelUpdateType.UPDATE,delta:{defaultFilterId:o,updateColumnCriteriaDelta:{columnIndex:h,criteria:e}}})),s.push(c)}}else if(i>=l){var I=i+(t===u.add?a:-a);d.push(new O.default({sheetId:r,workbookRangeId:o,updateType:S.FiltersModelUpdateType.UPDATE,delta:{defaultFilterId:o,updateColumnCriteriaDelta:{columnIndex:I,criteria:e}}}))}}),d.length>0&&(s.reduce(function(e,t){return e=(0,S.updateFilterColumnCriteriaDelta)(t,e)},l.clone()),d.push(new O.default({sheetId:r,workbookRangeId:o,updateType:S.FiltersModelUpdateType.RECAL,delta:{defaultFilterId:o}})));return d})({type:u.delete,index:n,amount:a,sheetId:this.sheetId,workbookRangeId:r.workbookRangeId,criteriaMap:r.criteriaMap,filter:r,spreadsheet:t}).forEach(function(e){o.afterMutations.push(e)})}return o}},{key:"conflictConditionalFormat",value:function(e,t){var n=this,a={beforeMutations:[],afterMutations:[]},r=this.sheetId,o=t.getSheetBySheetId(r),i=o.conditionalFormatRuleManager.getConditionalFormatRuleAll(),l=i.length,d=[];if(l<1)return a;var s=e.index,u=e.amount,f=s,h=s+u-1,c=o.getRowCount()-1,I=o.getColCount()-1,R=void 0;R=this.type===g.default.ROWS?new C.default(r,f,h,0,I):new C.default(r,0,c,f,h);for(var v=0;v<l;v++){var p=i[v];if(p.rule.ruleRanges.every(function(e){return R.contain(e)}))d.push(v);else{var T,E=!1;if(T=p.rule.ruleRanges.map(function(e){if(R.isCross(e)){E=!0;var t=e.startRowIndex,a=e.endRowIndex,o=e.startColIndex,i=e.endColIndex;return n.type===g.default.ROWS?new C.default(r,t,a-u,o,i):new C.default(r,t,a,o,i-u)}return e}),E){var m=new M.default({ruleRanges:T,booleanConditionalFormat:p.rule.booleanConditionalFormat,uid:p.rule.uid});a.beforeMutations.push(new w.default({sheetId:r,ruleIndex:p.index,rule:m,oldRuleRanges:p.rule.ruleRanges}))}}}return d.sort(function(e,t){return t-e}),d.forEach(function(e){var t=i[e];a.beforeMutations.push(new D.default({sheetId:r,ruleIndex:t.index,oldRuleRanges:t.rule.ruleRanges}))}),a}},{key:"id",get:function(){return h.default.DELETE_DIMENSION_REQUEST}}]),t}(c.default);t.default=k},1348:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=I(n(24)),r=I(n(3)),o=I(n(0)),i=I(n(1)),l=I(n(4)),d=I(n(5)),s=I(n(20)),u=n(70),f=I(u),h=n(51),c=I(n(13));function I(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e,n){(0,o.default)(this,t);var i,d=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n));(d.sheetId=e.sheetId,d.behaviors=[],e.dimensionModifiers)&&(i=d.behaviors).push.apply(i,(0,a.default)(e.dimensionModifiers));return d}return(0,d.default)(t,e),(0,i.default)(t,[{key:"do",value:function(e,t,n){var a,r=t.getSheetBySheetId(e.dimensionRange.sheetId),o=void 0,i=void 0;if(null!==r)for(a=(0,h.divideDimensionRangeByFilter)([e.dimensionRange],r.getBasicFilter()),i=0;i<a.length;i++)o=a[i],n(new f.default({ranges:[o],operation:[{slot:u.DIMENSION_PROPERTIES_SLOT.SLOT_SIZE,size:e.size}],sheetId:this.sheetId,type:o.dimension}))}},{key:"id",get:function(){return c.default.SET_DIMENSION_SIZE_REQUEST}}]),t}(s.default);t.default=g},1349:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(3)),r=g(n(0)),o=g(n(1)),i=g(n(4)),l=g(n(5)),d=g(n(20)),s=n(70),u=g(s),f=n(241),h=g(n(15)),c=n(51),I=g(n(13));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.type=e.type,e.dimensionRanges?(o.behaviors=[],e.dimensionRanges.forEach(function(e){e.dimension===o.type&&o.behaviors.push(e)})):n&&(o.type===h.default.ROWS?o.behaviors=(0,f.getSelectionDimensionRanges)(n.getRows(),o.sheetId,o.type):o.behaviors=(0,f.getSelectionDimensionRanges)(n.getCols(),o.sheetId,o.type)),o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=t.getSheetBySheetId(e.sheetId),o=void 0,i=void 0;if(null!==r)for(a=(0,c.divideDimensionRangeByFilter)([e],r.getBasicFilter()),i=0;i<a.length;i++)o=a[i],n(new u.default({ranges:[o],operation:[{slot:s.DIMENSION_PROPERTIES_SLOT.SLOT_HIDDEN,hidden:1}],sheetId:this.sheetId,type:this.type}))}},{key:"id",get:function(){return I.default.SET_DIMENSION_HIDE_REQUEST}}]),t}(d.default);t.default=R},1350:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getUserEnteredFormatDelta=function(e){var t=e.getUserEnteredFormat();if(null===t)return null;return new o.default({setSlots:t.setSlots,clearSlots:0,delta:t})};var a,r=n(39),o=(a=r)&&a.__esModule?a:{default:a}},1351:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSelectionDimensionRanges=function(e,t,n){for(var a=[],r=1,i=e[0],l=e[0];r<e.length;r++)e[r]!==e[r-1]+1&&(l=e[r-1],a.push(new o.default(t,i,l,n)),i=e[r]);return l=e[r-1],a.push(new o.default(t,i,l,n)),a};var a,r=n(35),o=(a=r)&&a.__esModule?a:{default:a}},1352:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellBorder=function(e,t,n,a,o){var d=e.getCellDataAtPosition(t,n),s=null,u=null,f=null;if(!o&&null===d)return null;switch(a){case r.BORDER_TYPE.TOP:o&&(s=e.getCellDataAtPosition(t-1,n)),u=l(d,a),f=l(s,r.BORDER_TYPE.BOTTOM);break;case r.BORDER_TYPE.RIGHT:o&&(s=e.getCellDataAtPosition(t,n+1)),u=l(d,a),f=l(s,r.BORDER_TYPE.LEFT);break;case r.BORDER_TYPE.BOTTOM:o&&(s=e.getCellDataAtPosition(t+1,n)),u=l(d,a),f=l(s,r.BORDER_TYPE.TOP);break;case r.BORDER_TYPE.LEFT:o&&(s=e.getCellDataAtPosition(t,n-1)),u=l(d,a),f=l(s,r.BORDER_TYPE.RIGHT)}return function(e,t){if(null===e&&null!==t)return-1;if(null!==e&&null===t)return 1;if(e&&t){var n=i.default.fromBorder(e),a=i.default.fromBorder(t);return n.compare(a)}return 0}(u,f)>0?u:f};var a,r=n(33),o=n(399),i=(a=o)&&a.__esModule?a:{default:a};function l(e,t){var n=null,a=void 0;return e&&(n=null===(a=e.getUserEnteredFormat())||null===a.getBorders()||null===a.getBorders()[t]?null:a.getBorders()[t]),n}},1353:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(9));t.getTextFormatDelta=function(e,t,n,u){var h=u.delta.userEnteredFormatDelta,c=new o.default,I=e.getCellDataAtPosition(t,n),g=void 0,R=void 0,v=!1;if(null===I||null===h||void 0===h)return c;if(null===(g=I.getTextFormatRuns())||0===g.length)return c;g=g.map(function(e){return e.clone()});var p=I.getMentionDetails(),T=[];if(p){T=(0,a.default)(p).map(function(e){var t=p[e].pos;return[t[0],t[1]]}).sort(function(e,t){return e[0]-t[0]});var E=(0,s.getMergedValue)(I);g=function(e,t,n){for(var a=[],r=0,o=0,l=t.length,d=void 0,s=void 0,u=0;u<l;u++){d=t[u],s=u+1<l?t[u+1]:null,r=d.startIndex,o=s?s.startIndex:e.length;var h=f([r,o],n);h.forEach(function(e){a.push(new i.default({startIndex:e.pos[0],format:d.format&&d.format.clone()||null}))})}return a}(E,g,T)}function m(e){if(!T.length)return!1;for(var t=0;t<T.length;t++)if(T[t][0]===e)return!0;return!1}function _(e,t){var n=void 0;for(n=0;n<g.length;n++)m((R=g[n]).startIndex)||(null===R.format&&(R.format=new l.default),R.format[e]=t,v=!0)}var y=void 0,x=void 0;for(x=h.clearSlots,y=0;x>0;x>>=1,y++)if(1===(1&x))switch(y){case r.default.FOREGROUND_COLOR:_("color",null);break;case r.default.FONT_FAMINY:_("fontFamily",null);break;case r.default.FONT_SIZE:_("fontSize",null);break;case r.default.BOLD:_("bold",null);break;case r.default.ITALIC:_("italic",null);break;case r.default.STRIKETHROUGH:_("strikethrough",null);break;case r.default.UNDERLINE:_("underline",null)}for(x=h.setSlots,y=0;x>0;x>>=1,y++)if(1===(1&x))switch(y){case r.default.FOREGROUND_COLOR:_("color",h.delta.getTextFormat().color);break;case r.default.FONT_FAMINY:_("fontFamily",h.delta.getTextFormat().fontFamily);break;case r.default.FONT_SIZE:_("fontSize",h.delta.getTextFormat().fontSize);break;case r.default.BOLD:_("bold",h.delta.getTextFormat().bold);break;case r.default.ITALIC:_("italic",h.delta.getTextFormat().italic);break;case r.default.STRIKETHROUGH:_("strikethrough",h.delta.getTextFormat().strikethrough);break;case r.default.UNDERLINE:_("underline",h.delta.getTextFormat().underline)}v&&c.setSlot(d.default.SLOT_RICH_TEXT_STYLE_RUN,g);return c};var r=u(n(32)),o=u(n(29)),i=u(n(109)),l=u(n(95)),d=u(n(18)),s=n(125);function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t){if(!t||!t.length)return[{pos:e,isMention:!1}];var n=[],a=t.filter(function(t){return e[0]<=t[0]&&t[1]<=e[1]});if(a.length>0){for(var r=e[0],o=void 0,i=0;i<a.length;i++)r<(o=a[i])[0]&&n.push({pos:[r,o[0]],isMention:!1}),n.push({pos:o,isMention:!0}),r=o[1];return r<e[1]&&n.push({pos:[r,e[1]],isMention:!1}),n}return[{pos:e,isMention:!1}]}},1354:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=I(n(3)),r=I(n(0)),o=I(n(1)),i=I(n(4)),l=I(n(5)),d=I(n(20)),s=n(70),u=I(s),f=n(241),h=I(n(15)),c=I(n(13));function I(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.type=e.type,e.dimensionRanges?(o.behaviors=[],e.dimensionRanges.forEach(function(e){e.dimension===o.type&&o.behaviors.push(e)})):n&&(o.type===h.default.ROWS?o.behaviors=(0,f.getSelectionDimensionRanges)(n.getRows(),o.sheetId,o.type):o.behaviors=(0,f.getSelectionDimensionRanges)(n.getCols(),o.sheetId,o.type)),o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=void 0,o=void 0;if(null!==t.getSheetBySheetId(e.sheetId))for(a=[e],o=0;o<a.length;o++)r=a[o],n(new u.default({ranges:[r],operation:[{slot:s.DIMENSION_PROPERTIES_SLOT.SLOT_HIDDEN,hidden:0}],sheetId:this.sheetId,type:this.type}))}},{key:"id",get:function(){return c.default.SET_DIMENSION_SHOW_REQUEST}}]),t}(d.default);t.default=g},1355:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(3)),r=g(n(0)),o=g(n(1)),i=g(n(4)),l=g(n(5)),d=g(n(20)),s=g(n(15)),u=g(n(161)),f=g(n(13)),h=g(n(11)),c=n(699),I=g(n(67));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.canUndoRedo=!1,o.behaviors=[{sheetId:e.sheetId,type:e.type,amount:e.amount}],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=t.getSheetBySheetId(e.sheetId);if(null!==a){var r=void 0,o=void 0,i=void 0,l=void 0,d=void 0,f=void 0,g=[],R=a.getRowCount()-1,v=a.getColCount()-1;if(e.type===s.default.ROWS)d=new h.default(e.sheetId,R,R,0,v);else{if(e.type!==s.default.COLUMNS)throw"unknown dimension type";d=new h.default(e.sheetId,0,R,v,v)}var p=(0,c.getSetRangeMutation)(a,d);if(n(new u.default({index:R+1,amount:e.amount,type:e.type,sheetId:e.sheetId})),p&&p.cellDataDeltaAtPositions.length>0){for(r=0;r<p.cellDataDeltaAtPositions.length;r++)if(i=p.cellDataDeltaAtPositions[r].rowIndex,l=p.cellDataDeltaAtPositions[r].colIndex,0!==(f=p.cellDataDeltaAtPositions[r].cellDataDelta).setSlots)if(e.type===s.default.ROWS)for(o=0;o<e.amount;o++)g.push({rowIndex:i+o+1,colIndex:l,cellDataDelta:f});else for(o=0;o<e.amount;o++)g.push({rowIndex:i,colIndex:l+o+1,cellDataDelta:f});d=e.type===s.default.ROWS?new h.default(e.sheetId,R+1,R+1+e.amount-1,0,v):new h.default(e.sheetId,0,R,v+1,v+1+e.amount-1),g.length>0&&n(new I.default({gridRange:d,cellDataDeltaAtPositions:g}))}}}},{key:"id",get:function(){return f.default.EXPAND_DIMENSION_REQUEST}}]),t}(d.default);t.default=R},1356:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(190)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return e instanceof Array?o.behaviors=e:o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){n(new s.default({data:e}))}},{key:"id",get:function(){return u.default.ADD_IMAGE_REQUEST}}]),t}(d.default);t.default=h},1357:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(235)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return e instanceof Array?o.behaviors=e:o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){n(new s.default({key:e.id,sheetId:e.sheetId}))}},{key:"id",get:function(){return u.default.DELETE_IMAGE_REQUEST}}]),t}(d.default);t.default=h},1358:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(280)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return e instanceof Array?o.behaviors=e:o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){n(new s.default({data:e}))}},{key:"id",get:function(){return u.default.UPDATE_IMAGE_REQUEST}}]),t}(d.default);t.default=h},1359:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=G(n(9)),r=G(n(24)),o=G(n(3)),i=G(n(0)),l=G(n(1)),d=G(n(4)),s=G(n(5)),u=G(n(107)),f=G(n(25)),h=G(n(159)),c=G(n(20)),I=G(n(161)),g=G(n(189)),R=G(n(35)),v=G(n(231)),p=G(n(15)),T=n(70),E=G(n(67)),m=G(n(11)),_=G(n(700)),y=G(n(290)),x=G(n(43)),S=G(n(13)),O=n(51),C=G(n(29)),D=n(18),M=G(D),w=n(55),A=n(164),F=G(A),k=G(n(162)),L=G(n(232)),N=G(n(191)),b=G(n(139)),P=G(n(96)),U=n(440),B=G(n(140));function G(e){return e&&e.__esModule?e:{default:e}}var V=function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=(0,h.default)(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&(0,u.default)(t,n,i),i},H=function(e){function t(e,n){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,n));a.sheetId=e.sheetId,a.type=e.type;var r,l=0,s=0;return e.from&&e.from.dimension===a.type&&(l=e.from.startIndex,s=e.from.endIndex),r={from:new R.default(a.sheetId,l,s,a.type),to:e.to},a.behaviors=[r],a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"predictRequestSize",value:function(e){var t=e.getSheetBySheetId(this.sheetId),n=0,a=0;return t?(this.type===p.default.ROWS?a=t.getColCount():this.type===p.default.COLUMNS&&(a=t.getRowCount()),this.behaviors.forEach(function(e){n+=(e.from.endIndex-e.from.startIndex+1)*a*280}),n):0}},{key:"requestSizeOverLimitTips",value:function(){return"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5206\u6279\u79fb\u52a8"+(this.type===p.default.ROWS?"\u884c":"\u5217")+"\u3002"}},{key:"check",value:function(e){var t,n=null,a=e.getSheetBySheetId(this.sheetId),r=this.behaviors[0].from,o=this.behaviors[0].to,i=void 0,l=void 0,d=void 0,s=void 0,u=void 0,f=void 0;if(this.type!==p.default.ROWS&&this.type!==p.default.COLUMNS)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};if(this.behaviors.length>1||null===a)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};if((s=a.getBasicFilter())&&this.type===p.default.COLUMNS&&(f=s.getHiddenRows())&&f.length>0)return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u79fb\u52a8\u4e4b\u524d\u8bf7\u5148\u53d6\u6d88\u7b5b\u9009\u3002"}};if(s&&this.type===p.default.ROWS&&r.startIndex!==o){u=s.getRange(),f=s.getHiddenRows();var h=u.startRowIndex>=r.startIndex&&u.startRowIndex<=r.endIndex,c=u.startRowIndex>=r.startIndex&&u.endRowIndex<=r.endIndex;if(h&&(!c||c&&f&&f.length>0))return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u79fb\u52a8\u4e4b\u524d\u8bf7\u5148\u53d6\u6d88\u7b5b\u9009\u3002"}}}for(t=a.getMerges(),l=0;l<t.length;l++)if(i=t[l],this.type===p.default.ROWS){if(o>i.startRowIndex&&o<=i.endRowIndex)return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u5c06\u884c\u79fb\u5230\u7a7f\u8d8a\u67d0\u4e2a\u5408\u5e76\u5355\u5143\u683c\u7684\u4f4d\u7f6e\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}};if(d=new R.default(i.sheetId,i.startRowIndex,i.endRowIndex,p.default.ROWS),r.isCross(d)&&!r.contain(d))return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u79fb\u52a8\u53ea\u5305\u542b\u5408\u5e76\u5355\u5143\u683c\u7684\u4e00\u90e8\u5206\u7684\u884c\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}}}else{if(o>i.startColIndex&&o<=i.endColIndex)return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u5c06\u5217\u79fb\u5230\u7a7f\u8d8a\u67d0\u4e2a\u5408\u5e76\u5355\u5143\u683c\u7684\u4f4d\u7f6e\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}};if(d=new R.default(i.sheetId,i.startColIndex,i.endColIndex,p.default.COLUMNS),r.isCross(d)&&!r.contain(d))return n={isWarningOnly:!1,error:{title:"\u79fb\u52a8\u884c\u5217",content:"\u62b1\u6b49\uff0c\u65e0\u6cd5\u79fb\u52a8\u53ea\u5305\u542b\u5408\u5e76\u5355\u5143\u683c\u7684\u4e00\u90e8\u5206\u7684\u5217\u3002\u8bf7\u53d6\u6d88\u5408\u5e76\uff0c\u7136\u540e\u91cd\u8bd5\u3002"}}}return n}},{key:"do",value:function(e,t,n){var a=this,r=0,o=t.getSheetBySheetId(this.sheetId),i=void 0,l=void 0,d=0,s=void 0,u=void 0,f=void 0,h=void 0,c=void 0,E=void 0,_=void 0,y=e.to,S=void 0,M=void 0;if(null!==o){var w=o.getBasicFilter(),A=e.from,F=(0,O.divideDimensionRangeByFilter)([A],w),k=0,L=0;for(_=0;_<F.length;_++){for(y<F[_].startIndex?y+=L:k+=L,F[_].startIndex-=k,F[_].endIndex-=k,L=(e={from:F[_],to:y}).from.endIndex-e.from.startIndex+1,n(new I.default({index:y,amount:L,type:this.type,sheetId:this.sheetId})),(i=new R.default(this.sheetId,e.from.startIndex,e.from.endIndex,this.type)).insert(e.to,L),S={from:i,to:new R.default(this.sheetId,y,y+L-1,this.type)},d=S.to.startIndex-S.from.startIndex,u={from:{startIndex:S.from.startIndex,endIndex:S.from.endIndex},to:e.to,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId},f={from:{startIndex:-1,endIndex:-1},to:-1,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId},this.type===p.default.ROWS?s=new v.default({row:u,column:f,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId}):this.type===p.default.COLUMNS&&(s=new v.default({row:f,column:u,sourceSheetId:this.sheetId,destinationSheetId:this.sheetId})),n(s),h=(0,T.getSetDimensionPropertiesMutation)({sheet:o,type:this.type,ranges:[S.from]},{hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0}),r=0;r<h.length;r++)(c=h[r]).operation.length>0&&(c.ranges.forEach(function(e){e.startIndex+=d,e.endIndex+=d}),n(c));this.type===p.default.ROWS?l=new m.default(this.sheetId,S.from.startIndex,S.from.endIndex,0,o.getColCount()-1):this.type===p.default.COLUMNS&&(l=new m.default(this.sheetId,0,o.getRowCount()-1,S.from.startIndex,S.from.endIndex)),l&&((E=this.getSetRangeMutation(o,l,d)).cellDataDeltaAtPositions.length>0&&(this.type===p.default.ROWS?(E.gridRange.startRowIndex+=d,E.gridRange.endRowIndex+=d):this.type===p.default.COLUMNS&&(E.gridRange.startColIndex+=d,E.gridRange.endColIndex+=d),E.cellDataDeltaAtPositions.forEach(function(e){a.type===p.default.ROWS?e.rowIndex+=d:a.type===p.default.COLUMNS&&(e.colIndex+=d)})),n(E)),this.type===p.default.ROWS?l=new m.default(this.sheetId,S.from.startIndex,S.from.endIndex,0,o.getColCount()-1):this.type===p.default.COLUMNS&&(l=new m.default(this.sheetId,0,o.getRowCount()-1,S.from.startIndex,S.from.endIndex)),l&&n(new x.default({gridRange:l,cellDataDelta:new C.default({setSlots:0,clearSlots:D.CELL_DATA_SLOT_COMPOSE.ALL,delta:{}})})),(M=this.beforeMoveDimension(t,S,this.type)).beforeMutations,M.afterMutations.forEach(function(e){n(e)}),n(new g.default({index:S.from.startIndex,amount:L,type:this.type,sheetId:this.sheetId}))}}}},{key:"getSetRangeMutation",value:function(e,t,n){var a=void 0,r=void 0,o=void 0,i=void 0,l=[],d=e.getSheetId();for(r=t.startRowIndex;r<=t.endRowIndex;r++)for(a=t.startColIndex;a<=t.endColIndex;a++){o=e.getCellDataAtPosition(r,a);var s=this.type===p.default.ROWS?r+n:r,u=this.type===p.default.ROWS?a:a+n;i=(0,w.createCellDataDelta)({cellData:null,rowIndex:s,colIndex:u,sheetId:d},{cellData:o,rowIndex:r,colIndex:a,sheetId:d});var f=e.getCellDataAtPosition(s,u),h=f&&f.getFormula();h&&i.setSlot(M.default.SLOT_FORMULA,h),l.push({rowIndex:r,colIndex:a,cellDataDelta:i})}return new E.default({gridRange:t,cellDataDeltaAtPositions:l})}},{key:"beforeMoveDimension",value:function(e,t,n){var a=[],o=[],i=this.conflictMerge(t,e);a.push.apply(a,(0,r.default)(i.beforeMutations)),o.push.apply(o,(0,r.default)(i.afterMutations));var l=this.conflictFilter(t,e);a.push.apply(a,(0,r.default)(l.beforeMutations)),o.push.apply(o,(0,r.default)(l.afterMutations));var d=this.conflictWorkbooRange(t,n,e);o.push.apply(o,(0,r.default)(d.afterMutations));var s=this.conflictConditionalFormat(t,n,e);return o.push.apply(o,(0,r.default)(s.afterMutations)),{beforeMutations:a,afterMutations:o}}},{key:"conflictWorkbooRange",value:function(e,t,n){var r=e.from,o=e.to.startIndex-r.startIndex,i={beforeMutations:[],afterMutations:[]},l=n.getSheetBySheetId(this.sheetId),d=l.sheetRangeControl.ranges;return(0,a.default)(d).forEach(function(e){var n=d[e].gridRange;t===p.default.ROWS?n.startRowIndex>=r.startIndex&&n.endRowIndex<=r.endIndex&&i.afterMutations.push(new N.default({sheetId:l.getSheetId(),sheetRangeId:e,gridRange:new m.default(l.getSheetId(),n.startRowIndex+o,n.endRowIndex+o,n.startColIndex,n.endColIndex),sheetRangeType:d[e].sheetRangeType,sheetRangePropertiesDelta:d[e].delta,nonPersistingLocalChange:!1,padId:d[e].padId})):n.startColIndex>=r.startIndex&&n.endColIndex<=r.endIndex&&i.afterMutations.push(new N.default({sheetId:l.getSheetId(),sheetRangeId:e,gridRange:new m.default(l.getSheetId(),n.startRowIndex,n.endRowIndex,n.startColIndex+o,n.endColIndex+o),sheetRangeType:d[e].sheetRangeType,sheetRangePropertiesDelta:d[e].delta,nonPersistingLocalChange:!1,padId:d[e].padId}))}),i}},{key:"conflictMerge",value:function(e,t){var n=e.from,a=e.to,r=t.getSheetBySheetId(this.sheetId),o=r.getMerges(),i=void 0,l=void 0,d=a.startIndex-n.startIndex,s=void 0,u=[],f=[],h={beforeMutations:[],afterMutations:[]};if(0===o.length)return h;for(l=0;l<o.length;l++)i=o[l],this.type===p.default.ROWS?i.startRowIndex>=n.startIndex&&i.endRowIndex<=n.endIndex&&(s=new m.default(i.sheetId,i.startRowIndex+d,i.endRowIndex+d,i.startColIndex,i.endColIndex),i.clone().insertRows(a.startIndex,n.endIndex-n.startIndex+1),u.push(s),f.push(i)):this.type===p.default.COLUMNS&&i.startColIndex>=n.startIndex&&i.endColIndex<=n.endIndex&&(s=new m.default(i.sheetId,i.startRowIndex,i.endRowIndex,i.startColIndex+d,i.endColIndex+d),i.clone().insertCols(a.startIndex,n.endIndex-n.startIndex+1),u.push(s),f.push(i));return new _.default({sheetId:r.getSheetId(),gridRanges:u}).run(t,function(e){h.afterMutations.push(e)}),new y.default({sheetId:r.getSheetId(),gridRanges:f}).run(t,function(e){h.afterMutations.push(e)}),h}},{key:"conflictFilter",value:function(e,t){var n=e.from,a=e.to,r=t.getSheetBySheetId(this.sheetId),o=a.startIndex-n.startIndex,i=r.getBasicFilter(),l={beforeMutations:[],afterMutations:[]};if(null===i)return l;var d=i.range,s=i.workbookRangeId,u=i.getHiddenRows(),f=void 0;if(this.type===p.default.ROWS&&n.startIndex<=d.startRowIndex&&n.endIndex>=d.endRowIndex)f=new m.default(d.sheetId,d.startRowIndex+o,d.endRowIndex+o,d.startColIndex,d.endColIndex),u=u.map(function(e){return e+o}),l.afterMutations.push(new F.default({sheetId:this.sheetId,workbookRangeId:s,updateType:A.FiltersModelUpdateType.UPDATE,delta:{hiddenRows:u,range:f,defaultFilterId:s}}));else if(this.type===p.default.COLUMNS&&n.startIndex<=d.startColIndex&&n.endIndex>=d.endColIndex){f=new m.default(d.sheetId,d.startRowIndex,d.endRowIndex,d.startColIndex+o,d.endColIndex+o);var h=i.criteriaMap,c={};h.forEach(function(e,t){c[+t+o]=e}),l.afterMutations.push(new k.default({sheetId:this.sheetId,delta:{defaultFilterId:s}})),l.afterMutations.push(new L.default({sheetId:this.sheetId,gridRange:f,delta:{defaultFilterId:s,hiddenRows:u,criteriaDelta:c}}))}else{var I=n.endIndex-n.startIndex+1;if(this.type===p.default.COLUMNS&&!(n.endIndex<d.startColIndex||n.startIndex>d.endColIndex)){var g=d.startColIndex,R=d.endColIndex;a.startIndex<=d.startColIndex?(g=d.startColIndex+I,R=d.endColIndex+I):a.startIndex<=d.endColIndex&&(R=d.endColIndex+I),d.endColIndex>=n.startIndex&&d.endColIndex<=n.endIndex&&o>0&&(g=d.startColIndex,R=d.endColIndex+o),d.startColIndex>=n.startIndex&&d.startColIndex<=n.endIndex&&o<0&&(g=d.startColIndex+o,R=d.endColIndex+I),f=new m.default(d.sheetId,d.startRowIndex,d.endRowIndex,g,R),l.afterMutations.push(new F.default({sheetId:this.sheetId,workbookRangeId:s,updateType:A.FiltersModelUpdateType.UPDATE,delta:{range:f,defaultFilterId:s}}))}if(this.type===p.default.ROWS&&d.endRowIndex>=n.startIndex&&d.endRowIndex<=n.endIndex){var v=d.startRowIndex,T=d.endRowIndex;a.startIndex<=v&&(v+=I,T+=I),f=new m.default(d.sheetId,v,T,d.startColIndex,d.endColIndex),l.afterMutations.push(new F.default({sheetId:this.sheetId,workbookRangeId:s,updateType:A.FiltersModelUpdateType.UPDATE,delta:{range:f,defaultFilterId:s}}))}}return l}},{key:"conflictConditionalFormat",value:function(e,t,n){var a={beforeMutations:[],afterMutations:[]},o=this.sheetId,i=n.getSheetBySheetId(o).conditionalFormatRuleManager.getConditionalFormatRuleAll(),l=i.length;if(!(l>0))return a;for(var d=e.from,s=e.to,u=s.startIndex-d.startIndex,f=d.endIndex-d.startIndex+1,h=function(e){var n=i[e],l=n.rule.ruleRanges,h=[],c=[],I=!1;if(l.map(function(e){var n=function(e){var n=s.startIndex,a=e.clone(),r=[a],o=!1;return t===p.default.ROWS?n>a.startRowIndex&&n<=a.endRowIndex&&(a.insertRows(n,f),o=!0):n>a.startColIndex&&n<=a.endColIndex&&(a.insertCols(n,f),o=!0),{result:r,needUpdate:o}}(e);n.needUpdate&&(I=!0),h.push.apply(h,(0,r.default)(n.result))}),h.map(function(e){var n,a=function(e){var n=d.startIndex,a=d.endIndex,r=e.clone(),i=r.startRowIndex,l=r.endRowIndex,s=r.startColIndex,f=r.endColIndex,h=[],c=!1;if(t===p.default.ROWS?n<=i&&a>=l?c=!0:n<=l&&n>=i?(n>i&&h.push(new m.default(o,i,n-1,s,f)),a<l&&h.push(new m.default(o,a+1,l,s,f)),c=!0):a>=i&&a<=l?n<=i&&(h.push(new m.default(o,a+1,l,s,f)),c=!0):h.push(r):n<=s&&a>=f?c=!0:n<=f&&n>=s?(n>s&&h.push(new m.default(o,i,l,s,n-1)),a<f&&h.push(new m.default(o,i,l,a+1,f)),c=!0):a>=s&&a<=f?n<=s&&(h.push(new m.default(o,i,l,a+1,f)),c=!0):h.push(r),c)if(t===p.default.ROWS){var I=Math.max(n,e.startRowIndex),g=Math.min(a,e.endRowIndex);h.push(new m.default(e.sheetId,I+u,g+u,e.startColIndex,e.endColIndex))}else{var R=Math.max(n,e.startColIndex),v=Math.min(a,e.endColIndex);h.push(new m.default(e.sheetId,e.startRowIndex,e.endRowIndex,R+u,v+u))}return{result:h,needUpdate:c}}(e);a.needUpdate&&(I=!0),(n=c).push.apply(n,(0,r.default)(a.result))}),c=(0,U.mergeMultiRanges)(c),I){var g=new P.default({ruleRanges:c,booleanConditionalFormat:n.rule.booleanConditionalFormat,uid:n.rule.uid});a.afterMutations.push(new b.default({sheetId:o,ruleIndex:n.index,rule:g,oldRuleRanges:l}))}},c=0;c<l;c++)h(c);return a}},{key:"id",get:function(){return S.default.MOVE_DIMENSION_REQUEST}}]),t}(c.default);V([(0,B.default)(H)],H.prototype,"predictRequestSize",null),t.default=H},1360:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(1361)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.canUndoRedo=!1,o.behaviors=e.behaviors,o.sheetId=e.sheetId,o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"do",value:function(e,t,n){n(new s.default({sheetId:this.sheetId,data:e}))}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return u.default.SET_SHEETS_REQUEST}}]),t}(d.default);t.default=h},1361:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(1)),i=s(n(4)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.UPDATE_ALL_SHEETS_MUTATION,e));return n.sheetId=e.sheetId,n.data=e.data,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},1362:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(3)),r=y(n(0)),o=y(n(1)),i=y(n(4)),l=y(n(5)),d=y(n(11)),s=y(n(20)),u=y(n(29)),f=y(n(39)),h=y(n(43)),c=y(n(688)),I=y(n(32)),g=y(n(18)),R=n(51),v=n(158),p=y(n(13)),T=y(n(7)),E=n(241),m=y(n(12)),_=y(n(8));function y(e){return e&&e.__esModule?e:{default:e}}T.default.window;var x=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0,d=void 0,s=void 0,u=o.normalizeFormatValue(e.formatItem,e.formatValue),f=null==e.formatValue;if(e.gridRange)s={gridRange:e.gridRange,formatItem:e.formatItem,formatValue:u,isClear:f},o.behaviors.push(s);else if(n)for(l=0,d=n.rangeSelections.length;l<d;l++)s={gridRange:n.rangeSelections[l],formatItem:e.formatItem,formatValue:u,isClear:f},o.behaviors.push(s);return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=void 0,o=void 0,i=void 0,l=this.getCellDataDelta(e),s=void 0,u=[e.gridRange],f=void 0,c=t.getSheetBySheetId(e.gridRange.sheetId);if(!l.isEmpty()&&c){for(u=(0,R.divideGridRangesByFilter)(u,c.getBasicFilter()),r=0,a=(u=(0,v.divideGridRangesByMerges)(u,c.getMerges())).length;r<a;r++)for(f=u[r],n(new h.default({gridRange:f,cellDataDelta:l})),i=f.startRowIndex;i<=f.endRowIndex;i++)for(o=f.startColIndex;o<=f.endColIndex;o++)(s=(0,E.getTextFormatDelta)(c,i,o,l)).isEmpty()||n(new h.default({gridRange:new d.default(e.gridRange.sheetId,i,i,o,o),cellDataDelta:s}));m.default.wait(1e3).run(function(){for(var t=e.gridRange.startRowIndex,n=e.gridRange.endRowIndex;t<=n;t++)for(var a=e.gridRange.startColIndex,r=e.gridRange.endColIndex;a<=r;a++){var o=c&&c.getCellDataAtPosition(t,a);o&&o.getHyperlink()&&_.default.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_style"})}})}}},{key:"getCellDataDelta",value:function(e){var t=new f.default;if(e.isClear)switch(e.formatItem){case c.default.FONT_FAMINY:t.clearSlot(I.default.FONT_FAMINY);break;case c.default.FONT_SIZE:t.clearSlot(I.default.FONT_SIZE);break;case c.default.BOLD:t.clearSlot(I.default.BOLD);break;case c.default.ITALIC:t.clearSlot(I.default.ITALIC);break;case c.default.WRAP_STRATEGY:t.clearSlot(I.default.WRAP_STRATEGY);break;case c.default.HORIZONTAL_ALIGN:t.clearSlot(I.default.HORIZONTAL_ALIGN);break;case c.default.VERTICAL_ALIGN:t.clearSlot(I.default.VERTICAL_ALIGN);break;case c.default.COLOR:t.clearSlot(I.default.FOREGROUND_COLOR);break;case c.default.BACKGROUND_COLOR:t.clearSlot(I.default.BACKGROUND_COLOR);break;case c.default.STRIKE_THROUGH:t.clearSlot(I.default.STRIKETHROUGH);break;case c.default.UNDERLINE:t.clearSlot(I.default.UNDERLINE)}else switch(e.formatItem){case c.default.FONT_FAMINY:t.setSlot(I.default.FONT_FAMINY,e.formatValue);break;case c.default.FONT_SIZE:t.setSlot(I.default.FONT_SIZE,e.formatValue);break;case c.default.BOLD:t.setSlot(I.default.BOLD,e.formatValue);break;case c.default.ITALIC:t.setSlot(I.default.ITALIC,e.formatValue);break;case c.default.WRAP_STRATEGY:t.setSlot(I.default.WRAP_STRATEGY,e.formatValue);break;case c.default.HORIZONTAL_ALIGN:t.setSlot(I.default.HORIZONTAL_ALIGN,e.formatValue);break;case c.default.VERTICAL_ALIGN:t.setSlot(I.default.VERTICAL_ALIGN,e.formatValue);break;case c.default.COLOR:t.setSlot(I.default.FOREGROUND_COLOR,e.formatValue);break;case c.default.BACKGROUND_COLOR:t.setSlot(I.default.BACKGROUND_COLOR,e.formatValue);break;case c.default.STRIKE_THROUGH:t.setSlot(I.default.STRIKETHROUGH,e.formatValue);break;case c.default.UNDERLINE:t.setSlot(I.default.UNDERLINE,e.formatValue)}var n=new u.default;return n.setSlot(g.default.SLOT_USER_ENTERED_FORMAT_DELTA,t),n}},{key:"normalizeFormatValue",value:function(e,t){switch(e){case c.default.FONT_FAMINY:return this.normalizeFontFamily(t);case c.default.FONT_SIZE:return this.normalizeFontSize(t);case c.default.BOLD:return this.normalizeBold(t);case c.default.ITALIC:return this.normalizeItalic(t);case c.default.WRAP_STRATEGY:return this.normalizeWrapStrategy(t);case c.default.HORIZONTAL_ALIGN:return this.normalizeHorizontalAlign(t);case c.default.VERTICAL_ALIGN:return this.normalizeVerticalAlign(t);case c.default.COLOR:case c.default.BACKGROUND_COLOR:return this.normalizeColor(t);case c.default.STRIKE_THROUGH:return this.normalizeStrikethrough(t);case c.default.UNDERLINE:return this.normalizeUnderline(t)}}},{key:"normalizeFontFamily",value:function(e){return e}},{key:"normalizeFontSize",value:function(e){return e}},{key:"normalizeBold",value:function(e){return e}},{key:"normalizeItalic",value:function(e){return e}},{key:"normalizeWrapStrategy",value:function(e){return e}},{key:"normalizeHorizontalAlign",value:function(e){return e}},{key:"normalizeVerticalAlign",value:function(e){return e}},{key:"normalizeColor",value:function(e){return e}},{key:"normalizeStrikethrough",value:function(e){return e}},{key:"normalizeUnderline",value:function(e){return e}},{key:"normalizeTextRotation",value:function(e){return e}},{key:"id",get:function(){return p.default.SET_FORMAT_REQUEST}}]),t}(s.default);t.default=x},1363:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(20)),s=n(163),u=c(s),f=c(n(7)),h=c(n(13));function c(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){void 0!==e.row&&n(new u.default({type:s.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_ROWS,value:e.row,sheetId:this.sheetId})),void 0!==e.column&&n(new u.default({type:s.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_COLUMNS,value:e.column,sheetId:this.sheetId}))}},{key:"check",value:function(e){var t=null,n=e.getSheetBySheetId(this.sheetId),a=this.behaviors[0].column||0,r=this.behaviors[0].row||0,o=void 0,i=void 0,l=0,d=0,s=void 0,u=void 0;if(null===n)return{isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};if(i=f.default.window.SpreadsheetApp.view.canvas.excel,e.activeSheet===n){for(s=i.bodyWidth,u=i.bodyHeight,o=0;o<a;o++)if((l+=i.tableData.col.getWidth(o))>s)return t={isWarningOnly:!1,error:{title:"\u51bb\u7ed3\u7a97\u683c",content:"\u51bb\u7ed3\u90e8\u5206\u8d85\u8fc7\u9875\u9762\u53ef\u5bb9\u7eb3\u503c\uff0c\u4f1a\u5bfc\u81f4\u9875\u9762\u65e0\u6cd5\u6b63\u5e38\u663e\u793a\uff0c\u5df2\u66ff\u4f60\u53d6\u6d88\u6b64\u6b21\u51bb\u7ed3\u8bbe\u7f6e\u3002"}};for(o=0;o<r;o++)if((d+=i.tableData.row.getHeight(o))>u)return t={isWarningOnly:!1,error:{title:"\u51bb\u7ed3\u7a97\u683c",content:"\u51bb\u7ed3\u90e8\u5206\u8d85\u8fc7\u9875\u9762\u53ef\u5bb9\u7eb3\u503c\uff0c\u4f1a\u5bfc\u81f4\u9875\u9762\u65e0\u6cd5\u6b63\u5e38\u663e\u793a\uff0c\u5df2\u66ff\u4f60\u53d6\u6d88\u6b64\u6b21\u51bb\u7ed3\u8bbe\u7f6e\u3002"}}}if(0===a&&0===r){this.behaviors[0].column=1,this.behaviors[0].row=1;var h=n.getProperties().getGridProperties();if(1!==h.frozenColCount||1!==h.frozenRowCount)return t={isWarningOnly:!0,warning:{title:"\u51bb\u7ed3\u7a97\u683c",content:"\u786e\u5b9a\u8981\u51bb\u7ed3\u9996\u884c\u548c\u9996\u5217\u5417\uff1f",repeat:!0}}}return-1===a&&(this.behaviors[0].column=0),-1===r&&(this.behaviors[0].row=0),t}},{key:"id",get:function(){return h.default.FREEZE_REQUEST}}]),t}(d.default);t.default=I},1364:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.valueSort=void 0;var a,r=l(n(25)),o=n(44),i=l(n(772));function l(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.KEEP=1]="KEEP",e[e.EXCHANGE=-1]="EXCHANGE",e[e.EQUAL=0]="EQUAL"}(a||(a={}));var d=function(e){return e?a.EXCHANGE:a.KEEP},s=function(e){return e?a.KEEP:a.EXCHANGE},u=function(e,t,n,r,o){return e<t?d(n):e>t?s(n):a.EQUAL},f=function(e){return"string"===typeof e&&("TRUE"===(e+="").toUpperCase()||"FALSE"===e.toUpperCase())},h=function(e){return"string"===typeof e?(0,o.hasError)(e):!("object"!==("undefined"===typeof e?"undefined":(0,r.default)(e))||!e.displayText)&&(0,o.hasError)(e.displayText)},c=function(e){return"string"===typeof e&&/\s+/.test(e+="")},I=function(e){if("string"!==typeof e)return!1;e=e[0];return/[!"#\$%&()\*,\.\/:;\?@\[\\,\]\^_\\`{|}~+<=>]+/gi.test(e+="")||/[\uff01\u3002\uff1f\u3001\uff1b\uff1a\u201c\u201d\u3010\u3011\u3014\uff08\uff09\[\]\u300c\u300d}\u3015\uff0e\u300a\u300b\xb7\u2014_*\xd7\u25a1\u25b2\u25cf\uff5e\u2192]+/gi.test(e)},g=function(e,t,n,a,r){if("string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase()),!("string"==typeof e)&&!("string"==typeof t))return null;var o=function(e,t,n,a,r){var o="string"==typeof e&&!c(e)&&!I(e),l="string"==typeof t&&!c(t)&&!I(t),f=l&&-1!==t.indexOf("-"),h=o&&-1!==e.indexOf("-");f&&(t=t.replace(/\-/gi,"")),h&&(e=e.replace(/\-/gi,""));var g=l&&-1!==t.indexOf("'"),R=o&&-1!==e.indexOf("'");g&&(t=t.replace(/\'/gi,"")),R&&(e=e.replace(/\'/gi,""));var v=/[\u4e00-\u9fa5]+/g.test(e),p=/[\u4e00-\u9fa5]+/g.test(t);return v&&p?n?i.default.compare(e,t):i.default.compare(t,e):o&&l?u(e,t,n):o?s(n):l?d(n):void 0}(e,t,n);if(null!=o)return o;var l=function(e,t,n,a,r){var o=I(e)&&!c(e),i=I(t)&&!c(t);if(o&&i){var l=["!",'"',"#","$","%","&","(",")","*",",",".","/",":",";","?","@","[","\\","]","^","_","`","{","|","}","~","+","<",">"],f=l.indexOf(t),h=l.indexOf(e);return-1!=f&&-1!=h?u(h,f,n):u(e,t,n)}return o?s(n):i?d(n):null}(e,t,n);if(null!=l)return l;var f=function(e,t,n,a,r){var o=c(e[0]),i=c(t[0]);return o&&i?u(e,t,n):o?s(n):i?d(n):null}(e,t,n);return null!=f?f:null};t.valueSort=function(e,t,n,r,o){var i=t,l=e,c=function(e,t,n,r,o){var i=null===e||""===e||void 0===e,l=null===t||""===t||void 0===t;return i&&l?a.EQUAL:i?a.KEEP:l?a.EXCHANGE:null}(l,i);if(null!=c)return c;var I=function(e,t,n,r,o){var i=h(e),l=h(t);return i&&l?a.EQUAL:i?s(n):l?d(n):null}(l,i,n);if(null!=I)return I;var R=function(e,t,n,a,r){"string"==typeof e&&(e=e.toLowerCase()),"string"==typeof t&&(t=t.toLowerCase());var o=f(e),i=f(t);return o&&i?u(e,t,n):o?s(n):i?d(n):null}(l,i,n);if(null!=R)return R;var v=g(l,i,n);if(null!=v)return v;var p=function(e,t,n,a,r){var o="number"===typeof e,i="number"===typeof t;if(o&&i){var l=parseFloat(e),f=parseFloat(t);return u(l,f,n)}return o?s(n):i?d(n):null}(l,i,n);return null!=p?p:a.EQUAL}},1369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),r=E(n(0)),o=E(n(1)),i=E(n(4)),l=E(n(5)),d=E(n(20)),s=E(n(29)),u=E(n(18)),f=E(n(39)),h=E(n(52)),c=E(n(156)),I=E(n(32)),g=E(n(67)),R=n(51),v=E(n(13)),p=E(n(224)),T=n(33);function E(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0,d=void 0,s=void 0,u=[];if(o.props=e.props,n)for(l=0,d=n.rangeSelections.length;l<d;l++)s={gridRange:n.rangeSelections[l],props:e.props,type:e.type},u.push(s);return o.behaviors=u,o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=t.getSheetBySheetId(e.gridRange.sheetId),r=[e.gridRange],o=e.gridRange,i=[],l=void 0,d=e.type;if(null!==a)for(r=(0,R.divideGridRangesByFilter)(r,a.getBasicFilter()),l=0;l<r.length;l++)o=r[l],i=[],Array.prototype.push.apply(i,this.getSetCellsBorder(o,d,t)),Array.prototype.push.apply(i,this.getClearCellsBorder(o,d,t)),o.startRowIndex=Math.max(0,o.startRowIndex-1),o.endRowIndex=Math.min(a.getRowCount()-1,o.endRowIndex+1),o.startColIndex=Math.max(0,o.startColIndex-1),o.endColIndex=Math.min(a.getColCount()-1,o.endColIndex+1),n(new g.default({gridRange:o,cellDataDeltaAtPositions:i}))}},{key:"getSetCellsBorder",value:function(e,t,n){var a=[],r=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,l=e.endColIndex,d=void 0,s=void 0,u=[];for(s=r;s<=o;s++)for(d=i;d<=l;d++)a.length=0,a.push({from:T.BORDER_TYPE.DIAG_DOWN,to:T.BORDER_TYPE.DIAG_DOWN}),a.push({from:T.BORDER_TYPE.DIAG_UP,to:T.BORDER_TYPE.DIAG_UP}),s===r?(a.push({from:T.BORDER_TYPE.TOP,to:T.BORDER_TYPE.TOP}),s!==o?a.push({from:T.BORDER_TYPE.MIDDLE,to:T.BORDER_TYPE.BOTTOM}):a.push({from:T.BORDER_TYPE.BOTTOM,to:T.BORDER_TYPE.BOTTOM})):s===o?(a.push({from:T.BORDER_TYPE.BOTTOM,to:T.BORDER_TYPE.BOTTOM}),s!==r?a.push({from:T.BORDER_TYPE.MIDDLE,to:T.BORDER_TYPE.TOP}):a.push({from:T.BORDER_TYPE.TOP,to:T.BORDER_TYPE.TOP})):a.push({from:T.BORDER_TYPE.MIDDLE,to:T.BORDER_TYPE.TOP},{from:T.BORDER_TYPE.MIDDLE,to:T.BORDER_TYPE.BOTTOM}),d===i?(a.push({from:T.BORDER_TYPE.LEFT,to:T.BORDER_TYPE.LEFT}),d!==l?a.push({from:T.BORDER_TYPE.CENTER,to:T.BORDER_TYPE.RIGHT}):a.push({from:T.BORDER_TYPE.RIGHT,to:T.BORDER_TYPE.RIGHT})):d===l?(a.push({from:T.BORDER_TYPE.RIGHT,to:T.BORDER_TYPE.RIGHT}),d!==i?a.push({from:T.BORDER_TYPE.CENTER,to:T.BORDER_TYPE.LEFT}):a.push({from:T.BORDER_TYPE.LEFT,to:T.BORDER_TYPE.LEFT})):a.push(a.push({from:T.BORDER_TYPE.CENTER,to:T.BORDER_TYPE.LEFT},{from:T.BORDER_TYPE.CENTER,to:T.BORDER_TYPE.RIGHT})),u.push({rowIndex:s,colIndex:d,cellDataDelta:this.getCellDataDeltaSet(a,t)});return u}},{key:"getClearCellsBorder",value:function(e,t,n){var a=n.getSheetBySheetId(e.sheetId),r=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,l=e.endColIndex,d=void 0,s=void 0,u=void 0,f=void 0,h=void 0,c=[],I=new p.default(this.props),g=a.getRowCount(),R=a.getColCount();if((s=r-1)>=0&&t[T.BORDER_TYPE.TOP])for(d=i;d<=l;d++)(u=a.data.rowData[s]&&a.data.rowData[s].values[d])&&(h=u.getUserEnteredFormat())&&h.getBorders()&&(f=h.getBorderBottom())&&(f.color||f.style)&&(i===l&&f.equal(I)||c.push({rowIndex:s,colIndex:d,cellDataDelta:this.getCellDataDeltaClear(T.BORDER_TYPE.BOTTOM)}));if((s=o+1)<g&&t[T.BORDER_TYPE.BOTTOM])for(d=i;d<=l;d++)(u=a.data.rowData[s]&&a.data.rowData[s].values[d])&&(h=u.getUserEnteredFormat())&&h.getBorders()&&(f=h.getBorderTop())&&(f.color||f.style)&&(i===l&&f.equal(I)||c.push({rowIndex:s,colIndex:d,cellDataDelta:this.getCellDataDeltaClear(T.BORDER_TYPE.TOP)}));if((d=i-1)>=0&&t[T.BORDER_TYPE.LEFT])for(s=r;s<=o;s++)(u=a.data.rowData[s]&&a.data.rowData[s].values[d])&&(h=u.getUserEnteredFormat())&&h.getBorders()&&(f=h.getBorderRight())&&(f.color||f.style)&&(i===l&&f.equal(I)||c.push({rowIndex:s,colIndex:d,cellDataDelta:this.getCellDataDeltaClear(T.BORDER_TYPE.RIGHT)}));if((d=l+1)<R&&t[T.BORDER_TYPE.RIGHT])for(s=r;s<=o;s++)(u=a.data.rowData[s]&&a.data.rowData[s].values[d])&&(h=u.getUserEnteredFormat())&&h.getBorders()&&(f=h.getBorderLeft())&&(f.color||f.style)&&(i===l&&f.equal(I)||c.push({rowIndex:s,colIndex:d,cellDataDelta:this.getCellDataDeltaClear(T.BORDER_TYPE.LEFT)}));return c}},{key:"getCellDataDeltaSet",value:function(e,t){var n,a=void 0,r=[];for(a=0;a<e.length;a++)t[e[a].from]?r.push(e[a].to):(e.splice(a,1),a--);return n=new f.default({setSlots:this.getSetSlots(r),delta:new h.default({borders:this.getBorders(r)})}),new s.default({setSlots:1<<u.default.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:n}})}},{key:"getBorders",value:function(e){var t={},n=void 0;for(n=0;n<e.length;n++)t[e[n]]={color:this.props.color,style:this.props.style};return new c.default(t)}},{key:"getSetSlots",value:function(e){var t=0,n=void 0;for(n=0;n<e.length;n++)switch(e[n]){case T.BORDER_TYPE.TOP:t+=1<<I.default.BORDER_TOP;break;case T.BORDER_TYPE.RIGHT:t+=1<<I.default.BORDER_RIGHT;break;case T.BORDER_TYPE.BOTTOM:t+=1<<I.default.BORDER_BOTTOM;break;case T.BORDER_TYPE.LEFT:t+=1<<I.default.BORDER_LEFT}return t}},{key:"getCellDataDeltaClear",value:function(e){var t,n=0;switch(e){case T.BORDER_TYPE.TOP:n+=1<<I.default.BORDER_TOP;break;case T.BORDER_TYPE.RIGHT:n+=1<<I.default.BORDER_RIGHT;break;case T.BORDER_TYPE.BOTTOM:n+=1<<I.default.BORDER_BOTTOM;break;case T.BORDER_TYPE.LEFT:n+=1<<I.default.BORDER_LEFT}return t=new f.default({clearSlots:n}),new s.default({setSlots:1<<u.default.SLOT_USER_ENTERED_FORMAT_DELTA,delta:{userEnteredFormatDelta:t}})}},{key:"id",get:function(){return v.default.SET_BORDERS_REQUEST}}]),t}(d.default);t.default=m},137:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.createMutationFromSerialize=void 0;var a=P(n(7)),r=P(n(17)),o=n(79),i=P(n(161)),l=P(n(189)),d=P(n(70)),s=P(n(67)),u=P(n(43)),f=P(n(80)),h=P(n(69)),c=P(n(232)),I=P(n(162)),g=P(n(164)),R=P(n(190)),v=P(n(235)),p=P(n(280)),T=P(n(1133)),E=P(n(1134)),m=P(n(1135)),_=P(n(163)),y=P(n(1136)),x=P(n(390)),S=P(n(281)),O=P(n(231)),C=P(n(110)),D=P(n(391)),M=P(n(233)),w=P(n(234)),A=P(n(191)),F=P(n(282)),k=P(n(236)),L=P(n(139)),N=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(668)),b=P(n(8));function P(e){return e&&e.__esModule?e:{default:e}}t.createMutationFromSerialize=function(e){var t=void 0,n={t:e.t,v:e.v,c:e.c,r:e.r,o:e.o};if(C.default.MUTATION_VER<n.v)return a.default.event.spreadsheetEvent.trigger("DataVersionTooLow",n.v),null;if(C.default.MUTATION_VER,n.v>=5)return N.deserializeMutation(e);try{switch(n.t){case r.default.INSERT_DIMENSION_MUTATION:t=(0,o.deserializeMutation)(n.c,i.default);break;case r.default.DELETE_DIMENSION_MUTATION:t=(0,o.deserializeMutation)(n.c,l.default);break;case r.default.SET_DIMENSION_PROPERTIES_MUTATION:t=(0,o.deserializeMutation)(n.c,d.default);break;case r.default.SET_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,s.default);break;case r.default.SET_CELL_PROPERTIES_MUTATION:t=(0,o.deserializeMutation)(n.c,u.default);break;case r.default.MERGE_CELLS_MUTATION:t=(0,o.deserializeMutation)(n.c,f.default);break;case r.default.UNMERGE_CELLS_MUTATION:t=(0,o.deserializeMutation)(n.c,h.default);break;case r.default.DEFINE_FILTER_MUTATION:t=(0,o.deserializeMutation)(n.c,c.default);break;case r.default.DELETE_FILTER_MUTATION:t=(0,o.deserializeMutation)(n.c,I.default);break;case r.default.UPDATE_FILTER_MUTATION:t=(0,o.deserializeMutation)(n.c,g.default);break;case r.default.ADD_EMBEDDED_OBJECT_MUTATION:t=(0,o.deserializeMutation)(n.c,R.default);break;case r.default.DELETE_EMBEDDED_OBJECT_MUTATION:t=(0,o.deserializeMutation)(n.c,v.default);break;case r.default.UPDATE_EMBEDDED_OBJECT_MUTATION:t=(0,o.deserializeMutation)(n.c,p.default);break;case r.default.INSERT_SHEET_MUTATION:t=(0,o.deserializeMutation)(n.c,T.default);break;case r.default.DELETE_SHEET_MUTATION:t=(0,o.deserializeMutation)(n.c,E.default);break;case r.default.MOVE_SHEET_MUTATION:t=(0,o.deserializeMutation)(n.c,m.default);break;case r.default.DEFINE_SHEET_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,M.default);break;case r.default.DELETE_SHEET_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,w.default);break;case r.default.UPDATE_SHEET_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,A.default);break;case r.default.SET_SHEET_PROPERTIES_MUTATION:t=(0,o.deserializeMutation)(n.c,_.default);break;case r.default.SET_WORKBOOK_PROPERTIES_MUTATION:t=(0,o.deserializeMutation)(n.c,y.default);break;case r.default.COPY_PASTE_MUTATION:t=(0,o.deserializeMutation)(n.c,x.default);break;case r.default.REORDER_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,S.default);break;case r.default.MAP_RANGE_MUTATION:t=(0,o.deserializeMutation)(n.c,O.default);break;case r.default.EMPTY_MUTATION:t=(0,o.deserializeMutation)(n.c,D.default);break;case r.default.ADD_CONDITIONAL_FORMAT_MUTATION:t=(0,o.deserializeMutation)(n.c,F.default);break;case r.default.DELETE_CONDITIONAL_FORMAT_MUTATION:t=(0,o.deserializeMutation)(n.c,k.default);break;case r.default.UPDATE_CONDITIONAL_FORMAT_MUTATION:t=(0,o.deserializeMutation)(n.c,L.default);break;default:t=null}t&&(t.parentRequestId=n.r,t.operationType=n.o)}catch(P){console.error("can not get available mutation",n.c,P),t=null}return t||b.default.monitor(33693655),t}},1370:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=P(n(24)),r=P(n(3)),o=P(n(0)),i=P(n(1)),l=P(n(4)),d=P(n(5)),s=P(n(107)),u=P(n(25)),f=P(n(159)),h=P(n(20)),c=P(n(379)),I=P(n(1371)),g=P(n(1372)),R=n(701),v=n(1373),p=P(v),T=P(n(1374)),E=P(n(1375)),m=n(702),_=n(1377),y=n(18),x=n(32),S=n(1378),O=n(291),C=P(O),D=P(n(703)),M=P(n(378)),w=P(n(13)),A=n(33),F=P(n(1379)),k=n(1380),L=P(n(8)),N=n(26),b=P(n(140));function P(e){return e&&e.__esModule?e:{default:e}}var U=function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=(0,f.default)(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":(0,u.default)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&(0,s.default)(t,n,i),i},B=function(e){function t(e,n){(0,o.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n));return a.behaviors=[e],a.sheetId=e.sheetId,a}return(0,d.default)(t,e),(0,i.default)(t,[{key:"calIsOverSheetSizeAfterPaste",value:function(e){var t=!1;return this.behaviors.forEach(function(n){var a=n.infoDimension,r=n.sheetId,o=a.insertDimensionRanges,i=a.deleteDimensionRanges,l=a.pasteRange,d=e.getSheetBySheetId(r);if(d){var s=(0,v.calcEndRowColIndexAfterExpansion)(d,l,i||[],o||[]),u=s.endRowIndex,f=s.endColIndex,h=(u+1)*(f+1);u>A.MAX_ROW_COUNT&&(t=!0),f>A.MAX_COL_COUNT&&(t=!0),h>A.MAX_CELL_COUNT&&(t=!0)}}),t}},{key:"predictRequestSize",value:function(e){if(this.calIsOverSheetSizeAfterPaste(e))return this.pasteSizeOverLimitTips="\u8d85\u51fa\u6700\u5927\u5355\u5143\u683c\u6570\u91cf\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002",1024e3;var t=0;return this.behaviors.forEach(function(n){var a=n.gridData,r=n.pasteEmbeddedObjects,o=n.sheetId;if(r&&r.length>1e3&&(t=1024e3),a&&!t){var i=a.rowData.length,l=e.getSheetBySheetId(o),d=l?l.getColCount():0;t=d>A.MAX_COL_COUNT||i>A.MAX_ROW_COUNT||d*i>A.MAX_CELL_COUNT?1024e3:a.rowData.reduce(function(e,t){return e+(t?t.values.reduce(function(e,t){if(t){var n=t.getEffectiveValue();if(n&&"string"==typeof n.value)return e+50+n.value.length}return e+50},0):0)},0)}}),t||0}},{key:"requestSizeOverLimitTips",value:function(){return this.pasteSizeOverLimitTips?this.pasteSizeOverLimitTips:"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5bfc\u5165\u539f\u6709\u6587\u6863\u6216\u5206\u6279\u7c98\u8d34\u3002"}},{key:"do",value:function(e,t,n){var r=e.pasteRanges,o=e.gridData,i=e.unmergeInfos,l=e.mergeInfos,d=e.infoDimension,s=e.cutData,u=e.copyPasteMutationsOptions,f=e.pasteEmbeddedObjects,h=e.cellMask,v=e.formatMask,w=e.isFormatPainter,A=e.clearRangeContent,b=r.map(function(e){return e.clone()}),P=s.cutGridRanges.length>0,U=void 0!==h?h:y.CELL_DATA_SLOT_COMPOSE.ALL,B=void 0!==v?v:x.CELL_FORMAT_SLOT_COMPOSE.ALL,G=t.parent;if(G){var V=t.activeSheet,H=V.getData().rowData,W=[],z=[];try{if(u){var Y=d.insertDimensionRanges,j=d.deleteDimensionRanges,K=u.copyRange;j&&j.forEach(function(e){var t=e.startIndex,n=e.endIndex,a=e.dimension;e.sheetId;r.forEach(function(e){e.deleteDimension({type:a,amount:n-t+1,index:t})}),K.deleteDimension({type:a,amount:n-t+1,index:t})}),Y&&Y.map(function(e){var t=e.startIndex,n=e.endIndex,a=e.dimension;e.sheetId;K.insertDimension({type:a,amount:n-t+1,index:t})}),W=(0,m.generateCopyPasteMutation)({sheetId:this.sheetId,copyRange:K,pasteRange:r[0],cellMask:U,formatMask:B},H)}else o&&(W=(0,I.default)({ranges:r,gridData:o,cellMask:U,formatMask:B,isFormatPainter:w,activeSheet:V}))}catch(J){console.error(J)}if(P&&(z=(0,g.default)({spreadsheetApp:G,fromRange:e.copyRange,toRange:e.toGridRange})),console.log("workbookMutations: ",z),A){var $=new M.default(A.sheetId,A.startRowIndex,A.startColIndex),Q=new c.default($,[A],[A],!1);new D.default({},Q).run(t,n)}var Z=[];d.insertDimensionRanges&&(Z=(0,F.default)({insertDimensionRanges:d.insertDimensionRanges||[],deleteDimensionRanges:d.deleteDimensionRanges||[],sheet:V}).afterMutations);var X=[].concat((0,a.default)(d.deleteDimensionRanges&&d.deleteDimensionRanges.length?[]:(0,S.generateUnsetDimensionPropsMutations)(s.cutColumnsDimensionRanges)),(0,a.default)(d.deleteDimensionRanges&&d.deleteDimensionRanges.length?[]:(0,S.generateUnsetDimensionPropsMutations)(s.cutRowsDimensionRanges)),(0,a.default)((0,p.default)(d)),(0,a.default)(d.deleteDimensionRanges&&d.deleteDimensionRanges.length?[]:(0,E.default)(s.cutUnmergeOptions)),(0,a.default)(d.deleteDimensionRanges&&d.deleteDimensionRanges.length?[]:(0,T.default)(s.cutGridRanges)),(0,a.default)((0,R.generateUnmergeCellsMutations)(i)),(0,a.default)(W),(0,a.default)((0,R.generateMergeCellsMutations)(l)),(0,a.default)(Z),(0,a.default)(z));if(f&&(X=[].concat((0,a.default)(X),(0,a.default)((0,_.generatePasteEmbeddedObjectMutations)(f)))),d)(0,k.checkPasteInsertMutations)(X,V)||L.default.run(N.CONFIG.GENERATE_MUTATION_2,["formatPainter",w,V.getSheetId(),"row",V.getRowCount(),"col",V.getColCount(),d.pasteRange,d.deleteDimensionRanges,d.insertDimensionRanges]);else L.default.run(N.CONFIG.GENERATE_MUTATION_1);if((0,k.checkPasteSetRangeMutations)(X)||L.default.run(N.CONFIG.GENERATE_MUTATION_3,["formatPainter",w,V.getSheetId(),d.pasteRange,b,s,e.toGridRange]),X.forEach(function(e){return n(e)}),(0,O.isNeedExtendFilterRange)(r)){var q=(0,C.default)();q.length>0&&n(q[0])}}}},{key:"id",get:function(){return w.default.PASTE_DATA_REQUEST}}]),t}(h.default);U([(0,b.default)(B)],B.prototype,"predictRequestSize",null),t.default=B},1371:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSetRangeMutation=h;var a=n(18),r=f(a),o=n(55),i=f(n(67)),l=f(n(54)),d=f(n(52)),s=n(32),u=f(s);function f(e){return e&&e.__esModule?e:{default:e}}function h(e,t,n,f){var h=[],c=e.ranges,I=e.gridData,g=e.isFormatPainter,R=void 0,v=0,p=void 0,T=void 0,E=void 0,m=void 0,_=I,y=void 0,x=f.getData().rowData,S=void 0,O=[],C=0,D=0;for((new d.default).setSlots=s.CELL_FORMAT_SLOT_COMPOSE.ALL;v<c.length;v++){var M=(R=c[v]).sheetId;O=[],p=R.startRowIndex<0?_.startRow:R.startRowIndex,T=R.endRowIndex<0?f.getRowCount()-1:R.endRowIndex,E=R.startColIndex<0?_.startColumn:R.startColIndex,m=R.endColIndex<0?f.getColCount()-1:R.endColIndex;for(var w=p;w<=T;w++){D=0;for(var A=E;A<=m;A++)if(y=_.rowData[w+C-p]?_.rowData[w+C-p].values[A+D-E]:null,S=x[p+w+C-p]?x[p+w+C-p].values[E+A+D-E]:null,y&&(!y||0!==y.setSlots)||S&&(!S||0!==S.setSlots)){var F=new l.default;F.setSlots=a.CELL_DATA_SLOT_COMPOSE.ALL;var k=new d.default;k.setSlots=s.CELL_FORMAT_SLOT_COMPOSE.ALL,F.setUserEnteredFormat(k);var L={cellData:F,rowIndex:0,colIndex:0,sheetId:M},N={cellData:y,rowIndex:w-p,colIndex:A-E,sheetId:M},b=g?(0,o.createCellDataDeltaForFormatPainter)(L,N):(0,o.createCellDataDelta)(L,N,t,n),P=b.delta.effectiveFormatDelta;P&&(P.clearSlot(u.default.BACKGROUND_COLOR),b.setSlot(r.default.SLOT_EFFIECTIVE_FORMAT_DELTA,P)),O.push({rowIndex:w,colIndex:A,cellDataDelta:b})}D+=m-E+1}C+=T-p+1,h.push(new i.default({gridRange:R,cellDataDeltaAtPositions:O}))}return h}t.default=function(e){var t=e.ranges,n=e.gridData,a=e.cellMask,r=e.formatMask;return h({ranges:t,gridData:n,isFormatPainter:e.isFormatPainter},a,r,e.activeSheet)}},1372:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=e.fromRange,n=e.toRange,o=e.spreadsheetApp;if(!o||!t||!n)return[];for(var i=[],s=o.spreadsheet.activeSheet.data.rowData,u=t.sheetId,f=t.endRowIndex-t.startRowIndex+1,h=t.endColIndex-t.startColIndex+1,c={rowLen:f,colLen:h},I=t.startRowIndex;I<=t.endRowIndex;I++)for(var g=t.startColIndex;g<=t.endColIndex;g++){var R={rowIndex:I,colIndex:g},v=d(R,t,n,c);if(v){var p=l(R,s);if(p){var T=new a.default(u,v.rowIndex,v.rowIndex,v.colIndex,v.colIndex),E=new r.default({sheetRangeId:p.id,gridRange:T,sheetRangeType:p.type,sheetRangePropertiesDelta:{},nonPersistingLocalChange:!1,sheetId:u,padId:window.clientVars.padId});i.push(E)}}}return i};var a=i(n(11)),r=i(n(191)),o=i(n(173));function i(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=e.rowIndex,a=e.colIndex;if(!t[n])return null;var r=t[n].values[a];if(!r)return null;var i=r.sheetRangeReferences;if(!i)return null;for(var l=0;l<i.length;l++){var d=i[l],s=d.id,u=d.type;if(u===o.default.COMMENT_RANGE)return{id:s,type:u}}return null}function d(e,t,n,a){var r=t.startColIndex-n.startColIndex,o=t.startRowIndex-n.startRowIndex;return{colIndex:e.colIndex-r,rowIndex:e.rowIndex-o}}},1373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCopyPasteDimensionMutations=void 0;var a=u(n(24));t.calcEndRowColIndexAfterExpansion=h,t.generateExpansionInsertDimensionMutations=c,t.generateSetDimensionPropertiesMutation=I,t.generateCopyDimensionPropertiesMutation=g,t.generateMultiRangeSetDimensionPropsMutations=R,t.generateCopySetDimensionPropertiesMutations=v;var r=u(n(161)),o=n(70),i=u(o),l=u(n(35)),d=u(n(15)),s=u(n(189));function u(e){return e&&e.__esModule?e:{default:e}}function f(e){return e.toDimensionData().amount}function h(e,t,n,a){var r=t.endColIndex,o=t.endRowIndex,i=t.sheetId,l=e.getColCount(),s=e.getRowCount();r=Math.max(r,l-1),o=Math.max(o,s-1);var u=n.reduce(function(e,t){return e-f(t)},r),h=n[0]&&n[0].dimension,c=n[0]&&n[0].sheetId,I=a.reduce(function(e,t){return e-f(t)},o),g=a[0]&&a[0].dimension,R=a[0]&&a[0].sheetId;return c===i&&(h===d.default.ROWS?o-=u:h===d.default.COLUMNS&&(r-=u)),R===i&&(g===d.default.ROWS?o-=I:h===d.default.COLUMNS&&(r-=I)),{endRowIndex:o,endColIndex:r}}function c(e,t,n,a){var o=[],i=t.sheetId,l=e.getColCount(),s=e.getRowCount(),u=h(e,t,n,a),f=u.endRowIndex,c=u.endColIndex;return c>=l&&o.push(new r.default({type:d.default.COLUMNS,index:l,amount:c-l+1,sheetId:i})),f>=s&&o.push(new r.default({type:d.default.ROWS,index:s,amount:f-s+1,sheetId:i})),o}function I(e,t){var n=[],r=e.values,d=e.type,s=e.ranges,u=void 0,f=0,h=0,c=void 0,I=void 0,g=0,R=void 0,v=void 0,p=null,T=void 0;function E(e,n){return e&&n?!e.equal(n,t):e!==n}function m(e,n){return e&&n?!e.equal(n,t):e!==n}function _(e,n){return e&&n?e.equal(n,t):e===n}var y=function(){u=s[f],c=u.startIndex;var e=(I=u.endIndex)-c+1,y=[];for(h=c;h<=I;h++)R=r[h-c],v=r[h-c+1],E(p=r[h-c-1],R)&&(g=1),_(p,R)&&g++,(m(R,v)||h===I)&&g&&0!==(T=R?(0,o.DimensionPropertiesToOperation)(R,d,t):[{slot:o.DIMENSION_PROPERTIES_SLOT.SLOT_HIDDEN,hidden:0},{slot:o.DIMENSION_PROPERTIES_SLOT.SLOT_SIZE,size:null}]).length&&y.push(new i.default({ranges:[new l.default(u.sheetId,h-g+1,h,u.dimension)],operation:T,type:d,sheetId:u.sheetId}));for(var x=[],S=c;S<=I;S++){var O=S-c;O%e===0&&function(){var t=parseInt(O/e+""),n=y.map(function(n){return n.ranges.forEach(function(n){n.startIndex=n.startIndex+t*e,n.endIndex=n.endIndex+t*e}),n});x=[].concat((0,a.default)(x),(0,a.default)(n))}()}n=[].concat((0,a.default)(n),(0,a.default)(x))};for(f=0;f<s.length;f++)y();return n}function g(e){var t=[],n=e.pasteDimensionRanges,r=e.type,o=I({values:e.values,type:r,ranges:n},{pixelSize:!0,hiddenByUser:!0,ignoreDefaultHidden:!0,clearDefaultSize:!0});return t=[].concat((0,a.default)(t),(0,a.default)(o))}function R(e){var t=e.pasteDimensionRanges,n=e.values,r=[],o=t.length;if(!n||0===t.length)return r;var i=t[0].dimension;if(t.filter(function(e){return e.dimension===t[0].dimension}).length!==o)return console.warn("pasteDimensionRanges ars not same dimension type"),r;var l=g({pasteDimensionRanges:t,type:i,values:n});return r=[].concat((0,a.default)(r),(0,a.default)(l))}function v(e){var t=e.pasteDimensionRanges,n=e.rowsDimensionProperties,r=e.columnsDimensionProperties,o=[];if(!t||0===t.length)return o;var i=t.filter(function(e){return e.dimension===d.default.ROWS}),l=t.filter(function(e){return e.dimension===d.default.COLUMNS});if(n){var s=R({pasteDimensionRanges:i,values:n});o=[].concat((0,a.default)(o),(0,a.default)(s))}if(r){var u=R({pasteDimensionRanges:l,values:r});o=[].concat((0,a.default)(o),(0,a.default)(u))}return o}var p=t.generateCopyPasteDimensionMutations=function(e){if(!e)return[];var t=[],n=e.sheet,o=e.pasteRange,i=e.pasteDimensionPropsRanges,l=e.insertDimensionRanges,d=e.deleteDimensionRanges,u=e.rowsDimensionProperties,f=e.columnsDimensionProperties;if(d){var h;h=d.map(function(e){return new s.default({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId})}),t=[].concat((0,a.default)(t),(0,a.default)(h))}var I=void 0;l&&l.map(function(e){I=new r.default({index:e.startIndex,amount:e.endIndex-e.startIndex+1,type:e.dimension,sheetId:e.sheetId}),t=[].concat((0,a.default)(t),[I])});var g=c(n,o,d||[],l||[]);t=[].concat((0,a.default)(t),(0,a.default)(g));var R=v({pasteDimensionRanges:i,rowsDimensionProperties:u,columnsDimensionProperties:f});return t=[].concat((0,a.default)(t),(0,a.default)(R))};t.default=p},1374:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return e.map(function(e){return new i.default({gridRange:e,cellDataDelta:new a.default({clearSlots:r.CELL_DATA_SLOT_COMPOSE.ALL}).setSlot(o.default.SLOT_USER_ENTERED_FORMAT_DELTA,new l.default({clearSlots:d.CELL_FORMAT_SLOT_COMPOSE.ALL}).clearSlot(s.default.BORDER_TOP).clearSlot(s.default.BORDER_RIGHT).clearSlot(s.default.BORDER_BOTTOM).clearSlot(s.default.BORDER_LEFT))})})};var a=u(n(29)),r=n(18),o=u(r),i=u(n(43)),l=u(n(39)),d=n(32),s=u(d);function u(e){return e&&e.__esModule?e:{default:e}}},1375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(24),o=(a=r)&&a.__esModule?a:{default:a},i=n(701);t.default=function(e){return[].concat((0,o.default)((0,i.generateUnmergeCellsMutations)(e)))}},1376:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSingleOrMerge=function(e,t){if(1===e.getColCount()&&1===e.getRowCount())return!0;if(t){var n=t.getMergeReference(),a=n&&n.equals(e);if(a)return!0}return!1}},1377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateCutDeleteEmbeddedObjectMutations=t.generatePasteEmbeddedObjectMutations=void 0;var a=o(n(190)),r=o(n(235));function o(e){return e&&e.__esModule?e:{default:e}}t.generatePasteEmbeddedObjectMutations=function(e){return e.map(function(e){return new a.default({data:e})})},t.generateCutDeleteEmbeddedObjectMutations=function(e){return e.map(function(e){var t=e.key,n=e.sheetId;return new r.default({key:t,sheetId:n})})}},1378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnsetDimensionPropsMutations=function(e){return e.map(function(e){var t=new o.default({ranges:[e],operation:[{slot:r.DIMENSION_PROPERTIES_SLOT.SLOT_SIZE,size:null},{slot:r.DIMENSION_PROPERTIES_SLOT.SLOT_HIDDEN,hidden:0}],type:e.dimension,sheetId:e.sheetId});return t})};var a,r=n(70),o=(a=r)&&a.__esModule?a:{default:a}},1379:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(24)),r=i(n(15)),o=i(n(80));function i(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.insertDimensionRanges,n=e.deleteDimensionRanges,i=e.sheet,l={beforeMutations:[],afterMutations:[]};return l=t.reduce(function(e,t){var l=function(e){var t=e.insertDimensionRange,n=e.deleteDimensionRanges,a=e.sheet,i=void 0,l=t.startIndex,d=t.endIndex,s=t.dimension,u=d-l+1,f=a.getMerges(),h=void 0,c={beforeMutations:[],afterMutations:[]};for(i=0;i<f.length;i++)h=f[i].clone(),n.forEach(function(e){h.deleteDimension({type:e.dimension,index:e.startIndex,amount:e.endIndex-e.startIndex+1})}),s===r.default.ROWS?l>h.startRowIndex&&l<=h.endRowIndex&&c.afterMutations.push(new o.default({sheetId:h.sheetId,startRowIndex:h.startRowIndex,endRowIndex:h.endRowIndex+u,startColIndex:h.startColIndex,endColIndex:h.endColIndex})):s===r.default.COLUMNS&&l>h.startColIndex&&l<=h.endColIndex&&c.afterMutations.push(new o.default({sheetId:h.sheetId,startRowIndex:h.startRowIndex,endRowIndex:h.endRowIndex,startColIndex:h.startColIndex,endColIndex:h.endColIndex+u}));return c}({insertDimensionRange:t,deleteDimensionRanges:n,sheet:i}),d=l.beforeMutations,s=l.afterMutations;return e.beforeMutations=[].concat((0,a.default)(e.beforeMutations),(0,a.default)(d)),e.afterMutations=[].concat((0,a.default)(e.afterMutations),(0,a.default)(s)),e},l)}},138:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.HISTORY=-1]="HISTORY",e[e.LOCAL=0]="LOCAL",e[e.UNDO=1]="UNDO",e[e.REDO=2]="REDO",e[e.COLLAB=3]="COLLAB"}(a||(a={})),t.default=a},1380:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkPasteSetRangeMutations=t.checkPasteInsertMutations=void 0;var a,r=n(17),o=(a=r)&&a.__esModule?a:{default:a};t.checkPasteInsertMutations=function(e,t){var n=e.filter(function(e){return e.id===o.default.MERGE_CELLS_MUTATION})[0],a=e.filter(function(e){return e.id===o.default.INSERT_DIMENSION_MUTATION});if(n&&0===a.length){var r=n.endColIndex,i=n.endRowIndex,l=t.getColCount(),d=t.getRowCount();if(r>=l)return!1;if(i>=d)return!1}return!0},t.checkPasteSetRangeMutations=function(e){var t=e.filter(function(e){return e.id===o.default.SET_RANGE_MUTATION})[0];if(t){var n=t.gridRange,a=n.endColIndex,r=n.endRowIndex;if(!a&&0!==a)return!1;if(!r&&0!==r)return!1}return!0}},1381:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),r=E(n(0)),o=E(n(1)),i=E(n(4)),l=E(n(5)),d=E(n(11)),s=E(n(20)),u=E(n(29)),f=E(n(43)),h=E(n(18)),c=n(51),I=n(158),g=E(n(39)),R=E(n(32)),v=E(n(13)),p=n(241),T=n(69);function E(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0,d=void 0,s=void 0;if(n)for(l=0,d=n.rangeSelections.length;l<d;l++)s={gridRange:n.rangeSelections[l]},o.behaviors.push(s);return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=void 0,o=void 0,i=void 0,l=void 0,s=this.getCellDataDelta(e),u=void 0,h=[e.gridRange],g=void 0,R=void 0,v=t.getSheetBySheetId(e.gridRange.sheetId);if(v)for(h=(0,c.divideGridRangesByFilter)(h,v.getBasicFilter()),r=0,a=(h=(0,I.divideGridRangesByMerges)(h,v.getMerges(),{needContainSubCells:!0})).length;r<a;r++){for(g=h[r],n(new f.default({gridRange:h[r],cellDataDelta:s})),i=g.startRowIndex;i<=g.endRowIndex;i++)for(o=g.startColIndex;o<=g.endColIndex;o++)(u=(0,p.getTextFormatDelta)(v,i,o,s)).isEmpty()||n(new f.default({gridRange:new d.default(e.gridRange.sheetId,i,i,o,o),cellDataDelta:u}));for(R=(0,T.getUnmergeCellsMutation)(g,v),l=0;l<R.length;l++)n(R[l])}}},{key:"getCellDataDelta",value:function(e){var t=new u.default,n=new g.default;return n.clearSlot(R.default.NUMBER_FORMAT),n.clearSlot(R.default.BACKGROUND_COLOR),n.clearSlot(R.default.BORDER_TOP),n.clearSlot(R.default.BORDER_RIGHT),n.clearSlot(R.default.BORDER_BOTTOM),n.clearSlot(R.default.BORDER_LEFT),n.clearSlot(R.default.HORIZONTAL_ALIGN),n.clearSlot(R.default.VERTICAL_ALIGN),n.clearSlot(R.default.WRAP_STRATEGY),n.clearSlot(R.default.FOREGROUND_COLOR),n.clearSlot(R.default.FONT_FAMINY),n.clearSlot(R.default.FONT_SIZE),n.clearSlot(R.default.BOLD),n.clearSlot(R.default.ITALIC),n.clearSlot(R.default.STRIKETHROUGH),n.clearSlot(R.default.UNDERLINE),t.clearSlot(h.default.SLOT_HYPERLINK),t.setSlot(h.default.SLOT_USER_ENTERED_FORMAT_DELTA,n),t}},{key:"id",get:function(){return v.default.CLEAR_RANGE_REQUEST}}]),t}(s.default);t.default=m},1382:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(3)),r=m(n(0)),o=m(n(1)),i=m(n(4)),l=m(n(5)),d=m(n(11)),s=m(n(20)),u=m(n(29)),f=m(n(18)),h=m(n(78)),c=m(n(43)),I=m(n(223)),g=n(57),R=m(n(39)),v=m(n(32)),p=n(250),T=m(n(60)),E=m(n(13));function m(e){return e&&e.__esModule?e:{default:e}}var _=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));o.behaviors=e;for(var l=0;l<o.behaviors.length;l++)o.behaviors[l].linkUrl=(0,p.parseLinkUrl)(o.behaviors[l].value);return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(){return null}},{key:"do",value:function(e,t,n){var a,r=void 0,o=e.sheetId,i=t.getSheetBySheetId(o);null!==i&&(a=i.getCellDataAtPosition(e.y,e.x),(r=this.getCellDataDelta(a,e.value,e.linkUrl,e.y,e.x,o)).isEmpty()||n(new c.default({gridRange:new d.default(e.sheetId,e.y,e.y,e.x,e.x),cellDataDelta:r})))}},{key:"getCellDataDelta",value:function(e,t,n,a,r,o){var i=new u.default,l=e&&e.getUserEnteredFormat(),d=l&&l.getNumberFormat(),s=(0,g.parseValueWithStyle)(t,d),c=void 0;return s.valueType===I.default.FORMULA?"string"===typeof s.value&&(i.clearSlot(f.default.SLOT_EFFIECTIVE_VALUE),i.setSlot(f.default.SLOT_FORMULA,T.default.string2FormulaModel(s.value,a,r,o))):(i.setSlot(f.default.SLOT_EFFIECTIVE_VALUE,new h.default({type:Number(s.valueType),value:s.value})),(c=new R.default).setSlot(v.default.NUMBER_FORMAT,s.numberFormat),i.setSlot(f.default.SLOT_USER_ENTERED_FORMAT_DELTA,c)),n&&i.setSlot(f.default.SLOT_HYPERLINK,n),i.clearSlot(f.default.SLOT_MENTION),i}},{key:"id",get:function(){return E.default.REPLACE_ALL_REQUEST}}]),t}(s.default);t.default=_},1383:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(413)),s=n(250),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);for(var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=0;l<o.behaviors.length;l++){var d=o.behaviors[l];d.linkUrl=e.linkUrl||null,!d.userEnterValue&&d.linkUrl&&(d.userEnterValue=(0,s.parseLinkUrl)(d.linkUrl)||"")}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"id",get:function(){return u.default.SET_LINK_REQUEST}}]),t}(d.default);t.default=h},1384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(3)),r=R(n(0)),o=R(n(1)),i=R(n(4)),l=R(n(5)),d=R(n(11)),s=R(n(20)),u=R(n(29)),f=R(n(18)),h=R(n(43)),c=R(n(39)),I=R(n(32)),g=R(n(13));function R(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=n&&n.activeCell.sheetId||"";return o.behaviors=[{sheetId:l,rowIndex:e.rowIndex,colIndex:e.colIndex}],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){if(t.getSheetBySheetId(e.sheetId)){var a=this.getCellDataDelta();n(new h.default({gridRange:new d.default(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex),cellDataDelta:a}))}}},{key:"getCellDataDelta",value:function(){var e=new u.default;e.clearSlot(f.default.SLOT_HYPERLINK);var t=e.delta.userEnteredFormatDelta||new c.default;return t.clearSlot(I.default.FOREGROUND_COLOR),t.clearSlot(I.default.UNDERLINE),e.setSlot(f.default.SLOT_USER_ENTERED_FORMAT_DELTA,t),e.clearSlot(f.default.SLOT_RICH_TEXT_STYLE_RUN),e}},{key:"id",get:function(){return g.default.CLEAR_LINK_REQUEST}}]),t}(s.default);t.default=v},1385:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(3)),r=p(n(0)),o=p(n(1)),i=p(n(4)),l=p(n(5)),d=p(n(20)),s=p(n(29)),u=p(n(39)),f=p(n(43)),h=p(n(32)),c=p(n(18)),I=n(51),g=n(158),R=n(48),v=p(n(13));function p(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0,d=void 0,s=void 0;if(n)for(l=0,d=n.rangeSelections.length;l<d;l++)s={gridRange:n.rangeSelections[l],pattern:e.pattern},o.behaviors.push(s);return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=void 0,o=this.getCellDataDelta(e),i=[e.gridRange],l=t.getSheetBySheetId(e.gridRange.sheetId);if(!o.isEmpty()&&l)for(i=(0,I.divideGridRangesByFilter)(i,l.getBasicFilter()),r=0,a=(i=(0,g.divideGridRangesByMerges)(i,l.getMerges())).length;r<a;r++)n(new f.default({gridRange:i[r],cellDataDelta:o}))}},{key:"getCellDataDelta",value:function(e){var t=new u.default,n=(0,R.getNumberFormatByFormatCode)(e.pattern);t.setSlot(h.default.NUMBER_FORMAT,n);var a=new s.default;return a.setSlot(c.default.SLOT_USER_ENTERED_FORMAT_DELTA,t),a}},{key:"id",get:function(){return v.default.SET_NUMBER_FORMAT_REQUEST}}]),t}(d.default);t.default=T},1386:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(3)),r=p(n(0)),o=p(n(1)),i=p(n(4)),l=p(n(5)),d=p(n(20)),s=p(n(29)),u=p(n(39)),f=p(n(43)),h=p(n(32)),c=p(n(18)),I=n(51),g=n(158),R=n(48),v=p(n(13));function p(e){return e&&e.__esModule?e:{default:e}}var T=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));if(n){o.activeCell=n.activeCell,o.decimalsDelta=e.decimalsDelta;var l,d=void 0,s=void 0;for(d=0,l=n.rangeSelections.length;d<l;d++)s={gridRange:n.rangeSelections[d],decimalsDelta:e.decimalsDelta},o.behaviors.push(s)}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){var t=e.parent.view.getSelection(),n=e.activeSheet.getCellDataAtPosition(t.activeCell.rowIndex,t.activeCell.colIndex);if(n){var a=n.getUserEnteredFormat(),r=a&&a.getNumberFormat()||(0,R.getDefaultNumberFormat)(),o=n.getEffectiveValue(),i=(0,R.changeDecimals)(o,r,this.decimalsDelta);return r.pattern===i.pattern?{ignore:!0}:null}return{ignore:!0}}},{key:"do",value:function(e,t,n){var a,r=void 0,o=t.getSheetBySheetId(this.activeCell.sheetId);if(o){var i=o.getCellDataAtPosition(this.activeCell.rowIndex,this.activeCell.colIndex),l=this.getCellDataDelta(i,e.decimalsDelta),d=[e.gridRange];if(!l.isEmpty()&&o)for(d=(0,I.divideGridRangesByFilter)(d,o.getBasicFilter()),r=0,a=(d=(0,g.divideGridRangesByMerges)(d,o.getMerges())).length;r<a;r++)n(new f.default({gridRange:d[r],cellDataDelta:l}))}}},{key:"getCellDataDelta",value:function(e,t){var n=e&&e.getUserEnteredFormat(),a=n&&n.getNumberFormat(),r=(0,R.changeDecimals)(e&&e.getEffectiveValue(),a,t),o=new u.default;o.setSlot(h.default.NUMBER_FORMAT,r);var i=new s.default;return i.setSlot(c.default.SLOT_USER_ENTERED_FORMAT_DELTA,o),i}},{key:"id",get:function(){return v.default.ADJUST_DECIMALS_REQUEST}}]),t}(d.default);t.default=T},1387:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(3)),r=y(n(0)),o=y(n(1)),i=y(n(4)),l=y(n(5)),d=y(n(20)),s=n(69),u=y(n(80)),f=y(n(67)),h=y(n(29)),c=y(n(18)),I=y(n(78)),g=y(n(223)),R=n(57),v=n(229),p=y(n(60)),T=n(291),E=y(T),m=y(n(13)),_=y(n(54));function y(e){return e&&e.__esModule?e:{default:e}}var x=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=e.changes,r=e.mergeCells,o=e.range,i=(e.originCell,void 0),l=t.getSheetBySheetId(this.sheetId),d=void 0,h=void 0,c=void 0,I=[],g=void 0;if(l){for(h=0;h<r.length;h++)for(i=r[h],d=(0,s.getUnmergeCellsMutation)(i,l),c=0;c<d.length;c+=1)n(d[c]);for(h=0;h<a.length;h++)g=this.getCellDataDelta(a[h],l),I.push({rowIndex:a[h][0],colIndex:a[h][1],cellDataDelta:g});for(n(new f.default({gridRange:o,cellDataDeltaAtPositions:I})),h=0;h<r.length;h++)i=r[h],n(new u.default({startRowIndex:i.startRowIndex,endRowIndex:i.endRowIndex,startColIndex:i.startColIndex,endColIndex:i.endColIndex,sheetId:this.sheetId}));if((0,T.isNeedExtendFilterRange)([o])){var R=(0,E.default)();R.length>0&&n(R[0])}}}},{key:"getCellDataDelta",value:function(e,t){var n,a=e[0],r=e[1],o=e[2],i=e[3],l=e[4]||new _.default,d=l&&l.getUserEnteredFormat(),s=t.getCellDataAtPosition(a,r),u=void 0,f=new h.default,T=d&&d.getNumberFormat();if(o instanceof p.default)f.clearSlot(c.default.SLOT_EFFIECTIVE_VALUE),f.setSlot(c.default.SLOT_FORMULA,o.clone());else{var E=(0,R.parseValueWithStyle)(o,T);E.valueType===g.default.FORMULA?(f.clearSlot(c.default.SLOT_EFFIECTIVE_VALUE),f.setSlot(c.default.SLOT_FORMULA,p.default.string2FormulaModel(E.value,a,r,t.getSheetId()))):(f.setSlot(c.default.SLOT_EFFIECTIVE_VALUE,new I.default({type:Number(E.valueType),value:E.value})),f.clearSlot(c.default.SLOT_FORMULA))}if(null===s)u=null;else(u=s.getUserEnteredFormat())&&u.getDataValidation();n=(0,v.createCellFormatDelta)(u,d),f.setSlot(c.default.SLOT_USER_ENTERED_FORMAT_DELTA,n),f.setSlot(c.default.SLOT_HYPERLINK,i);var m=l.getTextFormatRuns();return f.setSlot(c.default.SLOT_RICH_TEXT_STYLE_RUN,m),f}},{key:"id",get:function(){return m.default.AUTO_FILL_REQUEST}}]),t}(d.default);t.default=x},1388:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(41)),r=R(n(3)),o=R(n(0)),i=R(n(1)),l=R(n(4)),d=R(n(5)),s=R(n(20)),u=R(n(232)),f=n(316),h=n(317),c=R(n(7)),I=R(n(13)),g=R(n(8));function R(e){return e&&e.__esModule?e:{default:e}}c.default.window;var v=function(e){function t(e,n){(0,o.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n)),i=e.sheetId;return n&&(a.behaviors=[{sheetId:i,gridRange:n.rangeSelections[0]}]),a}return(0,d.default)(t,e),(0,i.default)(t,[{key:"check",value:function(e){for(var t=0;t<this.behaviors.length;t++){var n=this.behaviors[t];if(!(n&&n.gridRange&&(0,h.filterPreCheckSupport)(n.gridRange)))return{isWarningOnly:!1,error:{title:"\u65e0\u6cd5\u7b5b\u9009",content:"\u672a\u627e\u5230\u53ef\u521b\u5efa\u7b5b\u9009\u7684\u533a\u57df\uff0c\u8bf7\u9009\u62e9\u6709\u6570\u636e\u7684\u533a\u57df\u540e\u91cd\u8bd5\u3002",btnTxt:"\u786e\u5b9a"}}}return null}},{key:"do",value:function(e,t,n){var r=(0,f.getRandomWorkbookRangeId)(),o=e.gridRange,i=e.sheetId,l=(0,h.handleFilterRange)(o),d=(0,a.default)(l,3),s=d[0],c=d[1],I=d[2];n(new u.default({gridRange:s,sheetId:i,delta:{hiddenRows:[],defaultFilterId:r,criteriaDelta:{}}}));var R=void 0;switch(c){case h.FILTER_RANGE_TYPE.SINGLE_CELL:R="single_cell_filter";break;case h.FILTER_RANGE_TYPE.ONE_ROW_PART:case h.FILTER_RANGE_TYPE.ONE_ROW_WHOLE:R=I?"single_merge_row_filter":"single_row_filter";break;case h.FILTER_RANGE_TYPE.SINGLE_MERGE_CELL:R="single_merge_cell_filter";break;default:R="multi_cell_filter"}g.default.tdwReport({opername:"doc_excel_editor",module:"excel_filter",action:R})}},{key:"id",get:function(){return I.default.SET_BASIC_FILTER_REQUEST}}]),t}(s.default);t.default=v},1389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(162)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=e.sheetId,r=t&&t.getSheetBySheetId(a),o=r&&r.getBasicFilter();if(o){var i=o.workbookRangeId;n(new s.default({sheetId:a,delta:{defaultFilterId:i}}))}}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return u.default.CLEAR_COMMENT_REQUEST}}]),t}(d.default);t.default=h},139:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(15)),s=c(n(11)),u=c(n(17)),f=c(n(30)),h=c(n(96));function c(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,u.default.UPDATE_CONDITIONAL_FORMAT_MUTATION,e));return n.sheetId=e.sheetId,n.ruleIndex=e.ruleIndex,n.rule=e.rule,n.oldRuleRanges=e.oldRuleRanges,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.rule.serialize(),this.oldRuleRanges.map(function(e){return e.serialize()})]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.updateConditionalFormatRule(this.ruleIndex,this.rule)}},{key:"invert",value:function(e){var n=e.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return n?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:n,oldRuleRanges:this.rule.ruleRanges})]:[]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(this.sheetId===e.sheetId){var a=[];return this.rule.ruleRanges.forEach(function(t){(t=t.clone()).sheetId===e.sheetId&&(e.type===d.default.ROWS?t.insertRows(e.index,e.amount):e.type===d.default.COLUMNS&&t.insertCols(e.index,e.amount),t.isValid()&&a.push(t))}),a.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:a,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(this.sheetId===e.sheetId){var a=[];return this.rule.ruleRanges.forEach(function(t){(t=t.clone()).sheetId===e.sheetId&&(e.type===d.default.ROWS?t.deleteRows(e.index,e.amount):e.type===d.default.COLUMNS&&t.deleteCols(e.index,e.amount),t.isValid()&&a.push(t))}),a.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:a,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,n){if(this.sheetId!==e.sheetId)return[this];var a=new s.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some(function(e){return e.isCross(a)})){var r=new s.default(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some(function(e){return e.contain(r)}))return[this];var o=[];return this.rule.ruleRanges.forEach(function(e){if(e.sheetId===a.sheetId&&e.isCross(a)){var t=e.startRowIndex,n=e.endRowIndex;e.startRowIndex<a.startRowIndex&&(o.push(new s.default(e.sheetId,e.startRowIndex,a.startRowIndex,e.startColIndex,e.endColIndex)),t=a.startRowIndex),a.endRowIndex<e.endRowIndex&&(o.push(new s.default(e.sheetId,a.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),n=a.endRowIndex),e.startColIndex<a.startColIndex&&o.push(new s.default(e.sheetId,t,n,e.startColIndex,a.endColIndex)),a.endColIndex<e.endColIndex&&o.push(new s.default(e.sheetId,t,n,a.endColIndex,e.endColIndex))}else o.push(e)}),0===o.length?[]:(o.sort(function(e,t){return e.startRowIndex<t.startRowIndex?-1:e.startColIndex<t.startColIndex?-1:e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex}),[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:o,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})])}return[this]}},{key:"transformWithMapRangeMutation",value:function(e,n){var a=[],r=[],o=[],i=[];return this.rule.ruleRanges.forEach(function(t){if(t.sheetId===e.sourceSheetId){var n=[],l=new s.default(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),d=t.getCross(l);d&&(n.push(d),r.push(d),i.push(new s.default(e.sourceSheetId,-1===e.row.to?d.startRowIndex:d.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?d.endRowIndex:d.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?d.startColIndex:d.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?d.endColIndex:d.endColIndex-e.column.from.startIndex+e.column.to)));var u=new s.default(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),f=t.getCross(u);f&&(n.push(f),o.push(f)),d||f?n.forEach(function(e){var n=t.startRowIndex,r=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(a.push(new s.default(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),n=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(a.push(new s.default(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),r=e.endRowIndex),t.startColIndex<e.startColIndex&&a.push(new s.default(t.sheetId,n,r,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&a.push(new s.default(t.sheetId,n,r,e.endColIndex,t.endColIndex))}):a.push(t)}}),a.length>0||i.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:[].concat(a,i),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat}),oldRuleRanges:this.oldRuleRanges})]:[]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,n){return this.sheetId===e.sheetId&&this.ruleIndex>=e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule,oldRuleRanges:this.oldRuleRanges})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,n){if(this.sheetId===e.sheetId){if(this.ruleIndex===e.ruleIndex)return[];this.ruleIndex>e.ruleIndex&&new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule,oldRuleRanges:this.oldRuleRanges})}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){return this.sheetId===e.sheetId&&this.ruleIndex===e.ruleIndex?t?[this]:[]:[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],ruleIndex:e[1],rule:h.default.deserialize(e[2]),oldRuleRanges:e[3].map(function(e){return s.default.deserialize(e)})})}}]),t}(f.default);I.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:h.default},3:{name:"oldRuleRanges",dataType:{type:Array,subType:s.default}}},t.default=I},1390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(20)),s=n(704),u=n(164),f=c(u),h=c(n(13));function c(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));o.sheetId=e.sheetId,o.delta=e.delta,o.rangeFilterId=e.rangeFilterId;var l=o.sheetId,d=o.rangeFilterId,s=o.delta;return o.behaviors=[{updateType:u.FiltersModelUpdateType.UPDATE,workbookRangeId:d,delta:s,sheetId:l},{updateType:u.FiltersModelUpdateType.RECAL,workbookRangeId:d,delta:s,sheetId:l}],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=e.sheetId,r=t.getSheetBySheetId(a);r&&(e.updateType===u.FiltersModelUpdateType.UPDATE&&this.doUpdateCriteria(e,t,n),e.updateType===u.FiltersModelUpdateType.RECAL&&this.doRecal(e,t,n,r))}},{key:"doRecal",value:function(e,t,n,a){var r=e.delta,o=e.updateType,i=e.workbookRangeId,l=e.sheetId,d=r.updateColumnCriteriaDelta,h=r.defaultFilterId,c=[];if(r.defaultFilterId){var I=a.getBasicFilter();if(!I||!d)return;var g=(0,u.updateFilterColumnCriteriaDelta)(d,I);c=(0,s.getFilteredRows)(g,t)}n(new f.default({delta:{defaultFilterId:h,hiddenRows:c},updateType:o,workbookRangeId:i,sheetId:l}))}},{key:"doUpdateCriteria",value:function(e,t,n){e.delta;var a=e.sheetId;t.getSheetBySheetId(a)&&n(new f.default(e))}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return h.default.UPDATE_COMMENT_REQUEST}}]),t}(d.default);t.default=I},1391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(11)),s=h(n(20)),u=h(n(233)),f=h(n(13));function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.behaviors=[],o.sheetId=e.sheetId,o.nonPersistingLocalChange=!1,n?(o.behaviors.push({sheetRangeId:e.sheetRangeId,gridRange:new d.default(o.sheetId,n.activeCell.rowIndex,n.activeCell.rowIndex,n.activeCell.colIndex,n.activeCell.colIndex),sheetRangeType:e.sheetRangeType}),o):(0,i.default)(o)}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){var t;return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u53ea\u80fd\u7ed9\u552f\u4e00\u5355\u5143\u683c\u8bbe\u7f6e\u6279\u6ce8\u3002"}},this.behaviors.length>1?t:function(){var e=window.SpreadsheetApp,t=e.view.canvas.excel.selectData.select,n=e.spreadsheet.activeSheet,a=void 0,r=void 0;if(null===n)return!1;var o=!0;t.xRange[0]===t.xRange[1]&&t.yRange[0]===t.yRange[1]||(o=!1);if(!o&&(a=n.getMerges())&&a.length>0)for(r=0;r<a.length;r++)if(a[r].startColIndex===t.xRange[0]&&a[r].endColIndex===t.xRange[1]&&a[r].startRowIndex===t.yRange[0]&&a[r].endRowIndex===t.yRange[1]){o=!0;break}return o}()?null:t}},{key:"do",value:function(e,t,n){t.getSheetBySheetId(this.sheetId)&&n(new u.default({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,gridRange:e.gridRange,sheetRangeType:e.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,padId:window.clientVars.padId}))}},{key:"id",get:function(){return f.default.DEFINE_COMMENT_RANGE_REQUEST}}]),t}(s.default);t.default=c},1392:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(20)),s=h(n(234)),u=h(n(173)),f=h(n(13));function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));o.behaviors=[];var l;return n?(o.sheetId=e.sheetId,l={sheetRangeId:e.sheetRangeId,sheetRangeType:u.default.COMMENT_RANGE},o.behaviors.push(l),o):(0,i.default)(o)}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=t.getSheetBySheetId(this.sheetId);a&&(null!==a.sheetRangeControl.getSheetRange(e.sheetRangeId)&&n(new s.default({sheetId:this.sheetId,sheetRangeId:e.sheetRangeId,nonPersistingLocalChange:!1})))}},{key:"id",get:function(){return f.default.DELETE_COMMENT_RANGE_REQUEST}}]),t}(d.default);t.default=c},1393:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(3)),r=R(n(0)),o=R(n(1)),i=R(n(4)),l=R(n(5)),d=R(n(20)),s=n(413),u=n(250),f=R(n(43)),h=R(n(11)),c=n(291),I=R(c),g=R(n(13));function R(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0;l=e.sheetId?e.sheetId:n&&n.activeCell.sheetId||"";var d=void 0,s=void 0,f=void 0;if(e.data&&e.data.length)for(d=0,s=e.data.length;d<s;d++){var c=e.data[d];f={gridRange:new h.default(l,c.rowIndex,c.rowIndex,c.colIndex,c.colIndex),options:{sheetId:l,userEnterValue:c.userEnterValue,linkUrl:(0,u.parseLinkUrl)(c.userEnterValue,!1)}},o.behaviors.push(f)}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=e.gridRange.sheetId,o=t.getSheetBySheetId(r),i=void 0;if(o){var l=e.options,d=e.gridRange,s=o.getCellDataAtPosition(d.startRowIndex,d.startColIndex),u=this.getCellDataDelta(s,l.userEnterValue,l.linkUrl,d.startRowIndex,d.startColIndex,r);n(new f.default({gridRange:d,cellDataDelta:u}));for(i=0,a=this.behaviors.length;i<a;i++){this.behaviors[i].options;var h=this.behaviors[i].gridRange;if((0,c.isNeedExtendFilterRange)([h])){!0;break}}var g=(0,I.default)();g.length>0&&n(g[0])}}},{key:"getCellDataDelta",value:function(e,t,n,a,r,o){return(0,s.getCellDataDelta)({cellData:e,sheetId:o,rowIndex:a,colIndex:r,linkUrl:n,userEnterValue:t})}},{key:"id",get:function(){return g.default.SET_RANGE_VALUE_REQUEST}}]),t}(d.default);t.default=v},1394:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(3)),r=v(n(0)),o=v(n(1)),i=v(n(4)),l=v(n(5)),d=v(n(20)),s=v(n(29)),u=v(n(39)),f=v(n(43)),h=v(n(32)),c=v(n(18)),I=n(51),g=n(158),R=v(n(13));function v(e){return e&&e.__esModule?e:{default:e}}var p=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0;if(e.gridRange)l={gridRange:e.gridRange,dataValidation:e.dataValidation},o.behaviors.push(l);else{if(!n)return(0,i.default)(o);for(var d=0,s=n.rangeSelections.length;d<s;d++)l={gridRange:n.rangeSelections[d],dataValidation:e.dataValidation},o.behaviors.push(l)}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a=this.getCellDataDelta(e.dataValidation),r=[e.gridRange],o=t.getSheetBySheetId(e.gridRange.sheetId);if(!a.isEmpty()&&o){r=(0,I.divideGridRangesByFilter)(r,o.getBasicFilter());for(var i=0,l=(r=(0,g.divideGridRangesByMerges)(r,o.getMerges())).length;i<l;i++)n(new f.default({gridRange:r[i],cellDataDelta:a}))}}},{key:"getCellDataDelta",value:function(e){var t=new u.default,n=new s.default;return null==e?(t.clearSlot(h.default.DATA_VALIDATION),n.clearSlot(c.default.SLOT_IS_DATA_VALID),n.setSlot(c.default.SLOT_USER_ENTERED_FORMAT_DELTA,t)):(t.setSlot(h.default.DATA_VALIDATION,e),n.setSlot(c.default.SLOT_USER_ENTERED_FORMAT_DELTA,t)),n}},{key:"id",get:function(){return R.default.SET_DATA_VALIDATION_REQUEST}}]),t}(d.default);t.default=p},1395:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(20)),s=c(n(13)),u=n(51),f=n(70),h=c(f);function c(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));if(o.sheetId=e.sheetId,o.type=e.type,e.dimensionRanges){o.behaviors=[];for(var l=Math.max(e.dimensionRanges.length,e.formDatas.length),d=0;d<l;d++)e.dimensionRanges[d].dimension===o.type&&o.behaviors.push({dimensionRange:e.dimensionRanges[d],formData:e.formDatas[d]})}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=t.getSheetBySheetId(e.dimensionRange.sheetId),o=void 0;if(r)for(a=(0,u.divideDimensionRangeByFilter)([e.dimensionRange],r.getBasicFilter()),o=0;o<a.length;o++){var i=a[o],l=e.formData;n(new h.default({ranges:[i],operation:[{slot:f.DIMENSION_PROPERTIES_SLOT.SLOT_FORMDATA,formData:l}],sheetId:this.sheetId,type:this.type}))}}},{key:"id",get:function(){return s.default.SET_DIMENSION_FORMDATA_REQUEST}}]),t}(d.default);t.default=I},1396:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(24)),r=f(n(3)),o=f(n(0)),i=f(n(1)),l=f(n(4)),d=f(n(5)),s=f(n(20)),u=f(n(13));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,o.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n));return a.behaviors=e.requests,a}return(0,d.default)(t,e),(0,i.default)(t,[{key:"do",value:function(e,t,n){e.run(t,n)}},{key:"predictRequestSize",value:function(e){var t,n=void 0,a=0;for(n=0,t=this.behaviors.length;n<t;n++)a+=this.behaviors[n].predictRequestSize(e);return a}},{key:"getRanges",value:function(e){var t,n=void 0,r=[];for(n=0,t=this.behaviors.length;n<t;n++)r=[].concat((0,a.default)(r),(0,a.default)(this.behaviors[n].getRanges(e)));return r}},{key:"check",value:function(e){var t,n=void 0,a=void 0;for(n=0,t=this.behaviors.length;n<t;n++)if(null!==(a=this.behaviors[n].check(e)))return a;return null}},{key:"id",get:function(){return u.default.MULTI_REQUEST}}]),t}(s.default);t.default=h},1397:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(20)),s=f(n(13)),u=f(n(236));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.ruleIndex=e.ruleIndex,o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var a=e.ruleIndex,r=t&&t.getActiveSheetId(),o=t&&t.getSheetBySheetId(r),i=o&&o.getConditionalFormatRule(),l=i&&i.getConditionalFormatRuleByRuleIndex(a);(i||l)&&n(new u.default({sheetId:r,ruleIndex:a,oldRuleRanges:l.ruleRanges}))}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return s.default.DELETE_CONDITIONAL_FORMAT_REQUEST}}]),t}(d.default);t.default=h},1398:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(20)),s=h(n(13)),u=h(n(139)),f=n(705);function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.ruleIndex=e.ruleIndex,o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var a=e.ruleIndex,r=e.rule,o=t&&t.getActiveSheetId(),i=t&&t.getSheetBySheetId(o),l=i&&i.getConditionalFormatRule(),d=l&&l.getConditionalFormatRuleByRuleIndex(a);if(l||d){var s=(0,f.requestRuleToMutationRule)(r);n(new u.default({sheetId:o,ruleIndex:a,rule:s,oldRuleRanges:d.ruleRanges}))}}},{key:"afterdo",value:function(){}},{key:"id",get:function(){return s.default.DELETE_CONDITIONAL_FORMAT_REQUEST}}]),t}(d.default);t.default=c},1399:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=m(n(3)),o=m(n(0)),i=m(n(1)),l=m(n(4)),d=m(n(5)),s=m(n(20)),u=n(164),f=m(u),h=m(n(11)),c=m(n(13)),I=n(704),g=m(n(290)),R=n(450),v=m(n(281)),p=m(n(69)),T=m(n(80)),E=m(n(191));function m(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(a||(a={}));var _=function(e){function t(e,n){(0,o.default)(this,t);var a=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e,n));a.gridRange=e.gridRange,a.sheetId=e.sheetId;var i=e.filter.rangeFilterId,d=e.filter.delta;return a.behaviors=[{type:"filter",updateType:u.FiltersModelUpdateType.UPDATE,workbookRangeId:i,delta:d,sheetId:a.sheetId},{type:"filter",updateType:u.FiltersModelUpdateType.RECAL,workbookRangeId:i,delta:d,sheetId:a.sheetId},{type:"reorder",reorderInfos:e.reorder.reorderInfos,hasTitle:e.reorder.hasTitle}],a}return(0,d.default)(t,e),(0,i.default)(t,[{key:"check",value:function(e){var t,n=null,a=e.getSheetBySheetId(this.sheetId),r=this.gridRange,o=void 0,i=void 0;if(null===a)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};for(t=a.getMerges(),i=0;i<t.length;i++)if(o=t[i],r.isCross(o)){var l="";return o.startColIndex===o.endColIndex&&o.startRowIndex!==o.endRowIndex?l="\u7eb5\u5411\u7684":o.startColIndex!==o.endColIndex&&o.startRowIndex===o.endRowIndex&&(l="\u6a2a\u5411\u7684"),n={isWarningOnly:!1,error:{title:"\u6392\u5e8f\u63d0\u793a",content:"\u4f60\u7684\u6392\u5e8f\u533a\u57df\u4e2d\u5305\u542b"+l+"\u5408\u5e76\u5355\u5143\u683c "+o.toString()+" \uff0c\u8bf7\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u540e\u518d\u8fdb\u884c\u6392\u5e8f\u3002"}}}return n}},{key:"do",value:function(e,t,n){var a=this.gridRange,r=t.getSheetBySheetId(this.sheetId),o=void 0,i=void 0,l=void 0,d=void 0;if(r)switch(e.type){case"filter":e.updateType===u.FiltersModelUpdateType.UPDATE&&this.doUpdateCriteria(e,t,n),e.updateType===u.FiltersModelUpdateType.RECAL&&this.doRecal(e,t,n,r);break;case"reorder":for(o=this.createUnmergeCellsMutations(t),l=0;l<o.length;l++)n(o[l]);var s=this.reorder(r,a,e.hasTitle,e.reorderInfos);for(i=this.createUpdateSheetRangeMutations(t,s,a),n(new v.default({sheetId:this.sheetId,range:a,operation:s})),i.length>0&&i.forEach(function(e){n(e)}),l=0;l<o.length;l++)o[l]instanceof p.default&&(d=o[l].startRowIndex,s.rules[d]?n(new T.default({sheetId:this.sheetId,startRowIndex:s.rules[d].to,endRowIndex:s.rules[d].to,startColIndex:o[l].startColIndex,endColIndex:o[l].endColIndex})):n(new T.default({sheetId:this.sheetId,startRowIndex:o[l].startRowIndex,endRowIndex:o[l].endRowIndex,startColIndex:o[l].startColIndex,endColIndex:o[l].endColIndex})))}}},{key:"doRecal",value:function(e,t,n,a){var r=e.delta,o=e.updateType,i=e.workbookRangeId,l=e.sheetId,d=r.updateColumnCriteriaDelta,s=r.defaultFilterId,h=[];if(r.defaultFilterId){var c=a.getBasicFilter();if(!c||!d)return;var g=(0,u.updateFilterColumnCriteriaDelta)(d,c);h=(0,I.getFilteredRows)(g,t)}n(new f.default({delta:{defaultFilterId:s,hiddenRows:h},updateType:o,workbookRangeId:i,sheetId:l}))}},{key:"doUpdateCriteria",value:function(e,t,n){e.delta;var a=e.sheetId;t.getSheetBySheetId(a)&&n(new f.default(e))}},{key:"createUnmergeCellsMutations",value:function(e){var t=[],n=e.getSheetBySheetId(this.sheetId);return new g.default({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,function(e){t.push(e)}),t}},{key:"reorder",value:function(e,t,n,a){var r=void 0,o={queue:[],rules:{}},i=void 0,l=void 0,d=[],s=[],u=e.getBasicFilter(),f=[];for(u&&(f=u.getHiddenRows()),i=t.startRowIndex<0?e.data.startRow:t.startRowIndex,l=t.endRowIndex<0?e.data.rowData.length-1:t.endRowIndex,n&&(i+=1),r=i;r<=l;r++)f.indexOf(r)>=0||(d.push({index:r}),s.push({index:r,value:this.getValue(e,r,a)}));for(s.sort((0,R.calc)(a)),r=0;r<s.length;r++)s[r].index!==d[r].index&&(o.queue.push(""+s[r].index),o.rules[""+s[r].index]={from:s[r].index,to:d[r].index});return o}},{key:"getValue",value:function(e,t,n){for(var a=[],r=0,o=void 0;r<n.length;r++)o=n[r].column,null!==e.data.rowData[t]&&(e.getCellDataAtPosition(t,o)?a.push(e.data.rowData[t]?e.data.rowData[t].values[o].getEffectiveValue():null):a.push(null));return a}},{key:"createUpdateSheetRangeMutations",value:function(e,t,n){var a=[],r=e.getSheetBySheetId(this.sheetId),o=this.sheetId,i=void 0,l=void 0,d=void 0,s=void 0,u=void 0;for(i=0;i<t.queue.length;i++)for(d=t.queue[i],l=n.startColIndex;l<=n.endColIndex;l++)(s=r.getCellDataAtPosition(t.rules[d].from,l))&&(u=s.getSheetRange())&&u.forEach(function(e){var n,r,i;n=e,r=t.rules[d].to,i=l,a.push(new E.default({sheetId:o,sheetRangeId:n.id,sheetRangeType:n.type,gridRange:new h.default(o,r,r,i,i),padId:window.clientVars.padId}))});return a}},{key:"id",get:function(){return c.default.REORDER_FILTER_REQUEST}}]),t}(s.default);t.default=_},1400:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(20)),s=h(n(13)),u=n(163),f=h(u);function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){n(new f.default({type:u.SHEET_PROPERTIES_SLOT.SLOT_HIDE_GRIDLINES,value:e.hideGridlines,sheetId:e.sheetId}))}},{key:"id",get:function(){return s.default.SET_HIDE_GRIDLINES_REQUEST}}]),t}(d.default);t.default=c},15:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.ROWS="ROWS",e.COLUMNS="COLUMNS"}(a||(a={})),t.default=a},155:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=new RegExp("[^#a-f\\d]","gi"),r=new RegExp("^#?[a-f\\d]{3}[a-f\\d]?$|^#?[a-f\\d]{6}([a-f\\d]{2})?$","i");function o(e){if("string"!==typeof e||a.test(e)||!r.test(e))throw new TypeError("Expected a valid hex string");var t=1;if(8===(e=e.replace(/^#/,"")).length&&(t=parseInt(e.slice(6,8),16)/255,e=e.substring(0,6)),4===e.length){var n=e.slice(3,4);t=parseInt(n+n,16)/255,e=e.substring(0,3)}3===e.length&&(e=e[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var o=parseInt(e,16);return{red:o>>16,green:o>>8&255,blue:255&o,alpha:t}}t.compareColor=function(e,t){if(null==e)return 1;if(null==t)return-1;var n="string"===typeof e?o(e):e,a="string"===typeof t?o(t):t,r=.299*n.red+.587*n.green+.114*n.blue,i=.299*a.red+.587*a.green+.114*a.blue;return r>i?-1:r===i?0:1},t.hex2rgba=o,t.rgba2hex=function(e,t,n,a){var r=/%$/.test(a);if(void 0!==a&&(a=parseFloat(a)),"number"!==typeof e||"number"!==typeof t||"number"!==typeof n)throw new TypeError("Expected three numbers below 256");var o=a;if("number"===typeof a){if(!r&&o>=0&&o<=1)o=Math.round(255*o);else{if(!(r&&o>=0&&o<=100))throw new TypeError("Expected alpha value ("+o+") as a fraction or percentage");o=Math.round(255*o/100)}o=(256|o).toString(16).slice(1)}else o="";if(1!=a&&void 0!==a){var i=Math.floor(a*parseInt(e+"")+255*(1-a)),l=Math.floor(a*parseInt(t+"")+255*(1-a)),d=Math.floor(a*parseInt(n+"")+255*(1-a));return"#"+("0"+i.toString(16)).slice(-2)+("0"+l.toString(16)).slice(-2)+("0"+d.toString(16)).slice(-2)}return"#"+(n|t<<8|e<<16|1<<24).toString(16).slice(1)},t.transparentColor=function(e,t){var n=parseInt(e.substring(1,3),16),a=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16);return n=parseInt(String(255*(1-t)+n*t)),a=parseInt(String(255*(1-t)+a*t)),r=parseInt(String(255*(1-t)+r*t)),"#"+n.toString(16)+a.toString(16)+r.toString(16)},t.colorValues=function(e){if(""===e||null===e)return null;if("transparent"===e.toLowerCase())return[0,0,0,0];if("#"===e[0])return e.length<7&&(e="#"+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]+(e.length>4?e[4]+e[4]:"")),[parseInt(e.substr(1,2),16),parseInt(e.substr(3,2),16),parseInt(e.substr(5,2),16),e.length>7?parseInt(e.substr(7,2),16)/255:1];if(0===e.indexOf("rgb")){-1===e.indexOf("rgba")&&(e+=",1");var t=e.match(/[\.\d]+/g);return t&&t.map(function(e){return+e})}return null}},156:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(9)),r=l(n(0)),o=l(n(1)),i=l(n(224));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,e),t.top=t.top||null,t.bottom=t.bottom||null,t.left=t.left||null,t.right=t.right||null,t.diagDown=t.diagDown||null,t.diagUp=t.diagUp||null,this.setProperties(t)}return(0,o.default)(e,[{key:"setProperties",value:function(e){var t=this;return(0,a.default)(e).forEach(function(n){"undefined"!==typeof e[n]&&t.setBorder(n,e[n])}),this}},{key:"setBorder",value:function(e,t){return t?t instanceof i.default?this[e]=t:this[e]?this[e].setProperties(t):this[e]=new i.default(t):this[e]=null,this}},{key:"clear",value:function(){return this.top=null,this.bottom=null,this.left=null,this.right=null,this.diagDown=null,this.diagUp=null,this}},{key:"clearBorder",value:function(e){return this[e]=null,this}},{key:"setTop",value:function(e){return this.setBorder("top",e)}},{key:"clearTop",value:function(){return this.clearBorder("top")}},{key:"setBottom",value:function(e){return this.setBorder("bottom",e)}},{key:"clearBottom",value:function(){return this.clearBorder("bottom")}},{key:"setLeft",value:function(e){return this.setBorder("left",e)}},{key:"clearLeft",value:function(){return this.clearBorder("left")}},{key:"setRight",value:function(e){return this.setBorder("right",e)}},{key:"clearRight",value:function(){return this.clearBorder("right")}},{key:"setDiagDown",value:function(e){return this.setBorder("diagDown",e)}},{key:"clearDiagDown",value:function(){return this.clearBorder("diagDown")}},{key:"setDiagUp",value:function(e){return this.setBorder("diagUp",e)}},{key:"clearDiagUp",value:function(){return this.clearBorder("diagUp")}},{key:"clone",value:function(){return new e({top:this.top?this.top.clone():null,bottom:this.bottom?this.bottom.clone():null,left:this.left?this.left.clone():null,right:this.right?this.right.clone():null,diagDown:this.diagDown?this.diagDown.clone():null,diagUp:this.diagUp?this.diagUp.clone():null})}},{key:"toString",value:function(){return(null!=this.top?this.top._key:"")+","+(null!=this.bottom?this.bottom._key:"")+","+(null!=this.left?this.left._key:"")+","+(null!=this.right?this.right._key:"")}},{key:"_key",get:function(){return this.toString()}}]),e}();d.protoMap={0:{name:"top",dataType:i.default},1:{name:"bottom",dataType:i.default},2:{name:"left",dataType:i.default},3:{name:"right",dataType:i.default},4:{name:"diagDown",dataType:i.default},5:{name:"diagUp",dataType:i.default}},t.default=d},157:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LIST="list",e.NUMBER_INT="whole",e.NUMBER_FLOAT_AND_INT="decimal",e.TEXT_LENGTH="textLength",e.DATE="date",e.CUSTOM="custom",e.CUSTOM_NUM_PHONE="custom.numphone",e.CUSTOM_ID_CARD="custom.numidcard",e.CUSTOM_TEXT_CONTAINS="custom.textcontains",e.CUSTOM_TEXT_MAIL="custom.textmail",e.CUSTOM_TEXT_URL="custom.texturl",e.CUSTOM_TEXT_GENDER="custom.textgender",e.CUSTOM_MUST_FLOAT="custom.mustfloat"}(a||(a={})),t.default=a},158:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(24));t.divideGridRangesByMerges=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{needContainSubCells:!1,onlyTakeMasterRange:!0},r=[],o=[],l=[];return e.forEach(function(e){var o=i(e,t,n);r.push.apply(r,(0,a.default)(o.normalGridRanges)),l.push.apply(l,(0,a.default)(o.mergeGridRanges))}),l.forEach(function(e){for(var t=!1,n=void 0,a=0;a<o.length;a++)if(n=o[a],e.sheetId===n.sheetId&&e.startRowIndex===n.startRowIndex&&e.endRowIndex===n.endRowIndex&&e.startColIndex===n.startColIndex&&e.endColIndex===n.endColIndex){t=!0;break}t||o.push(e)}),[].concat(o,r)},t.divideGridRangeByMerges=i;var r=o(n(11));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{needContainSubCells:!1,onlyTakeMasterRange:!1},a=void 0,o=[],i=[],l=function(e){return new r.default(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex)},d=0;d<t.length;d++)a=t[d],e.isCross(a)&&(i.push(a.clone()),n.needContainSubCells?n.onlyTakeMasterRange?o.push(l(a)):o.push(a.clone()):e.contain(a)&&(n.onlyTakeMasterRange?o.push(l(a)):o.push(a.clone())));for(var s=function(e,t,n){if(!e||!e.length)return!1;for(var a=null,r=0;r<e.length;r++)if((a=e[r]).startColIndex<=t&&t<=a.endColIndex&&a.startRowIndex<=n&&n<=a.endRowIndex)return!0;return!1},u=function(e,t,n,a){for(;e<=n;){if(s(a,e,t)){e--;break}e++}return Math.min(e,n)},f=[],h=[],c=e.startRowIndex;c<=e.endRowIndex;c++){h=[];for(var I=e.startColIndex;I<=e.endColIndex;I++)if(!s(t,I,c)){var g=I,R=I;R=u(R,c,e.endColIndex,i),h.push(new r.default(e.sheetId,c,c,g,R)),I=R+1}f.push(h)}for(var v=function(e,t){var n=null,a=null,r=0,o=0;for(r=0;r<e.length;r++)for(n=e[r],o=0;o<t.length;o++)if(a=t[o],n.sheetId===a.sheetId&&n.startColIndex===a.startColIndex&&n.endColIndex===a.endColIndex){a.startRowIndex=n.startRowIndex,e.splice(r,1),r-=1;break}},p=0;p<f.length-1;p++){v(f[p],f[p+1])}return{normalGridRanges:f.reduce(function(e,t){return e.concat(t)},[]),mergeGridRanges:o}}},160:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserialize=t.serialize=void 0;var a=d(n(25)),r=d(n(41)),o=d(n(31)),i=d(n(63)),l=d(n(9));function d(e){return e&&e.__esModule?e:{default:e}}t.serialize=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=void 0,u=void 0,f=void 0;if(null==n&&t&&t.constructor&&t.constructor.protoMap&&(n=t.constructor),null!=t)if(n)if("sheetId"===n)f=d.notReplaceSheetId?t:"";else if(n===String||n===Number||"undefined"!==typeof n.NaN||n===Boolean)f=t;else if(n.type===Array){if(null==n.subType)throw new Error("must provide subType");for(f=n.saveType===Object?{l:t.length}:[],s=0,u=t.length;s<u;s++)f[s]=e(t[s],n.subType,d)}else if(n.protoMap){f=[];var h=[],c=[],I=n.protoMap,g=void 0,R=(0,l.default)(I),v=void 0;for(s=0,u=R.length;s<u;s++){var p=e(t[(g=I[v=R[s]]).name],g.dataType,d);void 0!==p&&null!==p&&(h[h.length]=Number(v),c[c.length]=p)}f=[h,c]}else if(n.type===Object&&null!=n.subType){f={};var T=(0,l.default)(t),E=void 0;for(s=0,u=T.length;s<u;s++)f[E=T[s]]=e(t[E],n.subType,d)}else if(n.type===i.default){f=[];var m=!0,_=!1,y=void 0;try{for(var x,S=(0,o.default)(t.entries());!(m=(x=S.next()).done);m=!0){var O=(0,r.default)(x.value,2),C=O[0],D=e(O[1],n.subType,d);f.push([C,D])}}catch(A){_=!0,y=A}finally{try{!m&&S.return&&S.return()}finally{if(_)throw y}}}else if(n===Array)f=t;else if(n===Object)f=t;else if(Array.isArray(n)){for(f=[],s=0,u=n.length;s<u;s++)if(t.constructor===n[s]){f[0]=s;break}if(null==f[0])throw new Error("can not match one of union types");f[1]=e(t,n[f[0]],d)}else{if(!n||"function"!==typeof n.serialize)throw new Error("serialize data error");f=n.serialize(t,e,d)}else if(Array.isArray(t))for(f=[],s=0,u=t.length;s<u;s++)f[s]=e(t[s],null,d);else if("object"===("undefined"===typeof t?"undefined":(0,a.default)(t))){f={};var M=(0,l.default)(t),w=void 0;for(s=0,u=M.length;s<u;s++)f[w=M[s]]=e(t[w],null,d)}else f=t;else f=void 0;return f},t.deserialize=function e(t,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=void 0,o=void 0,d=void 0;if(null==n)throw new Error("must provide dataType");if(null!=t)if("sheetId"===n)d=a.notReplaceSheetId?t:a.sheetId?a.keyframeVer>=4&&""===t||a.keyframeVer<4?a.sheetId:t:"";else if(n===String||n===Number||"undefined"!==typeof n.NaN||n===Boolean)d=t;else if(n.type===Array){if(null==n.subType)throw new Error("must provide subType");if(d=[],n.saveType===Object){var s=(0,l.default)(t),u=void 0;try{d.length=null!=t.l?t.l:t.length,delete t.l}catch(E){}for(r=0,o=s.length;r<o;r++)d[u=s[r]]=e(t[u],n.subType,a);delete d.l}else for(r=0,o=t.length;r<o;r++)d[r]=e(t[r],n.subType,a)}else if(n.protoMap){d={};var f=n.protoMap,h=void 0,c=t[0],I=t[1];for(r=0,o=c.length;r<o;r++)if(h=f[c[r]]){var g=e(I[r],h.dataType,a);void 0!==g&&(d[h.name]=g)}n.type!==Object&&(d="function"===typeof n.newInstance?n.newInstance(d,a):new n(d,a))}else if(n.type===Object&&null!=n.subType){d={};var R=(0,l.default)(t),v=void 0;for(r=0,o=R.length;r<o;r++)d[v=R[r]]=e(t[v],n.subType,a)}else if(n.type===i.default){d=new i.default;for(var p=0;p<t.length;p++){var T=t[p];d.set(T[0],e(T[1],n.subType,a))}}else if(n===Array)d=t;else if(n===Object)d=t;else if(Array.isArray(n)){if(null==t[0])throw new Error("can not match one of union types");d=e(t[1],n[t[0]],a)}else{if(!n||"function"!==typeof n.deserialize)throw new Error("deserialize data error");d=n.deserialize(t,e,a)}else d=void 0;return d}},161:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(24)),r=R(n(3)),o=R(n(0)),i=R(n(1)),l=R(n(4)),d=R(n(59)),s=R(n(5)),u=n(113),f=R(n(15)),h=n(1132),c=R(n(17)),I=R(n(30)),g=R(n(189));function R(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,c.default.INSERT_DIMENSION_MUTATION,e));return n.index=e.index,n.amount=e.amount,n.type=e.type,n.sheetId=e.sheetId,n}return(0,s.default)(t,e),(0,i.default)(t,[{key:"serialize",value:function(){return[this.index,this.amount,this.sheetId,this.type]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){if(this.type!==f.default.ROWS&&this.type!==f.default.COLUMNS)return!1;var t=e.properties.getGridProperties(),n=this.type===f.default.ROWS?t.rowCount:t.columnCount;return!(!(0,u.isNumber)(this.index)||this.index<0||this.index>n)&&!(!(0,u.isNumber)(this.amount)||this.amount<=0)}},{key:"runOnSheet",value:function(e){this.type===f.default.ROWS?e.insertRows(this.index,this.amount):this.type===f.default.COLUMNS&&e.insertCols(this.index,this.amount)}},{key:"invert",value:function(e){var t=e.getSheetBySheetId(this.sheetId),n=[];if(n.push(new g.default({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),!t)return n;var r=(0,h.getDirectlyAffectedDataByDimensionOperation)(t,h.DIMENSION_OPERATION_TYPE.INSERT,this.type,this.index),o=(0,h.getMutationsByAffectedData)(r,h.DIMENSION_OPERATION_TYPE.UNDO_INSERT,this.type,this.index,this.amount);return n=[].concat((0,a.default)(n),(0,a.default)(o))}},{key:"transform",value:function(e,n){var o=(0,h.getDirectlyAffectedDataWithCollabMutation)(e,h.DIMENSION_OPERATION_TYPE.INSERT,this.sheetId,this.type,this.index),i=(0,d.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"transform",this).call(this,e,n),l=(0,h.getMutationsByAffectedData)(o,h.DIMENSION_OPERATION_TYPE.INSERT,this.type,this.index,this.amount);return[].concat((0,a.default)(i),(0,a.default)(l))}},{key:"isConflictWithCollabMutation",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(!this.isConflictWithCollabMutation(e))return[this];var a=this.index;return(this.index>e.index||n&&this.index===e.index)&&(a=this.index+e.amount),[new t({index:a,amount:this.amount,type:this.type,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){return this.isConflictWithCollabMutation(e)?this.index<=e.index?[this]:this.index>=e.index+e.amount?[new t({index:this.index-e.amount,amount:this.amount,type:this.type,sheetId:this.sheetId})]:[]:[this]}}],[{key:"deserialize",value:function(e){return new t({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})}}]),t}(I.default);v.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}},t.default=v},162:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(17)),s=h(n(30)),u=h(n(232)),f=n(174);function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.DELETE_FILTER_MUTATION,e));return n.sheetId=e.sheetId,n.delta=e.delta,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,[this.delta.defaultFilterId||""]]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.getSheetBySheetId(t);return n?[n]:[]}},{key:"invert",value:function(e){var t=this.delta.defaultFilterId,n=this.sheetId,a=e.getSheetBySheetId(n);if(!a)return[];if(t){var r=a.getBasicFilter();if(r){var o=r.getRange(),i=r.getHiddenRows(),l=r.criteriaMap,d={};return l.forEach(function(e,t){var n=e.visibleValues;d[t]={visibleValues:n}}),[new u.default({sheetId:n,gridRange:o,delta:{defaultFilterId:t,hiddenRows:i,criteriaDelta:d}})]}}return[]}},{key:"runOnSheet",value:function(e){var t=this.delta.defaultFilterId;e.getBasicFilter();t&&e.clearBasicFilter()}},{key:"transformWithDefineFilterMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return(0,f.isSame)(e.sheetId,this.sheetId)?[]:[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],delta:{defaultFilterId:e[1][0]}})}}]),t}(s.default);c.protoMap={0:{name:"sheetId",dataType:String},1:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String}}}}},t.default=c},163:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.SHEET_PROPERTIES_SLOT=void 0;var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(17)),s=c(n(30)),u=c(n(15)),f=c(n(35)),h=c(n(669));function c(e){return e&&e.__esModule?e:{default:e}}var I=t.SHEET_PROPERTIES_SLOT=void 0;!function(e){e[e.SLOT_NAME=1]="SLOT_NAME",e[e.SLOT_NUMBER_OF_COLUMNS=2]="SLOT_NUMBER_OF_COLUMNS",e[e.SLOT_IS_RTL=3]="SLOT_IS_RTL",e[e.SLOT_HIDE_GRIDLINES=4]="SLOT_HIDE_GRIDLINES",e[e.SLOT_FROZEN_ROWS=5]="SLOT_FROZEN_ROWS",e[e.SLOT_FROZEN_COLUMNS=6]="SLOT_FROZEN_COLUMNS",e[e.SLOT_IS_HIDDEN=7]="SLOT_IS_HIDDEN",e[e.SLOT_COLOR=8]="SLOT_COLOR",e[e.SLOT_BACKGROUND_COLOR=9]="SLOT_BACKGROUND_COLOR",e[e.SLOT_TEXT_DIRECTION=10]="SLOT_TEXT_DIRECTION",e[e.SLOT_HYPERLINK_DISPLAY_TYPE=11]="SLOT_HYPERLINK_DISPLAY_TYPE",e[e.SLOT_TEXT_ROTATION=12]="SLOT_TEXT_ROTATION",e[e.SLOT_BOLD_WEIGHT=13]="SLOT_BOLD_WEIGHT",e[e.SLOT_NUMBER_OF_ROWS=14]="SLOT_NUMBER_OF_ROWS"}(I||(t.SHEET_PROPERTIES_SLOT=I={}));var g=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.SET_SHEET_PROPERTIES_MUTATION,e));return n.type=e.type,n.slotOperation=null!=e.slotOperation?e.slotOperation:h.default.SET_SLOT,n.value=e.value,n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.type,null!=this.slotOperation?this.slotOperation:h.default.SET_SLOT,this.value]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"runOnSheet",value:function(e){switch(this.type){case I.SLOT_FROZEN_ROWS:e.setFrozenRowCount(this.value);break;case I.SLOT_FROZEN_COLUMNS:e.setFrozenColCount(this.value);break;case I.SLOT_HIDE_GRIDLINES:e.setHideGridlines(this.value);break;case I.SLOT_NAME:e.setTitle(this.value);break;case I.SLOT_NUMBER_OF_COLUMNS:e.setColCount(this.value);break;case I.SLOT_NUMBER_OF_ROWS:e.setRowCount(this.value);break;default:console.log("\u6682\u65f6\u672a\u5f00\u53d1\u7684\u529f\u80fd")}}},{key:"invert",value:function(e){var n=[],a=e.getSheetBySheetId(this.sheetId);if(null===a)return n;switch(this.type){case I.SLOT_FROZEN_ROWS:n.push(new t({type:I.SLOT_FROZEN_ROWS,value:a.getFrozenRowCount(),sheetId:this.sheetId}));break;case I.SLOT_FROZEN_COLUMNS:n.push(new t({type:I.SLOT_FROZEN_COLUMNS,value:a.getFrozenColCount(),sheetId:this.sheetId}));break;case I.SLOT_HIDE_GRIDLINES:n.push(new t({type:I.SLOT_HIDE_GRIDLINES,value:a.getHideGridlines(),sheetId:this.sheetId}));break;case I.SLOT_NAME:n.push(new t({type:I.SLOT_NAME,value:a.getTitle(),sheetId:this.sheetId}));break;default:console.log("\u6682\u65f6\u4e3a\u5f00\u53d1\u7684\u529f\u80fd")}return n}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a=[],r=this.value;if(this.type===I.SLOT_FROZEN_COLUMNS&&e.type===u.default.COLUMNS){if(!(r>=e.index))return[this];r+=e.amount}else{if(this.type!==I.SLOT_FROZEN_ROWS||e.type!==u.default.ROWS)return[this];if(!(r>=e.index))return[this];r+=e.amount}return a.push(new t({type:this.type,value:r,sheetId:this.sheetId})),a}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=[],r=void 0,o=this.value;if(this.type===I.SLOT_FROZEN_COLUMNS&&e.type===u.default.COLUMNS)(r=new f.default(this.sheetId,0,o,u.default.COLUMNS)).delete(e.index,e.amount),o=Math.max(0,r.endIndex);else{if(this.type!==I.SLOT_FROZEN_ROWS||e.type!==u.default.ROWS)return[this];(r=new f.default(this.sheetId,0,o,u.default.ROWS)).delete(e.index,e.amount),o=Math.max(0,r.endIndex)}return a.push(new t({type:this.type,value:o,sheetId:this.sheetId})),a}},{key:"transformWithSetSheetPropertiesMutation",value:function(e,t){var n=[];return e.type!==this.type?n.push(this):t&&n.push(this),n}},{key:"transformWithInsertSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],type:e[1],slotOperation:e[2],value:e[3]})}}]),t}(s.default);g.protoMap={0:{name:"sheetId",dataType:String},1:{name:"type",dataType:Number},2:{name:"value",dataType:String}},t.default=g},164:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FiltersModelUpdateType=void 0;var a=I(n(3)),r=I(n(0)),o=I(n(1)),i=I(n(4)),l=I(n(5));t.updateFilterColumnCriteriaDelta=g;var d,s=I(n(17)),u=I(n(30)),f=I(n(186)),h=I(n(11)),c=n(174);function I(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var n=e.criteria,a=e.columnIndex,r=e.clear,o=t.getColFilterCriteria(a);if(r)return t.deleteColFilterCriteria(a),t;if(n){var i=n.visibleValues;i&&(o||(o=new f.default({})),o.setVisibleValues(i),t.setColFilterCriteria(a,o))}return t}!function(e){e[e.UPDATE=1]="UPDATE",e[e.RECAL=2]="RECAL"}(d||(t.FiltersModelUpdateType=d={}));var R={0:{name:"columnIndex",dataType:Number},1:{name:"clear",dataType:Boolean},2:{name:"criteria",dataType:{0:{name:"visibleByDefault",dataType:Boolean},1:{name:"visibleValues",dataType:Array,subType:String}}}},v=function(e){var t=[e.defaultFilterId||""];return e.hiddenRows?t.push(e.hiddenRows):t.push(null),e.range?t.push(e.range.serialize()):t.push(null),e.updateColumnCriteriaDelta?t.push([e.updateColumnCriteriaDelta.columnIndex,e.updateColumnCriteriaDelta.clear?1:0,e.updateColumnCriteriaDelta.criteria?[!1===e.updateColumnCriteriaDelta.criteria.visibleByDefault?0:1,e.updateColumnCriteriaDelta.criteria.visibleValues||[]]:null]):t.push(null),t},p=function(e){var t={defaultFilterId:e[0]};return e[1]&&(t.hiddenRows=e[1]),e[2]&&(t.range=h.default.deserialize(e[2])),e[3]&&(t.updateColumnCriteriaDelta={columnIndex:e[3][0],clear:!!e[3][1],criteria:e[3][2]?{visibleByDefault:!!e[3][2][0],visibleValues:e[3][2][1]}:void 0}),t},T=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,s.default.UPDATE_FILTER_MUTATION,e));return n.workbookRangeId=e.workbookRangeId,n.updateType=e.updateType,n.sheetId=e.sheetId,n.delta=e.delta,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.workbookRangeId,this.updateType,this.sheetId,v(this.delta)]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.getSheetBySheetId(t);return n?[n]:[]}},{key:"invert",value:function(e){if(this.updateType===d.UPDATE||this.updateType===d.RECAL){var n=this.delta.defaultFilterId,a=this.sheetId,r=this.workbookRangeId,o=this.updateType,i=e.getSheetBySheetId(a);if(!i)return[];var l=i.getBasicFilter();if(n&&l){var s=this.delta,u=s.hiddenRows,f=s.updateColumnCriteriaDelta,h=s.range;if(f){var c=f.columnIndex,I=l.getColFilterCriteria(c),g={columnIndex:c};return I?g.criteria=I:g.clear=!0,[new t({workbookRangeId:r,sheetId:a,updateType:o,delta:{updateColumnCriteriaDelta:g,defaultFilterId:n,range:l.range.clone()}})]}if(u)return[new t({workbookRangeId:r,sheetId:a,updateType:o,delta:{hiddenRows:l.getHiddenRows(),defaultFilterId:n,range:l.range.clone()}})];if(h)return[new t({workbookRangeId:r,sheetId:a,updateType:o,delta:{range:l.getRange(),defaultFilterId:n}})]}}return[]}},{key:"runOnSheet",value:function(e){this.updateType!==d.UPDATE&&this.updateType!==d.RECAL||this.delta.defaultFilterId&&this.updateBasicFilter(this.delta,e)}},{key:"updateBasicFilter",value:function(e,t){var n=e.hiddenRows,a=e.updateColumnCriteriaDelta,r=e.defaultFilterId,o=e.range,i=t.getBasicFilter();if(r&&i){if(a){var l=g(a,i);t.setBasicFilter(l)}n&&(i.setHiddenRows(n),t.hideRowsByFilter(n)),o&&i.setRange(o)}}},{key:"transformWithInsertDimensionMutation",value:function(e,t){if(!(0,c.isSame)(e.sheetId,this.sheetId))return[this];var n=e.type,a=e.index,r=e.amount,o=(e.sheetId,this.delta),i=o.range;o.hiddenRows,o.updateColumnCriteriaDelta;if(i){var l=i.clone();l.insertDimension({type:n,index:a,amount:r})}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return(0,c.isSame)(e.sheetId,this.sheetId),[this]}},{key:"transformWithDefineFilterMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({workbookRangeId:e[0],updateType:e[1],sheetId:e[2],delta:p(e[3])})}}]),t}(u.default);T.protoMap={0:{name:"workbookRangeId",dataType:String},1:{name:"updateType",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String},1:{name:"hiddenRows",dataType:Array,subType:Number},2:{name:"updateColumnCriteriaDelta",dataType:Object,protoMap:R},3:{name:"range",dataType:h.default}}}}},t.default=T,t.FiltersModelUpdateType=d},1642:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertRange2Span=function(e){if(!e)return;var t={};return t.row=e.from.row,t.col=e.from.col,t.rowspan=e.to.row-e.from.row+1,t.colspan=e.to.col-e.from.col+1,t},t.convertRanges2Span=function(e){if(!e)return;var t={};return t.row=e.startRowIndex,t.col=e.startColIndex,t.rowspan=e.endRowIndex-e.startRowIndex+1,t.colspan=e.endColIndex-e.startColIndex+1,t}},1643:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.exportProcessFormula=function(e){var t=[];if(r.forEach(function(n){-1!=e.indexOf(n)&&t.push(n)}),0==t.length)return e;var n={},o=-1,i=e.replace(/'.*?'!|"[^"]*"/g,function(e){if("'!"===e.slice(e.length-2))return e;var t=(0,a.numberToChineseNumberString)(++o);return n[t]=e,t}),l="(\\b"+t.join("\\b)|(\\b")+"\\b)",d=new RegExp(l,"ig");return i=i.replace(d,function(e){return"_xlfn."+e}),e=i.replace(/[\u96f6\u4e00\u4e8c\u4e09\u56db\u4e94\u516d\u4e03\u516b\u4e5d]+/g,function(e){return n[e]||""})},t.importProcessFormula=function(e){return e.replace(/(\_xlfn\.)|(\_xludf\.)/gi,"")};var a=n(44),r=["AVERAGEIF","COUNTIFS","IFERROR","SUMIFS","ACOT","ACOTH","CEILING.MATH","CEILING.PRECISE","CONCAT","COT","DAYS","ERF.PRECISE","ERFC.PRECISE","FLOOR.MATH","FLOOR.PRECISE","ISOWEEKNUM","MODE.SNGL","PERCENTRANK.EXC","PERCENTRANK.INC","RANK.AVG","RANK.EQ","TEXTJOIN","UNICHAR","UNICODE","XOR"]},17:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.INSERT_DIMENSION_MUTATION=0]="INSERT_DIMENSION_MUTATION",e[e.DELETE_DIMENSION_MUTATION=1]="DELETE_DIMENSION_MUTATION",e[e.SET_DIMENSION_PROPERTIES_MUTATION=2]="SET_DIMENSION_PROPERTIES_MUTATION",e[e.SET_RANGE_MUTATION=3]="SET_RANGE_MUTATION",e[e.SET_CELL_PROPERTIES_MUTATION=4]="SET_CELL_PROPERTIES_MUTATION",e[e.MERGE_CELLS_MUTATION=5]="MERGE_CELLS_MUTATION",e[e.UNMERGE_CELLS_MUTATION=6]="UNMERGE_CELLS_MUTATION",e[e.UPDATE_FILTERS_MODEL_MUTATION=7]="UPDATE_FILTERS_MODEL_MUTATION",e[e.ADD_EMBEDDED_OBJECT_MUTATION=8]="ADD_EMBEDDED_OBJECT_MUTATION",e[e.DELETE_EMBEDDED_OBJECT_MUTATION=9]="DELETE_EMBEDDED_OBJECT_MUTATION",e[e.UPDATE_EMBEDDED_OBJECT_MUTATION=10]="UPDATE_EMBEDDED_OBJECT_MUTATION",e[e.INSERT_SHEET_MUTATION=11]="INSERT_SHEET_MUTATION",e[e.DELETE_SHEET_MUTATION=12]="DELETE_SHEET_MUTATION",e[e.MOVE_SHEET_MUTATION=13]="MOVE_SHEET_MUTATION",e[e.SET_SHEET_PROPERTIES_MUTATION=14]="SET_SHEET_PROPERTIES_MUTATION",e[e.UPDATE_ALL_SHEETS_MUTATION=15]="UPDATE_ALL_SHEETS_MUTATION",e[e.DEFINE_SHEET_RANGE_MUTATION=16]="DEFINE_SHEET_RANGE_MUTATION",e[e.DELETE_SHEET_RANGE_MUTATION=17]="DELETE_SHEET_RANGE_MUTATION",e[e.UPDATE_SHEET_RANGE_MUTATION=18]="UPDATE_SHEET_RANGE_MUTATION",e[e.SET_WORKBOOK_PROPERTIES_MUTATION=19]="SET_WORKBOOK_PROPERTIES_MUTATION",e[e.INIT_DATA_MUTATION=20]="INIT_DATA_MUTATION",e[e.COPY_PASTE_MUTATION=21]="COPY_PASTE_MUTATION",e[e.REORDER_RANGE_MUTATION=22]="REORDER_RANGE_MUTATION",e[e.MAP_RANGE_MUTATION=23]="MAP_RANGE_MUTATION",e[e.DEFINE_FILTER_MUTATION=24]="DEFINE_FILTER_MUTATION",e[e.DELETE_FILTER_MUTATION=25]="DELETE_FILTER_MUTATION",e[e.UPDATE_FILTER_MUTATION=26]="UPDATE_FILTER_MUTATION",e[e.EMPTY_MUTATION=27]="EMPTY_MUTATION",e[e.ADD_CONDITIONAL_FORMAT_MUTATION=28]="ADD_CONDITIONAL_FORMAT_MUTATION",e[e.DELETE_CONDITIONAL_FORMAT_MUTATION=29]="DELETE_CONDITIONAL_FORMAT_MUTATION",e[e.UPDATE_CONDITIONAL_FORMAT_MUTATION=30]="UPDATE_CONDITIONAL_FORMAT_MUTATION"}(a||(a={}));var r=[a.SET_DIMENSION_PROPERTIES_MUTATION,a.SET_RANGE_MUTATION,a.SET_CELL_PROPERTIES_MUTATION];t.default=a,t.NOT_IGNORE_CHECK_MUTATIONS=r},173:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.COMMENT_RANGE=0]="COMMENT_RANGE"}(a||(a={})),t.default=a},18:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SLOT_USER_ENTERED_FORMAT_DELTA=0]="SLOT_USER_ENTERED_FORMAT_DELTA",e[e.SLOT_FORMULA=1]="SLOT_FORMULA",e[e.SLOT_EFFIECTIVE_VALUE=2]="SLOT_EFFIECTIVE_VALUE",e[e.SLOT_EFFIECTIVE_FORMAT_DELTA=3]="SLOT_EFFIECTIVE_FORMAT_DELTA",e[e.SLOT_HYPERLINK=4]="SLOT_HYPERLINK",e[e.SLOT_AUTHOR=5]="SLOT_AUTHOR",e[e.SLOT_COMMENT=6]="SLOT_COMMENT",e[e.SLOT_RICH_TEXT_STYLE_RUN=7]="SLOT_RICH_TEXT_STYLE_RUN",e[e.SLOT_IS_DATA_VALID=8]="SLOT_IS_DATA_VALID",e[e.SLOT_CONDITIONAL_FORMAT_DELTA=9]="SLOT_CONDITIONAL_FORMAT_DELTA",e[e.SLOT_MENTION=10]="SLOT_MENTION"}(a||(a={}));var r={ALL:Math.pow(2,a.SLOT_MENTION+1)-1-(1<<a.SLOT_COMMENT)-(1<<a.SLOT_CONDITIONAL_FORMAT_DELTA)};t.default=a,t.CELL_DATA_SLOT_COMPOSE=r},181:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(9)),r=f(n(248)),o=f(n(25)),i=f(n(16));t.unzipKeyFrame=function(e){if(e&&"k"===e.type&&e.z){var t=JSON.parse(T(e.z));if(t&&t[0]&&t[0].k&&"z"===t[0].k.st){var n=t[0].k;n.s=w(n.s,n.r,n.c,null),n.st="set"}return t}return[e]},t.unzipString=T,t.Uint8ToString=E,t.zipKeyFrame=function(e){var t="";try{!function(e){if(!e||!e.k)return;var t=e.k.st,n=e.k.s,a=void 0;if("set"===t){var r=void 0,o=0,l=0;try{l=m((0,i.default)(n)).length}catch(d){r=C(n),t="z",a=r}r||(r=C(n),o=m((0,i.default)(r)).length,.9*l>o?(t="z",a=r):(t="set",a=n)),e.k.st=t,e.k.s=a}}(e);var n=(0,i.default)([e]),a=l.default.deflate(n);if(a){var r={type:"k",z:_(a)};t=(0,i.default)([r])}else s.default.run(u.CONFIG.ZIP_KEYFRAME)}catch(o){s.default.run(u.CONFIG.ZIP_KEYFRAME_CATCH_ERROR,[o&&o.stack])}return t},t.zipString=m,t.u8tobase64=_,t.getZipStringWithCell=x,t.getRangeWithZipString=S,t.checkActionsIfNeedZip=function(e){for(var t=0,n=e.length;t<n;t++){var a=e[t];a&&("paste"===a.type?e[t]=N(a):"emptycell"===a.type&&(e[t]=b(a)))}return e},t.checkActionsIfNeedUnzip=function(e){for(var t=0,n=e.length;t<n;t++){var a=e[t];a&&a.z&&("paste"===a.type?e[t]=P(a):"emptycell"===a.type&&(e[t]=JSON.parse(T(a.z))))}return e};var l=f(n(362)),d=f(n(1053)),s=f(n(8)),u=n(26);function f(e){return e&&e.__esModule?e:{default:e}}var h=6e3,c=1,I=2,g=1e4,R=3e5,v=5e3,p=!1;function T(e){var t=void 0;if(e){for(var n=p?window.atob(e):(0,d.default)(e),a=n.length,r=new Uint8Array(a),o=0;o<a;o++)r[o]=n.charCodeAt(o);var i=l.default.inflate(r);t="function"===typeof TextDecoder?new TextDecoder("utf-8").decode(i):"function"!==typeof escape||p?E(i):function(e){for(var t=[],n=0;n<e.length;n+=32768)t.push(String.fromCharCode.apply(null,e.subarray(n,n+32768)));var a=t.join("");return decodeURIComponent(escape(a))}(i)}return t}function E(e){var t,n=void 0,a=void 0,r=void 0,o=void 0;for(n=[],t=e.length,a=0;a<t;)switch((r=e[a++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:n.push(String.fromCharCode(r));break;case 12:case 13:o=e[a++],n.push(String.fromCharCode((31&r)<<6|63&o));break;case 14:o=e[a++],e[a++],n.push(String.fromCharCode((15&r)<<12))}return n.join("")}function m(e){return _(l.default.deflate(e))}function _(e){for(var t="",n=0,a=e.length;n*h<a;)t+=btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(e,n*h,(n+1)*h))),n++;return t}function y(e){if(!e||!e.from||!e.to)return"";var t=function(e){if(!e||!e.from||!e.to)return[];var t=void 0,n=void 0;return t={row:Math.min(e.from.row,e.to.row),col:Math.min(e.from.col,e.to.col)},n={row:Math.max(e.from.row,e.to.row),col:Math.max(e.from.col,e.to.col)},[t,n]}(e),n=t[0],a=t[1];if(n&&a){if(n.col===a.col&&n.row===a.row)return x(n);var r=x(n),o=x(a);if(r&&o)return r+":"+o;if(r)return r;if(o)return o}return""}function x(e){var t="";if(e&&"number"===typeof e.col){var n="A".charCodeAt(0),a="Z".charCodeAt(0)-"A".charCodeAt(0)+1;if(!a)return"";var r=e.col||0,o=0,i=!0;do{o=Math.floor(r%a-(i?0:1)),r=Math.floor(r/a),t=String.fromCharCode(o+n)+t,i=!1}while(r);t+=e.row+1}return t}function S(e){if("string"===typeof e){var t=e.split(":");if(1===t.length){var n=O(t[0]);if(n)return{from:n,to:n}}else if(2===t.length){var a=O(t[0]),r=O(t[1]);if(a&&r)return{from:a,to:r}}}}function O(e){if("string"===typeof e&&new RegExp("^[A-Z]+[0-9]+$").test(e)){var t=function(e){if("string"!==typeof e)return;var t=0,n=new RegExp("^[A-Z]+"),a="A".charCodeAt(0),r="Z".charCodeAt(0)-"A".charCodeAt(0)+1,o=e.match(n),i="";o&&(i=o[0]);for(var l=0,d=i.length;l<d;l++)t=l===i.length-1?i.charCodeAt(l)-a+("number"===typeof t?r*t:0):i.charCodeAt(l)-a+1+("number"===typeof t?r*t:0);return t}(e);if("number"!==typeof t||isNaN(t))return;var n=function(e){if("string"!==typeof e)return;var t=new RegExp("[0-9]+$"),n=e.match(t),a="";n&&(a=n[0]);return parseInt(a)-1}(e);if("number"!==typeof n||isNaN(n))return;return{row:n,col:t}}}function C(e){return function(e){if(!e||!e.length)return;for(var t=U(e),n=[],a=0,r=t.length;a<r;a++)for(var i=0,l=t[a].length;i<l;i++){var d=t[a][i];if(d&&(!d.isSearched||d.isSearched!==c)){var s={row:a,col:a},u=M(t,s,g(d));if(u){D(t,d,s,u);var f={from:s,to:u},h=U(d);delete h.isSearched;var I=[y(f),h];n.push(I)}}}return n;function g(e){return function(t){return function(e,t){if(null===e&&null===t)return!0;if(null===e||null===t)return!1;if("object"!==("undefined"===typeof e?"undefined":(0,o.default)(e))||"object"!==("undefined"===typeof t?"undefined":(0,o.default)(t)))return!1;if(e.isSearched&&e.isSearched===c)return!1;var n=!0;for(var a in t)t[a]!==e[a]&&(n=!1);return n}(t,e)}}}(e)}function D(e,t,n,a){if(n&&"number"===typeof n.row&&"number"===typeof n.col&&a&&"number"===typeof a.row&&"number"===typeof a.col){n||(n={row:0,col:0});for(var o=(0,r.default)(t).length-(t.isSearched?1:0),i=n.row;i<=a.row;i++)for(var l=n.col;l<=a.col;l++){var d=e[i][l];d&&(o===(0,r.default)(d).length-(d.isSearched?1:0)?d.isSearched=c:d.isSearched=I)}}}function M(e,t,n){if(e&&e.length&&e[t.row].length){t||(t={row:0,col:0});var a,r=void 0,o=void 0,i=0,l={row:t.row,col:t.col};for(r=t.row,a=e.length;r<a;r++){var d=e[r];for(o=t.col,i=i?Math.min(i,d.length):d.length;o<i;o++){if(!n(d[o])){if(r===t.row)l.col=o-1,i=o;else if(r===e.length-1)l.row=e.length-1;else if(o<l.col+1)return l.row=r-1,l;break}o===d.length-1?(l.col=d.length-1,r===e.length-1&&(l.row=e.length-1)):r===e.length-1&&o===i-1&&(l.row=e.length-1)}}return l}}function w(e,t,n,a){if(!e||"undefined"===typeof e.length)return t&&n?A([],t,n,a):void 0;for(var r=[],o=0,i=e.length;o<i;o++){var l=e[o],d=S(l[0]),s=l[1];if(d&&s)for(var u=d.from.row;u<=d.to.row;u++){r[u]||(r[u]=[]);for(var f=d.from.col;f<=d.to.col;f++){var h=r[u][f];for(var c in h||(h={},r[u][f]=h),s)"undefined"===typeof h[c]&&(h[c]=s[c])}}}return t&&n&&A(r,t,n,a),r}function A(e,t,n,a){e||(e=[]);for(var r=0;r<t;r++){e[r]||(e[r]=[]);for(var o=0;o<n;o++)"undefined"===typeof e[r][o]&&(e[r][o]=a)}return e}function F(e){if(e&&e.style){var t=function(e){var t=(0,i.default)(e);if(t.length<g)return e;var n=void 0,a=void 0,r=0,o=0;try{a=m(t)}catch(l){return{z:n=C(e)}}return n||(r=a.length,n=C(e),o=m((0,i.default)(n)).length),.9*r>o?{z:n}:e}(e.style);if(t&&t.z)return t}return e}function k(e,t,n,a){if(e&&e.z){var r=w(e.z,t,n,a);if(r)return{style:r}}return e}function L(e,t){return e&&"paste"===e.type&&!e.z?(e.stateBefore&&(e.stateBefore=F(e.stateBefore)),e.stateUpdated&&(e.stateUpdated=F(e.stateUpdated)),{type:"paste",z:m(t||(0,i.default)(e))}):e}function N(e){if(e&&"paste"==e.type&&!e.z){if((Math.abs(e.range.to.col-e.range.from.col)+1)*(Math.abs(e.range.to.row-e.range.from.row)+1)>v)return L(e);var t=(0,i.default)(e);if(t.length>R)return L(e,t)}return e}function b(e){if(e&&"emptycell"==e.type&&!e.z){var t=(0,i.default)(e);if(t.length>R)return function(e,t){return{type:e.type,z:m(t||(0,i.default)(e))}}(e,t)}return e}function P(e){return e&&"paste"==e.type&&e.z?function(e){if(e&&"paste"==e.type&&e.z){var t=JSON.parse(T(e.z)),n=Math.abs(t.range.to.row-t.range.from.row)+1,a=Math.abs(t.range.to.col-t.range.from.col)+1;return t.stateBefore&&(t.stateBefore=k(t.stateBefore,n,a,null)),t.stateUpdated&&(t.stateUpdated=k(t.stateUpdated,n,a,null)),t}return e}(e):e}var U=function e(t){if(!t||"object"!==("undefined"===typeof t?"undefined":(0,o.default)(t)))return t;var n={};return Array.isArray(t)?n=t.map(function(t){return e(t)}):(0,a.default)(t).forEach(function(a){return n[a]=e(t[a])}),n}},182:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.LEFT="left",e.CENTER="center",e.RIGHT="right"}(a||(a={})),t.default=a},183:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(16)),r=d(n(0)),o=d(n(1)),i=d(n(157)),l=n(369);function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,r.default)(this,e),t.ruleType=null!=t.ruleType?t.ruleType:i.default.CUSTOM,t.inputMessage=null!=t.inputMessage?t.inputMessage:null,t.isStrict=null!=t.isStrict?t.isStrict:null,t.showDropDown=null!=t.showDropDown?t.showDropDown:null,t.operator=null!=t.operator?t.operator:null,t.argTokens=null!=t.argTokens?t.argTokens:null,this.setProperties(t)}return(0,o.default)(e,[{key:"serialize",value:function(){var e=void 0,t=void 0,n=[],a=[];if(a.push(this.ruleType),a.push(this.inputMessage||""),a.push(this.isStrict?1:0),a.push(this.showDropDown?1:0),a.push(this.operator||""),this.argTokens)for(e=0,t=this.argTokens.length;e<t;e++)n.push(this.argTokens[e].userEnteredValue||"");return a.push(n),a}},{key:"setProperties",value:function(e){if("undefined"!==typeof e.ruleType&&e.ruleType&&(this.ruleType=e.ruleType),"undefined"!==typeof e.inputMessage&&(this.inputMessage=e.inputMessage),"undefined"!==typeof e.isStrict&&(this.isStrict=e.isStrict),"undefined"!==typeof e.showDropDown&&(this.showDropDown=e.showDropDown),"undefined"!==typeof e.operator&&(this.operator=e.operator),"undefined"!==typeof e.argTokens){var t=e.argTokens;if(this.ruleType===i.default.LIST&&e.argTokens){var n=e.argTokens[0].userEnteredValue;"string"===typeof n&&(t=[{userEnteredValue:(0,l.makeSelectionInOrder)(n)}])}this.argTokens=t}return this}},{key:"equal",value:function(e){return this.ruleType===e.ruleType&&this.inputMessage===e.inputMessage&&this.isStrict===e.isStrict&&this.showDropDown===e.showDropDown&&this.operator===e.operator&&(0,a.default)(this.argTokens)===(0,a.default)(e.argTokens)}},{key:"clone",value:function(){return new e({ruleType:this.ruleType,inputMessage:this.inputMessage,isStrict:this.isStrict,showDropDown:this.showDropDown,operator:this.operator,argTokens:this.argTokens})}},{key:"getStringIndex",value:function(){return void 0===this.stringIndex&&this.createStringIndex(),this.stringIndex}},{key:"createStringIndex",value:function(){var e=void 0,t=void 0,n="",a="";if(a+=this.ruleType||"",a+=","+(this.inputMessage||""),a+=","+(this.isStrict?1:0),a+=","+(this.showDropDown||""),a+=","+(this.operator||""),this.argTokens)for(e=0,t=this.argTokens.length;e<t;e++)0!==e&&(n+="|"),n+=this.argTokens[e].userEnteredValue||"";return a+=","+n,this.stringIndex=a,this}},{key:"_key",get:function(){return this.getStringIndex()}}],[{key:"deserialize",value:function(t){var n,a=void 0,r=[];for(a=0,n=t[5].length;a<n;a++)r.push({userEnteredValue:t[5][a]});return new e({ruleType:t[0]||null,inputMessage:t[1]||null,isStrict:!!t[2],showDropDown:!!t[3],operator:t[4]||null,argTokens:r})}}]),e}();s.protoMap={0:{name:"ruleType",dataType:String},1:{name:"inputMessage",dataType:String},2:{name:"isStrict",dataType:Boolean},3:{name:"showDropDown",dataType:Boolean},4:{name:"operator",dataType:String},5:{name:"argTokens",dataType:Array}},t.default=s},185:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SINGLE_LINE=1]="SINGLE_LINE",e[e.DOUBLE_LINE=2]="DOUBLE_LINE"}(a||(a={})),t.default=a},186:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t){(0,a.default)(this,e),this.hiddenValues=t.hiddenValues||[],t.visibleValues&&(this.visibleValues=t.visibleValues)}return(0,r.default)(e,[{key:"getHiddenValues",value:function(){return this.hiddenValues||[]}},{key:"setHiddenValues",value:function(e){return this.hiddenValues=e,this}},{key:"getVisibleValues",value:function(){return this.visibleValues||[]}},{key:"setVisibleValues",value:function(e){return this.visibleValues=e,this}}]),e}();i.protoMap={0:{name:"hiddenValues",dataType:{type:Array,subType:String}},1:{name:"visibleValues",dataType:{type:Array,subType:String}}},t.default=i},187:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.sheetRangeDeltaProtoMap=void 0;var a=o(n(0)),r=o(n(11));function o(e){return e&&e.__esModule?e:{default:e}}var i={0:{name:"id",dataType:String},1:{name:"content",dataType:String},2:{name:"time",dataType:Number},3:{name:"flag",dataType:Number}},l=function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),this.sheetRangeType=t.sheetRangeType,this.gridRange=t.gridRange,this.delta=t.delta||{},this.padId=t.padId||"",this.sheetId=t.sheetId||n.sheetId||""};l.protoMap={0:{name:"sheetRangeType",dataType:Number},1:{name:"gridRange",dataType:r.default},2:{name:"delta",dataType:{type:Object,protoMap:i}},3:{name:"padId",dataType:String}},t.default=l,t.sheetRangeDeltaProtoMap=i},189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(9)),r=y(n(3)),o=y(n(0)),i=y(n(1)),l=y(n(4)),d=y(n(5)),s=n(113),u=y(n(17)),f=y(n(30)),h=y(n(15)),c=y(n(35)),I=y(n(11)),g=n(55),R=n(70),v=y(n(161)),p=y(n(67)),T=y(n(80)),E=n(163),m=y(E),_=y(n(233));function y(e){return e&&e.__esModule?e:{default:e}}var x=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,u.default.DELETE_DIMENSION_MUTATION,e));return n.index=e.index,n.amount=e.amount,n.type=e.type,n.sheetId=e.sheetId,n}return(0,d.default)(t,e),(0,i.default)(t,[{key:"serialize",value:function(){return[this.index,this.amount,this.sheetId,this.type]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){if(this.type!==h.default.ROWS&&this.type!==h.default.COLUMNS)return!1;var t=e.getProperties().getGridProperties(),n=this.type===h.default.ROWS?t.rowCount:t.columnCount;return!(!(0,s.isNumber)(this.index)||this.index<0||this.index>=n)&&!(!(0,s.isNumber)(this.amount)||this.amount<=0||this.index+this.amount>n)}},{key:"runOnSheet",value:function(e){this.type===h.default.ROWS?e.deleteRows(this.index,this.amount):this.type===h.default.COLUMNS&&e.deleteCols(this.index,this.amount)}},{key:"invert",value:function(e){var t,n=this,r=e.getSheetBySheetId(this.sheetId),o=[],i=void 0,l=void 0,d=void 0,s=void 0,u=void 0,f=void 0;if(null===r)return o;if(this.type!==h.default.ROWS&&this.type!==h.default.COLUMNS)return console.warn("DIMENSION_TYPE error"),o;o.push(new v.default({index:this.index,amount:this.amount,type:this.type,sheetId:this.sheetId})),i=new c.default(this.sheetId,this.index,this.index+this.amount-1,this.type),Array.prototype.push.apply(o,(0,R.getSetDimensionPropertiesMutation)({sheet:r,type:this.type,ranges:[i]},{hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0})),l=this.type===h.default.ROWS?new I.default(this.sheetId,this.index,this.index+this.amount-1,0,r.getColCount()-1):new I.default(this.sheetId,0,r.getRowCount()-1,this.index,this.index+this.amount-1);var g=this.getSetRangeMutation(r,l);for(g&&o.push(g),this.type===h.default.ROWS?(u=r.getProperties().getGridProperties().frozenRowCount,this.index<u&&this.index+this.amount>=u&&o.push(new m.default({type:E.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_ROWS,value:u,sheetId:this.sheetId}))):this.type===h.default.COLUMNS&&(f=r.getProperties().getGridProperties().frozenColCount,this.index<f&&this.index+this.amount>=f&&o.push(new m.default({type:E.SHEET_PROPERTIES_SLOT.SLOT_FROZEN_COLUMNS,value:f,sheetId:this.sheetId}))),t=r.getMerges(),s=0;s<t.length;s++)d=t[s],(this.type===h.default.ROWS&&i.isCross(new c.default(d.sheetId,d.startRowIndex,d.endRowIndex,h.default.ROWS))||this.type===h.default.COLUMNS&&i.isCross(new c.default(d.sheetId,d.startColIndex,d.endColIndex,h.default.COLUMNS)))&&o.push(new T.default(d.clone()));var p=r.sheetRangeControl.ranges;(0,a.default)(p).forEach(function(e){var t=p[e];(n.type===h.default.ROWS&&t.gridRange.startRowIndex>=n.index&&t.gridRange.endRowIndex<=n.index+n.amount-1||n.type===h.default.COLUMNS&&t.gridRange.startColIndex>=n.index&&t.gridRange.endColIndex<=n.index+n.amount-1)&&o.push(new _.default({sheetId:t.sheetId,sheetRangeId:e,sheetRangeType:t.sheetRangeType,sheetRangePropertiesDelta:t.delta,padId:t.padId,gridRange:t.gridRange.clone()}))});var y=e.parent,x=y&&y.calcController;if(x){var S=x.getInvertMutationsForDeleteDimensionMutation(this);o=o.concat(S)}return o}},{key:"getSetRangeMutation",value:function(e,t){var n=void 0,a=void 0,r=void 0,o=void 0,i=[],l=e.getSheetId();for(a=t.startRowIndex;a<=t.endRowIndex;a++)for(n=t.startColIndex;n<=t.endColIndex;n++)r=e.getCellDataAtPosition(a,n),(o=(0,g.createCellDataDelta)({cellData:null,rowIndex:a,colIndex:n,sheetId:l},{cellData:r,rowIndex:a,colIndex:n,sheetId:l})).isEmpty()||i.push({rowIndex:a,colIndex:n,cellDataDelta:o});return i.length>0?new p.default({gridRange:t,cellDataDeltaAtPositions:i}):null}},{key:"isConflict",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(!this.isConflict(e))return[this];var a,r,o=[],i=new c.default(this.sheetId,this.index,this.index+this.amount-1,this.type);i.insert(e.index,e.amount);var l=i.toDimensionData();return a=l.index,r=l.amount,o.push(new t({index:a,amount:r,sheetId:this.sheetId,type:this.type})),o}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(!this.isConflict(e))return[this];var a,r,o=[],i=new c.default(this.sheetId,this.index,this.index+this.amount-1,this.type);i.delete(e.index,e.amount);var l=i.toDimensionData();return a=l.index,0===(r=l.amount)?o:(o.push(new t({index:a,amount:r,sheetId:this.sheetId,type:this.type})),o)}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({index:e[0],amount:e[1],sheetId:e[2],type:e[3]})}}]),t}(f.default);x.protoMap={0:{name:"index",dataType:Number},1:{name:"amount",dataType:Number},2:{name:"sheetId",dataType:String},3:{name:"type",dataType:String}},t.default=x},190:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(16)),r=g(n(3)),o=g(n(0)),i=g(n(1)),l=g(n(4)),d=g(n(5)),s=g(n(17)),u=g(n(30)),f=n(388),h=g(n(15)),c=g(n(35)),I=g(n(235));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,s.default.ADD_EMBEDDED_OBJECT_MUTATION,e));return n.data=e.data,n}return(0,d.default)(t,e),(0,i.default)(t,[{key:"serialize",value:function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e}},{key:"getAffectedSheetId",value:function(){return this.data.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.data.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!e.getImage(this.data.id)}},{key:"runOnSheet",value:function(e){e.addImage(this.data)}},{key:"invert",value:function(){var e=[];return e.push(new I.default({key:this.data.id,sheetId:this.data.sheetId})),e}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var r=[],o=this.data.sheetId,i=void 0,l=void 0;return(i=e.type===h.default.ROWS?new c.default(o,this.data.y,this.data.y,e.type):new c.default(o,this.data.x,this.data.x,e.type)).insert(e.index,e.amount),l=JSON.parse((0,a.default)(this.data)),e.type===h.default.ROWS?l.y=i.startIndex:l.x=i.startIndex,r.push(new t({data:l})),r}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var r=[],o=this.data.sheetId,i=void 0,l=void 0;return(i=e.type===h.default.ROWS?new c.default(o,this.data.y,this.data.y,e.type):new c.default(o,this.data.x,this.data.x,e.type)).delete(e.index,e.amount),l=JSON.parse((0,a.default)(this.data)),e.type===h.default.ROWS?l.y=i.startIndex:l.x=i.startIndex,r.push(new t({data:l})),r}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){var n={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(n.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new t(n)}}]),t}(u.default);R.protoMap={0:{name:"data",dataType:{type:Object,protoMap:f.EmbeddedImageDataProtoMap}}},t.default=R},191:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),o=c(n(1)),i=c(n(4)),l=c(n(5)),d=c(n(17)),s=c(n(30)),u=c(n(11)),f=n(187),h=c(f);function c(e){return e&&e.__esModule?e:{default:e}}var I=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.UPDATE_SHEET_RANGE_MUTATION,e));return n.sheetId=e.sheetId,n.sheetRangeId=e.sheetRangeId,n.gridRange=e.gridRange,n.sheetRangeType=e.sheetRangeType,n.sheetRangePropertiesDelta=e.sheetRangePropertiesDelta||{},n.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,n.padId=e.padId,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.gridRange.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){var t=this.gridRange.clone(),n=new h.default({sheetId:this.sheetId,gridRange:t,sheetRangeType:this.sheetRangeType,delta:this.sheetRangePropertiesDelta,padId:this.padId});e.updateSheetRange(this.sheetRangeId,n)}},{key:"invert",value:function(e){var n,a=e.getSheetBySheetId(this.sheetId),r=[];return null===a?r:void 0===(n=a.sheetRangeControl.getSheetRange(this.sheetRangeId))?r:(r.push(new t({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:n.gridRange,sheetRangeType:this.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetRangePropertiesDelta:n.delta,padId:this.padId})),r)}},{key:"transformWithInsertDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformDeleteSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],sheetRangeId:e[1],gridRange:u.default.deserialize(e[2]),sheetRangeType:e[3],padId:e[4]})}}]),t}(s.default);I.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:u.default},3:{name:"sheetRangeType",dataType:Number},4:{name:"sheetRangePropertiesDelta",dataType:{type:Object,protoMap:f.sheetRangeDeltaProtoMap}},5:{name:"padId",dataType:String}},t.default=I},20:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(0)),r=s(n(1)),o=s(n(107)),i=s(n(25)),l=s(n(159)),d=s(n(140));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t,n,a){var r,d=arguments.length,s=d<3?t:null===a?a=(0,l.default)(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":(0,i.default)(Reflect))&&"function"===typeof Reflect.decorate)s=Reflect.decorate(e,t,n,a);else for(var u=e.length-1;u>=0;u--)(r=e[u])&&(s=(d<3?r(s):d>3?r(t,n,s):r(t,n))||s);return d>3&&s&&(0,o.default)(t,n,s),s},f=function(){function e(t,n){(0,a.default)(this,e),this.behaviors=[],this.canUndoRedo=!0}return(0,r.default)(e,[{key:"predictRequestSize",value:function(e){return 0}},{key:"requestSizeOverLimitTips",value:function(){}},{key:"getRanges",value:function(e){return[]}},{key:"check",value:function(e){return null}},{key:"run",value:function(e,t){var n,a=void 0,r=void 0;if(this.behaviors&&this.behaviors.length)for(a=0,n=this.behaviors.length;a<n;a++)r=this.behaviors[a],this.do(r,e,t)}},{key:"do",value:function(e,t,n){}}]),e}();u([(0,d.default)(f)],f.prototype,"run",null),t.default=f},220:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(364));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.type=null!=t.type?t.type:o.default.ERROR,t.displayText=null!=t.displayText?t.displayText:null,t.title=null!=t.title?t.title:null,t.message=null!=t.message?t.message:null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.type,this.displayText,this.title,this.message]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.displayText&&(this.displayText=e.displayText),"undefined"!==typeof e.title&&(this.title=e.title),"undefined"!==typeof e.message&&(this.message=e.message),this}}],[{key:"deserialize",value:function(t){return new e({type:t[0],displayText:t[1],title:t[2],message:t[3]})}}]),e}();l.protoMap={0:{name:"type",dataType:Number},1:{name:"displayText",dataType:String},2:{name:"title",dataType:String},3:{name:"message",dataType:String}},t.default=l},221:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.GENERAL="auto",e.TEXT="text",e.NUMBER="number",e.PERCENT="percent",e.CURRENCY="currency",e.DATE="date",e.TIME="time",e.DATE_TIME="date-time",e.FRACTION="fraction",e.SCIENTIFIC="scientific",e.ACCOUNTING="accounting",e.SPECIAL="special",e.CUSTOM="custom"}(a||(a={})),t.default=a},223:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.BOOL=2]="BOOL",e[e.FORMULA=3]="FORMULA"}(a||(a={})),t.default=a},224:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(115));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.style=null!=t.style?t.style:null,t.width=null!=t.width?t.width:null,t.color=null!=t.color?t.color:null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){var e={};return null!==this.style&&(e[0]=this.style),null!==this.width&&(e[1]=this.width),null!==this.color&&(e[2]=this.color.serialize()),e}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.style&&(this.style=e.style),"undefined"!==typeof e.width&&(this.width=e.width),"undefined"!==typeof e.color&&(e.color?e.color instanceof o.default?this.color=e.color:this.color?this.color.setProperties(e.color):this.color=new o.default(e.color):this.color=null),this}},{key:"equal",value:function(e){return!(this.style!==e.style||this.width!==e.width||!(null===this.color&&null===e.color||this.color&&e.color&&this.color.equal(e.color)))}},{key:"clone",value:function(){return new e({style:this.style?this.style:null,width:this.width?this.width:null,color:this.color?this.color.clone():null})}},{key:"toString",value:function(){return"{"+(null!==this.style?this.style:"")+","+(null!==this.width?this.width:"")+","+(null!==this.color?this.color._key:"")+"}"}},{key:"_key",get:function(){return"B"+this.toString()}}]),e}();l.protoMap={0:{name:"style",dataType:Number},1:{name:"width",dataType:Number},2:{name:"color",dataType:o.default}},t.default=l},225:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.TOP="top",e.MIDDLE="middle",e.BOTTOM="bottom"}(a||(a={})),t.default=a},227:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PROPERTIES_MAP_KEY=void 0;var a,r=u(n(83)),o=u(n(0)),i=u(n(1)),l=u(n(39)),d=u(n(60)),s=u(n(183));function u(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.FORMAT=0]="FORMAT",e[e.FORMULA=1]="FORMULA",e[e.DATA_VALIDATION=2]="DATA_VALIDATION"}(a||(t.PROPERTIES_MAP_KEY=a={}));var f=function(){function e(){(0,o.default)(this,e),this.cellFormatDeltaMap={},this.formulaMap={},this.dataValidationMap={},this.serializedPropertiesMap={}}return(0,i.default)(e,null,[{key:"createPropertiesMap",value:function(e){var t,n=void 0,o=void 0,i=void 0,u=(t={},(0,r.default)(t,a.FORMAT,[]),(0,r.default)(t,a.FORMULA,[]),(0,r.default)(t,a.DATA_VALIDATION,[]),t);if(e[a.FORMAT])for(n=0,o=(i=e[a.FORMAT]).length;n<o;n++)u[a.FORMAT].push(l.default.deserialize(i[n]));if(e[a.FORMULA])for(n=0,o=(i=e[a.FORMULA]).length;n<o;n++)u[a.FORMULA].push(d.default.deserialize(i[n]));if(e[a.DATA_VALIDATION])for(n=0,o=(i=e[a.DATA_VALIDATION]).length;n<o;n++)u[a.DATA_VALIDATION].push(s.default.deserialize(i[n]));return u}}]),(0,i.default)(e,[{key:"getCellFormatDeltaIndex",value:function(e){var t=e.getStringIndex();return null==this.cellFormatDeltaMap[t]?-1:this.cellFormatDeltaMap[t]}},{key:"addCellFormatDelta",value:function(e){var t=this.getCellFormatDeltaIndex(e);return-1===t&&(this.serializedPropertiesMap[a.FORMAT]=this.serializedPropertiesMap[a.FORMAT]||[],t=this.serializedPropertiesMap[a.FORMAT].length,this.cellFormatDeltaMap[e.getStringIndex()]=t,this.serializedPropertiesMap[a.FORMAT].push(e.serialize())),t}},{key:"getFormulaIndex",value:function(e){var t=e.getStringIndex();return null==this.formulaMap[t]?-1:this.formulaMap[t]}},{key:"addFormula",value:function(e){var t=this.getFormulaIndex(e);return-1===t&&(this.serializedPropertiesMap[a.FORMULA]=this.serializedPropertiesMap[a.FORMULA]||[],t=this.serializedPropertiesMap[a.FORMULA].length,this.formulaMap[e.getStringIndex()]=t,this.serializedPropertiesMap[a.FORMULA].push(e.serialize())),t}},{key:"getDataValidationIndex",value:function(e){var t=e.getStringIndex();return null==this.dataValidationMap[t]?-1:this.dataValidationMap[t]}},{key:"addDataValidationMap",value:function(e){var t=this.getDataValidationIndex(e);return-1===t&&(this.serializedPropertiesMap[a.DATA_VALIDATION]=this.serializedPropertiesMap[a.DATA_VALIDATION]||[],t=this.serializedPropertiesMap[a.DATA_VALIDATION].length,this.dataValidationMap[e.getStringIndex()]=t,this.serializedPropertiesMap[a.DATA_VALIDATION].push(e.serialize())),t}}]),e}();t.default=f,t.PROPERTIES_MAP_KEY=a},228:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(276));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.hiddenByFilter=t.hiddenByFilter||!1,this.hiddenByUser=t.hiddenByUser||!1,this.pixelSize=t.pixelSize||null,this.formData=t.formData||null}return(0,r.default)(e,[{key:"equal",value:function(e,t){return!((t=t||{hiddenByFilter:!0,hiddenByUser:!0,pixelSize:!0,formData:!0}).hiddenByUser&&this.hiddenByUser!==e.hiddenByUser||t.hiddenByFilter&&this.hiddenByFilter!==e.hiddenByFilter||t.pixelSize&&this.pixelSize!==e.pixelSize||t.formData&&this.formData!==e.formData)}},{key:"getHiddenByFilter",value:function(){return this.hiddenByFilter}},{key:"setHiddenByFilter",value:function(e){return this.hiddenByFilter=e,this}},{key:"getHiddenByUser",value:function(){return this.hiddenByUser}},{key:"setHiddenByUser",value:function(e){return this.hiddenByUser=e,this}},{key:"getPixelSize",value:function(){return this.pixelSize}},{key:"setPixelSize",value:function(e){return this.pixelSize=e,this}},{key:"getFormData",value:function(){return this.formData}},{key:"setFormData",value:function(e){return this.formData=e,this}}]),e}();l.protoMap={0:{name:"hiddenByFilter",dataType:Boolean},1:{name:"hiddenByUser",dataType:Boolean},2:{name:"pixelSize",dataType:Number},3:{name:"formData",dataType:o.default}},t.default=l},229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeDeltaToCellFormat=t.createCellFormatDelta=void 0;var a=l(n(52)),r=l(n(39)),o=n(32),i=l(o);function l(e){return e&&e.__esModule?e:{default:e}}t.createCellFormatDelta=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.CELL_FORMAT_SLOT_COMPOSE.ALL,l=void 0,d=new r.default;if(!e&&!t)return d;for(e=e||new a.default,t=t||new a.default,l=0;n>0;n>>=1,l++)if(1===(1&n))if((t.setSlots&1<<l)>0)switch(l){case i.default.NUMBER_FORMAT:d.setSlot(l,t.getNumberFormat());break;case i.default.BACKGROUND_COLOR:d.setSlot(l,t.getBackgroundColor());break;case i.default.BORDER_TOP:d.setSlot(l,t.getBorderTop());break;case i.default.BORDER_RIGHT:d.setSlot(l,t.getBorderRight());break;case i.default.BORDER_BOTTOM:d.setSlot(l,t.getBorderBottom());break;case i.default.BORDER_LEFT:d.setSlot(l,t.getBorderLeft());break;case i.default.HORIZONTAL_ALIGN:d.setSlot(l,t.getHorizontalAlign());break;case i.default.VERTICAL_ALIGN:d.setSlot(l,t.getVerticalAlign());break;case i.default.WRAP_STRATEGY:d.setSlot(l,t.getWrapStrategy());break;case i.default.FOREGROUND_COLOR:d.setSlot(l,t.getColor());break;case i.default.FONT_FAMINY:d.setSlot(l,t.getFontFamily());break;case i.default.FONT_SIZE:d.setSlot(l,t.getFontSize());break;case i.default.BOLD:d.setSlot(l,t.getBold());break;case i.default.ITALIC:d.setSlot(l,t.getItalic());break;case i.default.STRIKETHROUGH:d.setSlot(l,t.getStrikethrough());break;case i.default.UNDERLINE:d.setSlot(l,t.getUnderline());break;case i.default.DATA_VALIDATION:d.setSlot(l,t.getDataValidation())}else(e.setSlots&1<<l)>0&&d.clearSlot(l);return d},t.mergeDeltaToCellFormat=function(e,t){if(t.clearSlots===o.CELL_FORMAT_SLOT_COMPOSE.ALL)return null;if(0===t.setSlots&&(!e||0===(e.setSlots&t.clearSlots)))return e;e=e||new a.default;var n=void 0,r=void 0;for(r=t.clearSlots&e.setSlots,n=0;r>0;r>>=1,n++)if(1===(1&r))switch(n){case i.default.NUMBER_FORMAT:e.clearNumberFormat();break;case i.default.BACKGROUND_COLOR:e.clearBackgroundColor();break;case i.default.BORDER_TOP:e.clearBorderTop();break;case i.default.BORDER_RIGHT:e.clearBorderRight();break;case i.default.BORDER_BOTTOM:e.clearBorderBottom();break;case i.default.BORDER_LEFT:e.clearBorderLeft();break;case i.default.HORIZONTAL_ALIGN:e.clearHorizontalAlign();break;case i.default.VERTICAL_ALIGN:e.clearVerticalAlign();break;case i.default.WRAP_STRATEGY:e.clearWrapStrategy();break;case i.default.FOREGROUND_COLOR:e.clearColor();break;case i.default.FONT_FAMINY:e.clearFontFamily();break;case i.default.FONT_SIZE:e.clearFontSize();break;case i.default.BOLD:e.clearBold();break;case i.default.ITALIC:e.clearItalic();break;case i.default.STRIKETHROUGH:e.clearStrikethrough();break;case i.default.UNDERLINE:e.clearUnderline();break;case i.default.DATA_VALIDATION:e.clearDataValidation()}for(r=t.setSlots,n=0;r>0;r>>=1,n++)if(1===(1&r)){var l=void 0;switch(n){case i.default.NUMBER_FORMAT:e.setNumberFormat(t.delta.getNumberFormat());break;case i.default.BACKGROUND_COLOR:e.setBackgroundColor(t.delta.getBackgroundColor());break;case i.default.BORDER_TOP:l=t.delta.getBorders(),e.setBorderTop(l&&l.top);break;case i.default.BORDER_RIGHT:l=t.delta.getBorders(),e.setBorderRight(l&&l.right);break;case i.default.BORDER_BOTTOM:l=t.delta.getBorders(),e.setBorderBottom(l&&l.bottom);break;case i.default.BORDER_LEFT:l=t.delta.getBorders(),e.setBorderLeft(l&&l.left);break;case i.default.HORIZONTAL_ALIGN:e.setHorizontalAlign(t.delta.getHorizontalAlign());break;case i.default.VERTICAL_ALIGN:e.setVerticalAlign(t.delta.getVerticalAlign());break;case i.default.WRAP_STRATEGY:e.setWrapStrategy(t.delta.getWrapStrategy());break;case i.default.FOREGROUND_COLOR:e.setColor(t.delta.getTextFormat().color);break;case i.default.FONT_FAMINY:e.setFontFamily(t.delta.getTextFormat().fontFamily);break;case i.default.FONT_SIZE:e.setFontSize(t.delta.getTextFormat().fontSize);break;case i.default.BOLD:e.setBold(t.delta.getTextFormat().bold);break;case i.default.ITALIC:e.setItalic(t.delta.getTextFormat().italic);break;case i.default.STRIKETHROUGH:e.setStrikethrough(t.delta.getTextFormat().strikethrough);break;case i.default.UNDERLINE:e.setUnderline(t.delta.getTextFormat().underline);break;case i.default.DATA_VALIDATION:e.setDataValidation(t.delta.getDataValidation())}}return e.isEmpty()?null:e}},230:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(0)),r=u(n(1)),o=u(n(81)),i=u(n(385)),l=u(n(663)),d=u(n(380)),s=u(n(381));function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,a.default)(this,e),this.parent=t.parent,this.spreadsheetId=t.spreadsheetId,this.mainThreadWorker=t.mainThreadWorker,this.type=t.type||i.default.NORMAL,this.properties=t.properties||new l.default({parent:this}),this.sheets=t.sheets||[],this.activeSheetId=t.activeSheetId||"",this.isReadonly=!!t.isReadonly}return(0,r.default)(e,[{key:"sheetCount",get:function(){return this.sheets.length}},{key:"activeSheet",get:function(){return this.getSheetBySheetId(this.activeSheetId)||this.sheets[0]}}]),(0,r.default)(e,[{key:"getType",value:function(){return this.type}},{key:"setType",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i.default.NORMAL;return this.type=e,this}},{key:"getTitle",value:function(){return this.properties.title}},{key:"setTitle",value:function(e,t){return e=e||"\u65e0\u6807\u9898\u8868\u683c",this.properties.title!==e&&(this.properties.title=e,t?this.parent.event&&this.parent.event.spreadsheetEvent.trigger(o.default.EVENT_NAME.TITLE_CHANGE_SERVER,e):this.parent.event&&this.parent.event.spreadsheetEvent.trigger(o.default.EVENT_NAME.TITLE_CHANGE_LOCAL,e)),this}},{key:"getSheets",value:function(){return this.sheets}},{key:"getFirstSheet",value:function(){return this.sheets[0]}},{key:"getActiveSheetId",value:function(){return this.activeSheetId}},{key:"setActiveSheetId",value:function(e){if(!this.getSheetBySheetId(e))throw new Error("\u8bbe\u7f6eactiveSheetId\uff0csheetId\u5f02\u5e38");return this.activeSheetId=e,this}},{key:"getSheetBySheetId",value:function(e){var t,n=void 0,a=void 0;for(n=0,t=this.sheets.length;n<t;n++)if(e===(a=this.sheets[n]).getSheetId())return a;return null}},{key:"getSheetBySheetTitle",value:function(e){var t,n=void 0,a=void 0;for(n=0,t=this.sheets.length;n<t;n++)if(e===(a=this.sheets[n]).getTitle())return a;return null}},{key:"getSheetIdBySheetIndex",value:function(e){var t=this.sheets[e];if(!t)throw new Error("sheetIndex\u5f02\u5e38");return t.getSheetId()}},{key:"getSheetIndexBySheetId",value:function(e){var t=this.getSheetBySheetId(e);return t?t.getIndex():-1}},{key:"getSheetIdsAmongTwoSheets",value:function(e,t){if(e===t)return this.getSheetBySheetId(e)?[e]:[];var n,a=-1,r=-1,o=[],i=void 0,l=this.sheets,d=void 0;for(i=0,n=this.sheets.length;i<n&&((d=l[i].getSheetId())===e&&(a=i),d===t&&(r=i),(a>-1||r>-1)&&o.push(d),!(a>-1&&r>-1));i++);return a<0&&r<0?[]:a<0?[t]:r<0?[e]:o}},{key:"isSheetAmongTwoSheets",value:function(e,t,n){return-1!==this.getSheetIdsAmongTwoSheets(t,n).indexOf(e)}},{key:"createSheet",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return new d.default({parent:this,properties:new s.default({sheetId:e,title:t,hidden:n})})}},{key:"getNextDisplaySheetId",value:function(e){var t=this,n=this.getSheetIndexBySheetId(e),a=function(e){var a=t.getSheetBySheetId(t.getSheetIdBySheetIndex(e));return a&&!0!==a.getProperties().getHidden()?e:n},r=void 0;return(r=function(){for(var e=void 0,t=n-1;t>=0;t--)if(e=a(t),n!==e)return e;return n}())===n&&(r=function(){for(var e=void 0,r=n;r<t.sheetCount;r++)if(e=a(r),n!==e)return e;return n}()),this.getSheetIdBySheetIndex(r)}},{key:"insertSheet",value:function(e,t){if((t=null!=t?t:this.sheetCount)<0||t>this.sheetCount)throw new Error("\u63d2\u5165sheet\uff0csheetIndex\u5f02\u5e38");return this.sheets.splice(t,0,e),this.batchUpdateSheetIndex(t),this}},{key:"deleteSheetBySheetId",value:function(e){var t=this.getSheetIndexBySheetId(e);return this.deleteSheetBySheetIndex(t),t}},{key:"deleteSheetBySheetIndex",value:function(e){if(this.getDisplaySheets().length<=1)throw new Error("\u5220\u9664sheet\uff0c\u53ea\u5269\u6700\u540e\u4e00\u4e2asheet\u4e86\uff0c\u65e0\u6cd5\u5220\u9664");if(this.sheets.length<=1)throw new Error("\u5220\u9664sheet\uff0c\u53ea\u5269\u6700\u540e\u4e00\u4e2asheet\u4e86\uff0c\u65e0\u6cd5\u5220\u9664");if(e<0||e>=this.sheets.length)throw new Error("\u5220\u9664sheet\uff0csheetIndex\u5f02\u5e38");var t=this.sheets.splice(e,1)[0];return this.batchUpdateSheetIndex(e),t}},{key:"moveSheet",value:function(e,t){var n=this.getSheetBySheetId(e);if(!n)throw new Error("\u79fb\u52a8sheet\uff0csheetId\u5f02\u5e38");if(t<0||t>=this.sheets.length)throw new Error("\u5220\u9664sheet\uff0ctargetIndex\u5f02\u5e38");var a=n.getIndex();return this.sheets.splice(a,1),this.sheets.splice(t,0,n),this.batchUpdateSheetIndex(),a}},{key:"batchUpdateSheetIndex",value:function(e){var t,n=void 0;for(n=e=null!=e?e:0,t=this.sheets.length;n<t;n++)this.sheets[n].setIndex(n);return this}},{key:"replaceSheetBySheetIndex",value:function(e,t){if(e<0||e>=this.sheets.length)throw new Error("\u66ff\u6362sheet\uff0csheetIndex\u5f02\u5e38");return t.setIndex(e),this.sheets.splice(e,1,t),this}},{key:"clearSheets",value:function(){return this.sheets=[],this}},{key:"reInitSheetBySheetId",value:function(e){var t=this.getSheetBySheetId(e);if(t){var n=t.getIndex(),a=t.getTitle(),r=this.createSheet(e,a);this.replaceSheetBySheetIndex(n,r)}}},{key:"autoUpdateCellData",value:function(e,t,n){var a=this.getSheetBySheetId(e);if(a){var r=a.getCellDataAtPosition(t,n);r&&r.autoUpdate(t,n)}}},{key:"getDisplaySheets",value:function(){var e=[];return this.sheets.forEach(function(t){!0!==t.getProperties().getHidden()&&e.push(t)}),e}}]),e}();t.default=f},231:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(3)),r=p(n(0)),o=p(n(1)),i=p(n(4)),l=p(n(5));t.checkMapRangeIsDimension=function(e,t){var n=!1,a=void 0;a=e===u.default.ROWS?t.row:t.column;-1!==a.from.startIndex&&-1!==a.from.endIndex&&(n=!0);return n};var d=p(n(17)),s=p(n(30)),u=p(n(15)),f=p(n(35)),h=p(n(11)),c=p(n(96)),I=p(n(70)),g=p(n(69)),R=p(n(139)),v=n(79);function p(e){return e&&e.__esModule?e:{default:e}}var T={0:{name:"from",dataType:{type:Object,protoMap:{0:{name:"startIndex",dataType:Number},1:{name:"endIndex",dataType:Number}}}},1:{name:"to",dataType:Number},2:{name:"sourceSheetId",dataType:String},3:{name:"destinationSheetId",dataType:String}},E=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.MAP_RANGE_MUTATION,e));return n.sourceSheetId=e.sourceSheetId,n.destinationSheetId=e.destinationSheetId,n.row=e.row,n.column=e.column,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sourceSheetId,this.destinationSheetId,[[this.row.from.startIndex,this.row.from.endIndex],this.row.to,this.row.sourceSheetId,this.row.destinationSheetId],[[this.column.from.startIndex,this.column.from.endIndex],this.column.to,this.column.sourceSheetId,this.column.destinationSheetId]]}},{key:"getAffectedSheetId",value:function(){return this.destinationSheetId}},{key:"getAffectedSheets",value:function(e){var t,n,a=[];return(t=e.getSheetBySheetId(this.sourceSheetId))&&a.push(t),(n=e.getSheetBySheetId(this.destinationSheetId))&&n!==t&&a.push(n),a}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){var e=[];return e.push(new t({sourceSheetId:this.destinationSheetId,destinationSheetId:this.sourceSheetId,row:m(this.row),column:m(this.column)})),e}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a=[],r=void 0,o=void 0;return r=e.type===u.default.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===r.sourceSheetId&&((o=new f.default(r.sourceSheetId,r.from.startIndex,r.from.endIndex,e.type)).insert(e.index,e.amount),r.from.startIndex=o.startIndex,r.from.endIndex=o.endIndex),e.sheetId===r.destinationSheetId&&((o=new f.default(r.destinationSheetId,r.to,r.to,e.type)).insert(e.index,e.amount),r.to=o.startIndex),a.push(new t({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===u.default.ROWS?r:this.row,column:e.type===u.default.COLUMNS?r:this.column})),a}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=[],r=void 0,o=void 0;return r=e.type===u.default.ROWS?{from:{startIndex:this.row.from.startIndex,endIndex:this.row.from.endIndex},to:this.row.to,sourceSheetId:this.row.sourceSheetId,destinationSheetId:this.row.destinationSheetId}:{from:{startIndex:this.column.from.startIndex,endIndex:this.column.from.endIndex},to:this.column.to,sourceSheetId:this.column.sourceSheetId,destinationSheetId:this.column.destinationSheetId},e.sheetId===r.sourceSheetId&&((o=new f.default(r.sourceSheetId,r.from.startIndex,r.from.endIndex,e.type)).delete(e.index,e.amount),r.from.startIndex=o.startIndex,r.from.endIndex=o.endIndex),e.sheetId===r.destinationSheetId&&((o=new f.default(r.destinationSheetId,r.to,r.to,e.type)).delete(e.index,e.amount),r.to=o.startIndex),a.push(new t({sourceSheetId:this.sourceSheetId,destinationSheetId:this.destinationSheetId,row:e.type===u.default.ROWS?r:this.row,column:e.type===u.default.COLUMNS?r:this.column})),a}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,t){var n=[],a=e.ranges,r=void 0,o=void 0,i=void 0,l=void 0,d=void 0,s=void 0,h=[];if(n.push(this),e.sheetId!==this.sourceSheetId)return n;for(e.type===u.default.ROWS?(o=new f.default(this.sourceSheetId,this.row.from.startIndex,this.row.from.endIndex,u.default.ROWS),d=this.row.to):(o=new f.default(this.sourceSheetId,this.column.from.startIndex,this.column.from.endIndex,u.default.COLUMNS),d=this.column.to),i=0;i<a.length;i++)(r=a[i]).isCross(o)&&(l=(0,v.crossSingleRange)(r,o)).cross&&(s=l.cross[0].move({from:{startIndex:o.startIndex,endIndex:o.endIndex},to:d}),Array.prototype.push.apply(h,s));return h.length>0&&n.push(new I.default({operation:e.operation,ranges:h,type:e.type,sheetId:e.sheetId})),n}},{key:"transformWithSetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){var n,a=[],r=this.destinationSheetId;return r!==e.sheetId?[this]:(n=new h.default(r,this.row.to,this.row.to,this.column.to,this.column.to),new h.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex).isCross(n)&&(this.row.from.startIndex===this.row.from.endIndex&&this.column.from.startIndex===this.column.from.endIndex&&this.row.to===e.startRowIndex&&this.column.to===e.endRowIndex||a.push(new g.default({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex}))),a.push(this),a)}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){var n=this;if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var a=[],r=[],o=[],i=[];return e.rule.ruleRanges.forEach(function(e){if(e.sheetId===n.sourceSheetId){var t=[],l=new h.default(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.from.startIndex,-1===n.row.to?e.endRowIndex:n.row.from.endIndex,-1===n.column.to?e.startColIndex:n.column.from.startIndex,-1===n.column.to?e.endColIndex:n.column.from.endIndex),d=e.getCross(l);d&&(t.push(d),r.push(d),i.push(new h.default(n.sourceSheetId,-1===n.row.to?d.startRowIndex:d.startRowIndex-n.row.from.startIndex+n.row.to,-1===n.row.to?d.endRowIndex:d.endRowIndex-n.row.from.startIndex+n.row.to,-1===n.column.to?d.startColIndex:d.startColIndex-n.column.from.startIndex+n.column.to,-1===n.column.to?d.endColIndex:d.endColIndex-n.column.from.startIndex+n.column.to)));var s=new h.default(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.to,-1===n.row.to?e.endRowIndex:n.row.to+n.row.from.endIndex-n.row.from.startIndex,-1===n.column.to?e.startColIndex:n.column.to,-1===n.column.to?e.endColIndex:n.column.to+n.column.from.endIndex-n.column.from.startIndex),u=e.getCross(s);u&&(t.push(u),o.push(u)),d||u?t.forEach(function(t){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(a.push(new h.default(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(a.push(new h.default(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&a.push(new h.default(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&a.push(new h.default(e.sheetId,n,r,t.endColIndex,e.endColIndex))}):a.push(e)}}),a.length>0||i.length>0?[this,new R.default({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new c.default({ruleRanges:[].concat(a,i),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){var n=this;if(this.sourceSheetId===e.sheetId||this.destinationSheetId===e.sheetId){var a=[],r=[],o=[],i=[];return e.rule.ruleRanges.forEach(function(e){if(e.sheetId===n.sourceSheetId){var t=[],l=new h.default(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.from.startIndex,-1===n.row.to?e.endRowIndex:n.row.from.endIndex,-1===n.column.to?e.startColIndex:n.column.from.startIndex,-1===n.column.to?e.endColIndex:n.column.from.endIndex),d=e.getCross(l);d&&(t.push(d),r.push(d),i.push(new h.default(n.sourceSheetId,-1===n.row.to?d.startRowIndex:d.startRowIndex-n.row.from.startIndex+n.row.to,-1===n.row.to?d.endRowIndex:d.endRowIndex-n.row.from.startIndex+n.row.to,-1===n.column.to?d.startColIndex:d.startColIndex-n.column.from.startIndex+n.column.to,-1===n.column.to?d.endColIndex:d.endColIndex-n.column.from.startIndex+n.column.to)));var s=new h.default(n.sourceSheetId,-1===n.row.to?e.startRowIndex:n.row.to,-1===n.row.to?e.endRowIndex:n.row.to+n.row.from.endIndex-n.row.from.startIndex,-1===n.column.to?e.startColIndex:n.column.to,-1===n.column.to?e.endColIndex:n.column.to+n.column.from.endIndex-n.column.from.startIndex),u=e.getCross(s);u&&(t.push(u),o.push(u)),d||u?t.forEach(function(t){var n=e.startRowIndex,r=e.endRowIndex;e.startRowIndex<t.startRowIndex&&(a.push(new h.default(e.sheetId,e.startRowIndex,t.startRowIndex,e.startColIndex,e.endColIndex)),n=t.startRowIndex),t.endRowIndex<e.endRowIndex&&(a.push(new h.default(e.sheetId,t.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),r=t.endRowIndex),e.startColIndex<t.startColIndex&&a.push(new h.default(e.sheetId,n,r,e.startColIndex,t.endColIndex)),t.endColIndex<e.endColIndex&&a.push(new h.default(e.sheetId,n,r,t.endColIndex,e.endColIndex))}):a.push(e)}}),a.length>0||i.length>0?[this,new R.default({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new c.default({ruleRanges:[].concat(a,i),booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})]:[this]}return[this]}}],[{key:"deserialize",value:function(e){return new t({sourceSheetId:e[0],destinationSheetId:e[1],row:{from:{startIndex:e[2][0][0],endIndex:e[2][0][1]},to:e[2][1],sourceSheetId:e[2][2],destinationSheetId:e[2][3]},column:{from:{startIndex:e[3][0][0],endIndex:e[3][0][1]},to:e[3][1],sourceSheetId:e[3][2],destinationSheetId:e[3][3]}})}}]),t}(s.default);function m(e){var t={from:{startIndex:0,endIndex:0},to:0,sourceSheetId:e.destinationSheetId,destinationSheetId:e.sourceSheetId};return t.from.startIndex=e.to,t.from.endIndex=e.to+(e.from.endIndex-e.from.startIndex),t.to=e.from.startIndex,t}E.protoMap={0:{name:"sourceSheetId",dataType:String},1:{name:"destinationSheetId",dataType:String},2:{name:"row",dataType:{type:Object,protoMap:T}},3:{name:"column",dataType:{type:Object,protoMap:T}}},t.default=E},232:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),r=E(n(0)),o=E(n(1)),i=E(n(4)),l=E(n(59)),d=E(n(5)),s=E(n(63)),u=E(n(9));t.convertFilterDelta2Filter=m;var f=n(113),h=E(n(17)),c=E(n(30)),I=E(n(162)),g=E(n(377)),R=E(n(11)),v=E(n(186)),p=E(n(15)),T=n(174);function E(e){return e&&e.__esModule?e:{default:e}}function m(e){var t=e.gridRange,n=e.workbookRangeId,a=e.criteriaDelta,r=e.hiddenRows,o=a?function(e){var t=new s.default;return(0,u.default)(e).forEach(function(n){t.set(parseInt(n),new v.default(e[n]))}),t}(a):void 0;return new g.default({range:t,hiddenRows:r,workbookRangeId:n,criteriaMap:o})}var _=function(e){var t,n=[e.defaultFilterId||"",e.hiddenRows||[],e.filterViewId||""],a=(0,u.default)(e.criteriaDelta||{}),r=void 0,o={};for(r=0,t=a.length;r<t;r++){o[a[r]]=[!1===e.criteriaDelta[a[r]].visibleByDefault?0:1,e.criteriaDelta[a[r]].visibleValues||[]];var i=e.criteriaDelta[a[r]].hiddenValues;i&&(o[a[r]][2]=i)}return n.push(o),n},y=function(e){var t,n={defaultFilterId:e[0],hiddenRows:e[1],filterViewId:e[2]},a=(0,u.default)(e[3]),r=void 0,o={};for(r=0,t=a.length;r<t;r++)o[a[r]]={visibleByDefault:!!e[3][a[r]][0],visibleValues:e[3][a[r]][1],hiddenValues:e[3][a[r]][2]};return n.criteriaDelta=o,n},x=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,h.default.DEFINE_FILTER_MUTATION,e));return n.sheetId=e.sheetId,n.delta=e.delta,n.gridRange=e.gridRange,n}return(0,d.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.gridRange.serialize(),_(this.delta)]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=this.sheetId,n=e.getSheetBySheetId(t);return n?[n]:[]}},{key:"invert",value:function(e){var t=this.sheetId,n=this.delta.defaultFilterId;return n?[new I.default({sheetId:t,delta:{defaultFilterId:n}})]:[]}},{key:"check",value:function(e){if(!(0,l.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"check",this).call(this,e))return!1;var n=this.gridRange;if(!(0,f.isNumber)(n.startRowIndex)||!(0,f.isNumber)(n.endRowIndex)||!(0,f.isNumber)(n.startColIndex)||!(0,f.isNumber)(n.endColIndex))return!1;var r=e.getProperties().getGridProperties();return!(n.startRowIndex<0||n.startRowIndex>=r.rowCount||n.endRowIndex>=r.rowCount||n.startColIndex<0||n.startColIndex>=r.columnCount||n.endColIndex>=r.columnCount)}},{key:"runOnSheet",value:function(e){var t=this.delta.defaultFilterId;if(t){var n=this.delta,a=n.criteriaDelta,r=n.hiddenRows,o=e.getBasicFilter(),i=this.gridRange;if(!o){var l=m({gridRange:i,workbookRangeId:t,criteriaDelta:a,hiddenRows:r});e.setBasicFilter(l)}}}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(!(0,T.isSame)(e.sheetId,this.gridRange.sheetId))return[this];var a=e.type,r=e.index,o=e.amount,i=e.sheetId,l=this.gridRange.clone();return l.insertDimension({type:a,index:r,amount:o}),[new t({gridRange:l,delta:function(e,t){var n=e.type,a=e.index,r=e.amount,o=!1;if(n===p.default.COLUMNS&&null!=t.criteriaDelta){o=!1;var i=t.criteriaDelta;if(i&&(0,u.default)(i).length>0){var l=(0,u.default)(i),d=l.filter(function(e){return parseInt(e)>a}).length>0;if(o=o||d,d){var s=l.reduce(function(e,t){return e[parseInt(t)>a?parseInt(t)+r:t]=i[parseInt(t)],e},{});t.criteriaDelta=s}}if(o)return t.hiddenRows=[],t}return t}({type:a,index:r,amount:o},this.delta),sheetId:i})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(!(0,T.isSame)(e.sheetId,this.gridRange.sheetId))return[this];var a=e.type,r=e.index,o=e.amount,i=e.sheetId,l=this.gridRange.clone();return l.deleteDimension({type:a,index:r,amount:o}),[new t({gridRange:l,delta:function(e,t){var n=e.type,a=e.index,r=e.amount,o=!1;if(n===p.default.COLUMNS&&null!=t.criteriaDelta){o=!1;var i=t.criteriaDelta;if(i&&(0,u.default)(i).length>0){var l=(0,u.default)(i),d=l.filter(function(e){return parseInt(e)>a}).length>0;if(o=o||d,d){var s=l.reduce(function(e,t){return e[parseInt(t)>a?parseInt(t)-r:t]=i[parseInt(t)],e},{});t.criteriaDelta=s,t.hiddenRows=[]}}if(o)return t}return t}({type:a,index:r,amount:o},this.delta),sheetId:i})]}},{key:"transformWithMergeCellsMutation",value:function(e,t){if(!(0,T.isSame)(e.sheetId,this.gridRange.sheetId))return[this];var n=e.startColIndex,a=e.startRowIndex,r=e.endColIndex,o=e.endRowIndex,i=e.sheetId;return new R.default(i,a,o,n,r).isCross(this.gridRange)?[]:[this]}},{key:"transformWithDefineFilterMutation",value:function(e,t){return(0,T.isSame)(e.sheetId,this.gridRange.sheetId)&&(0,T.isSame)(e.delta.defaultFilterId||e.delta.filterViewId,this.delta.defaultFilterId||this.delta.filterViewId)?[]:[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return(0,T.isSame)(e.sheetId,this.gridRange.sheetId)&&(0,T.isSame)(e.delta.defaultFilterId||e.delta.filterViewId,this.delta.defaultFilterId||this.delta.filterViewId)?[]:[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],gridRange:R.default.deserialize(e[1]),delta:y(e[2])})}}]),t}(c.default);x.protoMap={0:{name:"sheetId",dataType:String},1:{name:"gridRange",dataType:R.default},2:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"defaultFilterId",dataType:String},1:{name:"hiddenRows",dataType:Array,subType:Number},2:{name:"filterViewId",dataType:String},3:{name:"criteriaDelta",dataType:{type:Object,subType:{type:Object,protoMap:{0:{name:"visibleByDefault",dataType:Boolean},1:{name:"visibleValues",dataType:Array,subType:String},2:{name:"hiddenValues",dataType:Array,subType:String}}}}}}}}},t.default=x},233:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(3)),r=g(n(0)),o=g(n(1)),i=g(n(4)),l=g(n(5)),d=g(n(17)),s=g(n(30)),u=g(n(11)),f=n(187),h=g(f),c=g(n(234)),I=g(n(15));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.DEFINE_SHEET_RANGE_MUTATION,e));return n.sheetId=e.sheetId,n.sheetRangeId=e.sheetRangeId,n.gridRange=e.gridRange,n.sheetRangeType=e.sheetRangeType,n.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,n.sheetRangePropertiesDelta=e.sheetRangePropertiesDelta||{},n.padId=e.padId,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId,this.gridRange.serialize(),this.sheetRangeType,this.padId]}},{key:"isNonPersistedLocalChange",value:function(){return this.nonPersistingLocalChange}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){var t=new h.default({sheetId:this.sheetId,gridRange:this.gridRange,sheetRangeType:this.sheetRangeType,delta:this.sheetRangePropertiesDelta,padId:this.padId});e.addSheetRange(this.sheetRangeId,t)}},{key:"invert",value:function(e){return[new c.default({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,nonPersistingLocalChange:this.nonPersistingLocalChange})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a=this.gridRange;if(e.type===I.default.ROWS)a.insertRows(e.index,e.amount);else{if(e.type!==I.default.COLUMNS)return[];a.insertCols(e.index,e.amount)}return[new t({sheetRangeId:this.sheetRangeId,gridRange:this.gridRange,sheetRangeType:this.sheetRangeType,sheetRangePropertiesDelta:this.sheetRangePropertiesDelta,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=this.gridRange;if(e.type===I.default.ROWS)a.deleteRows(e.index,e.amount);else{if(e.type!==I.default.COLUMNS)return[];a.deleteCols(e.index,e.amount)}return[new t({sheetRangeId:this.sheetRangeId,gridRange:this.gridRange,sheetRangeType:this.sheetRangeType,sheetRangePropertiesDelta:this.sheetRangePropertiesDelta,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetId:this.sheetId,padId:this.padId})]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineWorkbookRangeMutation",value:function(e,t){if(t){var n=e.gridRange;if(this.gridRange.isCross(n)&&this.sheetRangeType===e.sheetRangeType)return[]}return[this]}},{key:"transformWithDeleteWorkbookRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateWorkbookRangeMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],sheetRangeId:e[1],gridRange:u.default.deserialize(e[2]),sheetRangeType:e[3],padId:e[4]})}}]),t}(s.default);R.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String},2:{name:"gridRange",dataType:u.default},3:{name:"sheetRangeType",dataType:Number},4:{name:"sheetRangePropertiesDelta",dataType:{type:Object,protoMap:f.sheetRangeDeltaProtoMap}},5:{name:"padId",dataType:String}},t.default=R},234:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(3)),r=f(n(0)),o=f(n(1)),i=f(n(4)),l=f(n(5)),d=f(n(17)),s=f(n(30)),u=f(n(233));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.DELETE_SHEET_RANGE_MUTATION,e));return n.sheetId=e.sheetId,n.sheetRangeId=e.sheetRangeId,n.nonPersistingLocalChange=e.nonPersistingLocalChange||!1,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.sheetRangeId]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){e.deleteSheetRange(this.sheetRangeId)}},{key:"invert",value:function(e){var t,n=e.getSheetBySheetId(this.sheetId),a=[];return null===n?a:void 0===(t=n.sheetRangeControl.getSheetRange(this.sheetRangeId))?a:(a.push(new u.default({sheetId:this.sheetId,sheetRangeId:this.sheetRangeId,gridRange:t.gridRange,sheetRangeType:t.sheetRangeType,nonPersistingLocalChange:this.nonPersistingLocalChange,sheetRangePropertiesDelta:t.delta,padId:t.padId})),a)}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],sheetRangeId:e[1]})}}]),t}(s.default);h.protoMap={0:{name:"sheetId",dataType:String},1:{name:"sheetRangeId",dataType:String}},t.default=h},235:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(17)),s=h(n(30)),u=h(n(190)),f=n(388);function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.DELETE_EMBEDDED_OBJECT_MUTATION,e));return n.key=e.key,n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.key,this.sheetId]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!!e.getImage(this.key)}},{key:"runOnSheet",value:function(e){e.deleteImage(this.key)}},{key:"invert",value:function(e){var t=[],n=e.getSheetBySheetId(this.sheetId);if(null===n)return t;var a=n.getImage(this.key);return a&&t.push(new u.default({data:(0,f.getIEmbeddedImageOptions)(a)})),t}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){var n=[];return e.key!==this.key&&n.push(this),n}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){var n=[];return n.push(this),n}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){var n=[];return n.push(this),n}}],[{key:"deserialize",value:function(e){return new t({key:e[0],sheetId:e[1]})}}]),t}(s.default);c.protoMap={0:{name:"key",dataType:String},1:{name:"sheetId",dataType:String}},t.default=c},236:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(11)),s=h(n(17)),u=h(n(30)),f=h(n(282));function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,s.default.DELETE_CONDITIONAL_FORMAT_MUTATION,e));return n.sheetId=e.sheetId,n.ruleIndex=e.ruleIndex,n.oldRuleRanges=e.oldRuleRanges,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.oldRuleRanges.map(function(e){return e.serialize()})]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.deleteConditionalFormatRule(this.ruleIndex)}},{key:"invert",value:function(e){var t=e.getSheetBySheetId(this.sheetId).conditionalFormatRuleManager.getConditionalFormatRuleByRuleIndex(this.ruleIndex);return t?[new f.default({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:t})]:[]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,n){return this.sheetId===e.sheetId&&this.ruleIndex>=e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,oldRuleRanges:this.oldRuleRanges})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,n){if(this.sheetId===e.sheetId){if(this.ruleIndex===e.ruleIndex)return[];if(this.ruleIndex>e.ruleIndex)return[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,oldRuleRanges:this.oldRuleRanges})]}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,n){return this.sheetId===e.sheetId&&this.ruleIndex===e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.oldRuleRanges})]:[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],ruleIndex:e[1],oldRuleRanges:e[2].map(function(e){return d.default.deserialize(e)})})}}]),t}(u.default);c.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"oldRuleRanges",dataType:{type:Array,subType:d.default}}},t.default=c},241:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(1350);Object.defineProperty(t,"getUserEnteredFormatDelta",{enumerable:!0,get:function(){return a.getUserEnteredFormatDelta}});var r=n(1351);Object.defineProperty(t,"getSelectionDimensionRanges",{enumerable:!0,get:function(){return r.getSelectionDimensionRanges}});var o=n(1352);Object.defineProperty(t,"getCellBorder",{enumerable:!0,get:function(){return o.getCellBorder}});var i=n(1353);Object.defineProperty(t,"getTextFormatDelta",{enumerable:!0,get:function(){return i.getTextFormatDelta}})},274:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=void 0,f=n.beforeConvert,h=n.afterKeyframeRun,c=n.afterConvert;s=+new Date;var I=void 0;I=(0,o.transKeyFrame)(t),window.needOpenSpeedReport&&(+new Date,a.default.speed.runReport(r.SPEED_REPORT_POINTS.KEYFRAME_TRANSFORM,s,+new Date));var g=I.keyframe;"function"===typeof f&&f(e,g);I.hasKeyFrame&&(s=+new Date,(0,i.default)(e,g[0]),e.correct(),window.needOpenSpeedReport&&a.default.speed.runReport(r.SPEED_REPORT_POINTS.KEYFRAME_DESERIALIZATION,s,+new Date),"function"===typeof h&&(s=+new Date,h({data:g[0],sType:e.getParent()&&e.getParent().type||"normal"}),window.needOpenSpeedReport&&a.default.speed.runReport(r.SPEED_REPORT_POINTS.AFTER_KEYFRAME_RUN,s,+new Date)));s=+new Date;for(var R=0,v=I.actions.length;R<v;R++)for(var p=u(I.actions[R]),T=0,E=p.length;T<E;T++){var m=p[T];(0,l.default)(e,m)}I.actions.length&&e.correct();+new Date,window.needOpenSpeedReport&&a.default.tdwReport({opername:"quality_doc",module:"excel_detail",action:"first_screen_mutation_count",ver5:I.actions.length});"function"===typeof c&&c(e);return new d.default({sheetId:e.getSheetId(),lastRow:e.getRowCount()-1,lastCol:e.getColCount()-1}).run(e,{isLocal:!0}),e};var a=s(n(8)),r=n(26),o=n(510),i=s(n(1059)),l=s(n(667)),d=s(n(389));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){return"string"===typeof e?u(JSON.parse(e)):e}},275:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(24)),r=i(n(0)),o=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,r.default)(this,e),this.mentionId=t.mentionId||"",this.pos=[].concat(t.pos||""),this.type=t.type||0,this.sheetId=t.sheetId||"",this.text=t.text||"",this.userId=t.userId||"",this.padId=window.clientVars.padId}return(0,o.default)(e,[{key:"serialize",value:function(){return[this.mentionId,this.pos[0],this.pos[1],this.type,this.sheetId,this.text,this.userId,this.padId]}},{key:"clone",value:function(){return new e({mentionId:this.mentionId,pos:[].concat((0,a.default)(this.pos)),type:this.type,sheetId:this.sheetId,text:this.text,userId:this.userId,padId:this.padId})}},{key:"toObject",value:function(){return{mentionId:this.mentionId,pos:this.pos.slice(0),type:this.type,sheetId:this.sheetId,text:this.text,userId:this.userId,padId:this.padId}}}],[{key:"deserialize",value:function(t){return t[7]&&t[7]==window.clientVars.padId?new e({mentionId:t[0],pos:[t[1],t[2]],type:t[3],sheetId:t[4],text:t[5],userId:t[6],padId:t[7]}):null}}]),e}();l.protoMap={0:{name:"mentionId",dataType:String},1:{name:"pos",dataType:Array},2:{name:"type",dataType:Number},3:{name:"sheetId",dataType:String},4:{name:"text",dataType:String},5:{name:"userId",dataType:String},6:{name:"padId",dataType:String}},t.default=l},276:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t){(0,a.default)(this,e),this.formDataId=t.formDataId,this.formSeqNumber=t.formSeqNumber,this.formItemType="number"===typeof t.formItemType?String(t.formItemType):t.formItemType,this.isDuration=t.isDuration||!0,this.isDeleted=t.isDeleted||!1,this.time=t.time||"0"}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.formDataId,this.formSeqNumber,this.formItemType,this.isDuration,this.isDeleted,this.time]}},{key:"setDuration",value:function(e){return this.isDuration=e,this}},{key:"setDelete",value:function(e){return this.isDeleted=e,this}}],[{key:"deserialize",value:function(t){return new e({formDataId:t[0],formSeqNumber:t[1],formItemType:t[2],isDuration:t[3],isDeleted:t[4],time:t[5]})}}]),e}();i.protoMap={0:{name:"formDataId",dataType:String},1:{name:"formSeqNumber",dataType:Number},2:{name:"formItemType",dataType:String},3:{name:"isDuration",dataType:Boolean},4:{name:"isDeleted",dataType:Boolean},5:{name:"time",dataType:String}},t.default=i},277:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(373));function o(e){return e&&e.__esModule?e:{default:e}}var i=function e(t){(0,a.default)(this,e),this.anchorCell=t.anchorCell,this.offsetXpixels=t.offsetXpixels,this.offsetYpixels=t.offsetYpixels,this.widthPixels=t.widthPixels,this.heightPixels=t.heightPixels,this.zIndex=t.zIndex};i.protoMap={0:{name:"anchorCell",dataType:r.default},1:{name:"offsetXpixels",dataType:Number},2:{name:"offsetYpixels",dataType:Number},3:{name:"widthPixels",dataType:Number},4:{name:"heightPixels",dataType:Number},5:{name:"zIndex",dataType:Number}},t.default=i},278:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.VALUE_TOKEN=0]="VALUE_TOKEN",e[e.FORMULA_TOKEN=1]="FORMULA_TOKEN",e[e.DATE_TOKEN=2]="DATE_TOKEN",e[e.UNPARSED_TOKEN=3]="UNPARSED_TOKEN"}(a||(a={})),t.default=a},279:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setSheetCellsNum=function(e,t){a._sheetCellsNum[e]=t},t.getSheetCellsNum=function(e){if(e in a._sheetCellsNum){var t=a._sheetCellsNum[e];return t.dataNum>=1e4?t.isLarge=1:t.isLarge=0,t}return{allNum:-1,dataNum:-1,isLarge:-1}};var a=window;a._sheetCellsNum={}},280:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(16)),r=g(n(3)),o=g(n(0)),i=g(n(1)),l=g(n(4)),d=g(n(5)),s=g(n(17)),u=g(n(30)),f=n(388),h=g(n(15)),c=g(n(35)),I=g(n(190));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,s.default.UPDATE_EMBEDDED_OBJECT_MUTATION,e));return n.data=e.data,n}return(0,d.default)(t,e),(0,i.default)(t,[{key:"serialize",value:function(){var e=[this.data.type,this.data.sheetId,this.data.id,this.data.url,this.data.width,this.data.height,this.data.x,this.data.y,this.data.offsetX,this.data.offsetY,this.data.zIndex];return this.data.clipInfo?e.push([this.data.clipInfo.clipTop,this.data.clipInfo.clipLeft,this.data.clipInfo.clipRight,this.data.clipInfo.clipBottom]):e.push(null),e}},{key:"getAffectedSheetId",value:function(){return this.data.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.data.sheetId))&&n.push(t),n}},{key:"check",value:function(e){return!!e.getImage(this.data.id)}},{key:"runOnSheet",value:function(e){e.updateImage(this.data)}},{key:"invert",value:function(e){var n=[],a=e.getSheetBySheetId(this.data.sheetId);if(null===a)return n;var r=a.getImage(this.data.id);return r&&n.push(new t({data:(0,f.getIEmbeddedImageOptions)(r)})),n}},{key:"transformWithInsertDimensionMutation",value:function(e,t){var n=[],r=this.data.sheetId,o=void 0,i=void 0;return(o=e.type===h.default.ROWS?new c.default(r,this.data.y,this.data.y,e.type):new c.default(r,this.data.x,this.data.x,e.type)).insert(e.index,e.amount),i=JSON.parse((0,a.default)(this.data)),e.type===h.default.ROWS?i.y=o.startIndex:i.x=o.startIndex,n.push(new I.default({data:i})),n}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var r=[],o=this.data.sheetId,i=void 0,l=void 0;return(i=e.type===h.default.ROWS?new c.default(o,this.data.y,this.data.y,e.type):new c.default(o,this.data.x,this.data.x,e.type)).delete(e.index,e.amount),l=JSON.parse((0,a.default)(this.data)),e.type===h.default.ROWS?l.y=i.startIndex:l.x=i.startIndex,r.push(new t({data:this.data})),r}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){var n=[];return e.key!==this.data.id&&n.push(this),n}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){var n=[];return e.data.id!==this.data.id?n.push(this):t&&n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){var n={data:{type:e[0],sheetId:e[1],id:e[2],url:e[3],width:e[4],height:e[5],x:e[6],y:e[7],offsetX:e[8],offsetY:e[9],zIndex:e[10]}};return e[11]&&(n.data.clipInfo={clipTop:e[11][0],clipLeft:e[11][1],clipRight:e[11][2],clipBottom:e[11][3]}),new t(n)}}]),t}(u.default);R.protoMap={0:{name:"data",dataType:{type:Object,protoMap:f.EmbeddedImageDataProtoMap}}},t.default=R},281:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(16)),r=g(n(9)),o=g(n(3)),i=g(n(0)),l=g(n(1)),d=g(n(4)),s=g(n(5)),u=g(n(17)),f=g(n(30)),h=g(n(15)),c=g(n(11)),I=g(n(69));function g(e){return e&&e.__esModule?e:{default:e}}var R={0:{name:"from",dataType:Number},1:{name:"to",dataType:Number}},v={0:{name:"queue",dataType:{type:Array,subType:String}},1:{name:"rules",dataType:{type:Object,subType:{type:Object,protoMap:R}}}},p=function(e){function t(e){(0,i.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,u.default.REORDER_RANGE_MUTATION,e));return n.sheetId=e.sheetId,n.range=e.range,n.operation=e.operation,n}return(0,s.default)(t,e),(0,l.default)(t,[{key:"serialize",value:function(){var e=[this.sheetId,this.range.serialize()],t=[];t.push(this.operation.queue),t.push({});var n,a=void 0,o=(0,r.default)(this.operation.rules);for(a=0,n=o.length;a<n;a++)t[1][o[a]]=[this.operation.rules[o[a]].from,this.operation.rules[o[a]].to];return e.push(t),e}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"runOnSheet",value:function(e){for(var t=[],n=0;n<this.operation.queue.length;n++)t.push(this.operation.rules[this.operation.queue[n]]);e.moveRange(this.range,t)}},{key:"invert",value:function(e){var t=[];t=t.concat(this.reset());var n=e.parent,a=n&&n.calcController;if(a){var r=a.getInvertMutationsForRowReorderMutation(this);t=t.concat(r)}return t}},{key:"reset",value:function(){var e=[],n={queue:[],rules:{}},a=void 0,r=this.operation.queue,o=this.operation.rules,i=void 0;for(a=0;a<r.length;a++)i=o[r[a]],n.queue.push(""+i.to),n.rules[""+i.to]={from:i.to,to:i.from};return e.push(new t({range:this.range,sheetId:this.sheetId,operation:n})),e}},{key:"getOrderResult",value:function(e){var t,n=void 0;for(n=0,t=this.operation.queue.length;n<t;n++)if(e===Number(this.operation.queue[n]))return this.operation.rules[e].to;return null}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var r=[],o=JSON.parse((0,a.default)(this.operation)),i=o.queue,l=o.rules,d=void 0,s=void 0,u=this.range.clone();if(e.type===h.default.COLUMNS)u.insertCols(e.index,e.amount);else for(u.insertRows(e.index,e.amount),s=0;s<i.length;s++)(d=l[i[s]]).from>=e.index&&(d.from+=e.amount,delete l[i[s]],i[s]=""+d.from,l[i[s]]=d),d.to>=e.index&&(d.to+=e.amount);return r.push(new t({range:u,sheetId:this.sheetId,operation:o})),r}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var r=[],o=JSON.parse((0,a.default)(this.operation)),i=o.queue,l=o.rules,d=void 0,s=void 0,u=this.range.clone();if(e.type===h.default.COLUMNS){if(u.deleteCols(e.index,e.amount),!u.isValid())return r}else for(u.deleteRows(e.index,e.amount),s=0;s<i.length;s++)(d=l[i[s]]).from>=e.index&&(d.from<=e.index+e.amount-1?(delete l[i[s]],i.splice(s,1)):d.from-=e.amount);return r.push(new t({range:u,sheetId:this.sheetId,operation:o})),r}},{key:"transformWithSetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){var n=[],a=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,i=e.endColIndex,l=e.sheetId,d=new c.default(l,a,r,o,i);return l===this.sheetId&&d.isCross(this.range)&&n.push(new I.default({sheetId:l,startRowIndex:a,endRowIndex:r,startColIndex:o,endColIndex:i})),n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){var n=[];return this.range.isCross(e.range)?t&&(n=n.concat(e.reset())).push(this):n.push(this),n}}],[{key:"deserialize",value:function(e){var n,a={sheetId:e[0],range:c.default.deserialize(e[1]),operation:{queue:e[2][0],rules:{}}},o=void 0,i=(0,r.default)(e[2][1]);for(o=0,n=i.length;o<n;o++)a.operation.rules[i[o]]={from:e[2][1][i[o]][0],to:e[2][1][i[o]][1]};return new t(a)}}]),t}(f.default);p.protoMap={0:{name:"sheetId",dataType:String},1:{name:"range",dataType:c.default},2:{name:"operation",dataType:{type:Object,protoMap:v}}},t.default=p},282:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=I(n(3)),r=I(n(0)),o=I(n(1)),i=I(n(4)),l=I(n(5)),d=I(n(15)),s=I(n(11)),u=I(n(17)),f=I(n(30)),h=I(n(96)),c=I(n(236));function I(e){return e&&e.__esModule?e:{default:e}}var g=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,u.default.ADD_CONDITIONAL_FORMAT_MUTATION,e));return n.sheetId=e.sheetId,n.ruleIndex=e.ruleIndex,n.rule=e.rule,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.ruleIndex,this.rule.serialize()]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.sheetId);return t?[t]:[]}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){e.conditionalFormatRuleManager.addConditionalFormatRule(this.ruleIndex,this.rule)}},{key:"invert",value:function(e){return[new c.default({sheetId:this.sheetId,ruleIndex:this.ruleIndex,oldRuleRanges:this.rule.ruleRanges})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(this.sheetId===e.sheetId){var a=[];return this.rule.ruleRanges.forEach(function(t){(t=t.clone()).sheetId===e.sheetId&&(e.type===d.default.ROWS?t.insertRows(e.index,e.amount):e.type===d.default.COLUMNS&&t.insertCols(e.index,e.amount),t.isValid()&&a.push(t))}),a.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:a,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(this.sheetId===e.sheetId){var a=[];return this.rule.ruleRanges.forEach(function(t){(t=t.clone()).sheetId===e.sheetId&&(e.type===d.default.ROWS?t.deleteRows(e.index,e.amount):e.type===d.default.COLUMNS&&t.deleteCols(e.index,e.amount),t.isValid()&&a.push(t))}),a.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:a,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,n){if(this.sheetId!==e.sheetId)return[this];var a=new s.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(this.rule.ruleRanges.some(function(e){return e.isCross(a)})){var r=new s.default(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex,e.startColIndex);if(this.rule.ruleRanges.some(function(e){return e.contain(r)}))return[this];var o=[];return this.rule.ruleRanges.forEach(function(e){if(e.sheetId===a.sheetId&&e.isCross(a)){var t=e.startRowIndex,n=e.endRowIndex;e.startRowIndex<a.startRowIndex&&(o.push(new s.default(e.sheetId,e.startRowIndex,a.startRowIndex,e.startColIndex,e.endColIndex)),t=a.startRowIndex),a.endRowIndex<e.endRowIndex&&(o.push(new s.default(e.sheetId,a.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),n=a.endRowIndex),e.startColIndex<a.startColIndex&&o.push(new s.default(e.sheetId,t,n,e.startColIndex,a.endColIndex)),a.endColIndex<e.endColIndex&&o.push(new s.default(e.sheetId,t,n,a.endColIndex,e.endColIndex))}else o.push(e)}),0===o.length?[]:(o.sort(function(e,t){return e.startRowIndex<t.startRowIndex?-1:e.startColIndex<t.startColIndex?-1:e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex}),[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:o,booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})])}return[this]}},{key:"transformWithMapRangeMutation",value:function(e,n){var a=[],r=[],o=[],i=[];return this.rule.ruleRanges.forEach(function(t){if(t.sheetId===e.sourceSheetId){var n=[],l=new s.default(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.from.startIndex,-1===e.row.to?t.endRowIndex:e.row.from.endIndex,-1===e.column.to?t.startColIndex:e.column.from.startIndex,-1===e.column.to?t.endColIndex:e.column.from.endIndex),d=t.getCross(l);d&&(n.push(d),r.push(d),i.push(new s.default(e.sourceSheetId,-1===e.row.to?d.startRowIndex:d.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.to?d.endRowIndex:d.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.to?d.startColIndex:d.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.to?d.endColIndex:d.endColIndex-e.column.from.startIndex+e.column.to)));var u=new s.default(e.sourceSheetId,-1===e.row.to?t.startRowIndex:e.row.to,-1===e.row.to?t.endRowIndex:e.row.to+e.row.from.endIndex-e.row.from.startIndex,-1===e.column.to?t.startColIndex:e.column.to,-1===e.column.to?t.endColIndex:e.column.to+e.column.from.endIndex-e.column.from.startIndex),f=t.getCross(u);f&&(n.push(f),o.push(f)),d||f?n.forEach(function(e){var n=t.startRowIndex,r=t.endRowIndex;t.startRowIndex<e.startRowIndex&&(a.push(new s.default(t.sheetId,t.startRowIndex,e.startRowIndex,t.startColIndex,t.endColIndex)),n=e.startRowIndex),e.endRowIndex<t.endRowIndex&&(a.push(new s.default(t.sheetId,e.endRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex)),r=e.endRowIndex),t.startColIndex<e.startColIndex&&a.push(new s.default(t.sheetId,n,r,t.startColIndex,e.endColIndex)),e.endColIndex<t.endColIndex&&a.push(new s.default(t.sheetId,n,r,e.endColIndex,t.endColIndex))}):a.push(t)}}),a.length>0||i.length>0?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex,rule:new h.default({ruleRanges:[].concat(a,i),booleanConditionalFormat:this.rule.booleanConditionalFormat,gradientConditionalFormat:this.rule.gradientConditionalFormat})})]:[]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,n){return this.sheetId===e.sheetId&&(this.ruleIndex>e.ruleIndex||this.ruleIndex===e.ruleIndex&&n)?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex+1,rule:this.rule})]:[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,n){return this.sheetId===e.sheetId&&this.ruleIndex>e.ruleIndex?[new t({sheetId:this.sheetId,ruleIndex:this.ruleIndex-1,rule:this.rule})]:[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],ruleIndex:e[1],rule:h.default.deserialize(e[2])})}}]),t}(f.default);g.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ruleIndex",dataType:Number},2:{name:"rule",dataType:h.default}},t.default=g},29:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(9)),r=R(n(31)),o=R(n(0)),i=R(n(1)),l=R(n(18)),d=n(227),s=R(n(78)),u=R(n(52)),f=R(n(39)),h=R(n(60)),c=R(n(32)),I=R(n(109)),g=R(n(275));function R(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e),this.setSlots=null!=t.setSlots?t.setSlots:0,this.clearSlots=null!=t.clearSlots?t.clearSlots:0,this.delta=t.delta||{}}return(0,i.default)(e,[{key:"serialize",value:function(e){var t=void 0,n=void 0,o=void 0,i=this.setSlots,d=void 0,s=void 0,u={};for(this.setSlots>0&&(u[0]=this.setSlots),this.clearSlots>0&&(u[1]=this.clearSlots),t=0;i>0;i>>=1,t++)if(1===(1&i))switch(t){case l.default.SLOT_EFFIECTIVE_VALUE:this.delta.effectiveValue&&(u[2]=this.delta.effectiveValue.serialize());break;case l.default.SLOT_USER_ENTERED_FORMAT_DELTA:this.delta.userEnteredFormatDelta&&(d=e.addCellFormatDelta(this.delta.userEnteredFormatDelta),u[3]=d,0!==(this.delta.userEnteredFormatDelta.setSlots&1<<c.default.DATA_VALIDATION)&&this.delta.userEnteredFormatDelta.delta.getDataValidation()&&(d=e.addDataValidationMap(this.delta.userEnteredFormatDelta.delta.getDataValidation()),u[4]=d));break;case l.default.SLOT_EFFIECTIVE_FORMAT_DELTA:this.delta.effectiveFormatDelta&&(d=e.addCellFormatDelta(this.delta.effectiveFormatDelta),u[5]=d);break;case l.default.SLOT_HYPERLINK:u[6]=this.delta.hyperlink;break;case l.default.SLOT_FORMULA:this.delta.formula&&(d=e.addFormula(this.delta.formula),u[7]=d);break;case l.default.SLOT_RICH_TEXT_STYLE_RUN:if(this.delta.textFormatRuns){for(s=[],n=0,o=this.delta.textFormatRuns.length;n<o;n++)s.push(this.delta.textFormatRuns[n].serialize());u[8]=s}break;case l.default.SLOT_IS_DATA_VALID:u[9]=this.delta.isDataValid?1:0;break;case l.default.SLOT_CONDITIONAL_FORMAT_DELTA:this.delta.conditionalFormatResult&&(d=e.addCellFormatDelta(new f.default({setSlots:this.delta.conditionalFormatResult.setSlots,clearSlots:0,delta:this.delta.conditionalFormatResult})),u[10]=d);break;case l.default.SLOT_MENTION:if(this.delta.mentionDetails){var h=[],I=!0,g=!1,R=void 0;try{for(var v,p=(0,r.default)((0,a.default)(this.delta.mentionDetails));!(I=(v=p.next()).done);I=!0){var T=v.value;h.push([T,this.delta.mentionDetails[T].serialize()])}}catch(E){g=!0,R=E}finally{try{!I&&p.return&&p.return()}finally{if(g)throw R}}u[11]=h}}return u}},{key:"isEmpty",value:function(){return 0===(this.setSlots|this.clearSlots)}},{key:"setSlot",value:function(e,t){var n=1<<e;switch(this.setSlots|=n,this.clearSlots=this.clearSlots&~n,e){case l.default.SLOT_EFFIECTIVE_VALUE:this.delta.effectiveValue=t;break;case l.default.SLOT_USER_ENTERED_FORMAT_DELTA:this.delta.userEnteredFormatDelta=t;break;case l.default.SLOT_EFFIECTIVE_FORMAT_DELTA:this.delta.effectiveFormatDelta=t;break;case l.default.SLOT_CONDITIONAL_FORMAT_DELTA:this.delta.conditionalFormatResult=t;break;case l.default.SLOT_HYPERLINK:this.delta.hyperlink=t;break;case l.default.SLOT_FORMULA:this.delta.formula=t;break;case l.default.SLOT_RICH_TEXT_STYLE_RUN:this.delta.textFormatRuns=t;break;case l.default.SLOT_IS_DATA_VALID:this.delta.isDataValid=t;break;case l.default.SLOT_AUTHOR:this.delta.author=t;break;case l.default.SLOT_MENTION:this.delta.mentionDetails=t}return this}},{key:"clearSlot",value:function(e){var t=1<<e;if(this.clearSlots|=t,(this.setSlots&t)>0)switch(this.setSlots=this.setSlots&~t,e){case l.default.SLOT_EFFIECTIVE_VALUE:this.delta.effectiveValue=null;break;case l.default.SLOT_USER_ENTERED_FORMAT_DELTA:this.delta.userEnteredFormatDelta=null;break;case l.default.SLOT_EFFIECTIVE_FORMAT_DELTA:this.delta.effectiveFormatDelta=null;break;case l.default.SLOT_CONDITIONAL_FORMAT_DELTA:this.delta.conditionalFormatResult=null;break;case l.default.SLOT_HYPERLINK:this.delta.hyperlink=null;break;case l.default.SLOT_FORMULA:this.delta.formula=null;break;case l.default.SLOT_RICH_TEXT_STYLE_RUN:this.delta.textFormatRuns=null;break;case l.default.SLOT_IS_DATA_VALID:this.delta.isDataValid=null;break;case l.default.SLOT_AUTHOR:this.delta.author=null;break;case l.default.SLOT_MENTION:this.delta.mentionDetails=null}return this}},{key:"removeSlot",value:function(e){var t=1<<e;return this.clearSlot(e),this.setSlots=this.setSlots&~t,this.clearSlots=this.clearSlots&~t,this}},{key:"clone",value:function(){var t={};if(this.delta.mentionDetails){var n=!0,o=!1,i=void 0;try{for(var l,d=(0,r.default)((0,a.default)(this.delta.mentionDetails));!(n=(l=d.next()).done);n=!0){var s=l.value;t[s]=this.delta.mentionDetails[s].clone()}}catch(u){o=!0,i=u}finally{try{!n&&d.return&&d.return()}finally{if(o)throw i}}}return new e({setSlots:this.setSlots,clearSlots:this.clearSlots,delta:{effectiveValue:this.delta.effectiveValue?this.delta.effectiveValue.clone():void 0,userEnteredFormatDelta:this.delta.userEnteredFormatDelta?this.delta.userEnteredFormatDelta.clone():void 0,effectiveFormatDelta:this.delta.effectiveFormatDelta?this.delta.effectiveFormatDelta.clone():void 0,conditionalFormatResult:this.delta.conditionalFormatResult?this.delta.conditionalFormatResult.clone():void 0,hyperlink:null!=this.delta.hyperlink?this.delta.hyperlink:void 0,formula:this.delta.formula?this.delta.formula.clone():void 0,textFormatRuns:this.delta.textFormatRuns?this.delta.textFormatRuns.map(function(e){return e.clone()}):void 0,isDataValid:null!=this.delta.isDataValid?this.delta.isDataValid:void 0,author:null!=this.delta.author?this.delta.author:void 0,mentionDetails:t}})}}],[{key:"deserialize",value:function(t,n){var a=void 0,r=void 0,o=void 0,i=new e({setSlots:0,clearSlots:t[1]}),u=t[0]||0,f=void 0;for(a=0;u>0;u>>=1,a++)if(1===(1&u))switch(a){case l.default.SLOT_EFFIECTIVE_VALUE:t[2]&&i.setSlot(l.default.SLOT_EFFIECTIVE_VALUE,s.default.deserialize(t[2]));break;case l.default.SLOT_USER_ENTERED_FORMAT_DELTA:void 0!==t[3]&&(void 0!==t[4]?(i.setSlot(l.default.SLOT_USER_ENTERED_FORMAT_DELTA,n[d.PROPERTIES_MAP_KEY.FORMAT][t[3]].clone()),i.delta.userEnteredFormatDelta.setSlot(c.default.DATA_VALIDATION,n[d.PROPERTIES_MAP_KEY.DATA_VALIDATION][t[4]])):i.setSlot(l.default.SLOT_USER_ENTERED_FORMAT_DELTA,n[d.PROPERTIES_MAP_KEY.FORMAT][t[3]]));break;case l.default.SLOT_EFFIECTIVE_FORMAT_DELTA:void 0!==t[5]&&i.setSlot(l.default.SLOT_EFFIECTIVE_FORMAT_DELTA,n[d.PROPERTIES_MAP_KEY.FORMAT][t[5]]);break;case l.default.SLOT_HYPERLINK:null==t[6]?i.clearSlot(l.default.SLOT_HYPERLINK):t[6]&&i.setSlot(l.default.SLOT_HYPERLINK,t[6]);break;case l.default.SLOT_FORMULA:void 0!==t[7]&&i.setSlot(l.default.SLOT_FORMULA,n[d.PROPERTIES_MAP_KEY.FORMULA][t[7]]);break;case l.default.SLOT_RICH_TEXT_STYLE_RUN:if(t[8]){for(f=[],r=0,o=t[8].length;r<o;r++)f.push(I.default.deserialize(t[8][r]));i.setSlot(l.default.SLOT_RICH_TEXT_STYLE_RUN,f)}break;case l.default.SLOT_IS_DATA_VALID:i.setSlot(l.default.SLOT_IS_DATA_VALID,!!t[9]);break;case l.default.SLOT_CONDITIONAL_FORMAT_DELTA:void 0!==t[10]&&i.setSlot(l.default.SLOT_CONDITIONAL_FORMAT_DELTA,n[d.PROPERTIES_MAP_KEY.FORMAT][t[10]].delta);break;case l.default.SLOT_MENTION:t[11]&&function(){var e={};[].concat(t[11]).forEach(function(t){var n=t[0],a=g.default.deserialize(t[1]);a&&(e[n]=a)}),i.setSlot(l.default.SLOT_MENTION,e)}()}return i}}]),e}();v.protoMap={0:{name:"setSlots",dataType:Number},1:{name:"clearSlots",dataType:Number},2:{name:"delta",dataType:{type:Object,protoMap:{0:{name:"effectiveValue",dataType:s.default},1:{name:"userEnteredFormatDelta",dataType:f.default},2:{name:"effectiveFormatDelta",dataType:f.default},4:{name:"hyperlink",dataType:String},5:{name:"formula",dataType:h.default},7:{name:"textFormatRuns",dataType:{type:Array,subType:I.default}},8:{name:"isDataValid",dataType:Boolean},9:{name:"conditionalFormatResult",dataType:u.default},10:{name:"mentionDetails",dataType:{type:Object,subType:g.default}}}}}},t.default=v},290:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(3)),r=h(n(0)),o=h(n(1)),i=h(n(4)),l=h(n(5)),d=h(n(20)),s=h(n(11)),u=n(69),f=h(n(13));function h(e){return e&&e.__esModule?e:{default:e}}var c=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,e.gridRanges?o.behaviors=e.gridRanges:n&&(o.behaviors=n.rangeSelections),o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,l=e.endColIndex,d=new s.default(this.sheetId,r,o,i,l),f=t.getSheetBySheetId(this.sheetId),h=void 0;if(f)for(a=(0,u.getUnmergeCellsMutation)(d,f),h=0;h<a.length;h++)n(a[h])}},{key:"id",get:function(){return f.default.UNMERGE_CELLS_REQUEST}}]),t}(d.default);t.default=c},291:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isNeedExtendFilterRange=function(e){var t=i.default.window.SpreadsheetApp;if(!t)return!1;var n=!1,a=t.spreadsheet.activeSheet.getBasicFilter();if(!a||!e)return!1;var r=a.getRange(),l=new o.default(r.sheetId,r.endRowIndex+1,r.endRowIndex+1,r.startColIndex,r.endColIndex);return e.forEach(function(e){if(function(e){for(var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,l=e.endColIndex,d=n,s=a,u=r,f=l,h=n;h<=a;h++)for(var c=r;c<=l;c++){var I=t.spreadsheet.activeSheet.getCellDataAtPosition(h,c),g=I&&I.getMergeReference();if(g&&!e.contain(g)){var R=g.startRowIndex,v=g.endRowIndex,p=g.startColIndex,T=g.endColIndex;d=Math.min(d,R),s=Math.max(s,v),u=Math.min(u,p),f=Math.max(f,T)}}return new o.default(e.sheetId,d,s,u,f)}(e).isCross(l))return n=!0,!1}),n};var a=n(164),r=d(a),o=d(n(11)),i=d(n(7)),l=n(317);function d(e){return e&&e.__esModule?e:{default:e}}function s(e){for(var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,d=e.endColIndex,s=t.spreadsheet.activeSheet.getRowCount()-1,u=a,f=a+1;f<=s;f++){for(var h=!0,c=r;c<=d;c++)if(!(0,l.isRangeCellBlank)(f,c)){h=!1;break}if(h)break;u=f}return new o.default(e.sheetId,n,u,r,d)}t.default=function(){var e=i.default.window.SpreadsheetApp,t=e.spreadsheet.activeSheet,n=e.spreadsheet.getActiveSheetId(),o=t.getBasicFilter();return o?[new r.default({updateType:a.FiltersModelUpdateType.UPDATE,sheetId:n,workbookRangeId:o.workbookRangeId,delta:{defaultFilterId:o.workbookRangeId,range:s(o.getRange())}})]:[]}},30:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(0)),r=c(n(1)),o=c(n(40)),i=c(n(110)),l=n(113),d=c(n(17)),s=c(n(138)),u=c(n(8)),f=n(82),h=n(26);function c(e){return e&&e.__esModule?e:{default:e}}var I=-1,g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,a.default)(this,e),this.id=t,this.version=(0,l.isNumber)(n.parentRequestId)?n.version:i.default.MUTATION_VER,this.parentRequestId=(0,l.isNumber)(n.parentRequestId)?n.parentRequestId:I,this.operationType=(0,l.isNumber)(n.operationType)?n.operationType:s.default.LOCAL}return(0,r.default)(e,[{key:"runOnWorkbook",value:function(e){}},{key:"checkSheetId",value:function(e){var t=this.getAffectedSheetId();return!t||e.getSheetId()===t}},{key:"check",value:function(e){return!0}},{key:"getAffectedGridRanges",value:function(){return[]}},{key:"getSizeEstimate",value:function(){return 1}},{key:"isNonPersistedLocalChange",value:function(){return!1}},{key:"run",value:function(e,t){var n=!0;if("undefined"!==typeof e.spreadsheetId){this.runOnWorkbook(e);var a,r=this.getAffectedSheets(e),o=void 0,i=void 0;for(i=0,a=r.length;i<a&&(o=r[i],n=this.checkAndRunOnSheet(o,t));i++);}else n=this.checkAndRunOnSheet(e,t);return n}},{key:"checkAndRunOnSheet",value:function(e,t){var n=+new Date,a=!1,r=!1;try{a=this.checkSheetId(e)&&this.check(e)}catch(i){u.default.run(h.CONFIG.CHECK_MUTATION_ERROR,this,i)}if(!a&&(u.default.run(h.CONFIG.CHECK_MUTATION_RESULT_ERROR,this),!t.ignoreCheck))return a;try{this.runOnSheet(e)}catch(i){console.error("Run mutation error: ",this,i),u.default.run(h.CONFIG.RUN_MUTATION_ERROR,i,this),i.message&&0===i.message.indexOf("ApiCheckError")||(r=!0)}if(u.default.speed.hasInitReport()||u.default.speed.runReport(h.SPEED_REPORT_POINTS.MUTATIONS_RUN,n,+new Date,!0),n=+new Date,!r){try{o.default.spreadsheetEvent.trigger("afterMutationRun",{sheetId:e.getSheetId(),mutation:this,sType:e.getParent().type,isLocal:t.isLocal,isFromFormula:t.isFromFormula,isCollab:t.isCollab,isReplay:t.isReplay})}catch(i){u.default.run(h.CONFIG.AFTER_MUTATION_RUN_CATCH_ERROR,i,this),console.error(i)}u.default.speed.hasInitReport()||u.default.speed.runReport(h.SPEED_REPORT_POINTS.AFTER_MUTATIONS_RUN,n,+new Date,!0)}try{o.default.spreadsheetEvent.trigger(f.EVENT_NAME.DATA_CHANGE,{type:"afterMutationRun"})}catch(i){return console.error(i),u.default.monitor(33660170),!1}return!r}},{key:"transform",value:function(e,t){switch(e.id){case d.default.INSERT_DIMENSION_MUTATION:return this.transformWithInsertDimensionMutation(e,t);case d.default.DELETE_DIMENSION_MUTATION:return this.transformWithDeleteDimensionMutation(e,t);case d.default.SET_DIMENSION_PROPERTIES_MUTATION:return this.transformWithSetDimensionPropertiesMutation(e,t);case d.default.SET_RANGE_MUTATION:return this.transformWithSetRangeMutation(e,t);case d.default.SET_CELL_PROPERTIES_MUTATION:return this.transformWithSetCellPropertiesMutation(e,t);case d.default.MERGE_CELLS_MUTATION:return this.transformWithMergeCellsMutation(e,t);case d.default.UNMERGE_CELLS_MUTATION:return this.transformWithUnmergeCellsMutation(e,t);case d.default.UPDATE_FILTERS_MODEL_MUTATION:return this.transformWithUpdateFiltersModelMutation(e,t);case d.default.DEFINE_FILTER_MUTATION:return this.transformWithDefineFilterMutation(e,t);case d.default.DELETE_FILTER_MUTATION:return this.transformWithDeleteFilterMutation(e,t);case d.default.UPDATE_FILTER_MUTATION:return this.transformWithUpdateFilterMutation(e,t);case d.default.ADD_EMBEDDED_OBJECT_MUTATION:return this.transformWithAddEmbeddedObjectMutation(e,t);case d.default.DELETE_EMBEDDED_OBJECT_MUTATION:return this.transformWithDeleteEmbeddedObjectMutation(e,t);case d.default.UPDATE_EMBEDDED_OBJECT_MUTATION:return this.transformWithUpdateEmbeddedObjectMutation(e,t);case d.default.INSERT_SHEET_MUTATION:return this.transformWithInsertSheetMutation(e,t);case d.default.DELETE_SHEET_MUTATION:return this.transformWithDeleteSheetMutation(e,t);case d.default.MOVE_SHEET_MUTATION:return this.transformWithMoveSheetMutation(e,t);case d.default.SET_SHEET_PROPERTIES_MUTATION:return this.transformWithSetSheetPropertiesMutation(e,t);case d.default.UPDATE_ALL_SHEETS_MUTATION:return this.transformWithUpdateAllSheetsMutation(e,t);case d.default.DEFINE_SHEET_RANGE_MUTATION:return this.transformWithDefineSheetRangeMutation(e,t);case d.default.DELETE_SHEET_RANGE_MUTATION:return this.transformWithDeleteSheetRangeMutation(e,t);case d.default.UPDATE_SHEET_RANGE_MUTATION:return this.transformWithUpdateSheetRangeMutation(e,t);case d.default.SET_WORKBOOK_PROPERTIES_MUTATION:return this.transformWithSetWorkbookPropertiesMutation(e,t);case d.default.COPY_PASTE_MUTATION:return this.transformWithCopyPasteMutation(e,t);case d.default.REORDER_RANGE_MUTATION:return this.transformWithReorderRangeMutation(e,t);case d.default.MAP_RANGE_MUTATION:return this.transformWithMapRangeMutation(e,t);case d.default.EMPTY_MUTATION:return this.transformWithEmptyMutation(e,t);case d.default.ADD_CONDITIONAL_FORMAT_MUTATION:return this.transformWithAddConditionalFormatMutation(e,t);case d.default.INIT_DATA_MUTATION:default:throw new Error("Should not have tried transforming the two mutations: "+this.id+","+e.id)}}},{key:"transformWithInsertDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,t){return[this]}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithSetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateFiltersModelMutation",value:function(e,t){return[this]}},{key:"transformWithDefineFilterMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteFilterMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateFilterMutation",value:function(e,t){return[this]}},{key:"transformWithAddEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateEmbeddedObjectMutation",value:function(e,t){return[this]}},{key:"transformWithInsertSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithMoveSheetMutation",value:function(e,t){return[this]}},{key:"transformWithSetSheetPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateAllSheetsMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetWorkbookPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}},{key:"transformWithMapRangeMutation",value:function(e,t){return[this]}},{key:"transformWithEmptyMutation",value:function(e,t){return[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){return[this]}},{key:"transformWithDeleteConditionalFormatMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){return[this]}}]),e}();t.default=g},314:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.GRID="grid",e.OBJECT="object",e.FORM="form"}(a||(a={})),t.default=a},315:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NUMBER_GREATER=1]="NUMBER_GREATER",e[e.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",e[e.NUMBER_LESS=3]="NUMBER_LESS",e[e.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",e[e.NUMBER_EQ=5]="NUMBER_EQ",e[e.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",e[e.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",e[e.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",e[e.TEXT_CONTAINS=9]="TEXT_CONTAINS",e[e.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",e[e.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",e[e.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",e[e.TEXT_EQ=13]="TEXT_EQ",e[e.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",e[e.TEXT_IS_URL=15]="TEXT_IS_URL",e[e.DATE_DURING=16]="DATE_DURING",e[e.DATE_EQ=17]="DATE_EQ",e[e.DATE_BEFORE=18]="DATE_BEFORE",e[e.DATE_AFTER=19]="DATE_AFTER",e[e.DATE_ON_OR_BEFORE=20]="DATE_ON_OR_BEFORE",e[e.DATE_ON_OR_AFTER=21]="DATE_ON_OR_AFTER",e[e.DATE_BETWEEN=22]="DATE_BETWEEN",e[e.DATE_NOT_BETWEEN=23]="DATE_NOT_BETWEEN",e[e.DATE_IS_VALID=24]="DATE_IS_VALID",e[e.ONE_OF_RANGE=25]="ONE_OF_RANGE",e[e.ONE_OF_LIST=26]="ONE_OF_LIST",e[e.BLANK=27]="BLANK",e[e.NOT_BLANK=28]="NOT_BLANK",e[e.CUSTOM_FORMULA=29]="CUSTOM_FORMULA",e[e.BOOLEAN=30]="BOOLEAN",e[e.ERROR=31]="ERROR",e[e.NOT_ERROR=32]="NOT_ERROR"}(a||(a={})),t.default=a},316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getRandomWorkbookRangeId=function(){return String((e=1e9,t=9999999999,Math.floor(Math.random()*(t-e+1))+e));var e,t}},317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.FILTER_RANGE_TYPE=void 0;var a=l(n(41));t.handleFilterRange=function(e){var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,l=e.endRowIndex,s=e.startColIndex,c=e.endColIndex,I=t.spreadsheet.activeSheet,g=I.getRowCount()-1,R=I.getColCount()-1,T=e,E=void 0;if(n===l)if(s===c)T=(0,o.default)(e),E=d.SINGLE_CELL;else{var m=u(e),_=f(m),y=(0,a.default)(_,2),x=y[0],S=y[1],O=I.getCellDataAtPosition(m.startRowIndex,S),C=O&&O.getMergeReference();C&&C.endColIndex>S&&(S=C.endColIndex),T=new r.default(e.sheetId,m.startRowIndex,m.endRowIndex,x,S),E=0===s&&c===R?d.ONE_ROW_WHOLE:d.ONE_ROW_PART}else if(0===n&&l===g)T=function(e){e.startRowIndex,e.endRowIndex;var t=e.startColIndex,n=e.endColIndex,o=h(e),i=(0,a.default)(o,2),l=i[0],d=i[1],s=f(new r.default(e.sheetId,l,d,t,n)),u=(0,a.default)(s,2),c=u[0],I=u[1];return new r.default(e.sheetId,l,d,c,I)}(e),E=s===c?d.ONE_COL_WHOLE:d.MULTI_COL_WHOLE;else if(v(e))T=(0,o.default)(e),E=d.SINGLE_MERGE_CELL;else if(function(e){for(var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=e.endColIndex,l=r;l<=o;l++){var d=t.spreadsheet.activeSheet.getCellDataAtPosition(n,l),s=d&&d.getMergeReference();if(s){var u=s.endRowIndex;if(u===a)return!0}}return!1}(e)){var D=new r.default(e.sheetId,l,l,s,c);D=u(D);var M=f(D=new r.default(e.sheetId,n,D.endRowIndex,s,c)),w=(0,a.default)(M,2),A=w[0],F=w[1];T=new r.default(e.sheetId,n,D.endRowIndex,A,F),E=d.MULTI_ROW_COL}else{var k=f(e),L=(0,a.default)(k,2),N=L[0],b=L[1];T=new r.default(e.sheetId,e.startRowIndex,e.endRowIndex,N,b),E=d.MULTI_ROW_COL}return[T,E,p(e)]},t.isRangeBlankInMergeMode=s,t.filterPreCheckSupport=function(e){if(s(e)){if(T(e)){var t=(0,o.default)(e);return!t.equals(e)}return!1}return!0},t.searchNotBlankColRange=f,t.searcNotBlankRowRange=h,t.isSingleCellBlank=c,t.isRangeCellBlank=I,t.isMergeCellBlank=R,t.isSingleRange=T;var r=l(n(11)),o=l(n(771)),i=l(n(7));function l(e){return e&&e.__esModule?e:{default:e}}var d=t.FILTER_RANGE_TYPE=void 0;function s(e){for(var t=e.startRowIndex;t<=e.endRowIndex;t++)for(var n=e.startColIndex;n<=e.endColIndex;n++)if(!I(t,n))return!1;return!0}function u(e){for(var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,a=e.endRowIndex,o=e.startColIndex,l=e.endColIndex,d=t.spreadsheet.activeSheet.getRowCount()-1,s=a,u=n;u<=d;u++){for(var f=!0,h=o;h<=l;h++)if(!I(u,h)){f=!1;break}if(f)break;s=u}return new r.default(e.sheetId,n,s,o,l)}function f(e){for(var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex,o=void 0,i=void 0,l=function(e){for(var a=t;a<=n;a++)if(!I(a,e))return!1;return!0},d=a;d<=r;d++)if(!l(d)){o=d;break}if(void 0===o)return[a,a];for(var s=r;s>o;s--)if(!l(s)){i=s;break}return void 0===i&&(i=o),[o,i]}function h(e){for(var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex,o=void 0,i=void 0,l=function(e){for(var t=a;t<=r;t++)if(!I(e,t))return!1;return!0},d=t;d<=n;d++)if(!l(d)){o=d;break}if(void 0===o)return[t,t];for(var s=n;s>o;s--)if(!l(s)){i=s;break}return void 0===i&&(i=o),[o,i]}function c(e,t){var n=i.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t),a=n&&n.getEditValue();return!a||""===a.toString().replace(/[\u200B-\u200D\uFEFF]/g,"")}function I(e,t){return g(e,t)?R(e,t):c(e,t)}function g(e,t){var n=i.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t);return!(!n||!n.getMergeReference())}function R(e,t){var n=i.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t),a=n&&n.getMergeReference();return!!a&&c(a.startRowIndex,a.startColIndex)}function v(e){var t=i.default.window.SpreadsheetApp,n=e.startRowIndex,a=(e.endRowIndex,e.startColIndex),r=(e.endColIndex,t.spreadsheet.activeSheet.getCellDataAtPosition(n,a)),o=r&&r.getMergeReference();return!!o&&o.equals(e)}function p(e){for(var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex,o=t;o<=n;o++)for(var i=a;i<=r;i++)if(g(o,i))return!0;return!1}function T(e){var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex;return t===n&&a===r||!!v(e)}!function(e){e[e.SINGLE_CELL=0]="SINGLE_CELL",e[e.SINGLE_MERGE_CELL=1]="SINGLE_MERGE_CELL",e[e.ONE_ROW_PART=2]="ONE_ROW_PART",e[e.ONE_ROW_WHOLE=3]="ONE_ROW_WHOLE",e[e.ONE_COL_WHOLE=4]="ONE_COL_WHOLE",e[e.MULTI_COL_WHOLE=5]="MULTI_COL_WHOLE",e[e.MULTI_ROW_COL=6]="MULTI_ROW_COL"}(d||(t.FILTER_RANGE_TYPE=d={}))},32:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NUMBER_FORMAT=0]="NUMBER_FORMAT",e[e.BACKGROUND_COLOR=1]="BACKGROUND_COLOR",e[e.BORDER_TOP=2]="BORDER_TOP",e[e.BORDER_BOTTOM=3]="BORDER_BOTTOM",e[e.BORDER_LEFT=4]="BORDER_LEFT",e[e.BORDER_RIGHT=5]="BORDER_RIGHT",e[e.HORIZONTAL_ALIGN=6]="HORIZONTAL_ALIGN",e[e.VERTICAL_ALIGN=7]="VERTICAL_ALIGN",e[e.WRAP_STRATEGY=8]="WRAP_STRATEGY",e[e.FOREGROUND_COLOR=9]="FOREGROUND_COLOR",e[e.FONT_FAMINY=10]="FONT_FAMINY",e[e.FONT_SIZE=11]="FONT_SIZE",e[e.BOLD=12]="BOLD",e[e.ITALIC=13]="ITALIC",e[e.STRIKETHROUGH=14]="STRIKETHROUGH",e[e.UNDERLINE=15]="UNDERLINE",e[e.DATA_VALIDATION=16]="DATA_VALIDATION"}(a||(a={}));var r={ALL:Math.pow(2,a.DATA_VALIDATION+1)-1,BORDERS:1<<a.BORDER_TOP&1<<a.BORDER_BOTTOM&1<<a.BORDER_LEFT&1<<a.BORDER_RIGHT};t.default=a,t.CELL_FORMAT_SLOT_COMPOSE=r},33:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CELL_FONT_FORMAT=t.GRIDLINE_BORDER_COLOR=t.GRIDLINE_BORDER_STYLE=t.CSS_BORDER_STYLE=t.BORDER_STYLE_PRIORITY=t.BORDER_STYLE=t.BORDER_WIDTH=t.BORDER_TYPE=t.DEFAULT_CELL_FORMAT_LITERAL=t.HYPERLINK_COLOR=t.MAX_CELL_COUNT=t.MAX_COL_COUNT=t.MAX_ROW_COUNT=t.DEFAULT_TAB_COLOR=t.DEFAULT_ROW_HEIGHT=t.DEFAULT_COL_WIDTH=t.DEFAULT_COL_COUNT=t.DEFAULT_ROW_COUNT=void 0;var a,r,o=f(n(83)),i=f(n(81)),l=f(n(221)),d=f(n(182)),s=f(n(225)),u=f(n(108));function f(e){return e&&e.__esModule?e:{default:e}}var h,c,I;t.DEFAULT_ROW_COUNT=200,t.DEFAULT_COL_COUNT=26,t.DEFAULT_COL_WIDTH=107,t.DEFAULT_ROW_HEIGHT=i.default.util.userAgent.isMobile?33:22,t.DEFAULT_TAB_COLOR="#ffffff",t.MAX_ROW_COUNT=2e5,t.MAX_COL_COUNT=1e3,t.MAX_CELL_COUNT=2e5,t.HYPERLINK_COLOR="#0000ff",t.DEFAULT_CELL_FORMAT_LITERAL={numberFormat:{id:0,type:l.default.GENERAL,pattern:"General"},backgroundColor:"#ffffff",borderColor:"#cdcdcd",horizontalAlign:d.default.LEFT,verticalAlign:s.default.MIDDLE,wrapStrategy:u.default.OVERFLOW_CELL,color:"#000000",fontSize:10,fontFamily:"Microsoft YaHei,\u5fae\u8f6f\u96c5\u9ed1",bold:!1,italic:!1,strikethrough:!1,underline:null};!function(e){e[e.NONE=0]="NONE",e[e.THIN=3]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.DASHED=1]="DASHED",e[e.DOTTED=4]="DOTTED",e[e.THICK=5]="THICK",e[e.DOUBLE=6]="DOUBLE",e[e.HAIR=7]="HAIR",e[e.MEDIUM_DASHED=8]="MEDIUM_DASHED",e[e.DASH_DOT=9]="DASH_DOT",e[e.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",e[e.DASH_DOT_DOT=11]="DASH_DOT_DOT",e[e.MEDIUM_DASH_DOT_DOT=12]="MEDIUM_DASH_DOT_DOT",e[e.SLANTED_DASH_DOT=13]="SLANTED_DASH_DOT"}(h||(t.BORDER_STYLE=h={})),function(e){e.TOP="top",e.BOTTOM="bottom",e.LEFT="left",e.RIGHT="right",e.DIAG_DOWN="diagDown",e.DIAG_UP="diagUp",e.MIDDLE="middle",e.CENTER="center"}(c||(t.BORDER_TYPE=c={})),function(e){e[e.NONE=0]="NONE",e[e.THIN=1]="THIN",e[e.MEDIUM=2]="MEDIUM",e[e.THICK=3]="THICK"}(I||(t.BORDER_WIDTH=I={}));var g=(a={},(0,o.default)(a,h.NONE,0),(0,o.default)(a,h.HAIR,1),(0,o.default)(a,h.DASH_DOT,2),(0,o.default)(a,h.DASH_DOT_DOT,3),(0,o.default)(a,h.DOTTED,4),(0,o.default)(a,h.DASHED,5),(0,o.default)(a,h.THIN,6),(0,o.default)(a,h.MEDIUM_DASH_DOT_DOT,7),(0,o.default)(a,h.SLANTED_DASH_DOT,8),(0,o.default)(a,h.MEDIUM_DASH_DOT,9),(0,o.default)(a,h.MEDIUM_DASHED,10),(0,o.default)(a,h.MEDIUM,11),(0,o.default)(a,h.THICK,12),(0,o.default)(a,h.DOUBLE,13),a),R=(r={},(0,o.default)(r,h.NONE,"none"),(0,o.default)(r,h.HAIR,".5pt hairline"),(0,o.default)(r,h.DASH_DOT,".5pt dot-dash"),(0,o.default)(r,h.DASH_DOT_DOT,".5pt dot-dot-dash"),(0,o.default)(r,h.DOTTED,".5pt dotted"),(0,o.default)(r,h.DASHED,".5pt dashed"),(0,o.default)(r,h.THIN,".5pt solid"),(0,o.default)(r,h.MEDIUM_DASH_DOT_DOT,"1.0pt dot-dot-dash"),(0,o.default)(r,h.SLANTED_DASH_DOT,"1.0pt dot-dash-slanted"),(0,o.default)(r,h.MEDIUM_DASH_DOT,"1.0pt dot-dash"),(0,o.default)(r,h.MEDIUM_DASHED,"1.0pt dashed"),(0,o.default)(r,h.MEDIUM,"1.0pt solid"),(0,o.default)(r,h.DOUBLE,"2.0pt double"),(0,o.default)(r,h.THICK,"1.5pt solid"),r),v=h.THIN;t.BORDER_TYPE=c,t.BORDER_WIDTH=I,t.BORDER_STYLE=h,t.BORDER_STYLE_PRIORITY=g,t.CSS_BORDER_STYLE=R,t.GRIDLINE_BORDER_STYLE=v,t.GRIDLINE_BORDER_COLOR="#dcdcdc",t.CELL_FONT_FORMAT={PADDING_RIGHT:4,PADDING_RIGHT_FILTER:26,PADDING_RIGHT_FILTER_M:30}},35:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(81)),i=d(n(15)),l=n(51);function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n,r,o){(0,a.default)(this,e),this.sheetId=t,this.startIndex=n,this.endIndex=r,this.dimension=o}return(0,r.default)(e,[{key:"isValid",value:function(){return o.default.util.type.isNumber(this.startIndex)&&o.default.util.type.isNumber(this.endIndex)&&this.startIndex>=0&&this.startIndex<=this.endIndex}},{key:"equals",value:function(e){return this.sheetId===e.sheetId&&this.startIndex===e.startIndex&&this.endIndex===e.endIndex&&this.dimension===e.dimension}},{key:"insert",value:function(e,t){var n=!0;return this.startIndex>=e?(this.startIndex+=t,this.endIndex+=t):this.endIndex>=e?this.endIndex+=t:-1===this.startIndex&&-1===this.endIndex||(n=!1),n}},{key:"delete",value:function(e,t){var n=!0;return e<=this.startIndex?(this.startIndex=Math.max(e,this.startIndex-t),this.endIndex=this.endIndex-t):e<=this.endIndex?this.endIndex=Math.max(e-1,this.endIndex-t):-1===this.startIndex&&-1===this.endIndex||(n=!1),n}},{key:"divideByCross",value:function(t){var n=[],a=null,r=this.sheetId,o=this.clone(),i=t.clone();if(-1===o.startIndex||-1===o.endIndex||-1===i.startIndex||-1===i.endIndex)throw new Error("divideByCross\u4e2d\u53c2\u6570\u4e0d\u80fd\u662f\u5168\u9009\u7684range");return o.startIndex<=i.startIndex?o.endIndex<i.startIndex?n.push(o):(n.push(new e(r,o.startIndex,i.startIndex-1,o.dimension)),i.endIndex<=o.endIndex?(a=new e(r,i.startIndex,i.endIndex,o.dimension),n.push(new e(r,i.endIndex+1,o.endIndex,o.dimension))):(a=new e(r,i.startIndex,o.endIndex,o.dimension),n.push(new e(r,o.endIndex+1,i.endIndex,o.dimension)))):i.endIndex<o.startIndex?n.push(o):i.endIndex>=o.endIndex?a=new e(r,o.startIndex,o.endIndex,o.dimension):(a=new e(r,o.startIndex,i.endIndex,o.dimension),n.push(new e(r,i.endIndex+1,o.endIndex,o.dimension))),{ranges:n,cross:a}}},{key:"move",value:function(t){var n=[],a=this.divideByCross(new e(this.sheetId,t.from.startIndex,t.from.endIndex,this.dimension)),r=0;return a.cross?(Array.prototype.push.apply(n,a.ranges),r=t.from.startIndex-t.to,a.cross.startIndex-=r,a.cross.endIndex-=r,n.push(a.cross)):n=[this],n}},{key:"isCross",value:function(e){return this.dimension===e.dimension&&(e.endIndex>=this.startIndex&&e.startIndex<=this.endIndex)}},{key:"contain",value:function(e){return this.dimension===e.dimension&&(this.startIndex<=e.startIndex&&this.endIndex>=e.endIndex)}},{key:"toDimensionData",value:function(){return{index:this.startIndex,amount:Math.max(0,this.endIndex-this.startIndex+1),type:this.dimension}}},{key:"toString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this.dimension===i.default.ROWS?(e?this.sheetId+"!":"")+this.startIndex+":"+this.endIndex:(e?this.sheetId+"!":"")+(0,l.toChar)(this.startIndex)+":"+(0,l.toChar)(this.endIndex)}},{key:"clone",value:function(){return new e(this.sheetId,this.startIndex,this.endIndex,this.dimension)}},{key:"splitRanges",value:function(){for(var t=this.startIndex,n=this.endIndex,a=[],r=t;r<=n;r++)a.push(new e(this.sheetId,r,r,this.dimension));return a}}],[{key:"newInstance",value:function(t){return new e(t.sheetId,t.startIndex,t.endIndex,t.dimension)}}]),e}();s.protoMap={0:{name:"sheetId",dataType:"sheetId"},1:{name:"dimension",dataType:String},2:{name:"startIndex",dataType:Number},3:{name:"endIndex",dataType:Number}},t.default=s},364:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.ERROR=0]="ERROR",e[e.NULL_VALUE=1]="NULL_VALUE",e[e.DIVIDE_BY_ZERO=2]="DIVIDE_BY_ZERO",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.N_A=7]="N_A",e[e.LOADING=8]="LOADING"}(a||(a={})),t.default=a},368:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NORMAL="normal",e.JUSTIFIED="justified",e.ERROR="error"}(a||(a={})),t.default=a},369:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getAbsoluteNumber=t.toColumnName=t.makeSelectionInOrder=void 0;var a,r=n(41),o=(a=r)&&a.__esModule?a:{default:a};t.makeSelectionInOrder=function(e){return/\$?[A-Z]+\$?\d+:\$?[A-Z]+\$?\d+/.test(e)?(e=e.replace(/(\s*:\s*)+/g,":")).replace(/[A-Z]+\d+:+[A-Z]+\d+/g,function(e){if(!~e.indexOf(":"))return e;var t=e.split(":"),n=(0,o.default)(t,2),a=n[0],r=n[1],i=/[A-Z]+|[0-9]+/g,l=a.match(i)||[],d=r.match(i)||[];if(2===l.length&&2===d.length){var s=(0,o.default)(l,2),u=s[0],f=s[1],h=(0,o.default)(d,2),c=h[0],I=h[1],g=void 0,R=void 0,v=void 0,p=void 0;return u<c?(g=u,v=c):(g=c,v=u),Number(f)<Number(I)?(R=f,p=I):(R=I,p=f),""+g+R+":"+v+p}return e}):e},t.toColumnName=function(e){for(var t="",n=1,a=26;(e-=n)>=0;n=a,a*=26)t=String.fromCharCode(Math.floor(e%a/n)+65)+t;return t},t.getAbsoluteNumber=function(e,t,n){return e+(n?t:0)}},372:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.INSERT_ROWS="insertRows",e.INSERT_COLS="insertCols",e.DELETE_ROWS="deleteRows",e.DELETE_COLS="deleteCols",e.SET_CELLS="setCells"}(a||(a={})),t.default=a},373:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a};var i=function e(t){(0,o.default)(this,e),this.rowIndex=t.rowIndex,this.colIndex=t.colIndex};i.protoMap={1:{name:"rowIndex",dataType:Number},2:{name:"colIndex",dataType:Number}},t.default=i},374:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(277));function o(e){return e&&e.__esModule?e:{default:e}}var i=function e(t){(0,a.default)(this,e),this.overlayPosition=t.overlayPosition};i.protoMap={1:{name:"overlayPosition",dataType:r.default}},t.default=i},375:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a};var i=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e),this.clipTop=t.clipTop||0,this.clipLeft=t.clipLeft||0,this.clipRight=t.clipRight||0,this.clipBottom=t.clipBottom||0};i.protoMap={0:{name:"clipTop",dataType:Number},1:{name:"clipLeft",dataType:Number},2:{name:"clipRight",dataType:Number},3:{name:"clipBottom",dataType:Number}},t.default=i},376:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=f(n(63)),r=f(n(3)),o=f(n(0)),i=f(n(4)),l=f(n(5)),d=f(n(377)),s=f(n(11)),u=f(n(186));function f(e){return e&&e.__esModule?e:{default:e}}var h=function(e){function t(e){return(0,o.default)(this,t),(0,i.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return(0,l.default)(t,e),t}(d.default);h.protoMap={0:{name:"range",dataType:s.default},1:{name:"workbookRangeId",dataType:String},2:{name:"sprtSpecs",dataType:Array,subType:{type:Object,protoMap:{0:{name:"dimensionIndex",dataType:Number},1:{name:"sortOrder",dataType:Number}}}},3:{name:"criteriaMap",dataType:{type:a.default,subType:u.default}},4:{name:"hiddenRows",dataType:Array,subType:Number}},t.default=h},377:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(63)),r=u(n(0)),o=u(n(1)),i=u(n(11)),l=u(n(15)),d=u(n(35)),s=u(n(372));function u(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,r.default)(this,e),this.range=t.range,this.workbookRangeId=t.workbookRangeId,this.sortSpecs=t.sortSpecs||[],this.criteriaMap=t.criteriaMap||new a.default,this.filterHideRowMap=new a.default,this.setHiddenRows(t.hiddenRows||[]),t.positionCenter&&this.active(t.positionCenter)}return(0,o.default)(e,[{key:"active",value:function(e){this.addPositionCenter(e)}},{key:"inActive",value:function(){this.removePositionCenter()}},{key:"addPositionCenter",value:function(e){this.positionCenter!==e&&(this.positionCenter&&this.inActive(),this.positionCenter=e,this.addRangeToPositionCenter(),this.addCriteriaMapToPositionCenter())}},{key:"addRangeToPositionCenter",value:function(){var e=this;if(this.positionCenter){var t=this.range;this.rangePositionCenterKey=this.positionCenter.add({type:"sheet-filter-range",selfData:{xRange:new d.default(t.sheetId,t.startColIndex,t.endColIndex,l.default.COLUMNS),yRange:new d.default(t.sheetId,t.startRowIndex,t.endRowIndex,l.default.ROWS)},calc:function(n,a,r){e.setRange(new i.default(t.sheetId,n.yRange.startIndex,n.yRange.endIndex,n.xRange.startIndex,n.xRange.endIndex));var o=e.getHiddenRows(),l=[],d=r.index,u=r.amount,f=!1;a===s.default.INSERT_ROWS?(o.forEach(function(e){e<d?l.push(e):e>=d&&l.push(e+u)}),f=!0):a===s.default.DELETE_ROWS&&(o.forEach(function(e){e<d?l.push(e):e>d+u-1&&l.push(e-u)}),f=!0),f&&e.setHiddenRows(l)}})}}},{key:"updateRangeToPositionCenter",value:function(){if(this.positionCenter&&this.rangePositionCenterKey){var e=this.range;this.positionCenter.changeSelfData(this.rangePositionCenterKey,{xRange:new d.default(e.sheetId,e.startColIndex,e.endColIndex,l.default.COLUMNS),yRange:new d.default(e.sheetId,e.startRowIndex,e.endRowIndex,l.default.ROWS)})}}},{key:"addCriteriaMapToPositionCenter",value:function(){var e=this;this.positionCenter&&this.criteriaMap.forEach(function(t,n){e.addCriteriaToPositionCenter(n,t)})}},{key:"addCriteriaToPositionCenter",value:function(e,t){var n=this;if(this.positionCenter){var a=this.range;t.positionCenterKey=this.positionCenter.add({type:"sheet-filter-criteria",selfData:{xRange:new d.default(a.sheetId,e,e,l.default.COLUMNS),colIndex:e},calc:function(e,a,r){var o=e.xRange;o.startIndex>o.endIndex?n.removeCriteriaFromPositionCenter(t):(n.updateColFilterCriteria(e.colIndex,o.startIndex,t),e.colIndex=o.startIndex)}})}}},{key:"removePositionCenter",value:function(){this.positionCenter&&(this.removeRangeFromPositionCenter(),this.removeCriteriaMapFromToPositionCenter(),delete this.positionCenter)}},{key:"removeRangeFromPositionCenter",value:function(){this.positionCenter&&this.rangePositionCenterKey&&this.positionCenter.remove(this.rangePositionCenterKey)}},{key:"removeCriteriaMapFromToPositionCenter",value:function(){var e=this;this.positionCenter&&this.criteriaMap.forEach(function(t,n){e.removeCriteriaFromPositionCenter(t)})}},{key:"removeCriteriaFromPositionCenter",value:function(e){this.positionCenter&&e.positionCenterKey&&this.positionCenter.remove(e.positionCenterKey)}},{key:"getRange",value:function(){return this.range}},{key:"setRange",value:function(e){return this.range.equals(e)||(this.range=e,this.rangePositionCenterKey?this.updateRangeToPositionCenter():this.addRangeToPositionCenter()),this}},{key:"getColFilterCriteria",value:function(e){return this.criteriaMap.get(e)||null}},{key:"setColFilterCriteria",value:function(e,t){return this.criteriaMap.get(e)!==t&&(this.deleteColFilterCriteria(e),this.criteriaMap.set(e,t),this.addCriteriaToPositionCenter(e,t)),this}},{key:"deleteColFilterCriteria",value:function(e){var t=this.criteriaMap.get(e);return t&&(this.criteriaMap.delete(e),this.removeCriteriaFromPositionCenter(t)),this}},{key:"updateColFilterCriteria",value:function(e,t,n){return this.deleteColFilterCriteria(e),this.setColFilterCriteria(t,n),this}},{key:"getHiddenRows",value:function(){return this.hiddenRows}},{key:"setHiddenRows",value:function(e){return this.hiddenRows=e,this.filterHideRowMap=e.reduce(function(e,t){return e.set(t,"foke"),e},new a.default),this}},{key:"clone",value:function(){var t=new e({range:this.range,workbookRangeId:this.workbookRangeId,sortSpecs:this.sortSpecs,criteriaMap:this.criteriaMap,hiddenRows:this.hiddenRows});return t.positionCenter=this.positionCenter,t}}]),e}();t.default=f},378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));function o(e){return e&&e.__esModule?e:{default:e}}var i=function(){function e(t,n,r){(0,a.default)(this,e),this.sheetId=t,this.rowIndex=n,this.colIndex=r}return(0,r.default)(e,[{key:"equal",value:function(e){return this.sheetId===e.sheetId&&this.rowIndex===e.rowIndex&&this.colIndex===e.colIndex}}]),e}();t.default=i},379:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(84)),r=l(n(204)),o=l(n(0)),i=l(n(1));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(t,n,a,r){(0,o.default)(this,e),this.activeCell=t,this.rangeSelections=n,this.copySelections=a,this.isEditing=r}return(0,i.default)(e,[{key:"getRows",value:function(){var e,t=void 0,n=void 0,o=[],i=void 0;for(t=0;t<this.rangeSelections.length;t++)for(n=(i=this.rangeSelections[t]).startRowIndex;n<=i.endRowIndex;n++)o.push(n);return o=o.sort(function(e,t){return e-t}),e=new r.default(o),(0,a.default)(e)}},{key:"getCols",value:function(){var e,t=void 0,n=void 0,o=[],i=void 0;for(t=0;t<this.rangeSelections.length;t++)for(n=(i=this.rangeSelections[t]).startColIndex;n<=i.endColIndex;n++)o.push(n);return e=new r.default(o),(0,a.default)(e)}}]),e}();t.default=d},380:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=W(n(63)),r=W(n(25)),o=W(n(9)),i=W(n(41)),l=W(n(31)),d=W(n(0)),s=W(n(1)),u=W(n(81)),f=n(33),h=n(1124),c=W(n(54)),I=W(n(29)),g=W(n(227)),R=W(n(18)),v=n(55),p=W(n(52)),T=W(n(39)),E=W(n(381)),m=W(n(228)),_=W(n(276)),y=W(n(115)),x=W(n(15)),S=W(n(35)),O=W(n(11)),C=W(n(376)),D=W(n(186)),M=W(n(657)),w=W(n(662)),A=W(n(187)),F=n(48),k=W(n(1125)),L=W(n(96)),N=W(n(656)),b=W(n(372)),P=W(n(1128)),U=W(n(7)),B=W(n(121)),G=W(n(277)),V=W(n(109)),H=n(57);function W(e){return e&&e.__esModule?e:{default:e}}var z=function(){function e(t){(0,d.default)(this,e),this.parent=t.parent,this.initPositionCenter(),this.initProperties(t.properties),this.initData(t.data),this.initMerges(t.merges),this.initBasicFilter(t.basicFilter),this.initImages(t.images),this.initSheetRangeControl(t.sheetRangeControl),this.initConditionalFormatRuleManager(t.conditionalFormatRuleManager),this._standardHeight=t._standardHeight||f.DEFAULT_ROW_HEIGHT,this._standardWidth=t._standardWidth||f.DEFAULT_COL_WIDTH,t.customNumberFormatMap&&(this.customNumberFormatMap=t.customNumberFormatMap),this.isFetching=!!t.isFetching,this.isLoaded=!!t.isLoaded,this.isReadonly=!!t.isReadonly,this.initMentions(t.mentionsMap)}return(0,s.default)(e,[{key:"serialize",value:function(){var e=void 0,t=void 0,n=void 0,a=void 0,r=void 0,d={};d[0]=[this.data.startRow,this.data.startColumn];var s=new g.default,u=[],f=void 0,h=void 0,c=void 0,v=void 0,p=void 0;for(e=0,t=this.data.rowData.length;e<t;e++)if(f=this.data.rowData[e])for(n=0,a=f.values.length;n<a;n++)if((h=f.values[n])&&!h.isEmpty()){for(v=new I.default({setSlots:h.setSlots,clearSlots:0,delta:{}}),p=h.setSlots,r=0;p>0;p>>=1,r++)if(1===(1&p))switch(r){case R.default.SLOT_EFFIECTIVE_VALUE:v.delta.effectiveValue=h.getEffectiveValue();break;case R.default.SLOT_USER_ENTERED_FORMAT_DELTA:(c=h.getUserEnteredFormat())&&(v.delta.userEnteredFormatDelta=new T.default({setSlots:c.setSlots,clearSlots:0,delta:c}));break;case R.default.SLOT_EFFIECTIVE_FORMAT_DELTA:(c=h.getEffectiveFormat())&&(v.delta.effectiveFormatDelta=new T.default({setSlots:c.setSlots,clearSlots:0,delta:c}));break;case R.default.SLOT_HYPERLINK:v.delta.hyperlink=h.getHyperlink();break;case R.default.SLOT_FORMULA:v.delta.formula=h.getFormula();break;case R.default.SLOT_RICH_TEXT_STYLE_RUN:v.delta.textFormatRuns=h.getTextFormatRuns();break;case R.default.SLOT_IS_DATA_VALID:v.delta.isDataValid=h.getIsDataValid();break;case R.default.SLOT_MENTION:v.delta.mentionDetails=h.getMentionDetails()}u.push([e,n,v.serialize(s)])}d[0][2]=[u,s.serializedPropertiesMap],d[0][3]={};var E=void 0;for(e=0,t=this.data.rowMetadata.length;e<t;e++)(E=this.data.rowMetadata[e])&&(d[0][3][e]=[E.hiddenByFilter?1:0,E.hiddenByUser?1:0],null!==E.pixelSize&&(d[0][3][e][2]=E.pixelSize),E.formData&&(d[0][3][e][3]=E.formData.serialize()));for(d[0][4]={},e=0,t=this.data.columnMetadata.length;e<t;e++)(E=this.data.columnMetadata[e])&&(d[0][4][e]=[E.hiddenByFilter?1:0,E.hiddenByUser?1:0],null!==E.pixelSize&&(d[0][4][e][2]=E.pixelSize),E.formData&&(d[0][4][e][3]=E.formData.serialize()));if(this.basicFilter){d[1]=[[this.basicFilter.range.startRowIndex,this.basicFilter.range.endRowIndex,this.basicFilter.range.startColIndex,this.basicFilter.range.endColIndex],this.basicFilter.workbookRangeId],d[1][2]=[];var m=!0,_=!1,y=void 0;try{for(var x,S=(0,l.default)(this.basicFilter.criteriaMap.entries());!(m=(x=S.next()).done);m=!0){var O=(0,i.default)(x.value,2),C=O[0],D=O[1];d[1][2].push([C,[D.hiddenValues,D.visibleValues]])}}catch($){_=!0,y=$}finally{try{!m&&S.return&&S.return()}finally{if(_)throw y}}d[1][3]=this.basicFilter.hiddenRows}if(this.merges.length>0){d[2]=[];var M=void 0;for(e=0,t=this.merges.length;e<t;e++)M=this.merges[e],d[2].push([M.startRowIndex,M.endRowIndex,M.startColIndex,M.endColIndex])}var w=(0,o.default)(this.images),A=void 0;if(w.length>0)for(d[3]=[],e=0,t=w.length;e<t;e++)A=this.images[w[e]],d[3].push([A.id,[A.position.overlayPosition.widthPixels,A.position.overlayPosition.heightPixels,A.position.overlayPosition.anchorCell.rowIndex,A.position.overlayPosition.anchorCell.colIndex,A.position.overlayPosition.offsetXpixels,A.position.overlayPosition.offsetYpixels,A.position.overlayPosition.zIndex],A.url,[A.clipInfo.clipTop,A.clipInfo.clipLeft,A.clipInfo.clipRight,A.clipInfo.clipBottom]]);d[4]=[this.properties.title,this.properties.sheetType,[this.properties.gridProperties.rowCount,this.properties.gridProperties.columnCount,this.properties.gridProperties.frozenRowCount,this.properties.gridProperties.frozenColCount,this.properties.gridProperties.hideGridlines?1:0,this.properties.gridProperties.rowGroupControlAfter?1:0,this.properties.gridProperties.columnGroupControlAfter?1:0],this.properties.hidden?1:0,this.properties.tabColor.serialize(),this.properties.rightToLeft?1:0];var F=[],k=!0,L=!1,N=void 0;try{for(var b,P=(0,l.default)(this.customNumberFormatMap.entries());!(k=(b=P.next()).done);k=!0){var U=(0,i.default)(b.value,2);C=U[0],D=U[1];F.push([C,D])}}catch($){L=!0,N=$}finally{try{!k&&P.return&&P.return()}finally{if(L)throw N}}F.length>0&&(d[5]=F);var B=(0,o.default)(this.sheetRangeControl.ranges),G=void 0;if(B.length>0)for(d[6]=[],e=0,t=B.length;e<t;e++)G=this.sheetRangeControl.ranges[B[e]],d[6].push([B[e],G.sheetRangeType,[G.gridRange.startRowIndex,G.gridRange.endRowIndex,G.gridRange.startColIndex,G.gridRange.endColIndex],G.padId]);if(this.conditionalFormatRuleManager.conditionalFormatRules.length>0){var V=void 0;for(d[7]=[],e=0,t=this.conditionalFormatRuleManager.conditionalFormatRules.length;e<t;e++)V=this.conditionalFormatRuleManager.conditionalFormatRules[e],d[7].push([V.index,V.rule.serialize()])}if(this.mentionsMap){d[8]=[];var H=!0,W=!1,z=void 0;try{for(var Y,j=(0,l.default)((0,o.default)(this.mentionsMap));!(H=(Y=j.next()).done);H=!0){var K=Y.value;d[8].push([K].concat(this.mentionsMap[K].serialize()))}}catch($){W=!0,z=$}finally{try{!H&&j.return&&j.return()}finally{if(W)throw z}}}return d}},{key:"initPositionCenter",value:function(){this.positionCenter=new N.default}},{key:"initProperties",value:function(e){this.properties=e||new E.default}},{key:"initData",value:function(e){this.setData(e||{startRow:0,startColumn:0,rowData:[],rowMetadata:[],columnMetadata:[]})}},{key:"initMerges",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=void 0;for(this.merges=[],n=0,e=t.length;n<e;n++)try{this.addMerge(t[n])}catch(a){}}},{key:"initBasicFilter",value:function(e){this.setBasicFilter(e||null)}},{key:"initImages",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.images={};var t=!0,n=!1,a=void 0;try{for(var r,i=(0,l.default)((0,o.default)(e));!(t=(r=i.next()).done);t=!0){var d=r.value;this.addImage(e[d])}}catch(s){n=!0,a=s}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}}},{key:"initSheetRangeControl",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.sheetRangeControl=new w.default({parent:this}),e.ranges){var t=!0,n=!1,a=void 0;try{for(var r,i=(0,l.default)((0,o.default)(e.ranges));!(t=(r=i.next()).done);t=!0){var d=r.value;this.addSheetRange(d,e.ranges[d])}}catch(s){n=!0,a=s}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}}}},{key:"initConditionalFormatRuleManager",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this.conditionalFormatRuleManager=new k.default({parent:this}),e.conditionalFormatRules){var t,n=void 0;for(n=0,t=e.conditionalFormatRules.length;n<t;n++)this.conditionalFormatRuleManager.addConditionalFormatRule(e.conditionalFormatRules[n].index,e.conditionalFormatRules[n].rule)}}},{key:"getConditionalFormatRule",value:function(){return this.conditionalFormatRuleManager}},{key:"initMentions",value:function(e){if(e){var t=!0,n=!1,a=void 0;try{for(var r,i=(0,l.default)((0,o.default)(e));!(t=(r=i.next()).done);t=!0){var d=r.value;this.addMention(d,e[d])}}catch(s){n=!0,a=s}finally{try{!t&&i.return&&i.return()}finally{if(n)throw a}}}}},{key:"_debugCheckPositionCenter",value:function(){var e=this.positionCenter;e._cleanUp(),console.log("\u300c"+this.getSheetId()+"\u300dsheet\u4e0a\u5171\u76d1\u542c\u4e86"+e.queue.length+"\u4e2arange"),e.queue.forEach(function(e,t){console.log("\u7b2c"+t+"\u4e2arange\u7684\u7c7b\u578b\u662f"+e.type)}),console.log("\u68c0\u6d4b\u5b8c\u6bd5")}},{key:"getParent",value:function(){return this.parent}},{key:"setParent",value:function(e){return this.parent=e,this}},{key:"getData",value:function(){return this.data}},{key:"setData",value:function(e){this.data=e,this.setRowCount(Math.max(this.properties.gridProperties.rowCount,this.getDataRowCount(),this.data.rowMetadata.length)),this.setColCount(Math.max(this.properties.gridProperties.columnCount,this.getDataColCount(),this.data.columnMetadata.length));var t=this.getRowCount(),n=this.getColCount();return t>f.MAX_ROW_COUNT&&u.default.report.monitor(u.default.config.report.MONITOR_POINTS.SHEET_ROW_COUNT_EXCEED),n>f.MAX_COL_COUNT&&u.default.report.monitor(u.default.config.report.MONITOR_POINTS.SHEET_COL_COUNT_EXCEED),t*n>f.MAX_CELL_COUNT&&u.default.report.monitor(u.default.config.report.MONITOR_POINTS.SHEET_CELL_COUNT_EXCEED),this}},{key:"getDataRowCount",value:function(){return this.data.rowData.length}},{key:"getDataColCount",value:function(){var e,t=0,n=void 0;for(n=0,e=this.data.rowData.length;n<e;n++)this.data.rowData[n]&&(t=Math.max(t,this.data.rowData[n].values.length));return t}},{key:"clearRowData",value:function(){return this.data.rowData=[],this}},{key:"getMerges",value:function(){return this.merges}},{key:"addMerge",value:function(e){var t=this;if(!e.isValid()||e.isSingle()||e.endRowIndex>=this.getRowCount()||e.endColIndex>=this.getColCount())throw console.error("\u5408\u5e76\u8303\u56f4\u5f02\u5e38",e),u.default.report.monitor(u.default.config.report.MONITOR_POINTS.MERGE_GRID_RANGE_ERROR),new Error("ApiCheckError-\u5408\u5e76\u8303\u56f4\u5f02\u5e38");if(this.checkCellDataHasMergeReference(e))throw console.error("\u5408\u5e76\u5355\u5143\u683c\u5df2\u7ecf\u5b58\u5728",e),u.default.report.monitor(u.default.config.report.MONITOR_POINTS.MERGE_ALREADY_EXIST),new Error("ApiCheckError-\u5408\u5e76\u5355\u5143\u683c\u5df2\u7ecf\u5b58\u5728");return this.setCellDataMergeReference(e),this.merges.push(e),e.positionCenterKey=this.positionCenter.add({selfData:{xRange:new S.default(e.sheetId,e.startColIndex,e.endColIndex,x.default.COLUMNS),yRange:new S.default(e.sheetId,e.startRowIndex,e.endRowIndex,x.default.ROWS),gridRange:e},type:"sheet-merge",calc:function(e,n,a){var r=e.xRange,o=e.yRange,i=e.gridRange;if(i.isValid()&&!i.isSingle()){if(i.endRowIndex-i.startRowIndex!==o.endIndex-o.startIndex||i.endColIndex-i.startColIndex!==r.endIndex-r.startIndex)return i.startRowIndex=o.startIndex,i.endRowIndex=o.endIndex,i.startColIndex=r.startIndex,i.endColIndex=r.endIndex,void t.removeMerge(i);i.startRowIndex=o.startIndex,i.endRowIndex=o.endIndex,i.startColIndex=r.startIndex,i.endColIndex=r.endIndex}else t.removeMerge(i)}}),this}},{key:"checkCellDataHasMergeReference",value:function(e){var t=void 0,n=void 0,a=void 0;for(n=e.startRowIndex;n<=e.endRowIndex;n++)for(t=e.startColIndex;t<=e.endColIndex;t++)if((a=this.getCellDataAtPosition(n,t))&&a.getMergeReference())return!0;return!1}},{key:"setCellDataMergeReference",value:function(e){var t=void 0,n=void 0,a=void 0;for(n=e.startRowIndex;n<=e.endRowIndex;n++)for(t=e.startColIndex;t<=e.endColIndex;t++)(a=this.getCellDataAtPosition(n,t))||(a=new c.default,this.setCellDataAtPosition(n,t,a)),a.setMergeReference(e)}},{key:"removeMerge",value:function(e){var t=void 0,n=void 0,a=!1;for(t=0;t<this.merges.length;t++)if(e.equals(this.merges[t])){n=this.merges[t].positionCenterKey,this.merges.splice(t,1),a=!0;break}return a?this.clearCellDataMergeReference(e):console.error("\u5408\u5e76\u5355\u5143\u683c\u4e0d\u5b58\u5728\uff0c\u65e0\u6cd5\u5220\u9664"),n?this.positionCenter.remove(n):(console.error("\u5408\u5e76\u5355\u5143\u683c\u4e0a\u6ca1\u6709positionCenterKey"),u.default.report.monitor(u.default.config.report.MONITOR_POINTS.MERGE_POSITION_CENTER_KEY_NOT_EXIST)),this}},{key:"clearCellDataMergeReference",value:function(e){var t=void 0,n=void 0,a=void 0;for(n=e.startRowIndex;n<=e.endRowIndex;n++)for(t=e.startColIndex;t<=e.endColIndex;t++)(a=this.getCellDataAtPosition(n,t))&&a.setMergeReference(null)}},{key:"_debugCheckMerges",value:function(){var e=this.getMerges(),t=void 0,n=void 0;for(console.log("\u5408\u5e76\u5355\u5143\u683c\u6570\u91cf\uff1a",e.length),n=0;n<e.length;n++)t=e[n],this._debugCheckCellDataAllMergeReference(t)?console.log(t.toString(),"\u5408\u5e76\u5355\u5143\u683c\u6b63\u5e38"):console.error("\u8be5\u5408\u5e76\u5355\u5143\u683c\u6570\u636e\u5f02\u5e38\uff1a",t);console.log("\u68c0\u6d4b\u5b8c\u6bd5")}},{key:"_debugCheckCellDataAllMergeReference",value:function(e){var t,n=void 0,a=void 0,r=void 0;if(!(r=this.getCellDataAtPosition(e.startRowIndex,e.startColIndex)))return!1;if(!(t=r.getMergeReference()))return!1;for(a=e.startRowIndex;a<=e.endRowIndex;a++)for(n=e.startColIndex;n<=e.endColIndex;n++)if(!(r=this.getCellDataAtPosition(a,n))||r.getMergeReference()!==t)return!1;return!0}},{key:"getImages",value:function(){return this.images}},{key:"getImage",value:function(e){return this.images[e]}},{key:"addImage",value:function(e){var t=void 0;return(t=e instanceof M.default?e:new M.default(e)).position.overlayPosition.anchorCell.rowIndex>=0&&t.position.overlayPosition.anchorCell.rowIndex<this.getRowCount()&&t.position.overlayPosition.anchorCell.colIndex>=0&&t.position.overlayPosition.anchorCell.colIndex<this.getColCount()&&(t.active(this.positionCenter),this.images[t.id]=t),this}},{key:"deleteImage",value:function(e){var t=this.images[e];return t&&(t.inActive(),delete this.images[e]),this}},{key:"updateImage",value:function(e){var t=this.images[e.id];return t&&e.y>=0&&e.y<this.getRowCount()&&e.x>=0&&e.x<this.getColCount()&&t.update(e),this}},{key:"getProperties",value:function(){return this.properties}},{key:"getSheetType",value:function(){return this.properties.getSheetType()}},{key:"setProperties",value:function(e){return e.gridProperties.rowCount=Math.max(e.gridProperties.rowCount,this.properties.gridProperties.rowCount),e.gridProperties.columnCount=Math.max(e.gridProperties.columnCount,this.properties.gridProperties.columnCount),this.properties=e,this}},{key:"setSheetType",value:function(e){return this.properties.sheetType=e,this}},{key:"hide",value:function(e){return this.properties.hidden=e,this}},{key:"getDisplayHidden",value:function(){return this.properties.hidden}},{key:"getSheetId",value:function(){return this.properties.sheetId}},{key:"setSheetId",value:function(e){return this.properties.sheetId=e,this}},{key:"getTitle",value:function(){return this.properties.title}},{key:"setTitle",value:function(e){return this.properties.title=e,this}},{key:"getIndex",value:function(){return this.properties.index}},{key:"setIndex",value:function(e){return this.properties.index=e,this}},{key:"getRowCount",value:function(){return this.properties.gridProperties.rowCount}},{key:"setRowCount",value:function(e){return this.properties.gridProperties.rowCount=e,this}},{key:"getColCount",value:function(){return this.properties.gridProperties.columnCount}},{key:"setColCount",value:function(e){return this.properties.gridProperties.columnCount=e,this}},{key:"getFrozenRowCount",value:function(){return this.properties.gridProperties.frozenRowCount}},{key:"setFrozenRowCount",value:function(e){return e>=0&&e<this.getRowCount()&&(this.properties.gridProperties.frozenRowCount=e),this}},{key:"getFrozenColCount",value:function(){return this.properties.gridProperties.frozenColCount}},{key:"setFrozenColCount",value:function(e){return e>=0&&e<this.getColCount()&&(this.properties.gridProperties.frozenColCount=e),this}},{key:"getHideGridlines",value:function(){return!!this.properties.gridProperties.hideGridlines}},{key:"setHideGridlines",value:function(e){return this.properties.gridProperties.hideGridlines=e,this}},{key:"getTabColor",value:function(){return this.properties.tabColor}},{key:"setTabColor",value:function(e){return this.properties.setTabColor(e),this}},{key:"getCellDataAtPosition",value:function(e,t){var n=this.data.rowData[e];return n&&n.values[t]||null}},{key:"setCellDataAtPosition",value:function(e,t,n){return e>=0&&e<this.getRowCount()&&t>=0&&t<this.getColCount()&&(this.data.rowData[e]||(this.data.rowData[e]={values:[]}),this.data.rowData[e].values[t]=n),this}},{key:"getCellDatasAtRange",value:function(e,t,n,a){var r=void 0,o=void 0,i=void 0,l=[],d=[];for(o=e;o<=t;o++){if(i=this.data.rowData[o])for(d=[],r=n;r<=a;r++)d.push(i.values[r]);else d=new Array(a-n+1);l.push(d)}return l}},{key:"getGridRangeHasData",value:function(){var e=void 0,t=void 0,n=new O.default(this.getSheetId(),-1,-1,-1,-1);for(t=0;t<this.data.rowData.length;t++)if(this.data.rowData[t])for(e=0;e<this.data.rowData[t].values.length;e++)this.data.rowData[t].values[e]&&(-1===n.startRowIndex&&(n.startRowIndex=t),n.endRowIndex=Math.max(n.endRowIndex,t),-1===n.startColIndex?n.startColIndex=e:n.startColIndex=Math.min(n.startColIndex,e),n.endColIndex=Math.max(n.endColIndex,e));return n}},{key:"isEmpty",value:function(){var e=void 0,t=void 0;for(t=0;t<this.data.rowData.length;t++)if(this.data.rowData[t])for(e=0;e<this.data.rowData[t].values.length;e++)if(this.data.rowData[t].values[e])return!1;return!0}},{key:"getBasicFilter",value:function(){return this.basicFilter}},{key:"setBasicFilter",value:function(e){if(this.basicFilter&&this.basicFilter.inActive(),e){var t=e.getRange();t.isValid()&&(t.endRowIndex=Math.min(t.endRowIndex,this.getRowCount()-1),t.endColIndex=Math.min(t.endColIndex,this.getColCount()-1),t.startRowIndex=Math.min(t.startRowIndex,t.endRowIndex),t.startColIndex=Math.min(t.startColIndex,t.endColIndex),this.basicFilter=e)}else this.basicFilter=e;return this.basicFilter&&this.basicFilter.active(this.positionCenter),this.hideRowsByFilter(this.basicFilter&&this.basicFilter.hiddenRows||[]),this}},{key:"clearBasicFilter",value:function(){return this.setBasicFilter(null),this}},{key:"hideRowsByFilter",value:function(e){var t,n=void 0,a=void 0;for(n=0,t=this.getRowCount();n<t;n++)a=this.getRowProperties(n),-1===e.indexOf(n)?a&&a.setHiddenByFilter(!1):(a||(a=new m.default,this.setRowProperties(n,a)),a.setHiddenByFilter(!0))}},{key:"_debugCheckFilter",value:function(){var e=this;if(this.basicFilter){console.log("\u7b5b\u9009\u8303\u56f4\uff1a",this.basicFilter.range.toString());var t=this.basicFilter.getHiddenRows();t.length>0?t.forEach(function(t){e.data.rowMetadata[t]&&e.data.rowMetadata[t].getHiddenByFilter()?console.log(t+1+" \u884c\u88ab\u7b5b\u9009\u9690\u85cf"):console.error(t+1+" \u884c\u88ab\u7b5b\u9009\u9690\u85cf\u5f02\u5e38")}):console.log("\u6ca1\u6709\u7b5b\u9009\u9690\u85cf\u884c")}else console.log("\u6ca1\u6709\u7b5b\u9009");console.log("\u68c0\u6d4b\u5b8c\u6bd5")}},{key:"getRowProperties",value:function(e){return this.data.rowMetadata[e]}},{key:"setRowProperties",value:function(e,t){return e>=0&&e<this.getRowCount()&&(this.data.rowMetadata[e]=t),this}},{key:"getColProperties",value:function(e){return this.data.columnMetadata[e]}},{key:"setColProperties",value:function(e,t){return e>=0&&e<this.getColCount()&&(this.data.columnMetadata[e]=t),this}},{key:"getRowHeight",value:function(e){return this.data.rowMetadata[e]&&null!=this.data.rowMetadata[e].getPixelSize()?this.data.rowMetadata[e].getPixelSize():this._standardHeight}},{key:"setRowHeight",value:function(e,t){if(e>=0&&e<this.getRowCount()){var n=this.data.rowMetadata[e];n||(n=new m.default,this.setRowProperties(e,n)),n.setPixelSize(t)}return this}},{key:"getRowsHeight",value:function(e,t){var n=void 0,a=[];for(n=e;n<=t;n++)a.push(this.getRowHeight(n));return a}},{key:"setRowsHeight",value:function(e,t,n){var a=void 0;for(a=e;a<=t;a++)this.setRowHeight(a,Array.isArray(n)?n[a-e]:n);return this}},{key:"getColWidth",value:function(e){return this.data.columnMetadata[e]&&null!=this.data.columnMetadata[e].getPixelSize()?this.data.columnMetadata[e].getPixelSize():this._standardWidth}},{key:"setColWidth",value:function(e,t){if(e>=0&&e<this.getColCount()){var n=this.data.columnMetadata[e];n||(n=new m.default,this.setColProperties(e,n)),n.setPixelSize(t)}return this}},{key:"setColsWidth",value:function(e,t,n){var a=void 0;for(a=e;a<=t;a++)this.setColWidth(a,Array.isArray(n)?n[a-e]:n);return this}},{key:"getColsWidth",value:function(e,t){var n=void 0,a=[];for(n=e;n<=t;n++)a.push(this.getColWidth(n));return a}},{key:"setRowFormData",value:function(e,t){if(e>=0&&e<this.getRowCount()){var n=this.data.rowMetadata[e];n||(n=new m.default,this.setRowProperties(e,n)),n.setFormData(t)}return this}},{key:"setRowsFormData",value:function(e,t,n){var a=void 0;for(a=e;a<=t;a++)this.setRowFormData(a,Array.isArray(n)?n[a-e]:n);return this}},{key:"delRowFormData",value:function(e){var t=this.data.rowMetadata[e];if(t){var n=t.getFormData();n&&n.setDelete(!0)}return this}},{key:"delRowsFormData",value:function(e,t){var n=void 0;for(n=e;n<t;n++)this.delRowFormData(e);return this}},{key:"setColFormData",value:function(e,t){if(e>=0&&e<this.getRowCount()){var n=this.data.columnMetadata[e];n||(n=new m.default,this.setColProperties(e,n)),n.setFormData(t)}return this}},{key:"setColsFormData",value:function(e,t,n){var a=void 0;for(a=e;a<=t;a++)this.setColFormData(a,Array.isArray(n)?n[a-e]:n);return this}},{key:"delColFormData",value:function(e){var t=this.data.columnMetadata[e];if(t){var n=t.getFormData();n&&n.setDelete(!0)}return this}},{key:"delColsFormData",value:function(e,t){var n=void 0;for(n=e;n<t;n++)this.delColFormData(e);return this}},{key:"getMentions",value:function(){return this.mentionsMap}},{key:"addMention",value:function(e,t){var n=this;if(this.mentionsMap||(this.mentionsMap={}),this.mentionsMap[e]){var a=this.mentionsMap[e];"undefined"!==typeof a&&a.setProperties(t)}else{var r=new P.default(t);r.id=e,r.positionCenterKey=this.positionCenter.add({config:{ignoreInsertDimension:!1,ignoreDeleteDimension:!1,ignoreSetCell:!1},selfData:{xRange:new S.default(this.getSheetId(),r.colIndex,r.colIndex,x.default.COLUMNS),yRange:new S.default(this.getSheetId(),r.rowIndex,r.rowIndex,x.default.ROWS),mention:r},type:"mention",calc:function(e,t,a){var r=e.xRange,o=e.yRange,i=e.mention,l=a.index;if(t===b.default.DELETE_COLS&&l===r.startIndex||t===b.default.DELETE_ROWS&&l===o.startIndex){var d=n.judgeDeleteMention(i.id,i.rowIndex,i.colIndex);"undefined"!==typeof i.id&&d&&(n.deleteMention(i.id),U.default.event.spreadsheetEvent.trigger("deleteMention",i.id))}else t!==b.default.SET_CELLS&&(i.colIndex=r.startIndex,i.rowIndex=o.startIndex)}}),this.mentionsMap[e]=r}return this}},{key:"judgeDeleteMention",value:function(e,t,n){var a={};return null!=this.getMentions()&&(a=this.getMentions()),a[e]&&a[e].colIndex===n&&a[e].rowIndex===t}},{key:"deleteMention",value:function(e){if(this.mentionsMap&&this.mentionsMap[e]){var t=this.mentionsMap[e];t&&t.positionCenterKey&&(this.positionCenter.remove(t.positionCenterKey),delete this.mentionsMap[e])}return this}},{key:"deleteMentions",value:function(){var e=this;return this.mentionsMap&&(0,o.default)(this.mentionsMap).forEach(function(t){e.deleteMention(t)}),this}},{key:"updateMentions",value:function(e,t,n,a){var r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{isLocal:!1},i=!1;"undefined"!==typeof r&&(i=!!r&&!r.isReplay&&!r.isCollab);var l=this.getMentions()||{};if(t||e){var d=e&&e.getMentionDetails()?e.getMentionDetails():{},s=t&&t.getMentionDetails()?t.getMentionDetails():{},u=[],f=[];for(var h in s)if("undefined"===typeof d[h]&&"undefined"===typeof l[h])this.addMention(h,{rowIndex:n,colIndex:a}),i&&u.push(h);else{var c=l?l[h]:void 0;"undefined"!==typeof c&&(c.setProperties({rowIndex:n,colIndex:a}),c.updatePositionCenterData(this.positionCenter))}for(var I in d)"undefined"===typeof s[I]&&this.judgeDeleteMention(I,n,a)&&(this.deleteMention(I),i&&f.push(I));u&&u.length>0&&U.default.event.spreadsheetEvent.trigger("addMention",u,this.getSheetId()),f&&u.length>0&&U.default.event.spreadsheetEvent.trigger("deleteMention",f),((0,o.default)(d).length>0||(0,o.default)(s).length>0)&&U.default.event.spreadsheetEvent.trigger("updateDocMention")}return this}},{key:"updateMentionCordinate",value:function(e,t,n){var a=this.getMentions();if(null!=a&&a[e]){var r=a[e];r.setProperties({rowIndex:t,colIndex:n}),r.updatePositionCenterData(this.positionCenter)}}},{key:"insertRows",value:function(e,t){var n=this.properties.getGridProperties(),a=this.data,r=a.rowData,o=a.rowMetadata;return!u.default.util.type.isNumber(e)||!u.default.util.type.isNumber(t)||e<0||t<0?this:(n.rowCount+=t,n.frozenRowCount>e&&(n.frozenRowCount+=t),e<r.length&&Array.prototype.splice.apply(r,[e,0].concat(new Array(t))),e<o.length&&Array.prototype.splice.apply(o,[e,0].concat(new Array(t))),this.positionCenter.insertRows({index:e,amount:t}),this)}},{key:"insertCols",value:function(e,t){var n,a=void 0,r=this.properties.getGridProperties(),o=this.data,i=o.rowData,l=o.columnMetadata;if(!u.default.util.type.isNumber(e)||!u.default.util.type.isNumber(t)||e<0||t<0)return this;for(r.columnCount+=t,r.frozenColCount>e&&(r.frozenColCount+=t),a=0,n=i.length;a<n;a++)o.rowData[a]&&e<o.rowData[a].values.length&&Array.prototype.splice.apply(o.rowData[a].values,[e,0].concat(new Array(t)));return e<l.length&&Array.prototype.splice.apply(l,[e,0].concat(new Array(t))),this.positionCenter.insertCols({index:e,amount:t}),this}},{key:"deleteRows",value:function(e,t){var n=this.getRowCount(),a=this.properties.getGridProperties(),r=this.data,o=r.rowData,i=r.rowMetadata;return!u.default.util.type.isNumber(e)||!u.default.util.type.isNumber(t)||e<0||t<0||e+t>n?this:(a.rowCount-=t,a.frozenRowCount>e&&(a.frozenRowCount-=t),o.splice(e,t),i.splice(e,t),this.positionCenter.deleteRows({index:e,amount:t}),this)}},{key:"deleteCols",value:function(e,t){var n,a=void 0,r=this.getColCount(),o=this.properties.getGridProperties(),i=this.data,l=i.rowData,d=i.columnMetadata;if(!u.default.util.type.isNumber(e)||!u.default.util.type.isNumber(t)||e<0||t<0||e+t>r)return this;for(o.columnCount-=t,o.frozenColCount>e&&(o.frozenColCount-=t),a=0,n=l.length;a<n;a++)i.rowData[a]&&i.rowData[a].values.splice(e,t);return d.splice(e,t),this.positionCenter.deleteCols({index:e,amount:t}),this}},{key:"moveRange",value:function(e,t){if(!e.isValid||e.endRowIndex>=this.getRowCount()||e.endColIndex>=this.getColCount())return this;var n=e.startColIndex,a=e.endColIndex,r=void 0,i=void 0,d=void 0,s=void 0,u=void 0,f=void 0,h=null,I=null,g=void 0,R=void 0,v=void 0,T=void 0,E=void 0,m=void 0,_=[],y=[];for(i=0;i<t.length;i++)for(d=t[i].from,s=t[i].to,y.push([]),_.push(d),r=n;r<=a;r++)if(u=this.getCellDataAtPosition(d,r),f=this.getCellDataAtPosition(s,r),h=null,I=null,g=null,R=null,v=null,T=null,E=null,m=null,u&&(h=u.clone(),u.sheetRangeReferences&&u.sheetRangeReferences.length>0&&(h.sheetRangeReferences=u.sheetRangeReferences),g=h.getUserEnteredFormat(),E=h.getSheetRange(),g&&(v=g.getBorders())),f&&(I=f.clone(),f.sheetRangeReferences&&f.sheetRangeReferences.length>0&&(I.sheetRangeReferences=f.sheetRangeReferences),R=I.getUserEnteredFormat(),m=I.getSheetRange(),R&&(T=R.getBorders())),v?(R||(R=new p.default),R.setBorders(v),I||(I=new c.default),I.setUserEnteredFormat(R)):I&&R&&(R.setBorders(v),I.setUserEnteredFormat(R)),T?(g||(g=new p.default),g.setBorders(T),h||(h=new c.default),h.setUserEnteredFormat(g)):h&&g&&(g.setBorders(T),h.setUserEnteredFormat(g)),E?(I||(I=new c.default),I.sheetRangeReferences=E):I&&(I.sheetRangeReferences=null),m?(h||(h=new c.default),h.sheetRangeReferences=m):h&&(h.sheetRangeReferences=null),y[i].push(h),h&&h.getMentionDetails()){var x=h.getMentionDetails(),S=!0,O=!1,C=void 0;try{for(var D,M=(0,l.default)((0,o.default)(x));!(S=(D=M.next()).done);S=!0){var w=D.value;this.updateMentionCordinate(w,s,r)}}catch(A){O=!0,C=A}finally{try{!S&&M.return&&M.return()}finally{if(O)throw C}}}for(i=0;i<t.length;i++)for(s=t[i].to,r=n;r<=a;r++)this.setCellDataAtPosition(s,r,y[i][r-n]);return this}},{key:"showRows",value:function(e,t){var n=void 0,a=void 0;for(n=e;n<=t;n++)(a=this.getRowProperties(n))&&a.setHiddenByUser(!1);return this}},{key:"showCols",value:function(e,t){var n=void 0,a=void 0;for(n=e;n<=t;n++)(a=this.getColProperties(n))&&a.setHiddenByUser(!1);return this}},{key:"hideRows",value:function(e,t){var n=void 0,a=void 0;for(n=e;n<=t;n++)(a=this.getRowProperties(n))||(a=new m.default,this.setRowProperties(n,a)),a.setHiddenByUser(!0);return this}},{key:"hideCols",value:function(e,t){var n=void 0,a=void 0;for(n=e;n<=t;n++)(a=this.getColProperties(n))||(a=new m.default,this.setColProperties(n,a)),a.setHiddenByUser(!0);return this}},{key:"addSheetRange",value:function(e,t){var n=this;if(t.padId!==window.clientVars.padId)return this;var a=t.gridRange;return a.isValid()&&a.endRowIndex<this.getRowCount()&&a.endColIndex<this.getColCount()&&(this.sheetRangeControl.addSheetRange(e,t),a.each(function(a,r){var o=n.getCellDataAtPosition(a,r);o||(o=new c.default,n.setCellDataAtPosition(a,r,o)),o.addSheetRange(e,t.sheetRangeType)})),this}},{key:"deleteSheetRange",value:function(e){var t=this,n=this.sheetRangeControl.deleteSheetRange(e);return n?(n.gridRange.each(function(a,r){var o=t.getCellDataAtPosition(a,r);o&&o.deleteSheetRange(e,n.sheetRangeType)}),this):this}},{key:"updateSheetRange",value:function(e,t){var n=this,a=this.sheetRangeControl.getSheetRange(e);return this.deleteSheetRange(e),a&&a.gridRange.each(function(t,r){var o=n.getCellDataAtPosition(t,r);o&&o.deleteSheetRange(e,a.sheetRangeType)}),this.addSheetRange(e,t),this}},{key:"_debugCheckSheetRange",value:function(){var e=this,t=this.sheetRangeControl.ranges,n=void 0,a=void 0,r=void 0,i=void 0,d=void 0,s=void 0,u=void 0,f=0,h=1,c=2,I=["commnet","","","","","\u6536\u96c6\u8868","\u6536\u96c6\u8868"];console.log("\u603b\u5171 "+(0,o.default)(t).length+" \u4e2asheetRange");var g=!0,R=!1,v=void 0;try{for(var p,T=function(){var o=p.value;n=t[o],a=f,r=n.gridRange;e:for(d=r.startRowIndex;d<=r.endRowIndex;d++)for(i=r.startColIndex;i<=r.endColIndex;i++){if(!(s=e.getCellDataAtPosition(d,i))){a=h;break e}if(!(u=s.getSheetRange())){a=h;break e}if(u.forEach(function(e){a=e.id===o&&e.type===t[o].sheetRangeType?c:h}),a===h)break e}a===c?console.log("\u8be5 "+r.toString()+" \u6b63\u5e38\uff0c\u7c7b\u578b\u662f"+I[n.sheetRangeType]):console.error("\u8be5 "+r.toString()+" \u5f02\u5e38\uff0c\u7c7b\u578b\u662f"+I[n.sheetRangeType])},E=(0,l.default)((0,o.default)(t));!(g=(p=E.next()).done);g=!0)T()}catch(m){R=!0,v=m}finally{try{!g&&E.return&&E.return()}finally{if(R)throw v}}console.log("\u68c0\u6d4b\u5b8c\u6bd5")}},{key:"correct",value:function(){var e=this;this.merges.forEach(function(t){t.each(function(n,a){if(t.startRowIndex!==n||t.startColIndex!==a){var r=e.getCellDataAtPosition(n,a);r&&(r.getEffectiveValue()&&r.clearEffectiveValue(),r.getFormula()&&r.clearFormula())}})})}},{key:"equal",value:function(e){var t={},n=function(e,t){var n,a=t.split("."),r=void 0;for(r=0,n=a.length-1;r<n;r++)e[a[r]]=e[a[r]]||{},e=e[a[r]];e[a[n]]=!1},i=function e(i,d,s){if(!(null===i&&null===d||void 0===i&&void 0===d))if(null!=i&&null!=d){var u="undefined"===typeof i?"undefined":(0,r.default)(i),f="undefined"===typeof d?"undefined":(0,r.default)(d);if(u!==f){if("number"===u&&"string"===f&&(0,H.isPrecisionBiggerThan16)(i))return;if("number"===f&&"string"===u&&(0,H.isPrecisionBiggerThan16)(d))return;n(t,s)}else if("object"===u)if(i instanceof a.default){i.size!==d.size&&n(t,s+".length");var h=!0,I=!1,g=void 0;try{for(var R,v=(0,l.default)(i.keys());!(h=(R=v.next()).done);h=!0){var T=R.value;"positionCenter"!==T&&"positionCenterKey"!==T&&"parent"!==T&&e(i.get(T),d.get(T),s+"."+T)}}catch(A){I=!0,g=A}finally{try{!h&&v.return&&v.return()}finally{if(I)throw g}}var E=!0,_=!1,y=void 0;try{for(var x,S=(0,l.default)(d.keys());!(E=(x=S.next()).done);E=!0){var O=x.value;i.has(O)||n(t,s+"."+O)}}catch(A){_=!0,y=A}finally{try{!E&&S.return&&S.return()}finally{if(_)throw y}}}else{var D=(0,o.default)(i),w=(0,o.default)(d);D.length!==w.length&&(Array.isArray(i)&&Array.isArray(d)?i.length!==d.length&&n(t,s+".length"):n(t,s+".length")),i instanceof c.default&&i.getFormula()&&(i.clearEffectiveValue(),i.getEffectiveFormat()&&i.getEffectiveFormat().clearNumberFormat(),i.getEffectiveFormat()&&i.getEffectiveFormat().clearColor(),i.clearFormattedValue(null)),d instanceof c.default&&d.getFormula()&&(d.clearEffectiveValue(),d.getEffectiveFormat()&&d.getEffectiveFormat().clearNumberFormat(),d.getEffectiveFormat()&&d.getEffectiveFormat().clearColor(),d.clearFormattedValue(null)),D.forEach(function(t){if(i instanceof p.default&&"borders"===t){var n=null==i.getBorders()||(0,o.default)(i.getBorders()).every(function(e){return null==i.getBorders()[e]}),a=null==d[t]||(0,o.default)(d[t]).every(function(e){return null==d[t][e]});if(n&&a)return}if(i instanceof p.default&&"textFormat"===t){var r=null==i.getTextFormat()||(0,o.default)(i.getTextFormat()).every(function(e){return null==i.getTextFormat()[e]}),l=null==d[t]||(0,o.default)(d[t]).every(function(e){return null==d[t][e]});if(r&&l)return}if(i instanceof V.default&&"format"===t){var u=null==i.format||(0,o.default)(i.format).every(function(e){return null==i.format[e]}),f=null==d[t]||(0,o.default)(d[t]).every(function(e){return null==d[t][e]});if(u&&f)return}if(i instanceof m.default&&"pixelSize"===t){var h=0===i.pixelSize||null==i.pixelSize,c=0===d.pixelSize||null==d.pixelSize;if(h&&c)return}if(!(i instanceof B.default&&"__id"===t)){if(i instanceof G.default&&"zIndex"===t){var I=0===i.zIndex||null==i.zIndex,g=0===d.zIndex||null==d.zIndex;if(I&&g)return}if(i instanceof M.default&&"url"===t){var R=""===i.url||null==i.url,v=""===d.url||null==d.url;if(R&&v)return}i instanceof C.default&&"workbookRangeId"===t||"parent"===t||"stringIndex"===t||/positionCenter/i.test(t)||e(i[t],d[t],s+"."+t)}}),w.forEach(function(e){-1===D.indexOf(e)&&n(t,s+"."+e)})}else i!==d&&("number"===u?parseFloat(i).toFixed(9)!==parseFloat(d).toFixed(9)&&n(t,s):n(t,s))}else n(t,s)},d=function(e){e.data.rowData.forEach(function(t,n){if(t&&t.values){var a=!0;t.values.forEach(function(e,n){e&&e.isTotallyEmpty()&&(e=null,delete t.values[n]),e&&(a=!1)}),a&&delete e.data.rowData[n]}})};return d(this),d(e),i(this.data.rowData,e.data.rowData,"data.rowData"),i(this.data.rowMetadata,e.data.rowMetadata,"data.rowMetadata"),i(this.data.columnMetadata,e.data.columnMetadata,"data.columnMetadata"),i(this.basicFilter,e.basicFilter,"basicFilter"),i(this.merges,e.merges,"merges"),i(this.images,e.images,"images"),i(this.properties,e.properties,"properties"),i(this.customNumberFormatMap,e.customNumberFormatMap,"customNumberFormatMap"),i(this.sheetRangeControl,e.sheetRangeControl,"sheetRangeControl"),i(this.conditionalFormatRuleManager,e.conditionalFormatRuleManager,"conditionalFormatRuleManager"),t}},{key:"customNumberFormatMap",get:function(){return F.CUSTOM_NUMBER_FORMAT_MAP},set:function(e){(0,F.updateCustomNumberFormatMap)(e)}}],[{key:"deserialize",value:function(t,n){var r=void 0,i=void 0,l=n.sheetId,d={parent:n.spreadsheet},s={startRow:t[0][0],startColumn:t[0][1],rowData:[],rowMetadata:[],columnMetadata:[]},u=g.default.createPropertiesMap(t[0][2][1]),f=void 0,h=void 0,c=void 0,R=void 0;for(r=0,i=t[0][2][0].length;r<i;r++)h=t[0][2][0][r][0],f=t[0][2][0][r][1],c=I.default.deserialize(t[0][2][0][r][2],u),s.rowData[h]=s.rowData[h]||{values:[]},(R=(0,v.mergeDeltaToCellData)(null,c))&&!R.isEmpty()&&(s.rowData[h].values[f]=R);var p=(0,o.default)(t[0][3]),T=void 0;for(r=0,i=p.length;r<i;r++)T=t[0][3][p[r]],s.rowMetadata[+p[r]]=new m.default({hiddenByFilter:!!T[0],hiddenByUser:!!T[1],pixelSize:null!==T[2]?T[2]:null,formData:T[3]?_.default.deserialize(T[3]):void 0});var x=(0,o.default)(t[0][4]);for(r=0,i=x.length;r<i;r++)T=t[0][4][x[r]],s.columnMetadata[+x[r]]=new m.default({hiddenByFilter:!!T[0],hiddenByUser:!!T[1],pixelSize:null!==T[2]?T[2]:null,formData:T[3]?_.default.deserialize(T[3]):void 0});if(d.data=s,t[1]){var S=new a.default;for(r=0,i=t[1][2].length;r<i;r++)S.set(t[1][2][r][0],new D.default({hiddenValues:t[1][2][r][1][0],visibleValues:t[1][2][r][1][1]}));d.basicFilter=new C.default({range:new O.default(l,t[1][0][0],t[1][0][1],t[1][0][2],t[1][0][3]),workbookRangeId:t[1][1],criteriaMap:S,hiddenRows:t[1][3]})}if(t[2]){var w=[];for(r=0,i=t[2].length;r<i;r++)w.push(new O.default(l,t[2][r][0],t[2][r][1],t[2][r][2],t[2][r][3]));d.merges=w}if(t[3]){var F={};for(r=0,i=t[3].length;r<i;r++)F[t[3][r][0]]=new M.default({id:t[3][r][0],sheetId:l,width:t[3][r][1][0],height:t[3][r][1][1],y:t[3][r][1][2],x:t[3][r][1][3],offsetX:t[3][r][1][4],offsetY:t[3][r][1][5],zIndex:t[3][r][1][6],url:t[3][r][2],clipInfo:{clipTop:t[3][r][3][0],clipLeft:t[3][r][3][1],clipRight:t[3][r][3][2],clipBottom:t[3][r][3][3]}});d.images=F}if(d.properties=new E.default({sheetId:l,title:t[4][0],sheetType:t[4][1],gridProperties:{rowCount:t[4][2][0],columnCount:t[4][2][1],frozenRowCount:t[4][2][2],frozenColCount:t[4][2][3],hideGridlines:!!t[4][2][4],rowGroupControlAfter:!!t[4][2][5],columnGroupControlAfter:!!t[4][2][6]},hidden:!!t[4][3],tabColor:new y.default(t[4][4]),rightToLeft:!!t[4][5]}),t[5]){var k=new a.default;for(r=0,i=t[5].length;r<i;r++)k.set(t[5][r][0],t[5][r][1]);d.customNumberFormatMap=k}if(t[6]){var N={};for(r=0,i=t[6].length;r<i;r++)N[t[6][r][0]]=new A.default({sheetRangeType:t[6][r][1],gridRange:new O.default(l,t[6][r][2][0],t[6][r][2][1],t[6][r][2][2],t[6][r][2][3]),padId:t[6][r][3],sheetId:l});d.sheetRangeControl={ranges:N}}if(t[7]){var b=[];for(r=0,i=t[7].length;r<i;r++)b.push({index:t[7][r][0],rule:L.default.deserialize(t[7][r][1]),id:""});d.conditionalFormatRuleManager={conditionalFormatRules:b}}if(t[8]){var U={};[].concat(t[8]).forEach(function(e){var t=e[0],n=P.default.deserialize([e[1],e[2],e[3]]);n&&(U[t]=n)}),d.mentionsMap=U}return new e(d)}}]),e}();z.protoMap={0:{name:"data",dataType:{type:Object,protoMap:{0:{name:"startRow",dataType:Number},1:{name:"startColumn",dataType:Number},2:{name:"rowData",dataType:h.RowData},3:{name:"rowMetadata",dataType:{type:Array,saveType:Object,subType:m.default}},4:{name:"columnMetadata",dataType:{type:Array,saveType:Object,subType:m.default}}}}},1:{name:"basicFilter",dataType:C.default},2:{name:"merges",dataType:{subType:O.default,type:Array}},3:{name:"images",dataType:{type:Object,subType:M.default}},4:{name:"properties",dataType:E.default},5:{name:"customNumberFormatMap",dataType:{type:a.default,subType:String}},6:{name:"sheetRangeControl",dataType:w.default},7:{name:"gridlines",dataType:Boolean},8:{name:"conditionalFormatRuleManager",dataType:k.default},9:{name:"mentionsMap",dataType:{type:Object,subType:P.default}}},t.default=z},381:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(0)),r=s(n(1)),o=n(33),i=s(n(314)),l=s(n(660)),d=s(n(115));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.sheetId=t.sheetId||"",this.title=t.title||"",this.index=t.index||0,this.sheetType=t.sheetType||i.default.GRID,this.initGridProperties(t.gridProperties),this.hidden=t.hidden||!1,this.tabColor=t.tabColor||new d.default(o.DEFAULT_TAB_COLOR),this.rightToLeft=t.rightToLeft||!1}return(0,r.default)(e,[{key:"initGridProperties",value:function(e){e instanceof l.default?this.gridProperties=e:this.gridProperties=new l.default(e)}},{key:"getSheetId",value:function(){return this.sheetId}},{key:"setSheetId",value:function(e){return this.sheetId=e,this}},{key:"getTitle",value:function(){return this.title}},{key:"setTitle",value:function(e){return this.title=e,this}},{key:"getIndex",value:function(){return this.index}},{key:"setIndex",value:function(e){return this.index=e,this}},{key:"getSheetType",value:function(){return this.sheetType}},{key:"setSheetType",value:function(e){return this.sheetType=e,this}},{key:"getGridProperties",value:function(){return this.gridProperties}},{key:"setGridProperties",value:function(e){return this.gridProperties=e,this}},{key:"getHidden",value:function(){return this.hidden}},{key:"setHidden",value:function(e){return this.hidden=e,this}},{key:"getTabColor",value:function(){return this.tabColor}},{key:"setTabColor",value:function(e){return this.tabColor=e,this}},{key:"getRightToLeft",value:function(){return this.rightToLeft}},{key:"setRightToLeft",value:function(e){return this.rightToLeft=e,this}}]),e}();u.protoMap={0:{name:"sheetId",dataType:String},1:{name:"title",dataType:String},2:{name:"index",dataType:Number},3:{name:"sheetType",dataType:String},4:{name:"gridProperties",dataType:l.default},5:{name:"hidden",dataType:Boolean},6:{name:"tabColor",dataType:d.default},7:{name:"rightToLeft",dataType:Boolean}},t.default=u},382:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(383)),i=d(n(52)),l=d(n(39));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.condition=t.condition||null,t.format=t.format||null,t.stopIftrue=!!t.stopIftrue,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.condition.serialize(),new l.default({setSlots:this.format.setSlots,clearSlots:0,delta:this.format}).serialize(),this.stopIftrue?1:0]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.condition&&(this.condition=e.condition),"undefined"!==typeof e.format&&(this.format=e.format),"undefined"!==typeof e.stopIftrue&&(this.stopIftrue=e.stopIftrue),this}},{key:"clone",value:function(){return new e({condition:this.condition.clone(),format:this.format.clone(),stopIftrue:this.stopIftrue})}}],[{key:"deserialize",value:function(t){return new e({condition:o.default.deserialize(t[0]),format:l.default.deserialize(t[1]).delta,stopIftrue:!!t[2]})}}]),e}();s.protoMap={0:{name:"condition",dataType:o.default},1:{name:"format",dataType:i.default},2:{name:"stopIftrue",dataType:Boolean}},t.default=s},383:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(0)),r=l(n(1)),o=l(n(315)),i=l(n(384));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.type=null!=t.type?t.type:o.default.NUMBER_GREATER,t.values=t.values||[],this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return[this.type,this.values.map(function(e){return e.serialize()})]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.values&&(this.values=e.values),this}},{key:"clone",value:function(){return new e({type:this.type,values:this.values.map(function(e){return e.clone()})})}}],[{key:"deserialize",value:function(t){return new e({type:t[0],values:t[1].map(function(e){return i.default.deserialize(e)})})}}]),e}();d.protoMap={0:{name:"type",dataType:Number},1:{name:"values",dataType:{type:Array,subType:i.default}}},t.default=d},384:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(278)),i=d(n(1126)),l=d(n(60));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.type=null!=t.type?t.type:o.default.VALUE_TOKEN,t.dateType=null!=t.dateType?t.dateType:i.default.UNSPECIFIED,t.formula=t.formula||null,t.userEnteredValue=null!=t.userEnteredValue?t.userEnteredValue:null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){var e=[this.type];return null!=this.dateType&&(e[1]=this.dateType),null!=this.formula&&(e[2]=this.formula.serialize()),null!=this.userEnteredValue&&(e[3]=this.userEnteredValue),e}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.dateType&&(this.dateType=e.dateType),"undefined"!==typeof e.formula&&(this.formula=e.formula),"undefined"!==typeof e.userEnteredValue&&(this.userEnteredValue=e.userEnteredValue),this}},{key:"clone",value:function(){return new e({type:this.type,dateType:this.dateType,formula:this.formula,userEnteredValue:this.userEnteredValue})}}],[{key:"deserialize",value:function(t){return new e({type:t[0],dateType:t[1],formula:t[2]?l.default.deserialize(t[2]):null,userEnteredValue:t[3]})}}]),e}();s.protoMap={0:{name:"type",dataType:Number},1:{name:"dateType",dataType:Number},2:{name:"formula",dataType:l.default},3:{name:"userEnteredValue",dataType:String}},t.default=s},385:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.NORMAL="normal",e.PREVIEW="preview"}(a||(a={})),t.default=a},387:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.keyframeV1=function(e,t,n,a,r){if(t){var o=void 0;if(console.warn("\u5f53\u524dkeyframe\u7248\u672c\u4e3a\uff1a "+r),r>=5)o=i.default.deserialize(JSON.parse(t),{spreadsheet:e.parent,sheetId:e.getSheetId()});else{o=(0,l.deserialize)(JSON.parse(t),i.default,{keyframeVer:r,sheetId:e.getSheetId()});var s=window.clientVars,u=+new Date(2019,4,24);s&&s.createdDate&&s.createdDate>=u||d(e)}var f=e.getProperties(),h=f.index,c=f.title,I=f.sheetId;["data","merges","basicFilter","images","properties","positionCenter","customNumberFormatMap","sheetRangeControl"].forEach(function(t){e[t]=o[t]}),e.properties.index=h,e.properties.title=c,e.properties.sheetId=I}},t.correctRowHeight=d;var a,r=n(33),o=n(380),i=(a=o)&&a.__esModule?a:{default:a},l=n(160);function d(e){var t,n=void 0,a=void 0;for(n=0,t=e.data.rowMetadata.length;n<t;n++)!(a=e.data.rowMetadata[n])||a.pixelSize>=r.DEFAULT_ROW_HEIGHT||delete a.pixelSize}},388:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getIEmbeddedImageOptions=t.EmbeddedImageDataProtoMap=void 0;var a,r=n(375),o=(a=r)&&a.__esModule?a:{default:a};var i={0:{name:"type",dataType:String},1:{name:"sheetId",dataType:"sheetId"},2:{name:"id",dataType:String},3:{name:"url",dataType:String},4:{name:"width",dataType:Number},5:{name:"height",dataType:Number},6:{name:"x",dataType:Number},7:{name:"y",dataType:Number},8:{name:"offsetX",dataType:Number},9:{name:"offsetY",dataType:Number},10:{name:"zIndex",dataType:Number},11:{name:"clipInfo",dataType:o.default}};t.EmbeddedImageDataProtoMap=i,t.getIEmbeddedImageOptions=function(e){return{type:e.type,sheetId:e.sheetId,id:e.id,url:e.url,width:e.position.overlayPosition.widthPixels,height:e.position.overlayPosition.heightPixels,x:e.position.overlayPosition.anchorCell.colIndex,y:e.position.overlayPosition.anchorCell.rowIndex,offsetX:e.position.overlayPosition.offsetXpixels,offsetY:e.position.overlayPosition.offsetYpixels,zIndex:e.position.overlayPosition.zIndex,clipInfo:e.clipInfo}}},389:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.INIT_DATA_MUTATION,e));return n.sheetId=e.sheetId,n.lastRow=e.lastRow,n.lastCol=e.lastCol,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:e[0],lastRow:e[1],lastCol:e[2]})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},39:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(0)),r=l(n(1)),o=l(n(52)),i=l(n(32));function l(e){return e&&e.__esModule?e:{default:e}}var d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),this.clearSlots=null!=t.clearSlots?t.clearSlots:0,this.delta=t.delta||new o.default,this.setSlots=this.delta.setSlots}return(0,r.default)(e,[{key:"serialize",value:function(){var e=void 0,t=this.setSlots,n={};for(this.setSlots>0&&(n[0]=this.setSlots),this.clearSlots>0&&(n[1]=this.clearSlots),e=0;t>0;t>>=1,e++)if(1===(1&t))switch(e){case i.default.NUMBER_FORMAT:this.delta.getNumberFormat()&&(n[2]=this.delta.getNumberFormat().serialize());break;case i.default.BACKGROUND_COLOR:this.delta.getBackgroundColor()&&(n[3]=this.delta.getBackgroundColor().serialize());break;case i.default.BORDER_TOP:this.delta.getBorderTop()&&(n[4]=this.delta.getBorderTop().serialize());break;case i.default.BORDER_RIGHT:this.delta.getBorderRight()&&(n[5]=this.delta.getBorderRight().serialize());break;case i.default.BORDER_BOTTOM:this.delta.getBorderBottom()&&(n[6]=this.delta.getBorderBottom().serialize());break;case i.default.BORDER_LEFT:this.delta.getBorderLeft()&&(n[7]=this.delta.getBorderLeft().serialize());break;case i.default.HORIZONTAL_ALIGN:n[8]=this.delta.getHorizontalAlign();break;case i.default.VERTICAL_ALIGN:n[9]=this.delta.getVerticalAlign();break;case i.default.WRAP_STRATEGY:n[10]=this.delta.getWrapStrategy();break;case i.default.FOREGROUND_COLOR:this.delta.getColor()&&(n[11]=this.delta.getColor().serialize());break;case i.default.FONT_FAMINY:n[12]=this.delta.getFontFamily();break;case i.default.FONT_SIZE:n[13]=this.delta.getFontSize();break;case i.default.BOLD:n[14]=this.delta.getBold()?1:0;break;case i.default.ITALIC:n[15]=this.delta.getItalic()?1:0;break;case i.default.STRIKETHROUGH:n[16]=this.delta.getStrikethrough()?1:0;break;case i.default.UNDERLINE:n[17]=this.delta.getUnderline()}return n}},{key:"isEmpty",value:function(){return 0===(this.setSlots|this.clearSlots)}},{key:"setSlot",value:function(e,t){var n=1<<e;switch(this.setSlots|=n,this.clearSlots=this.clearSlots&~n,e){case i.default.NUMBER_FORMAT:this.delta.setNumberFormat(t);break;case i.default.BACKGROUND_COLOR:this.delta.setBackgroundColor(t);break;case i.default.BORDER_TOP:this.delta.setBorderTop(t);break;case i.default.BORDER_RIGHT:this.delta.setBorderRight(t);break;case i.default.BORDER_BOTTOM:this.delta.setBorderBottom(t);break;case i.default.BORDER_LEFT:this.delta.setBorderLeft(t);break;case i.default.HORIZONTAL_ALIGN:this.delta.setHorizontalAlign(t);break;case i.default.VERTICAL_ALIGN:this.delta.setVerticalAlign(t);break;case i.default.WRAP_STRATEGY:this.delta.setWrapStrategy(t);break;case i.default.FOREGROUND_COLOR:this.delta.setColor(t);break;case i.default.FONT_FAMINY:this.delta.setFontFamily(t);break;case i.default.FONT_SIZE:this.delta.setFontSize(t);break;case i.default.BOLD:this.delta.setBold(t);break;case i.default.ITALIC:this.delta.setItalic(t);break;case i.default.STRIKETHROUGH:this.delta.setStrikethrough(t);break;case i.default.UNDERLINE:this.delta.setUnderline(t);break;case i.default.DATA_VALIDATION:this.delta.setDataValidation(t)}return this}},{key:"clearSlot",value:function(e){var t=1<<e;if(this.clearSlots|=t,(this.setSlots|t)>0)switch(this.setSlots=this.setSlots&~t,e){case i.default.NUMBER_FORMAT:this.delta.clearNumberFormat();break;case i.default.BACKGROUND_COLOR:this.delta.clearBackgroundColor();break;case i.default.BORDER_TOP:this.delta.clearBorderTop();break;case i.default.BORDER_RIGHT:this.delta.clearBorderRight();break;case i.default.BORDER_BOTTOM:this.delta.clearBorderBottom();break;case i.default.BORDER_LEFT:this.delta.clearBorderLeft();break;case i.default.HORIZONTAL_ALIGN:this.delta.clearHorizontalAlign();break;case i.default.VERTICAL_ALIGN:this.delta.clearVerticalAlign();break;case i.default.WRAP_STRATEGY:this.delta.clearWrapStrategy();break;case i.default.FOREGROUND_COLOR:this.delta.clearColor();break;case i.default.FONT_FAMINY:this.delta.clearFontFamily();break;case i.default.FONT_SIZE:this.delta.clearFontSize();break;case i.default.BOLD:this.delta.clearBold();break;case i.default.ITALIC:this.delta.clearItalic();break;case i.default.STRIKETHROUGH:this.delta.clearStrikethrough();break;case i.default.UNDERLINE:this.delta.clearUnderline();break;case i.default.DATA_VALIDATION:this.delta.clearDataValidation()}return this}},{key:"removeSlot",value:function(e){var t=1<<e;return this.clearSlot(e),this.setSlots=this.setSlots&~t,this.clearSlots=this.clearSlots&~t,this}},{key:"getStringIndex",value:function(){return void 0===this.stringIndex&&this.createStringIndex(),this.stringIndex}},{key:"createStringIndex",value:function(){var e=void 0,t=this.setSlots,n=this.delta,a=this.setSlots+","+this.clearSlots;for(e=0;t>0;t>>=1,e++)if(1===(1&t))switch(a+=",",e){case i.default.NUMBER_FORMAT:a+=n.getNumberFormat()?n.getNumberFormat().toString():"";break;case i.default.BACKGROUND_COLOR:a+=n.getBackgroundColor()?n.getBackgroundColor().toString():"";break;case i.default.BORDER_TOP:a+=n.getBorderTop()?n.getBorderTop().toString():"";break;case i.default.BORDER_RIGHT:a+=n.getBorderRight()?n.getBorderRight().toString():"";break;case i.default.BORDER_BOTTOM:a+=n.getBorderBottom()?n.getBorderBottom().toString():"";break;case i.default.BORDER_LEFT:a+=n.getBorderLeft()?n.getBorderLeft().toString():"";break;case i.default.HORIZONTAL_ALIGN:a+=n.getHorizontalAlign();break;case i.default.VERTICAL_ALIGN:a+=n.getVerticalAlign();break;case i.default.WRAP_STRATEGY:a+=n.getWrapStrategy();break;case i.default.FOREGROUND_COLOR:a+=n.getColor()?n.getColor().toString():"";break;case i.default.FONT_FAMINY:a+=n.getFontFamily();break;case i.default.FONT_SIZE:a+=n.getFontSize();break;case i.default.BOLD:a+=n.getBold();break;case i.default.ITALIC:a+=n.getItalic();break;case i.default.STRIKETHROUGH:a+=n.getStrikethrough();break;case i.default.UNDERLINE:a+=n.getUnderline()}return this.stringIndex=a,this}},{key:"clone",value:function(){return new e({setSlots:this.setSlots,clearSlots:this.clearSlots,delta:this.delta?this.delta.clone():void 0})}}],[{key:"deserialize",value:function(t){var n=new e({setSlots:0,clearSlots:t[1]}),a=void 0,r=t[0]||0;for(a=0;r>0;r>>=1,a++)if(1===(1&r))switch(a){case i.default.NUMBER_FORMAT:t[2]&&n.setSlot(i.default.NUMBER_FORMAT,{id:t[2][0],pattern:t[2][1]});break;case i.default.BACKGROUND_COLOR:t[3]&&n.setSlot(i.default.BACKGROUND_COLOR,t[3]);break;case i.default.BORDER_TOP:t[4]&&n.setSlot(i.default.BORDER_TOP,{style:t[4][0],width:t[4][1],color:t[4][2]});break;case i.default.BORDER_RIGHT:t[5]&&n.setSlot(i.default.BORDER_RIGHT,{style:t[5][0],width:t[5][1],color:t[5][2]});break;case i.default.BORDER_BOTTOM:t[6]&&n.setSlot(i.default.BORDER_BOTTOM,{style:t[6][0],width:t[6][1],color:t[6][2]});break;case i.default.BORDER_LEFT:t[7]&&n.setSlot(i.default.BORDER_LEFT,{style:t[7][0],width:t[7][1],color:t[7][2]});break;case i.default.HORIZONTAL_ALIGN:null!=t[8]&&n.setSlot(i.default.HORIZONTAL_ALIGN,t[8]);break;case i.default.VERTICAL_ALIGN:null!=t[9]&&n.setSlot(i.default.VERTICAL_ALIGN,t[9]);break;case i.default.WRAP_STRATEGY:null!=t[10]&&n.setSlot(i.default.WRAP_STRATEGY,t[10]);break;case i.default.FOREGROUND_COLOR:t[11]&&n.setSlot(i.default.FOREGROUND_COLOR,t[11]);break;case i.default.FONT_FAMINY:null!=t[12]?n.setSlot(i.default.FONT_FAMINY,t[12]):n.clearSlot(i.default.FONT_FAMINY);break;case i.default.FONT_SIZE:null!=t[13]?n.setSlot(i.default.FONT_SIZE,t[13]):n.clearSlot(i.default.FONT_SIZE);break;case i.default.BOLD:null!=t[14]&&n.setSlot(i.default.BOLD,!!t[14]);break;case i.default.ITALIC:null!=t[15]&&n.setSlot(i.default.ITALIC,!!t[15]);break;case i.default.STRIKETHROUGH:null!=t[16]&&n.setSlot(i.default.STRIKETHROUGH,!!t[16]);break;case i.default.UNDERLINE:null!=t[17]?n.setSlot(i.default.UNDERLINE,t[17]):n.clearSlot(i.default.UNDERLINE)}return n}}]),e}();d.protoMap={0:{name:"setSlots",dataType:Number},1:{name:"clearSlots",dataType:Number},2:{name:"delta",dataType:o.default}},t.default=d},390:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasteMapping=void 0;var a=v(n(24)),r=v(n(3)),o=v(n(1)),i=v(n(4)),l=v(n(5)),d=v(n(63)),s=v(n(0)),u=v(n(17)),f=v(n(30)),h=v(n(11)),c=v(n(67)),I=n(55),g=v(n(35)),R=v(n(15));function v(e){return e&&e.__esModule?e:{default:e}}var p=t.PasteMapping=function e(t){(0,s.default)(this,e),this.source=t.source,this.destination=t.destination};function T(e,t){return e.getRowCount()===t.getRowCount()&&e.getColCount()===t.getColCount()}p.protoMap={0:{name:"source",dataType:h.default},1:{name:"destination",dataType:h.default}};var E=function(e){function t(e){(0,s.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,r.default)(t)).call(this,u.default.COPY_PASTE_MUTATION,e));n.sheetId=e.sheetId,n.cellMask=e.cellMask,n.formatMask=e.formatMask;var a=e.pasteMappings;return n.checkPasteMappings(a)?n.pasteMappings=e.pasteMappings:(console.warn("pasteMapping must be same rowLen and colLen"),n.pasteMappings=n.filterPasteMappings(a)),n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){var e,t=[this.sheetId,this.cellMask,this.formatMask],n=void 0,a=[];for(n=0,e=this.pasteMappings.length;n<e;n++)a.push([this.pasteMappings[n].source.serialize(),this.pasteMappings[n].destination.serialize()]);return t.push(a),t}},{key:"getAffectedGridRanges",value:function(){return this.pasteMappings.map(function(e){return e.destination})}},{key:"checkPasteMappings",value:function(e){var t=!0;return e.forEach(function(e){var n=e.source,a=e.destination;t&&(t=T(n,a))}),t}},{key:"filterPasteMappings",value:function(e){return e.filter(function(e){return T(e.source,e.destination)})}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t=[];return function(e){var t=new d.default;return e.filter(function(e){return!t.has(e)&&t.set(e,1)})}(this.pasteMappings.map(function(e){var t=e.source;e.destination;return t.sheetId})).forEach(function(n){var a=e.getSheetBySheetId(n);a&&t.push(a)}),t}},{key:"runOnSheet",value:function(e){var t=e.getSheetId(),n=this.cellMask,a=this.formatMask;this.pasteMappings.forEach(function(r){for(var o=r.source,i=r.destination,l=o.startColIndex,d=o.startRowIndex,s=i.startColIndex,u=i.endColIndex,f=i.startRowIndex,h=i.endRowIndex,g=s-l,R=f-d,v=(e.data.rowData,[]),p=f;p<=h;p++)for(var T=s;T<=u;T++){var E=e.getCellDataAtPosition(p-R,T-g),m=e.getCellDataAtPosition(p,T),_=(0,I.createCellDataDelta)({cellData:m,rowIndex:p-R,colIndex:T-g,sheetId:t},{cellData:E,rowIndex:p,colIndex:T,sheetId:t},n,a);_.isEmpty()||v.push({rowIndex:p,colIndex:T,cellDataDelta:_})}new c.default({gridRange:i,cellDataDeltaAtPositions:v}).run(e,{isLocal:!1})})}},{key:"invert",value:function(e){var t=[],n=this.cellMask,r=this.formatMask;return this.pasteMappings.forEach(function(o){var i=o.source,l=o.destination,d=i.sheetId,s=i.startColIndex,u=i.startRowIndex,f=l.startColIndex,h=l.endColIndex,g=l.startRowIndex,R=l.endRowIndex,v=f-s,p=g-u,T=e.getSheetBySheetId(d);if(T){T.data.rowData;for(var E=[],m=g;m<=R;m++)for(var _=f;_<=h;_++){var y=T.getCellDataAtPosition(m-p,_-v),x=T.getCellDataAtPosition(m,_),S=(0,I.createCellDataDelta)({cellData:x,rowIndex:m-p,colIndex:_-v,sheetId:d},{cellData:y,rowIndex:m,colIndex:_,sheetId:d},n,r);S.isEmpty()||E.push({rowIndex:m,colIndex:_,cellDataDelta:S})}var O=new c.default({gridRange:l,cellDataDeltaAtPositions:E}).invert(e);t=[].concat((0,a.default)(t),(0,a.default)(O))}}),t}},{key:"transformWithInsertDimensionMutation",value:function(e,t){return this.pasteMappings.forEach(function(t){var n=t.source,a=t.destination;(n=n.clone()).insertDimension(e),(a=a.clone()).insertDimension(e)}),[this]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=-2147483647,r=2147483647;function o(e,t){return e==a?e:e+t}function i(e){return e!=a?e:r}function l(e,t){return e.startIndex==e.endIndex&&e.startIndex!=a&&e.endIndex!=a&&t.startIndex==t.endIndex&&t.startIndex!=a&&t.endIndex!=a?e.endIndex<t.startIndex:i(e.endIndex)<=t.startIndex}function d(e,t){return t.startIndex==t.endIndex&&t.startIndex!=a&&t.endIndex!=a?e.startIndex==e.endIndex&&e.startIndex!=a&&e.endIndex!=a&&e.startIndex==t.startIndex:e.startIndex==e.endIndex&&e.startIndex!=a&&e.endIndex!=a?e.startIndex>=t.startIndex&&e.startIndex<i(t.endIndex):e.startIndex>=t.startIndex&&i(e.endIndex)<=i(t.endIndex)}function u(e,t){var n,a,r,s,u,f;return 0==(s=t.endIndex-t.startIndex)?e:l(e,t)?e:d(e,t)?(f=t.startIndex,new E(f,f)):(u=e.startIndex,n=e.endIndex,r=i(e.endIndex),e.startIndex<t.startIndex&&r>t.startIndex&&r<i(t.endIndex)?n=t.startIndex:d(t,e)?n=o(n,-s):(a=i(t.endIndex),t.startIndex<e.startIndex&&a>e.startIndex&&a<i(e.endIndex)?(u=t.startIndex,n=o(n,-s)):l(t,e)&&(u=o(u,-s),n=o(n,-s))),new E(u,n))}function f(e,t,n,a){var r,o,i;return I(t,e.sheetId)?(i=n==R.default.ROWS,(r=u(o=T(e,n),a))==o||r.startIndex==o.startIndex&&r.endIndex==o.endIndex?e:i?function(e,t){return new h.default(e.sheetId,e.startRowIndex,e.endRowIndex,t.startIndex,t.endIndex)}(e,r):function(e,t){return new h.default(e.sheetId,t.startIndex,t.endIndex,e.startColIndex,e.endColIndex)}(e,r)):e}function c(e){return null==e?null:e}function I(e,t){return c(e)===c(t)}var v=h.default;function T(e,t){var n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=e.endColIndex;e.sheetId;return t===R.default.ROWS?new E(n,a):new E(r,o)}var E=function e(t,n){(0,s.default)(this,e),this.startIndex=t,this.endIndex=n};function m(e,t,n){return function(e,t,n,a){return t==R.default.ROWS?new v(e.sheetId,n,e.endRowIndex,a,e.endColIndex):new v(e.sheetId,e.startRowIndex,n,e.startColIndex,a)}(e,n,t.startIndex,t.endIndex)}function _(e,t,n){var a,r,o,i,l,d;return d=T(e.source,n),a=T(e.destination,n),o=m(e.source,new E(d.startIndex,d.startIndex+t),n),l=m(e.source,new E(d.startIndex+t,d.endIndex),n),r=m(e.destination,new E(a.startIndex,a.startIndex+t),n),i=m(e.destination,new E(a.startIndex+t,a.endIndex),n),{a:new p({source:o,destination:r}),c:new p({source:l,destination:i})}}function y(e,t,n,a){return a>e&&t>n||e==n&&t==a}var x=[];this.pasteMappings.forEach(function(t){var n=t.source,a=t.destination;(n=n.clone()).deleteDimension(e),(a=a.clone()).deleteDimension(e),function t(n,a,r){var o,i,l,d,s=void 0,u=void 0,h=void 0;if(e.type){var c=a.type==R.default.ROWS?R.default.ROWS:R.default.COLUMNS;i=new g.default(a.sheetId,a.index,a.index+a.amount,e.type),d=T(n.source,c),l=T(n.destination,c),o=a.sheetId,y(d.startIndex,d.endIndex,i.startIndex,i.endIndex)&&o===n.source.sheetId?i.startIndex>d.startIndex?(t((h=_(n,i.startIndex-d.startIndex,c)).a,a,r),t(h.c,a,r)):i.endIndex<d.endIndex&&(t((h=_(n,i.endIndex-d.startIndex,c)).a,a,r),t(h.c,a,r)):y(l.startIndex,l.endIndex,i.startIndex,i.endIndex)&&o===n.destination.sheetId?i.startIndex>l.startIndex?(t((h=_(n,i.startIndex-l.startIndex,c)).a,a,r),t(h.c,a,r)):i.endIndex<l.endIndex&&(t((h=_(n,i.endIndex-l.startIndex,c)).a,a,r),t(h.c,a,r)):(u=I(o,n.source.sheetId)?f(n.source,o,c,i):n.source,s=I(o,n.destination.sheetId)?f(n.destination,o,c,i):n.destination,r.push(new p({source:u,destination:s})))}else console.warn("copy paste mutation transform with dimensionMutation that is without dimension type")}(t,e,x)});var S=0==x.length?null:new t({sheetId:this.sheetId,pasteMappings:x,cellMask:this.cellMask,formatMask:this.formatMask});return S?[S]:[]}},{key:"transformWithSetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){return[this]}},{key:"transformWithMergeCellsMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){var n,a={sheetId:e[0],cellMask:e[1],formatMask:e[2],pasteMappings:[]},r=void 0;for(r=0,n=e[3].length;r<n;r++)a.pasteMappings.push({source:h.default.deserialize(e[3][r][0]),destination:h.default.deserialize(e[3][r][1])});return new t(a)}}]),t}(f.default);E.protoMap={0:{name:"cellMask",dataType:Number},1:{name:"formatMask",dataType:Number},2:{name:"pasteMappings",dataType:{type:Array,subType:p}},3:{name:"sheetId",dataType:String}},t.default=E},391:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(3)),r=s(n(0)),o=s(n(4)),i=s(n(1)),l=s(n(5)),d=s(n(17));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.EMPTY_MUTATION,e));return n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,i.default)(t,null,[{key:"deserialize",value:function(e){return new t({sheetId:""})}}]),(0,i.default)(t,[{key:"serialize",value:function(){return[]}},{key:"getAffectedSheets",value:function(e){return[]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"check",value:function(e){return!0}},{key:"runOnSheet",value:function(e){}},{key:"invert",value:function(){return[]}}]),t}(s(n(30)).default);t.default=u},413:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCellDataDelta=void 0;var a=k(n(3)),r=k(n(0)),o=k(n(1)),i=k(n(4)),l=k(n(5)),d=k(n(20)),s=k(n(11)),u=k(n(29)),f=k(n(18)),h=k(n(39)),c=n(32),I=k(c),g=k(n(43)),R=k(n(62)),v=k(n(223)),p=k(n(78)),T=n(57),E=n(250),m=k(n(108)),_=n(33),y=k(n(185)),x=k(n(60)),S=n(48),O=n(291),C=k(O),D=k(n(109)),M=k(n(95)),w=k(n(7)),A=k(n(13)),F=k(n(8));function k(e){return e&&e.__esModule?e:{default:e}}w.default.window;var L=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));o.isValid=!0;var l=void 0;l=e.sheetId?e.sheetId:n&&n.activeCell.sheetId||"";var d=w.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e.rowIndex,e.colIndex),s=d&&d.getHyperlink(),u=(0,E.parseLinkUrl)(e.userEnterValue,!1);return u&&!s&&e.textFormatRuns&&(e.textFormatRuns=e.textFormatRuns.map(function(e){return e?e&&!e.format&&(e.format=new M.default({})):e=new D.default({startIndex:0,format:new M.default({})}),e&&e.format&&e.format.setProperties({underline:y.default.SINGLE_LINE,color:_.HYPERLINK_COLOR}),e})),o.behaviors=[{sheetId:l,rowIndex:e.rowIndex,colIndex:e.colIndex,userEnterValue:e.userEnterValue,isChanged:e.isChanged,isTextFormatRunsChanged:e.isTextFormatRunsChanged,linkUrl:u,textFormatRuns:e.textFormatRuns||null,mentionDetailsMap:e.mentionDetailsMap}],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"checkOptionsWithCurrentCellData",value:function(e,t){var n=!0;return t&&t.forEach(function(t){var a=e.getSheetBySheetId(t.sheetId);if(a){var r=a.getCellDataAtPosition(t.rowIndex,t.colIndex),o=r&&r.getUserEnteredFormat(),i=o&&o.getNumberFormat(),l=(0,S.isTextCell)(i),d=r&&r.getFormula(),s=l&&d,u=r&&r.getEffectiveValue(),f=void 0;t.isChanged||t.linkUrl||s||t.isTextFormatRunsChanged||(l||!u||u.type!==R.default.STRING?n=!1:(f=(0,T.parseValueWithStyle)(t.userEnterValue,i,{parseMode:T.PARSE_MODE.PARSE_STYLE_FIRST}),u&&u.type===R.default.STRING&&f.valueType!==v.default.STRING||(n=!1)))}else n=!1}),n}},{key:"check",value:function(e){return this.isValid=this.isValid&&this.checkOptionsWithCurrentCellData(e,this.behaviors),this.isValid?null:{ignore:!0}}},{key:"do",value:function(e,t,n){var a=e.sheetId,r=t.getSheetBySheetId(a);if(r){var o=r.getCellDataAtPosition(e.rowIndex,e.colIndex),i=this.getCellDataDelta(o,a,e),l=new s.default(e.sheetId,e.rowIndex,e.rowIndex,e.colIndex,e.colIndex);if(n(new g.default({gridRange:l,cellDataDelta:i})),(0,O.isNeedExtendFilterRange)([l])){var d=(0,C.default)();d.length>0&&n(d[0])}o&&o.getHyperlink()&&F.default.tdwReport({opername:"doc_excel_editor",module:"excel_link",action:"edit_url_cell"})}}},{key:"getCellDataDelta",value:function(e,t,n){return N({cellData:e,sheetId:t,rowIndex:n.rowIndex,colIndex:n.colIndex,userEnterValue:n.userEnterValue,linkUrl:n.linkUrl,isChanged:n.isChanged,textFormatRuns:n.textFormatRuns,isTextFormatRunsChanged:n.isTextFormatRunsChanged,mentionDetailsMap:n.mentionDetailsMap})}},{key:"id",get:function(){return A.default.SET_SINGLE_VALUE_REQUEST}}]),t}(d.default);function N(e){var t=e.cellData,n=void 0===t?null:t,a=e.sheetId,r=e.userEnterValue,o=(e.linkUrl,e.rowIndex),i=e.colIndex,l=(e.isChanged,e.isTextFormatRunsChanged,e.mentionDetailsMap),d=new u.default,s=n&&n.getUserEnteredFormat(),g=s&&s.getNumberFormat(),R=(0,T.twelveNumberToText)((0,T.parseValueWithStyle)(r,g,{parseMode:T.PARSE_MODE.PARSE_STYLE_FIRST})),E=new h.default,O=(0,S.isTextCell)(g);return R.valueType!==v.default.FORMULA||O?(d.clearSlot(f.default.SLOT_FORMULA),d.setSlot(f.default.SLOT_EFFIECTIVE_VALUE,new p.default({type:Number(R.valueType),value:R.value})),E.setSlot(I.default.NUMBER_FORMAT,R.numberFormat)):"string"===typeof R.value&&(d.clearSlot(f.default.SLOT_EFFIECTIVE_VALUE),d.setSlot(f.default.SLOT_FORMULA,x.default.string2FormulaModel(R.value,o,i,a))),function(e,t,n,a,r){var o=String.fromCharCode(10),i=t?t.getEffectiveValue():null,l=n.valueType===v.default.STRING?n.value:null;l&&l.indexOf(o)>=0?(r.setSlot(I.default.WRAP_STRATEGY,m.default.WRAP),F.default.tdwReport({opername:"doc_excel_editor",module:"excel_wrap",action:"manual_wrap"})):a&&a.getWrapStrategy()===m.default.WRAP&&i&&"string"===typeof i.value&&i.value.indexOf(o)>=0&&null===l&&r.setSlot(I.default.WRAP_STRATEGY,m.default.OVERFLOW_CELL)}(0,n,R,s,E),function(e,t,n,a,r){var o=e.textFormatRuns,i=void 0===o?null:o;if(n.valueType===v.default.STRING)if(i){a.setSlot(f.default.SLOT_RICH_TEXT_STYLE_RUN,i);var l=function(e){var t=void 0,n=void 0,a=void 0,r={},o=["fontFamily","fontSize","bold","italic","strikethrough","underline","color"];for(t=0;t<e.length;t++){if(null===(a=e[t].format))return{};for(n=0;n<o.length;n++)void 0!==r[o[n]]?r[o[n]]!==a[o[n]]&&(delete r[o[n]],o.splice(n,1),n--):r[o[n]]=a[o[n]]}return r}(i),d=void 0,s=void 0;for(s in l)if(d=l[s],null===t||t[s]!==d)switch(s){case"fontFamily":r.setSlot(I.default.FONT_FAMINY,d);break;case"fontSize":r.setSlot(I.default.FONT_SIZE,d);break;case"bold":r.setSlot(I.default.BOLD,d);break;case"italic":r.setSlot(I.default.ITALIC,d);break;case"color":r.setSlot(I.default.FOREGROUND_COLOR,d&&d.clone?d.clone():d);break;case"strikethrough":r.setSlot(I.default.STRIKETHROUGH,d);break;case"underline":r.setSlot(I.default.UNDERLINE,d)}}else a.clearSlot(f.default.SLOT_RICH_TEXT_STYLE_RUN);else a.clearSlot(f.default.SLOT_RICH_TEXT_STYLE_RUN)}(e,s,R,d,E),function(e,t,n){var a=e.userEnterValue,r=e.linkUrl,o=void 0===r?null:r;""===a?(t.clearSlot(f.default.SLOT_HYPERLINK),t.setSlot(f.default.SLOT_USER_ENTERED_FORMAT_DELTA,n)):o&&(t.setSlot(f.default.SLOT_HYPERLINK,o),n.removeSlot(c.CELL_FORMAT_SLOT_COMPOSE.ALL),n.setSlot(I.default.UNDERLINE,y.default.SINGLE_LINE),n.setSlot(I.default.FOREGROUND_COLOR,_.HYPERLINK_COLOR))}(e,d,E),E.isEmpty()||d.setSlot(f.default.SLOT_USER_ENTERED_FORMAT_DELTA,E),l?d.setSlot(f.default.SLOT_MENTION,l):d.clearSlot(f.default.SLOT_MENTION),d}t.getCellDataDelta=N,t.default=L},43:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=O(n(14)),r=O(n(3)),o=O(n(0)),i=O(n(1)),l=O(n(4)),d=O(n(59)),s=O(n(5)),u=n(113),f=O(n(17)),h=O(n(30)),c=O(n(15)),I=O(n(11)),g=O(n(29)),R=n(18),v=O(R),p=O(n(39)),T=O(n(32)),E=O(n(8)),m=n(79),_=O(n(67)),y=O(n(69)),x=O(n(227)),S=n(55);function O(e){return e&&e.__esModule?e:{default:e}}var C=function(e){function t(e){(0,o.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,f.default.SET_CELL_PROPERTIES_MUTATION,e));n.gridRange=e.gridRange,n.cellDataDelta=e.cellDataDelta;try{n.cellDataDelta.delta.formula&&(n.isChangeFormula=!0)}catch(a){}return n}return(0,s.default)(t,e),(0,i.default)(t,[{key:"serialize",value:function(){var e=new x.default;return[this.gridRange.serialize(),this.cellDataDelta.serialize(e),e.serializedPropertiesMap]}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]}},{key:"check",value:function(e){if(!(0,d.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"check",this).call(this,e))return!1;if(!this.gridRange||!this.cellDataDelta)return!1;var n=this.gridRange,a=e.getProperties().getGridProperties();return!!((0,u.isNumber)(n.startRowIndex)&&(0,u.isNumber)(n.endRowIndex)&&(0,u.isNumber)(n.startColIndex)&&(0,u.isNumber)(n.endColIndex))&&!(n.startRowIndex<0||n.endRowIndex>=a.rowCount||n.startColIndex<0||n.endColIndex>=a.columnCount)}},{key:"run",value:function(e,n){return this.runMutationOptions={isLocal:!1},(0,a.default)(this.runMutationOptions,n),(0,d.default)(t.prototype.__proto__||(0,r.default)(t.prototype),"run",this).call(this,e,n)}},{key:"runOnSheet",value:function(e){if(!this.cellDataDelta.isEmpty()){var t,n,a,r,o,i=void 0,l=void 0,d=void 0,s=void 0,u=this.cellDataDelta,f=void 0,h=this.gridRange;for(n=h.startRowIndex,a=h.endRowIndex,r=h.startColIndex,o=h.endColIndex,i=n,t=a;i<=t;i++)for(l=r,d=o;l<=d;l++)if((s=e.getCellDataAtPosition(i,l))&&0!==s.setSlots||0!==u.setSlots){var c=null;null!=s&&(c=s.clone()),f=(0,S.mergeDeltaToCellData)(s,u),e.setCellDataAtPosition(i,l,f),e.updateMentions(c,f,i,l,this.runMutationOptions)}e.positionCenter.setCells({gridRange:this.gridRange})}}},{key:"invert",value:function(e){var t,n,a=void 0,r=void 0,o=void 0,i=e.getSheetBySheetId(this.gridRange.sheetId),l=void 0,d=this.cellDataDelta,s=[],u=this.gridRange,f=void 0,h=void 0,c=void 0,I=void 0;if(!i)return[];for(n=i.data,f=u.startRowIndex<0?n.startRow:u.startRowIndex,h=u.endRowIndex<0?i.getRowCount()-1:u.endRowIndex,c=u.startColIndex<0?n.startColumn:u.startColIndex,I=u.endColIndex<0?i.getColCount()-1:u.endColIndex,a=f,t=h;a<=t;a++)for(r=c,o=I;r<=o;r++)l=i.getCellDataAtPosition(a,r),s.push({rowIndex:a,colIndex:r,cellDataDelta:this.invertCellDataDelta(l,d)});return[new _.default({gridRange:this.gridRange,cellDataDeltaAtPositions:s})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];this.checkFormulaReport();var a,r=void 0,o=[];e.type===c.default.ROWS?e.index>this.gridRange.startRowIndex&&e.index<=this.gridRange.endRowIndex?(o.push(new I.default(this.gridRange.sheetId,this.gridRange.startRowIndex,e.index-1,this.gridRange.startColIndex,this.gridRange.endColIndex)),o.push(new I.default(this.gridRange.sheetId,e.index,this.gridRange.endRowIndex,this.gridRange.startColIndex,this.gridRange.endColIndex))):o.push(this.gridRange):e.index>this.gridRange.startColIndex&&e.index<=this.gridRange.endColIndex?(o.push(new I.default(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,this.gridRange.startColIndex,e.index-1)),o.push(new I.default(this.gridRange.sheetId,this.gridRange.startRowIndex,this.gridRange.endRowIndex,e.index,this.gridRange.endColIndex))):o.push(this.gridRange);var i=[],l=(0,m.changeCellDataDeltaByMutation)(this.cellDataDelta,e);for(r=0,a=o.length;r<a;r++)i.push(new t({gridRange:(0,m.changeGridRangeByInsertDimension)(o[r],o[r].sheetId,e.type,e.index,e.amount,!1,!1),cellDataDelta:l}));return i}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(this.gridRange.sheetId!==e.sheetId)return[this];this.checkFormulaReport();var a=(0,m.changeGridRangeByDeleteDimension)(this.gridRange,e.sheetId,e.type,e.index,e.amount);return a.startRowIndex<a.endRowIndex||a.startColIndex<a.endColIndex?[]:[new t({gridRange:a,cellDataDelta:(0,m.changeCellDataDeltaByMutation)(this.cellDataDelta,e)})]}},{key:"transformWithSetRangeMutation",value:function(e,n){var a=void 0,r=void 0;if(!(0,m.isTwoGridRangeCross)(this.gridRange,e.gridRange))return[this];var o=e.getTotalSlots();if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(o.cellDataSetSlots|o.cellDataClearSlots)))return[this];var i=void 0,l=void 0,d=[],s=void 0,u=[];for(a=0,r=e.cellDataDeltaAtPositions.length;a<r;a++)i=e.cellDataDeltaAtPositions[a],(0,m.isCellInGridRange)(this.gridRange,i.rowIndex,i.colIndex)&&(l=(0,m.transformTwoCellDataDelta)(this.cellDataDelta,i.cellDataDelta,n),s=new I.default(this.gridRange.sheetId,i.rowIndex,i.rowIndex,i.colIndex,i.colIndex),l.isEmpty()||d.push(new t({gridRange:s,cellDataDelta:l})),u.push(s));for(a=0,r=(u=(0,m.divideGridRangeByCells)(this.gridRange,u)).length;a<r;a++)d.push(new t({gridRange:u[a],cellDataDelta:this.cellDataDelta}));return d}},{key:"transformWithSetCellPropertiesMutation",value:function(e,n){var a,r=void 0;if(!(0,m.isTwoGridRangeCross)(this.gridRange,e.gridRange))return[this];if(0===((this.cellDataDelta.setSlots|this.cellDataDelta.clearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var o=(0,m.transformTwoCellDataDelta)(this.cellDataDelta,e.cellDataDelta,n);if(e.gridRange.contain(this.gridRange))return o.isEmpty()?[]:[new t({gridRange:this.gridRange,cellDataDelta:o})];var i=(0,m.getCrossGridRange)(this.gridRange,e.gridRange),l=[];o.isEmpty()||l.push(new t({gridRange:i,cellDataDelta:o}));var d=(0,m.divideGridRangeByCells)(this.gridRange,[i]);for(r=0,a=d.length;r<a;r++)l.push(new t({gridRange:d[r],cellDataDelta:this.cellDataDelta}));return l}},{key:"transformWithMergeCellsMutation",value:function(e,n){var a=void 0,r=void 0;if(0===this.cellDataDelta.setSlots)return[this];var o=[];o.push(new I.default(e.sheetId,e.startRowIndex+1,e.endRowIndex,e.startColIndex,e.endColIndex)),o.push(new I.default(e.sheetId,e.startRowIndex,e.startRowIndex,e.startColIndex+1,e.endColIndex));var i=void 0,l=[];for(a=0,r=o.length;a<r;a++)(i=(0,m.getCrossGridRange)(this.gridRange,o[a]))&&l.push(i);if(0===l.length)return[this];if(n)return[new y.default({sheetId:e.sheetId,startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex})];var d=[];for(a=0,r=(l=(0,m.divideGridRangeByCells)(this.gridRange,l)).length;a<r;a++)d.push(new t({gridRange:l[a],cellDataDelta:this.cellDataDelta}));return d}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[this]}},{key:"transformWithReorderRangeMutation",value:function(e,n){var a=void 0,r=void 0;this.checkFormulaReport();var o=(0,m.getCrossGridRange)(this.gridRange,e.range);if(!o)return[this];var i=(0,m.divideGridRangeByCells)(this.gridRange,[o]),l=[];for(a=0,r=i.length;a<r;a++)l.push(new t({gridRange:i[a],cellDataDelta:this.cellDataDelta}));var d,s=void 0,u=void 0;for(d=(0,m.changeCellDataDeltaByMutation)(this.cellDataDelta,e),s=(0,m.divideCellDataDeltaByBorders)(d),a=o.startRowIndex,r=o.endRowIndex;a<=r;a++)(u=e.getOrderResult(a))?(s.borders&&!s.borders.isEmpty()&&l.push(new t({gridRange:new I.default(o.sheetId,a,a,o.startColIndex,o.endColIndex),cellDataDelta:s.borders})),s.other&&!s.other.isEmpty()&&l.push(new t({gridRange:new I.default(o.sheetId,u,u,o.startColIndex,o.endColIndex),cellDataDelta:s.other}))):l.push(new t({gridRange:new I.default(o.sheetId,a,a,o.startColIndex,o.endColIndex),cellDataDelta:this.cellDataDelta}));return l}},{key:"transformWithMapRangeMutation",value:function(e,n){var a,r=void 0;this.checkFormulaReport();var o=(0,m.changeCellDataDeltaByMutation)(this.cellDataDelta,e),i=(0,m.getCrossGridRange)(this.gridRange,new I.default(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.startIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.startIndex));if(!i)return[new t({gridRange:this.gridRange,cellDataDelta:o})];var l=[];l.push(new t({gridRange:i,cellDataDelta:new g.default({clearSlots:R.CELL_DATA_SLOT_COMPOSE.ALL})}));var d=new I.default(this.gridRange.sheetId,-1===e.row.from.startIndex?i.startRowIndex:i.startRowIndex-e.row.from.startIndex+e.row.to,-1===e.row.from.startIndex?i.endRowIndex:i.endRowIndex-e.row.from.startIndex+e.row.to,-1===e.column.from.startIndex?i.startColIndex:i.startColIndex-e.column.from.startIndex+e.column.to,-1===e.column.from.startIndex?i.endColIndex:i.endColIndex-e.column.from.startIndex+e.column.to);l.push(new t({gridRange:d,cellDataDelta:o}));var s=(0,m.divideGridRangeByCells)(this.gridRange,[i]);for(r=0,a=s.length;r<a;r++)l.push(new t({gridRange:s[r],cellDataDelta:this.cellDataDelta}));return l}},{key:"invertCellDataDelta",value:function(e,t){var n=void 0,a=t.setSlots|t.clearSlots,r=new g.default,o=void 0,i=void 0;for(n=0;a>0;n++,a>>=1)if(1===(1&a))switch(n){case v.default.SLOT_EFFIECTIVE_VALUE:e&&e.getEffectiveValue()?r.setSlot(v.default.SLOT_EFFIECTIVE_VALUE,e.getEffectiveValue()):r.clearSlot(v.default.SLOT_EFFIECTIVE_VALUE);break;case v.default.SLOT_USER_ENTERED_FORMAT_DELTA:e&&e.getUserEnteredFormat()?(o=1<<v.default.SLOT_USER_ENTERED_FORMAT_DELTA,(t.clearSlots&o)>0?r.setSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA,new p.default({setSlots:e.getUserEnteredFormat().setSlots,clearSlots:0,delta:e.getUserEnteredFormat()})):(i=this.invertCellFormatDelta(e.getUserEnteredFormat(),t.delta.userEnteredFormatDelta),t.isEmpty()||r.setSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA,i))):r.clearSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA);break;case v.default.SLOT_EFFIECTIVE_FORMAT_DELTA:e&&e.getEffectiveFormat()?(o=1<<v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,(t.clearSlots&o)>0?r.setSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,new p.default({setSlots:e.getEffectiveFormat().setSlots,clearSlots:0,delta:e.getEffectiveFormat()})):(i=this.invertCellFormatDelta(e.getEffectiveFormat(),t.delta.effectiveFormatDelta),t.isEmpty()||r.setSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,i))):r.clearSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA);break;case v.default.SLOT_HYPERLINK:e&&null!==e.getHyperlink()?r.setSlot(v.default.SLOT_HYPERLINK,e.getHyperlink()):r.clearSlot(v.default.SLOT_HYPERLINK);break;case v.default.SLOT_FORMULA:e&&e.getFormula()?r.setSlot(v.default.SLOT_FORMULA,e.getFormula()):r.clearSlot(v.default.SLOT_FORMULA);break;case v.default.SLOT_AUTHOR:e&&e.getAuthor()?r.setSlot(v.default.SLOT_AUTHOR,e.getAuthor()):r.clearSlot(v.default.SLOT_AUTHOR);break;case v.default.SLOT_RICH_TEXT_STYLE_RUN:e&&e.getTextFormatRuns()?r.setSlot(v.default.SLOT_RICH_TEXT_STYLE_RUN,e.getTextFormatRuns()):r.clearSlot(v.default.SLOT_RICH_TEXT_STYLE_RUN);break;case v.default.SLOT_IS_DATA_VALID:e&&e.getIsDataValid()?r.setSlot(v.default.SLOT_IS_DATA_VALID,e.getIsDataValid()):r.clearSlot(v.default.SLOT_IS_DATA_VALID);case v.default.SLOT_MENTION:e&&e.getMentionDetails()?r.setSlot(v.default.SLOT_MENTION,e.getMentionDetails()):r.clearSlot(v.default.SLOT_MENTION)}return r}},{key:"invertCellFormatDelta",value:function(e,t){var n=void 0,a=t.setSlots|t.clearSlots,r=new p.default;for(n=0;a>0;n++,a>>=1)if(1===(1&a))switch(n){case T.default.NUMBER_FORMAT:e.getNumberFormat()?r.setSlot(T.default.NUMBER_FORMAT,e.getNumberFormat()):r.clearSlot(T.default.NUMBER_FORMAT);break;case T.default.BACKGROUND_COLOR:e.getBackgroundColor()?r.setSlot(T.default.BACKGROUND_COLOR,e.getBackgroundColor()):r.clearSlot(T.default.BACKGROUND_COLOR);break;case T.default.BORDER_TOP:e.getBorders()&&e.getBorders().top?r.setSlot(T.default.BORDER_TOP,e.getBorders().top):r.clearSlot(T.default.BORDER_TOP);break;case T.default.BORDER_RIGHT:e.getBorders()&&e.getBorders().right?r.setSlot(T.default.BORDER_RIGHT,e.getBorders().right):r.clearSlot(T.default.BORDER_RIGHT);break;case T.default.BORDER_BOTTOM:e.getBorders()&&e.getBorders().bottom?r.setSlot(T.default.BORDER_BOTTOM,e.getBorders().bottom):r.clearSlot(T.default.BORDER_BOTTOM);break;case T.default.BORDER_LEFT:e.getBorders()&&e.getBorders().left?r.setSlot(T.default.BORDER_LEFT,e.getBorders().left):r.clearSlot(T.default.BORDER_LEFT);break;case T.default.HORIZONTAL_ALIGN:e.getHorizontalAlign()?r.setSlot(T.default.HORIZONTAL_ALIGN,e.getHorizontalAlign()):r.clearSlot(T.default.HORIZONTAL_ALIGN);break;case T.default.VERTICAL_ALIGN:e.getVerticalAlign()?r.setSlot(T.default.VERTICAL_ALIGN,e.getVerticalAlign()):r.clearSlot(T.default.VERTICAL_ALIGN);break;case T.default.WRAP_STRATEGY:e.getWrapStrategy()?r.setSlot(T.default.WRAP_STRATEGY,e.getWrapStrategy()):r.clearSlot(T.default.WRAP_STRATEGY);break;case T.default.FOREGROUND_COLOR:e.getTextFormat()&&e.getTextFormat().color?r.setSlot(T.default.FOREGROUND_COLOR,e.getTextFormat().color):r.clearSlot(T.default.FOREGROUND_COLOR);break;case T.default.FONT_FAMINY:e.getTextFormat()&&e.getTextFormat().fontFamily?r.setSlot(T.default.FONT_FAMINY,e.getTextFormat().fontFamily):r.clearSlot(T.default.FONT_FAMINY);break;case T.default.FONT_SIZE:e.getTextFormat()&&e.getTextFormat().fontSize?r.setSlot(T.default.FONT_SIZE,e.getTextFormat().fontSize):r.clearSlot(T.default.FONT_SIZE);break;case T.default.BOLD:e.getTextFormat()&&e.getTextFormat().bold?r.setSlot(T.default.BOLD,e.getTextFormat().bold):r.clearSlot(T.default.BOLD);break;case T.default.ITALIC:e.getTextFormat()&&e.getTextFormat().italic?r.setSlot(T.default.ITALIC,e.getTextFormat().italic):r.clearSlot(T.default.ITALIC);break;case T.default.STRIKETHROUGH:e.getTextFormat()&&e.getTextFormat().strikethrough?r.setSlot(T.default.STRIKETHROUGH,e.getTextFormat().strikethrough):r.clearSlot(T.default.STRIKETHROUGH);break;case T.default.UNDERLINE:e.getTextFormat()&&e.getTextFormat().underline?r.setSlot(T.default.UNDERLINE,e.getTextFormat().underline):r.clearSlot(T.default.UNDERLINE);break;case T.default.DATA_VALIDATION:e.getDataValidation()?r.setSlot(T.default.DATA_VALIDATION,e.getDataValidation()):r.clearSlot(T.default.DATA_VALIDATION)}return r}},{key:"checkFormulaReport",value:function(){this.isChangeFormula&&E.default.monitor(34451179)}}],[{key:"deserialize",value:function(e){var n=I.default.deserialize(e[0]),a=x.default.createPropertiesMap(e[2]);return new t({gridRange:n,cellDataDelta:g.default.deserialize(e[1],a)})}}]),t}(h.default);C.protoMap={0:{name:"gridRange",dataType:I.default},1:{name:"cellDataDelta",dataType:g.default}},t.default=C},450:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ReorderType=void 0;var a=p(n(3)),r=p(n(0)),o=p(n(1)),i=p(n(4)),l=p(n(5));t.calc=m;var d=p(n(20)),s=p(n(281)),u=p(n(11)),f=p(n(290)),h=p(n(69)),c=p(n(80)),I=p(n(13)),g=p(n(191)),R=n(1364),v=p(n(62));function p(e){return e&&e.__esModule?e:{default:e}}var T=t.ReorderType=void 0;!function(e){e[e.ReverseOrder=0]="ReverseOrder",e[e.PositiveSequence=1]="PositiveSequence"}(T||(t.ReorderType=T={}));var E=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.sheetId=e.sheetId,o.gridRange=e.gridRange,o.behaviors=[{reorderInfos:e.reorderInfos,hasTitle:e.hasTitle}],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){var t,n=null,a=e.getSheetBySheetId(this.sheetId),r=this.gridRange,o=void 0,i=void 0;if(null===a)return n={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u8bf7\u5237\u65b0\u9875\u9762\u91cd\u8bd5"}};for(t=a.getMerges(),i=0;i<t.length;i++)if(o=t[i],r.isCross(o)){var l="";return o.startColIndex===o.endColIndex&&o.startRowIndex!==o.endRowIndex?l="\u7eb5\u5411\u7684":o.startColIndex!==o.endColIndex&&o.startRowIndex===o.endRowIndex&&(l="\u6a2a\u5411\u7684"),n={isWarningOnly:!1,error:{title:"\u6392\u5e8f\u63d0\u793a",content:"\u4f60\u7684\u6392\u5e8f\u533a\u57df\u4e2d\u5305\u542b"+l+"\u5408\u5e76\u5355\u5143\u683c "+o.toString()+" \uff0c\u8bf7\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u540e\u518d\u8fdb\u884c\u6392\u5e8f\u3002"}}}return n}},{key:"do",value:function(e,t,n){var a,r=this.gridRange,o=t.getSheetBySheetId(this.sheetId),i=void 0,l=void 0,d=void 0,u=e.hasTitle;if(void 0!==o){for(a=this.createUnmergeCellsMutations(t),l=0;l<a.length;l++)n(a[l]);var f=this.reorder(o,r,u,e.reorderInfos);for(i=this.createUpdateSheetRangeMutations(t,f,r),n(new s.default({sheetId:this.sheetId,range:r,operation:f})),i.length>0&&i.forEach(function(e){n(e)}),l=0;l<a.length;l++)a[l]instanceof h.default&&(d=a[l].startRowIndex,f.rules[d]?n(new c.default({sheetId:this.sheetId,startRowIndex:f.rules[d].to,endRowIndex:f.rules[d].to,startColIndex:a[l].startColIndex,endColIndex:a[l].endColIndex})):n(new c.default({sheetId:this.sheetId,startRowIndex:a[l].startRowIndex,endRowIndex:a[l].endRowIndex,startColIndex:a[l].startColIndex,endColIndex:a[l].endColIndex})))}}},{key:"reorder",value:function(e,t,n,a){var r=void 0,o={queue:[],rules:{}},i=void 0,l=void 0,d=[],s=[],u=e.getBasicFilter(),f=[];for(u&&(f=u.getHiddenRows()),i=t.startRowIndex<0?e.data.startRow:t.startRowIndex,l=t.endRowIndex<0?e.data.rowData.length-1:t.endRowIndex,n&&(i+=1),r=i;r<=l;r++)f.indexOf(r)>=0||(d.push({index:r}),s.push({index:r,value:this.getValue(e,r,a)}));for(s.sort(m(a)),r=0;r<s.length;r++)s[r].index!==d[r].index&&(o.queue.push(""+s[r].index),o.rules[""+s[r].index]={from:s[r].index,to:d[r].index});return o}},{key:"getValue",value:function(e,t,n){for(var a=[],r=0,o=void 0;r<n.length;r++)o=n[r].column,null!==e.data.rowData[t]&&(e.getCellDataAtPosition(t,o)?a.push(e.data.rowData[t]?e.data.rowData[t].values[o].getEffectiveValue():null):a.push(null));return a}},{key:"createUnmergeCellsMutations",value:function(e){var t=[],n=e.getSheetBySheetId(this.sheetId);return new f.default({sheetId:n.getSheetId(),gridRanges:[this.gridRange]}).run(e,function(e){t.push(e)}),t}},{key:"createUpdateSheetRangeMutations",value:function(e,t,n){var a=[],r=e.getSheetBySheetId(this.sheetId),o=this.sheetId,i=void 0,l=void 0,d=void 0,s=void 0,f=void 0;for(i=0;i<t.queue.length;i++)for(d=t.queue[i],l=n.startColIndex;l<=n.endColIndex;l++)(s=r.getCellDataAtPosition(t.rules[d].from,l))&&(f=s.getSheetRange())&&f.forEach(function(e){var n,r,i;n=e,r=t.rules[d].to,i=l,a.push(new g.default({sheetId:o,sheetRangeId:n.id,sheetRangeType:n.type,gridRange:new u.default(o,r,r,i,i),padId:window.clientVars.padId}))});return a}},{key:"id",get:function(){return I.default.REORDER_RANGE_REQUEST}}]),t}(d.default);function m(e){var t=0,n=function(e){if(e)switch(e.type){case v.default.NUMBER:return parseFloat(e.value+"");case v.default.STRING:case v.default.BOOL:return e.value+"";case v.default.ERROR:return e.value}return null};return function(a,r){var o=void 0;for(t=0;t<e.length;t++){var i=n(a.value[t]),l=n(r.value[t]);if(0!==(o=(0,R.valueSort)(i,l,e[t].type,a.index,r.index)))return o}return 0}}t.default=E},48:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__testExport=t.txSheetToMsoFormatMapping=t.custom_fmt=t.CUSTOM_NUMBER_FORMAT_MAP=t.msoFormatToTxSheetMapping=t.format2TypeMapping=t.BUILDIN_NUMBER_FORMAT_MAP=t.FORMAT_DEFAULT=t.INVALID_VALUE=void 0;var a=g(n(41)),r=g(n(31)),o=g(n(9)),i=g(n(63));t.getRealNumValueStr=B,t.extToExponential=G,t.fmt_is_date=W,t.format=Q,t.getFormatCodeById=Z,t.getIdByFormatStr=X,t.getNumberFormatByFormatCode=q,t.getDefaultNumberFormat=J,t.getFormatCodeByNumberFormat=ee,t.formatValue=te,t.getEditValue=function(e,t){if(null===e)return"";var n=$(ee(t),e),a=void 0;if(n.fmt=Se(n.fmt),W(n.fmt)){var r="";(n.fmt.match(/y{1,5}.*(?!=A|a|P|p)m{1,5}?.*d{1,5}?/)||n.fmt.match(/\[\$\-804\]a{3,4}/)||0!==(0|e))&&(r="yyyy/m/d"),((0|e)!==e||n.fmt.match(/\[[HhMmSs]*\]|h+:m{1,2}(?=:ss)?|h{1,2}(?=.*m{1,2})?(?=.*s{1,2})?|m{1,2}(?=:s{1,2})|ss/))&&(r.length>0&&(r+="_"),r+="hh:mm:ss",-1!==n.fmt.indexOf(".0")&&(r+=".0"));var o=Q(r,e);(a=o[0])===x&&(a=String(e))}else if(n.fmt&&-1!==n.fmt.indexOf("%")){var i="",l=e.toString();-1!==l.toUpperCase().indexOf("E")&&(l=B(l));var d=l.indexOf(".");if(-1!==d){var s=l.length-d-1;s=Math.max(0,s-2),i=0===s?"0%":"0."+v("0",s)+"%"}else i="0%";var u=Q(i,l);a=u[0]}else a=n.fmt&&-1!==e.toString().toUpperCase().indexOf("E")?e.toString().toUpperCase():e.toString();return a},t.getCellFormattedValue=ne,t.isDateCell=function(e,t){if(!t)return!1;if(W($(ee(t),e).fmt))return!0;return!1},t.getFormatInfoByOldFormat=function(e){var t=void 0;t=e&&ae[e]||"General";return{id:X(t),pattern:t}},t.getDetailByValue=function(e){var t=ae[e],n=Re(t),a=oe(n.group);return{pattern:t,name:a,value:n.type,type:n.group}},t.getNumberFormatNameByType=oe,t.modifyFormat=de,t.changeDecimals=function(e,t,n){var a=void 0,r=void 0;t=t||J(),e&&e.type===f.default.NUMBER&&(a=e.value,r=t.pattern||"",n>0?(r=he(a,r),t=q(r)):n<0&&(r=ce(a,r),t=q(r)));return t},t.increaseDecimalFormat=he,t.decreaseDecimalFormat=ce,t.getCurrentCellDotNum=Ie,t.getCurrencySymbol=function(e){l.supportCurrentCurrencyList.sort(function(e,t){return t.symbol.length-e.symbol.length});var t=Se(e,!0),n=t.match(/\[\$(.+)-(.+)\]/),a=void 0;if(n)Oe(t.replace(/(\[\$.+-.+\])/,""))&&(a=n[1]);else{t=t.replace(/\[.*\]/,"");for(var r=0;r<l.supportCurrentCurrencyList.length;r++)-1===t.indexOf(l.supportCurrentCurrencyList[r].symbol)&&-1===e.indexOf('"'+l.supportCurrentCurrencyList[r].symbol+'"')||(a=l.supportCurrentCurrencyList[r].symbol)}return a},t.getFormatType=ge,t.getCellNumberFormatType=Re,t.isDateTimeCell=Ce,t.isGeneralCell=function(e){return!e||void 0===e.id||0===e.id},t.isGeneralCell2=function(e){return!e||"General"===e.pattern},t.isTextCell=function(e){if(e){var t=ee(e);if("@"===t||-1===t.indexOf(";")&&-1!==t.indexOf("@"))return!0}return!1},t.isFractionFormat=De,t.updateCustomNumberFormatMap=function(e){e&&e.forEach(function(e,t){Me.set(t,e)})},t.autoUpdateCustomNumberFormatMap=function(e){var t=we(e);t<0&&Me.set(Math.abs(t)+1,e)},t.getPatternByNumberFormatId=function(e){return Me.has(e)?Me.get(e):e<164?Z(e):C},t.findIdByPattern=we,t.getIdByNumberFormatPattern=function(e){var t=we(e);t<0&&Me.set(Math.abs(t)+1,e);return t<0?Math.abs(t)+1:t};var l=n(57),d=g(n(121)),s=g(n(309)),u=g(n(221)),f=g(n(62)),h=g(n(1083)),c=g(n(368)),I=g(n(81));function g(e){return e&&e.__esModule?e:{default:e}}function R(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function v(e,t){for(var n="";n.length<t;)n+=e;return n}function p(e,t){var n=""+e;return n.length>=t?n:v("0",t-n.length)+n}function T(e,t){var n=""+e;return n.length>=t?n:v(" ",t-n.length)+n}function E(e,t){var n=""+e;return(n=B(n)).length>=t?n:n+v(" ",t-n.length)}var m=Math.pow(2,32);function _(e,t){return e>m||e<-m?function(e,t){var n=""+Math.round(e);return(n=B(n)).length>=t?n:v("0",t-n.length)+n}(e,t):function(e,t){var n=""+e;return(n=B(n)).length>=t?n:v("0",t-n.length)+n}(Math.round(e),t)}function y(e,t){return t=t||0,e.length>=7+t&&103===(32|e.charCodeAt(t))&&101===(32|e.charCodeAt(t+1))&&110===(32|e.charCodeAt(t+2))&&101===(32|e.charCodeAt(t+3))&&114===(32|e.charCodeAt(t+4))&&97===(32|e.charCodeAt(t+5))&&108===(32|e.charCodeAt(t+6))}var x=t.INVALID_VALUE="#INVALID_DATE!",S=[["Sun","Sunday","\u661f\u671f\u5929","\u5468\u65e5"],["Mon","Monday","\u661f\u671f\u4e00","\u5468\u4e00"],["Tue","Tuesday","\u661f\u671f\u4e8c","\u5468\u4e8c"],["Wed","Wednesday","\u661f\u671f\u4e09","\u5468\u4e09"],["Thu","Thursday","\u661f\u671f\u56db","\u5468\u56db"],["Fri","Friday","\u661f\u671f\u4e94","\u5468\u4e94"],["Sat","Saturday","\u661f\u671f\u516d","\u5468\u516d"]],O=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]],C=t.FORMAT_DEFAULT="General",D=t.BUILDIN_NUMBER_FORMAT_MAP=new i.default([[0,C],[1,"0"],[2,"0.00"],[3,"#,##0"],[4,"#,##0.00"],[5,"\\\xa5#,##0;\\\xa5-#,##0"],[6,"\\\xa5#,##0;[Red]\\\xa5-#,##0"],[7,"\\\xa5#,##0.00;\\\xa5-#,##0.00"],[8,"\\\xa5#,##0.00;[Red]\\\xa5-#,##0.00"],[9,"0%"],[10,"0.00%"],[11,"0.00E+00"],[12,"# ?/?"],[13,"# ??/??"],[14,"yyyy/m/d"],[15,"d-mmm-yy"],[16,"d-mmm"],[17,"mmm-yy"],[18,"h:mm AM/PM"],[19,"h:mm:ss AM/PM"],[20,"h:mm"],[21,"hh:mm:ss"],[22,"yyyy/m/d h:mm"],[23,"\\$#,##0_);(\\$#,##0)"],[24,"\\$#,##0_);[Red](\\$#,##0)"],[25,"\\$#,##0.00_);(\\$#,##0.00)"],[26,"\\$#,##0.00_);[Red](\\$#,##0.00)"],[27,'yyyy"\u5e74"m"\u6708"'],[28,'m"\u6708"d"\u65e5"'],[29,'m"\u6708"d"\u65e5"'],[30,"m/d/yy"],[31,'yyyy"\u5e74"m"\u6708"d"\u65e5"'],[32,'h"\u65f6"mm"\u5206"'],[33,'h"\u65f6"mm"\u5206"ss"\u79d2"'],[34,'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"'],[35,'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"'],[36,'yyyy"\u5e74"m"\u6708"'],[37,"#,##0;-#,##0"],[38,"#,##0;[Red]-#,##0"],[39,"#,##0.00;-#,##0.00"],[40,"#,##0.00;[Red]-#,##0.00"],[41,'_ * #,##0_ ;_ * -#,##0_ ;_ * "-"_ ;_ @_ '],[42,'_ \\\xa5* #,##0_ ;_ \\\xa5* -#,##0_ ;_ \\\xa5* "-"_ ;_ @_ '],[43,'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_ '],[44,'_ \\\xa5* #,##0.00_ ;_ \\\xa5* -#,##0.00_ ;_ \\\xa5* "-"??_ ;_ @_ '],[45,"mm:ss"],[46,"[h]:mm:ss"],[47,"mm:ss.0"],[48,"##0.0E+0"],[49,"@"],[50,'yyyy"\u5e74"m"\u6708"'],[51,'m"\u6708"d"\u65e5"'],[52,'yyyy"\u5e74"m"\u6708"'],[53,'m"\u6708"d"\u65e5"'],[54,'m"\u6708"d"\u65e5"'],[55,'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"'],[56,'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"'],[57,'yyyy"\u5e74"m"\u6708"'],[58,'m"\u6708"d"\u65e5"'],[59,"0"],[60,"0.00"],[61,"#,##0"],[62,"#,##0.00"],[63,"\\\xa5#,##0;\\\xa5-#,##0"],[64,"\\\xa5#,##0;[Red]\\\xa5-#,##0"],[65,"\\\xa5#,##0.00;\\\xa5-#,##0.00"],[66,"\\\xa5#,##0.00;[Red]\\\xa5-#,##0.00"],[67,"0%"],[68,"0.00%"],[69,"# ?/?"],[70,"# ??/??"],[71,"yyyy/m/d"],[72,"yyyy/m/d"],[73,"d-mmm-yy"],[74,"d-mmm"],[75,"mmm-yy"],[76,"h:mm"],[77,"h:mm:ss"],[78,"yyyy/m/d h:mm"],[79,"mm:ss"],[80,"[h]:mm:ss"],[81,"mm:ss.0"]]);function M(e,t,n){for(var a=e<0?-1:1,r=e*a,o=0,i=1,l=0,d=1,s=0,u=0,f=Math.floor(r);s<t&&(l=(f=Math.floor(r))*i+o,u=f*s+d,!(r-f<5e-8));)r=1/(r-f),o=i,i=l,d=s,s=u;if(u>t&&(s>t?(u=d,l=o):(u=s,l=i)),!n)return[0,a*l,u];var h=Math.floor(a*l/u);return[B(h+""),a*l-h*u,u]}function w(e,t,n){if(e>=2958466||e<0)return null;var a=0|e,r=Math.floor(86400*(e-a)),o=0,i=[],l={D:a,T:r,u:86400*(e-a)-r,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(l.u)<1e-6&&(l.u=0),t&&t.date1904&&(a+=1462),l.u>=.95&&(l.u=0,86400==++r&&(l.T=r=0,++a,++l.D)),60===a)i=n?[1317,10,29]:[1900,3,1],o=4;else if(0===a)i=n?[1317,8,29]:[1900,1,0],o=6;else{var d=new Date(1900,0,1);d.setDate(d.getDate()+a-1),i=[d.getFullYear(),d.getMonth()+1,d.getDate()],o=d.getDay(),a<60&&(o=(o+6)%7),n&&(o=0)}return l.y=i[0],l.m=i[1],l.d=i[2],l.S=r%60,r=Math.floor(r/60),l.M=r%60,r=Math.floor(r/60),l.H=r,l.q=o,l}var A=function(){var e=/\.(\d*[1-9])0+$/,t=/\.0*$/,n=/\.(\d*[1-9])0+/,a=/\.0*[Ee]/,r=/(E[+-])(\d)$/;function o(n){return n.indexOf(".")>-1?n.replace(t,"").replace(e,".$1"):n}return function(t){var i=Math.floor(Math.log(Math.abs(t))*Math.LOG10E),l=void 0;return l=i>=-4&&i<=-1?t.toPrecision(10+i):Math.abs(i)<=9?function(e){var t=e<0?12:11,n=o(e.toFixed(12));return n.length<=t?n:(n=e.toPrecision(10)).length<=t?n:e.toExponential(5)}(t):10===i?t.toFixed(10).substr(0,12):function(t){var n=t.toFixed(11).replace(e,".$1");return n.length>(t<0?12:11)&&(n=t.toPrecision(6)),n}(t),o(function(e){for(var t=0;t!=e.length;++t)if(101===(32|e.charCodeAt(t)))return e.replace(n,".$1").replace(a,"E").replace("e","E").replace(r,"$10$2");return e}(l))}}();function F(e,t){if((0,l.isNumeric)(e)&&!/\n/.test(e)){var n=Number(e);return n===1/0||n===-1/0?e:(0|n)===n?function(e){return e.toString(10)}(n):A(n)}return e}function k(e,t,n,a){var r="",o=0,i=0,l=n.y,d=void 0,s=0;switch(e){case 97:if("aaaa"===t)return S[n.q][2];if("aaa"===t)return S[n.q][3];break;case 98:l=n.y+543;case 121:switch(t.length){case 1:case 2:d=l%100,s=2;break;default:d=l%1e4,s=4}break;case 109:switch(t.length){case 1:case 2:d=n.m,s=t.length;break;case 3:return O[n.m-1][1];case 5:return O[n.m-1][0];default:return O[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:d=n.d,s=t.length;break;case 3:return S[n.q][0];default:return S[n.q][1]}break;case 104:switch(t.length){case 1:case 2:d=1+(n.H+11)%12,s=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:d=n.H,s=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:d=n.M,s=t.length;break;default:throw"bad minute format: "+t}break;case 115:if("s"!=t&&"ss"!=t&&".0"!=t&&".00"!=t&&".000"!=t)throw"bad second format: "+t;return 0!==n.u||"s"!=t&&"ss"!=t?(a||(a=0),i=a>=2?3===a?1e3:100:1===a?10:1,(o=Math.round(i*(n.S+n.u)))>=60*i&&(o=0),"s"===t?0===o?"0":""+o/i:(r=p(o,2+a),"ss"===t?r.substr(0,2):"."+r.substr(2,t.length-1))):p(n.S,t.length);case 90:switch(t){case"[h]":case"[hh]":d=24*n.D+n.H;break;case"[m]":case"[mm]":d=60*(24*n.D+n.H)+n.M;break;case"[s]":case"[ss]":d=60*(60*(24*n.D+n.H)+n.M)+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}s=3===t.length?1:2;break;case 101:d=l,s=1}return s>0?p(d,s):""}function L(e){if(e.length<=3)return e;for(var t=e.length%3,n=e.substr(0,t);t!=e.length;t+=3)n+=(n.length>0?",":"")+e.substr(t,3);return n}function N(e){var t=e.indexOf(".");return-1!==t?L(e.substr(0,t))+e.substr(t):L(e)}function b(e){return e?e.split("").reverse().join(""):""}function P(e){return e<2147483647&&e>-2147483648?""+(e>=0?0|e:e-1|0):""+Math.floor(e)}function U(e,t){function n(e){var t="";e=e||"";for(var n=0;n<e.length;n++)switch(e.charAt(n)){case"0":t+="0";break;case"?":t+=" "}return t}var a=t&&t.length||0;"number"===typeof e&&(e=e.toString()),-1!==e.toUpperCase().indexOf("E")&&(e=B(e));var r=e.length,o=e.indexOf(".");if(-1===o)e=e+"."+n(t);else if(r-o-1<=a)e+=n(t.substr(r-o-1));else if(r-o-1>a){r=(e=e.substr(0,o+1+a+1)).length;var i=e.substr(-1);if(parseInt(i)>=5){for(var l=!0,d=r-2,s="";d>=0;){var u=e.charAt(d);"."===u?s=u+s:l?9===parseInt(u)?(s="0"+s,l=!0):(s=parseInt(u)+1+s,l=!1):(s=u+s,l=!1),d--}l&&(s="1"+s),0===a&&-1===e.indexOf(".")&&s.length===r&&(s=s.substr(1)),(e=s).length<r-1&&(e=v("0",r-e.length-1)+e)}else e=e.substr(0,e.length-1)}return e.toString()}function B(e){"string"!==typeof e&&(e=e.toString());var t=e.match(/((-?\d+\.\d+)|(-?\d+))[eE]([+-]?\d+)/);if(!t)return e;var n=t[1],a=t[4],r=e;if(void 0===a)return r;if(t){var o=e.indexOf("."),i=parseFloat(a);if(i>=0)if(-1!==o){r=e.substr(0,o);for(var l=o,d=0;d<i;d++)(l=o+d+1)<n.length?r+=n.charAt(l):r+="0";l<n.length-1&&(r+=".",r+=n.substr(l+1))}else{var s=e.toLowerCase().indexOf("e");r=e.substr(0,s),r+=v("0",Math.abs(i))}else r=n.replace(".",""),r="0."+v("0",Math.abs(i)-1)+r}return r}function G(e,t){if("number"!==typeof e)return String(e);if("Infinity"===(e=e.toString())||"-Infinity"===e)return e;(e.includes("e")||e.includes("E"))&&(e=B(e)),void 0===t&&(t=e.replace(/[^\d]/g,"").length-1),e.includes(".")||(e+=".0");var n="-"===e[0],a=(e=e.replace(/^-?([0-9.]+)$/,"$1")).indexOf(".")-e.replace(/[.]/g,"").replace(/^(0*)([^0])([0-9]*)$/,"$1$2.$3").indexOf("."),r=0===a?"e+0":"e"+(a>0?"+"+a:a+"");if(e=e.replace(/[.]/g,"").replace(/^(0*)([^0])([0-9]*)$/,"$2.$30"),/^0+$/.test(e))return"0."+new Array(t).fill("0").join("")+"e+0";var o=e.match(/^([1-9])\.([0-9]+)$/),i=o&&o[1]||"",l=o&&o[2]||"";if(l.length>t){var d=l.slice(t,t+1);l=l.slice(0,t),parseInt(d)>4&&(l=l.slice(0,t-1)+(parseInt(l.slice(-1))+1).toString())}else l+=new Array(t-l.length).fill("0").join("");return(n?"-":"")+i+(l=""===l?"":"."+l)+r}var V=function(){var e=/%/g;function t(t,n,a){var r=n.replace(e,""),o=n.length-r.length;return V(t,r,function(e,t){-1===e.indexOf("e")&&-1===e.indexOf("E")||(e=B(e));var n=e.indexOf("."),a=void 0;if(-1!==n){var r=e.slice(0,n),o=e.slice(n+1);a=r,o.length>t?(a+=o.substr(0,t),a+=".",a+=o.substr(t)):a+=o+v("0",t-o.length)}else a=e+v("0",t);return a}(a.toString(),2*o))+v("%",o)}var n=/# (\?+)( ?)\/( ?)(\d+)/;var a=/^#*0*\.([0#?]+)/,r=/\).*[0#]/,o=/\(###\) ###\\?-####/;function i(e){for(var t="",n=void 0,a=0;a!=e.length;++a)switch(n=e.charCodeAt(a)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function d(e,l,u){if(40===e.charCodeAt(0)&&!l.match(r)){var f=/\) */.test(l),h=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return u>=0?d("n",h,u):"("+d("n",h,-u)+(f?")":"")}if(44===l.charCodeAt(l.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return V(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(e,l,u);if(-1!==l.indexOf("%"))return t(e,l,u);if(-1!==l.indexOf("E"))return function e(t,n){if(!isNaN(n)&&n<0)return"-"+e(t,-n);var a=void 0,r=(t=t.toUpperCase()).indexOf("E")-t.indexOf(".")-1,o=t.match(/^(#+0).0E\+0?$/);if(o){if(0==n)return v("0",o[1].length)+".0E+0";if(n<0)return"-"+e(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%i;if(l<0&&(l+=i),-1===(a=(n/Math.pow(10,l)).toPrecision(r+1+(i+l)%i)).indexOf("e")){var d=Math.floor(Math.log(n)*Math.LOG10E);for(-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+l):a+="E+"+(d-l);"0."===a.substr(0,2);)a=(a=a.charAt(0)+a.substr(2,i)+"."+a.substr(2+i)).replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,a){return t+n+a.substr(0,(i+l)%i)+"."+a.substr(l)+"E"})}else if(-1!==t.indexOf(".")){var u=new s.default(n).toExponential(r+2),f=u.indexOf("e")||u.indexOf("E"),h=U(u.substr(0,f),t.substr(t.indexOf(".")+1,r)),c=h.indexOf(".");if(c>1){var I=parseInt(u.substr(f+1));a=(h=h.charAt(0)+"."+h.substr(1).replace(".","").substr(0,r))+"E"+((I+=c-1)>=0?"+":"-")+p(Math.abs(I),2)}else a=h.toString()+u.substr(f)}else a=n.toExponential(0);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(l,u);if(36===l.charCodeAt(0))return"$"+d(e,l.substr(" "==l.charAt(1)?2:1),u);var c=void 0,I=void 0,g=void 0,m=void 0,y=Math.abs(u),x=u<0?"-":"";if(l.match(/^00+$/)){var S=_(y,l.length);return S=B(S),/^0+$/.test(S)?S:x+S}if(l.match(/^[#?]+$/))return"0"===(c=_(u,0))&&(c=""),c.length>l.length?c:i(l.substr(0,l.length-c.length))+c;if(I=l.match(n))return function(e,t,n){var a=parseInt(e[4],10),r=new s.default(t).mul(a).round(),o=r.div(a).floor(),i=r.minus(o.mul(a)),l=a,d=0===i.toNumber()?v(" ",e[1].length+1+e[4].length):T(i.toString(),e[1].length)+e[2]+"/"+e[3]+p(l.toString(),e[4].length);return""===d.trim()&&0===o.toNumber()?n+"0 "+d:n+(0===o.toNumber()?"":""+B(o.toString()))+" "+d}(I,y,x);if(l.match(/^#+0+$/))return x+_(y,l.length-l.indexOf("0"));if(I=l.match(a))return-1!==(c=x+U(y,I[1]).replace(/^([^\.]+)$/,"$1."+i(I[1])).replace(/\.$/,"."+i(I[1])).replace(/\.(\d*)$/,function(e,t){return"."+t+v("0",i(I[1]).length-t.length)})).indexOf("e")||-1!==c.indexOf("E")&&parseFloat(c)>0?B(c):-1!==l.indexOf("0.")?c:c.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),I=l.match(/^(0*)\.(#*)$/))return x+U(y,I[2]).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,I[1].length?"0.":".");if(I=l.match(/^#{1,3},##0(\.?)$/)){var O=y.toString();return-1!==O.indexOf("e")||-1!==O.indexOf("E")?x+L(B(u=Math.abs(u))):x+L(_(y,0))}if(I=l.match(/^#,##0\.([#0?]*[0?])$/)){var C=u.toString();return-1!==C.indexOf("e")||-1!==C.indexOf("E")&&u>0?x+N(U(B(u=Math.abs(u)),I[1])):u<0?"-"+d(e,l,-u):N(U(u,I[1]))}if(I=l.match(/^#,#*,#0/))return d(e,l.replace(/^#,#*,/,""),u);if(I=l.match(/^([0#]+)(\\?-([0#]+))+$/))return c=R(d(e,l.replace(/[\\-]/g,""),u)),g=0,R(R(l.replace(/\\/g,"")).replace(/[0#]/g,function(e){return g<c.length?c.charAt(g++):"0"===e?"0":""}));if(l.match(o))return"("+(c=d(e,"##########",u)).substr(0,3)+") "+c.substr(3,3)+"-"+c.substr(6);var D="";if(I=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(I[4].length,7),m=M(y,Math.pow(10,g)-1,!1),c=""+x," "==(D=V("n",I[1],m[1])).charAt(D.length-1)&&(D=D.substr(0,D.length-1)+"0"),c+=D+I[2]+"/"+I[3],(D=E(m[2],g)).length<I[4].length&&(D=i(I[4].substr(I[4].length-D.length))+D),c+=D;if(I=l.match(/^([#0?]+)( ?)(\?+)\/( ?)([#0?]+)/))return g=Math.min(I[5].length,7),m=M(y,Math.pow(10,g)-1,!0),c="","0"!==(D=V("n",I[3],m[1])||"").trim()&&""!==D.trim()?(c+=I[2]+D+"/"+I[4],(D=E(m[2],g)).length<I[5].length&&(D=i(I[5].substr(I[5].length-D.length))+D),c+=D):c+=v(" ",l.length-I[1].length),D=V("n",I[1],m[0])||"",""===c.trim()?c=""===D.trim()?"0"+c:D+c:"0"!==D.trim()&&(c=D+c),c=""+x+c;if(I=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return g=Math.min(Math.max(I[1].length,I[4].length),7),x+(("0"!==(m=M(y,Math.pow(10,g)-1,!0))[0]?m[0]:"")||(m[1]?"":"0"))+" "+(m[1]?T(m[1],g)+I[2]+"/"+I[3]+E(m[2],g):v(" ",2*g+1+I[2].length+I[3].length));if(I=l.match(/^[#0?]+$/))return-1===(c=_(u,0)).indexOf("e")&&-1===c.indexOf("E")||(c=B(c)),l.length<=c.length?c:i(l.substr(0,l.length-c.length))+c;if(I=l.match(/^([#0?]+)\.([#0?]+)$/)){c=""+u.toFixed(Math.min(I[2].length,10)).replace(/([^0])0+$/,"$1"),g=c.indexOf(".");var w=l.indexOf(".")-g,A=l.length-c.length-w;return i(l.substr(0,w)+c+l.substr(l.length-A))}if(I=l.match(/^00,000\.([#0?]*0)$/))return g=function(e,t){var n=U(e,t);return n.substr(n.indexOf(".")+1)}(u,I[1]),u<0?"-"+d(e,l,-u):L(P(u)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?p(0,3-e.length):"")+e})+"."+p(g,I[1].length);if(I=l.match(/^(([0#?]{1,3},)?([0#?]{3},)*([0#?]{3})?)(\.|\.([0#?]+))?$/))return u<0?"-"+d(e,l,-u):function(e,t){for(var n=b(P(e)),a=b(t).replace(/,/g,""),r=0,o=0,i="",l=-1!==t.indexOf(",");r<n.length&&o<a.length;)","!==a[o]?(i+=n[r],r++,o++):(i+=",",o++);if(r<n.length)if(l)for(var d=Math.max(0,i.lastIndexOf(",")),s=i.length-d;r<n.length;r++)s%3===0&&(i+=","),i+=n[r],s++;else i+=n.substr(r);else if(o<a.length){if(l)for(var u=Math.max(0,i.lastIndexOf(",")),f=i.length-u;o<a.length;o++)f%3===0&&(i+=","),i+=a[o],f++;else i+=a.substr(o);i=i.replace(/#/g,"").replace(/\?/g," ")}return i=(i=b(i)).replace(/(\ +),/g,"$1")}(u,I[1])+U(u,I[6]).replace(/(\d*)\./,".");switch(l){case"###,##0.00":return d(e,"#,##0.00",u);case"###,###":case"##,###":case"#,###":var F=L(_(y,0));return"0"!==F?x+F:"";case"###,###.00":return d(e,"###,##0.00",u).replace(/^0\./,".");case"#,###.00":return d(e,"#,##0.00",u).replace(/^0\./,".")}return u+""}function u(t,l,d){if(40===t.charCodeAt(0)&&!l.match(r)){var s=/\) */.test(l),f=l.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return d>=0?u("n",f,d):"("+u("n",f,-d)+(s?")":"")}if(44===l.charCodeAt(l.length-1))return function(e,t,n){for(var a=t.length-1;44===t.charCodeAt(a-1);)--a;return V(e,t.substr(0,a),n/Math.pow(10,3*(t.length-a)))}(t,l,d);if(-1!==l.indexOf("%"))return function(t,n,a){var r=n.replace(e,""),o=n.length-r.length;return V(t,r,a*Math.pow(10,2*o))+v("%",o)}(t,l,d);if(-1!==l.indexOf("E"))return function e(t,n){var a=void 0,r=t.indexOf("E")-t.indexOf(".")-1,o=t.match(/^(#+0).0E\+0?$/);if(o){if(0==n)return v("0",o[1].length)+".0E+0";if(n<0)return"-"+e(t,-n);var i=t.indexOf(".");-1===i&&(i=t.indexOf("E"));var l=Math.floor(Math.log(n)*Math.LOG10E)%i;if(l<0&&(l+=i),!(a=(n/Math.pow(10,l)).toPrecision(r+1+(i+l)%i)).match(/[Ee]/)){var d=Math.floor(Math.log(n)*Math.LOG10E);-1===a.indexOf(".")?a=a.charAt(0)+"."+a.substr(1)+"E+"+(d-a.length+l):a+="E+"+(d-l),a=a.replace(/\+-/,"-")}a=a.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(e,t,n,a){return t+n+a.substr(0,(i+l)%i)+"."+a.substr(l)+"E"})}else a=-1===t.indexOf(".")?n.toExponential(0):G(n,r);return t.match(/E\+00$/)&&a.match(/e[+-]\d$/)&&(a=a.substr(0,a.length-1)+"0"+a.charAt(a.length-1)),t.match(/E\-/)&&a.match(/e\+/)&&(a=a.replace(/e\+/,"e")),a.replace("e","E")}(l,d);if(36===l.charCodeAt(0))return"$"+u(t,l.substr(" "==l.charAt(1)?2:1),d);var h=void 0,c=void 0,I=void 0,g=void 0,m=Math.abs(d),_=d<0?"-":"";if(l.match(/^00+$/)){var y=p(m,l.length);return y=B(y),/^0+$/.test(y)?y:_+y}if(l.match(/^[#?]+$/))return"0"===(h=""+d)&&(h=""),h.length>l.length?h:i(l.substr(0,l.length-h.length))+h;if(c=l.match(n))return function(e,t,n){return n+t+v(" ",e[1].length+2+e[4].length)}(c,m,_);if(l.match(/^#+0+$/))return _+p(m,l.length-l.indexOf("0"));if(c=l.match(a))return h=(h=(""+d).replace(/^([^\.]+)$/,"$1."+i(c[1])).replace(/\.$/,"."+i(c[1]))).replace(/\.(\d*)$/,function(e,t){return"."+t+v("0",i(c[1]).length-t.length)}),-1!==l.indexOf("0.")?h:h.replace(/^0\./,".");if(l=l.replace(/^#+([0.])/,"$1"),c=l.match(/^(0*)\.(#*)$/))return _+(""+m).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,c[1].length?"0.":".");if(c=l.match(/^#{1,3},##0(\.?)$/))return _+L(""+m);if(c=l.match(/^#,##0\.([#0]*0)$/))return d<0?"-"+u(t,l,-d):L(""+d)+"."+v("0",c[1].length);if(c=l.match(/^#,#*,#0/))return u(t,l.replace(/^#,#*,/,""),d);if(c=l.match(/^([0#]+)(\\?-([0#]+))+$/))return h=R(u(t,l.replace(/[\\-]/g,""),d)),I=0,R(R(l.replace(/\\/g,"")).replace(/[0#]/g,function(e){return I<h.length?h.charAt(I++):"0"===e?"0":""}));if(l.match(o))return"("+(h=u(t,"##########",d)).substr(0,3)+") "+h.substr(3,3)+"-"+h.substr(6);var x="";if(c=l.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return I=Math.min(c[4].length,7),g=M(m,Math.pow(10,I)-1,!1),h=""+_," "==(x=V("n",c[1],g[1])).charAt(x.length-1)&&(x=x.substr(0,x.length-1)+"0"),h+=x+c[2]+"/"+c[3],(x=E(g[2],I)).length<c[4].length&&(x=i(c[4].substr(c[4].length-x.length))+x),h+=x;if(c=l.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return I=Math.min(Math.max(c[1].length,c[4].length),7),_+(("0"!==(g=M(m,Math.pow(10,I)-1,!0))[0]?g[0]:"")||(g[1]?"":"0"))+" "+(g[1]?T(g[1],I)+c[2]+"/"+c[3]+E(g[2],I):v(" ",2*I+1+c[2].length+c[3].length));if(c=l.match(/^[#0?]+$/))return h=""+d,l.length<=h.length?h:i(l.substr(0,l.length-h.length))+h;if(c=l.match(/^([#0]+)\.([#0]+)$/)){h=""+d.toFixed(Math.min(c[2].length,10)).replace(/([^0])0+$/,"$1"),I=h.indexOf(".");var S=l.indexOf(".")-I,O=l.length-h.length-S;return i(l.substr(0,S)+h+l.substr(l.length-O))}if(c=l.match(/^00,000\.([#0]*0)$/))return d<0?"-"+u(t,l,-d):L(""+d).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(e){return"00,"+(e.length<3?p(0,3-e.length):"")+e})+"."+p(0,c[1].length);switch(l){case"###,###":case"##,###":case"#,###":var C=L(""+m);return"0"!==C?_+C:"";default:if(l.match(/\.[0#?]*$/))return u(t,l.slice(0,l.lastIndexOf(".")),d)+i(l.slice(l.lastIndexOf(".")))}return d+""}return function(e,t,n){var a=n;return(0,l.isNumeric)(n)&&(0!==(a=parseFloat(n.toString()))||"0"===n.toString()||/0+[Ee]0+/.test(n.toString())||/0+(\.0+)?/.test(n.toString()))?a===1/0||a===-1/0?n.toString():(0|a)===a?u(e,t,a):d(e,t,a):n.toString()}}();var H=/\[[HhMmSs]*\]/;function W(e){for(var t=0,n="",a="";t<e.length;)switch(n=e.charAt(t)){case"G":y(e,t)&&(t+=6),t++;break;case'"':for(var r=!1;t+1<e.length;)if(34===e.charCodeAt(++t)){r=!0;break}if(!r)return!1;++t;break;case"\\":case"_":t+=2;break;case"@":++t;break;case"B":case"b":if("1"===e.charAt(t+1)||"2"===e.charAt(t+1))return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":if("A/P"===e.substr(t,3).toUpperCase())return!0;if("AM/PM"===e.substr(t,5).toUpperCase())return!0;if("aaaa"===e.substr(t,4).toLowerCase())return!0;if("aaa"===e.substr(t,3).toLowerCase())return!0;++t;break;case"\u4e0a":if("\u4e0a\u5348/\u4e0b\u5348"===e.substr(t,5).toUpperCase())return!0;++t;break;case"[":for(a=n;"]"!==e.charAt(t++)&&t<e.length;)a+=e.charAt(t);if(a.match(H))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||"\\"==n&&"-"==e.charAt(t+1)&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t," "!=e.charAt(t)&&"*"!=e.charAt(t)||++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":default:++t}return!1}function z(e,t,n,a){for(var r=Array(),o="",i=0,d="",s="t",u=null,f=void 0,h=void 0,c=void 0,I="H";i<e.length;)switch(d=e.charAt(i)){case"G":if(!y(e,i))throw new Error("unrecognized character "+d+" in "+e);r[r.length]={t:"G",v:"General"},i+=7;break;case'"':for(o="";34!==(h=e.charCodeAt(++i))&&i<e.length;)o+=String.fromCharCode(h);r[r.length]={t:"t",v:o},++i;break;case"\\":var g=e.charAt(++i),R="("===g||")"===g?g:"t";r[r.length]={t:R,v:g},++i;break;case"_":r[r.length]={t:"t",v:" "},i+=2;break;case"@":r[r.length]={t:"T",v:t},++i;break;case"B":case"b":if("1"===e.charAt(i+1)||"2"===e.charAt(i+1)){if(null===u&&null==(u=w(t,n,"2"===e.charAt(i+1))))return[x,null];r[r.length]={t:"X",v:e.substr(i,2)},s=d,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":d=d.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0)return[x,null];if(null==u&&null==(u=w(t,n)))return[x,null];for(o=d;++i<e.length&&e.charAt(i).toLowerCase()===d;)o+=d;"m"===d&&"h"===s.toLowerCase()&&o.length<=2&&(d="M"),"m"===d&&"s"===s.toLowerCase()&&o.length<=2&&(d="M"),"h"===d&&(d=I),r[r.length]={t:d,v:o},s=d;break;case"A":case"a":if(c={t:d,v:d},null==u&&null==(u=w(t,n)))return[x,null];"A/P"===e.substr(i,3).toUpperCase()?(null!=u&&(c.v=u.H>=12?"P":"A"),c.t="T",I="h",i+=3):"AM/PM"===e.substr(i,5).toUpperCase()?(null!=u&&(c.v=u.H>=12?"PM":"AM"),c.t="T",i+=5,I="h"):"aaaa"===e.substr(i,4)?null!=u&&(c.t="a",c.v="aaaa",i+=4):"aaa"===e.substr(i,3)?null!=u&&(c.t="a",c.v="aaa",i+=3):(c.t="t",++i),r[r.length]=c,s=d;break;case"\u4e0a":if(c={t:d,v:d},null===u&&null===(u=w(t,n)))return[x,null];"\u4e0a\u5348/\u4e0b\u5348"===e.substr(i,5).toUpperCase()?(null!=u&&(c.v=u.H>=12?"\u4e0b\u5348":"\u4e0a\u5348"),c.t="T",i+=5,I="h"):(c.t="t",++i),r[r.length]=c,s=d;break;case"[":for(o=d;"]"!==e.charAt(i++)&&i<e.length;)o+=e.charAt(i);if("]"!==o.slice(-1))throw'unterminated "[" block: |'+o+"|";if(o.match(H)){if(null==u&&null==(u=w(t,n)))return[x,null];r[r.length]={t:"Z",v:o.toLowerCase()},s=o.charAt(1)}else{if("[$-f800]"===o.toLowerCase()){e=e.substr(0,i)+'yyyy"\u5e74"m"\u6708"d"\u65e5" aaaa';break}if("[$-f400]"===o.toLowerCase()){e=e.substr(0,i)+"\u4e0a\u5348/\u4e0b\u5348 h:mm:ss";break}if(o.indexOf("$")>-1){if(o=(o.match(/\$([^-\[\]]*)/)||[])[1]||"$",/\[\$\-\d+\].*a{3,4}/.test(e))break;W(e)||(r[r.length]={t:"t",v:o})}else if(o.match(/DBNum\d+/)){var v="";if(r[r.length]={t:"DN",v:o},i<e.length&&"["===e.charAt(i++)){for(;"]"!==e.charAt(i++)&&i<e.length;)v+=e.charAt(i);if("]"!==v.slice(-1))throw'unterminated "[" block: |'+v+"|"}}else ue(o)&&(r[r.length]={t:"Color",v:fe(o)})}break;case".":if(null!=u){for(o=d;++i<e.length&&"0"===(d=e.charAt(i));)o+=d;r[r.length]={t:"s",v:o};break}case"0":case"#":for(o=d;++i<e.length&&"0#?.,E+-%".indexOf(d=e.charAt(i))>-1||"\\"==d&&"-"==e.charAt(i+1)&&i<e.length-2&&"0#".indexOf(e.charAt(i+2))>-1;)o+=d;r[r.length]={t:"n",v:o};break;case"?":for(o=d;e.charAt(++i)===d;)o+=d;r[r.length]={t:d,v:o},s=d;break;case"*":i+=2;break;case"(":case")":r[r.length]={t:1===a?"t":d,v:d},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(o=d;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)o+=e.charAt(i);r[r.length]={t:"D",v:o};break;case" ":r[r.length]={t:d,v:d},++i;break;case"%":r[r.length]={t:"n",v:d},++i;break;default:if(-1===",$-+/():!^&'~{}<>=\u20acacfijklopqrtuvwxzP".indexOf(d))return t;r[r.length]={t:"t",v:d},++i}var p=0,T=0,E=void 0;for(i=r.length-1,s="t";i>=0;--i)switch(r[i].t){case"h":case"H":r[i].t=I,s="h",p<1&&(p=1);break;case"s":(E=r[i].v.match(/\.0+$/))&&(T=Math.max(T,E[0].length-1)),p<3&&(p=3);case"d":case"y":case"M":case"e":s=r[i].t;break;case"m":"s"===s&&r[i].v.length<=2&&(r[i].t="M",p<2&&(p=2));break;case"X":break;case"Z":p<1&&r[i].v.match(/[Hh]/)&&(p=1),p<2&&r[i].v.match(/[Mm]/)&&(p=2),p<3&&r[i].v.match(/[Ss]/)&&(p=3)}var m="",_=void 0,S="0",O=void 0,C=!1;for(i=0;i<r.length;++i)switch(r[i].t){case"t":case"T":case" ":case"D":break;case"X":r[i].v="",r[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":case"a":r[i].v=k(r[i].t.charCodeAt(0),r[i].v,u,T),r[i].t="t";break;case"n":case"(":case"?":if(_=i+1,"n"===r[i].t&&"%"===r[i].v){m+=r[i].v,r[i].t="t",C=!0,i=_-1;break}for(;null!=r[_]&&("?"===(d=r[_].t)||"D"===d||(" "===d||"t"===d)&&null!=r[_+1]&&("?"===r[_+1].t||"t"===r[_+1].t&&"/"===r[_+1].v)||"("===r[i].t&&(" "===d||"n"===d||")"===d)||"t"===d&&("/"===r[_].v||" "===r[_].v&&null!=r[_+1]&&"?"==r[_+1].t));)r[i].v+=r[_].v,r[_]={v:"",t:";"},++_;if("("===r[i].t&&"("===r[i].v&&null!=r[_]&&"n"!==r[_]){i=_-1;break}m+=r[i].v,i=_-1;break;case"G":r[i].t="t",r[i].v=S?t:F(t);break;case"DN":S=r[i].v.replace(/\[DBNum(\d)\]/,"$1");break;case"Color":O=r[i].v,r[i].t="t",r[i].v=""}var D="",M=void 0,A=void 0;if(m.length>0){40==m.charCodeAt(0)?(M=t<0&&45===m.charCodeAt(0)?-t:t,A=V("(",m,M)):(A=V("n",m,M=t<0&&a>1?-t:t),M<0&&r[0]&&"t"==r[0].t&&(A=A.substr(1),r[0].v="-"+r[0].v)),C&&A&&A.endsWith("%")&&(A=A.substr(0,A.length-1)),_=A.length-1;var L=r.length;for(i=0;i<r.length;++i)if(null!=r[i]&&"t"!=r[i].t&&r[i].v&&r[i].v.indexOf(".")>-1){L=i;break}var N=r.length;if(L===r.length&&-1===A.indexOf("E")){for(i=r.length-1;i>=0;--i)null!=r[i]&&-1!=="n?(".indexOf(r[i].t)&&("("!==r[i].t||"("!==r[i].v?(_>=r[i].v.length-1?(_-=r[i].v.length,r[i].v=A.substr(_+1,r[i].v.length)):_<0?"("!==r[i].t&&(r[i].v=""):(r[i].v=A.substr(0,_+1),_=-1),r[i].t="t",N=i):r[i].t="t");_>=0&&N<r.length&&(r[N].v=A.substr(0,_+1)+r[N].v)}else if(L!==r.length&&-1===A.indexOf("E")&&(_=A.indexOf(".")-1)>=0){for(i=L;i>=0;--i)if(null!=r[i]&&-1!=="n?(".indexOf(r[i].t)){if(f=r[i].v.indexOf(".")>-1&&i===L?r[i].v.indexOf(".")-1:r[i].v.length-1,""!==(D=r[i].v.substr(f+1)))for(;f>=0&&_>=0;--f,--_)"0"===r[i].v.charAt(f)||"#"===r[i].v.charAt(f)||"?"===r[i].v.charAt(f)?D=A.charAt(_)+D:r[i].v.charAt(f)===A.charAt(_)?D=A.charAt(_)+D:_++;"("===r[i].t&&"("===r[i].v?r[i].t="t":(r[i].v=D,r[i].t="t",N=i)}for(_>=0&&N<r.length&&(r[N].v=A.substr(0,_+1)+r[N].v),_=A.indexOf(".")+1,i=L;i<r.length;++i)if(null!=r[i]&&(-1!=="n?(".indexOf(r[i].t)||i===L)){for(f=r[i].v.indexOf(".")>-1&&i===L?r[i].v.indexOf(".")+1:0,D=r[i].v.substr(0,f);f<r[i].v.length;++f)if(_<A.length){var b=A.charAt(_);if("0"!==r[i].v.charAt(f)&&"#"!==r[i].v.charAt(f)&&"?"!==r[i].v.charAt(f)){D+=r[i].v.charAt(f),_++;break}D+=b,_++}r[i].v=D,r[i].t="t",N=i}}}for("0"!==S&&r.length>=2&&"DN"===r[0].t&&(r=r.filter(function(e,t){if("t"===e.t&&(0,l.isNumeric)(e.v)){var n=void 0;return t+1<r.length&&("\u5e74"==r[t+1].v?n={unit:!1,fill:!0}:"\u6708"==r[t+1].v||"\u65e5"==r[t+1].v?n={unit:!0,fill:!0,showTenOne:!1}:"\u5206"==r[t+1].v?n={unit:!0,fill:!0}:"\u65f6"==r[t+1].v&&(n={unit:!0,fill:!1})),n=n||{unit:!0,fill:!1},e.v=function(e,t,n){var a=void 0,r=void 0,o=void 0;if("1"===t)a=new Array("\u3007","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d","\u4e03","\u516b","\u4e5d"),r=new Array("","\u5341","\u767e","\u5343"),o=new Array("","\u4e07","\u4ebf","\u5146");else{if("2"!==t)return""+e;a=new Array("\u96f6","\u58f9","\u8d30","\u53c1","\u8086","\u4f0d","\u9646","\u67d2","\u634c","\u7396"),r=new Array("","\u62fe","\u4f70","\u4edf"),o=new Array("","\u4e07","\u4ebf","\u5146")}var i=void 0,l=void 0,d="",s=void 0;if(""==e)return"";var u=e.length,f=parseFloat(e);if(f>=1e15)return e;if(e=f.toString(),u>e.length&&n&&n.fill)for(var h=u-e.length;h-- >0;)d+=a[0];if(0==f)return d+=a[0];f<0&&(d+="-",e=e.substr(1));-1===e.indexOf(".")?i=e:(s=e.split("."),i=s[0],l=s[1]);if(parseInt(i,10)>0)for(var c=0,I=i.length,g=0;g<I;g++){var R=i.substr(g,1),v=I-g-1,p=v/4,T=v%4;"0"==R?n&&!n.unit?d+=a[parseInt(R)]:c++:(c>0&&(d+=a[0]),c=0,(0!==g||"1"!==R||1!==T||n&&n.showTenOne)&&(d+=a[parseInt(R)]),n&&n.unit&&(d+=r[T])),0==T&&c<4&&n&&n.unit&&(d+=o[p])}else d+=a[0];if(l&&""!==l&&0!==Number(l)){var E=l.length;E>0&&(d+=".");for(var m=0;m<E;m++){var _=l.substr(m,1);d+=a[Number(_)]}}""==d&&(d+=a[0]);return d}(e.v,S,n),!0}return"DN"!==e.t})),i=0;i<r.length;++i)null!=r[i]&&"n?".indexOf(r[i].t)>-1&&(M=a>1&&t<0&&i>0&&"-"===r[i-1].v?-t:t,r[i].v=V(r[i].t,r[i].v,M),r[i].t="t");var P="";for(i=0;i!==r.length;++i)null!=r[i]&&(P+=r[i].v);return[P,O]}var Y=/\[[=<>]/,j=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function K(e,t){if(null==t)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0}return!1}function $(e,t){var n=["General"];try{n=function(e){var t=[],n=!1,a=void 0,r=void 0;for(a=0,r=0;a<e.length;++a)switch(e.charCodeAt(a)){case 34:n=!n;break;case 95:case 92:case 42:n||++a;break;case 59:n||(t[t.length]=e.substr(r,a-r),r=a+1)}if(t[t.length]=e.substr(r),!0===n)throw new Error("Format |"+e+"| unterminated string ");return t}(e)}catch(d){I.default.report.run(I.default.config.report.CONFIG.CHOOSE_FORMAT_ERROR,[e,t],d),n=["General"]}var a=n.length,r=n[a-1].indexOf("@");switch(a<4&&r>-1&&--a,n.length){case 1:n=r>-1?[n[0],n[0],n[0],n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=r>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=r>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"]}var o=t>0?n[0]:t<0?n[1]:n[2];if(isNaN(t))return{length:a,fmt:o=n[3]};if(-1===n[0].indexOf("[")&&-1===n[1].indexOf("["))return{length:a,fmt:o};if(null!=n[0].match(Y)||null!=n[1].match(Y)){var i=n[0].match(j),l=n[1].match(j);return K(t,i)?{length:a,fmt:n[0]}:K(t,l)?{length:a,fmt:n[1]}:{length:a,fmt:n[null!=i&&null!=l?2:1]}}return{length:a,fmt:o}}function Q(e,t,n){if(null==n&&(n={}),y(e,0))return[F(t),void 0];var a=$(e,t);return y(a.fmt)?[F(t),void 0]:""===t||null==t||"string"===typeof t&&""===t.trim()?["",void 0]:"string"!==typeof t||function(e){var t=!0;if((0,l.isNumeric)(e)){var n=parseFloat(e);(0!==n||"0"===e.toString()||/0+[Ee]0+/.test(e)||/0+(\.0+)?/.test(e))&&n!==1/0&&n!==-1/0||(t=!1)}return t}(t)?z(a.fmt,t,n,a.length):[t,void 0]}function Z(e){var t=D.get(e);return t||D.get(0)}function X(e){if(void 0===e)return 0;for(var t=(0,o.default)(D),n=t.length,a=164,r=0;r<n;r++){var i=parseInt(t[r],10);if(D.get(i)===e)return i;i>a&&i<65535&&(a=i)}return e?(D.set(a+1,e),a+1):0}function q(e){return e=ae[e||"General"]||e||"General",new d.default({pattern:e})}function J(){return{id:0,type:u.default.GENERAL,pattern:"General"}}function ee(e){var t=void 0,n=void 0;return e&&(t=e.id,n=e.pattern),void 0===t&&(t=0),n&&/reserved-.+/g.test(n)&&(n=void 0),n&&(n=ae[n]||n||"General"),14===t&&(n="yyyy/m/d"),n||(n=Z(t)),n}function te(e,t,n){var a=ee(t),r=Q(a,e,n);return{formatCode:a,value:r[0],color:r[1]?r[1]:null}}function ne(e,t,n){try{if(t=t||J(),null===e||null==e.value||""===e.value.toString())return{type:c.default.NORMAL,value:""};if(e.type===f.default.STRING)return{type:c.default.NORMAL,value:e.value};if(e.type===f.default.BOOL){var a=e.value?"TRUE":"FALSE";return{type:c.default.NORMAL,value:a}}var r=te(e.value,t,n);return{type:c.default.NORMAL,value:r.value,textColor:r.color}}catch(o){return I.default.report.run(I.default.config.report.CONFIG.PARSE_FORMAT_ERROR,[t,e,n],o),{type:c.default.NORMAL,value:String(e.value),textColor:null}}}var ae={default:"General",auto:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00",currency:"#,##0.00","currency-chs":'"\xa5"#,##0.00_);[Red]\\("\xa5"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss",date:"yyyy/m/d",accounting:'_ * #,##0.00_ ;_ * -#,##0.00_ ;_ * "-"??_ ;_ @_',"date-chs":'yyyy"\u5e74"m"\u6708"d"\u65e5";@',"date-chs-ym":'yyyy"\u5e74"m"\u6708";@',"date-chs-md":'m"\u6708"d"\u65e5";@',fraction:"# ?/?"};(function(){var e=navigator.userAgent,t=!e.match(/(iPad).*OS\s([\d_]+)/)&&e.match(/(iPhone\sOS)\s([\d_]+)/),n=e.match(/(Android)\s+([\d.]+)/);return!(!t&&!n)})()&&(t.txSheetToMsoFormatMapping=ae={auto:"General",default:"General",text:"@",numeral:"#,##0.00_ ",percentage:"0.00%","percentage-int":"0%",exponential:"0.00E+00","currency-chs":'"\xa5"#,##0.00_);[Red]\\("\xa5"#,##0.00\\)',"currency-hk":"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)","currency-en":"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)",time:"h:mm:ss;@","date-time":"yyyy/m/d h:mm:ss;@",date:"yyyy/m/d","date-chs":'yyyy"\u5e74"m"\u6708"d"\u65e5";@',"date-chs-ym":'yyyy"\u5e74"m"\u6708";@',"date-chs-md":'m"\u6708"d"\u65e5";@',fraction:"# ?/?",m_d_yy:"m/d/yy;@","mmm-yy":"[$-409]mmm-yy;@",m_d:"m/d;@","yyyy-mm-dd":"yyyy-mm-dd;@",yyyy_mm_dd:"yyyy/mm/dd;@","yyyy_m_d-h-m":"yyyy/m/d h:mm;@","h-mm":"h:mm;@",yy_m_d:"yy/m/d;@","h-mm-ss-am_pm":"[$-409]h:mm:ss\\ AM/PM;@"});var re=[{type:u.default.GENERAL,name:"\u5e38\u89c4"},{type:u.default.TEXT,name:"\u6587\u672c"},{type:u.default.NUMBER,name:"\u6570\u503c"},{type:u.default.PERCENT,name:"\u767e\u5206\u6bd4"},{type:u.default.SCIENTIFIC,name:"\u79d1\u5b66\u8bb0\u6570"},{type:u.default.CURRENCY,name:"\u8d27\u5e01"},{type:u.default.TIME,name:"\u65f6\u95f4"},{type:u.default.DATE,name:"\u65e5\u671f"},{type:u.default.DATE_TIME,name:"\u65e5\u671f"},{type:u.default.ACCOUNTING,name:"\u4f1a\u8ba1\u4e13\u7528"},{type:u.default.FRACTION,name:"\u5206\u6570"},{type:u.default.SPECIAL,name:"\u7279\u6b8a"},{type:u.default.CUSTOM,name:"\u81ea\u5b9a\u4e49"}];function oe(e){if(e)for(var t=0;t<re.length;t++)if(re[t].type===e)return re[t].name;return"\u5e38\u89c4"}var ie,le=t.format2TypeMapping=(ie=ae,(0,o.default)(ie).reduce(function(e,t){return e[ie[t]]=t,e},{}));t.msoFormatToTxSheetMapping={Standard:"#,##0.00",Scientific:"0.00E+00",Percent:"0.00%","Short Date":"yyyy/m/d","Long Date":'yyyy"\u5e74"m"\u6708"d"\u65e5"',"General Date":"yyyy/m/d hh:mm","Medium Date":"d-mmm-yy","Long Time":"h:mm:ss AM/PM","Medium Time":"h:mm AM/PM","Short Time":"hh:mm",'AM/PMh"\u65f6"mm"\u5206"':'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"','AM/PMh"\u65f6"mm"\u5206"ss"\u79d2"':'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',Fixed:"#,##0.00_ ;@"};function de(e,t,n){var a=[];return e&&(a=e.split(";").map(function(e,a){return 2===a&&-1!==e.indexOf("?")?e:function(e,t,n){var a="";return e.split('"').forEach(function(e,r){r%2===0&&(e=e.replace(t,n)),r>0&&(e='"'+e),a+=e}),a}(e,t,n)})),a.join(";")}var se={Black:"#000000",Blue:"#0000FF",Cyan:"#00FFFF",Green:"#008000",Magenta:"#FF00FF",Red:"#FF0000",White:"#FFFFFF",Yellow:"#FFFF00","\u9ed1\u8272":"#000000","\u84dd\u8272":"#0000FF","\u84dd\u7eff\u8272":"#00FFFF","\u7eff\u8272":"#008000","\u6d0b\u7ea2\u8272":"#FF00FF","\u7ea2\u8272":"#FF0000","\u767d\u8272":"#FFFFFF","\u9ec4\u8272":"#FFFF00","\u989c\u82720":"#00000000","\u989c\u82721":"#00FFFFFF","\u989c\u82722":"#00FF0000","\u989c\u82723":"#0000FF00","\u989c\u82724":"#000000FF","\u989c\u82725":"#00FFFF00","\u989c\u82726":"#00FF00FF","\u989c\u82727":"#0000FFFF","\u989c\u82728":"#00000000","\u989c\u82729":"#00FFFFFF","\u989c\u827210":"#00FF0000","\u989c\u827211":"#0000FF00","\u989c\u827212":"#000000FF","\u989c\u827213":"#00FFFF00","\u989c\u827214":"#00FF00FF","\u989c\u827215":"#0000FFFF","\u989c\u827216":"#00800000","\u989c\u827217":"#00008000","\u989c\u827218":"#00000080","\u989c\u827219":"#00808000","\u989c\u827220":"#00800080","\u989c\u827221":"#00008080","\u989c\u827222":"#00C0C0C0","\u989c\u827223":"#00808080","\u989c\u827224":"#009999FF","\u989c\u827225":"#00993366","\u989c\u827226":"#00FFFFCC","\u989c\u827227":"#00CCFFFF","\u989c\u827228":"#00660066","\u989c\u827229":"#00FF8080","\u989c\u827230":"#000066CC","\u989c\u827231":"#00CCCCFF","\u989c\u827232":"#00000080","\u989c\u827233":"#00FF00FF","\u989c\u827234":"#00FFFF00","\u989c\u827235":"#0000FFFF","\u989c\u827236":"#00800080","\u989c\u827237":"#00800000","\u989c\u827238":"#00008080","\u989c\u827239":"#000000FF","\u989c\u827240":"#0000CCFF","\u989c\u827241":"#00CCFFFF","\u989c\u827242":"#00CCFFCC","\u989c\u827243":"#00FFFF99","\u989c\u827244":"#0099CCFF","\u989c\u827245":"#00FF99CC","\u989c\u827246":"#00CC99FF","\u989c\u827247":"#00FFCC99","\u989c\u827248":"#003366FF","\u989c\u827249":"#0033CCCC","\u989c\u827250":"#0099CC00","\u989c\u827251":"#00FFCC00","\u989c\u827252":"#00FF9900","\u989c\u827253":"#00FF6600","\u989c\u827254":"#00666699","\u989c\u827255":"#00969696","\u989c\u827256":"#00003366","\u989c\u827257":"#00339966","\u989c\u827258":"#00003300","\u989c\u827259":"#00333300","\u989c\u827260":"#00993300","\u989c\u827261":"#00993366","\u989c\u827262":"#00333399","\u989c\u827263":"#00333333",Color0:"#00000000",Color1:"#00FFFFFF",Color2:"#00FF0000",Color3:"#0000FF00",Color4:"#000000FF",Color5:"#00FFFF00",Color6:"#00FF00FF",Color7:"#0000FFFF",Color8:"#00000000",Color9:"#00FFFFFF",Color10:"#00FF0000",Color11:"#0000FF00",Color12:"#000000FF",Color13:"#00FFFF00",Color14:"#00FF00FF",Color15:"#0000FFFF",Color16:"#00800000",Color17:"#00008000",Color18:"#00000080",Color19:"#00808000",Color20:"#00800080",Color21:"#00008080",Color22:"#00C0C0C0",Color23:"#00808080",Color24:"#009999FF",Color25:"#00993366",Color26:"#00FFFFCC",Color27:"#00CCFFFF",Color28:"#00660066",Color29:"#00FF8080",Color30:"#000066CC",Color31:"#00CCCCFF",Color32:"#00000080",Color33:"#00FF00FF",Color34:"#00FFFF00",Color35:"#0000FFFF",Color36:"#00800080",Color37:"#00800000",Color38:"#00008080",Color39:"#000000FF",Color40:"#0000CCFF",Color41:"#00CCFFFF",Color42:"#00CCFFCC",Color43:"#00FFFF99",Color44:"#0099CCFF",Color45:"#00FF99CC",Color46:"#00CC99FF",Color47:"#00FFCC99",Color48:"#003366FF",Color49:"#0033CCCC",Color50:"#0099CC00",Color51:"#00FFCC00",Color52:"#00FF9900",Color53:"#00FF6600",Color54:"#00666699",Color55:"#00969696",Color56:"#00003366",Color57:"#00339966",Color58:"#00003300",Color59:"#00333300",Color60:"#00993300",Color61:"#00993366",Color62:"#00333399",Color63:"#00333333"};function ue(e){var t=e.match(/\[(.+)\]/),n=void 0;if(!t)return!1;n=t[1];for(var a=(0,o.default)(se),r=0;r<a.length;r++)if(a[r]===n)return!0;return!1}function fe(e){var t=e.match(/\[(.+)\]/),n=void 0;return t?(n=t[1],se[n]):null}function he(e,t){if(De(t))return t;if("General"!==t&&t){var n=de(t,/((\]|^)[^\[]*)([0#,.?]+)(E\+[0#,.?]+)?/g,function(e){return e=-1!==e.indexOf("E+")?-1===e.indexOf(".")?e.replace(/([0#?]+)(?=E\+)/g,"$1.0"):e.replace(/(\.[0#?]+)E/g,"$10E"):-1===e.indexOf(".")?e.replace(/([0#,?]+)/g,"$1.0"):e.replace(/(\.[0#?]+)/g,"$10")});Ie(n)<=127&&(t=n)}else if(""===e||null===e||void 0===e||isNaN(e))t="General";else{var a=e.toString().match(/^[-]?(\d+)(.(\d+))?([e|E][-+]\d+)?$/),r=a&&void 0!==a[3]?a[3].length:0,o=a?a[1].length:1;o>=12?t="0.000000E+00":(r=Math.min(10-o,r),t=0===(r=Math.max(0,r))?"0.0_ ":"0."+v("0",r+1)+"_ ")}return t&&0!==t.length||(t="General"),t}function ce(e,t){if(De(t))return t;if("General"!==t&&t){var n=function(e){return e=-1===e.indexOf(".")?e:e.indexOf(".")>=e.length-2?e.slice(0,e.indexOf(".")):/(\.[0#?])(?![0#?])/g.test(e)?e.replace(/(\.[0#?])([^0#?]*)/g,"$2"):e.replace(/(\.[0#?]+?)/g,".")};t=de(t,/((\]|^)[^\[]*)([0#,.?]+)(E\+[0#,.?]+)?/g,function(e){return""===(e=-1!==e.indexOf("E+")?-1===e.indexOf(".")?e:e.replace(new RegExp("\\.[0#?]*","g"),n):n(e))&&(e="#"),e})}else if(""===e||null===e||void 0===e||isNaN(e))t="General";else{var a=e.toString().match(/^[-]?(\d+)(.(\d+))?([e|E][-+]\d+)?$/),r=a&&void 0!==a[3]?a[3].length:0,o=a?a[1].length:1;o>=12?t="0.0000E+00":(r=Math.min(10-o,r),t=(r=Math.max(0,r))<=1?"0_ ":"0."+v("0",r-1)+"_ ")}return t&&0!==t.length||(t="General"),t}function Ie(e){var t=(e=e||"").split(";")[0],n=(t=(t=Se(t)).toUpperCase()).indexOf("E"),a=0;-1!==n&&(t=t.substr(0,n));var r=t.match(/([0#?,]*)[.]([0#?]+)?/);return r&&(a=r[2]?r[2].length:a),a}function ge(e){var t,n=u.default.GENERAL,a=u.default.GENERAL,r=void 0,o=void 0;if("@"===e||-1===e.indexOf(";")&&-1!==e.indexOf("@"))n=u.default.TEXT,a=u.default.TEXT;else if("General"===e)n=u.default.GENERAL,a=u.default.GENERAL;else if(o=function(e){var t=Se(e);if(/[0#?]+(\.[0#?]?)?[Ee][+-]?[0#?]+/.test(t))return!0;return!1}(e))n=u.default.SCIENTIFIC,a="exponential";else if(o=function(e){var t=Se(e);if(/%/.test(t))return!0;return!1}(e))n=u.default.PERCENT,a="percentage";else if(o=function(e){l.supportCurrentCurrencyList.sort(function(e,t){return t.symbol.length-e.symbol.length});var t=Se(e,!0),n=t.match(/\[\$(.+)-(.+)\]/);if(n){if(Oe(t.replace(/(\[\$.+-.+\])/,"")))for(var a=n[1],r=(n[2],0);r<l.supportCurrentCurrencyList.length;r++)if(a===l.supportCurrentCurrencyList[r].symbol)return l.supportCurrentCurrencyList[r].type}else{t=t.replace(/\[.*\]/,"");for(var o=0;o<l.supportCurrentCurrencyList.length;o++)if(-1!==t.indexOf(l.supportCurrentCurrencyList[o].symbol)||-1!==e.indexOf('"'+l.supportCurrentCurrencyList[o].symbol+'"'))return l.supportCurrentCurrencyList[o].type}}(e))n=u.default.CURRENCY,a=o;else if(o=De(e))n=u.default.FRACTION,a=u.default.FRACTION;else if(o=Ce(e)){n=a=function(e){var t=0;e&&(e.year&&(t|=ve),e.month&&(t|=pe),e.day&&(t|=Te),e.hour&&(t|=Ee),e.minute&&(t|=me),e.second&&(t|=_e),e.week&&(t|=ye));for(var n=0;n<xe.length;n++)if(xe[n].key===t)return xe[n].type}(o)||u.default.DATE,(a=le[e])||(a=u.default.CUSTOM),r=o}else(o="000000"===(t=e)||"[DBNum1][$-804]General"===t||"[DBNum2][$-804]General"===t)?(n=u.default.SPECIAL,a=u.default.SPECIAL):(o=Oe(e))?(n=u.default.NUMBER,a="numeral"):e&&"General"!==e?(n=u.default.CUSTOM,a=u.default.CUSTOM):(n=u.default.GENERAL,a=u.default.GENERAL);return{group:n,type:a,extraInfo:r}}function Re(e){if(null===e||void 0===e)return{group:u.default.GENERAL,type:u.default.GENERAL};var t=void 0;"string"===typeof e?t=e:(void 0===e&&(e=J()),t=ee(e));var n=h.default.get(t);if(n)return n;var a=t.split(";");if(a.length>4)n={group:u.default.CUSTOM,type:u.default.CUSTOM};else if(n=function(e){if(/^#,##0(\.0+)?;\[Red\]-#,##0(\.0+)?$/.test(e)||/^#,##0(\.0+)?;\[\u7ea2\u8272\]-#,##0(\.0+)?$/.test(e)||/^#,##0(\.0+)?$/.test(e))return{group:u.default.CURRENCY,type:u.default.CURRENCY}}(t));else{var r=!1,o=a[a.length-1];o=Se(o),2===a.length&&"@"===a[1]?(a=[])[0]=t:"@"===o&&(a=a.slice(0,a.length-1),r=!0);for(var i=a.map(function(e){return ge(e)}),l=void 0,d=void 0,s=!1,f=i.length-1;f>=0;f--)if(d){if(d!==i[f].type){s=!0;break}}else l=i[f].group,d=i[f].type;l=l||(r?u.default.TEXT:u.default.GENERAL),d=d||(r?u.default.TEXT:u.default.GENERAL),n=s?{group:u.default.CUSTOM,type:u.default.CUSTOM}:{group:l,type:d}}return h.default.put(t,n),n}var ve=64,pe=32,Te=16,Ee=8,me=4,_e=2,ye=1,xe=[{key:ve|pe|Te,type:u.default.DATE},{key:ve|pe,type:u.default.DATE},{key:pe|Te,type:u.default.DATE},{key:ve|Te,type:u.default.DATE},{key:ve,type:u.default.DATE},{key:pe,type:u.default.DATE},{key:Te,type:u.default.DATE},{key:ve|pe|Te|Ee|me,type:u.default.DATE_TIME},{key:ve|pe|Te|Ee|me|_e,type:u.default.DATE_TIME},{key:Ee|me|_e,type:u.default.TIME},{key:Ee|me,type:u.default.TIME},{key:me|_e,type:u.default.TIME},{key:Ee|_e,type:u.default.TIME},{key:Ee,type:u.default.TIME},{key:_e,type:u.default.TIME},{key:me,type:u.default.TIME}];function Se(e,t){if(!e)return"";var n=0;"string"===typeof e&&(e=e.split("").map(function(e){return'"'==e?(n++,""):n%2===1?"":e}).join(""));for(var a=(0,o.default)(se),r=0;r<a.length;r++)e=e.replace("["+a[r]+"]","");if(t)return e;for(var i="",l=0;l<e.length;++l){switch(e.charCodeAt(l)){case 95:case 92:case 42:l++;break;default:i+=e.charAt(l)}}return i||""}function Oe(e){var t=Se(e);return"_ * #,##0.00_ "!==e&&'_ * "-"??_ '!==e&&"_ * -#,##0.00_ "!==e&&"_ @_\xa0"!==e&&!(!/^[-]?[0#?,]+(\.[0#?]+)?$/.test(t)&&!/^\([0#?,]+(\.[0#?]+)?\)$/.test(t))}function Ce(e){var t=Se(e);t=t.replace(/\[.*\]/,"");var n={year:!1,month:!1,day:!1,hour:!1,minute:!1,second:!1,week:!1},a=!1;if(/[y|Y]/.test(t)&&(n.year=!0,a=!0),/[mM]/.test(t)){var r=t.replace(/[\s:]/g,"");r=(r=r.replace(/AM|PM|am|PM/g,"")).replace(/m+/g,"m"),/[^hHsS][mM][^hHsS]|[^hHsS][mM]$|^[mM][^hHsS]|^[mM]$/.test(r)&&(n.month=!0,a=!0)}if(/[d|D]/.test(t)&&(n.day=!0,a=!0),/[h|H]/.test(t)&&(n.hour=!0,a=!0),/([hHsS]+(:|\s|(".*"))*[mM])|([mM](:|\s|(".*"))*[hHsS]+)/.test(t)&&(n.minute=!0,a=!0),/[s|S]/.test(t)&&(n.second=!0,a=!0),/a{3,4}/.test(t)&&(n.week=!0,a=!0),a)return n}function De(e){var t=Se(e);return!(!t||!/[0#]*\s*\?+\/([\d]+|[\?]+)/.test(t.trim()))}var Me=t.CUSTOM_NUMBER_FORMAT_MAP=new i.default;function we(e){if(!e||""===e)return 0;var t=164,n=!0,o=!1,i=void 0;try{for(var l,d=(0,r.default)(Me.entries());!(n=(l=d.next()).done);n=!0){var s=(0,a.default)(l.value,2),u=s[0];if(s[1]===e)return u;u>t&&(t=u)}}catch(v){o=!0,i=v}finally{try{!n&&d.return&&d.return()}finally{if(o)throw i}}var f=!0,h=!1,c=void 0;try{for(var I,g=(0,r.default)(D.entries());!(f=(I=g.next()).done);f=!0){var R=(0,a.default)(I.value,2);u=R[0];if(R[1]===e)return u}}catch(v){h=!0,c=v}finally{try{!f&&g.return&&g.return()}finally{if(h)throw c}}return-t}t.custom_fmt=[{label:"G/\u901a\u7528\u683c\u5f0f",formatData:"General"},{label:"0",formatData:"0"},{label:"0.00",formatData:"0.00"},{label:"#,##0",formatData:"#,##0"},{label:"#,##0.00",formatData:"#,##0.00"},{label:"#,##0;-#,##0",formatData:"#,##0;-#,##0"},{label:"#,##0;[Red]-#,##0",formatData:"#,##0;[Red]-#,##0"},{label:"#,##0.00;-#,##0.00",formatData:"#,##0.00;-#,##0.00"},{label:"#,##0.00;[Red]-#,##0.00",formatData:"#,##0.00;[Red]-#,##0.00"},{label:"\xa5#,##0;\xa5-#,##0",formatData:'"\xa5"#,##0;"\xa5"-#,##0'},{label:"\xa5#,##0;[Red]\xa5-#,##0",formatData:'"\xa5"#,##0;[Red]"\xa5"-#,##0'},{label:"\xa5#,##0.00;\xa5-#,##0.00",formatData:'"\xa5"#,##0.00;"\xa5"-#,##0.00'},{label:"\xa5#,##0.00;[Red]\xa5-#,##0.00",formatData:'"\xa5"#,##0.00;[Red]"\xa5"-#,##0.00'},{label:"0%",formatData:"0%"},{label:"0.00%",formatData:"0.00%"},{label:"0.00E+00",formatData:"0.00E+00"},{label:"##0.0E+0",formatData:"##0.0E+0"},{label:"# ?/?",formatData:"# ?/?"},{label:"# ??/??",formatData:"# ??/??"},{label:"$#,##0_);($#,##0)",formatData:"$#,##0_);($#,##0)"},{label:"$#,##0_);[Red]($#,##0)",formatData:"$#,##0_);[Red]($#,##0)"},{label:"$#,##0.00_);($#,##0.00)",formatData:"$#,##0.00_);($#,##0.00)"},{label:"$#,##0.00_);[Red]($#,##0.00)",formatData:"$#,##0.00_);[Red]($#,##0.00)"},{label:'yyyy"\u5e74"m"\u6708"',formatData:'yyyy"\u5e74"m"\u6708"'},{label:'m"\u6708"d"\u65e5"',formatData:'m"\u6708"d"\u65e5"'},{label:"yyyy/m/d",formatData:"yyyy/m/d"},{label:'yyyy"\u5e74"m"\u6708"d"\u65e5"',formatData:'yyyy"\u5e74"m"\u6708"d"\u65e5"'},{label:"m/d/yy",formatData:"m/d/yy"},{label:"d-mmm-yy",formatData:"d-mmm-yy"},{label:"d-mmm",formatData:"d-mmm"},{label:"mmm-yy",formatData:"mmm-yy"},{label:"h:mm AM/PM",formatData:"h:mm AM/PM"},{label:"h:mm:ss AM/PM",formatData:"h:mm:ss AM/PM"},{label:"h:mm",formatData:"h:mm"},{label:"h:mm:ss",formatData:"h:mm:ss"},{label:'h"\u65f6"mm"\u5206"',formatData:'h"\u65f6"mm"\u5206"'},{label:'h"\u65f6"mm"\u5206"ss"\u79d2"',formatData:'h"\u65f6"mm"\u5206"ss"\u79d2"'},{label:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"',formatData:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"'},{label:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"',formatData:'\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2"'},{label:"yyyy/m/d h:mm",formatData:"yyyy/m/d h:mm"},{label:"mm:ss",formatData:"mm:ss"},{label:"mm:ss.0",formatData:"mm:ss.0"},{label:"@",formatData:"@"},{label:"[h]:mm:ss",formatData:"[h]:mm:ss"}],t.txSheetToMsoFormatMapping=ae;t.__testExport={format:Q,getCellFormattedValue:ne,getNumberFormatByFormatCode:q}},51:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.divideGridRangesByMerges=void 0;var a=d(n(41)),r=n(158);Object.defineProperty(t,"divideGridRangesByMerges",{enumerable:!0,get:function(){return r.divideGridRangesByMerges}}),t.toChar=function(e){var t="";for(;e>=0;)t=String.fromCharCode(e%26+65)+t,e=Math.floor(e/26)-1;return t},t.toRC=function(e){var t=/^([a-zA-Z]+)(\d+)$/,n=void 0,a=void 0;if(t.test(e)){var r=e.match(t);if(r)return n=r[1],a=function(e){var t=e.toUpperCase().split(""),n=0,a=0;for(;t.length>0;){var r=t.pop(),o=r.charCodeAt(0);a+=n?(o-64)*Math.pow(26,n):o-64,n+=1}return a-1}(n),{row:Number(r[2])-1,col:a}}return},t.divideDimensionRangeByHidden=function(e,t){var n=void 0,a=void 0,r=void 0,o=[];for(n=0;n<e.length;n++){for(r=e[n],a=r.startIndex;a<=r.endIndex&&!(t[a]&&t[a].hiddenByUser&&(r.startIndex<=a-1&&o.push(new l.default(r.sheetId,r.startIndex,a-1,r.dimension)),r.startIndex=a+1,r.startIndex>=r.endIndex));a++);r.startIndex<=r.endIndex&&o.push(r)}return o},t.divideDimensionRangeByFilter=function(e,t){var n=void 0,a=void 0,r=void 0,o=[];if(!t)return e;var d=t.getHiddenRows(),s=void 0;if(!d.length)return e;for(n=0;n<e.length;n++)if((r=e[n]).dimension!==i.default.COLUMNS){for(a=0;a<d.length&&(s=d[a],!(r.startIndex<=s&&r.endIndex>=s&&(r.startIndex<s&&o.push(new l.default(r.sheetId,r.startIndex,s-1,r.dimension)),r.startIndex=s+1,r.startIndex>=r.endIndex)));a++);r.startIndex<=r.endIndex&&o.push(r)}else o.push(r);return o},t.divideGridRangesByFilter=function(e,t){var n=void 0,a=void 0,r=void 0,i=void 0,l=void 0,d=[];if(!t)return e;var s=t.getHiddenRows(),u=void 0;if(!s.length)return e;for(n=0,i=e.length;n<i;n++){for(l=e[n],a=0,r=s.length;a<r&&(u=s[a],!(l.startRowIndex<=u&&l.endRowIndex>=u&&(l.startRowIndex<u&&d.push(new o.default(l.sheetId,l.startRowIndex,u-1,l.startColIndex,l.endColIndex)),l.startRowIndex=u+1,l.startRowIndex>=l.endRowIndex)));a++);l.startRowIndex<=l.endRowIndex&&d.push(l)}return d},t.convertGridRangeToIXYRange=function(e){var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex;return{yRange:[t,n],xRange:[a,r]}},t.convertIXYRangeToGridRange=function(e,t){var n=(0,a.default)(e.yRange,2),r=n[0],i=n[1],l=(0,a.default)(e.xRange,2),d=l[0],s=l[1];return new o.default(t,r,i,d,s)},t.convertGridRangeToSheetIdXYRange=function(e){var t=e.startRowIndex,n=e.endRowIndex,a=e.startColIndex,r=e.endColIndex,o=e.sheetId;return{rowsRange:new l.default(o,t,n,i.default.ROWS),columnsRange:new l.default(o,a,r,i.default.COLUMNS),sheetId:o}},t.convertXYRangeToSheetIdXYRange=function(e,t){var n=(0,a.default)(e.yRange,2),r=n[0],o=n[1],d=(0,a.default)(e.xRange,2),s=d[0],u=d[1];return{rowsRange:new l.default(t,r,o,i.default.ROWS),columnsRange:new l.default(t,s,u,i.default.COLUMNS),sheetId:t}},t.convertGridRangeToDimensionRange=function(e,t){var n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=e.endColIndex,d=e.sheetId;return t===i.default.ROWS?new l.default(d,n,a,i.default.ROWS):new l.default(d,r,o,i.default.COLUMNS)},t.convertSheetIdXYRange2GridRange=function(e){var t=e.rowsRange,n=t.startIndex,a=t.endIndex,r=e.columnsRange,i=r.startIndex,l=r.endIndex,d=e.sheetId;return new o.default(d,n,a,i,l)};var o=d(n(11)),i=d(n(15)),l=d(n(35));function d(e){return e&&e.__esModule?e:{default:e}}},510:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transKeyFrame=function(e){if(Array.isArray(e))return function(e){var t={keyframe:[],actions:[],lastKeyFrameActions:[],hasKeyFrame:!1},n=void 0,s=void 0;if(e&&e[0])try{s=e[0]}catch(R){l.default.run(d.CONFIG.PARSE_KEYFRAME_ERROR_2,[R&&R.stack]),s=[]}else s=[];var h=void 0;try{h=u(s[0])}catch(v){return l.default.run(d.CONFIG.UNZIP_KEYFRAME,[v&&v.stack],v),o.default.window.SpreadsheetApp.isInited?alert("\u51fa\u9519\u5566"):(0,r.redirectToBlankPage)({type:17,errcode:i.errCodeType.KEYFRAME_UNZIP_ERROR}),t}var c=0;f(h)&&(t.hasKeyFrame=!0,t.keyframe=h,c=1);new Date;for(var I,g=c;I=e[g++];){try{n=I}catch(R){!1;break}t.actions.push((0,a.checkActionsIfNeedUnzip)(n))}t.keyframe&&(t.lastKeyFrameActions[0]=t.keyframe);return t.lastKeyFrameActions=t.lastKeyFrameActions.concat(t.actions),t}(e);var t=unescape(e);return function(e){var t={keyframe:[],actions:[],lastKeyFrameActions:[],hasKeyFrame:!1},n=void 0,s=void 0;if(e&&e[0])try{s=JSON.parse(e[0])}catch(g){l.default.run(d.CONFIG.PARSE_KEYFRAME_ERROR,[g&&g.stack]),s=[]}else s=[];var h=void 0;try{h=u(s[0])}catch(R){return l.default.run(d.CONFIG.UNZIP_KEYFRAME_ERROR,[R&&R.stack],R),o.default.window.SpreadsheetApp.isInited?this.app.event.errorCode.trigger("errorCode",{type:"front",code:i.errCodeType.KEYFRAME_UNZIP_ERROR}):(0,r.redirectToBlankPage)({type:17,errcode:i.errCodeType.KEYFRAME_UNZIP_ERROR}),t}f(h)&&(t.hasKeyFrame=!0,t.keyframe=h,e.shift()),new Date;for(var c,I=0;c=e[I++];){try{n=JSON.parse(c)}catch(g){break}t.actions.push((0,a.checkActionsIfNeedUnzip)(n))}return t.keyframe&&(t.lastKeyFrameActions[0]=t.keyframe),t.lastKeyFrameActions=t.lastKeyFrameActions.concat(t.actions),t}(t.split("\n").filter(function(e){return e.length>0&&e.indexOf("[")>-1}))},t.sheetToKeyframe=function(e){for(var t=e.getRowCount(),n=e.getColCount(),a={tt:"set",t:"",dt:"set",st:"set",r:t,c:n,imm:!0},r=[],o=[],i=0;i<t;i++){for(var l=[],d=[],s=0;s<n;s++){var u=e.data.rowData[s]&&e.data.rowData[s].values[i],f=u&&u.getEffectiveValue(),c=h(u);l.push(f),d.push(c)}r.push(l),o.push(d)}a.d=r,a.s=o,a.m=function(e){if(Array.isArray(e)){var t=[];return e.forEach(function(e){var n=e.startRowIndex,a=e.endRowIndex,r=e.startColumnIndex,o=e.endColumnIndex,i={row:n,rowspan:a-n+1,col:r,colspan:o-r+1};t.push(i)}),t}}(e.getMerges());var I=e.getProperties().getGridProperties();a.ts={rowCount:I.frozenRowCount,colCount:I.frozenColCount},a.sp=e.getImages(),a.f=e.getBasicFilter();var g=e.data.columnMetadata,R=e.data.rowMetadata,v=[],p=[];g.forEach(function(e){v.push(e&&e.getPixelSize())}),g.forEach(function(e){p.push(e&&e.getPixelSize())}),a.cw=v,a.rh=p;var T={},E={};g.forEach(function(e,t){e&&e.getHiddenByUser()&&(E[t]=1)}),R.forEach(function(e,t){e&&e.getHiddenByUser()&&(T[t]=1)})};var a=n(181),r=n(1058),o=s(n(7)),i=n(90),l=s(n(8)),d=n(26);function s(e){return e&&e.__esModule?e:{default:e}}function u(e){if(e&&e.z){var t=Date.now(),n=(0,a.unzipKeyFrame)(e);return l.default.tdwReport({opername:"quality_doc",module:"excel_detail",action:"unzip_keyframe_cost",ver5:Date.now()-t}),n}return e&&e.u?e.u:e&&e.k?[e]:e}function f(e){return!(!e||!e[0]||"k"!==e[0].type)}function h(e){if(!e)return{style:null,prop:null};var t={},n=e.getUserEnteredFormat();return n&&(t.background=n.getBackgroundColor()&&n.getBackgroundColor().toHex(),t.bold=n.getTextFormat()&&n.getTextFormat().bold,t.fontfamily=n.getTextFormat()&&n.getTextFormat().fontFamily,t.fontsize=n.getTextFormat()&&n.getTextFormat().fontSize,t.format=n.getNumberFormat()&&n.getNumberFormat().type,t.format_data=n.getNumberFormat()&&n.getNumberFormat().pattern,t.format_id=n.getNumberFormat()&&n.getNumberFormat().id,t.h_align=n.getHorizontalAlign(),t.v_align=n.getVerticalAlign(),t.border=function(e){var t=[];e&&(e.top&&(t[0]=e.top.color),e.left&&(t[1]=e.left.color),e.bottom&&(t[2]=e.bottom.color),e.right&&(t[3]=e.right.color));return{colors:t}}(n.getBorders()),t.color=n.getTextFormat()&&n.getTextFormat().color),t}},52:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(83)),r=g(n(0)),o=g(n(1)),i=g(n(32)),l=g(n(121)),d=g(n(115)),s=g(n(156)),u=g(n(182)),f=g(n(225)),h=g(n(108)),c=g(n(95)),I=g(n(183));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,r.default)(this,e),t.setSlots=null!=t.setSlots?t.setSlots:0,t.numberFormat=t.numberFormat||null,t.backgroundColor=t.backgroundColor||null,t.borders=t.borders||null,t.horizontalAlign=t.horizontalAlign||null,t.verticalAlign=t.verticalAlign||null,t.wrapStrategy=t.wrapStrategy||null,t.textFormat=t.textFormat||null,t.dataValidation=t.dataValidation||null,this.setProperties(t)}return(0,o.default)(e,[{key:"setProperties",value:function(e){return"undefined"!==typeof e.numberFormat&&this.setNumberFormat(e.numberFormat),"undefined"!==typeof e.dataValidation&&this.setDataValidation(e.dataValidation),"undefined"!==typeof e.backgroundColor&&this.setBackgroundColor(e.backgroundColor),"undefined"!==typeof e.borders&&this.setBorders(e.borders),"undefined"!==typeof e.horizontalAlign&&this.setHorizontalAlign(e.horizontalAlign),"undefined"!==typeof e.verticalAlign&&this.setVerticalAlign(e.verticalAlign),"undefined"!==typeof e.wrapStrategy&&this.setWrapStrategy(e.wrapStrategy),"undefined"!==typeof e.textFormat&&this.setTextFormat(e.textFormat),this}},{key:"isEmpty",value:function(){return 0===this.setSlots}},{key:"setSlot",value:function(e){return this.setSlots=this.setSlots|1<<e,this}},{key:"clearSlot",value:function(e){return this.setSlots=this.setSlots&~(1<<e),this}},{key:"hasSlot",value:function(e){return(this.setSlots&1<<e)>0}},{key:"getNumberFormat",value:function(){return this.numberFormat}},{key:"setNumberFormat",value:function(e){return"function"===typeof e?this:(e?e instanceof l.default?this.numberFormat=e:this.numberFormat?this.numberFormat.setProperties(e):this.numberFormat=new l.default(e):this.numberFormat=null,this.numberFormat?this.setSlot(i.default.NUMBER_FORMAT):this.clearSlot(i.default.NUMBER_FORMAT),this)}},{key:"clearNumberFormat",value:function(){return this.setNumberFormat(null)}},{key:"getBackgroundColor",value:function(){return this.backgroundColor}},{key:"setBackgroundColor",value:function(e){return e?e instanceof d.default?this.backgroundColor=e:this.backgroundColor?this.backgroundColor.setProperties(e):this.backgroundColor=new d.default(e):this.backgroundColor=null,this.backgroundColor?this.setSlot(i.default.BACKGROUND_COLOR):this.clearSlot(i.default.BACKGROUND_COLOR),this}},{key:"clearBackgroundColor",value:function(){return this.setBackgroundColor(null)}},{key:"getBorders",value:function(){return this.borders}},{key:"setBorders",value:function(e){return e?e instanceof s.default?this.borders=e:this.borders?this.borders.setProperties(e):this.borders=new s.default(e):this.borders=null,this.borders?(this.borders.top?this.setSlot(i.default.BORDER_TOP):this.clearSlot(i.default.BORDER_TOP),this.borders.right?this.setSlot(i.default.BORDER_RIGHT):this.clearSlot(i.default.BORDER_RIGHT),this.borders.bottom?this.setSlot(i.default.BORDER_BOTTOM):this.clearSlot(i.default.BORDER_BOTTOM),this.borders.left?this.setSlot(i.default.BORDER_LEFT):this.clearSlot(i.default.BORDER_LEFT)):(this.clearSlot(i.default.BORDER_TOP),this.clearSlot(i.default.BORDER_RIGHT),this.clearSlot(i.default.BORDER_BOTTOM),this.clearSlot(i.default.BORDER_LEFT)),this}},{key:"clearBorders",value:function(){return this.setBorders(null)}},{key:"getBorderTop",value:function(){var e=this.getBorders();return e&&e.top}},{key:"setBorderTop",value:function(e){return this.setBorders({top:e})}},{key:"clearBorderTop",value:function(){return this.setBorderTop(null)}},{key:"getBorderRight",value:function(){var e=this.getBorders();return e&&e.right}},{key:"setBorderRight",value:function(e){return this.setBorders({right:e})}},{key:"clearBorderRight",value:function(){return this.setBorderRight(null)}},{key:"getBorderBottom",value:function(){var e=this.getBorders();return e&&e.bottom}},{key:"setBorderBottom",value:function(e){return this.setBorders({bottom:e})}},{key:"clearBorderBottom",value:function(){return this.setBorderBottom(null)}},{key:"getBorderLeft",value:function(){var e=this.getBorders();return e&&e.left}},{key:"setBorderLeft",value:function(e){return this.setBorders({left:e})}},{key:"clearBorderLeft",value:function(){return this.setBorderLeft(null)}},{key:"getHorizontalAlign",value:function(){return this.horizontalAlign}},{key:"setHorizontalAlign",value:function(e){return this.horizontalAlign=e||null,this.horizontalAlign?this.setSlot(i.default.HORIZONTAL_ALIGN):this.clearSlot(i.default.HORIZONTAL_ALIGN),this}},{key:"clearHorizontalAlign",value:function(){return this.setHorizontalAlign(null)}},{key:"getVerticalAlign",value:function(){return this.verticalAlign}},{key:"setVerticalAlign",value:function(e){return this.verticalAlign=e||null,this.verticalAlign?this.setSlot(i.default.VERTICAL_ALIGN):this.clearSlot(i.default.VERTICAL_ALIGN),this}},{key:"clearVerticalAlign",value:function(){return this.setVerticalAlign(null)}},{key:"getWrapStrategy",value:function(){return this.wrapStrategy}},{key:"setWrapStrategy",value:function(e){return this.wrapStrategy=e||null,this.wrapStrategy?this.setSlot(i.default.WRAP_STRATEGY):this.clearSlot(i.default.WRAP_STRATEGY),this}},{key:"clearWrapStrategy",value:function(){return this.setWrapStrategy(null)}},{key:"getTextFormat",value:function(){return this.textFormat}},{key:"setTextFormat",value:function(e){return e?e instanceof c.default?this.textFormat=e:this.textFormat?this.textFormat.setProperties(e):this.textFormat=new c.default(e):this.textFormat=null,this.textFormat?(null==this.textFormat.color?this.clearSlot(i.default.FOREGROUND_COLOR):this.setSlot(i.default.FOREGROUND_COLOR),null==this.textFormat.fontFamily?this.clearSlot(i.default.FONT_FAMINY):this.setSlot(i.default.FONT_FAMINY),null==this.textFormat.fontSize?this.clearSlot(i.default.FONT_SIZE):this.setSlot(i.default.FONT_SIZE),null==this.textFormat.bold?this.clearSlot(i.default.BOLD):this.setSlot(i.default.BOLD),null==this.textFormat.italic?this.clearSlot(i.default.ITALIC):this.setSlot(i.default.ITALIC),null==this.textFormat.strikethrough?this.clearSlot(i.default.STRIKETHROUGH):this.setSlot(i.default.STRIKETHROUGH),null==this.textFormat.underline?this.clearSlot(i.default.UNDERLINE):this.setSlot(i.default.UNDERLINE)):(this.clearSlot(i.default.FOREGROUND_COLOR),this.clearSlot(i.default.FONT_FAMINY),this.clearSlot(i.default.FONT_SIZE),this.clearSlot(i.default.BOLD),this.clearSlot(i.default.ITALIC),this.clearSlot(i.default.STRIKETHROUGH),this.clearSlot(i.default.UNDERLINE)),this}},{key:"clearTextFormat",value:function(){return this.setTextFormat(null)}},{key:"getColor",value:function(){var e=this.textFormat;return e&&e.color}},{key:"setColor",value:function(e){return this.setTextFormat({color:e})}},{key:"clearColor",value:function(){return this.setColor(null)}},{key:"getFontFamily",value:function(){var e=this.textFormat;return e&&e.fontFamily}},{key:"setFontFamily",value:function(e){return this.setTextFormat({fontFamily:e})}},{key:"clearFontFamily",value:function(){return this.setFontFamily(null)}},{key:"getFontSize",value:function(){var e=this.textFormat;return e&&e.fontSize}},{key:"setFontSize",value:function(e){return this.setTextFormat({fontSize:e})}},{key:"clearFontSize",value:function(){return this.setFontSize(null)}},{key:"getBold",value:function(){var e=this.textFormat;return e&&e.bold}},{key:"setBold",value:function(e){return this.setTextFormat({bold:e})}},{key:"clearBold",value:function(){return this.setBold(null)}},{key:"getItalic",value:function(){var e=this.textFormat;return e&&e.italic}},{key:"setItalic",value:function(e){return this.setTextFormat({italic:e})}},{key:"clearItalic",value:function(){return this.setItalic(null)}},{key:"getStrikethrough",value:function(){var e=this.textFormat;return e&&e.strikethrough}},{key:"setStrikethrough",value:function(e){return this.setTextFormat({strikethrough:e})}},{key:"clearStrikethrough",value:function(){return this.setStrikethrough(null)}},{key:"getUnderline",value:function(){var e=this.textFormat;return e&&e.underline}},{key:"setUnderline",value:function(e){return this.setTextFormat({underline:e})}},{key:"clearUnderline",value:function(){return null===this.textFormat?this:this.setUnderline(null)}},{key:"getDataValidation",value:function(){return this.dataValidation}},{key:"setDataValidation",value:function(e){return e?e instanceof I.default?this.dataValidation=e:this.dataValidation?this.dataValidation.setProperties(e):this.dataValidation=new I.default(e):this.dataValidation=null,this.dataValidation?this.setSlot(i.default.DATA_VALIDATION):this.clearSlot(i.default.DATA_VALIDATION),this}},{key:"clearDataValidation",value:function(){return this.setDataValidation(null)}},{key:"clone",value:function(){return new e({numberFormat:this.numberFormat?this.numberFormat.clone():null,backgroundColor:this.backgroundColor?this.backgroundColor.clone():null,borders:this.borders?this.borders.clone():null,horizontalAlign:this.horizontalAlign,verticalAlign:this.verticalAlign,wrapStrategy:this.wrapStrategy,textFormat:this.textFormat?this.textFormat.clone():null,dataValidation:this.dataValidation?this.dataValidation.clone():null})}},{key:"toString",value:function(){var e,t,n;return this.setSlots+","+(null!==this.numberFormat?this.numberFormat._key:"")+","+(null!=this.backgroundColor?this.backgroundColor._key:"")+","+(null!=this.borders?this.borders._key:"")+","+(null!=this.horizontalAlign?(e={},(0,a.default)(e,u.default.LEFT,"1"),(0,a.default)(e,u.default.CENTER,"2"),(0,a.default)(e,u.default.RIGHT,"3"),e)[this.horizontalAlign]:"")+","+(null!=this.verticalAlign?(t={},(0,a.default)(t,f.default.TOP,"1"),(0,a.default)(t,f.default.MIDDLE,"2"),(0,a.default)(t,f.default.BOTTOM,"3"),t)[this.verticalAlign]:"")+","+(null!=this.wrapStrategy?(n={},(0,a.default)(n,h.default.OVERFLOW_CELL,"1"),(0,a.default)(n,h.default.WRAP,"2"),n)[this.wrapStrategy]:"")+","+(null!=this.textFormat?this.textFormat._key:"")+","+(null!=this.dataValidation?this.dataValidation._key:"")}}]),e}();R.protoMap={0:{name:"setSlots",dataType:Number},1:{name:"numberFormat",dataType:l.default},2:{name:"backgroundColor",dataType:d.default},3:{name:"borders",dataType:s.default},4:{name:"horizontalAlign",dataType:Number},5:{name:"verticalAlign",dataType:Number},6:{name:"wrapStrategy",dataType:Number},7:{name:"textFormat",dataType:c.default},8:{name:"dataValidation",dataType:I.default}},t.default=R},54:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(9)),r=R(n(31)),o=R(n(0)),i=R(n(1)),l=R(n(81)),d=R(n(18)),s=R(n(62)),u=R(n(78)),f=R(n(52)),h=R(n(60)),c=R(n(109)),I=R(n(275)),g=n(48);function R(e){return e&&e.__esModule?e:{default:e}}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e),t.setSlots=null!=t.setSlots?t.setSlots:0,t.effectiveValue=t.effectiveValue||null,t.formattedValue=t.formattedValue||null,t.editValue=null!=t.editValue?t.editValue:null,t.userEnteredFormat=t.userEnteredFormat||null,t.effectiveFormat=t.effectiveFormat||null,t.conditionalFormatResult=t.conditionalFormatResult||null,t.mergeReference=t.mergeReference||null,t.hyperlink=null!=t.hyperlink?t.hyperlink:null,t.formula=t.formula||null,t.textFormatRuns=t.textFormatRuns||null,t.isDataValid=null!=t.isDataValid?t.isDataValid:null,t.sheetRangeReferences=t.sheetRangeReferences||null,t.author=null!=t.author?t.author:null,t.mentionDetails=t.mentionDetails||null,this.setProperties(t)}return(0,i.default)(e,[{key:"setProperties",value:function(e){var t=this;return"undefined"!==typeof e.effectiveValue&&this.setEffectiveValue(e.effectiveValue),"undefined"!==typeof e.formattedValue&&this.setFormattedValue(e.formattedValue),"undefined"!==typeof e.editValue&&this.setEditValue(e.editValue),"undefined"!==typeof e.userEnteredFormat&&this.setUserEnteredFormat(e.userEnteredFormat),"undefined"!==typeof e.effectiveFormat&&this.setEffectiveFormat(e.effectiveFormat),"undefined"!==typeof e.conditionalFormatResult&&this.setConditionalFormatResult(e.conditionalFormatResult),"undefined"!==typeof e.mergeReference&&this.setMergeReference(e.mergeReference),"undefined"!==typeof e.hyperlink&&this.setHyperlink(e.hyperlink),"undefined"!==typeof e.formula&&this.setFormula(e.formula),"undefined"!==typeof e.textFormatRuns&&this.setTextFormatRuns(e.textFormatRuns),"undefined"!==typeof e.isDataValid&&this.setIsDataValid(e.isDataValid),"undefined"!==typeof e.sheetRangeReferences&&e.sheetRangeReferences&&e.sheetRangeReferences.forEach(function(e){t.addSheetRange(e.id,e.type)}),"undefined"!==typeof e.author&&this.setAuthor(e.author),"undefined"!==typeof e.mentionDetails&&this.setMentionDetails(e.mentionDetails),this}},{key:"isEmpty",value:function(){return 0===this.setSlots}},{key:"isTotallyEmpty",value:function(){return this.isEmpty()&&!this.mergeReference&&!this.sheetRangeReferences}},{key:"setSlot",value:function(e){return this.setSlots=this.setSlots|1<<e,this}},{key:"clearSlot",value:function(e){return this.setSlots=this.setSlots&~(1<<e),this}},{key:"hasSlot",value:function(e){return(this.setSlots&1<<e)>0}},{key:"getEffectiveValue",value:function(){return this.effectiveValue}},{key:"setEffectiveValue",value:function(e){return e?e instanceof u.default?this.effectiveValue=e:this.effectiveValue?this.effectiveValue.setProperties(e):this.effectiveValue=new u.default(e):this.effectiveValue=null,this.effectiveValue?this.setSlot(d.default.SLOT_EFFIECTIVE_VALUE):this.clearSlot(d.default.SLOT_EFFIECTIVE_VALUE),this}},{key:"clearEffectiveValue",value:function(){return this.setEffectiveValue(null)}},{key:"getFormattedValue",value:function(){return this.formattedValue}},{key:"setFormattedValue",value:function(e){return this.formattedValue=e,this}},{key:"clearFormattedValue",value:function(){return this.setFormattedValue(null)}},{key:"getEditValue",value:function(){return this.editValue}},{key:"setEditValue",value:function(e){return this.editValue=e,this}},{key:"clearEditValue",value:function(){return this.setEditValue(null)}},{key:"getUserEnteredFormat",value:function(){return this.userEnteredFormat}},{key:"setUserEnteredFormat",value:function(e){return this.userEnteredFormat=e,this.userEnteredFormat?this.setSlot(d.default.SLOT_USER_ENTERED_FORMAT_DELTA):this.clearSlot(d.default.SLOT_USER_ENTERED_FORMAT_DELTA),this}},{key:"clearUserEnteredFormat",value:function(){return this.setUserEnteredFormat(null)}},{key:"getEffectiveFormat",value:function(){return this.effectiveFormat}},{key:"setEffectiveFormat",value:function(e){return this.effectiveFormat=e,this.effectiveFormat?this.setSlot(d.default.SLOT_EFFIECTIVE_FORMAT_DELTA):this.clearSlot(d.default.SLOT_EFFIECTIVE_FORMAT_DELTA),this}},{key:"clearEffectiveFormat",value:function(){return this.setEffectiveFormat(null)}},{key:"getConditionalFormatResult",value:function(){return this.conditionalFormatResult}},{key:"setConditionalFormatResult",value:function(e){return this.conditionalFormatResult=e,this.conditionalFormatResult?this.setSlot(d.default.SLOT_CONDITIONAL_FORMAT_DELTA):this.clearSlot(d.default.SLOT_CONDITIONAL_FORMAT_DELTA),this}},{key:"clearConditionalFormatResult",value:function(){return this.setConditionalFormatResult(null)}},{key:"getMergeReference",value:function(){return this.mergeReference||null}},{key:"setMergeReference",value:function(e){return this.mergeReference=e,this}},{key:"clearMergeReference",value:function(){return this.mergeReference=null,this}},{key:"getHyperlink",value:function(){return this.hyperlink}},{key:"setHyperlink",value:function(e){return this.hyperlink=e,null==this.hyperlink?(this.hyperlink=null,this.clearSlot(d.default.SLOT_HYPERLINK)):this.setSlot(d.default.SLOT_HYPERLINK),this}},{key:"clearHyperlink",value:function(){return this.setHyperlink(null)}},{key:"getFormula",value:function(){return this.formula}},{key:"setFormula",value:function(e){return this.formula=e,null==this.formula?this.clearSlot(d.default.SLOT_FORMULA):this.setSlot(d.default.SLOT_FORMULA),this}},{key:"clearFormula",value:function(){return this.setFormula(null)}},{key:"getTextFormatRuns",value:function(){return this.textFormatRuns}},{key:"setTextFormatRuns",value:function(e){return e||null===e?(this.textFormatRuns=e,this.textFormatRuns?this.setSlot(d.default.SLOT_RICH_TEXT_STYLE_RUN):this.clearSlot(d.default.SLOT_RICH_TEXT_STYLE_RUN),this.checkTextFormatRuns(),this):this}},{key:"checkTextFormatRuns",value:function(){if(this.textFormatRuns){var e=this.textFormatRuns,t=void 0,n=void 0,a=void 0;for(t=0;t<e.length-1;t++)n=e[t],a=e[t+1],n.equalTextFormat(a)&&(e.splice(t+1,1),t--)}}},{key:"clearTextFormatRuns",value:function(){return this.setTextFormatRuns(null)}},{key:"getIsDataValid",value:function(){return this.isDataValid}},{key:"setIsDataValid",value:function(e){return this.isDataValid=e,null==this.isDataValid?this.clearSlot(d.default.SLOT_IS_DATA_VALID):this.setSlot(d.default.SLOT_IS_DATA_VALID),this}},{key:"clearIsDataValid",value:function(){return this.setIsDataValid(null)}},{key:"getSheetRange",value:function(){return this.sheetRangeReferences}},{key:"setSheetRange",value:function(e){return this.sheetRangeReferences=e,this}},{key:"addSheetRange",value:function(e,t){var n,a=void 0;for(this.sheetRangeReferences=this.sheetRangeReferences||[],a=0,n=this.sheetRangeReferences.length;a<n;a++)if(this.sheetRangeReferences[a].id===e)return this;return this.sheetRangeReferences.push({id:e,type:t}),this}},{key:"deleteSheetRange",value:function(e,t){var n,a=void 0;for(this.sheetRangeReferences=this.sheetRangeReferences||[],a=0,n=this.sheetRangeReferences.length;a<n;a++)if(this.sheetRangeReferences[a].id===e&&this.sheetRangeReferences[a].type===t){this.sheetRangeReferences.splice(a,1);break}return this}},{key:"clearSheetRange",value:function(){return this.setSheetRange(null)}},{key:"getAuthor",value:function(){return this.author}},{key:"setAuthor",value:function(e){return this.author=e,this}},{key:"clearAuthor",value:function(){return this.setAuthor(null)}},{key:"getMentionDetails",value:function(){return this.mentionDetails||null}},{key:"setMentionDetails",value:function(e){if(this.mentionDetails=null,null==e)this.clearSlot(d.default.SLOT_MENTION);else{this.setSlot(d.default.SLOT_MENTION);var t=!0,n=!1,o=void 0;try{for(var i,l=(0,r.default)((0,a.default)(e));!(t=(i=l.next()).done);t=!0){var s=i.value,u=e[s];u.padId&&u.padId===window.clientVars.padId&&this.addMentionDetail(s,e[s])}}catch(f){n=!0,o=f}finally{try{!t&&l.return&&l.return()}finally{if(n)throw o}}}return this}},{key:"addMentionDetail",value:function(e,t){return null!=this.mentionDetails&&"undefined"!=typeof this.mentionDetails||(this.mentionDetails={}),this.mentionDetails[e]=t.clone(),this}},{key:"clearMentionDetails",value:function(){return this.setMentionDetails(null)}},{key:"autoUpdate",value:function(e,t){this.effectiveFormat&&!this.formula&&this.effectiveFormat.clearNumberFormat();var n=void 0;if(this.effectiveValue&&this.effectiveValue.type===s.default.ERROR)this.setFormattedValue(null),this.formula?this.setEditValue(this.formula.toString(e,t)):this.setEditValue(null),this.effectiveFormat&&this.effectiveFormat.clearColor();else{var a=this.userEnteredFormat?this.userEnteredFormat.getNumberFormat():null,r=this.effectiveFormat?this.effectiveFormat.getNumberFormat():null,o=a&&!(0,g.isGeneralCell2)(a)?a:r;n=(0,g.getCellFormattedValue)(this.effectiveValue,o),this.setFormattedValue(n),n&&n.textColor?(this.effectiveFormat=this.effectiveFormat||new f.default,this.effectiveFormat.setColor(n.textColor)):this.effectiveFormat&&this.effectiveFormat.clearColor(),this.formula?this.setEditValue(this.formula.toString(e,t)):this.effectiveValue?this.effectiveValue.type===s.default.BOOL?this.setEditValue(this.effectiveValue.value?"TRUE":"FALSE"):this.effectiveValue.type===s.default.NUMBER?this.setEditValue((0,g.getEditValue)(this.effectiveValue.value,o)):this.effectiveValue.type===s.default.STRING&&this.setEditValue(this.effectiveValue.value):this.setEditValue(null)}this.effectiveFormat&&this.effectiveFormat.isEmpty()&&this.clearEffectiveFormat()}},{key:"clone",value:function(){var t={};if(this.mentionDetails){var n=!0,o=!1,i=void 0;try{for(var d,s=(0,r.default)((0,a.default)(this.mentionDetails));!(n=(d=s.next()).done);n=!0){var u=d.value;t[u]=this.mentionDetails[u].clone()}}catch(f){o=!0,i=f}finally{try{!n&&s.return&&s.return()}finally{if(o)throw i}}}return new e({effectiveValue:this.effectiveValue?this.effectiveValue.clone():null,formattedValue:this.formattedValue?l.default.util.type.clone(this.formattedValue):null,editValue:this.editValue?this.editValue:null,userEnteredFormat:this.userEnteredFormat?this.userEnteredFormat.clone():null,effectiveFormat:this.effectiveFormat?this.effectiveFormat.clone():null,hyperlink:null!=this.hyperlink?this.hyperlink:null,formula:this.formula?this.formula.clone():null,textFormatRuns:this.textFormatRuns?this.textFormatRuns.map(function(e){return e.clone()}):null,isDataValid:this.isDataValid?this.isDataValid:null,mentionDetails:t})}}]),e}();v.protoMap={0:{name:"setSlots",dataType:Number},1:{name:"effectiveValue",dataType:u.default},2:{name:"userEnteredFormat",dataType:f.default},4:{name:"hyperlink",dataType:String},5:{name:"formula",dataType:h.default},6:{name:"textFormatRuns",dataType:{type:Array,subType:c.default}},7:{name:"textFormatRuns",dataType:{type:Array,subType:c.default}},8:{name:"isDataValid",dataType:Boolean},9:{name:"conditionalFormatResult",dataType:f.default},10:{name:"mentionDetails",dataType:{type:Object,subType:I.default}}},t.default=v},55:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getExportFormat=t.mergeDeltaToCellData=t.createCellDataDeltaForFormatPainter=t.createCellDataDelta=void 0;var a=h(n(54)),r=h(n(29)),o=n(18),i=h(o),l=n(32),d=n(229),s=h(n(60)),u=n(48),f=h(n(52));function h(e){return e&&e.__esModule?e:{default:e}}function c(e){var t=e.getUserEnteredFormat(),n=e.getEffectiveFormat();if(!t&&!n)return new f.default;var a=t?t.getNumberFormat():null,r=n?n.getNumberFormat():null;if(a&&!(0,u.isGeneralCell)(a)||!r||(0,u.isGeneralCell)(r))return t||new f.default;var o=t?t.clone():new f.default;return o.setNumberFormat(r),o}t.createCellDataDelta=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:o.CELL_DATA_SLOT_COMPOSE.ALL,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:l.CELL_FORMAT_SLOT_COMPOSE.ALL,f=arguments[4];f=f||{formulaRelative:!1};var h=void 0,c=new r.default,I=void 0;if(!e.cellData&&!t.cellData)return c;for(e.cellData||(e.cellData=new a.default),t.cellData||(t.cellData=new a.default),h=0;n>0;n>>=1,h++)if(1===(1&n))if(t.cellData.hasSlot(h))switch(h){case i.default.SLOT_EFFIECTIVE_VALUE:c.setSlot(h,t.cellData.getEffectiveValue());break;case i.default.SLOT_USER_ENTERED_FORMAT_DELTA:I=(0,d.createCellFormatDelta)(e.cellData.getUserEnteredFormat(),t.cellData.getUserEnteredFormat(),u),c.setSlot(h,I);break;case i.default.SLOT_EFFIECTIVE_FORMAT_DELTA:I=(0,d.createCellFormatDelta)(e.cellData.getEffectiveFormat(),t.cellData.getEffectiveFormat(),u),c.setSlot(h,I);break;case i.default.SLOT_HYPERLINK:c.setSlot(h,t.cellData.getHyperlink());break;case i.default.SLOT_FORMULA:if(t.cellData.getFormula())if(f.formulaRelative){if(void 0===e.rowIndex||void 0===e.colIndex||void 0===t.rowIndex||void 0===t.colIndex){console.error("\u9519\u8bef\uff0c\u68c0\u6d4b\u51fd\u6570delta\u5fc5\u987b\u8981\u4f20\u5165rowIndex\u548ccolIndex");break}c.setSlot(h,s.default.string2FormulaModel(t.cellData.getFormula().toString(t.rowIndex,t.colIndex),e.rowIndex,e.colIndex,e.sheetId))}else c.setSlot(h,t.cellData.getFormula());else c.setSlot(h,null);break;case i.default.SLOT_IS_DATA_VALID:c.setSlot(h,t.cellData.getIsDataValid());break;case i.default.SLOT_RICH_TEXT_STYLE_RUN:c.setSlot(h,t.cellData.getTextFormatRuns());break;case i.default.SLOT_MENTION:c.setSlot(h,t.cellData.getMentionDetails())}else(e.cellData.setSlots&1<<h)>0&&c.clearSlot(h);return c},t.createCellDataDeltaForFormatPainter=function(e,t){var n=new r.default,o=void 0;return e.cellData||t.cellData?(e.cellData||(e.cellData=new a.default),t.cellData||(t.cellData=new a.default),t.cellData.hasSlot(i.default.SLOT_USER_ENTERED_FORMAT_DELTA)||t.cellData.hasSlot(i.default.SLOT_EFFIECTIVE_FORMAT_DELTA)?(o=(0,d.createCellFormatDelta)(e.cellData.getUserEnteredFormat(),c(t.cellData)),n.setSlot(i.default.SLOT_USER_ENTERED_FORMAT_DELTA,o),n.clearSlot(i.default.SLOT_RICH_TEXT_STYLE_RUN)):e.cellData.hasSlot(i.default.SLOT_USER_ENTERED_FORMAT_DELTA)&&n.clearSlot(i.default.SLOT_USER_ENTERED_FORMAT_DELTA),n):n},t.mergeDeltaToCellData=function(e,t){if(t.clearSlots===o.CELL_DATA_SLOT_COMPOSE.ALL)return null;if(0===t.setSlots&&(!e||0===(e.setSlots&t.clearSlots)))return e;e=e||new a.default;var n=void 0,r=void 0;for(r=t.clearSlots&e.setSlots,n=0;r>0;r>>=1,n++)if(1===(1&r))switch(n){case i.default.SLOT_EFFIECTIVE_VALUE:e.setEffectiveValue(null);break;case i.default.SLOT_USER_ENTERED_FORMAT_DELTA:e.setUserEnteredFormat(null);break;case i.default.SLOT_EFFIECTIVE_FORMAT_DELTA:e.setEffectiveFormat(null);break;case i.default.SLOT_CONDITIONAL_FORMAT_DELTA:e.setConditionalFormatResult(null);break;case i.default.SLOT_HYPERLINK:e.setHyperlink(null);break;case i.default.SLOT_FORMULA:e.setFormula(null);break;case i.default.SLOT_RICH_TEXT_STYLE_RUN:e.setTextFormatRuns(null);break;case i.default.SLOT_IS_DATA_VALID:e.setIsDataValid(null);break;case i.default.SLOT_AUTHOR:e.setAuthor(null);break;case i.default.SLOT_MENTION:e.setMentionDetails(null)}for(r=t.setSlots,n=0;r>0;r>>=1,n++)if(1===(1&r))switch(n){case i.default.SLOT_EFFIECTIVE_VALUE:e.setEffectiveValue(t.delta.effectiveValue);break;case i.default.SLOT_USER_ENTERED_FORMAT_DELTA:e.setUserEnteredFormat((0,d.mergeDeltaToCellFormat)(e.getUserEnteredFormat(),t.delta.userEnteredFormatDelta));break;case i.default.SLOT_EFFIECTIVE_FORMAT_DELTA:e.setEffectiveFormat((0,d.mergeDeltaToCellFormat)(e.getEffectiveFormat(),t.delta.effectiveFormatDelta));break;case i.default.SLOT_CONDITIONAL_FORMAT_DELTA:e.setConditionalFormatResult(t.delta.conditionalFormatResult);break;case i.default.SLOT_HYPERLINK:e.setHyperlink(t.delta.hyperlink);break;case i.default.SLOT_FORMULA:e.setFormula(t.delta.formula);break;case i.default.SLOT_RICH_TEXT_STYLE_RUN:e.setTextFormatRuns(t.delta.textFormatRuns);break;case i.default.SLOT_IS_DATA_VALID:e.setIsDataValid(t.delta.isDataValid);break;case i.default.SLOT_AUTHOR:e.setAuthor(t.delta.author);break;case i.default.SLOT_MENTION:e.setMentionDetails(t.delta.mentionDetails)}return e},t.getExportFormat=c},57:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.__testExport=t.datetime2Numeric=t.supportCurrentCurrencyList=t.parseValueWithStyle=t.PARSE_MODE=void 0;var a=u(n(25));t.parseDateTimeValue=h,t.parseValue=function(e,t){return E(e,t)||_(e,t)||S(e,t)||O(e,t)||m(e,t)||g(e,t)||h(e,t)||{numericValue:e}},t.twelveNumberToText=function(e){var t=e.value&&e.value.toString()||"",n=(0,i.getCellNumberFormatType)(e.numberFormat);n&&n.type===s.default.GENERAL&&/^[+-]?\d{12,}$/.test(t)&&(e.value=t,e.valueType=d.default.STRING,e.numberFormat=new l.default({pattern:"@"}));return e},t.parseFractionValue=g,t.parseDate=p,t.isFractionValue=function(e){if(/^\-?\s*(\d*\s*\d+|\d+\s*\d*)\/\d*[1-9]\d*$/.test(e.trim()))return!0;return!1},t.isFractionFormat=function(e){if("string"===typeof e&&/^[0|#]*\s*\?+\/(?=[\d\?]+)$/.test(e.trim()))return!0;return!1},t.parseNumber=E,t.parseThousandNumber=m,t.parsePercentage=_,t.parseCurrency=S,t.parseExponential=O,t.handleLongNumber=D,t.isPrecisionBiggerThan15=M,t.isPrecisionBiggerThan16=w,t.isNumeric=A,t.compareStylePriority=function(e,t){if(e&&!t)return t;if(t&&!e)return e;if(!e&&!t)return(0,i.getDefaultNumberFormat)();var n=(0,i.getCellNumberFormatType)(e),a=(0,i.getCellNumberFormatType)(t);if(a.group===s.default.NUMBER){if(I(n.group)||n.group===s.default.GENERAL)return e}else{if(I(n.group)&&n.group===a.group)return e;if(n.type===a.type)return e}return t};var r=u(n(6)),o=u(n(309)),i=n(48),l=u(n(121)),d=u(n(223)),s=u(n(221));function u(e){return e&&e.__esModule?e:{default:e}}var f=t.PARSE_MODE={CURRENT_STYLE_FIRST:0,PARSE_STYLE_FIRST:1};function h(e,t){return R(e,t)||p(e,t)||v(e,t)}var c=t.parseValueWithStyle=function(e,t,n){var a=n&&n.parseMode||f.CURRENT_STYLE_FIRST;try{t=t||(0,i.getDefaultNumberFormat)(),n&&(n.numberFormat=t);var r=(0,i.getCellNumberFormatType)(t),o=r.type===s.default.TEXT,l=r.type===s.default.GENERAL,u=void 0,c=e,R=void 0,v=void 0;if(void 0===e||null===e||""===e||/\n/.test(e))u=void 0;else if("number"===typeof e)R=e,u={type:r.type,pattern:v=t.pattern,numericValue:e,valueType:d.default.NUMBER};else if(o)R=e,u={type:s.default.TEXT,pattern:v="@",numericValue:e,valueType:d.default.STRING};else if("string"===typeof e&&"="===e[0]&&e.length>1)R=e,u={type:r.type,pattern:v=t.pattern,numericValue:e,valueType:d.default.FORMULA};else if(a===f.CURRENT_STYLE_FIRST&&l&&M(e))R=e,u={type:s.default.TEXT,pattern:v="@",numericValue:e,valueType:d.default.STRING};else if(a===f.CURRENT_STYLE_FIRST&&/^[-]?(0|[1-9][0-9]*)(\.[0-9]*)?$/.test(e))R=e=C(e,n),u={type:r.type,pattern:v=t.pattern,numericValue:e,valueType:d.default.NUMBER};else if((u=function(e,t){var n=t&&t.numberFormat;if("string"!==typeof(e=e||""))return;var a=(0,i.getCellNumberFormatType)(n).group,r=void 0;if(r=e.match(/^(\d+)\/(\d*[1-9]\d*)$/))switch(a){case s.default.FRACTION:r=g(e,t);break;default:r=p(e,t)}if(r)return{originValue:e,numericValue:r.numericValue,type:r.type,pattern:r.pattern,valueType:r.valueType}}(e,n))?R=u.numericValue:(u=E(e,n)||_(e,n)||S(e,n)||O(e,n)||m(e,n)||g(e,n)||h(e,n))&&(R=u.numericValue),u&&a===f.PARSE_STYLE_FIRST){var T=(0,i.getCellNumberFormatType)(u.pattern);u.type===s.default.NUMBER?I(r.group)||r.group===s.default.GENERAL?(s.default.GENERAL,v="General"):(r.type,v=t.pattern):I(r.group)&&r.group===T.group?(r.type,v=t.pattern):r.type===u.type?(r.type,v=t.pattern):(u.type,v=u.pattern)}else a===f.CURRENT_STYLE_FIRST&&r.type===s.default.GENERAL&&u&&u.type!==s.default.NUMBER?(u.type,v=u.pattern):(r.type,v=t.pattern);return R!==-1/0&&R!==1/0&&u||(R=e,r.type,v=t.pattern),t=(0,i.getNumberFormatByFormatCode)(v),null!==R&&void 0!==R||(R=""),{originValue:c,value:R,numberFormat:t,valueType:u?u.valueType:d.default.STRING}}catch(x){console.warn(x);var y=e;return null!==y&&void 0!==y||(y=""),{originValue:e,value:y,numberFormat:(0,i.getDefaultNumberFormat)(),valueType:d.default.STRING}}};function I(e){switch(e){case s.default.DATE:case s.default.TIME:case s.default.DATE_TIME:return!0}return!1}function g(e,t){var n=t&&t.numberFormat,a=/^\s*[\(\uff08]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*))\s*[\)\uff09]\s*$/.exec(e);a&&a[1]&&(e="-"+a[1]);var r=e&&"string"===typeof e&&e.match(/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)$/),l=(0,i.getCellNumberFormatType)(n).group;if(r&&r[3]&&r[4]){var u=new o.default(r[3]),f=new o.default(r[4]),h=!(!r[1]||"-"!==r[1].trim());if(u.greaterThan(32767)||f.greaterThan(32767))return;var c=r[4].length,I=u.div(f),g=!!r[2];if(g){var R=new o.default(r[2].trim());I=I.plus(R)}else if(l===s.default.GENERAL||0===f.toNumber()||!g&&0===u.toNumber())return;h&&(I=I.mul(-1));var v=new Array(c+1).join("?"),p="# "+v+"/"+v;return{type:s.default.FRACTION,pattern:p,numericValue:I.toNumber(),valueType:d.default.NUMBER}}}function R(e,t){if("string"===typeof e){var n=void 0,a=void 0,o=(e=e.replace(/\//g,"-")).match(/\s*[0-9a-zA-Z\u65e5\u53f7\u6708](\s+)[0-9\u4e0a\u4e0baApP]+/);if(o&&o[0]&&o[1]){var i=o.index+1,l=e.substring(0,i);if(!/^\s+/.test(l)){l=l.replace(/\s/g,"");var u=e.substring(i,e.length).replace(/\s/g,"");u=T(u);var f=(0,r.default)(l,["YYYY-M-D","YY-M-D","M-D","D-M","YY-M","YYYY-M","YYYY\u5e74M\u6708D\u65e5","YY\u5e74M\u6708D\u65e5","YYYY\u5e74M\u6708","YY\u5e74M\u6708","M\u6708D\u65e5","YYYY.M.D","YY.M.D","YYYY\u5e74M\u6708D\u53f7","YY\u5e74M\u6708D\u53f7","M\u6708D\u53f7"],!0),h=(0,r.default)(l,["D-MMM-YYYY","D-MMM-YY","D-MMMM-YYYY","D-MMMM-YY","MMM-D","MMMM-D","MMM-YYYY","MMM-YY","MMMM-YYYY","MMMM-YY","D-MMM","D-MMMM"],"en",!0);if(!f.isValid()&&h.isValid()&&(f=h),f.isValid()){var c=(0,r.default)(u,["H:m:s","H:m","H:m:s a","H:m a","aH\u65f6m\u5206","aH\u65f6m\u5206s\u79d2","H\u65f6m\u5206s\u79d2","H\u65f6m\u5206","H:m:s.SSSS","m:s.SSSS","H:m:s.SSSS a"],!0),I=(0,r.default)("0:"+u,["H:m:s.SSSS a"],!0),g=void 0;if(c.isValid()?g=c:I.isValid()&&(g=I),g&&g.isValid()&&(new Date).getDate()===g.date()&&0!==f.year()){var R=f.format("YYYY-MM-DD")+"T"+g.format("HH:mm:ss")+"+08:00",v=F(R);return v>0&&(a=C(v,t)),void 0!==a?(n="yyyy/m/d h:mm",-1!==g._f.indexOf("s")&&(n="yyyy/m/d h:mm:ss;@"),{type:s.default.DATE_TIME,pattern:n,numericValue:a,valueType:d.default.NUMBER}):void 0}}}}}}function v(e,t){if("string"===typeof e){var n=void 0,a=void 0,o=void 0;if(e=e.replace(/\uff1a/g,":"),/^\s*[0-9]+\s*:\s*[0-9]+\s*:\s*[0-9]+(\.\d+)?\s*$/.test(e)){e=e.replace(/\s/g,"");var i=(0,r.default)(e,["H:m:s"],!0);i.isValid()?(o=i,n="h:mm:ss;@"):(i=(0,r.default)(e,["H:m:s.SSSS"],!0)).isValid()&&(o=i,n="h:mm:ss.0")}else if(/^\s*[0-9]+\s*:\s*[0-9]+(\.\d+)?\s*$/.test(e)){e=e.replace(/\s/g,"");var l=(0,r.default)(e,["H:m"],!0);l.isValid()?(o=l,n="h:mm;@"):(l=(0,r.default)(e,["m:s.SSSS"],!0)).isValid()&&(o=l,n="mm:ss.0")}else if(/^[0-9]+\s*:\s*[0-9]+\s*:\s*[0-9]+(\.\d+)?\s+(A|AM|P|PM|\u4e0a\u5348|\u4e0b\u5348)\s*$/.test(e.toUpperCase())){e=T(e=e.toUpperCase());var u=(0,r.default)(e,["H:m:s a"],!0);u.isValid()?(o=u,n="[$-409]h:mm:ss\\ AM/PM;@"):(u=(0,r.default)(e,["H:m:s.SSSS a"],!0)).isValid()&&(o=u,n="h:mm:ss.0")}else if(/^[0-9]+\s*:\s*[0-9]+(\.\d+)?\s+(A|AM|P|PM|\u4e0a\u5348|\u4e0b\u5348)$/.test(e.toUpperCase())){e=T(e=e.toUpperCase());var f=(0,r.default)(e,["H:m a"],!0);f.isValid()?(o=f,n="[$-409]h:mm AM/PM;@"):(e="0:"+e,(f=(0,r.default)(e,["H:m:s.SSSS a"],!0)).isValid()&&(o=f,n="mm:ss.0"))}else if(/^\s*(A|AM|P|PM|\u4e0a\u5348|\u4e0b\u5348)[0-9]+\u65f6[0-9]+\u5206\s*$/.test(e.toUpperCase())){e=e.toUpperCase().replace(/\s/g,"");var h=(0,r.default)(e,["aH\u65f6m\u5206"],!0);h.isValid()&&(o=h,n='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206";@')}else if(/^\s*(A|AM|P|PM|\u4e0a\u5348|\u4e0b\u5348)[0-9]+\u65f6[0-9]+\u5206[0-9]+\u79d2\s*$/.test(e.toUpperCase())){e=e.toUpperCase().replace(/\s/g,"");var c=(0,r.default)(e,["aH\u65f6m\u5206s\u79d2"],!0);c.isValid()&&(o=c,n='\u4e0a\u5348/\u4e0b\u5348h"\u65f6"mm"\u5206"ss"\u79d2";@')}else if(/^\s*[0-9]+\u65f6[0-9]+\u5206[0-9]+\u79d2$/.test(e)){e=e.replace(/\s/g,"");var I=(0,r.default)(e,["H\u65f6m\u5206s\u79d2"],!0);I.isValid()&&(o=I,n='h"\u65f6"mm"\u5206"ss"\u79d2";@')}else if(/^\s*[0-9]+\u65f6[0-9]+\u5206\s*$/.test(e)){e=e.replace(/\s/g,"");var g=(0,r.default)(e,["H\u65f6m\u5206"],!0);g.isValid()&&(o=g,n='h"\u65f6"mm"\u5206";@')}if(o){if((new Date).getDate()!==o.date())return;var R=o.format("HH:mm:ss.SSS");a=F("1899-12-31T"+R+"+08:00")}return void 0!==a?(a=C(a,t),{type:s.default.TIME,pattern:n,numericValue:a,valueType:d.default.NUMBER}):void 0}}function p(e,t){if("string"===typeof e){var n=void 0,a=void 0,o=void 0;if(e=e.replace(/\//g,"-"),/^[0-9]+\s*\-\s*[0-9]+\s*\-\s*[0-9]+\s*$/.test(e)){e=e.replace(/\s/g,"");var i=(0,r.default)(e,["YYYY-M-D","YY-M-D"],!0),l=(0,r.default)(e,["M-D-YYYY","M-D-YY"],!0);i.isValid()&&(o=i,n="yyyy/m/d"),l.isValid()&&(o=l,n="m/d/yyyy")}else if(/^[0-9]+\s*\-\s*[0-9]+\s*$/.test(e)){e=e.replace(/\s/g,"");var u=(0,r.default)(e,["M-D","D-M"],!0);u.isValid()?(o=u,n='m"\u6708"d"\u65e5";@'):(u=(0,r.default)(e,["YY-M","YYYY-M"],!0)).isValid()&&(o=u,n="mmm-yy")}else if(/^\s*[0-9]+\u5e74[0-9]+\u6708[0-9]+\u65e5\s*$/.test(e)){e=e.replace(/\s/g,"");var f=(0,r.default)(e,["YYYY\u5e74M\u6708D\u65e5","YY\u5e74M\u6708D\u65e5"],!0);f.isValid()&&(o=f,n='yyyy"\u5e74"m"\u6708"d"\u65e5";@')}else if(/^\s*[0-9]+\u5e74[0-9]+\u6708\s*$/.test(e)){e=e.replace(/\s/g,"");var h=(0,r.default)(e,["YYYY\u5e74M\u6708","YY\u5e74M\u6708"],!0);h.isValid()&&(o=h,n='yyyy"\u5e74"m"\u6708";@')}else if(/^\s*[0-9]+\u6708[0-9]+\u65e5\s*$/.test(e)){e=e.replace(/\s/g,"");var c=(0,r.default)(e,["M\u6708D\u65e5"],!0);c.isValid()&&(o=c,n='m"\u6708"d"\u65e5";@')}else if(/^[0-9]+\s*\-\s*(JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*\s*\-\s*[0-9]+\s*$/.test(e.toUpperCase())){e=e.replace(/\s/g,"");var I=(0,r.default)(e,["D-MMM-YYYY","D-MMM-YY","D-MMMM-YYYY","D-MMMM-YY"],"en",!0);I.isValid()&&(o=I,n="[$-409]d-mmm-yy;@")}else if(/^(JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*\s*\-\s*[0-9]+\s*$/.test(e.toUpperCase())){e=e.replace(/\s/g,"");var g=(0,r.default)(e,["MMM-D","MMMM-D"],"en",!0);g.isValid()?(o=g,n="d-mmm"):(o=g=(0,r.default)(e,["MMM-YYYY","MMM-YY","MMMM-YYYY","MMMM-YY"],"en",!0),n="mmm-yy")}else if(/^\s*[0-9]+\s*\-\s*(JAN|FEB|MAR|APR|MAY|JUN|JUL|AUG|SEP|OCT|NOV|DEC)[A-Z]*\s*$/.test(e.toUpperCase())){e=e.replace(/\s/g,"");var R=(0,r.default)(e,["D-MMM","D-MMMM"],"en",!0);R.isValid()&&(o=R,n="d-mmm")}else if(/^[0-9]+\s*\.\s*[0-9]+\s*\.\s*[0-9]+\s*$/.test(e)){e=e.replace(/\s/g,"");var v=(0,r.default)(e,["YYYY.M.D","YY.M.D"],!0);v.isValid()&&(o=v,n='yyyy"."m"."d')}else if(/^\s*[0-9]+\u5e74[0-9]+\u6708[0-9]+\u53f7\s*$/.test(e)){e=e.replace(/\s/g,"");var p=(0,r.default)(e,["YYYY\u5e74M\u6708D\u53f7","YY\u5e74M\u6708D\u53f7"],!0);p.isValid()&&(o=p,n='yyyy"\u5e74"m"\u6708"d"\u53f7"')}else if(/^\s*[0-9]+\u6708[0-9]+\u53f7\s*$/.test(e)){e=e.replace(/\s/g,"");var T=(0,r.default)(e,["M\u6708D\u53f7"],!0);T.isValid()&&(o=T,n='m"\u6708"d"\u53f7"')}if(o){if(0===o.year())return;var E=o.format("YYYY-MM-DDTHH:mm:ss.SSS+08:00"),m=F(E);m>0&&(a=C(m,t))}return void 0!==a?{type:s.default.DATE,pattern:n,numericValue:a,valueType:d.default.NUMBER}:void 0}}function T(e){var t=e,n=(e=e.replace(/\s/g,"")).length,a=e.substring(n-2,n).toUpperCase(),r=e[n-1].toUpperCase();return-1!==["AM","PM","\u4e0a\u5348","\u4e0b\u5348"].indexOf(a)?e.substring(0,n-2)+" "+a:-1!==["A","P"].indexOf(r)?e.substring(0,n-1)+" "+r:t}function E(e,t){var n=/^\s*[\(\uff08]\s*((\d+(\.\d+)?)|(\.\d+))\s*[\)\uff09]\s*$/.exec(e);if(n&&n[1]&&(e="-"+n[1]),/^\s*[\+\-]?\s*((\d+(\.\d*)?)|(\.\d+))\s*$/.test(e))return e=C(e=e.replace(/\s/g,""),t),{type:s.default.NUMBER,pattern:"0.00_);[Red](0.00)",numericValue:e,valueType:d.default.NUMBER}}function m(e,t){var n=/^\s*[\(\uff08]\s*(\d{1,3}([,\uff0c]\d{3})+(\.\d*)?)*\s*[\)\uff09]\s*$/.exec(e);if(n&&n[1]&&(e="-"+n[1]),n=/^\s*[\+\-]?\s*((\d{1,3})([,\uff0c]\d{3})+(\.\d*)?)\s*$/.exec(e)){var a="#,##0";-1!==(e=e.replace(/[,\uff0c\s]/g,"")).indexOf(".")&&(a="#,##0.00");var r=e=C(e,t);if(/^0{1,3}$/.test(n[2]))return;return{type:"thousand_numeral",pattern:a,numericValue:r,valueType:d.default.NUMBER}}}function _(e,t){if("string"===typeof e){var n=/^\s*[\(\uff08]\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*[\)\uff09]\s*$/.exec(e)||/^\s*[\(\uff08]\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*[\)\uff09]\s*%\s*$/.exec(e)||/^\s*[\(\uff08]\s*%\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*[\)\uff09]\s*$/.exec(e)||/^\s*%\s*[\(\uff08]\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*[\)\uff09]\s*$/.exec(e);n&&n[1]&&(e="-"+n[1]+"%");var a=void 0,r=-1!==e.indexOf(".");if(/^\s*[\+\-]?\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*%\s*$/.test(e))a=(e=e.replace(/\s/g,"")).substr(0,e.length-1);else if(/^\s*%\s*[\+\-]?\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e)||/^\s*[\+\-]?\s*%\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*$/.test(e))a=-1!==(e=e.replace(/\s/g,"")).indexOf("+")?e.substr(2,e.length):-1!==e.indexOf("-")?"-"+e.substr(2,e.length):e.substr(1,e.length);else if(/^\s*[\(\uff08]\s*((\d+\s)?(\d+)\/(\d*[1-9]\d*)(%))\s*[\)\uff09]\s*$/.test(e)||/^([+-]?\s*)(\d+\s)?(\d+)\/(\d*[1-9]\d*)(%)$/.test(e)){var i=g(e.replace(/%/g,""),t);void 0!=i&&(r="string"===typeof(a=i.numericValue)&&-1!==a.indexOf("."))}if("string"===typeof a){a=C(a=a.replace(/[,\uff0c]/g,""),t),a=new o.default(a).div(100).toString();var l=r?"0.00%":"0%";return{type:s.default.PERCENT,pattern:l,numericValue:a,valueType:d.default.NUMBER}}}}r.default.parseTwoDigitYear=function(e){var t=(new Date).getFullYear(),n=t+11,a=parseInt(e);return a+2e3<=n?a+2e3:a+1900};var y=t.supportCurrentCurrencyList=[{symbol:"\uffe5",type:"currency-chs",pattern:'"\xa5"#,##0_);[Red]\\("\xa5"#,##0\\)',pattern_decimal:'"\xa5"#,##0.00_);[Red]\\("\xa5"#,##0.00\\)'},{symbol:"\xa5",type:"currency-chs",pattern:'"\xa5"#,##0_);[Red]\\("\xa5"#,##0\\)',pattern_decimal:'"\xa5"#,##0.00_);[Red]\\("\xa5"#,##0.00\\)'},{symbol:"HK$",type:"currency-hk",pattern:"[$HK$-C04]#,##0_);[Red]\\([$HK$-C04]#,##0\\)",pattern_decimal:"[$HK$-C04]#,##0.00_);[Red]\\([$HK$-C04]#,##0.00\\)"},{symbol:"$",type:"currency-en",pattern:"\\$#,##0_);[Red]\\(\\$#,##0\\)",pattern_decimal:"\\$#,##0.00_);[Red]\\(\\$#,##0.00\\)"},{symbol:"US$",type:"currency-en",pattern:"\\U\\S\\$#,##0_);[Red]\\(\\U\\S\\$#,##0\\)",pattern_decimal:"\\U\\S\\$#,##0.00_);[Red]\\(\\U\\S\\$#,##0.00\\)"}],x=["$"];function S(e,t){if("string"===typeof e){e=e.toUpperCase();var n=/^\s*(\$|\uffe5|\xa5|HK\$|US\$)\s*[\uff08\(]\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*[\)\uff09]\s*$/.exec(e)||/^\s*[\uff08\(]\s*(\$|\uffe5|\xa5|HK\$|US\$)\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))\s*[\)\uff09]\s*$/.exec(e);n&&n[1]&&n[2]&&(e="-"+n[1]+n[2]);for(var a=0;a<y.length;a++){for(var r=y[a],o=r.symbol,i=0;i<x.length;i++)o=o.replace(x[i],"\\"+x[i]);if(new RegExp("^\\s*[+-]?\\s*"+o+"\\s*[+-]?\\s*((\\d{1,3})([,\uff0c]?\\d{3})*(\\.\\d*)?|(\\.\\d+))\\s*$").test(e)){e=e.replace(/\s/g,"").replace(r.symbol,"").replace(/[,\uff0c]/g,"");var l=r.pattern;-1!==e.indexOf(".")&&(l=r.pattern_decimal);var s=C(e,t);if(A(s))return{type:r.type,pattern:l,numericValue:s,valueType:d.default.NUMBER}}}}}function O(e,t){if("string"===typeof e){var n=/^\s*[\(\uff08]((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[\)\uff09]\s*$/.exec(e.toUpperCase());n&&n[1]&&n[6]&&(e="-"+n[1]+"E"+n[6]);(n=/^\s*[\(\uff08]((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)\s*%\s*[\)\uff09]\s*$/.exec(e.toUpperCase())||/^\s*[\(\uff08]((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))E([+-]?\d+)[\)\uff09]\s*%\s*$/.exec(e.toUpperCase()))&&n[1]&&n[6]&&(e="-"+n[1]+"E"+(Number(n[6])-2));if(n=/^\s*([+-])?\s*((\d{1,3}([,\uff0c]?\d{3})*(\.\d*)?)|(\.\d+))[Ee]([+-]?\d+)\s*(%\s*)?$/.exec(e)){var a=parseInt(n[7]);if(n[8]?(a-=2,e=""+(n[1]?n[1]:"")+n[2]+"E"+(Number(n[7])-2)):e=""+(n[1]?n[1]:"")+n[2]+"E"+n[7],!(a>=308||a<=-310)){-309===a&&(e="0");var r=e=C(e=e.replace(/[,\uff0c]/g,""),t);return{type:s.default.SCIENTIFIC,numericValue:r,pattern:"0.00E+00",valueType:d.default.NUMBER}}}}}function C(e,t){var n=D(e,void 0,t&&t.toRound);return t&&t.toRound?n:w(e)?e:parseFloat(e)}function D(e,t,n){t=t||15;var a=parseFloat(e);if(isNaN(a))return e;var r="",o=-1===(e=(e+="").trim()).indexOf("e")?e.indexOf("E"):e.indexOf("e");-1!==o&&(r=e.slice(o),e=e.slice(0,o));for(var i=e.split(""),l=0,d=0,s=!1,u=0;u<i.length;u++){var f=i[u];if("-"!==f||0!==u)if("."===f)s=!0,l>=t&&(i[u]="");else if(isNaN(parseInt(f)))i[u]="";else if(s){if(d++,(l>=t||l+d>t)&&(i[u]=""),!0===n&&l+d===t+1&&parseInt(f)>=5){var h=""===i[u-1]?u-2:u-1,c=parseInt(i[h]);isNaN(c)||(i[h]=c+1+"")}}else++l>t&&(i[u]="0"),!0===n&&l===t+1&&parseInt(f)>=5&&(i[u-1]=parseInt(i[u-1])+1+"")}return i.join("")+r}function M(e){var t=void 0;return!(!e||"string"!==typeof e||!(t=e.match(/^\s*[0]*([1-9]([0-9]*[1-9])?)[0]*\s*$/)))&&t[1].length>15}function w(e){if("number"===typeof e)return!1;if(!e)return!1;var t=e.indexOf(".");-1!==t&&(e=e.substr(0,t)+e.substr(t+1,e.length)),e.replace(/[+-]/,"");var n=(e=e.toUpperCase()).indexOf("E");-1!==n&&(e=e.substr(0,n));var a=e.match(/^[0]*([1-9]([0-9]*[1-9])?)[0]*$/);return!!(a&&a[1].length>16)}function A(e){var t="undefined"===typeof e?"undefined":(0,a.default)(e);return("string"!==t||0!==e.toLowerCase().indexOf("0x"))&&("number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&(!!e&&"number"==typeof e.valueOf()&&!(e instanceof Date)))}var F=t.datetime2Numeric=function(e){var t=(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).need_1900_2_29,n=void 0!==t&&t,a=Date.parse("1970-01-01T00:00:00.000+08:00"),r=!1;/1900-2-29/.test(e)&&(e.replace("1900-2-29","1900-3-1"),r=!0);var o=(Date.parse(e)-a)/864e5+25568;return n&&o>=60&&!r?o+1:o},k={EN:{monthsShort:["JAN(U|UA|UAR|UARY)?","FEB(R|RU|RUA|RUAR|RUARY)?","MAR(C|CH)?","APR(I|IL)?","MAY","JUN(E)?","JUL(Y)?","AUG(U|US|UST)?","SEP(T|TE|TEM|TEMB|TEMBE|TEMBER)?","OCT(O|OB|OBE|OBER)?","NOV(E|EM|EMB|EMBE|EMBER)?","DEC(E|EM|EMB|EMBE|EMBER)?"]},CN:{months:"\u4e00\u6708_\u4e8c\u6708_\u4e09\u6708_\u56db\u6708_\u4e94\u6708_\u516d\u6708_\u4e03\u6708_\u516b\u6708_\u4e5d\u6708_\u5341\u6708_\u5341\u4e00\u6708_\u5341\u4e8c\u6708".split("_"),monthsShort:"1\u6708_2\u6708_3\u6708_4\u6708_5\u6708_6\u6708_7\u6708_8\u6708_9\u6708_10\u6708_11\u6708_12\u6708".split("_"),weekdays:"\u661f\u671f\u65e5_\u661f\u671f\u4e00_\u661f\u671f\u4e8c_\u661f\u671f\u4e09_\u661f\u671f\u56db_\u661f\u671f\u4e94_\u661f\u671f\u516d".split("_"),weekdaysShort:"\u5468\u65e5_\u5468\u4e00_\u5468\u4e8c_\u5468\u4e09_\u5468\u56db_\u5468\u4e94_\u5468\u516d".split("_"),weekdaysMin:"\u65e5_\u4e00_\u4e8c_\u4e09_\u56db_\u4e94_\u516d".split("_"),longDateFormat:{LT:"HH:mm",LTS:"HH:mm:ss",L:"YYYY\u5e74MMMD\u65e5",LL:"YYYY\u5e74MMMD\u65e5",LLL:"YYYY\u5e74MMMD\u65e5Ah\u70b9mm\u5206",LLLL:"YYYY\u5e74MMMD\u65e5ddddAh\u70b9mm\u5206",l:"YYYY\u5e74MMMD\u65e5",ll:"YYYY\u5e74MMMD\u65e5",lll:"YYYY\u5e74MMMD\u65e5 HH:mm",llll:"YYYY\u5e74MMMD\u65e5dddd HH:mm"},meridiemParse:/\u4e0a\u5348|\u4e0b\u5348|AM|A|PM|P/,meridiemHour:function(e,t){return t=t.toUpperCase(),-1!==["\u4e0b\u5348","P","PM"].indexOf(t)?12===e?e:e+12:-1!==["\u4e0a\u5348","A","AM"].indexOf(t)&&12===e?0:e},calendar:{sameDay:"[\u4eca\u5929]LT",nextDay:"[\u660e\u5929]LT",nextWeek:"[\u4e0b]ddddLT",lastDay:"[\u6628\u5929]LT",lastWeek:"[\u4e0a]ddddLT",sameElse:"L"},dayOfMonthOrdinalParse:/\d{1,2}(\u65e5|\u6708|\u5468)/,ordinal:function(e,t){switch(t){case"d":case"D":case"DDD":return e+"\u65e5";case"M":return e+"\u6708";case"w":case"W":return e+"\u5468";default:return e}},relativeTime:{future:"%s\u5185",past:"%s\u524d",s:"\u51e0\u79d2",m:"1 \u5206\u949f",mm:"%d \u5206\u949f",h:"1 \u5c0f\u65f6",hh:"%d \u5c0f\u65f6",d:"1 \u5929",dd:"%d \u5929",M:"1 \u4e2a\u6708",MM:"%d \u4e2a\u6708",y:"1 \u5e74",yy:"%d \u5e74"},week:{dow:1,doy:4}}};r.default.updateLocale("en",k.EN),r.default.updateLocale("zh-cn",k.CN);t.__testExport={parseDateTime:R,parseTime:v,parseDate:p,parseExponential:O,parsePercentage:_,parseCurrency:S,parseNumber:E,parseThousandNumber:m,parseValueWithStyle:c}},62:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.BOOL=2]="BOOL",e[e.ERROR=3]="ERROR"}(a||(a={})),t.default=a},653:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(9)),r=u(n(31));t.createCell=f,t.createGridData=function(e){for(var t=e.startCol,n=e.startRow,a=e.dataSource,r=e.styles,o=e.rowLen,i=e.colLen,l=e.sheetId,d=o,s=i,u={startRow:n||0,startColumn:t||0,rowData:[],rowMetadata:[],columnMetadata:[]},h=0;h<d;h++){for(var c={values:[]},I=0;I<s;I++){var g=void 0;if(a&&r){var R=a[h]&&a[h][I],v=r[h]&&r[h][I];g=R||v?f(R,v,h,I,l):null}else g=null;g&&(c.values[I]=g)}c.values.length>0&&(u.rowData[h]=c)}return u},t.checkDataSource=function(e){if(!e||0===e.length)return;var t=void 0,n=void 0,a=void 0;for(e=e.filter(function(e){return null!=e&&void 0!=e&&Array.isArray(e)}),t=0;t<e.length;t++)for(n=0;n<e[t].length;n++)null!==(a=e[t][n])&&void 0!==a||(e[t][n]="");return e},t.checkStyles=function(e){if(!e||0===e.length)return;var t=void 0,n=void 0,a=void 0;for(e=e.filter(function(e){return null!=e&&void 0!=e&&Array.isArray(e)}),t=0;t<e.length;t++)for(n=0;n<e[t].length;n++)null!==(a=e[t][n])&&void 0!==a||(e[t][n]={style:null,prop:null},!0);return e},t.checkHideDimension=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||0===e.length)return;var o=e.length,i=e[0].length,l=void 0,d=void 0,s=!0,u=!1,f=void 0;try{for(var h,c=(0,r.default)((0,a.default)(t));!(s=(h=c.next()).done);s=!0)d=h.value,l=parseInt(d),(isNaN(l)||l>=i||l<0)&&delete t[d]}catch(T){u=!0,f=T}finally{try{!s&&c.return&&c.return()}finally{if(u)throw f}}var I=!0,g=!1,R=void 0;try{for(var v,p=(0,r.default)((0,a.default)(n));!(I=(v=p.next()).done);I=!0)d=v.value,l=parseInt(d),(isNaN(l)||l>=o||l<0)&&delete n[d]}catch(T){g=!0,R=T}finally{try{!I&&p.return&&p.return()}finally{if(g)throw R}}},t.setCellValue=h,t.checkDimansionCount=function(e,t,n){(function(e,t){var n=e.getRowCount()-1;if(t>n){var a=t-n;e.insertRows(n+1,a)}})(e,t),function(e,t){var n=e.getColCount()-1;if(t>n){var a=t-n;e.insertCols(n+1,a)}}(e,n)};var o=u(n(54)),i=u(n(62)),l=n(654),d=n(666),s=u(n(60));function u(e){return e&&e.__esModule?e:{default:e}}function f(e,t,n,a,r){var i=void 0,s=void 0;t&&(i=t.style,s=t.prop),i||(i=t);var u=new o.default;if(void 0!==e&&null!==e){var f="string";0===e.indexOf("=")&&(f="formula"),h(u,e,n,a,r,f)}return void 0!==s&&null!==s&&(0,d.setHyperlink)(u,s),void 0!==i&&null!==i&&(0,l.setCellStyle)(u,i),u}function h(e,t,n,a,r,o){"string"===typeof t&&("formula"===o?(e.setEffectiveValue(null),e.setFormula(s.default.string2FormulaModel(t,n,a,r))):e.setEffectiveValue({type:i.default.STRING,value:t}))}},654:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=m(n(9));t.setCellStyle=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(!e||!t)return;var r=e.getUserEnteredFormat();r||(r=new l.default);var v=!1;(0,a.default)(t).forEach(function(e){var n=t[e];switch(e){case"fontsize":n&&("string"===typeof n&&(n=Number(n.replace("pt",""))),r&&r.setFontSize(n));break;case"fontcolor":r&&r.setColor((0,o.hex2rgba)(n));break;case"cellcolor":r&&r.setBackgroundColor((0,o.hex2rgba)(n));break;case"bold":if("string"===typeof n){var a="bold"===n;r&&r.setBold(a)}break;case"italic":if("string"===typeof n){var l="italic"===n;r&&r.setItalic(l)}break;case"fontfamily":if(n){if(R.isMac&&(n=n),!isNaN(parseInt(n))){n=["Microsoft YaHei","Microsoft YaHei","fangsong","kaiti","song","Arial","Comic Sans MS","Courier New","Georgia","Impact","Times New Roman","Trebuchet MS","Verdana"][parseInt(n)]}r&&r.setFontFamily(n)}break;case"h_align":n&&r&&r.setHorizontalAlign(n);break;case"v_align":n&&r&&r.setVerticalAlign(n);break;case"textwrap":if(n){var d="normal"===n?g.default.WRAP:g.default.OVERFLOW_CELL;r&&r.setWrapStrategy(d)}break;case"strikeline":if("string"===typeof n&&n){var s="strikeline"===n;r&&r.setStrikethrough(s)}break;case"underline":if("string"===typeof n&&n&&"underline"===n){var u=I.default.SINGLE_LINE;r&&r.setUnderline(u)}break;case"border":case"sheetborder":case"bordertype":if(!v){var f=function(e){var t=[];e.border?t=e.border.colors:e.sheetborder&&(t=(0,i.handleBorderColors)(e.sheetborder));var n=[];e.bordertype&&(n=(0,i.handleBorderStyles)(e.bordertype));if(!t.length&&!n.length)return new E.default;return(0,i.createBorders)(t,n)}(t);r&&r.setBorders(f),v=!0}}});var p=e.getEffectiveValue(),T=t.format,m=t.format_id,y=t.format_data,x=!1,S=r&&r.getNumberFormat()||new s.default({id:m,pattern:y}),O=!1;if("t"===n.cellType&&null!=p&&_.test(p.value+""))return r&&r.setProperties({numberFormat:S.setProperties({id:m,pattern:y})}),void e.setUserEnteredFormat(r);"number"===typeof m&&0!==m&&(S.setProperties({id:m,pattern:y}),y=S.pattern,x=!0,O=!0);var C=null;if(x||T){if(!x){var D=(0,d.getFormatInfoByOldFormat)(T);y=D.pattern}var M=new s.default({pattern:y});p&&null!==p.value&&(C=(0,u.parseValueWithStyle)(p.value,M),!(0,d.isGeneralCell)(C.numberFormat)&&(0,d.isGeneralCell)(M)&&(y=C.numberFormat.pattern))}else if(p&&null!==p.value)C=(0,u.parseValueWithStyle)(p.value),y=C.numberFormat.pattern;else{var w=(0,d.getDefaultNumberFormat)();y=w.pattern}if(C)switch(C.valueType){case h.default.NUMBER:e.setEffectiveValue(new f.default({type:c.default.NUMBER,value:C.value}));break;case h.default.BOOL:e.setEffectiveValue(new f.default({type:c.default.BOOL,value:C.value}))}x&&!O||(y&&S.setProperties({pattern:y}),r&&r.setProperties({numberFormat:S}),e.setUserEnteredFormat(r));return e.setUserEnteredFormat(r),e},t.setBatchValidation=function(e,t){var n=(t.sqref+"").split(" "),a=e.properties.getGridProperties().rowCount||y,o=e.properties.getGridProperties().columnCount||x;n.forEach(function(n){var i=(0,v.getRangeWithZipString)(n);if(i)for(var l=i.from.row,d=i.to.row,s=i.from.col,u=i.to.col,f=l;f<=d;f++)if(e.data.rowData[f]&&!(f>=a))for(var h=s;h<=u;h++)if(!(h>=o)){var c=e.data.rowData[f]&&e.data.rowData[f].values[h];c||(c=new r.default,e.setCellDataAtPosition(f,h,c)),S(c,t,f,h)}})};var r=m(n(54)),o=n(155),i=n(1110),l=m(n(52)),d=n(48),s=m(n(121)),u=n(57),f=m(n(78)),h=m(n(223)),c=m(n(62)),I=m(n(185)),g=m(n(108)),R=n(22),v=n(181),p=n(655),T=n(98),E=m(n(156));function m(e){return e&&e.__esModule?e:{default:e}}var _=/(^\d+$)|(^\d+\.\d*$)/,y=200,x=26;function S(e,t,n,a){if(t&&t.type){if(!(0,T.isImportSupportType)(t.type))return;var r=(0,p.xlsx2DocumentVali)(t.operator,t.prompt,t.showDropDown,t.formula1,t.formula2,t.type,n,a),o=e.getUserEnteredFormat();if(!o){var i=new l.default;o=e.setUserEnteredFormat(i).getUserEnteredFormat()}o&&o.setDataValidation(r)}}},656:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.IPositionCenterSelfData=void 0;var a,r,o=c(n(25)),i=c(n(9)),l=c(n(0)),d=c(n(1)),s=c(n(83)),u=c(n(15)),f=n(1116),h=c(n(372));function c(e){return e&&e.__esModule?e:{default:e}}function I(e){null!=e.xRange&&(e.xRange.startIndex=+e.xRange.startIndex,e.xRange.endIndex=+e.xRange.endIndex),null!=e.yRange&&(e.yRange.startIndex=+e.yRange.startIndex,e.yRange.endIndex=+e.yRange.endIndex)}var g={ignoreInsertDimension:(a={},(0,s.default)(a,u.default.ROWS,!1),(0,s.default)(a,u.default.COLUMNS,!1),a),ignoreDeleteDimension:(r={},(0,s.default)(r,u.default.ROWS,!1),(0,s.default)(r,u.default.COLUMNS,!1),r),ignoreSetCell:!0},R=function(){function e(){(0,l.default)(this,e),this.queue=[],this.keyMap={},this.addIndex=0}return(0,d.default)(e,[{key:"add",value:function(e){var t=function(){var e=+new Date,t=void 0;return"xxxxxxxx-xxxx-4xxx-yxxx".replace(/[xy]/g,function(n){return t=(e+16*Math.random())%16|0,e=Math.floor(e/16),("x"==n?t:3&t|8).toString(16)})}();return e.key=t,this.handleConfig(e),this.queue.push(e),this.keyMap[t]=this.queue.length-1,this.addIndex++,this.addIndex>30&&(this._cleanUp(),this.addIndex=0),t}},{key:"handleConfig",value:function(e){var t=void 0,n=void 0;if(I(e.selfData),e.config&&0!==(0,i.default)(e.config).length){var a,r;if("boolean"===(0,o.default)(e.config.ignoreInsertDimension))t=e.config.ignoreInsertDimension,a={},(0,s.default)(a,u.default.ROWS,t),(0,s.default)(a,u.default.COLUMNS,t),n=a,e.config.ignoreInsertDimension=n;else void 0===e.config.ignoreInsertDimension&&(e.config.ignoreInsertDimension=g.ignoreInsertDimension);if("boolean"===(0,o.default)(e.config.ignoreDeleteDimension))t=e.config.ignoreDeleteDimension,r={},(0,s.default)(r,u.default.ROWS,t),(0,s.default)(r,u.default.COLUMNS,t),n=r,e.config.ignoreDeleteDimension=n;else void 0===e.config.ignoreDeleteDimension&&(e.config.ignoreDeleteDimension=g.ignoreDeleteDimension)}else e.config=g}},{key:"remove",value:function(e){var t=this.keyMap[e];void 0!==t&&(delete this.keyMap[e],delete this.queue[t])}},{key:"changeSelfData",value:function(e,t){var n=this.keyMap[e];void 0!==n&&(I(t),this.queue[n].selfData=t)}},{key:"_cleanUp",value:function(){var e=void 0,t=this.queue,n=this.keyMap;for(e=0;e<t.length;e++)t[e]||(t.splice(e,1),e--);for(e=0;e<t.length;e++)n[t[e].key]=e}},{key:"insertRows",value:function(e){var t=e.index,n=e.amount,a=this.queue,r=void 0,o=void 0,i=void 0,l=void 0;for(r=a.length-1;r>=0;r--)(o=a[r])&&!o.config.ignoreInsertDimension[u.default.ROWS]&&(l=!1,null!=(i=o.selfData).yRange&&i.yRange.insert(t,n)&&(l=!0),l&&o.calc(i,h.default.INSERT_ROWS,e))}},{key:"insertCols",value:function(e){var t=e.index,n=e.amount,a=this.queue,r=void 0,o=void 0,i=void 0,l=void 0;for(r=a.length-1;r>=0;r--)(o=a[r])&&!o.config.ignoreInsertDimension[u.default.COLUMNS]&&(l=!1,null!=(i=o.selfData).xRange&&i.xRange.insert(t,n)&&(l=!0),l&&o.calc(i,h.default.INSERT_COLS,e))}},{key:"deleteRows",value:function(e){var t=e.index,n=e.amount,a=this.queue,r=void 0,o=void 0,i=void 0,l=void 0;for(r=a.length-1;r>=0;r--)(o=a[r])&&!o.config.ignoreDeleteDimension[u.default.ROWS]&&(l=!1,null!=(i=o.selfData).yRange&&i.yRange.delete(t,n)&&(l=!0),l&&o.calc(i,h.default.DELETE_ROWS,e))}},{key:"deleteCols",value:function(e){var t=e.index,n=e.amount,a=this.queue,r=void 0,o=void 0,i=void 0,l=void 0;for(r=a.length-1;r>=0;r--)(o=a[r])&&!o.config.ignoreDeleteDimension[u.default.COLUMNS]&&(l=!1,null!=(i=o.selfData).xRange&&i.xRange.delete(t,n)&&(l=!0),l&&o.calc(i,h.default.DELETE_COLS,e))}},{key:"setCells",value:function(e){var t=e.gridRange,n=t.startRowIndex,a=t.endRowIndex,r=t.startColIndex,o=t.endColIndex,i=this.queue,l=void 0,d=void 0,s=void 0,u=void 0,f=void 0,c=void 0;for(l=i.length-1;l>=0;l--)(d=i[l])&&!d.config.ignoreSetCell&&(u=!1,void 0!==(s=d.selfData).xRange&&null!==s.xRange&&void 0!==s.yRange&&null!==s.yRange&&(f=s.xRange,c=s.yRange,(f.startIndex>=r&&f.startIndex<=o||r>=f.startIndex&&r<=f.endIndex||f.startIndex<0)&&(c.startIndex>=n&&c.startIndex<=a||n>=c.startIndex&&n<=c.endIndex||c.startIndex<0)&&(u=!0)),u&&d.calc(s,h.default.SET_CELLS,e))}}]),e}();t.default=R,t.IPositionCenterSelfData=f.IPositionCenterSelfData},657:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=g(n(3)),r=g(n(0)),o=g(n(1)),i=g(n(4)),l=g(n(59)),d=g(n(5)),s=g(n(15)),u=g(n(35)),f=g(n(658)),h=g(n(659)),c=g(n(374)),I=g(n(375));function g(e){return e&&e.__esModule?e:{default:e}}var R=function(e){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,r.default)(this,t),e.sheetId=e.sheetId||n.sheetId||"";var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,h.default.IMAGE,e));return o.url=e.url,e.clipInfo?e.clipInfo instanceof I.default?o.clipInfo=e.clipInfo:o.clipInfo=new I.default(e.clipInfo):o.clipInfo=new I.default,e.positionCenter&&o.active(e.positionCenter),e.previewInsertInfo&&(o.previewInsertInfo=e.previewInsertInfo),o}return(0,d.default)(t,e),(0,o.default)(t,[{key:"update",value:function(e){var n=this.position.overlayPosition,r=n.anchorCell.rowIndex!==e.y||n.anchorCell.colIndex!==e.x;(0,l.default)(t.prototype.__proto__||(0,a.default)(t.prototype),"update",this).call(this,e),this.url=e.url,e.clipInfo instanceof I.default?this.clipInfo=e.clipInfo:this.clipInfo=new I.default(e.clipInfo),r&&this.updatePositionCenter(),e.previewInsertInfo&&(this.previewInsertInfo=e.previewInsertInfo)}},{key:"active",value:function(e){this.addPositionCenter(e)}},{key:"inActive",value:function(){this.removePositionCenter()}},{key:"addPositionCenter",value:function(e){if(this.positionCenter!==e){this.positionCenter&&this.inActive(),this.positionCenter=e;var t=this.position.overlayPosition.anchorCell.rowIndex,n=this.position.overlayPosition.anchorCell.colIndex;this.positionCenterKey=e.add({type:"sheet-image",selfData:{xRange:new u.default(this.sheetId,n,n,s.default.COLUMNS),yRange:new u.default(this.sheetId,t,t,s.default.ROWS),overlayPosition:this.position.overlayPosition},calc:function(e,t,n){var a=e.xRange,r=e.yRange,o=e.overlayPosition;a.endIndex<a.startIndex&&(a.endIndex=a.startIndex),r.endIndex<r.startIndex&&(r.endIndex=r.startIndex),o.anchorCell.rowIndex=r.startIndex,o.anchorCell.colIndex=a.startIndex}})}}},{key:"removePositionCenter",value:function(){this.positionCenter&&this.positionCenterKey&&(this.positionCenter.remove(this.positionCenterKey),delete this.positionCenter)}},{key:"updatePositionCenter",value:function(){if(this.positionCenter&&this.positionCenterKey){var e=this.position.overlayPosition.anchorCell.rowIndex,t=this.position.overlayPosition.anchorCell.colIndex;this.positionCenter.changeSelfData(this.positionCenterKey,{xRange:new u.default(this.sheetId,t,t,s.default.COLUMNS),yRange:new u.default(this.sheetId,e,e,s.default.ROWS),overlayPosition:this.position.overlayPosition})}}}]),t}(f.default);R.protoMap={0:{name:"id",dataType:String},1:{name:"position",dataType:c.default},2:{name:"url",dataType:String},3:{name:"type",dataType:String},4:{name:"clipInfo",dataType:I.default}},t.default=R},658:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(373)),i=d(n(277)),l=d(n(374));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t,n){(0,a.default)(this,e),this.type=t,this.id=n.id,this.sheetId=n.sheetId,this.initEmbededObjectPosition(n)}return(0,r.default)(e,[{key:"initEmbededObjectPosition",value:function(e){if(e.position&&e.position instanceof l.default)this.position=e.position;else{var t=new o.default({rowIndex:e.y,colIndex:e.x}),n=new i.default({anchorCell:t,offsetXpixels:e.offsetX,offsetYpixels:e.offsetY,widthPixels:e.width,heightPixels:e.height,zIndex:e.zIndex});this.position=new l.default({overlayPosition:n})}}},{key:"update",value:function(e){var t=this.position.overlayPosition;t.anchorCell.rowIndex=e.y,t.anchorCell.colIndex=e.x,t.offsetXpixels=e.offsetX,t.offsetYpixels=e.offsetY,t.widthPixels=e.width,t.heightPixels=e.height,t.zIndex=e.zIndex}}]),e}();t.default=s},659:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e.IMAGE="image"}(a||(a={})),t.default=a},660:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(0),o=(a=r)&&a.__esModule?a:{default:a},i=n(33);var l=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,o.default)(this,e),this.rowCount=null!=t.rowCount?t.rowCount:i.DEFAULT_ROW_COUNT,this.columnCount=null!=t.columnCount?t.columnCount:i.DEFAULT_COL_COUNT,this.frozenRowCount=t.frozenRowCount||0,this.frozenColCount=t.frozenColCount||0,this.hideGridlines=!!t.hideGridlines,this.rowGroupControlAfter=!!t.rowGroupControlAfter,this.columnGroupControlAfter=!!t.columnGroupControlAfter};l.protoMap={0:{name:"rowCount",dataType:Number},1:{name:"columnCount",dataType:Number},2:{name:"frozenRowCount",dataType:Number},3:{name:"frozenColCount",dataType:Number},5:{name:"hideGridlines",dataType:Boolean},6:{name:"rowGroupControlAfter",dataType:Boolean},7:{name:"columnGroupCOntrolAfter",dataType:Boolean}},t.default=l},661:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(54));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(t){(0,a.default)(this,e),this.data=t}return(0,r.default)(e,null,[{key:"serialize",value:function(e,t,n){var a=e.length,r=0,i=[];return e.forEach(function(e,a){var l=[];e&&(e.values.forEach(function(e,a){e&&(l.push(a),l.push(t(e,o.default,n)))}),r=Math.max(r,e.values.length),l.length>0&&(i.push(a),i.push(l)))}),[a,r,i]}},{key:"deserialize",value:function(e,t,n){var a=e[2],r=void 0,i=[],l=void 0,d=void 0;for(l=0;l<a.length;l+=2)if(i[a[l]]={values:[]},(r=a[l+1])&&r.length>0)for(d=0;d<r.length;d+=2)r[d+1]&&(i[a[l]].values[r[d]]=t(r[d+1],o.default,n));return i}}]),e}();t.default=l},662:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(15)),i=d(n(35)),l=d(n(187));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,a.default)(this,e),this.parent=t.parent,this.ranges=t.ranges||{}}return(0,r.default)(e,[{key:"getSheetRange",value:function(e){return this.ranges[e]}},{key:"addSheetRange",value:function(e,t){var n=this;if(this.ranges[e])throw new Error("id\u91cd\u590d");return this.ranges[e]=t,this.ranges[e].gridRange.positionCenterKey=this.parent.positionCenter.add({selfData:{xRange:new i.default(t.gridRange.sheetId,t.gridRange.startColIndex,t.gridRange.endColIndex,o.default.COLUMNS),yRange:new i.default(t.gridRange.sheetId,t.gridRange.startRowIndex,t.gridRange.endRowIndex,o.default.ROWS),gridRange:t.gridRange,id:e},type:"sheet-sheetRange",calc:function(e,t,a){var r=e.xRange,o=e.yRange,i=e.gridRange;o.startIndex>o.endIndex||r.startIndex>r.endIndex?n.deleteSheetRange(e.id):(i.startRowIndex=o.startIndex,i.endRowIndex=o.endIndex,i.startColIndex=r.startIndex,i.endColIndex=r.endIndex)}}),this}},{key:"deleteSheetRange",value:function(e){if(this.ranges[e]){var t=this.ranges[e];return t.gridRange.positionCenterKey&&this.parent.positionCenter.remove(t.gridRange.positionCenterKey),delete this.ranges[e],t}return null}}]),e}();s.protoMap={0:{name:"ranges",dataType:{type:Object,subType:l.default}}},t.default=s},663:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=n(33),i=d(n(52)),l=n(48);function d(e){return e&&e.__esModule?e:{default:e}}var s=new i.default({numberFormat:(0,l.getDefaultNumberFormat)(),backgroundColor:o.DEFAULT_CELL_FORMAT_LITERAL.backgroundColor,borders:{top:{color:o.DEFAULT_CELL_FORMAT_LITERAL.borderColor},right:{color:o.DEFAULT_CELL_FORMAT_LITERAL.borderColor},bottom:{color:o.DEFAULT_CELL_FORMAT_LITERAL.borderColor},left:{color:o.DEFAULT_CELL_FORMAT_LITERAL.borderColor}},horizontalAlign:o.DEFAULT_CELL_FORMAT_LITERAL.horizontalAlign,verticalAlign:o.DEFAULT_CELL_FORMAT_LITERAL.verticalAlign,wrapStrategy:o.DEFAULT_CELL_FORMAT_LITERAL.wrapStrategy,textFormat:{color:o.DEFAULT_CELL_FORMAT_LITERAL.color,fontFamily:o.DEFAULT_CELL_FORMAT_LITERAL.fontFamily,fontSize:o.DEFAULT_CELL_FORMAT_LITERAL.fontSize,bold:o.DEFAULT_CELL_FORMAT_LITERAL.bold,italic:o.DEFAULT_CELL_FORMAT_LITERAL.italic,strikethrough:o.DEFAULT_CELL_FORMAT_LITERAL.strikethrough,underline:o.DEFAULT_CELL_FORMAT_LITERAL.underline}}),u=function(){function e(t){(0,a.default)(this,e),this.parent=t.parent,this.title=t.title||"",this.locale=t.locale||this.defaultLocale,this.timeZone=t.timeZone||this.defaultTimeZone,this.defaultFormat=t.defaultFormat||this.defaultDefaultFormat}return(0,r.default)(e,[{key:"defaultLocale",get:function(){return"zh-CN"}},{key:"defaultTimeZone",get:function(){return"Asia/Shanghai"}},{key:"defaultDefaultFormat",get:function(){return s}}]),e}();t.default=u},666:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setImportHyperlink=function(e,t){Array.isArray(t)&&t.forEach(function(t){var n=t[0],r=t[1],i=t[3],l=void 0;i&&"link"===i.type&&i.prop.linkurl&&((0,o.checkDimansionCount)(e,n,r),(l=e.getCellDataAtPosition(n,r))||(l=new a.default,e.setCellDataAtPosition(n,r,l)),l.setHyperlink(i.prop.linkurl))})},t.setHyperlink=function(e,t){if(!e||!t)return;if("link"===t.minType){var n=t.linkurl;e.setHyperlink(n);var a=e.getUserEnteredFormat();if(!a){var o=new d.default;a=e.setUserEnteredFormat(o).getUserEnteredFormat()}a&&a.setColor((0,r.hex2rgba)(i.HYPERLINK_COLOR)),a&&a.setUnderline(l.default.SINGLE_LINE)}};var a=s(n(54)),r=n(155),o=n(653),i=n(33),l=s(n(185)),d=s(n(52));function s(e){return e&&e.__esModule?e:{default:e}}},667:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=+new Date,d=(0,a.getCollabMutations)(t);i.default.speed.hasInitReport()||i.default.speed.runReport(l.SPEED_REPORT_POINTS.MUTATIONS_DESERIALIZATION,n,+new Date,!0);for(var s=void 0,u=[],f=0,h=d.length;f<h;f++)(s=d[f]).operationType=r.default.HISTORY,s.run(e,{isLocal:!0,ignoreCheck:-1===o.NOT_IGNORE_CHECK_MUTATIONS.indexOf(s.id),isReplay:!0})||u.push(s);u.length&&i.default.run(l.CONFIG.DO_MUTATIONS,u);return e};var a=n(188),r=d(n(138)),o=n(17),i=d(n(8)),l=n(26);function d(e){return e&&e.__esModule?e:{default:e}}},668:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.deserializeMutation=t.serializeMutation=void 0;var a=N(n(8)),r=n(26),o=N(n(1130)),i=N(n(40)),l=N(n(110)),d=N(n(17)),s=N(n(1131)),u=N(n(161)),f=N(n(189)),h=N(n(70)),c=N(n(67)),I=N(n(43)),g=N(n(80)),R=N(n(69)),v=N(n(190)),p=N(n(235)),T=N(n(280)),E=N(n(163)),m=N(n(233)),_=N(n(234)),y=N(n(191)),x=N(n(389)),S=N(n(390)),O=N(n(281)),C=N(n(231)),D=N(n(391)),M=N(n(232)),w=N(n(162)),A=N(n(164)),F=N(n(282)),k=N(n(236)),L=N(n(139));function N(e){return e&&e.__esModule?e:{default:e}}t.serializeMutation=function(e){var t={t:e.id,v:e.version,c:[],r:e.parentRequestId,o:e.operationType};try{t.c=e.serialize()}catch(n){a.default.run(r.CONFIG.SERIALIZE_MUTATION_CACHE_ERROR,e,n)}return t},t.deserializeMutation=function(e){var t=new D.default({sheetId:""});if(e.v>l.default.MUTATION_VER)return i.default.spreadsheetEvent.trigger(o.default.DATA_VERSION_TOO_LOW,e.v),t;if(e.v<l.default.MUTATION_VER_LOWEST_SUPPORT)throw a.default.monitor(r.MONITOR_POINTS.MUTATION_VER_LOWER_THAN_SUPPORT),new Error("Mutation version is lower than support: "+e.v);if(e.v<l.default.MUTATION_VER){try{e=(0,s.default)(e)}catch(n){console.error("Convert mutation error: ",e,n),a.default.monitor(r.MONITOR_POINTS.CONVERT_MUTATION_ERROR)}return t}try{switch(e.t){case d.default.INSERT_DIMENSION_MUTATION:t=u.default.deserialize(e.c);break;case d.default.DELETE_DIMENSION_MUTATION:t=f.default.deserialize(e.c);break;case d.default.SET_DIMENSION_PROPERTIES_MUTATION:t=h.default.deserialize(e.c);break;case d.default.SET_RANGE_MUTATION:t=c.default.deserialize(e.c);break;case d.default.SET_CELL_PROPERTIES_MUTATION:t=I.default.deserialize(e.c);break;case d.default.MERGE_CELLS_MUTATION:t=g.default.deserialize(e.c);break;case d.default.UNMERGE_CELLS_MUTATION:t=R.default.deserialize(e.c);break;case d.default.UPDATE_FILTERS_MODEL_MUTATION:break;case d.default.ADD_EMBEDDED_OBJECT_MUTATION:t=v.default.deserialize(e.c);break;case d.default.DELETE_EMBEDDED_OBJECT_MUTATION:t=p.default.deserialize(e.c);break;case d.default.UPDATE_EMBEDDED_OBJECT_MUTATION:t=T.default.deserialize(e.c);break;case d.default.INSERT_SHEET_MUTATION:case d.default.DELETE_SHEET_MUTATION:case d.default.MOVE_SHEET_MUTATION:break;case d.default.SET_SHEET_PROPERTIES_MUTATION:t=E.default.deserialize(e.c);break;case d.default.UPDATE_ALL_SHEETS_MUTATION:break;case d.default.DEFINE_SHEET_RANGE_MUTATION:t=m.default.deserialize(e.c);break;case d.default.DELETE_SHEET_RANGE_MUTATION:t=_.default.deserialize(e.c);break;case d.default.UPDATE_SHEET_RANGE_MUTATION:t=y.default.deserialize(e.c);break;case d.default.SET_WORKBOOK_PROPERTIES_MUTATION:break;case d.default.INIT_DATA_MUTATION:t=x.default.deserialize(e.c);break;case d.default.COPY_PASTE_MUTATION:t=S.default.deserialize(e.c);break;case d.default.REORDER_RANGE_MUTATION:t=O.default.deserialize(e.c);break;case d.default.MAP_RANGE_MUTATION:t=C.default.deserialize(e.c);break;case d.default.EMPTY_MUTATION:t=D.default.deserialize(e.c);break;case d.default.DEFINE_FILTER_MUTATION:t=M.default.deserialize(e.c);break;case d.default.DELETE_FILTER_MUTATION:t=w.default.deserialize(e.c);break;case d.default.UPDATE_FILTER_MUTATION:t=A.default.deserialize(e.c);break;case d.default.ADD_CONDITIONAL_FORMAT_MUTATION:t=F.default.deserialize(e.c);break;case d.default.DELETE_CONDITIONAL_FORMAT_MUTATION:t=k.default.deserialize(e.c);break;case d.default.UPDATE_CONDITIONAL_FORMAT_MUTATION:t=L.default.deserialize(e.c);break;default:console.error("Deserialize mutation fail: ",e),a.default.monitor(r.MONITOR_POINTS.DESERIALIZE_MUTATION_FAIL)}t.version=e.v,t.parentRequestId=e.r,t.operationType=e.o}catch(n){a.default.run(r.CONFIG.DESERIALIZE_MUTATION_CACHE_ERROR,e,n)}return t}},669:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.SET_SLOT=0]="SET_SLOT",e[e.CLEAR_SLOT=1]="CLEAR_SLOT",e[e.ADD_SLOT=2]="ADD_SLOT",e[e.REMOVE_SLOT=3]="REMOVE_SLOT"}(a||(a={})),t.default=a},67:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=O(n(9)),r=O(n(14)),o=O(n(3)),i=O(n(0)),l=O(n(1)),d=O(n(4)),s=O(n(59)),u=O(n(5)),f=n(113),h=O(n(17)),c=O(n(30)),I=O(n(11)),g=O(n(29)),R=n(18),v=O(R),p=O(n(39)),T=O(n(32)),E=O(n(8)),m=n(79),_=O(n(43)),y=O(n(69)),x=O(n(227)),S=n(55);function O(e){return e&&e.__esModule?e:{default:e}}var C={0:{name:"rowIndex",dataType:Number},1:{name:"colIndex",dataType:Number},2:{name:"cellDataDelta",dataType:g.default}},D=function(e){function t(e){(0,i.default)(this,t);var n=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,h.default.SET_RANGE_MUTATION,e));n.gridRange=e.gridRange,n.cellDataDeltaAtPositions=e.cellDataDeltaAtPositions;try{for(var a=0,r=n.cellDataDeltaAtPositions.length;a<r;a++)n.cellDataDeltaAtPositions[a].cellDataDelta.delta.formula&&(n.isChangeFormula=!0)}catch(l){}return n}return(0,u.default)(t,e),(0,l.default)(t,[{key:"serialize",value:function(){var e,t=new x.default,n=void 0,a={},r=void 0,o=this.gridRange.endColIndex-this.gridRange.startColIndex+1;for(n=0,e=this.cellDataDeltaAtPositions.length;n<e;n++)a[((r=this.cellDataDeltaAtPositions[n]).rowIndex-this.gridRange.startRowIndex)*o+(r.colIndex-this.gridRange.startColIndex)]=r.cellDataDelta.serialize(t);return[this.gridRange.serialize(),a,t.serializedPropertiesMap]}},{key:"getSizeEstimate",value:function(){return this.cellDataDeltaAtPositions.length}},{key:"getAffectedSheetId",value:function(){return this.gridRange.sheetId}},{key:"getAffectedSheets",value:function(e){var t=e.getSheetBySheetId(this.gridRange.sheetId);return t?[t]:[]}},{key:"check",value:function(e){if(!(0,s.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"check",this).call(this,e))return!1;if(!this.gridRange||!this.cellDataDeltaAtPositions)return!1;var n=this.gridRange,a=e.getProperties().getGridProperties();return!!((0,f.isNumber)(n.startRowIndex)&&(0,f.isNumber)(n.endRowIndex)&&(0,f.isNumber)(n.startColIndex)&&(0,f.isNumber)(n.endColIndex))&&!(n.startRowIndex<0||n.endRowIndex>=a.rowCount||n.startColIndex<0||n.endColIndex>=a.columnCount)}},{key:"run",value:function(e,n){return this.runMutationOptions={isLocal:!1},(0,r.default)(this.runMutationOptions,n),(0,s.default)(t.prototype.__proto__||(0,o.default)(t.prototype),"run",this).call(this,e,n)}},{key:"runOnSheet",value:function(e){var t,n=void 0,a=void 0,r=void 0,o=void 0,i=void 0,l=void 0;for(n=0,t=this.cellDataDeltaAtPositions.length;n<t;n++)if(a=this.cellDataDeltaAtPositions[n].rowIndex,r=this.cellDataDeltaAtPositions[n].colIndex,i=this.cellDataDeltaAtPositions[n].cellDataDelta,(o=e.getCellDataAtPosition(a,r))&&0!==o.setSlots||0!==i.setSlots){var d=null;null!=o&&(d=o.clone()),l=(0,S.mergeDeltaToCellData)(o,i),e.setCellDataAtPosition(a,r,l),e.updateMentions(d,l,a,r,this.runMutationOptions)}e.positionCenter.setCells({gridRange:this.gridRange})}},{key:"invert",value:function(e){var n,a=void 0,r=void 0,o=void 0,i=e.getSheetBySheetId(this.gridRange.sheetId),l=void 0,d=void 0,s=[];if(!i)return[];for(a=0,n=this.cellDataDeltaAtPositions.length;a<n;a++)r=this.cellDataDeltaAtPositions[a].rowIndex,o=this.cellDataDeltaAtPositions[a].colIndex,d=this.cellDataDeltaAtPositions[a].cellDataDelta,l=i.getCellDataAtPosition(r,o),s.push({rowIndex:r,colIndex:o,cellDataDelta:this.invertCellDataDelta(l,d)});return[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:s})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a,r=void 0;this.checkFormulaReport();var o=(0,m.changeGridRangeByInsertDimension)(this.gridRange,e.sheetId,e.type,e.index,e.amount,!1,!1),i=[],l=void 0,d=void 0,s=void 0;for(r=0,a=this.cellDataDeltaAtPositions.length;r<a;r++)l=this.cellDataDeltaAtPositions[r],d=new I.default(this.gridRange.sheetId,l.rowIndex,l.rowIndex,l.colIndex,l.colIndex),(s=(0,m.changeGridRangeByInsertDimension)(d,e.sheetId,e.type,e.index,e.amount,!1,!1)).endRowIndex===s.startRowIndex&&s.endColIndex===s.startColIndex&&i.push({rowIndex:s.startRowIndex,colIndex:s.startColIndex,cellDataDelta:(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e)});return 0===i.length?[]:[new t({gridRange:o,cellDataDeltaAtPositions:i})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a,r=void 0;this.checkFormulaReport();var o=(0,m.changeGridRangeByDeleteDimension)(this.gridRange,e.sheetId,e.type,e.index,e.amount);if(o.startRowIndex<o.endRowIndex||o.startColIndex<o.endColIndex)return[];var i=[],l=void 0,d=void 0,s=void 0;for(r=0,a=this.cellDataDeltaAtPositions.length;r<a;r++)l=this.cellDataDeltaAtPositions[r],d=new I.default(this.gridRange.sheetId,l.rowIndex,l.rowIndex,l.colIndex,l.colIndex),(s=(0,m.changeGridRangeByDeleteDimension)(d,e.sheetId,e.type,e.index,e.amount)).endRowIndex===s.startRowIndex&&s.endColIndex===s.startColIndex&&i.push({rowIndex:s.startRowIndex,colIndex:s.startColIndex,cellDataDelta:(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e)});return 0===i.length?[]:[new t({gridRange:o,cellDataDeltaAtPositions:i})]}},{key:"transformWithSetRangeMutation",value:function(e,n){var a=void 0,r=void 0;if(!(0,m.isTwoGridRangeCross)(this.gridRange,e.gridRange))return[this];var o=this.getTotalSlots(),i=e.getTotalSlots();if(0===((o.cellDataSetSlots|o.cellDataClearSlots)&(i.cellDataSetSlots|i.cellDataClearSlots)))return[this];if((0,m.equals)(this,e))return n?[this]:[];var l=[],d=void 0,s={},u=void 0,f=void 0;for(a=0,r=e.cellDataDeltaAtPositions.length;a<r;a++)s[u=(d=e.cellDataDeltaAtPositions[a]).rowIndex+","+d.colIndex]=d.cellDataDelta;for(a=0,r=this.cellDataDeltaAtPositions.length;a<r;a++)if(s[u=(d=this.cellDataDeltaAtPositions[a]).rowIndex+","+d.colIndex]){if((f=(0,m.transformTwoCellDataDelta)(d.cellDataDelta,s[u],n)).isEmpty())continue;l.push({rowIndex:d.rowIndex,colIndex:d.colIndex,cellDataDelta:f})}else l.push(d);return 0===l.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:l})]}},{key:"transformWithSetCellPropertiesMutation",value:function(e,n){var a,r=void 0;if(!(0,m.isTwoGridRangeCross)(this.gridRange,e.gridRange))return[this];var o=this.getTotalSlots();if(0===((o.cellDataSetSlots|o.cellDataClearSlots)&(e.cellDataDelta.setSlots|e.cellDataDelta.clearSlots)))return[this];var i=[],l=void 0,d=void 0;for(r=0,a=this.cellDataDeltaAtPositions.length;r<a;r++)if(l=this.cellDataDeltaAtPositions[r],(0,m.isCellInGridRange)(e.gridRange,l.rowIndex,l.colIndex)){if((d=(0,m.transformTwoCellDataDelta)(l.cellDataDelta,e.cellDataDelta,n)).isEmpty())continue;i.push({rowIndex:l.rowIndex,colIndex:l.colIndex,cellDataDelta:d})}else i.push(l);return 0===i.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:i})]}},{key:"transformWithMergeCellsMutation",value:function(e,n){var a,r=void 0,o=new I.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);if(!(0,m.isTwoGridRangeCross)(this.gridRange,o))return[this];var i=[],l=void 0;for(r=0,a=this.cellDataDeltaAtPositions.length;r<a;r++)if(l=this.cellDataDeltaAtPositions[r],!(0,m.isCellInGridRange)(o,l.rowIndex,l.colIndex)||l.rowIndex===o.startRowIndex&&l.colIndex===o.startColIndex)i.push(l);else if(n&&l.cellDataDelta.setSlots>0)return[new y.default(o),this];return 0===i.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:i})]}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithCopyPasteMutation",value:function(e,t){return[]}},{key:"transformWithReorderRangeMutation",value:function(e,n){var a,r=void 0;this.checkFormulaReport();var o=(0,m.getCrossGridRange)(this.gridRange,e.range);if(!o)return[this];var i=[],l=void 0,d=void 0,s=void 0,u=void 0;for(r=0,a=this.cellDataDeltaAtPositions.length;r<a;r++)if(l=this.cellDataDeltaAtPositions[r],(0,m.isCellInGridRange)(o,l.rowIndex,l.colIndex)){if(!(d=e.getOrderResult(l.rowIndex))){i.push(l);continue}u=(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e),(s=(0,m.divideCellDataDeltaByBorders)(u)).other&&!s.other.isEmpty()&&i.push({rowIndex:d,colIndex:l.colIndex,cellDataDelta:s.other}),s.borders&&!s.borders.isEmpty()&&i.push({rowIndex:l.rowIndex,colIndex:l.colIndex,cellDataDelta:s.borders})}else i.push(l);return 0===i.length?[]:[new t({gridRange:(0,m.getUnionGridRange)(this.gridRange,e.range),cellDataDeltaAtPositions:i})]}},{key:"transformWithMapRangeMutation",value:function(e,n){var a=void 0,r=void 0;this.checkFormulaReport();var o=(0,m.getCrossGridRange)(this.gridRange,new I.default(e.sourceSheetId,-1===e.row.from.startIndex?0:e.row.from.startIndex,-1===e.row.from.endIndex?Number.MAX_VALUE:e.row.from.startIndex,-1===e.column.from.startIndex?0:e.column.from.startIndex,-1===e.column.from.endIndex?Number.MAX_VALUE:e.column.from.startIndex)),i=[],l=void 0,d=[],s=void 0,u=void 0;if(!o){for(a=0,r=this.cellDataDeltaAtPositions.length;a<r;a++)l=this.cellDataDeltaAtPositions[a],i.push({rowIndex:l.rowIndex,colIndex:l.colIndex,cellDataDelta:(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e)});return 0===i.length?[]:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:i})]}for(d.push(new _.default({gridRange:o,cellDataDelta:new g.default({clearSlots:R.CELL_DATA_SLOT_COMPOSE.ALL})})),a=0,r=this.cellDataDeltaAtPositions.length;a<r;a++)l=this.cellDataDeltaAtPositions[a],(0,m.isCellInGridRange)(o,l.rowIndex,l.colIndex)?(s=-1===e.row.from.startIndex?l.rowIndex:l.rowIndex-e.row.from.startIndex+e.row.to,u=-1===e.column.from.startIndex?l.colIndex:l.colIndex-e.column.from.startIndex+e.column.to,d.push(new _.default({gridRange:new I.default(this.gridRange.sheetId,s,s,u,u),cellDataDelta:(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e)}))):i.push({rowIndex:l.rowIndex,colIndex:l.colIndex,cellDataDelta:(0,m.changeCellDataDeltaByMutation)(l.cellDataDelta,e)});return 0===i.length?d:[new t({gridRange:this.gridRange,cellDataDeltaAtPositions:i})].concat(d)}},{key:"getTotalSlots",value:function(){var e,t=void 0,n={cellDataSetSlots:0,cellDataClearSlots:0,cellFormatSetSlots:0,cellFormatClearSlots:0},a=void 0;for(t=0,e=this.cellDataDeltaAtPositions.length;t<e;t++)a=this.cellDataDeltaAtPositions[t],n.cellDataSetSlots|=a.cellDataDelta.setSlots,n.cellDataSetSlots|=a.cellDataDelta.clearSlots,a.cellDataDelta.delta.userEnteredFormatDelta&&(n.cellFormatSetSlots|=a.cellDataDelta.delta.userEnteredFormatDelta.setSlots,n.cellFormatClearSlots|=a.cellDataDelta.delta.userEnteredFormatDelta.clearSlots);return n}},{key:"invertCellDataDelta",value:function(e,t){var n=void 0,a=t.setSlots|t.clearSlots,r=new g.default,o=void 0,i=void 0;for(n=0;a>0;n++,a>>=1)if(1===(1&a))switch(n){case v.default.SLOT_EFFIECTIVE_VALUE:e&&e.getEffectiveValue()?r.setSlot(v.default.SLOT_EFFIECTIVE_VALUE,e.getEffectiveValue()):r.clearSlot(v.default.SLOT_EFFIECTIVE_VALUE);break;case v.default.SLOT_USER_ENTERED_FORMAT_DELTA:e&&e.getUserEnteredFormat()?(o=1<<v.default.SLOT_USER_ENTERED_FORMAT_DELTA,(t.clearSlots&o)>0?r.setSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA,new p.default({setSlots:e.getUserEnteredFormat().setSlots,clearSlots:0,delta:e.getUserEnteredFormat()})):(i=this.invertCellFormatDelta(e.getUserEnteredFormat(),t.delta.userEnteredFormatDelta),t.isEmpty()||r.setSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA,i))):r.clearSlot(v.default.SLOT_USER_ENTERED_FORMAT_DELTA);break;case v.default.SLOT_EFFIECTIVE_FORMAT_DELTA:e&&e.getEffectiveFormat()?(o=1<<v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,(t.clearSlots&o)>0?r.setSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,new p.default({setSlots:e.getEffectiveFormat().setSlots,clearSlots:0,delta:e.getEffectiveFormat()})):(i=this.invertCellFormatDelta(e.getEffectiveFormat(),t.delta.effectiveFormatDelta),t.isEmpty()||r.setSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA,i))):r.clearSlot(v.default.SLOT_EFFIECTIVE_FORMAT_DELTA);break;case v.default.SLOT_HYPERLINK:e&&null==e.getHyperlink()?r.setSlot(v.default.SLOT_HYPERLINK,e.getHyperlink()):r.clearSlot(v.default.SLOT_HYPERLINK);break;case v.default.SLOT_FORMULA:e&&e.getFormula()?r.setSlot(v.default.SLOT_FORMULA,e.getFormula()):r.clearSlot(v.default.SLOT_FORMULA);break;case v.default.SLOT_RICH_TEXT_STYLE_RUN:e&&e.getTextFormatRuns()?r.setSlot(v.default.SLOT_RICH_TEXT_STYLE_RUN,e.getTextFormatRuns()):r.clearSlot(v.default.SLOT_RICH_TEXT_STYLE_RUN);break;case v.default.SLOT_IS_DATA_VALID:e&&e.getIsDataValid()?r.setSlot(v.default.SLOT_IS_DATA_VALID,e.getIsDataValid()):r.clearSlot(v.default.SLOT_IS_DATA_VALID);break;case v.default.SLOT_MENTION:e&&e.getMentionDetails()?r.setSlot(v.default.SLOT_MENTION,e.getMentionDetails()):r.clearSlot(v.default.SLOT_MENTION)}return r}},{key:"invertCellFormatDelta",value:function(e,t){var n=void 0,a=t.setSlots|t.clearSlots,r=new p.default;for(n=0;a>0;n++,a>>=1)if(1===(1&a))switch(n){case T.default.NUMBER_FORMAT:e.getNumberFormat()?r.setSlot(T.default.NUMBER_FORMAT,e.getNumberFormat()):r.clearSlot(T.default.NUMBER_FORMAT);break;case T.default.BACKGROUND_COLOR:e.getBackgroundColor()?r.setSlot(T.default.BACKGROUND_COLOR,e.getBackgroundColor()):r.clearSlot(T.default.BACKGROUND_COLOR);break;case T.default.BORDER_TOP:e.getBorders()&&e.getBorders().top?r.setSlot(T.default.BORDER_TOP,e.getBorders().top):r.clearSlot(T.default.BORDER_TOP);break;case T.default.BORDER_RIGHT:e.getBorders()&&e.getBorders().right?r.setSlot(T.default.BORDER_RIGHT,e.getBorders().right):r.clearSlot(T.default.BORDER_RIGHT);break;case T.default.BORDER_BOTTOM:e.getBorders()&&e.getBorders().bottom?r.setSlot(T.default.BORDER_BOTTOM,e.getBorders().bottom):r.clearSlot(T.default.BORDER_BOTTOM);break;case T.default.BORDER_LEFT:e.getBorders()&&e.getBorders().left?r.setSlot(T.default.BORDER_LEFT,e.getBorders().left):r.clearSlot(T.default.BORDER_LEFT);break;case T.default.HORIZONTAL_ALIGN:e.getHorizontalAlign()?r.setSlot(T.default.HORIZONTAL_ALIGN,e.getHorizontalAlign()):r.clearSlot(T.default.HORIZONTAL_ALIGN);break;case T.default.VERTICAL_ALIGN:e.getVerticalAlign()?r.setSlot(T.default.VERTICAL_ALIGN,e.getVerticalAlign()):r.clearSlot(T.default.VERTICAL_ALIGN);break;case T.default.WRAP_STRATEGY:e.getWrapStrategy()?r.setSlot(T.default.WRAP_STRATEGY,e.getWrapStrategy()):r.clearSlot(T.default.WRAP_STRATEGY);break;case T.default.FOREGROUND_COLOR:e.getTextFormat()&&e.getTextFormat().color?r.setSlot(T.default.FOREGROUND_COLOR,e.getTextFormat().color):r.clearSlot(T.default.FOREGROUND_COLOR);break;case T.default.FONT_FAMINY:e.getTextFormat()&&e.getTextFormat().fontFamily?r.setSlot(T.default.FONT_FAMINY,e.getTextFormat().fontFamily):r.clearSlot(T.default.FONT_FAMINY);break;case T.default.FONT_SIZE:e.getTextFormat()&&e.getTextFormat().fontSize?r.setSlot(T.default.FONT_SIZE,e.getTextFormat().fontSize):r.clearSlot(T.default.FONT_SIZE);break;case T.default.BOLD:e.getTextFormat()&&e.getTextFormat().bold?r.setSlot(T.default.BOLD,e.getTextFormat().bold):r.clearSlot(T.default.BOLD);break;case T.default.ITALIC:e.getTextFormat()&&e.getTextFormat().italic?r.setSlot(T.default.ITALIC,e.getTextFormat().italic):r.clearSlot(T.default.ITALIC);break;case T.default.STRIKETHROUGH:e.getTextFormat()&&e.getTextFormat().strikethrough?r.setSlot(T.default.STRIKETHROUGH,e.getTextFormat().strikethrough):r.clearSlot(T.default.STRIKETHROUGH);break;case T.default.UNDERLINE:e.getTextFormat()&&e.getTextFormat().underline?r.setSlot(T.default.UNDERLINE,e.getTextFormat().underline):r.clearSlot(T.default.UNDERLINE);break;case T.default.DATA_VALIDATION:e.getDataValidation()?r.setSlot(T.default.DATA_VALIDATION,e.getDataValidation()):r.clearSlot(T.default.DATA_VALIDATION)}return r}},{key:"checkFormulaReport",value:function(){this.isChangeFormula&&E.default.monitor(34451179)}}],[{key:"deserialize",value:function(e){var n,r=void 0,o=I.default.deserialize(e[0]),i=[],l=x.default.createPropertiesMap(e[2]),d=(0,a.default)(e[1]),s=void 0,u=o.endColIndex-o.startColIndex+1,f=void 0,h=void 0;for(r=0,n=d.length;r<n;r++)f=(s=+d[r])%u+o.startColIndex,h=Math.floor(s/u)+o.startRowIndex,i.push({rowIndex:h,colIndex:f,cellDataDelta:g.default.deserialize(e[1][s],l)});return new t({gridRange:o,cellDataDeltaAtPositions:i})}}]),t}(c.default);D.protoMap={0:{name:"gridRange",dataType:I.default},1:{name:"cellDataDeltaAtPositions",dataType:{type:Array,subType:{type:Object,protoMap:C}}}},t.default=D},688:function(e,t,n){"use strict";var a;Object.defineProperty(t,"__esModule",{value:!0}),function(e){e[e.FONT_FAMINY=0]="FONT_FAMINY",e[e.FONT_SIZE=1]="FONT_SIZE",e[e.BOLD=2]="BOLD",e[e.ITALIC=3]="ITALIC",e[e.WRAP_STRATEGY=4]="WRAP_STRATEGY",e[e.HORIZONTAL_ALIGN=5]="HORIZONTAL_ALIGN",e[e.VERTICAL_ALIGN=6]="VERTICAL_ALIGN",e[e.COLOR=7]="COLOR",e[e.BACKGROUND_COLOR=8]="BACKGROUND_COLOR",e[e.STRIKE_THROUGH=9]="STRIKE_THROUGH",e[e.UNDERLINE=10]="UNDERLINE"}(a||(a={}));var r={ALL:Math.pow(2,a.UNDERLINE+1)-1};t.default=a,t.FORMAT_ITEM_COMPOSE=r},69:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(3)),r=T(n(0)),o=T(n(1)),i=T(n(4)),l=T(n(5));t.getUnmergeCellsMutation=function(e,t){var n=t.getMerges(),a=void 0,r=[],o=void 0,i=void 0,l=void 0,d=void 0,s=void 0,u=void 0,f=void 0;for(a=0;a<n.length;a++)o=n[a],e.isCross(o)&&(r.push(new E({startRowIndex:o.startRowIndex,endRowIndex:o.endRowIndex,startColIndex:o.startColIndex,endColIndex:o.endColIndex,sheetId:o.sheetId})),s=t.getCellDataAtPosition(o.startRowIndex,o.startColIndex),f=null!==s?(0,p.createCellFormatDelta)(null,s.getUserEnteredFormat(),c.CELL_FORMAT_SLOT_COMPOSE.ALL):null,(u=new v.default).setSlot(g.default.SLOT_USER_ENTERED_FORMAT_DELTA,f),i=new R.default({cellDataDelta:u,gridRange:new h.default(o.sheetId,o.startRowIndex,o.endRowIndex,o.startColIndex,o.endColIndex)}),(l=i.cellDataDelta.delta.userEnteredFormatDelta)&&l.delta.getBorders()&&((d=l.delta.getBorders()).top&&(l.setSlots-=1<<I.default.BORDER_TOP,d.top=null),d.right&&(l.setSlots-=1<<I.default.BORDER_RIGHT,d.right=null),d.bottom&&(l.setSlots-=1<<I.default.BORDER_BOTTOM,d.bottom=null),d.left&&(l.setSlots-=1<<I.default.BORDER_LEFT,d.left=null)),r.push(i));return r};var d=T(n(17)),s=T(n(30)),u=T(n(15)),f=T(n(80)),h=T(n(11)),c=n(32),I=T(c),g=T(n(18)),R=T(n(43)),v=T(n(29)),p=n(229);function T(e){return e&&e.__esModule?e:{default:e}}var E=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.UNMERGE_CELLS_MUTATION,e));return n.sheetId=e.sheetId,n.startRowIndex=e.startRowIndex,n.endRowIndex=e.endRowIndex,n.startColIndex=e.startColIndex,n.endColIndex=e.endColIndex,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){if(!new h.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isValid())return!1;var t=e.getProperties().getGridProperties();return!(this.endRowIndex>=t.rowCount||this.endColIndex>=t.columnCount)}},{key:"runOnSheet",value:function(e){e.removeMerge(new h.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex))}},{key:"invert",value:function(e){return[new f.default({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a=new h.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return e.type===u.default.ROWS?a.insertRows(e.index,e.amount):a.insertCols(e.index,e.amount),[new t({startRowIndex:a.startRowIndex,endRowIndex:a.endRowIndex,startColIndex:a.startColIndex,endColIndex:a.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=new h.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return e.type===u.default.ROWS?a.deleteRows(e.index,e.amount):a.deleteCols(e.index,e.amount),[new t({startRowIndex:a.startRowIndex,endRowIndex:a.endRowIndex,startColIndex:a.startColIndex,endColIndex:a.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){var n=[];return this.sheetId===e.sheetId&&this.startRowIndex===e.startRowIndex&&this.endRowIndex===e.endRowIndex&&this.startColIndex===e.startColIndex&&this.endColIndex===e.endColIndex||n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})}}]),t}(s.default);E.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.default=E},697:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transform=void 0;var a=o(n(24)),r=o(n(110));function o(e){return e&&e.__esModule?e:{default:e}}t.transform=function e(t,n,o){var i=void 0,l=void 0,d=void 0,s=void 0,u=t,f=void 0,h=void 0,c=void 0,I=void 0,g=void 0;try{for(i=0,s=n.length;i<s;i++)if(h=[n[i]],c=[],0!==h.length){for(l=0,d=t.length;l<d;l++)f=t[l],h.length>1?(I=e([f],h,o),l<d-1&&(g=e(h,[f],!o))):1===h.length?(I=f.transform(h[0],o),f.version===r.default.MUTATION_VER_LOWEST_SUPPORT&&h[0].version===r.default.MUTATION_VER_LOWEST_SUPPORT&&I.forEach(function(e){e.version=r.default.MUTATION_VER_LOWEST_SUPPORT}),l<d-1&&(g=h[0].transform(f,!o),f.version===r.default.MUTATION_VER_LOWEST_SUPPORT&&h[0].version===r.default.MUTATION_VER_LOWEST_SUPPORT&&g.forEach(function(e){e.version=r.default.MUTATION_VER_LOWEST_SUPPORT}))):(I=[f],g=[]),l<d-1&&(h=g),c=[].concat((0,a.default)(c),(0,a.default)(I));t=c}}catch(R){return console.error("transform two mutation array error: ",R),u}return u=t}},699:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getSetRangeMutation=function(e,t){var n=void 0,i=void 0,l=void 0,d=void 0,s=[],u=void 0,f=e.getSheetId();for(i=t.startRowIndex;i<=t.endRowIndex;i++)for(n=t.startColIndex;n<=t.endColIndex;n++)null!==(l=e.getCellDataAtPosition(i,n))&&null!==l.getMergeReference()&&(u=l.getMergeReference(),l=e.getCellDataAtPosition(u.startRowIndex,u.startColIndex)),d=(0,r.createCellDataDelta)({cellData:null,sheetId:f},{cellData:l,sheetId:f},1<<a.default.SLOT_USER_ENTERED_FORMAT_DELTA),s.push({rowIndex:i,colIndex:n,cellDataDelta:d});return new o.default({gridRange:t,cellDataDeltaAtPositions:s})};var a=i(n(18)),r=n(55),o=i(n(67));function i(e){return e&&e.__esModule?e:{default:e}}},70:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.DIMENSION_PROPERTIES_SLOT=void 0;var a=v(n(3)),r=v(n(0)),o=v(n(1)),i=v(n(4)),l=v(n(5));t.getSetDimensionPropertiesMutation=y,t.DimensionPropertiesToOperation=x;var d=v(n(669)),s=v(n(17)),u=v(n(30)),f=v(n(15)),h=v(n(35)),c=v(n(228)),I=n(79),g=n(231),R=v(n(276));function v(e){return e&&e.__esModule?e:{default:e}}var p=t.DIMENSION_PROPERTIES_SLOT=void 0;!function(e){e[e.SLOT_SIZE=1]="SLOT_SIZE",e[e.SLOT_HIDDEN=2]="SLOT_HIDDEN",e[e.SLOT_FORMDATA=3]="SLOT_FORMDATA"}(p||(t.DIMENSION_PROPERTIES_SLOT=p={}));var T={0:{name:"slot",dataType:Number},1:{name:"size",dataType:Number},2:{name:"hidden",dataType:Number},3:{name:"formData",dataType:R.default}},E=function(e){var t=[e.slot,null!=e.slotOperation?e.slotOperation:d.default.SET_SLOT];switch(e.slot){case p.SLOT_SIZE:t[2]=e.size;break;case p.SLOT_HIDDEN:t[2]=e.hidden;break;case p.SLOT_FORMDATA:t[2]=e.formData?e.formData.serialize():null}return t},m=function(e){var t={slot:e[0],slotOperation:e[1]};switch(e[0]){case p.SLOT_SIZE:t.size=e[2];break;case p.SLOT_HIDDEN:t.hidden=e[2];break;case p.SLOT_FORMDATA:t.formData=e[2]?R.default.deserialize(e[2]):null}return t},_=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,s.default.SET_DIMENSION_PROPERTIES_MUTATION,e));n.ranges=[];for(var o=0;o<e.ranges.length;o++)e.ranges[o].endIndex>=e.ranges[o].startIndex&&n.ranges.push(e.ranges[o]);return n.operation=e.operation,n.type=e.type,n.sheetId=e.sheetId,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){var e=void 0,t=void 0,n=[],a=[];for(e=0,t=this.ranges.length;e<t;e++)n.push([this.ranges[e].startIndex,this.ranges[e].endIndex]);for(e=0,t=this.operation.length;e<t;e++)a.push(E(this.operation[e]));return[this.sheetId,n,a,this.type]}},{key:"getSizeEstimate",value:function(){return this.ranges.length}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){if(!this.ranges||!this.operation)return!1;var t,n=void 0,a=this.ranges,r=void 0,o=e.getProperties().getGridProperties();if(this.type!==f.default.ROWS&&this.type!==f.default.COLUMNS)return!1;for(n=0,t=a.length;n<t;n++){if(!(r=a[n]).isValid())return!1;if(this.type===f.default.ROWS){if(r.endIndex>=o.rowCount)return!1}else if(this.type===f.default.COLUMNS&&r.endIndex>=o.columnCount)return!1}return!0}},{key:"runOnSheet",value:function(e){for(var t=0;t<this.operation.length;t++)switch(this.operation[t].slot){case p.SLOT_SIZE:this.setDimensionSize(e,this.operation[t]);break;case p.SLOT_HIDDEN:this.setDimensionHidden(e,this.operation[t]);break;case p.SLOT_FORMDATA:this.setDimensionFormData(e,this.operation[t])}}},{key:"setDimensionFormData",value:function(e,t){var n=this,a=void 0,r=void 0;this.ranges.forEach(function(o){a=o.startIndex,r=o.endIndex,n.type===f.default.ROWS?e.setRowsFormData(a,r,t.formData):n.type===f.default.COLUMNS&&e.setColsFormData(a,r,t.formData)})}},{key:"setDimensionSize",value:function(e,t){var n=this,a=void 0,r=void 0;this.ranges.forEach(function(o){a=o.startIndex,r=o.endIndex,n.type===f.default.ROWS?e.setRowsHeight(a,r,t.size):n.type===f.default.COLUMNS&&e.setColsWidth(a,r,t.size)})}},{key:"setDimensionHidden",value:function(e,t){for(var n=0,a=void 0;n<this.ranges.length;n++)a=this.ranges[n],this.type===f.default.ROWS?t.hidden?e.hideRows(a.startIndex,a.endIndex):e.showRows(a.startIndex,a.endIndex):this.type===f.default.COLUMNS&&(t.hidden?e.hideCols(a.startIndex,a.endIndex):e.showCols(a.startIndex,a.endIndex))}},{key:"invert",value:function(e){for(var t=[],n=e.getSheetBySheetId(this.sheetId),a=0,r=[];a<this.operation.length;a++){switch(r=[],this.operation[a].slot){case p.SLOT_SIZE:r=y({sheet:n,type:this.type,ranges:this.ranges},{pixelSize:!0,ignoreDefaultSize:!1});break;case p.SLOT_HIDDEN:r=y({sheet:n,type:this.type,ranges:this.ranges},{hiddenByUser:!0});break;case p.SLOT_FORMDATA:r=y({sheet:n,type:this.type,ranges:this.ranges},{formData:!0})}Array.prototype.push.apply(t,r)}return t}},{key:"isConflict",value:function(e){return this.sheetId===e.sheetId&&this.type===e.type}},{key:"transformWithInsertDimensionMutation",value:function(e,n){if(!this.isConflict(e))return[this];for(var a=[],r=0,o=void 0,i=[];r<this.ranges.length;r++)(o=this.ranges[r].clone()).insert(e.index,e.amount),i.push(o);return a.push(new t({ranges:i,operation:this.operation,type:this.type,sheetId:this.sheetId})),a}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){if(!this.isConflict(e))return[this];for(var a=[],r=0,o=void 0,i=[];r<this.ranges.length;r++)(o=this.ranges[r].clone()).delete(e.index,e.amount),o.endIndex<o.startIndex||i.push(o);return 0===i.length?a:(a.push(new t({ranges:i,operation:this.operation,type:this.type,sheetId:this.sheetId})),a)}},{key:"transformWithSetDimensionPropertiesMutation",value:function(e,n){if(!this.isConflict(e))return[this];var a=0,r=0,o=0,i=[],l=[],d=void 0;for(a=0;a<this.operation.length;a++){for(r=0;r<e.operation.length;r++)if(this.operation[a].slot===e.operation[r].slot){for(d=(0,I.crossRanges)(this.ranges,e.ranges,n),o=0;o<d.length;o++)l=d[o],i.push(new t({ranges:l,operation:[this.operation[a]],type:this.type,sheetId:this.sheetId}));r=0;break}0!==r&&i.push(new t({ranges:this.ranges,operation:[this.operation[a]],type:this.type,sheetId:this.sheetId}))}return i}},{key:"transformWithMapRangeMutation",value:function(e,n){var a=[],r=0,o=[],i=void 0,l=void 0;if((0,g.checkMapRangeIsDimension)(this.type,e)){if(this.type===f.default.ROWS)i=e.row;else{if(this.type!==f.default.COLUMNS)return console.warn("DIMENSION_TYPE error"),a;i=e.column}for(;r<this.ranges.length;r++)l=this.ranges[r].clone(),Array.prototype.push.apply(o,l.move({from:i.from,to:i.to}));a.push(new t({ranges:o,operation:this.operation,type:this.type,sheetId:this.sheetId}))}else a.push(this);return a}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}}],[{key:"deserialize",value:function(e){var n=void 0,a=void 0,r=[],o=[];for(n=0,a=e[1].length;n<a;n++)r.push(new h.default(e[0],e[1][n][0],e[1][n][1],e[3]));for(n=0,a=e[2].length;n<a;n++)o.push(m(e[2][n]));return new t({sheetId:e[0],ranges:r,operation:o,type:e[3]})}}]),t}(u.default);function y(e,t){var n=[],a=e.sheet,r=e.type,o=e.ranges;t||(t={hiddenByUser:!0,pixelSize:!0,ignoreDefaultHidden:!0,ignoreDefaultSize:!0,formData:!0});var i=void 0,l=0,d=0,s=void 0,u=void 0,I=0,g=void 0,R=void 0,v=void 0,p=void 0;for(v=r===f.default.ROWS?a.getRowProperties.bind(a):a.getColProperties.bind(a),l=0;l<o.length;l++)for(s=(i=o[l]).startIndex,u=i.endIndex,I=0,R=g=v(s)||new c.default,d=s;d<=u;d++)(g=v(d)||new c.default).equal(R,t)?(d===u&&0!==(p=x(g,r,t)).length&&n.push(new _({ranges:[new h.default(i.sheetId,d-I,d,r)],operation:x(g,r,t),type:r,sheetId:i.sheetId})),I++):(0!==(p=x(R,r,t)).length&&n.push(new _({ranges:[new h.default(i.sheetId,d-I,d-1,r)],operation:p,type:r,sheetId:i.sheetId})),d===u&&0!==(p=x(g,r,t)).length&&n.push(new _({ranges:[new h.default(i.sheetId,d,d,r)],operation:x(g,r,t),type:r,sheetId:i.sheetId})),R=g);return n}function x(e,t,n){var a=[];return n.pixelSize&&(e.pixelSize?a.push({slot:p.SLOT_SIZE,size:e.pixelSize}):n.clearDefaultSize?a.push({slot:p.SLOT_SIZE,size:null}):n.ignoreDefaultSize||a.push({slot:p.SLOT_SIZE,size:null})),n.hiddenByUser&&(e.hiddenByUser?a.push({slot:p.SLOT_HIDDEN,hidden:1}):n.ignoreDefaultHidden||a.push({slot:p.SLOT_HIDDEN,hidden:0})),n.formData&&(e.formData?a.push({slot:p.SLOT_FORMDATA,formData:e.formData}):a.push({slot:p.SLOT_FORMDATA,formData:null})),a}_.protoMap={0:{name:"sheetId",dataType:String},1:{name:"ranges",dataType:{type:Array,subType:h.default}},2:{name:"operation",dataType:{type:Array,subType:{type:Object,protoMap:T}}},3:{name:"type",dataType:String}},t.default=_},700:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=A(n(204)),r=A(n(84)),o=A(n(3)),i=A(n(0)),l=A(n(1)),d=A(n(4)),s=A(n(5));t.intersectWithMergeAndForm=F,t.intersectWithMergeAndFreezeBorder=function(e,t){var n=!1,a=void 0,r=void 0,o=void 0,i=void 0,l=void 0;for(l=0;l<e.length;l++)if(i=e[l],null!==(a=t.getSheetBySheetId(i.sheetId))&&(r=a.getFrozenColCount()||0,o=a.getFrozenRowCount()||0,r>i.startColIndex&&r<=i.endColIndex||o>i.startRowIndex&&o<=i.endRowIndex))return n=!0;return n},t.intersectWithMergeAndFilter=k;var u=A(n(20)),f=n(80),h=A(f),c=A(n(43)),I=A(n(11)),g=A(n(29)),R=n(69),v=n(18),p=A(v),T=n(55),E=A(n(67)),m=n(33),_=A(n(156)),y=n(32),x=A(y),S=A(n(39)),O=A(n(52)),C=n(241),D=A(n(13)),M=A(n(7)),w=A(n(234));function A(e){return e&&e.__esModule?e:{default:e}}function F(e,t){var n=void 0,a=void 0,r=void 0,o=0;for(r=0;r<e.length;r++){var i=M.default.window.SpreadsheetApp.plugins.rmap;if(a=e[r],null!==(n=t.getSheetBySheetId(a.sheetId))&&i&&i.isRelated(a.sheetId))if(n.data&&n.data.rowData||!1){var l=n.data.rowMetadata,d=n.data.columnMetadata;if(o=i.checkReleaseRange(a,l,d,4))return 4===o}}return!1}function k(e,t){var n=void 0,a=void 0,r=void 0,o=void 0;for(o=0;o<e.length;o++)if(r=e[o],null!==(n=t.getSheetBySheetId(r.sheetId))&&null!==(a=n.getBasicFilter())){var i=a.range,l=i.startRowIndex,d=(i.endRowIndex,i.startColIndex),s=i.endColIndex,u=new I.default(i.sheetId,l,l,d,s);if(r.isCross(u))return!0}return!1}var L=function(e){function t(e,n){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,n));a.sheetId=e.sheetId,e.gridRanges?a.behaviors=e.gridRanges:n&&(a.behaviors=n.rangeSelections);var r=void 0,l=void 0,s=void 0,u=[];e:for(r=0;r<a.behaviors.length;r++)for(s=a.behaviors[r],l=0;l<a.behaviors.length;l++)if(r!==l&&s.isCross(a.behaviors[l])){u.push(r);break e}if(u.length>0)for(l=0,r=0;r<u.length;r++)a.behaviors.splice(u[r]+l),l--;return a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"check",value:function(e){var t=null,n=void 0,a=void 0,r=void 0,o=void 0;if(k(this.behaviors,e))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5408\u5e76\u5355\u5143\u683c\u6682\u4e0d\u80fd\u5305\u542b\u7b5b\u9009\u6309\u94ae\u6240\u5728\u7684\u4f4d\u7f6e\uff0c\u8bf7\u89e3\u9664\u7b5b\u9009\u4e4b\u540e\u91cd\u8bd5\u3002"}};if(F(this.behaviors,e))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u64cd\u4f5c\u88ab\u7981\u6b62\u3002\u65e0\u6cd5\u5408\u5e76\u5305\u542b\u6536\u96c6\u8868\u95ee\u9898\u6216\u6570\u636e\u7684\u5355\u5143\u683c\u3002",btnTxt:"\u6211\u77e5\u9053\u4e86"}};var i=void 0;for(r=0;r<this.behaviors.length;r++)for(a=this.behaviors[r],i=(n=e.getSheetBySheetId(a.sheetId)).getMerges(),o=0;o<i.length;o++)if(i[o].isCross(a))return t={isWarningOnly:!1,error:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u60a8\u5fc5\u987b\u9009\u62e9\u5408\u5e76\u5355\u5143\u683c\u8303\u56f4\u5185\u7684\u6240\u6709\u5355\u5143\u683c\u6216\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u3002"}};var l=void 0,d=void 0,s=void 0,u=void 0;for(r=0;r<this.behaviors.length;r++)if(a=this.behaviors[r],null!==(n=e.getSheetBySheetId(a.sheetId)))for(u=0,d=a.startRowIndex;d<=a.endRowIndex;d++)for(l=a.startColIndex;l<=a.endColIndex;l++)if(null!==(s=n.getCellDataAtPosition(d,l))&&(null!==s.getEffectiveValue()&&""!==s.getEffectiveValue().value||null!==s.getFormula())&&++u>1)return t={isWarningOnly:!0,warning:{title:"\u51fa\u73b0\u95ee\u9898",content:"\u5408\u5e76\u540e\u7684\u5355\u5143\u683c\u5c06\u53ea\u4fdd\u7559\u5de6\u4e0a\u89d2\u5355\u5143\u683c\u4e2d\u7684\u503c\uff0c\u7ee7\u7eed\u5408\u5e76\u5417\uff1f"}};return t}},{key:"do",value:function(e,t,n){var a,r,o,i=this,l=e.startRowIndex,d=e.endRowIndex,s=e.startColIndex,u=e.endColIndex,p=e,m=t.getSheetBySheetId(this.sheetId),_=void 0,x=void 0,S=void 0,O=void 0,C=void 0,D=void 0,M=void 0,A={row:0,column:0};if(m){e:for(_=l;_<=d;_++)for(x=s;x<=u;x++)if(null!==(S=m.getCellDataAtPosition(_,x))&&S.getEffectiveValue()&&""!==S.getEffectiveValue().value){if(_!==l||x!==s)break e;break e}for(_>d&&(_=l,x=s),A.row=_,A.column=x,this.parent=A,a=(0,R.getUnmergeCellsMutation)(p,m),_=0;_<a.length;_+=2)n(a[_]);for(o=this.checkMergeBorders(e,m),this.parent.row===l&&this.parent.column===s||(C=m.getCellDataAtPosition(l,s),D=m.getCellDataAtPosition(this.parent.row,this.parent.column),M=(0,T.createCellDataDelta)({cellData:C,rowIndex:l,colIndex:s,sheetId:this.sheetId},{cellData:D,rowIndex:this.parent.row,colIndex:this.parent.column,sheetId:this.sheetId},v.CELL_DATA_SLOT_COMPOSE.ALL,y.CELL_FORMAT_SLOT_COMPOSE.ALL,{formulaRelative:!0}),null!==(O=new E.default({gridRange:new I.default(this.sheetId,l,l,s,s),cellDataDeltaAtPositions:[{rowIndex:l,colIndex:s,cellDataDelta:M}]})).cellDataDeltaAtPositions[0].cellDataDelta.delta.userEnteredFormatDelta&&void 0!==O.cellDataDeltaAtPositions[0].cellDataDelta.delta.userEnteredFormatDelta&&O.cellDataDeltaAtPositions[0].cellDataDelta.delta.userEnteredFormatDelta.delta.clearBorders()),O&&n(O),r=(0,f.getMergedGridRange)(p),_=0;_<r.length;_++){var F=r[_];n(new c.default({gridRange:F,cellDataDelta:new g.default({setSlots:0,clearSlots:v.CELL_DATA_SLOT_COMPOSE.ALL,delta:{}})})),F.each(function(e,t){var a=m.getCellDataAtPosition(e,t);a&&(a.getSheetRange()||[]).forEach(function(e){var t=e.id;n(new w.default({sheetId:i.sheetId,sheetRangeId:t,nonPersistingLocalChange:!1}))})})}o&&n(o),n(new h.default({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:this.sheetId}))}}},{key:"checkMergeBorders",value:function(e,t){var n,o=e.startRowIndex,i=e.endRowIndex,l=e.startColIndex,d=e.endColIndex,s=void 0,u={top:void 0,right:void 0,bottom:void 0,left:void 0},f=void 0,h=void 0,c=[],R=[],v=!0;for(this.parent.row!=o||this.parent.column!=l?v=!1:((0,C.getCellBorder)(t,this.parent.row,this.parent.column,m.BORDER_TYPE.LEFT,!0)||(0,C.getCellBorder)(t,this.parent.row,this.parent.column,m.BORDER_TYPE.TOP,!0))&&(v=!1),f=l;f<=d;f++){if(null===(s=(0,C.getCellBorder)(t,o,f,m.BORDER_TYPE.TOP,!0))){u.top=null;break}if(void 0===u.top)u.top=s;else{if(null===u.top)break;if(!u.top.equal(s)){u.top=null;break}}}for(f=o;f<=i;f++){if(null===(s=(0,C.getCellBorder)(t,f,l,m.BORDER_TYPE.LEFT,!0))){u.left=null;break}if(void 0===u.left)u.left=s;else{if(null===u.left)break;if(!u.left.equal(s)){u.left=null;break}}}var T=!0,_=!1;for(f=o;f<=i;f++)if(null!==(s=(0,C.getCellBorder)(t,f,d,m.BORDER_TYPE.RIGHT,!0)))if(T=!1,void 0===u.right)u.right=s;else{if(null===u.right)break;if(!u.right.equal(s)){u.right=null;break}}else u.right=null;T&&v&&(u.right=(0,C.getCellBorder)(t,this.parent.row,this.parent.column,m.BORDER_TYPE.RIGHT,!1),null!==u.right&&(_=!0));var y=!0,x=!1;for(f=l;f<=d;f++)if(null!==(s=(0,C.getCellBorder)(t,i,f,m.BORDER_TYPE.BOTTOM,!0)))if(y=!1,void 0===u.bottom)u.bottom=s;else{if(null===u.bottom)break;if(!u.bottom.equal(s)){u.bottom=null;break}}else u.bottom=null;for(y&&v&&(u.bottom=(0,C.getCellBorder)(t,this.parent.row,this.parent.column,m.BORDER_TYPE.BOTTOM,!1),null!==u.bottom&&(x=!0)),n=new I.default(t.getSheetId(),o,i,l,d),f=o;f<=i;f++)for(h=l;h<=d;h++)R.length=0,f===o?(R.push(m.BORDER_TYPE.TOP),h===l&&R.push(m.BORDER_TYPE.LEFT),h===d&&R.push(m.BORDER_TYPE.RIGHT),f===i&&R.push(m.BORDER_TYPE.BOTTOM)):f===i?(R.push(m.BORDER_TYPE.BOTTOM),h===l&&R.push(m.BORDER_TYPE.LEFT),h===d&&R.push(m.BORDER_TYPE.RIGHT)):h===l?(R.push(m.BORDER_TYPE.LEFT),h===d&&R.push(m.BORDER_TYPE.RIGHT)):h===d?R.push(m.BORDER_TYPE.RIGHT):R=[],x&&R.push(m.BORDER_TYPE.BOTTOM),_&&R.push(m.BORDER_TYPE.RIGHT),R=(0,r.default)(new a.default(R)),c.push({rowIndex:f,colIndex:h,cellDataDelta:new g.default({setSlots:1<<p.default.SLOT_USER_ENTERED_FORMAT_DELTA,clearSlots:0,delta:{userEnteredFormatDelta:new S.default({setSlots:this.getSetSlots(R),clearSlots:this.getClearSlots(R),delta:new O.default({borders:this.getBorders(R,u)})})}})});return new E.default({gridRange:n,cellDataDeltaAtPositions:c})}},{key:"getBorders",value:function(e,t){var n={},a=void 0;for(a=0;a<e.length;a++)t[e[a]]&&(n[e[a]]={color:t[e[a]].color,style:t[e[a]].style});return new _.default(n)}},{key:"getSetSlots",value:function(e){var t=0,n=void 0;for(n=0;n<e.length;n++)switch(e[n]){case m.BORDER_TYPE.TOP:t+=1<<x.default.BORDER_TOP;break;case m.BORDER_TYPE.RIGHT:t+=1<<x.default.BORDER_RIGHT;break;case m.BORDER_TYPE.BOTTOM:t+=1<<x.default.BORDER_BOTTOM;break;case m.BORDER_TYPE.LEFT:t+=1<<x.default.BORDER_LEFT}return t}},{key:"getClearSlots",value:function(e){var t=0,n=void 0;for(t+=1<<x.default.BORDER_TOP,t+=1<<x.default.BORDER_RIGHT,t+=1<<x.default.BORDER_BOTTOM,t+=1<<x.default.BORDER_LEFT,n=0;n<e.length;n++)switch(e[n]){case m.BORDER_TYPE.TOP:t-=1<<x.default.BORDER_TOP;break;case m.BORDER_TYPE.RIGHT:t-=1<<x.default.BORDER_RIGHT;break;case m.BORDER_TYPE.BOTTOM:t-=1<<x.default.BORDER_BOTTOM;break;case m.BORDER_TYPE.LEFT:t-=1<<x.default.BORDER_LEFT}return t}},{key:"id",get:function(){return D.default.MERGE_CELLS_REQUEST}}]),t}(u.default);t.default=L},701:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.generateUnmergeCellsMutations=t.generateMergeCellsMutations=void 0;var a=o(n(80)),r=o(n(69));function o(e){return e&&e.__esModule?e:{default:e}}t.generateMergeCellsMutations=function(e){return e.map(function(e){return new a.default(e)})},t.generateUnmergeCellsMutations=function(e){return e.map(function(e){return new r.default(e)})}},702:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PasteOrientation=t.PasteType=void 0;var a=I(n(3)),r=I(n(0)),o=I(n(1)),i=I(n(4)),l=I(n(5));t.generateCopyPasteMutation=g;var d=I(n(20)),s=I(n(11)),u=n(390),f=I(u),h=n(1376),c=I(n(13));function I(e){return e&&e.__esModule?e:{default:e}}function g(e,t){var n=e.sheetId,a=e.cellMask,r=e.formatMask,o=e.copyRange,i=e.pasteRange,l=o.startColIndex,d=o.startRowIndex,c=(o.endColIndex,o.endRowIndex,i.startColIndex),I=i.startRowIndex,g=(i.endColIndex,i.endRowIndex,void 0),R=void 0,v=void 0,p=void 0,T=o.getColCount(),E=o.getRowCount(),m=i.getColCount(),_=i.getRowCount(),y=t[d]&&t[d].values[l],x=t[I]&&t[I].values[c],S=(0,h.isSingleOrMerge)(o,y),O=(0,h.isSingleOrMerge)(i,x);S&&O?(v=1,p=1):(T<m?v=m/T>>0:T>m?(T=m,v=1):v=1,E<_?p=_/E>>0:E>_?(E=_,p=1):p=1);var C=[],D=new s.default(o.sheetId,o.startRowIndex,o.startRowIndex+E-1,o.startColIndex,o.startColIndex+T-1),M=i,w=new s.default(i.sheetId,i.startRowIndex,i.startRowIndex+E-1,i.startColIndex,i.startColIndex+T-1);for(g=0;g<p;g++)for(R=0;R<v;R++)(M=w.clone()).insertRows(-1,g*E),M.insertCols(-1,R*T),C.push(new u.PasteMapping({source:D,destination:M}));return[new f.default({sheetId:n,cellMask:a,formatMask:r,pasteMappings:C})]}var R=t.PasteType=void 0;!function(e){e[e.PASTE_NORMAL=0]="PASTE_NORMAL",e[e.PASTE_VALUES=1]="PASTE_VALUES",e[e.PASTE_FORMAT=2]="PASTE_FORMAT",e[e.PASTE_NO_BORDERS=3]="PASTE_NO_BORDERS",e[e.PASTE_FORMULA=4]="PASTE_FORMULA",e[e.PASTE_DATA_VALIDATION=5]="PASTE_DATA_VALIDATION",e[e.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",e[e.PASTE_AS_TEXT=7]="PASTE_AS_TEXT",e[e.PASTE_COLUMN_WIDTHS=8]="PASTE_COLUMN_WIDTHS"}(R||(t.PasteType=R={}));var v=t.PasteOrientation=void 0;!function(e){e[e.NORMAL=1]="NORMAL"}(v||(t.PasteOrientation=v={}));var p=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=e.sheetId,d=e.pasteType,s=e.pasteOrientation,u=e.copyRange;if(o.sheetId=l,o.copyRange=u,n){var f=n.rangeSelections;0===f.length||f.length>1?console.warn("invalid rangeSelections length"):(o.pasteRange=f[0],o.behaviors=f.map(function(e){return{sheetId:o.sheetId,pasteType:d,pasteOrientation:s,copyRange:u,pasteRange:e}}))}return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){t.parent&&n(g(e,t.activeSheet.getData().rowData))}},{key:"id",get:function(){return c.default.COPY_PASTE_REQUEST}}]),t}(d.default);t.default=p},703:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=R(n(3)),r=R(n(0)),o=R(n(1)),i=R(n(4)),l=R(n(5)),d=R(n(20)),s=R(n(29)),u=R(n(43)),f=R(n(18)),h=R(n(39)),c=n(51),I=n(158),g=R(n(13));function R(e){return e&&e.__esModule?e:{default:e}}var v=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n)),l=void 0,d=void 0,s=void 0;if(n)for(l=0,d=n.rangeSelections.length;l<d;l++)s={gridRange:n.rangeSelections[l]},o.behaviors.push(s);return o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"do",value:function(e,t,n){var a,r=void 0,o=this.getCellDataDelta(e),i=[e.gridRange],l=t.getSheetBySheetId(e.gridRange.sheetId);if(l)for(i=(0,c.divideGridRangesByFilter)(i,l.getBasicFilter()),r=0,a=(i=(0,I.divideGridRangesByMerges)(i,l.getMerges())).length;r<a;r++)n(new u.default({gridRange:i[r],cellDataDelta:o}))}},{key:"getCellDataDelta",value:function(e){var t=new s.default;new h.default;return t.clearSlot(f.default.SLOT_EFFIECTIVE_VALUE),t.clearSlot(f.default.SLOT_HYPERLINK),t.clearSlot(f.default.SLOT_FORMULA),t.clearSlot(f.default.SLOT_MENTION),t}},{key:"id",get:function(){return g.default.CLEAR_RANGE_REQUEST}}]),t}(d.default);t.default=v},704:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getFilteredRows=void 0;var a=n(292);t.getFilteredRows=function(e,t){e=e.clone();var n={},r=e.range.startRowIndex,o=e.range.endRowIndex,i=e.criteriaMap,l=[];return i.forEach(function(e,i){var d=e.getVisibleValues().reduce(function(e,t){return e[t]=1,e},{}),s=r;for(s+=1;s<=o;s++){var u=(0,a.getRenderResult)(t.activeSheet,s,i);null!==u&&void 0!==u||(u=""),void 0===n[s]&&(d[u]||(l.push(s),n[s]=1))}}),l}},705:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),r=E(n(0)),o=E(n(1)),i=E(n(4)),l=E(n(5));t.requestRuleToMutationRule=m;var d=E(n(20)),s=E(n(13)),u=E(n(282)),f=E(n(382)),h=E(n(52)),c=E(n(32)),I=E(n(115)),g=E(n(383)),R=E(n(384)),v=E(n(278)),p=E(n(96)),T=n(155);function E(e){return e&&e.__esModule?e:{default:e}}function m(e){var t=e.booleanConditionalFormat,n=t.condition,a=t.format,r=[];if(n.userInputOne){var o=new R.default({type:v.default.VALUE_TOKEN,userEnteredValue:n.userInputOne});r.push(o)}if(n.userInputTwo){var i=new R.default({type:v.default.VALUE_TOKEN,userEnteredValue:n.userInputTwo});r.push(i)}var l=(0,T.colorValues)("#"+a.bgColor);return new p.default({ruleRanges:e.ruleRanges,booleanConditionalFormat:new f.default({condition:new g.default({type:e.booleanConditionalFormat.condition.conditionType,values:r}),format:l&&new h.default({setSlots:1<<c.default.BACKGROUND_COLOR,backgroundColor:new I.default({red:l[0],green:l[1],blue:l[2]})}),stopIftrue:!1}),uid:e.userId})}var _=function(e){function t(e,n){(0,r.default)(this,t);var o=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e,n));return o.behaviors=[e],o}return(0,l.default)(t,e),(0,o.default)(t,[{key:"check",value:function(e){return null}},{key:"do",value:function(e,t,n){var a=e.rule,r=t&&t.getActiveSheetId(),o=t&&t.getSheetBySheetId(r);if(o&&o.getConditionalFormatRule()){var i={sheetId:r,ruleIndex:0,rule:m(a)};n(new u.default(i))}}},{key:"id",get:function(){return s.default.ADD_CONDITIONAL_FORMAT_REQUEST}}]),t}(d.default);t.default=_},755:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(63)),r=p(n(16)),o=p(n(14)),i=p(n(9));t.getSheetExportInfo=function(e){for(var t=e.getRowCount(),n=e.getColCount(),r=e.getRowsHeight(0,t-1),o=e.getColsWidth(0,n-1),d=[],u=[],f=[],h=[],c=[],I=[],g=[],R=0,v=!e.getHideGridlines(),p=0;p<t;p++){for(var T=[],_=[],y=0;y<n;y++){var S=e.data.rowData[p]&&e.data.rowData[p].values[y];if(S){var O=x(S,p,y,T,_,c,h,g,I);O.isValidDataCell&&R++}else T.push(null),_.push(-1)}var C=r[p];"number"===typeof C&&C>s.DEFAULT_ROW_HEIGHT?f[p]=!0:f[p]=!1,d.push(T),u.push(_)}var D=[];e.getMerges().forEach(function(e){var t=(0,l.convertRanges2Span)(e);D.push(t)});var M=void 0,w=void 0;e.data.rowMetadata.forEach(function(e,t){e&&e.getHiddenByUser()&&(M||(M={}),M[t]=1)}),e.data.columnMetadata.forEach(function(e,t){e&&e.getHiddenByUser()&&(w||(w={}),w[t]=1)});var A={};A.fixedColumnsLeft=e.getFrozenColCount(),A.fixedRowsTop=e.getFrozenRowCount();var F=[],k=e.getImages();(0,i.default)(k).forEach(function(e,t){var n=k[e],a={},r=n.position.overlayPosition;a.anchor={col:Number(r.anchorCell.colIndex),row:Number(r.anchorCell.rowIndex)},a.id=e,a.offset={x:r.offsetXpixels,y:r.offsetYpixels},a.size={height:r.heightPixels,width:r.widthPixels},a.type="pic",a.url=n.url,a.clipInfo={l:n.clipInfo.clipLeft||0,r:n.clipInfo.clipRight||0,t:n.clipInfo.clipTop||0,b:n.clipInfo.clipBottom||0};var o=n.url;o&&!/undefined/i.test(o)&&F.push(a)});var L=void 0,N=void 0,b=e.getBasicFilter();if(b){var P=b.range;P&&(L=[P.startRowIndex,P.startColIndex,P.endRowIndex,P.endColIndex]),N=b.getHiddenRows()}var U={ref:L||[],filterColumn:[],hiddenRow:N||[]};L&&b&&function(){for(var t=function(e,t){var n=new a.default;if(t)for(var r=t.startRowIndex,o=t.endRowIndex,i=t.startColIndex,l=t.endColIndex,d=i;d<l+1;d++){for(var s=[],u=r+1;u<o+1;u++){if(!e.data.rowData[u])break;var f=e.data.rowData[u]&&e.data.rowData[u].values[d],h=(f&&f.getEffectiveValue()?f.getEffectiveValue():{value:""}).value+"";-1!=h.indexOf(m)&&(h=h.replace(E,"")),s.push(h)}n.set(d,s)}return n}(e,b.range),n=b.criteriaMap,r=b.range.startRowIndex,o=function(a){var o=[],i=t.get(a)||[];i.forEach(function(t,i,l){var d=void 0,s=n.get(a);if(!s||function(e,t){return void 0!==e.hiddenValues?-1===e.hiddenValues.indexOf(t):void 0!==e.visibleValues&&e.visibleValues.indexOf(t)>-1}(s,t)){var u=e.data.rowData[r+i+1]&&e.data.rowData[r+i+1].values[a];if(u){var f=u.getUserEnteredFormat(),h=f&&f.getNumberFormat(),c=h?h.id:"",I=h?h.type:"";d=-1!==[8,12,44,166,167,168,169,170,171,176,177].indexOf(c)||-1!==["currency-hk","numeral","currency-chs","currency-en"].indexOf(I)?(t+"").trim():t,o.push(d)}}});var l=o.filter(function(e,t,n){return n.indexOf(e)===t}),d={colId:a-b.range.startColIndex,filterVal:[].concat(l)};U.filterColumn.push(d)},i=b.range.startColIndex;i<=b.range.endColIndex;i++)o(i)}();return{data:d,styles:u,templates:h,mergeCellsInfo:D,rowHeights:r,colHeights:o,rowHide:M,colHide:w,tableSettings:A,formulaInfo:c,shouldManual:f,shapes:F,dataVersion:2,autoFilter:U,sharedStrings:g,dataValidations:I,validDataCount:R,showgrid:v}},t.getCommentsExportInfo=function(e,t){var n=e.sheetRangeControl&&e.sheetRangeControl.ranges,a=[];if(n)return(0,i.default)(n).forEach(function(e){var r=n[e];if(r.sheetRangeType===f.default.COMMENT_RANGE){var o=r.gridRange.startColIndex,i=r.gridRange.startRowIndex,l=(0,h.toChar)(o)+(i+1);a.push({ref:l,author:t,anchorId:e})}}),{id:e.getSheetId(),anchors:a}};var l=n(1642),d=p(n(108)),s=n(33),u=p(n(62)),f=p(n(173)),h=n(51),c=n(655),I=n(181),g=n(44),R=n(1643),v=n(55);function p(e){return e&&e.__esModule?e:{default:e}}var T=window,E=new RegExp(String.fromCharCode(65279),"g"),m=String.fromCharCode(65279),_={"\u9ed1\u8272":"Black","\u7eff\u8272":"Green","\u767d\u8272":"White","\u84dd\u8272":"Blue","\u6d0b\u7ea2\u8272":"Magenta","\u9ec4\u8272":"Yellow","\u84dd\u7eff\u8272":"Cyan","\u7ea2\u8272":"Red"},y=["\u9ed1\u8272","\u7eff\u8272","\u767d\u8272","\u84dd\u8272","\u6d0b\u7ea2\u8272","\u9ec4\u8272","\u84dd\u7eff\u8272","\u7ea2\u8272"];function x(e,t,n,a,i,l,s,f,h){var p=!1,x=e.getEffectiveValue(),S=e.getFormula(),O=S?S.toString(t,n):"",C=!1;if(O&&"string"===typeof O){var D=void 0;if(x&&x.type===u.default.ERROR){var M=x.value;D=M&&M.displayText}else D=null;null!=D&&(C=(0,g.noSupportFormulaError)(D+"")),(0,g.noNeedConvertFormula)(O)||C||(console.warn("formulaInfo ",O),l.push({col:n,row:t,error:D,data:(0,R.exportProcessFormula)(O.replace("=","")),type:null!==x?x.type:u.default.STRING}))}if(x&&x.type!==u.default.ERROR)if(null===x.value)a.push(x.value);else if(p=!0,x.type===u.default.BOOL)a.push(x.value?1:0);else{var w=String(x.value);-1!=w.indexOf(m)?a.push(w.replace(E,"")):a.push(x.value)}else C?(p=!0,a.push(String(O))):a.push(null);var A={},F=(0,v.getExportFormat)(e);if(F){if(F.getTextFormat()){F.getTextFormat();F.getFontFamily()&&(A.fontfamily=F.getFontFamily()),F.getFontSize()&&(A.fontsize=F.getFontSize()),F.getBold()&&(A.bold="bold"),F.getItalic()&&(A.italic="italic"),F.getColor()&&(A.color=F.getColor().toHex()),F.getUnderline()&&(A.underline="underline"),F.getStrikethrough()&&(A.strikeline="strikeline")}if(F.getNumberFormat()){var k=F.getNumberFormat();A.format_id=k&&k.id,A.format_data=k&&k.pattern;var L=[],N=A.format_data+"";y.forEach(function(e){-1!=N.indexOf(e)&&L.push(e)}),L.length>0&&(A.format_data=N.replace(new RegExp(L.join("|")),function(e){return _[e]}))}if(F.getHorizontalAlign()&&(A.h_align=F.getHorizontalAlign()),F.getVerticalAlign()&&(A.v_align=F.getVerticalAlign()),F.getBorders()){var b=F.getBorders(),P=b.top,U=b.right,B=b.bottom,G=b.left,V=[],H=[],W=function(e){return 1===e?3:3==e?1:e};P&&("number"===typeof P.style||P.color)&&(V.push("border-top-show:"+(P.color?P.color.toHex():"#d8d8d8")),H.push("t:"+("number"===typeof P.style?W(P.style):1))),U&&("number"===typeof U.style||U.color)&&(V.push("border-right-show:"+(U.color?U.color.toHex():"#d8d8d8")),H.push("r:"+("number"===typeof U.style?W(U.style):1))),B&&("number"===typeof B.style||B.color)&&(V.push("border-bottom-show:"+(B.color?B.color.toHex():"#d8d8d8")),H.push("b:"+("number"===typeof B.style?W(B.style):1))),G&&("number"===typeof G.style||G.color)&&(V.push("border-left-show:"+(G.color?G.color.toHex():"#d8d8d8")),H.push("l:"+("number"===typeof G.style?W(G.style):1))),A.sheetborder=V.join("--"),A.bordertype=H.join("-")}if(F.getColor()){var z=F.getColor();A.fontcolor=z&&z.toHex()}if(F.getBackgroundColor()){var Y=F.getBackgroundColor();A.cellcolor=Y&&Y.toHex()}if(F.getWrapStrategy()===d.default.WRAP?A.textwrap="normal":A.textwrap="nowrap",F.getDataValidation()){var j=F.getDataValidation();j=j?j.clone():null;var K=(0,c.document2XlsxVali)(j,t,n);K&&h.push((0,o.default)({sqref:(0,I.getZipStringWithCell)({row:t,col:n})},K))}}A=(0,o.default)({bold:"false",color:"#000000",fontfamily:"\u5fae\u8f6f\u96c5\u9ed1",fontsize:10,format_id:0,format_data:"General",fontcolor:"#000000",h_align:"general",italic:"false",strikeline:"false",textwrap:"nowrap",underline:"false",v_align:"middle"},A);var $=(0,r.default)(A),Q=T.SpreadsheetApp.file.styleDetail,Z=Q.indexOf($);if(-1==Z?(T.SpreadsheetApp.file.styleDetail.push($),i.push(Q.length-1)):i.push(Z),e&&e.getHyperlink()){var X={},q=e.getEffectiveValue();X.linkurl=e.getHyperlink(),X.linkvalue=q&&String(q.value)||"",X.minType="link",s.push([t,n,null,{prop:X,type:"link"}])}if(e&&e.getTextFormatRuns()&&x&&x.value){var J=(x.value+"").length;f.push([t,n,(0,r.default)(e.getTextFormatRuns().filter(function(e){return e.startIndex<J}))])}return{isValidDataCell:p}}},770:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=D(n(24)),r=D(n(83)),o=D(n(3)),i=D(n(0)),l=D(n(1)),d=D(n(4)),s=D(n(5)),u=D(n(107)),f=D(n(25)),h=D(n(159)),c=D(n(20)),I=D(n(161)),g=D(n(15)),R=n(70),v=D(n(35)),p=D(n(11)),T=D(n(67)),E=D(n(13)),m=D(n(18)),_=n(55),y=D(n(80)),x=n(699),S=D(n(96)),O=D(n(139)),C=D(n(140));function D(e){return e&&e.__esModule?e:{default:e}}var M=function(e,t,n,a){var r,o=arguments.length,i=o<3?t:null===a?a=(0,h.default)(t,n):a;if("object"===("undefined"===typeof Reflect?"undefined":(0,f.default)(Reflect))&&"function"===typeof Reflect.decorate)i=Reflect.decorate(e,t,n,a);else for(var l=e.length-1;l>=0;l--)(r=e[l])&&(i=(o<3?r(i):o>3?r(t,n,i):r(t,n))||i);return o>3&&i&&(0,u.default)(t,n,i),i},w=function(e){function t(e,n){(0,i.default)(this,t);var a=(0,d.default)(this,(t.__proto__||(0,o.default)(t)).call(this,e,n));return a.sheetId=e.sheet.getSheetId(),a.type=e.type,a.selection=n,e.insertInfo?(e.insertInfo=e.insertInfo.map(function(t){return a.generateRange(e.sheet,t)}),a.behaviors=e.insertInfo):n&&(a.type===g.default.ROWS?a.behaviors=a.getInsertOption(e.sheet,n.getRows()):a.behaviors=a.getInsertOption(e.sheet,n.getCols())),a}return(0,s.default)(t,e),(0,l.default)(t,[{key:"predictRequestSize",value:function(e){var t=e.getSheetBySheetId(this.sheetId),n=0,a=0,r=void 0,o=void 0,i=void 0,l=this.behaviors[0].index;if(0===l)return 0;if(!t)return 0;if(this.type===g.default.ROWS)for(r=a=t.getColCount(),i=0;i<r;i++)(o=t.getCellDataAtPosition(l-1,i))&&0!==o.setSlots||a--;else{if(this.type!==g.default.COLUMNS)return 0;for(r=a=t.getRowCount(),i=0;i<r;i++)(o=t.getCellDataAtPosition(i-1,l))&&0!==o.setSlots||a--}return this.behaviors.forEach(function(e){n+=e.amount*a*40}),n}},{key:"requestSizeOverLimitTips",value:function(){return"\u6570\u636e\u91cf\u8f83\u5927\uff0c\u64cd\u4f5c\u4e0d\u6210\u529f\u3002\u5efa\u8bae\u5206\u6279\u63d2\u5165"+(this.type===g.default.ROWS?"\u884c":"\u5217")+"\u3002"}},{key:"do",value:function(e,t,n){var a,r,o=0,i=0,l=t.getSheetBySheetId(this.sheetId),d=void 0,s=void 0,u=void 0,f=[],h=void 0,c=void 0,E=void 0,m=void 0,_=void 0;if(null!==l){this.selection||(this.selection=t.parent.view.getSelection());var y=this.selection.activeCell,S=y.rowIndex,O=y.colIndex,C=l.getRowCount(),D=l.getColCount(),M=e.index;for(M=this.type===g.default.ROWS?M>C-1?C-1:S:M>D-1?D-1:O,e.positionCenterKey&&l.positionCenter.remove(e.positionCenterKey),m=(r=this.beforeInsertDimension(t,e,this.type)).beforeMutations,_=r.afterMutations,m.forEach(function(e){n(e)}),this.type===g.default.ROWS&&(s=new p.default(this.sheetId,M,M,0,l.getRowCount()-1),u=(0,x.getSetRangeMutation)(l,s),this.checkBorders(u,l,e.index>M)),this.type===g.default.COLUMNS&&(s=new p.default(this.sheetId,0,l.getRowCount()-1,M,M),u=(0,x.getSetRangeMutation)(l,s),this.checkBorders(u,l,e.index>M)),n(new I.default({index:e.index,amount:e.amount,type:this.type,sheetId:this.sheetId})),this.type===g.default.ROWS?M=e.index<=M?M+e.amount:M:this.type===g.default.COLUMNS&&(M=e.index<=M?M+e.amount:M),a=(0,R.getSetDimensionPropertiesMutation)({sheet:l,type:this.type,ranges:[new v.default(this.sheetId,M,M,this.type)]},{pixelSize:!0,ignoreDefaultSize:!0}),o=0;o<a.length;o++)(d=a[o]).operation.length>0&&(d.ranges.forEach(function(t){t.startIndex=e.index,t.endIndex=e.index+e.amount-1}),n(d));if(u&&u.cellDataDeltaAtPositions.length>0){for(o=0;o<u.cellDataDeltaAtPositions.length;o++)if(h=u.cellDataDeltaAtPositions[o].rowIndex,c=u.cellDataDeltaAtPositions[o].colIndex,0!==(E=u.cellDataDeltaAtPositions[o].cellDataDelta).setSlots)if(this.type===g.default.ROWS)for(i=0;i<e.amount;i++)f.push({rowIndex:e.index+i,colIndex:c,cellDataDelta:E});else for(i=0;i<e.amount;i++)f.push({rowIndex:h,colIndex:e.index+i,cellDataDelta:E});s=this.type===g.default.ROWS?new p.default(this.sheetId,e.index,e.index+e.amount-1,0,l.getColCount()-1):new p.default(this.sheetId,0,l.getRowCount()-1,e.index,e.index+e.amount-1),0!==f.length&&n(new T.default({gridRange:s,cellDataDeltaAtPositions:f}))}_.forEach(function(e){n(e)})}}},{key:"updateDataValidationAfterInsertMutation",value:function(e,t,n,a){var r=e.delta.userEnteredFormatDelta;return null!=(r&&r.delta.getDataValidation())?this.getCellDataDeltaAtPosition(t,n,a):e}},{key:"getCellDataDeltaAtPosition",value:function(e,t,n){var a=void 0,r=void 0,o=e.getSheetId();return null!==(a=e.getCellDataAtPosition(t,n))&&null!==a.getMergeReference()&&(r=a.getMergeReference(),a=e.getCellDataAtPosition(r.startRowIndex,r.startColIndex)),(0,_.createCellDataDelta)({cellData:null,rowIndex:this.type===g.default.ROWS?t+1:t,colIndex:this.type===g.default.ROWS?n:n+1,sheetId:o},{cellData:a,rowIndex:t,colIndex:n,sheetId:o},1<<m.default.SLOT_USER_ENTERED_FORMAT_DELTA)}},{key:"getInsertOption",value:function(e,t){for(var n=[],a=1,r=t[0],o=1,i=void 0;a<t.length;a++)t[a]===t[a-1]+1?o++:(i={index:r,amount:o},n.push(this.generateRange(e,i)),r=t[a],o=1);return i={index:r,amount:o},n.push(this.generateRange(e,i)),n}},{key:"generateRange",value:function(e,t){var n,a=new v.default(this.sheetId,t.index,t.index+t.amount-1,this.type),o=this.type===g.default.ROWS?"yRange":"xRange";return t.positionCenterKey=e.positionCenter.add({config:{},selfData:(n={},(0,r.default)(n,o,a),(0,r.default)(n,"area",t),(0,r.default)(n,"dimension",o),n),type:"request-insertDimensionBehavior",calc:function(e,t,n){e.area.index=e[e.dimension].startIndex}}),t}},{key:"checkBorders",value:function(e,t,n){var a=e.cellDataDeltaAtPositions,r=void 0,o=void 0,i=void 0,l=void 0,d=void 0,s=void 0,u=void 0,f=void 0,h=void 0,c=e.gridRange,I=!1;for(this.type===g.default.ROWS?(i=1,l=0,t.getRowCount()<=c.startRowIndex+i&&(I=!0)):(i=0,l=1,t.getColCount()<=c.startColIndex+l&&(I=!0)),d=0;d<a.length;d++)(s=a[d].cellDataDelta.delta).userEnteredFormatDelta&&s.userEnteredFormatDelta.delta&&null!==(u=s.userEnteredFormatDelta.delta).getBorders()&&(I&&n?u.clearBorders():(r=a[d].rowIndex,o=a[d].colIndex,null!==(f=n?t.getCellDataAtPosition(r+i,o+l):t.getCellDataAtPosition(r-i,o-l))&&null!==(h=f.getUserEnteredFormat())&&null!==h.getBorders()?(u.getBorderTop()&&(h.getBorderTop()&&u.getBorderTop().equal(h.getBorderTop())||u.clearBorderTop()),u.getBorderRight()&&(h.getBorderRight()&&u.getBorderRight().equal(h.getBorderRight())||u.clearBorderRight()),u.getBorderBottom()&&(h.getBorderBottom()&&u.getBorderBottom().equal(h.getBorderBottom())||u.clearBorderBottom()),u.getBorderLeft()&&(h.getBorderLeft()&&u.getBorderLeft().equal(h.getBorderLeft())||u.clearBorderLeft())):u.clearBorders()))}},{key:"beforeInsertDimension",value:function(e,t,n){t.index,t.amount;var r=[],o=[],i=this.conflictMerge(t,e);r.push.apply(r,(0,a.default)(i.beforeMutations)),o.push.apply(o,(0,a.default)(i.afterMutations));var l=this.conflictWorkbookrange(t,e,n);o.push.apply(o,(0,a.default)(l.afterMutations));var d=this.conflictConditionalFormat(t,e);return r.push.apply(r,(0,a.default)(d.beforeMutations)),o.push.apply(o,(0,a.default)(d.afterMutations)),{beforeMutations:r,afterMutations:o}}},{key:"conflictWorkbookrange",value:function(e,t,n){e.index,e.amount,t.getSheetBySheetId(this.sheetId).sheetRangeControl.ranges;return{beforeMutations:[],afterMutations:[]}}},{key:"conflictMerge",value:function(e,t){var n=void 0,a=e.index,r=e.amount,o=t.getSheetBySheetId(this.sheetId).getMerges(),i=void 0,l={beforeMutations:[],afterMutations:[]};for(n=0;n<o.length;n++)i=o[n],this.type===g.default.ROWS?a>i.startRowIndex&&a<=i.endRowIndex&&l.afterMutations.push(new y.default({sheetId:i.sheetId,startRowIndex:i.startRowIndex,endRowIndex:i.endRowIndex+r,startColIndex:i.startColIndex,endColIndex:i.endColIndex})):this.type===g.default.COLUMNS&&a>i.startColIndex&&a<=i.endColIndex&&l.afterMutations.push(new y.default({sheetId:i.sheetId,startRowIndex:i.startRowIndex,endRowIndex:i.endRowIndex,startColIndex:i.startColIndex,endColIndex:i.endColIndex+r}));return l}},{key:"conflictConditionalFormat",value:function(e,t){var n=this,a={beforeMutations:[],afterMutations:[]},r=this.sheetId,o=t.getSheetBySheetId(r),i=o.conditionalFormatRuleManager.getConditionalFormatRuleAll(),l=i.length;if(l<1)return a;var d=e.index,s=e.amount,u=o.getRowCount()-1,f=o.getColCount()-1,h=void 0;h=this.type===g.default.ROWS?new p.default(r,d,d,0,f):new p.default(r,0,u,d,d);for(var c=0;c<l;c++){var I,R=i[c],v=!1;if(I=R.rule.ruleRanges.map(function(e){if(h.isCross(e)){v=!0;var t=e.startRowIndex,a=e.endRowIndex,o=e.startColIndex,i=e.endColIndex;return n.type===g.default.ROWS?new p.default(r,t,a+s,o,i):new p.default(r,t,a,o,i+s)}return e}),v){var T=new S.default({ruleRanges:I,booleanConditionalFormat:R.rule.booleanConditionalFormat,uid:R.rule.uid});a.afterMutations.push(new O.default({sheetId:r,ruleIndex:R.index,rule:T,oldRuleRanges:R.rule.ruleRanges}))}}return a}},{key:"id",get:function(){return E.default.INSERT_DIMENSION_REQUEST}}]),t}(c.default);M([(0,C.default)(w)],w.prototype,"predictRequestSize",null),t.default=w},771:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=s(n(41)),o=s(n(24)),i=s(n(11)),l=n(317),d=s(n(7));function s(e){return e&&e.__esModule?e:{default:e}}function u(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];a&&-1===t.indexOf(a.direction)&&t.push(a.direction)}return t}function f(e,t){for(var n=d.default.window.SpreadsheetApp.spreadsheet.activeSheet,r=n.getRowCount()-1,o=n.getColCount()-1,l=e.startRowIndex,s=e.endRowIndex,u=e.startColIndex,f=e.endColIndex,h=0;h<t.length;h++){var c=t[h];if(c){var I=c.amount;switch(c.direction){case a.UP:l=(l-=I)<0?0:l;break;case a.DOWN:s=(s+=I)>r?r:s;break;case a.LEFT:u=(u-=I)<0?0:u;break;case a.RIGHT:f=(f+=I)>o?o:f}}}return new i.default(e.sheetId,l,s,u,f)}function h(e,t){for(var n=function(e,t,n){return{directions:n,position:[e,t]}},r=function(e,t,n,a){for(var r=[],o=e;o<=t;o++){var i=a?[n,o]:[o,n];r.push(i)}return r},o=[],i=e.startRowIndex,l=e.endRowIndex,d=e.startColIndex,s=e.endColIndex,u=n(i,d,[a.UP,a.LEFT]),f=n(i,s,[a.UP,a.RIGHT]),h=n(l,d,[a.DOWN,a.LEFT]),c=n(l,s,[a.DOWN,a.RIGHT]),I=0;I<t.length;I++)switch(t[I]){case a.UP:o.push({direction:a.UP,sideDatas:r(d+1,s-1,i,!0),corners:[u,f]});break;case a.DOWN:o.push({direction:a.DOWN,sideDatas:r(d+1,s-1,l,!0),corners:[h,c]});break;case a.LEFT:o.push({direction:a.LEFT,sideDatas:r(i+1,l-1,d,!1),corners:[u,h]});break;case a.RIGHT:o.push({direction:a.RIGHT,sideDatas:r(i+1,l-1,s,!1),corners:[f,c]})}return o}function c(e,t){for(var n=d.default.window.SpreadsheetApp.spreadsheet.activeSheet,i=0,s=0,u=0,f=0,h=[],c=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n){var r=n.amount;switch(n.direction){case a.UP:i=Math.max(i,r);break;case a.DOWN:s=Math.max(s,r);break;case a.LEFT:u=Math.max(u,r);break;case a.RIGHT:f=Math.max(f,r)}}}},I=function(e,t){return e<1?[]:[{direction:t,amount:e}]},g=function(t,r,i){var d=[],s=n.getCellDataAtPosition(t,r),u=s&&s.getMergeReference();return(u?(0,l.isMergeCellBlank)(t,r):(0,l.isSingleCellBlank)(t,r))||(u&&d.push.apply(d,(0,o.default)(function(e,t){var n=[],r=e.startRowIndex,o=e.endRowIndex,i=e.startColIndex,l=e.endColIndex,d=t.startRowIndex,s=t.endRowIndex,u=t.startColIndex,f=t.endColIndex;d<r&&n.push({direction:a.UP,amount:r-d});s>o&&n.push({direction:a.DOWN,amount:s-o});u<i&&n.push({direction:a.LEFT,amount:i-u});f>l&&n.push({direction:a.RIGHT,amount:f-l});return n}(e,u))),d.push.apply(d,(0,o.default)(function(e,t){for(var n=[],a=0;a<e.length;a++){var r=e[a];r&&n.push({direction:r,amount:t})}return n}(i,1)))),d},R=0;R<t.length;R++){var v=t[R];if(v){for(var p=v.direction,T=v.corners,E=v.sideDatas,m=!1,_=0;_<T.length;_++){var y=(0,r.default)(T[_].position,2),x=g(y[0],y[1],T[_].directions);x.length>0&&(c(x),m=!0)}if(!m)for(var S=E.length,O=0;O<S;O++){var C=(0,r.default)(E[O],2),D=g(C[0],C[1],[p]);D.length>0&&c(D)}}}return h.push.apply(h,(0,o.default)(I(i,a.UP)).concat((0,o.default)(I(s,a.DOWN)),(0,o.default)(I(u,a.LEFT)),(0,o.default)(I(f,a.RIGHT)))),h}!function(e){e[e.UP=1]="UP",e[e.DOWN=2]="DOWN",e[e.LEFT=3]="LEFT",e[e.RIGHT=4]="RIGHT"}(a||(a={})),t.default=function(e){var t=function(e,t){var n=d.default.window.SpreadsheetApp.spreadsheet.activeSheet,r=n.getRowCount()-1,l=n.getColCount()-1,s=e.startRowIndex,f=e.endRowIndex,I=e.startColIndex,g=e.endColIndex,R=[];R.push.apply(R,(0,o.default)(0===s?[a.UP]:[])),R.push.apply(R,(0,o.default)(f===r?[a.DOWN]:[])),R.push.apply(R,(0,o.default)(0===I?[a.LEFT]:[])),R.push.apply(R,(0,o.default)(g===l?[a.RIGHT]:[]));for(var v=h(e,R),p=u(c(e,v)),T=0;T<R.length;T++){var E=R[T];if(-1!==p.indexOf(E))switch(E){case a.UP:s--;break;case a.DOWN:f++;break;case a.LEFT:I--;break;case a.RIGHT:g++}}return++s>--f&&(s=f),++I>--g&&(I=g),s=Math.min(s,t.startRowIndex),f=Math.max(f,t.endRowIndex),I=Math.min(I,t.startColIndex),g=Math.max(g,t.endColIndex),new i.default(e.sheetId,s,f,I,g)}(function(e){var t,n,r,i,l=d.default.window.SpreadsheetApp.spreadsheet.activeSheet,s=l.getRowCount()-1,I=l.getColCount()-1,g=0,R=Math.max(s,I),v=function(e,t){return e<1?[]:[{direction:t,amount:e}]},p=[];(t=p).push.apply(t,(0,o.default)(v(0===e.startRowIndex?0:1,a.UP))),(n=p).push.apply(n,(0,o.default)(v(e.endRowIndex===s?0:1,a.DOWN))),(r=p).push.apply(r,(0,o.default)(v(0===e.startColIndex?0:1,a.LEFT))),(i=p).push.apply(i,(0,o.default)(v(e.endColIndex===I?0:1,a.RIGHT)));var T=u(p),E=f(e,p);if(E.equals(e))return e;do{var m=h(E,T);if((p=c(E,m)).length<1)break;E=f(E,p),T=u(p),g++}while(g<R);return E}(e),e);return(0,l.isSingleRange)(e)&&(0,l.isRangeCellBlank)(e.startRowIndex,e.startColIndex)?t.equals(e)?t:function(e,t){if(!e.contain(t))return!1;var n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=e.endColIndex,i=t.startRowIndex,l=t.endRowIndex,d=t.startColIndex,s=t.endColIndex;return n===i||a===l||r===d||o===s}(t,e)?function(e,t){var n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=e.endColIndex,d=t.startRowIndex,s=t.endRowIndex,u=t.startColIndex,f=t.endColIndex,h=new i.default(e.sheetId,d,s,r,o),c=new i.default(e.sheetId,n,a,u,f);return(0,l.isRangeBlankInMergeMode)(h)&&(n===d?n=s+1:a=d-1),(0,l.isRangeBlankInMergeMode)(c)&&(r===u?r=f+1:o=u-1),new i.default(e.sheetId,n,a,r,o)}(t,e):t:t}},78:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(220));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.type=null!=t.type?t.type:null,t.value=null!=t.value?t.value:null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){return this.value instanceof o.default?[this.type,null,this.value.serialize()]:[this.type,this.value]}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.type&&(this.type=e.type),"undefined"!==typeof e.value&&(this.value=e.value),this}},{key:"equals",value:function(e){return this.type===e.type&&this.value===e.value}},{key:"clone",value:function(){return new e({type:this.type,value:this.value})}}],[{key:"deserialize",value:function(t){return t[2]?new e({type:t[0],value:o.default.deserialize(t[2])}):new e({type:t[0],value:t[1]})}}]),e}();l.protoMap={0:{name:"type",dataType:Number},1:{name:"value",dataType:[Number,String,Boolean,o.default]}},t.default=l},79:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getMonitorByMutationSize=t.getMutationDataSize=t.divideGridRangeByCells=t.divideCellDataDeltaByBorders=t.getUnionGridRange=t.getCrossGridRange=t.isCellInGridRange=t.transformTwoCellDataDelta=t.equals=t.isTwoGridRangeCross=t.changeGridRangeByDeleteDimension=t.changeCellDataDeltaByMutation=t.changeGridRangeByInsertDimension=t.deserializeMutation=t.serializeMutation=t.crossRanges=t.crossSingleRange=void 0;var a=p(n(24)),r=p(n(16)),o=p(n(15)),i=p(n(35)),l=p(n(11)),d=p(n(29)),s=p(n(18)),u=p(n(39)),f=n(32),h=p(f),c=n(160),I=p(n(110)),g=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(668)),R=p(n(8)),v=n(26);function p(e){return e&&e.__esModule?e:{default:e}}function T(e,t){var n=[],a=null,r=e.sheetId;if(e=e.clone(),t=t.clone(),-1===e.startIndex||-1===e.endIndex||-1===t.startIndex||-1===t.endIndex)throw"invalid select all dimensionrange in crossSingleRange";return e.startIndex<=t.startIndex?e.endIndex<t.startIndex?n.push(e):(n.push(new i.default(r,e.startIndex,t.startIndex-1,e.dimension)),t.endIndex<=e.endIndex?(a=new i.default(r,t.startIndex,t.endIndex,e.dimension),n.push(new i.default(r,t.endIndex+1,e.endIndex,e.dimension))):(a=new i.default(r,t.startIndex,e.endIndex,e.dimension),n.push(new i.default(r,e.endIndex+1,t.endIndex,e.dimension)))):t.endIndex<e.startIndex?n.push(e):t.endIndex>=e.endIndex?a=new i.default(r,e.startIndex,e.endIndex,e.dimension):(a=new i.default(r,e.startIndex,t.endIndex,e.dimension),n.push(new i.default(r,t.endIndex+1,e.endIndex,e.dimension))),{ranges:n,cross:a?[a]:null}}function E(e){try{return e.version>=5&&!window.clientVars.relative?g.serializeMutation(e):{t:e.id,v:I.default.MUTATION_VER_LOWEST_SUPPORT,c:(0,c.serialize)(e,null,{notReplaceSheetId:!0}),r:e.parentRequestId,o:e.operationType}}catch(t){throw R.default.run(v.CONFIG.SERIALIZE_MUTATION,[e],t),t}}function m(e,t){return e.sheetId===t.sheetId&&_({startIndex:e.startRowIndex,endIndex:e.endRowIndex},{startIndex:t.startRowIndex,endIndex:t.endRowIndex})&&_({startIndex:e.startColIndex,endIndex:e.endColIndex},{startIndex:t.startColIndex,endIndex:t.endColIndex})}function _(e,t){return t.endIndex>=e.startIndex&&e.endIndex>=t.startIndex}function y(e,t){return(e&1<<t)>0}function x(e,t,n){var a=void 0,r=void 0;for(e=e||new u.default,t=t||new u.default,a=0,r=e.setSlots|e.clearSlots;r>0;a++,r>>=1)if(y(t.setSlots|t.clearSlots,a))switch(y(e.clearSlots,a)&&y(t.clearSlots,a)&&e.removeSlot(a),a){case h.default.NUMBER_FORMAT:case h.default.BACKGROUND_COLOR:case h.default.BORDER_TOP:case h.default.BORDER_RIGHT:case h.default.BORDER_BOTTOM:case h.default.BORDER_LEFT:case h.default.HORIZONTAL_ALIGN:case h.default.VERTICAL_ALIGN:case h.default.WRAP_STRATEGY:case h.default.FOREGROUND_COLOR:case h.default.FONT_FAMINY:case h.default.FONT_SIZE:case h.default.BOLD:case h.default.ITALIC:case h.default.STRIKETHROUGH:case h.default.UNDERLINE:n||e.removeSlot(a)}return e}function S(e,t,n){return t>=e.startRowIndex&&t<=e.endRowIndex&&n>=e.startColIndex&&n<=e.endColIndex}t.crossSingleRange=T,t.crossRanges=function(e,t,n){var a=0,r=0,o=0,i=[],l=void 0;for(a=0;a<e.length;a++)for(r=0;r<t.length;r++){for(l=T(e[a],t[r]),o=0;o<l.ranges.length;o++)l.ranges[o].endIndex<l.ranges[o].startIndex&&(l.ranges.splice(o,1),o--);l.ranges.length&&i.push(l.ranges),n&&null!==l.cross&&i.push(l.cross)}return i},t.serializeMutation=E,t.deserializeMutation=function(e,t){try{var n=(0,c.deserialize)(e,t,{notReplaceSheetId:!0});return n.version=I.default.MUTATION_VER_LOWEST_SUPPORT,n}catch(a){throw R.default.run(v.CONFIG.DESERIALIZE_MUTATION,[e,t],a),a}},t.changeGridRangeByInsertDimension=function(e,t,n,a,r,i,d){if(e.sheetId!==t)return e;var s=n===o.default.ROWS?{startIndex:e.startRowIndex,endIndex:e.endRowIndex}:{startIndex:e.startColIndex,endIndex:e.endColIndex},u=function(e,t,n,a,r){return t<e.startIndex?{startIndex:e.startIndex+n,endIndex:e.endIndex+n}:t===e.startIndex?a?{startIndex:e.startIndex,endIndex:e.endIndex+n}:{startIndex:e.startIndex+n,endIndex:e.endIndex+n}:t<=e.endIndex||r&&t===e.endIndex+1?{startIndex:e.startIndex,endIndex:e.endIndex+n}:e}(s,a,r,i,d);return u===s||u.startIndex===s.startIndex&&u.endIndex===s.endIndex?e:n===o.default.ROWS?new l.default(e.sheetId,u.startIndex,u.endIndex,e.startColIndex,e.endColIndex):new l.default(e.sheetId,e.startRowIndex,e.endRowIndex,u.startIndex,u.endIndex)},t.changeCellDataDeltaByMutation=function(e,t){return e},t.changeGridRangeByDeleteDimension=function(e,t,n,a,r){if(e.sheetId!==t)return e;var i=n===o.default.ROWS?{startIndex:e.startRowIndex,endIndex:e.endRowIndex}:{startIndex:e.startColIndex,endIndex:e.endColIndex},d=function(e,t,n){var a={startIndex:t,endIndex:t+n-1};if(0===n)return e;if(e.endIndex<a.endIndex)return e;if(e.startIndex>=a.startIndex&&e.endIndex<=a.endIndex)return{startIndex:a.startIndex,endIndex:a.startIndex-1};var r=e.startIndex,o=e.endIndex;return e.startIndex<a.startIndex&&e.endIndex>=a.startIndex&&e.endIndex<a.endIndex?o=a.startIndex-1:a.startIndex>=e.startIndex&&a.endIndex<=e.endIndex?o-=n:a.startIndex<e.startIndex&&a.endIndex>=e.startIndex&&a.endIndex<e.endIndex?(r=a.startIndex,o-=n):(r-=n,o-=n),{startIndex:r,endIndex:o}}(i,a,r);return d===i||d.startIndex===i.startIndex&&d.endIndex===i.endIndex?e:n===o.default.ROWS?new l.default(e.sheetId,d.startIndex,d.endIndex,e.startColIndex,e.endColIndex):new l.default(e.sheetId,e.startRowIndex,e.endRowIndex,d.startIndex,d.endIndex)},t.isTwoGridRangeCross=m,t.equals=function e(t,n){if(t===n)return!0;if("string"===typeof t||"number"===typeof t||"boolean"===typeof t)return(t=null==t?null:t)===(n=null==n?null:n);if((Array.isArray(t)||null==t)&&(Array.isArray(n)||null==n)){if(null==t||0===t.length)return null==n||0===n.length;if(null==n||t.length!==n.length)return!1;for(var a=0,r=t.length;a<r;a++)if(!e(t[a],n[a]))return!1}return null!=t&&"function"===typeof t.equals?t.equals(n):(t=null==t?null:t)===(n=null==n?null:n)},t.transformTwoCellDataDelta=function(e,t,n){var a=void 0,r=void 0,o=void 0;for(e=e||new d.default,t=t||new d.default,a=0,r=e.setSlots|e.clearSlots;r>0;a++,r>>=1)if(1===(1&r)){if(!y(t.setSlots|t.clearSlots,a))continue;switch(y(e.clearSlots,a)&&y(t.clearSlots,a)&&e.removeSlot(a),a){case s.default.SLOT_USER_ENTERED_FORMAT_DELTA:case s.default.SLOT_EFFIECTIVE_FORMAT_DELTA:(o=x(e.delta.userEnteredFormatDelta,t.delta.userEnteredFormatDelta,n)).isEmpty()?e.removeSlot(a):e.setSlot(a,o);break;case s.default.SLOT_EFFIECTIVE_VALUE:case s.default.SLOT_HYPERLINK:case s.default.SLOT_FORMULA:n||e.removeSlot(a)}}return e},t.isCellInGridRange=S,t.getCrossGridRange=function(e,t){return m(e,t)?new l.default(e.sheetId,Math.max(e.startRowIndex,t.startRowIndex),Math.min(e.endRowIndex,t.endRowIndex),Math.max(e.startColIndex,t.startColIndex),Math.min(e.endColIndex,t.endColIndex)):null},t.getUnionGridRange=function(e,t){return new l.default(e.sheetId,Math.min(e.startRowIndex,t.startRowIndex),Math.max(e.endRowIndex,t.endColIndex),Math.min(e.startColIndex,t.startColIndex),Math.max(e.endColIndex,t.endColIndex))},t.divideCellDataDeltaByBorders=function(e){var t=new d.default,n=e,a=void 0,r=void 0;return(e.setSlots&1<<s.default.SLOT_USER_ENTERED_FORMAT_DELTA)>0?(a=new u.default,r=e.delta.userEnteredFormatDelta,(e.delta.userEnteredFormatDelta.setSlots&1<<h.default.BORDER_TOP)>0?a.setSlot(h.default.BORDER_TOP,e.delta.userEnteredFormatDelta.delta.getBorderTop()):(e.delta.userEnteredFormatDelta.clearSlots&1<<h.default.BORDER_TOP)>0&&a.clearSlot(h.default.BORDER_TOP),r.removeSlot(h.default.BORDER_TOP),(e.delta.userEnteredFormatDelta.setSlots&1<<h.default.BORDER_RIGHT)>0?a.setSlot(h.default.BORDER_RIGHT,e.delta.userEnteredFormatDelta.delta.getBorderRight()):(e.delta.userEnteredFormatDelta.clearSlots&1<<h.default.BORDER_RIGHT)>0&&a.clearSlot(h.default.BORDER_RIGHT),r.removeSlot(h.default.BORDER_RIGHT),(e.delta.userEnteredFormatDelta.setSlots&1<<h.default.BORDER_BOTTOM)>0?a.setSlot(h.default.BORDER_BOTTOM,e.delta.userEnteredFormatDelta.delta.getBorderBottom()):(e.delta.userEnteredFormatDelta.clearSlots&1<<h.default.BORDER_BOTTOM)>0&&a.clearSlot(h.default.BORDER_BOTTOM),r.removeSlot(h.default.BORDER_BOTTOM),(e.delta.userEnteredFormatDelta.setSlots&1<<h.default.BORDER_LEFT)>0?a.setSlot(h.default.BORDER_LEFT,e.delta.userEnteredFormatDelta.delta.getBorderLeft()):(e.delta.userEnteredFormatDelta.clearSlots&1<<h.default.BORDER_LEFT)>0&&a.clearSlot(h.default.BORDER_LEFT),r.removeSlot(h.default.BORDER_LEFT)):(e.clearSlots&1<<s.default.SLOT_USER_ENTERED_FORMAT_DELTA)>0?(a=new u.default({clearSlots:f.CELL_FORMAT_SLOT_COMPOSE.BORDERS}),r=new u.default({clearSlots:f.CELL_FORMAT_SLOT_COMPOSE.ALL&~f.CELL_FORMAT_SLOT_COMPOSE.BORDERS}),t.setSlot(s.default.SLOT_USER_ENTERED_FORMAT_DELTA,a),n.setSlot(s.default.SLOT_USER_ENTERED_FORMAT_DELTA,r)):t=null,{borders:t,other:n}},t.divideGridRangeByCells=function(e,t){var n=[];if(0===t.length)return n.push(e),n;var r,o=void 0,i=void 0,d=void 0,s=[],u=void 0,f=void 0;for(s.push(e),o=0,r=t.length;o<r;o++){for(f=t[o],i=0,d=s.length;i<d;i++){if(S(u=s[i],f.startRowIndex,f.startColIndex)){f.startColIndex>u.startColIndex&&(n.push(new l.default(u.sheetId,u.startRowIndex,u.endRowIndex,u.startColIndex,f.startColIndex-1)),u.startColIndex=f.startColIndex),f.startRowIndex>u.startRowIndex&&(n.push(new l.default(u.sheetId,u.startRowIndex,f.startRowIndex-1,u.startColIndex,u.endColIndex)),u.startRowIndex=f.startRowIndex),f.endRowIndex<u.endRowIndex&&(n.push(new l.default(u.sheetId,f.endRowIndex+1,u.endRowIndex,u.startColIndex,u.endColIndex)),u.endRowIndex=f.endRowIndex),f.endColIndex<u.endColIndex&&(n.push(new l.default(u.sheetId,u.startRowIndex,u.endRowIndex,f.endColIndex+1,u.endColIndex)),u.endColIndex=f.endColIndex),n=[].concat((0,a.default)(n),(0,a.default)(s.slice(i+1)));break}n.push(u)}s=n,n=[]}return n=s},t.getMutationDataSize=function(e){try{var t=[];return e&&e.forEach(function(e){var n=E(e);t.push(n)}),(0,r.default)(t).length}catch(n){return console.error(n),-1}},t.getMonitorByMutationSize=function(e){return e<256?33708829:e<512?33708830:e<1024?33708831:e<4096?33708832:e<8192?33708833:e<16384?33708834:e<32768?33708835:e<51200?33708836:e<102400?33708837:e<204800?33708838:e<512e3?33708839:e<1024e3?33708840:e<2048e3?33708841:e<3072e3?33708842:33708866}},80:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=E(n(3)),r=E(n(0)),o=E(n(1)),i=E(n(4)),l=E(n(5));t.getMergedGridRange=_;var d=E(n(17)),s=E(n(30)),u=E(n(15)),f=E(n(11)),h=E(n(29)),c=n(18),I=E(n(96)),g=E(n(43)),R=E(n(69)),v=n(231),p=E(n(162)),T=E(n(139));function E(e){return e&&e.__esModule?e:{default:e}}var m=function(e){function t(e){(0,r.default)(this,t);var n=(0,i.default)(this,(t.__proto__||(0,a.default)(t)).call(this,d.default.MERGE_CELLS_MUTATION,e));return n.sheetId=e.sheetId,n.startRowIndex=e.startRowIndex,n.endRowIndex=e.endRowIndex,n.startColIndex=e.startColIndex,n.endColIndex=e.endColIndex,n}return(0,l.default)(t,e),(0,o.default)(t,[{key:"serialize",value:function(){return[this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex]}},{key:"getAffectedSheetId",value:function(){return this.sheetId}},{key:"getAffectedSheets",value:function(e){var t,n=[];return(t=e.getSheetBySheetId(this.sheetId))&&n.push(t),n}},{key:"check",value:function(e){if(!new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isValid())return!1;var t=e.getProperties().getGridProperties();return!(this.endRowIndex>=t.rowCount||this.endColIndex>=t.columnCount)}},{key:"runOnSheet",value:function(e){e.addMerge(new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex))}},{key:"invert",value:function(e){return[new R.default({startRowIndex:this.startRowIndex,endRowIndex:this.endRowIndex,startColIndex:this.startColIndex,endColIndex:this.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithInsertDimensionMutation",value:function(e,n){var a=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return e.type===u.default.ROWS?a.insertRows(e.index,e.amount):a.insertCols(e.index,e.amount),[new t({startRowIndex:a.startRowIndex,endRowIndex:a.endRowIndex,startColIndex:a.startColIndex,endColIndex:a.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithDeleteDimensionMutation",value:function(e,n){var a=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);return e.type===u.default.ROWS?a.deleteRows(e.index,e.amount):a.deleteCols(e.index,e.amount),[new t({startRowIndex:a.startRowIndex,endRowIndex:a.endRowIndex,startColIndex:a.startColIndex,endColIndex:a.endColIndex,sheetId:this.sheetId})]}},{key:"transformWithSetRangeMutation",value:function(e,t){var n=[],a=void 0,r=e.cellDataDeltaAtPositions,o=void 0,i=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),l=void 0;if(i.isCross(e.gridRange)){if(t){for(a=0;a<r.length;a++)0!==(o=r[a]).cellDataDelta.setSlots&&(l=new f.default(this.sheetId,o.rowIndex,o.rowIndex,o.colIndex,o.colIndex),i.isCross(l)&&n.push(new g.default({gridRange:l,cellDataDelta:new h.default({setSlots:0,clearSlots:c.CELL_DATA_SLOT_COMPOSE.ALL})})));n.push(this)}}else n.push(this);return n}},{key:"transformWithSetCellPropertiesMutation",value:function(e,t){var n=[],a=[],r=void 0,o=void 0,i=[];if(0===e.cellDataDelta.setSlots)n.push(this);else{for(a=_(new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex)),r=0;r<a.length;r++)(o=a[r].getCross(e.gridRange))&&i.push(o);if(i.length>0){if(t){for(r=0;r<i.length;r++)n.push(new g.default({gridRange:i[r],cellDataDelta:new h.default({setSlots:0,clearSlots:c.CELL_DATA_SLOT_COMPOSE.ALL})}));n.push(this)}}else n.push(this)}return n}},{key:"transformWithMergeCellsMutation",value:function(e,t){var n=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),a=new f.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return n.isCross(a)?t?[new R.default({startRowIndex:e.startRowIndex,endRowIndex:e.endRowIndex,startColIndex:e.startColIndex,endColIndex:e.endColIndex,sheetId:e.sheetId}),this]:[]:[this]}},{key:"transformWithUnmergeCellsMutation",value:function(e,t){var n=[],a=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex),r=new f.default(e.sheetId,e.startRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex);return a.isCross(r)?t&&n.push(e,this):n.push(this),n}},{key:"transformWithDefineFilterMutation",value:function(e,t){var n=[];return new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.gridRange)&&n.push(new p.default({sheetId:e.sheetId,delta:{defaultFilterId:e.delta.defaultFilterId,filterViewId:e.delta.filterViewId}})),n.push(this),n}},{key:"transformWithCopyPasteMutation",value:function(e,t){var n=[];return n.push(this),n}},{key:"transformWithReorderRangeMutation",value:function(e,t){var n=[];return new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex).isCross(e.range)||n.push(this),n}},{key:"transformWithMapRangeMutation",value:function(e,t){var n=[];return(0,v.checkMapRangeIsDimension)(u.default.ROWS,e)||(0,v.checkMapRangeIsDimension)(u.default.COLUMNS,e)||n.push(this),n}},{key:"transformWithDeleteSheetMutation",value:function(e,t){return[this]}},{key:"transformWithDefineSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithUpdateSheetRangeMutation",value:function(e,t){return[this]}},{key:"transformWithAddConditionalFormatMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(e.rule.ruleRanges.some(function(e){return e.isCross(n)})){var a=new f.default(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(e.rule.ruleRanges.some(function(e){return e.contain(a)}))return[this];var r=[];return e.rule.ruleRanges.forEach(function(e){if(e.sheetId===n.sheetId&&e.isCross(n)){var t=e.startRowIndex,a=e.endRowIndex;e.startRowIndex<n.startRowIndex&&(r.push(new f.default(e.sheetId,e.startRowIndex,n.startRowIndex,e.startColIndex,e.endColIndex)),t=n.startRowIndex),n.endRowIndex<e.endRowIndex&&(r.push(new f.default(e.sheetId,n.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),a=n.endRowIndex),e.startColIndex<n.startColIndex&&r.push(new f.default(e.sheetId,t,a,e.startColIndex,n.endColIndex)),n.endColIndex<e.endColIndex&&r.push(new f.default(e.sheetId,t,a,n.endColIndex,e.endColIndex))}else r.push(e)}),0===r.length?[this]:(r.sort(function(e,t){return e.startRowIndex<t.startRowIndex?-1:e.startColIndex<t.startColIndex?-1:e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex}),[this,new T.default({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new I.default({ruleRanges:r,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]}},{key:"transformWithUpdateConditionalFormatMutation",value:function(e,t){if(this.sheetId!==e.sheetId)return[this];var n=new f.default(this.sheetId,this.startRowIndex,this.endRowIndex,this.startColIndex,this.endColIndex);if(e.rule.ruleRanges.some(function(e){return e.isCross(n)})){var a=new f.default(this.sheetId,this.startRowIndex,this.startRowIndex,this.startColIndex,this.startColIndex);if(e.rule.ruleRanges.some(function(e){return e.contain(a)}))return[this];var r=[];return e.rule.ruleRanges.forEach(function(e){if(e.sheetId===n.sheetId&&e.isCross(n)){var t=e.startRowIndex,a=e.endRowIndex;e.startRowIndex<n.startRowIndex&&(r.push(new f.default(e.sheetId,e.startRowIndex,n.startRowIndex,e.startColIndex,e.endColIndex)),t=n.startRowIndex),n.endRowIndex<e.endRowIndex&&(r.push(new f.default(e.sheetId,n.endRowIndex,e.endRowIndex,e.startColIndex,e.endColIndex)),a=n.endRowIndex),e.startColIndex<n.startColIndex&&r.push(new f.default(e.sheetId,t,a,e.startColIndex,n.endColIndex)),n.endColIndex<e.endColIndex&&r.push(new f.default(e.sheetId,t,a,n.endColIndex,e.endColIndex))}else r.push(e)}),0===r.length?[this]:(r.sort(function(e,t){return e.startRowIndex<t.startRowIndex?-1:e.startColIndex<t.startColIndex?-1:e.endRowIndex<t.endRowIndex?-1:e.endColIndex-t.endColIndex}),[this,new T.default({sheetId:e.sheetId,ruleIndex:e.ruleIndex,rule:new I.default({ruleRanges:r,booleanConditionalFormat:e.rule.booleanConditionalFormat,gradientConditionalFormat:e.rule.gradientConditionalFormat}),oldRuleRanges:e.rule.ruleRanges})])}return[this]}}],[{key:"deserialize",value:function(e){return new t({sheetId:e[0],startRowIndex:e[1],endRowIndex:e[2],startColIndex:e[3],endColIndex:e[4]})}}]),t}(s.default);function _(e){var t=[],n=e.sheetId,a=e.startRowIndex,r=e.endRowIndex,o=e.startColIndex,i=e.endColIndex;return r>a&&t.push(new f.default(n,a+1,r,o,i)),i>o&&t.push(new f.default(n,a,a,o+1,i)),t}m.protoMap={0:{name:"sheetId",dataType:String},1:{name:"startRowIndex",dataType:Number},2:{name:"endRowIndex",dataType:Number},3:{name:"startColIndex",dataType:Number},4:{name:"endColIndex",dataType:Number}},t.default=m},89:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=Ee(n(656)),o=Ee(n(54)),i=n(18),l=Ee(i),d=Ee(n(78)),s=Ee(n(62)),u=Ee(n(364)),f=Ee(n(52)),h=n(32),c=Ee(h),I=Ee(n(368)),g=Ee(n(60)),R=Ee(n(109)),v=Ee(n(29)),p=Ee(n(39)),T=Ee(n(227)),E=Ee(n(121)),m=Ee(n(221)),_=Ee(n(156)),y=Ee(n(224)),x=Ee(n(1117)),S=Ee(n(1118)),O=Ee(n(182)),C=Ee(n(225)),D=Ee(n(108)),M=Ee(n(95)),w=Ee(n(185)),A=Ee(n(157)),F=Ee(n(1119)),k=Ee(n(115)),L=Ee(n(183)),N=Ee(n(276)),b=Ee(n(228)),P=Ee(n(15)),U=Ee(n(657)),B=Ee(n(375)),G=Ee(n(658)),V=Ee(n(374)),H=Ee(n(659)),W=Ee(n(373)),z=Ee(n(277)),Y=Ee(n(376)),j=Ee(n(377)),K=Ee(n(186)),$=Ee(n(1122)),Q=Ee(n(378)),Z=Ee(n(660)),X=Ee(n(661)),q=Ee(n(379)),J=Ee(n(275)),ee=Ee(n(35)),te=Ee(n(11)),ne=Ee(n(187)),ae=Ee(n(173)),re=Ee(n(1123)),oe=Ee(n(380)),ie=Ee(n(381)),le=Ee(n(662)),de=Ee(n(314)),se=Ee(n(230)),ue=Ee(n(663)),fe=Ee(n(385)),he=Te(n(55)),ce=Te(n(229)),Ie=Te(n(155)),ge=Te(n(369)),Re=Te(n(51)),ve=Te(n(160)),pe=Te(n(33));function Te(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}function Ee(e){return e&&e.__esModule?e:{default:e}}!function(e){e.PositionCenter=r.default;!function(e){e.CellData=o.default,e.CELL_DATA_SLOT=l.default,e.CELL_DATA_SLOT_COMPOSE=i.CELL_DATA_SLOT_COMPOSE,e.ExtendedValue=d.default,e.EXTENDED_VALUE_TYPE=s.default,e.ErrorValue=u.default,e.ERROR_TYPE=u.default,e.CellFormat=f.default,e.CELL_FORMAT_SLOT=c.default,e.CELL_FORMAT_SLOT_COMPOSE=h.CELL_FORMAT_SLOT_COMPOSE,e.FORMATTED_VALUE_TYPE=I.default,e.FormulaModel=g.default,e.TextFormatRun=R.default,e.CellDataDelta=v.default,e.CellFormatDelta=p.default,e.CellDataDeltaPropertiesMap=T.default;!function(e){e.NumberFormat=E.default,e.NUMBER_FORMAT_TYPE=m.default,e.Color=k.default,e.Borders=_.default,e.BORDER_TYPE=x.default,e.Border=y.default,e.BORDER_STYLE=S.default,e.HORIZONTAL_ALIGN=O.default,e.VERTICAL_ALIGN=C.default,e.WRAP_STRATEGY=D.default,e.TextFormat=M.default,e.UNDERLINE_TYPE=w.default,e.DataValidation=L.default,e.DATA_VALIDATION_RULE_TYPE=A.default,e.DATA_VALIDATION_CONDITION_TYPE=F.default}(e.Format||(e.Format={}))}(e.Cell||(e.Cell={}));!function(e){e.DimensionFormData=N.default,e.DimensionProperties=b.default,e.DIMENSION_TYPE=P.default}(e.Dimension||(e.Dimension={}));!function(e){e.EmbeddedImage=U.default,e.EmbeddedImageClip=B.default,e.EmbeddedObject=G.default,e.EmbeddedObjectPosition=V.default,e.EMBEDDED_OBJECT_TYPE=H.default,e.GridCoordinate=W.default,e.OverlayPosition=z.default}(e.Embedded||(e.Embedded={}));var t;(t=e.Filter||(e.Filter={})).BasicFilter=Y.default,t.Filter=j.default,t.FilterCriteria=K.default,t.SORT_ORDER=$.default;!function(e){e.Cell=Q.default,e.GridProperties=Z.default,e.RowData=X.default,e.Selection=q.default}(e.Grid||(e.Grid={}));!function(e){e.MentionDetail=J.default}(e.Mention||(e.Mention={}));!function(e){e.DimensionRange=ee.default,e.GridRange=te.default,e.SheetRange=ne.default,e.SHEET_RANGE_TYPE=ae.default,e.RANGE_BORDER_TYPE=re.default}(e.Range||(e.Range={}));!function(e){e.BaseSheet=oe.default,e.SheetProperties=ie.default,e.SheetRangeControl=le.default,e.SHEET_TYPE=de.default}(e.Sheet||(e.Sheet={})),function(e){e.Spreadsheet=se.default,e.SpreadsheetProperties=ue.default,e.SPREADSHEET_TYPE=fe.default}(e.Sheet||(e.Sheet={}));!function(e){e.cellDataUtils=he,e.cellFormatUtils=ce,e.colorUtils=Ie,e.formulaUtils=ge,e.rangeUtils=Re,e.serializeUtils=ve}(e.Utils||(e.Utils={}));!function(e){e.DEFAULT_ROW_COUNT=pe.DEFAULT_ROW_COUNT,e.DEFAULT_COL_COUNT=pe.DEFAULT_COL_COUNT,e.DEFAULT_COL_WIDTH=pe.DEFAULT_COL_WIDTH,e.DEFAULT_ROW_HEIGHT=pe.DEFAULT_ROW_HEIGHT,e.DEFAULT_TAB_COLOR=pe.DEFAULT_TAB_COLOR,e.MAX_ROW_COUNT=pe.MAX_ROW_COUNT,e.MAX_COL_COUNT=pe.MAX_COL_COUNT,e.MAX_CELL_COUNT=pe.MAX_CELL_COUNT,e.HYPERLINK_COLOR=pe.HYPERLINK_COLOR,e.DEFAULT_CELL_FORMAT_LITERAL=pe.DEFAULT_CELL_FORMAT_LITERAL,e.BORDER_TYPE=pe.BORDER_TYPE,e.BORDER_WIDTH=pe.BORDER_WIDTH,e.BORDER_STYLE=pe.BORDER_STYLE,e.BORDER_STYLE_PRIORITY=pe.BORDER_STYLE_PRIORITY,e.CSS_BORDER_STYLE=pe.CSS_BORDER_STYLE,e.GRIDLINE_BORDER_STYLE=pe.GRIDLINE_BORDER_STYLE,e.GRIDLINE_BORDER_COLOR=pe.GRIDLINE_BORDER_COLOR}(e.config||(e.config={}))}(a||(a={}));var me=window.T_SHEET||{};window.T_SHEET=me,me.Model=a,t.default=a},95:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1)),o=i(n(115));function i(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.color=null!=t.color?new o.default(t.color):null,t.fontFamily=null!=t.fontFamily?t.fontFamily:null,t.fontSize=null!=t.fontSize?t.fontSize:null,t.bold=null!=t.bold?t.bold:null,t.italic=null!=t.italic?t.italic:null,t.strikethrough=null!=t.strikethrough?t.strikethrough:null,t.underline=null!=t.underline&&Number(t.underline)||null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){var e={};return this.color&&(e[0]=this.color.serialize()),null!==this.fontFamily&&(e[1]=this.fontFamily),null!==this.fontSize&&(e[2]=this.fontSize),null!==this.bold&&(e[3]=this.bold?1:0),null!==this.italic&&(e[4]=this.italic?1:0),null!==this.strikethrough&&(e[5]=this.strikethrough?1:0),null!==this.underline&&(e[6]=this.underline),e}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.color&&(e.color?e.color instanceof o.default?this.color=e.color:this.color?this.color.setProperties(e.color):this.color=new o.default(e.color):this.color=null),"undefined"!==typeof e.fontFamily&&(this.fontFamily=e.fontFamily),"undefined"!==typeof e.fontSize&&(this.fontSize=e.fontSize),"undefined"!==typeof e.bold&&(this.bold=e.bold),"undefined"!==typeof e.italic&&(this.italic=e.italic),"undefined"!==typeof e.strikethrough&&(this.strikethrough=e.strikethrough),"undefined"!==typeof e.underline&&(this.underline=e.underline),this}},{key:"equal",value:function(e){return!(this.color&&!e.color||!this.color&&e.color||this.color&&e.color&&!this.color.equal(e.color))&&((this.fontFamily||"").replace(/"|'/g,"")===(e.fontFamily||"").replace(/"|'/g,"")&&(this.fontSize===e.fontSize&&!!this.bold===!!e.bold&&!!this.italic===!!e.italic&&!!this.strikethrough===!!e.strikethrough&&this.underline===e.underline))}},{key:"clone",value:function(){return new e({color:this.color?this.color.clone():null,fontFamily:null!==this.fontFamily?this.fontFamily:null,fontSize:null!==this.fontSize?this.fontSize:null,bold:null!==this.bold?this.bold:null,italic:null!==this.italic?this.italic:null,strikethrough:null!==this.strikethrough?this.strikethrough:null,underline:null!==this.underline?this.underline:null})}},{key:"toString",value:function(){return"{"+(null!=this.color?this.color._key:"")+","+(null!=this.fontFamily?this.fontFamily:"")+","+(null!=this.fontSize?this.fontSize:"")+","+(this.bold?"1":"")+","+(this.italic?"1":"")+","+(null!=this.strikethrough?this.strikethrough:"")+","+(null!=this.underline?this.underline:"")+"}"}},{key:"_key",get:function(){return"T"+this.toString()}}],[{key:"deserialize",value:function(t){var n={};return n.color=t[0],n.fontFamily=t[1],n.fontSize=t[2],"undefined"!==typeof t[3]&&(n.bold=!!t[3]),"undefined"!==typeof t[4]&&(n.italic=!!t[4]),"undefined"!==typeof t[5]&&(n.strikethrough=!!t[5]),n.underline=t[6],new e(n)}}]),e}();l.protoMap={0:{name:"color",dataType:o.default},1:{name:"fontFamily",dataType:String},2:{name:"fontSize",dataType:Number},3:{name:"bold",dataType:Boolean},4:{name:"italic",dataType:Boolean},5:{name:"strikethrough",dataType:Boolean},6:{name:"underline",dataType:Number}},t.default=l},96:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(0)),r=d(n(1)),o=d(n(11)),i=d(n(382)),l=d(n(1127));function d(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(0,a.default)(this,e),t.ruleRanges=t.ruleRanges||[],t.booleanConditionalFormat=t.booleanConditionalFormat||null,t.gradientConditionalFormat=t.gradientConditionalFormat||null,t.uid=null!=t.uid?t.uid:null,this.setProperties(t)}return(0,r.default)(e,[{key:"serialize",value:function(){var e=[this.ruleRanges.map(function(e){return e.serialize()})];return this.booleanConditionalFormat&&(e[1]=this.booleanConditionalFormat.serialize()),this.gradientConditionalFormat&&(e[2]=this.gradientConditionalFormat.serialize()),null!=this.uid&&(e[3]=this.uid),e}},{key:"setProperties",value:function(e){return"undefined"!==typeof e.ruleRanges&&(this.ruleRanges=e.ruleRanges),"undefined"!==typeof e.booleanConditionalFormat&&(this.booleanConditionalFormat=e.booleanConditionalFormat),"undefined"!==typeof e.gradientConditionalFormat&&(this.gradientConditionalFormat=e.gradientConditionalFormat),"undefined"!==typeof e.uid&&(this.uid=e.uid),this}},{key:"clone",value:function(){return new e({ruleRanges:this.ruleRanges.map(function(e){return e.clone()}),booleanConditionalFormat:this.booleanConditionalFormat?this.booleanConditionalFormat.clone():null,gradientConditionalFormat:this.gradientConditionalFormat?this.gradientConditionalFormat.clone():null,uid:this.uid})}}],[{key:"deserialize",value:function(t){return new e({ruleRanges:t[0].map(function(e){return o.default.deserialize(e)}),booleanConditionalFormat:t[1]?i.default.deserialize(t[1]):null,gradientConditionalFormat:t[2]?l.default.deserialize(t[2]):null,uid:null!=t[3]?t[3]:null})}}]),e}();s.protoMap={0:{name:"ruleRanges",dataType:{type:Array,subType:o.default}},1:{name:"booleanConditionalFormat",dataType:i.default},2:{name:"gradientConditionalFormat",dataType:l.default},3:{name:"uid",dataType:String}},t.default=s}}]);
//# sourceMappingURL=chunk-core-pc-006b4475dd.js.map