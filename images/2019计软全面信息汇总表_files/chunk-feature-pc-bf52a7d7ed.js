(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-feature-pc"],{1308:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.showDialogMergeCellAndRangeNotMatchV2=t.showDialogMergeCellAndRangeNotMatch=t.showDialogIntersectWithPasteMerge=void 0;var a=n(99);t.showDialogIntersectWithPasteMerge=function(){a.dialog.confirm("\u63d0\u793a","\u4e0d\u80fd\u6267\u884c\u4e0e\u5408\u5e76\u5355\u5143\u683c\u76f8\u4ea4\u7684\u7c98\u8d34\uff0c\u5efa\u8bae\u53d6\u6d88\u5408\u5e76\u5355\u5143\u683c\u3002",function(e,t){return t.preventDefault(),t.stopPropagation(),window.focus(),!0},function(e,t){t.preventDefault(),t.stopPropagation(),window.focus()})},t.showDialogMergeCellAndRangeNotMatch=function(){a.dialog.confirm("\u63d0\u793a","\u7c98\u8d34\u7684\u6570\u636e\u4e0e\u9009\u62e9\u7684\u6570\u636e\u5927\u5c0f\u4e0d\u4e00\u6837\uff0c\u65e0\u6cd5\u5bf9\u5408\u5e76\u5355\u5143\u683c\u6267\u884c\u6b64\u64cd\u4f5c\u3002",function(e,t){return t.preventDefault(),t.stopPropagation(),window.focus(),!0},function(e,t){t.preventDefault(),t.stopPropagation(),window.focus()})},t.showDialogMergeCellAndRangeNotMatchV2=function(){a.dialog.alert("\u8b66\u544a","\u65e0\u6cd5\u5bf9\u5408\u5e76\u5355\u5143\u683c\u6267\u884c\u6b64\u64cd\u4f5c\u3002",function(){})}},1309:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyTextHTML=t.getCopyValue=void 0;var a=w(n(31)),r=w(n(41)),i=w(n(9)),o=w(n(14)),l=w(n(63));t.getCopyTextPlain=x,t.isNullOrUndefined=function(e){return!e&&"undefined"!==typeof e&&0!==e},t.getCommonStyle=E,t._getColsStr=k,t._getHeightStr=M,t._getHiddenRowStr=O,t._getHiddenColStr=L,t._isFullLine=N,t._getMergeStr=F,t._getFormulaStr=P,t._getStyleStr=B;var s=n(689),u=n(48),c=n(449),d=n(68),f=n(22),p=w(n(62)),h=w(n(95)),v=n(444),g=n(125),m=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(10)),y=n(33),T=n(51),C=w(n(11)),S=n(407),b=n(288);function w(e){return e&&e.__esModule?e:{default:e}}var R={styles:{}};function x(e,t,n,a){var r=e.startColIndex,i=e.endColIndex,o=e.startRowIndex,l=e.endRowIndex,s="",c=void 0,d=void 0;for(d=o;d<=l;d++)if(!a.get(d)){var p=[];for(c=r;c<=i;c++){var h=n[d]?n[d].values[c]:null;t.getCellDataAtPosition(d,c);var v=h&&h.getFormattedValue()&&h.getFormattedValue().value||"";if(v===u.INVALID_VALUE){var g=n[d]?n[d].values[c]:null;v=(v=g&&g.getEditValue()||"").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;")}p.push(v)}s+=p.join("\t"),d!=l&&(f.isWindows?s+="\r\n":s+="\n")}return s}function E(){if(f.isMobile)return"";var e=I("td"),t=I("table"),n="";if(e||t)n="\x3c!-- td { "+e+" } table { "+t+" } --\x3e";return n}function I(e){return"td"===e?"empty-cells:show;line-height:normal;color:#000;vertical-align:middle;outline-width:0;word-wrap:break-word;word-break:normal;white-space:nowrap; text-align:left;font-family:'Microsoft YaHei','\u5fae\u8f6f\u96c5\u9ed1',sans-serif;font-size:10pt;":"table"===e?"border-collapse: collapse;":""}function _(e,t,n){return""+e.map(function(e){return"<"+e+">"}).concat([n]).concat(t.map(function(e){return"<"+e+"/>"})).join("")}function A(e,t,n,a,r,i,o){for(var l=e.xRange,s=e.yRange,u=l[1],c=s[1],d=!1,f=0,p=0,h=r;h<=c;h++)p+=t.getRowHeight(h);for(var v=a;v<=u;v++)f+=t.getColWidth(v);return p-=o,f-=i,n.position.overlayPosition.widthPixels<=f&&n.position.overlayPosition.heightPixels<=p&&(d=!0),d}function D(e,t,n,l,c,f,m,y,w){var R=e.xRange,x=e.yRange,I=(0,T.convertIXYRangeToGridRange)(e,"sheetId"),D=(0,s.getEffictiveDataRange)(m.rowData,e.xRange[0],e.yRange[0],e.xRange[1],e.yRange[1]),N=D.maxY,V=D.maxX,H=R[0],j=V,Y=x[0],q=N,G="",z="",X=void 0,W=void 0,$=void 0,K=void 0,Q=void 0,Z="\x3c!--cutShapeIDs",J=function(e){if(e.selectAll)return"all";if(e.selectRow)return"row";if(e.selectCol)return"col";return"cells"}(y);z+='<table style="border-collapse:collapse" selectType="'+J+'">',z+=k(H,j,m.columnMetadata);var ee=n[0],te=function(e){var t=e.rowCount,n=e.colCount,a=e.range,r=e.tableData,l=a.xRange,s=a.yRange,u=l[0],c=l[1],d=s[0],f=s[1],p=new Array,h=r.getImages();for(var v in h){for(var g=h[v],m=g.position.overlayPosition.anchorCell.colIndex,y=g.position.overlayPosition.anchorCell.rowIndex,T=g.position.overlayPosition.offsetXpixels;T>=r.getColWidth(m)&&m<=n-1;)T-=r.getColWidth(m),m++;for(var C=g.position.overlayPosition.offsetYpixels;C>=r.getRowHeight(y)&&y<=t-1;)C-=r.getRowHeight(y),y++;if(y>=d&&y<=f&&m>=u&&m<=c&&A(a,r,g,m,y,T,C)){var S=y+"_"+m,w=(0,o.default)({},(0,b.convertEmbeddedImage2ShapeData)(g));if(w.offset.x=T,w.offset.y=C,p.hasOwnProperty(S))p[S].push(w);else{var R=new Array;R.push(w),p[S]=R}}}return console.log("includedImg keys : "+(0,i.default)(p)),p}({range:e,tableData:t,rowCount:n.length,colCount:ee?ee.values.length:0});for(var ne in te)if(Object.prototype.hasOwnProperty.call(te,ne)){var ae=ne.split("_").map(function(e){return parseInt(e,10)}),re=(0,r.default)(ae,2),ie=re[0],oe=re[1];oe>j&&(j=oe),ie>q&&(q=ie)}for($=Y;$<=q;$++)if(!l.get($)){for(Q=O(H,j,m.columnMetadata.length,$,m.rowMetadata),K=M($,m.rowMetadata),z+="<tr "+K+Q+">",W=H;W<=j;W++){var le=W,se=$,ue=(X=n[se]?n[se].values[le]:null)?X.mergeReference:null;if(ue){var ce=(ue=ue.clone()).startColIndex,de=ue.startRowIndex,fe=(0,s.calMergeCellXYUnitPosition)({mergeReference:ue,filterHideRowMap:l,copyRange:I}),pe=fe.xUnit,he=fe.yUnit,ve=fe.x,ge=fe.y;ve===W&&ge===$?(ue=pe>1||he>1?new C.default("sheetid",ge,ge+he-1,ve,ve+pe-1):null,le=ce,X=n[se=de]?n[se].values[le]:null):ue=null}else ue=null;if("",!(0,S.cellIsMergedCell)(X,se,le)||ue){var me=X&&X.getUserEnteredFormat(),ye="",Te=me&&me.getTextFormat()||new h.default;if(X&&me){var Ce=Te?Te.fontSize:null,Se=me.getNumberFormat();ye+=B(X,Ce,Se,n,Te,me)}else ye+=U();$===Y&&L(Y,q,m.rowMetadata.length,W,m.columnMetadata);var be="";ue&&(be+=F(ue,le,se,l,c,f));var we="",Re=void 0,xe=X&&X.getFormula();xe&&(we=xe.toString(se,le),w===d.CopyType.copy&&(Re=(0,v.getRelativeFormulaWithFormula)(we,se,le)));var Ee="";Re&&"string"===typeof Re&&(Ee+=P(Re)),z+='<td style="'+ye+'"'+be+Ee+">";var Ie=X&&X.getHyperlink(),_e=!!Ie;if(_e)z+='<a href="'+Ie+'" title="" style="cursor: default;color: blue; text-decoration: underline;pointer-events: auto">';var Ae=Te.strikethrough,De=[];Ae&&De.push("s");var ke=De.reverse();if(Re&&"string"===typeof Re?z+=X?(0,g.getMergedValue)(X):"\u8ba1\u7b97\u4e2d...":function(){var e=X&&X.getEffectiveValue(),t=X&&X.getTextFormatRuns();if(e&&e.type===p.default.STRING&&"string"===typeof e.value&&t){var n=e.value;we=t.map(function(e,a){var r=t[a+1]?t[a+1].startIndex:n.length,i=n.slice(e.startIndex,r);if(i=i.replace(/</g,"&lt;").replace(/>/g,"&gt;"),!e.format)return i;var o=e.format,l=o.fontSize,s=o.color,u=o.fontFamily,c=o.bold,d=o.italic,f=o.strikethrough,p=o.underline,h=[];l&&h.push("font-size:"+l+"pt"),s&&h.push("color:"+s.toHex()),d&&h.push("font-style:italic"),c&&h.push("font-weight:bold"),p&&h.push("text-decoration:underline"),u&&h.push("font-family:"+u.replace(/"/g,"'"));var v=h.join(";")+";",g=[];f&&g.push("s");var m=g.reverse();return'<font style="'+v+'">'+_(g,m,i)+"</font>"}).join("")}else if((we=X?(0,g.getMergedValue)(X):"")===u.INVALID_VALUE){var a=X&&X.getEditValue()||"";we=(we=a.replace(/\ufeff/g,"")).replace(/</g,"&lt;").replace(/>/g,"&gt;")}else we=(we+"").replace(/\ufeff/g,"").replace(/</g,"&lt;").replace(/>/g,"&gt;");we=we.replace(/\r?\n/g,'<br style="mso-data-placement:same-cell;">'),z+=_(De,ke,we)}(),_e&&(z+="</a>"),te&&(0,i.default)(te).length>0)if(ue)for(var Me=ue.startRowIndex,Oe=ue.endRowIndex,Le=ue.startColIndex,Ne=ue.endColIndex,Fe=Me;Fe<=Oe;Fe++)for(var Pe=Le;Pe<=Ne;Pe++){var Be=te[Fe+"_"+Pe];if(Be&&Be.length>0){for(var Ue=0,Ve=Pe;Ve>Le;Ve--)Ue+=t.getColWidth(Ve-1);for(var He=0,je=Fe;je>Me;je--)He+=t.getRowHeight(je-1);var Ye=!0,qe=!1,Ge=void 0;try{for(var ze,Xe=(0,a.default)(Be);!(Ye=(ze=Xe.next()).done);Ye=!0){var We=ze.value,$e='<img src="'+We.url+'" width='+We.size.width+" height="+We.size.height+' style="width: '+We.size.width+"px; height: "+We.size.height+"px; margin-left: "+(We.offset.x+Ue)+"px; margin-top: "+(We.offset.y+He)+'px" data-clip="'+We.clipInfo.clipTop+"px "+We.clipInfo.clipRight+"px "+We.clipInfo.clipBottom+"px "+We.clipInfo.clipLeft+'px"/>';z+=$e,Z+=We.id+"|"}}catch(rt){qe=!0,Ge=rt}finally{try{!Ye&&Xe.return&&Xe.return()}finally{if(qe)throw Ge}}}}else{var Ke=te[se+"_"+le];if(Ke&&Ke.length>0){var Qe=!0,Ze=!1,Je=void 0;try{for(var et,tt=(0,a.default)(Ke);!(Qe=(et=tt.next()).done);Qe=!0){var nt=et.value,at='<img src="'+nt.url+'" width='+nt.size.width+" height="+nt.size.height+' style="width: '+nt.size.width+"px; height: "+nt.size.height+"px; margin-left: "+nt.offset.x+"px; margin-top: "+nt.offset.y+'px" data-clip="'+nt.clipInfo.clipTop+"px "+nt.clipInfo.clipRight+"px "+nt.clipInfo.clipBottom+"px "+nt.clipInfo.clipLeft+'px"/>';z+=at,Z+=nt.id+"|"}}catch(rt){Ze=!0,Je=rt}finally{try{!Qe&&tt.return&&tt.return()}finally{if(Ze)throw Je}}}}z+="</td>"}}z+="</tr>"}return te&&(0,i.default)(te).length>0&&(Z=Z.substring(0,Z.length-1),z+=Z+="cutShapeIDs--\x3e"),z+="</table>",G+='<html xmlns:x="tencent"><meta charset="utf-8"><style type=\'text/css\'>'+E()+"</style>",G+="<body>\x3c!--StartFragment--\x3e",G+=z,G+="\x3c!--EndFragment--\x3e</body></html>"}function k(e,t,n){for(var a="",r=e;r<=t;r++){var i=n[r],o=i?i.pixelSize:y.DEFAULT_COL_WIDTH;a+="<col "+(!!i&&i.hiddenByUser?' hiddenCol="hiddenCol" ':"")+' width="'+o+'" style="width: '+o+'px;">'}return a}function M(e,t){var n=t[e],a=n?n.pixelSize:null,r=!!a;return' height="'+(a=a||y.DEFAULT_ROW_HEIGHT)+'" style="mso-height-source:'+(r?"userset":"auto")+";height:"+a+'px;"'}function O(e,t,n,a,r){var i="";if(N(e,t,n)&&r&&r[a]){var o=r[a];o&&o.getHiddenByUser()&&(i=' hiddenRow="hiddenRow" ')}return i}function L(e,t,n,a,r){var i="";return N(e,t,n)&&r&&r[a]&&(i=' hiddenCol="hiddenCol" '),i}function N(e,t,n){return 0===e&&t-e+1>=n}function F(e,t,n,a,r,i){var o="";if(e){for(var l=e.getColCount(),s=t+l-1,u=t;u<=s;u++)i&&i[u]&&(l-=1);for(var c=e.getRowCount(),d=n+c-1,f=n;f<=d;f++)r&&r[f]&&(c-=1);o=' colspan="'+l+'" rowspan="'+c+'" '}return o}function P(e){var t="";return e&&(t=' data-online-sheet-formula="'+e.replace(/"/g,"&#34;")+'" '),t}function B(e,t,n,a,r,i){var o=[],l=i.getBackgroundColor();if(l){var s=l.toHex();s!==y.DEFAULT_CELL_FORMAT_LITERAL.backgroundColor&&o.push("background-color:"+s)}o.push("font-size:"+(t||y.DEFAULT_CELL_FORMAT_LITERAL.fontSize)+"pt");var d=r.color?r.color:R.styles.color;d!==R.styles.color&&d&&o.push("color:"+d.toHex()),r.italic&&o.push("font-style:italic"),r.bold&&o.push("font-weight:bold"),r.underline&&o.push("text-decoration:underline"),o.push("font-family:"+(r.fontFamily?r.fontFamily.replace(/"/g,"'"):y.DEFAULT_CELL_FORMAT_LITERAL.fontFamily));var f=i.getBorderTop(),p=i.getBorderRight(),h=i.getBorderBottom(),v=i.getBorderLeft(),T=e.getMergeReference();function C(e){var t=e.color?e.color.toHex():"#000000";return("number"===typeof e.style?y.CSS_BORDER_STYLE[e.style]:y.CSS_BORDER_STYLE[y.BORDER_STYLE.THIN])+" "+t}if(f&&(f.color||f.style)&&o.push("border-top: "+C(f)),!T&&p&&(p.color||p.style)&&o.push("border-right: "+C(p)),!T&&h&&(h.color||h.style)&&o.push("border-bottom: "+C(h)),v&&(v.color||v.style)&&o.push("border-left: "+C(v)),T){var S=T.startRowIndex,b=T.endRowIndex,w=T.startColIndex,x=T.endColIndex;if(a&&a[S]&&a[S].values&&a[S].values[x]){var E=a[S].values[x];if(E)if(E.getUserEnteredFormat()){var I=i.getBorderRight();I&&(I.color||I.style)&&o.push("border-right: "+C(I))}}if(a&&a[b]&&a[b].values&&a[b].values[w]){var _=a[S].values[x];if(_)if(_.getUserEnteredFormat()){var A=i.getBorderBottom();A&&(A.color||A.style)&&o.push("border-bottom: "+C(A))}}}var D=(0,g.getMergedFormat)(e,m.SET_CELLDATA.VERTICAL_ALIGN);D&&o.push("vertical-align:"+D);var k=(0,g.getMergedFormat)(e,m.SET_CELLDATA.TEXT_ALIGN);k&&o.push("text-align:"+k);var M=i.getWrapStrategy();if(M&&o.push("white-space:"+M),n){var O=(0,c.escapeCssSequence)((0,u.getFormatCodeByNumberFormat)(n));o.push("mso-number-format: "+O)}return o.join(";")+";"}function U(){var e="";return e+="font-size: "+y.DEFAULT_CELL_FORMAT_LITERAL.fontSize+"pt;",e+="font-family: "+y.DEFAULT_CELL_FORMAT_LITERAL.fontFamily+";"}t.getCopyValue=function(e){var t=e.spreadsheetApp,n=e.copyType,a=e.range,r=e.select,i=e.previewActiveSheetId,o=i&&t.preview.previewsheet.getSheetBySheetId(i),s=o||t.spreadsheet.activeSheet,u=(new Date).getTime().toString();if(!s)return{timeStamp:u,html:"",plain:""};var c=s.data.rowData,d=s.getBasicFilter(),p=d?d.filterHideRowMap:new l.default,h=r.selectRow?s.data.rowMetadata:[],v=r.selectCol?s.data.columnMetadata:[],g=(0,T.convertIXYRangeToGridRange)(a,s.getSheetId()),m=f.isWxMiniProgram&&f.isAndroid,y=r.selectCol||r.selectRow||r.selectAll;return{timeStamp:u,html:m&&y?"":D(a,s,c,p,h,v,t.spreadsheet.activeSheet.data,r,n),plain:x(g,s,c,p)}},t.getCopyTextHTML=D},1312:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=u(n(41)),r=u(n(0)),i=u(n(1)),o=u(n(1313)),l=n(693),s=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}var c=function(){function e(){(0,r.default)(this,e)}return(0,i.default)(e,[{key:"securityCheck",value:function(e){return e=this.deleteTagByTagName(e,"script"),e=this.deleteTagByTagName(e,"iframe")}},{key:"deleteTagByTagName",value:function(e,t){if(!e||!t)return e;for(var n,a=e,r=100;r--;){if((n=this.deleteOneTagByTagName(a,t))===a)return n;a=n}return 0==r?"":n}},{key:"deleteOneTagByTagName",value:function(e,t){if(!t)return e;var n=e.indexOf("<"+t);if(-1!=n){var a=e.indexOf("</"+t);if(-1!=a)return e.substring(0,n)+e.substring(a+t.length+3)}return e}},{key:"getTableHTML",value:function(e){if(!e)return{};if(!(e=this.securityCheck(e)))return{};var t=document.createElement("iframe");(t=t).name="copyTemplate",t.style.position="absolute",t.style.top="99999px",t.style.left="99999px",document.body.appendChild(t);var n=window.frames.copyTemplate.document,a=document.createElement("meta");a.setAttribute("http-equiv","Content-Security-Policy"),a.setAttribute("content","script-src 'none';  child-src 'none';"),n.getElementsByTagName("head")[0].appendChild(a),n.body.innerHTML=e,s.default.wait(0).run(function(){t.remove()});var r=null,i=n.body.lastElementChild,o=n.getElementsByTagName("style")[0];return i&&i.tagName&&"table"===i.tagName.toLowerCase()&&(r=i),{table:r,stylesheet:o}}},{key:"parsePasteTableHTML",value:function(e,t){return e?function(e,t){var n=new Date,a=o.default.getSingleton().parse(e,t,!0),r=new Date;return console.log("cost: "+(r.getTime()-n.getTime())+"ms"),a}(e,t):null}},{key:"parseHTML",value:function(e){if(!e)return null;if(e=this.securityCheck(e),!(e=this.clipHTML(e)))return null;var t=(new DOMParser).parseFromString(e,"text/html"),n=this.parseFromApp(t),a=this.parseSelectType(t);if(t&&t.body){var r="",i=t.getElementsByTagName("style")[0];i&&(r=i.outerHTML);var o=this.parseNodes(t.body);if(o){var l=this.isNodesContainTable(o.nodes),s=this.convertToTableElement(o.nodes,o.cols,r),u=s.table;if(!u)return null;var c=s.stylesheet,d="";c&&c.innerHTML&&(d=c.innerHTML);var f=this.parsePasteTableHTML(u,d);return f.selectType=a,{table:f,images:o.images,fromApp:n,containTable:l}}return null}}},{key:"parseNodes",value:function(e){var t=[],n=[],a=0,r=1,i=s("style"),o=s("body"),l=s("a,address,article,applet,aside,audio,blockquote,button,canvas,center,div,dd,del,dir,dl,dt,fieldset,figcaption,figure,footer,form,frameset,h1,h2,h3,h4,h5,h6,header,hgroup,hr,iframe,img,ins,isindex,li,map,menu,noframes,noscript,object,ol,output,p,pre,section,script,table,tbody,td,tfoot,th,thead,tr,ul,video");function s(e){for(var t={},n=e.split(","),a=0;a<n.length;a++)t[n[a]]=!0;return t}if(e){var u=[];for(u.push(e);0!=u.length;){var c=u.pop();if(c.nodeType!==Node.TEXT_NODE){if(c.nodeType===Node.ELEMENT_NODE){var d=c.tagName.toLowerCase();if(l[d]){if("div"===d){if(c.getElementsByTagName("div").length>0){for(var f=(N=c.childNodes).length-1;f>=0;f--)u.push(N[f]);continue}if(1==(N=c.childNodes).length){var p=N[0];if(p.nodeType===Node.TEXT_NODE){var h=p.nodeValue;(h=h.replace(/^\s+|\s+$/g,"")).length>0&&(t.push([c]),a+=1)}else p.nodeType===Node.ELEMENT_NODE&&u.push(p)}else if(N.length>1)for(f=N.length-1;f>=0;f--)u.push(N[f]);continue}if("table"===d){if(0==c.rows.length)continue;a+=c.rows.length-1;var v=c.rows[0].cells.length;r=Math.max(r,v)}var g=c.getElementsByTagName("img");if("img"===d&&(g=[c]),g&&g.length>0)for(var m=0;m<g.length;m++){var y=g[m],T=y.src,C=0,S=0+a,b=S,w=y.getAttribute("width"),R=y.getAttribute("height");if(!(w&&w<=2&&R&&R<=2)){var x="undefined"!==typeof y.attributes["v:shapes"];if("table"===d){for(var E=[].slice.call(c.rows),I=y.parentNode;"td"!==I.tagName.toLowerCase();)I=I.parentNode;for(var _=I.parentNode;"tr"!==_.tagName.toLowerCase();)_=_.parentNode;if(-1===E.indexOf(_)){for(I=I.parentNode;"td"!==I.tagName.toLowerCase();)I=I.parentNode;for(_=I.parentNode;"tr"!==_.tagName.toLowerCase();)_=_.parentNode}C=0+[].slice.call(_.children).indexOf(I),b=S=0+E.indexOf(_),a+=t.length}else if("img"!==d){var A=c.innerText||"";b=S,(A=A.replace(/^\s+|\s+$/g,"")).length>0&&(S+=1)}var D=this.getImageData(y,T,b,C,x);D&&n.push(D)}}t.push([c]),a+=1;continue}if("br"===d){(B=(P=t[t.length-1])&&P[P.length-1])&&B&&B.tagName&&"span"===B.tagName.toLowerCase()&&B&&!B.newRow&&(B.newRow=!0);continue}if(0==c.children.length){var k=c.innerText||"";if((k=k.replace(/^\s+|\s+$/g,"")).length>0)if(console.log("content"+k),(B=(P=t[t.length-1])&&P[P.length-1])&&B.newRow||B&&"span"!==B.tagName.toLowerCase())i[c.tagName.toLowerCase()]||(t.push([c]),a+=1);else if(B&&"span"===B.tagName.toLowerCase()){for(var M=B.parentNode,O="";M&&(O=M.tagName.toLowerCase(),M.nodeType!==Node.ELEMENT_NODE||!l[O]&&!o[O]);)M=M.parentNode;var L=c.parentNode;for(O="";L&&(O=L.tagName.toLowerCase(),L.nodeType!==Node.ELEMENT_NODE||!l[O]&&!o[O]);)L=L.parentNode;B&&!B.newRow&&(M||L)&&M===L?P.push(c):(t.push([c]),a+=1)}else B&&!B.newRow?P.push(c):i[c.tagName.toLowerCase()]||(t.push([c]),a+=1);continue}}var N;for(f=(N=c.childNodes).length-1;f>=0;f--)u.push(N[f])}else{var F=c.nodeValue;if((F=F.replace(/^\s+|\s+$/g,"")).length>0){console.log("content"+F);var P,B=(P=t[t.length-1])&&P[P.length-1],U=document.createElement("span");U.innerText=F,B&&B.tagName&&"span"===B.tagName.toLowerCase()&&B&&!B.newRow?(a+=1,P.push(U)):t.push([U])}}}}return{nodes:t,images:n,cols:r}}},{key:"getImageData",value:function(e,t,n,r,i){var s=o.default.getSingleton(),u=/^data:image\/(png|gif|jpeg|x-icon|jpg|tiff);base64,.+/i.test(t),c="";if(c=window.devicePixelRatio&&window.devicePixelRatio>=2?l.retinaPlaceHolderUrl:l.placeHolderUrl,t.match(/^file:\/\/[\/].+(gif|jpg|jpeg|tiff|png)$/i)||t.match(/^[a-zA-Z]:.+(gif|jpg|jpeg|tiff|png)$/i)||i&&t&&!u)return t=c,e.src=t,{isLocal:!0,isFromHTML:!0,id:"attachment-"+ +new Date+"-"+(0,l.randomString)(4),url:t,order:void 0,size:{width:440,height:330},anchor:{row:n,col:r},offset:{x:0,y:0},clipInfo:{clipTop:0,clipLeft:0,clipRight:0,clipBottom:0}};if(s.validUrl(t)||u){var d="qpic.cn"===function(e){var t,n;return(n=e.match(/^(?:https?:\/\/)?(?:[^@\n]+@)?(?:www\.)?([^:\/\n\?\=]+)/im))&&(n=(t=n[1]).match(/^[^\.]+\.(.+\..+)$/))&&(t=n[1]),t}(t),f=e.style.width?parseInt(e.style.width.replace("px","")):-1,p=e.style.height?parseInt(e.style.height.replace("px","")):-1,h=0,v=0,g=0,m=0,y=e.dataset.clip;if(y){var T=y.match(/[\d\.]+/g);if(T.length>=4){var C=T.map(Number),S=(0,a.default)(C,4);h=S[0],v=S[1],g=S[2],m=S[3]}}var b=e.style.marginLeft?parseInt(e.style.marginLeft.replace("px","")):-1,w=e.style.marginTop?parseInt(e.style.marginTop.replace("px","")):-1;return{isLocal:d,isFromHTML:!0,placeHolder:!0,url:d?t:c,id:"attachment-"+ +new Date+"-"+(0,l.randomString)(4),type:"pic",order:void 0,anchor:{row:n,col:r},offset:{x:b,y:w},size:{width:f,height:p},clipInfo:{clipTop:h,clipLeft:m,clipRight:v,clipBottom:g}}}return null}},{key:"parseFromApp",value:function(e){if(!e)return null;var t=e.getElementsByTagName("html")[0],n=t&&t.getAttribute("xmlns:x");return"urn:schemas-microsoft-com:office:excel"===n?"excel":"tencent"===n?"tencent":void 0}},{key:"parseSelectType",value:function(e){if(!e)return null;var t=e.getElementsByTagName("table")[0];return t&&t.getAttribute("selectType")}},{key:"clipHTML",value:function(e){if(!e)return null;function t(e,t,n,a){var r=e.indexOf(t),i=e.lastIndexOf(n);return-1!=r&&-1!=i&&(a?r+=t.length:i+=n.length,e=e.substring(r,i)),e}var n="<html>\r\n<body>\r\n\x3c!--StartFragment--\x3e",a="\x3c!--EndFragment--\x3e\r\n</body>\r\n</html>";return e=t(e,n,a,!0),e=t(e,n="<html",a="</html>",!1)}},{key:"convertToTableElement",value:function(e,t,n){if(1===e.length&&e[0]&&e[0][0]&&e[0][0].tagName&&"table"===e[0][0].tagName.toLowerCase()){var a=e[0][0].outerHTML;return this.getTableHTML(n+a)}for(var r="<table>",i=0;i<e.length;i++){var o=e[i];if(o[0]&&o[0].tagName&&"table"===o[0].tagName.toLowerCase()){var l=o[0],s=l.getElementsByTagName("thead")[0];s&&(r+=s.innerHTML);var u=l.getElementsByTagName("colgroup")[0];u&&(r+=u.innerHTML);var c=l.getElementsByTagName("tbody")[0];c&&(r+=c.innerHTML);var d=l.getElementsByTagName("tfoot")[0];d&&d.innerHTML,s||c||d||u||(r+=l.innerHTML)}else{var f="<tr>";f+="<td>"+(o.map?o.map(function(e){return e.outerHTML}).join(""):o.outerHTML)+"</td>";for(var p=1;p<t;p++)f+="<td></td>";r+=f+="</tr>"}}return r+="</table>",this.getTableHTML(n+r)}},{key:"isNodesContainTable",value:function(e){for(var t=0;t<e.length;t++)for(var n=e[t],a=0;a<n.length;a++){if("table"===(n[a].tagName&&n[a].tagName.toLowerCase()))return!0}return!1}}],[{key:"getSingleton",value:function(){return d}}]),e}(),d=new c;t.default=c},1313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(84)),r=d(n(0)),i=d(n(1)),o=d(n(1314)),l=n(48),s=n(1316),u=n(1317),c=n(33);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(){(0,r.default)(this,e),this.init(),this.getHexColor=this.getHexColor.bind(this)}return(0,i.default)(e,[{key:"init",value:function(){this.initNotificationCenter(),this.initSubscription()}},{key:"initNotificationCenter",value:function(){this.notificationCenter=[]}},{key:"initSubscription",value:function(){this.subscribe("beforeStandardizeCells",this.standardizeCellsWithMergeCells),this.subscribe("beforeParseCell",this.parseFormula),this.subscribe("beforeParseCell",this.parseData),this.subscribe("beforeParseCell",this.parseFontFamily),this.subscribe("beforeParseCell",this.parseFontSize),this.subscribe("beforeParseCell",this.parseFontColor),this.subscribe("beforeParseCell",this.parseFontWeight),this.subscribe("beforeParseCell",this.parseFontStyle),this.subscribe("beforeParseCell",this.parseFontDecoration),this.subscribe("beforeParseCell",this.parseBackgroundColor),this.subscribe("beforeParseCell",this.parseBorder),this.subscribe("beforeParseCell",this.parseTextAlign),this.subscribe("beforeParseCell",this.parseVerticalAlign),this.subscribe("beforeParseCell",this.parseWhiteSpace),this.subscribe("beforeParseCell",this.parseLink),this.subscribe("beforeParseCell",this.parseFormat),this.subscribe("beforeParseCell",this.parseTextFormatRuns)}},{key:"initTableInfo",value:function(e){this.clearTableInfo(),this.cache={tableDOM:e,mSOStyle:null,mergeCells:[],cellsStyleMaps:[[]]},this.tableInfo={styles:null}}},{key:"clearTableInfo",value:function(){delete this.tableInfo,delete this.cache}},{key:"parse",value:function(e,t,n){if(!e)return null;this.initTableInfo(e),this.cache.mSOStyle=null;try{this.cache.mSOStyle=new o.default(t||"")}catch(x){console.warn("\u89e3\u6790\u683c\u5f0f\u76f8\u5173\u6837\u5f0f\u62a5\u9519"),console.error(x)}this.nowrap=n;for(var a=this.parseSizeInfo(),r=this.getStandardCells(),i=[],l=[],s=[],u=[],c=0,d=a?a.row:0;c<d;c++){var f=r[c];!i[c]&&(i[c]=[]),!l[c]&&(l[c]=[]),!s[c]&&(s[c]=[]),!u[c]&&(u[c]=[]);for(var p=0,h=a?a.col:0;p<h;p++){var v=f[p];if(v){var g={style:{},data:null,template:{}},m=getComputedStyle(v),y=void 0;this.cache.mSOStyle&&(y=this.cache.cellsStyleMaps[c]&&this.cache.cellsStyleMaps[c][p]),this.notify("beforeParseCell",v,m,g,c,p,i,y);var T=!1;try{if("colspan"===y["mso-ignore"]){var C=parseInt(v.attributes.colspan.value);if(C>1){var S=g.style.border,b=S.colors[1];S.colors[1]=null,T=!0,i[c].push(g.style),l[c].push(g.data),s[c].push(g.template),u[c].push(g.formula);for(var w=1;w<C;w++){f[p+w];var R={style:{border:{colors:[null,null,null,null],styles:[null,null,null,null]}},data:null,template:{},formula:void 0};R.style.border.colors[0]=g.style.border.colors[0],R.style.border.colors[2]=g.style.border.colors[2],w===C-1&&(R.style.border.colors[1]=b),i[c].push(R.style),l[c].push(R.data),s[c].push(R.template),u[c].push(R.formula)}}}}catch(x){}T||(i[c].push(g.style),l[c].push(g.data),s[c].push(g.template),u[c].push(g.formula))}else i[c].push(null),l[c].push(null),s[c].push(null),u[c].push(null)}}return this.nowrap=null,{styles:i,data:l,template:s,formula:u,mergeCells:this.cache.mergeCells,size:a,hiddenRowCol:{hiddenRows:a.hiddenRows,hiddenCols:a.hiddenCols}}}},{key:"parseData",value:function(e,t,n,a,r,i,o){if(e){var l=e.innerText||e.textContent;n.data=l&&"\u3000"!=l&&"\xa0"!==l?l:""}}},{key:"parseFormula",value:function(e,t,n,a,r,i,o){if(e){var l=e.getAttribute("data-online-sheet-formula");n.formula=l&&"string"===typeof l?l:null}}},{key:"parseFontFamily",value:function(e,t,n,a,r,i,o){if(t){var l=t.fontFamily;if(!l)return;var s=l.indexOf(",");-1!=s&&(l=l.slice(0,s)),'"'==l[0]&&(l=l.slice(1,l.length-1)),l=l.replace(/-webkit-standard|-webkit-body|-webkit-pictograph/g,""),n.style.fontfamily=l}}},{key:"parseFontSize",value:function(e,t,n,a,r,i,o){if(t){var l=parseFloat(t.fontSize);if(o&&o["font-size"]){var s=o["font-size"];if(-1!==s.toString().toLowerCase().indexOf("pt"))return void(n.style.fontsize=s);l=parseFloat(s)}l=3*l/4,(l=Math.round(10*l)/10)&&(n.style.fontsize=l+"pt")}}},{key:"parseFontColor",value:function(e,t,n,a,r,i,o){if(t){var l=this.getHexColor(t.color);l&&(n.style.fontcolor=l)}}},{key:"getHexColor",value:function(e){if("string"==typeof e)return"#"==e[0]?e:"rgb"==e.substring(0,3).toLowerCase()?(this.cache.rgba2hex||(this.cache.rgba2hex={}),this.cache.rgba2hex[e]||(this.cache.rgba2hex[e]=this.rgba2hex(e)),this.cache.rgba2hex[e]):u.standard16colorsMapping[e]?u.standard16colorsMapping[e]:void 0}},{key:"rgba2hex",value:function(e){var t=e.toString().match(/\d+(\.\d+)?/g),n=1;if("undefined"!=typeof t[3]&&(n=Number(t[3])),0==n)return"";var a="#";if(1===n)for(var r=0;r<3;r++)a+=("0"+Number(t[r]).toString(16)).slice(-2);else{for(r=0;r<3;r++)a+=("0"+Number(t[r]).toString(16)).slice(-2);a+=(255*n).toString(16).substring(0,2)}return a}},{key:"parseFontWeight",value:function(e,t,n,a,r,i,o){t&&("bold"!=t.fontWeight&&700!=t.fontWeight||(n.style.bold="bold"))}},{key:"parseFontStyle",value:function(e,t,n,a,r,i,o){t&&"italic"==t.fontStyle&&(n.style.italic="italic")}},{key:"parseFontDecoration",value:function(e,t,n,a,r,i,o){if(t&&(-1!=t.textDecoration.indexOf("underline")&&(n.style.underline="underline"),-1!=t.textDecoration.indexOf("line-through")&&(n.style.strikeline="strikeline")),e)for(var l=e.firstElementChild,s=10;l&&s--;)"u"==l.tagName.toLowerCase()?n.style.underline="underline":"s"==l.tagName.toLowerCase()&&(n.style.strikeline="strikeline"),l=l.firstElementChild}},{key:"parseBackgroundColor",value:function(e,t,n,a,r,i,o){if(t){var l=this.getHexColor(t.backgroundColor);l&&(n.style.cellcolor=l)}}},{key:"parseBorder",value:function(e,t,n,a,r,i,o){var l=this;if(t){var s=function(e){var t=e.split(" "),n=null;return t&&t.length>2&&(n=t.slice(0,2).join(" ")),n?u(n):null},u=function(e){var t={none:c.BORDER_STYLE.NONE,".5pt hairline":c.BORDER_STYLE.HAIR,".5pt dot-dash":c.BORDER_STYLE.DASH_DOT,".5pt dot-dot-dash":c.BORDER_STYLE.DASH_DOT_DOT,".5pt dotted":c.BORDER_STYLE.DOTTED,".5pt dashed":c.BORDER_STYLE.DASHED,".5pt solid":c.BORDER_STYLE.THIN,"1.0pt dot-dot-dash":c.BORDER_STYLE.MEDIUM_DASH_DOT_DOT,"1.0pt dot-dash-slanted":c.BORDER_STYLE.SLANTED_DASH_DOT,"1.0pt dot-dash":c.BORDER_STYLE.MEDIUM_DASH_DOT,"1.0pt dashed":c.BORDER_STYLE.MEDIUM_DASHED,"1.0pt solid":c.BORDER_STYLE.MEDIUM,"2.0pt double":c.BORDER_STYLE.DOUBLE,"1.5pt solid":c.BORDER_STYLE.THICK},n={".5pt dotted":c.BORDER_STYLE.DOTTED,".5pt dashed":c.BORDER_STYLE.DASHED,".5pt solid":c.BORDER_STYLE.THIN,"1.2pt solid":c.BORDER_STYLE.MEDIUM,"1.2pt dashed":c.BORDER_STYLE.MEDIUM_DASHED,"2.0pt solid":c.BORDER_STYLE.THICK,"2.0pt double":c.BORDER_STYLE.DOUBLE};return t[e]||n[e]||null},d=o?o["border-top"]||o.border:t.borderTopWidth,f=o?o["border-right"]||o.border:t.borderRightWidth,p=o?o["border-bottom"]||o.border:t.borderBottomWidth,h=o?o["border-left"]||o.border:t.borderLeftWidth,v=[parseInt(d)>0||parseFloat(d)>0,parseInt(f)>0||parseFloat(f)>0,parseInt(p)>0||parseFloat(p)>0,parseInt(h)>0||parseFloat(h)>0],g=function(e){var t=l.getHexColor(e);return"#dadbda"===t&&(t=null),t},m=[v[0]&&t.borderTopColor?g(t.borderTopColor):null,v[1]&&t.borderRightColor?g(t.borderRightColor):null,v[2]&&t.borderBottomColor?g(t.borderBottomColor):null,v[3]&&t.borderLeftColor?g(t.borderLeftColor):null],y=[v[0]&&d?s(d):null,v[1]&&f?s(f):null,v[2]&&p?s(p):null,v[3]&&h?s(h):null];n.style.border={colors:m,styles:y}}}},{key:"parseTextAlign",value:function(e,t,n,a,r,i,o){if(t){var l=t.textAlign;"start"===(l=(l=l&&l.toLowerCase()||"").replace(/^-webkit-(.*)/,"$1"))||"justify"===l?l="left":"end"===l&&(l="right"),o&&"121"===o["text-align"]&&(l="center"),-1!==["right","left","center"].indexOf(l)&&(n.style.h_align=l)}}},{key:"parseVerticalAlign",value:function(e,t,n,a,r,i,o){if(t){var l=t.verticalAlign;n.style.v_align=l}}},{key:"parseWhiteSpace",value:function(e,t,n,a,r,i,o){if(t){var l=e.style.whiteSpace,s=o&&o["white-space"];s&&(l=s),"normal"===l?n.style.textwrap=l:this.nowrap?n.style.textwrap="nowrap":"nowrap"!==l&&(n.style.textwrap=l)}}},{key:"parseTextFormatRuns",value:function(e,t,n,a,r,i,o){if(e)try{var l=(0,s.convertFontHtml2Obj)(e,this.getHexColor,this.cache.mSOStyle?this.cache.mSOStyle.getComputedStyle:void 0);n.style.textFormatRuns=l}catch(u){console.log(u)}}},{key:"parseFormat",value:function(e,t,n,a,r,i,o){if(e){if(!this.cache.mSOStyle)return;var s=o&&o["mso-number-format"];if(void 0!==s){s=s.replace(/^['|"]/,"").replace(/['|"]$/,"");var u=l.msoFormatToTxSheetMapping[s];u&&(s=u),n.style.format_data=s}}}},{key:"parseLink",value:function(e,t,n,a,r,i,o){if(e){var l,s,u=e.getElementsByTagName("a");if(u){for(var c=0,d=u.length;c<d&&!(l=u[c].getAttribute("href"));c++);(s=e.innerText)&&(s=s.replace(/^\s+|\s+$/g,"")),f.bind(this)(l,s,n)}else(s=e.innerText)&&(s=s.replace(/^\s+|\s+$/g,"")),f.bind(this)(s,s,n)}function f(e,t,n){e&&""!=e&&this.validUrl(e)&&(n.template||(n.template={}),n.template.link={url:e,value:t})}}},{key:"parseSizeInfo",value:function(e){if(e){var t=this.parseColCount(e),n=this.parseRowCount(e),a=this.parseColWidthsAndHidden(e,t),r=this.parseRowHeightsAndHidden(e,n);return{col:t,row:n,colWidths:a?a.map(function(e){return e.size}):null,hiddenCols:a?a.map(function(e){return e.hidden}):null,rowHeights:r?r.map(function(e){return e.size}):null,hiddenRows:r?r.map(function(e){return e.hidden}):null}}return!this.cache.size&&this.cache.tableDOM&&(this.cache.size=this.parseSizeInfo(this.cache.tableDOM)),this.cache.size}},{key:"parseColCount",value:function(e){var t=this.getColGroupDOM(e),n=0;if(t)if(t.getAttribute("span"))n+=parseInt(t.getAttribute("span"));else for(var a=0,r=t.childElementCount;a<r;a++){var i=t.children[a],o=parseInt(i.getAttribute("span"));n+=o||1}else{var l,s,u=this.getTBodyDOM(e);if(u&&(l=u.firstElementChild),l&&(s=l.firstElementChild),s&&("TD"==s.tagName||"TH"==s.tagName))for(var c=s;c;){var d=parseInt(c.getAttribute("colspan"));n+=d||1,c=c.nextElementSibling}}return n}},{key:"parseRowCount",value:function(e){var t=this.getTBodyDOM(e),n=0;return t&&(n=t.childElementCount),n}},{key:"parseColWidthsAndHidden",value:function(e,t){var n=this.getColGroupDOM(e),r=[];if(n)for(var i=n.getElementsByTagName("col"),o=0;o<i.length;o++){var l=i[o],s=parseInt(l.getAttribute("span"),10),u=window.navigator.userAgent.match(/Mac\sOS\sX/i),c=parseInt(l.style.width,10),d=isNaN(c),f=u&&!d?c:parseInt(l.getAttribute("width"),10),p=!!l.getAttribute("hiddenCol");if(isNaN(s))r.push({hidden:p,size:f||null});else for(var h=0;h<s;h++)r.push({hidden:p,size:f})}else{var v,g=this.getTBodyDOM(e);if(g&&(v=g.firstElementChild),!v)return null;var m=v.getElementsByTagName("td");r=(0,a.default)(m&&m.length>0?m:v.getElementsByTagName("th")).map(function(e){var t=!!e.getAttribute("hiddenCol");return null!=e.getAttribute("width")?{hidden:t,size:parseInt(e.getAttribute("width"),10)}:{hidden:t,size:null}})}return r.length==t?r:null}},{key:"parseRowHeightsAndHidden",value:function(e,t){var n=this.getTBodyDOM(e),r=(0,a.default)(n.getElementsByTagName("tr")).map(function(e){var t=!!e.getAttribute("hiddenRow"),n=parseInt(e.getAttribute("height"),10),a=parseInt(e.style.height,10);isNaN(n)&&isNaN(a);var r=window.navigator.userAgent.match(/Mac\sOS\sX/i);return{hidden:t,size:e.getAttribute("style")&&-1!==e.getAttribute("style").indexOf("mso-height-source:userset")?r?isNaN(a)?n:a:isNaN(n)?a:n:null}});return r.length==t?r:null}},{key:"parseCopySource",value:function(e){if(e){var t=this.getDocumentObject(e);if(t){var n=t.getElementsByTagName("meta");if(n){var a=n.ProgId;a&&"Excel.Sheet"==a.content&&(this.cache.isCopySourceExcel=!0)}}}}},{key:"getDocumentObject",value:function(e){for(var t=e.parentNode;t&&9!=t.nodeType;)t=t.parentNode;if(9==t.nodeType)return t}},{key:"standardizeCellsWithMergeCells",value:function(e){var t=[],n=[],a=[],r=this.parseSizeInfo();if(r)for(var i=0;i<r.row;i++){n[i]||(n[i]=[]),a[i]||(a[i]=[]);for(var o=e[i],l=0,s=0;l<r.col&&s<o.length;l++)if(void 0===n[i][l]){var u=o[s++];n[i][l]=u;var c=parseInt(u.getAttribute("rowspan"));c=c||1;var d=parseInt(u.getAttribute("colspan"));d=d||1;u.getAttribute("style");var f=this.cache.mSOStyle&&this.cache.mSOStyle.getComputedStyle(u)||{};a[i][l]=f;var p=f["mso-ignore"];if(p&&-1!==p.indexOf("colspan")){if(d>1)for(var h=1;h<d;h++);d=0}if(p&&-1!==p.indexOf("rowspan")&&(c=0),d>1)for(h=1;h<d;h++){var v=u.cloneNode(!0);v.innerHTML="",n[i][l+h]=v}if(c>1)for(var g=1;g<c;g++){n[i+g]||(n[i+g]=[]);for(var m=0;m<d;m++){var y=u.cloneNode(!0);y.innerHTML="",n[i+g][l+m]=y}}(c>1||d>1)&&t.push({row:i,col:l,rowspan:c,colspan:d}),l+=d-1}}return this.cache.mergeCells=t,this.cache.cellsStyleMaps=a,n}},{key:"getStandardCells",value:function(e){var t=this.getCells(e),n=this.notify("beforeStandardizeCells",t);return void 0!=n&&(t=n),t}},{key:"getCells",value:function(e){if(!e)return!this.cache.cells&&this.cache.tableDOM&&(this.cache.cells=this.getCells(this.cache.tableDOM)),this.cache.cells;var t=this.getTBodyDOM(e);if(t){for(var n=t.children,a=[],r=0,i=n?n.length:0;r<i;r++){for(var o=n[r].children,l=[],s=0,u=o?o.length:0;s<u;s++){var c=o[s];(c&&"td"==c.tagName.toLowerCase()||"th"==c.tagName.toLowerCase())&&l.push(c)}a.push(l)}return a}}},{key:"validUrl",value:function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(e)}},{key:"getColGroupDOM",value:function(e){if(e){var t=e.firstElementChild;if(t&&"colgroup"==t.tagName.toLowerCase())return t;for(var n=e.children,a=1;a<n.length;a++)if(n[a]&&"colgroup"==n[a].tagName.toLowerCase())return n[a];return null}return!this.cache.colgroup&&this.cache.tableDOM&&(this.cache.colgroup=this.getColGroupDOM(this.cache.tableDOM)),this.cache.colgroup}},{key:"getTBodyDOM",value:function(e){if(e){for(var t=null,n=0;n<e.children.length;n++){var a=e.children[n];if(a&&"tbody"==a.tagName.toLowerCase())if(t)for(var r=a.children,i=0;i<r.length;i++)t.appendChild(r[i]);else t=a}return t}return!this.cache.tbody&&this.cache.tableDOM&&(this.cache.tbody=this.getTBodyDOM(this.cache.tableDOM)),this.cache.tbody}},{key:"subscribe",value:function(e,t){if(Array.isArray(t))for(var n=0,a=t.length;n<a;n++)this.subscribe(e,t[n]);this.notificationCenter[e]?this.notificationCenter[e].push(t):this.notificationCenter[e]=[t]}},{key:"unsubscribe",value:function(e,t){if(void 0==t)delete this.notificationCenter[e];else{var n=this.notificationCenter[e],a=n?n.indexOf(t):-1;a>-1&&delete this.notificationCenter[e][a]}}},{key:"notify",value:function(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];for(var r=this.notificationCenter[e],i=-1,o=r?r.length:0,l=null,s=[],u=1,c=arguments.length;u<c;u++)s.push(arguments[u]);for(;++i<o;){var d=r[i].apply(this,s);void 0!=d&&(l=d)}return l}}]),e}();f.getSingleton=function(){return p};var p=new f;t.default=f},1314:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.parseMSOCss=void 0;var a=l(n(0)),r=l(n(1)),i=l(n(1315)),o=n(449);function l(e){return e&&e.__esModule?e:{default:e}}var s=new i.default,u=t.parseMSOCss=function(e){return e?s.parseCSS(e):(console.error("invalid css string"),[])},c=function(){function e(t){(0,a.default)(this,e);var n=u(t);this.styleSheetsParsed=this.transform(n),this.getComputedStyle=this.getComputedStyle.bind(this)}return(0,r.default)(e,[{key:"transform",value:function(e){return e.reduce(function(e,t){return e[t.selector]=(e[t.selector]||[]).concat(t.rules),e},{})}},{key:"getComputedStyle",value:function(e){var t=e.getAttribute("class"),n=e.getAttribute("style"),a=this.getMergedStyles(t,n);return this.reaplaceStylePropertyUnit(e,a,"font-size")}},{key:"getMergedStyles",value:function(e,t){var n=this.getRulesBySelector("."+e),a=this.parseRules(t),r=n||[];return this.getMergeStyles(r.concat(a))}},{key:"getMergeStyles",value:function(e){var t={};return e.forEach(function(e){var n=e.value;/mso/.test(e.directive)&&(n=(0,o.unEscapeCssSequence)(e.value)),t[e.directive]=n}),t}},{key:"reaplaceStylePropertyUnit",value:function(e,t,n){var a=getComputedStyle(e);return t[n]&&(t[n]=a.getPropertyValue(n)),t}},{key:"parseRules",value:function(e){return(t=e)?s.parseRules(t):[];var t}},{key:"getRulesBySelector",value:function(e){return this.styleSheetsParsed[e]}}]),e}();t.default=c},1315:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(){this.cssImportStatements=[],this.cssKeyframeStatements=[],this.cssRegex=new RegExp("([\\s\\S]*?){([\\s\\S]*?)}","gi"),this.cssMediaQueryRegex="((@media [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.cssKeyframeRegex="((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})",this.combinedCSSRegex="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",this.cssCommentsRegex="(\\/\\*[\\s\\S]*?\\*\\/)",this.cssImportStatementRegex=new RegExp("@import .*?;","gi")};a.prototype.stripComments=function(e){var t=new RegExp(this.cssCommentsRegex,"gi");return e.replace(t,"")},a.prototype.parseCSS=function(e){if(void 0===e)return[];for(var t=[];;){var n=this.cssImportStatementRegex.exec(e);if(null===n)break;this.cssImportStatements.push(n[0]),t.push({selector:"@imports",type:"imports",styles:n[0]})}e=e.replace(this.cssImportStatementRegex,"");for(var a,r=new RegExp(this.cssKeyframeRegex,"gi");null!==(a=r.exec(e));)t.push({selector:"@keyframes",type:"keyframes",styles:a[0]});e=e.replace(r,"");for(var i=new RegExp(this.combinedCSSRegex,"gi");null!==(a=i.exec(e));){var o="";o=void 0===a[2]?a[5].split("\r\n").join("\n").trim():a[2].split("\r\n").join("\n").trim();var l=new RegExp(this.cssCommentsRegex,"gi"),s=l.exec(o);if(null!==s&&(o=o.replace(l,"").trim()),-1!==(o=o.replace(/\n+/,"\n")).indexOf("@media")){var u={selector:o,type:"media",subStyles:this.parseCSS(a[3]+"\n}")};null!==s&&(u.comments=s[0]),t.push(u)}else{var c={selector:o,rules:this.parseRules(a[6])};"@font-face"===o&&(c.type="font-face"),null!==s&&(c.comments=s[0]),t.push(c)}}return t},a.prototype.parseRules=function(e){var t=[];e=(e=(e=e.split("\r\n").join("\n")).replace("\\;","8cbdb7f1309a1f76b65356e6afc3948b")).replace("\\\\;","8cbdb7f1309a1f76b65356e6afc3948a").split(new RegExp(";")).map(function(e){return(e=e.replace("8cbdb7f1309a1f76b65356e6afc3948b","\\;")).replace("8cbdb7f1309a1f76b65356e6afc3948a","\\\\;")});for(var n=0;n<e.length;n++){var a=e[n];if(-1!==(a=a.trim()).indexOf(":")){var r=(a=a.split(":"))[0].trim(),i=a.slice(1).join(":").trim();if(r.length<1||i.length<1)continue;t.push({directive:r,value:i})}else"base64,"===a.trim().substr(0,7)?t[t.length-1].value+=a.trim():a.length>0&&t.push({directive:"",value:a,defective:!0})}return t},a.prototype.findCorrespondingRule=function(e,t,n){void 0===n&&(n=!1);for(var a=!1,r=0;r<e.length&&(e[r].directive!==t||(a=e[r],n!==e[r].value));r++);return a},a.prototype.findBySelector=function(e,t,n){void 0===n&&(n=!1);for(var a=[],r=0;r<e.length;r++)!1===n?e[r].selector===t&&a.push(e[r]):-1!==e[r].selector.indexOf(t)&&a.push(e[r]);if("@imports"===t||a.length<2)return a;var i=a[0];for(r=1;r<a.length;r++)this.intelligentCSSPush([i],a[r]);return[i]},a.prototype.deleteBySelector=function(e,t){for(var n=[],a=0;a<e.length;a++)e[a].selector!==t&&n.push(e[a]);return n},a.prototype.compressCSS=function(e){for(var t=[],n={},a=0;a<e.length;a++){var r=e[a];if(!0!==n[r.selector]){var i=this.findBySelector(e,r.selector);0!==i.length&&(t=t.concat(i),n[r.selector]=!0)}}return t},a.prototype.cssDiff=function(e,t){if(e.selector!==t.selector)return!1;if("media"===e.type||"media"===t.type)return!1;for(var n,a,r={selector:e.selector,rules:[]},i=0;i<e.rules.length;i++)n=e.rules[i],!1===(a=this.findCorrespondingRule(t.rules,n.directive,n.value))?r.rules.push(n):n.value!==a.value&&r.rules.push(n);for(var o=0;o<t.rules.length;o++)a=t.rules[o],!1===(n=this.findCorrespondingRule(e.rules,a.directive))&&(a.type="DELETED",r.rules.push(a));return 0!==r.rules.length&&r},a.prototype.intelligentMerge=function(e,t,n){void 0===n&&(n=!1);for(var a=0;a<t.length;a++)this.intelligentCSSPush(e,t[a],n);for(a=0;a<e.length;a++){var r=e[a];"media"!==r.type&&"keyframes"!==r.type&&(r.rules=this.compactRules(r.rules))}},a.prototype.intelligentCSSPush=function(e,t,n){var a=t.selector,r=!1;if(void 0===n&&(n=!1),!1===n){for(var i=0;i<e.length;i++)if(e[i].selector===a){r=e[i];break}}else for(var o=e.length-1;o>-1;o--)if(e[o].selector===a){r=e[o];break}if(!1===r)e.push(t);else if("media"!==t.type)for(var l=0;l<t.rules.length;l++){var s=t.rules[l],u=this.findCorrespondingRule(r.rules,s.directive);!1===u?r.rules.push(s):"DELETED"===s.type?u.type="DELETED":u.value=s.value}else r.subStyles=r.subStyles.concat(t.subStyles)},a.prototype.compactRules=function(e){for(var t=[],n=0;n<e.length;n++)"DELETED"!==e[n].type&&t.push(e[n]);return t},a.prototype.getCSSForEditor=function(e,t){void 0===t&&(t=0);var n="";void 0===e&&(e=this.css);for(var a=0;a<e.length;a++)"imports"===e[a].type&&(n+=e[a].styles+"\n\n");for(a=0;a<e.length;a++){var r=e[a];if(void 0!==r.selector){var i="";void 0!==r.comments&&(i=r.comments+"\n"),"media"===r.type?(n+=i+r.selector+"{\n",n+=this.getCSSForEditor(r.subStyles,t+1),n+="}\n\n"):"keyframes"!==r.type&&"imports"!==r.type&&(n+=this.getSpaces(t)+i+r.selector+" {\n",n+=this.getCSSOfRules(r.rules,t+1),n+=this.getSpaces(t)+"}\n\n")}}for(a=0;a<e.length;a++)"keyframes"===e[a].type&&(n+=e[a].styles+"\n\n");return n},a.prototype.getImports=function(e){for(var t=[],n=0;n<e.length;n++)"imports"===e[n].type&&t.push(e[n].styles);return t},a.prototype.getCSSOfRules=function(e,t){for(var n="",a=0;a<e.length;a++)void 0!==e[a]&&(void 0===e[a].defective?n+=this.getSpaces(t)+e[a].directive+": "+e[a].value+";\n":n+=this.getSpaces(t)+e[a].value+";\n");return n||"\n"},a.prototype.getSpaces=function(e){for(var t="",n=0;n<4*e;n++)t+=" ";return t},a.prototype.applyNamespacing=function(e,t){var n=e,a="."+this.cssPreviewNamespace;void 0!==t&&(a=t),"string"===typeof e&&(n=this.parseCSS(e));for(var r=0;r<n.length;r++){var i=n[r];if(!(i.selector.indexOf("@font-face")>-1||i.selector.indexOf("keyframes")>-1||i.selector.indexOf("@import")>-1||i.selector.indexOf(".form-all")>-1||i.selector.indexOf("#stage")>-1))if("media"!==i.type){for(var o=i.selector.split(","),l=[],s=0;s<o.length;s++)-1===o[s].indexOf(".supernova")?l.push(a+" "+o[s]):l.push(o[s]);i.selector=l.join(",")}else i.subStyles=this.applyNamespacing(i.subStyles,t)}return n},a.prototype.clearNamespacing=function(e,t){void 0===t&&(t=!1);var n=e,a="."+this.cssPreviewNamespace;"string"===typeof e&&(n=this.parseCSS(e));for(var r=0;r<n.length;r++){var i=n[r];if("media"!==i.type){for(var o=i.selector.split(","),l=[],s=0;s<o.length;s++)l.push(o[s].split(a+" ").join(""));i.selector=l.join(",")}else i.subStyles=this.clearNamespacing(i.subStyles,!0)}return!1===t?this.getCSSForEditor(n):n},a.prototype.createStyleElement=function(e,t,n){if(void 0===n&&(n=!1),!1===this.testMode&&"nonamespace"!==n&&(t=this.applyNamespacing(t)),"string"!==typeof t&&(t=this.getCSSForEditor(t)),!0===n&&(t=this.getCSSForEditor(this.parseCSS(t))),!1!==this.testMode)return this.testMode("create style #"+e,t);var a=document.getElementById(e);a&&a.parentNode.removeChild(a);var r=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=e,i.type="text/css",r.appendChild(i),i.styleSheet&&!i.sheet?i.styleSheet.cssText=t:i.appendChild(document.createTextNode(t))};var r=a;t.default=r},1316:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertFontHtml2Obj=void 0;var a,r=o(n(14)),i=o(n(31));function o(e){return e&&e.__esModule?e:{default:e}}!function(e){e[e.TEXT=0]="TEXT",e[e.BR=1]="BR"}(a||(a={}));t.convertFontHtml2Obj=function(e,t,n){if(!n)return[];var o=[],l=function e(t,n,o,l){if(!t)return[];if(3===t.nodeType){var s=t.textContent;return l.needSpace||(s=s.replace(/\s+?/g," ")),[{len:s.length,format:null,text:s,type:a.TEXT}]}if(t.nodeType!==Node.ELEMENT_NODE)return[];if("br"==t.tagName.toLowerCase())return[{len:1,format:null,text:"",type:a.BR}];var u="mso-spacerun:yes"===t.getAttribute("style"),c=o(t),d={style:{}};if("a"==t.tagName.toLowerCase()&&(d.style.fontcolor=n("#018ffb"),d.style.underline="underline"),c){var f=c["font-family"];if(f){var p=f.indexOf(",");-1!=p&&(f=f.slice(0,p)),'"'==f[0]&&(f=f.slice(1,f.length-1)),d.style.fontfamily=f}else d.style.fontfamily=null;var h=c["font-size"];if(h)if(-1!==h.toString().toLowerCase().indexOf("pt"))d.style.fontsize=h;else{var v=parseFloat(h);v=3*v/4,(v=Math.round(10*v)/10)&&(d.style.fontsize=v+"pt")}var g=n(c.color);g&&(d.style.fontcolor=g);var m=c["font-weight"];"bold"!=m&&700!=m||(d.style.bold="bold"),"italic"==c["font-style"]&&(d.style.italic="italic");var y=c["text-decoration"];y&&(-1!=y.indexOf("underline")&&(d.style.underline="underline"),-1!=y.indexOf("line-through")&&(d.style.strikeline="strikeline"))}switch(t.tagName.toLowerCase()){case"b":case"strong":d.style.bold="bold";break;case"i":case"em":d.style.italic="italic";break;case"u":case"ins":d.style.underline="underline";break;case"s":case"strike":case"del":d.style.strikeline="strikeline"}var T=t.childNodes;if(T&&T.length){if(l.isRootNode&&1===T.length&&T[0].nodeName&&("s"==T[0].nodeName.toLowerCase()||"u"==T[0].nodeName.toLowerCase()))return[];var C=[];if(T.forEach(function(t,a){C=C.concat(e(t,n,o,{needSpace:u,isRootNode:!1}))}),!l.isRootNode){var S=!0,b=!1,w=void 0;try{for(var R,x=(0,i.default)(C);!(S=(R=x.next()).done);S=!0){var E=R.value;E&&(E.format?E.format=(0,r.default)({},d.style,E.format):E.format=(0,r.default)({},d.style))}}catch(I){b=!0,w=I}finally{try{!S&&x.return&&x.return()}finally{if(b)throw w}}}return C}return[]}(e,t,n,{isRootNode:!0,needSpace:!1}),s=0,u=l.length-1;return l.forEach(function(e,t){e&&(0!==s&&t!==u||e.type!==a.TEXT||!/^\s+$/.test(e.text))&&(o.push({startIndex:s,format:e.format}),s+=e.len)}),o.filter(function(e){return!e.format}).length===o.length?[]:o}},1317:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.standard16colorsMapping={white:"FFFFFF",silver:"C0C0C0",gray:"808080",black:"000000",red:"FF0000",maroon:"800000",yellow:"FFFF00",olive:"808000",lime:"00FF00",green:"008000",aqua:"00FFFF",teal:"008080",blue:"0000FF",navy:"000080",fuchsia:"FF00FF",purple:"800080"}},1318:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(47),i=(a=r)&&a.__esModule?a:{default:a};var o={};if("undefined"!==typeof document&&document.addEventListener){o={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};try{o.copy=function(){function e(){t=!1,n=null,a&&window.getSelection().removeAllRanges(),a=!1}var t=!1,n=null,a=!1,r=!1;return function(o){return r||(document.addEventListener("copy",function(e){if(t){for(var a in n)try{e.clipboardData.setData(a,n[a])}catch(a){console.error(a)}e.preventDefault()}}),r=!0),new i.default(function(r,i){t=!0,n="string"===typeof o?{"text/plain":o}:o instanceof Node?{"text/html":(new XMLSerializer).serializeToString(o)}:o;try{var l=document.getSelection();if(!document.queryCommandEnabled("copy")&&l.isCollapsed){var s=document.createRange();s.selectNodeContents(document.body),l.addRange(s),a=!0}if(!document.execCommand("copy"))throw Error("Unable to copy. Perhaps it's not available in your browser?");e(),r()}catch(u){e(),i(u)}})}}(),o.paste=function(){var e,t,n=!1,a=!1;return function(r){return a||(document.addEventListener("paste",function(a){if(n){n=!1,a.preventDefault();var r=e;e=null,r(a.clipboardData.getData(t))}}),a=!0),new i.default(function(a,i){n=!0,e=a,t=r||"text/plain";try{document.execCommand("paste")||(n=!1,i(Error("Unable to paste. Pasting only works in Internet Explorer at the moment.")))}catch(o){n=!1,i(Error(o))}})}}(),"undefined"===typeof ClipboardEvent&&"undefined"!==typeof window.clipboardData&&"undefined"!==typeof window.clipboardData.setData&&(o.copy=function(e){return new i.default(function(t,n){if("string"!==typeof e&&!("text/plain"in e))throw Error("You must provide a text/plain type.");window.clipboardData.setData("Text","string"===typeof e?e:e["text/plain"])?t():n(Error("Copying was rejected."))})},o.paste=function(){return new i.default(function(e,t){var n=window.clipboardData.getData("Text");n?e(n):t(Error("Pasting was rejected."))})})}catch(l){console.error(l)}}else o={copy:function(){throw Error("Unable to copy. Perhaps it's not available in your browser?")},paste:function(){throw Error("Unable to paste. Perhaps it's not available in your browser?")}};t.default=o},1319:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=h(n(41)),r=h(n(0)),i=h(n(1)),o=h(n(1320)),l=h(n(1323)),s=h(n(1326)),u=h(n(695)),c=n(240),d=h(n(40)),f=h(n(7)),p=h(n(8));function h(e){return e&&e.__esModule?e:{default:e}}var v=f.default.window,g=v.$;function m(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on"+t,function(){n(v.event)})}function y(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent&&e.detachEvent("on"+t,function(){n(v.event)})}var T=/Firefox/i.test(navigator.userAgent)?"DOMMouseScroll":"mousewheel",C="paste-special-menu",S="paste-special-panel",b="paste-special-container",w=0,R=1,x=function(){function e(t){var n=t.styleCssText,a=t.stateBefore,i=t.pasteData,s=t.active,u=t.hotInstance,c=t.fromCache,d=t.__mergeBefore,f=t.itemsOptions,p=t.closeCb,h=t.envs;(0,r.default)(this,e),console.log("pasteSpecial"),this.wrap=document.querySelector("#canvasContainer"),this.containerCls=b,this.domIdPasteSpecialMenu=C,this.domIdPasteSpecialPanel=S,this.init(n),this.render(),this.childComponents=[],this.childComponents[w]=new o.default({handleClick:this.handleClickMenu.bind(this)},document.body.querySelector('[data-id="'+this.domIdPasteSpecialMenu+'"]')),this.childComponents[R]=this.pasteSpecialPanel=new l.default({handleClickItem:this.handleClickItem.bind(this),fromCache:c,itemsOptions:f},document.body.querySelector('[data-id="'+this.domIdPasteSpecialPanel+'"]')),this.pasteCacheData={pasteData:i,stateBefore:a,active:s,hotInstance:u,__mergeBefore:d,smartSplitObj:[],cacheDoneActionsLength:u.behavior.undoredoStack.undoStack.length},this.registerListener(),this.smartSplitMenuCB,this.closeCb=p,this.envs=h||{}}return(0,i.default)(e,[{key:"init",value:function(e){this.styleCssText=e}},{key:"enableSmartSplitObj",value:function(e,t){v.CoreSheet.configurations&&v.CoreSheet.configurations.aiAutoColumnEnable&&(this.pasteCacheData.smartSplitObj=e,this.childComponents[R].setSmartSplitEnable(),"function"===typeof t&&(this.smartSplitMenuCB=t))}},{key:"triggerSmartSplit",value:function(){var e=this.pasteCacheData,t=e.pasteData,n=e.active,a=e.hotInstance,r=e.__mergeBefore,i=e.cacheDoneActionsLength,o=e.smartSplitObj;(0,s.default)({pasteData:t,type:c.SMARTSPLIT,active:n,hotInstance:a,__mergeBefore:r,cacheDoneActionsLength:i,smartSplitObj:o,envs:this.envs})}},{key:"registerListener",value:function(){this.pasteCacheData.hotInstance;this.closeBind=this.close.bind(this),this.setPanelHideBind=this.setPanelHide.bind(this),this.tableMoveHandlerBind=this.tableMoveHandler.bind(this),this.scaleHandlerBind=this.scaleHandler.bind(this),d.default.default.listen("enterInputStatus",this.closeBind,"ignoreOffline"),d.default.default.listen("changeActivation",this.closeBind,"ignoreOffline"),d.default.default.listen("tableMove",this.tableMoveHandlerBind),d.default.default.listen("scale",this.scaleHandlerBind),this.registerDocumentOnmousewheel(),this.registerDocumentClick()}},{key:"tableMoveHandler",value:function(){this.resetPosition()}},{key:"scaleHandler",value:function(){this.resetPosition()}},{key:"unRegisterListener",value:function(){this.pasteCacheData.hotInstance;d.default.default.remove("enterInputStatus",this.closeBind),d.default.default.remove("changeActivation",this.closeBind),d.default.default.remove("tableMove",this.tableMoveHandlerBind),d.default.default.remove("scale",this.scaleHandlerBind),y(document,"click",this.documentClick,!0),y(document,T,this.documentOnmousewheel,!0)}},{key:"calTableMovePrevent",value:function(){return"block"===this.pasteSpecialPanel.rootEl.style.display}},{key:"render",value:function(){var e=document.body.querySelector("."+this.containerCls),t=this.wrap;t&&(e||((e=document.createElement("div")).classList.add(this.containerCls),t.appendChild(e)),e.style.cssText=this.styleCssText,this.container=e,e.innerHTML='\n<div class="paste-panel-container" style="visibility: visible;" >\n<div data-id="'+this.domIdPasteSpecialMenu+'" style="visibility: visible;"></div>\n<div data-id="'+this.domIdPasteSpecialPanel+'" style="display: none;"></div>\n</div>\n    ')}},{key:"resetPosition",value:function(){var e=this.pasteCacheData.hotInstance,t=(0,u.default)(e);if(t){var n=(0,a.default)(t,3),r=n[0],i=n[1],o=n[2];this.container.style.cssText="position: fixed; left:"+i+"px; top:"+r+"px; z-index: 104; "+(o?"display:none;":"")}}},{key:"handleClickItem",value:function(e){var t=this.pasteCacheData,n=t.pasteData,a=t.active,r=t.hotInstance,i=t.__mergeBefore,o=t.cacheDoneActionsLength,l=t.smartSplitObj;this.togglePanelShowHide(),(0,s.default)({pasteData:n,type:e,active:a,hotInstance:r,__mergeBefore:i,cacheDoneActionsLength:o,smartSplitObj:l,envs:this.envs}),r.view.canvas.excel.focusInput(),e===c.SMARTSPLIT&&this.smartSplitMenuCB&&(this.smartSplitMenuCB(),p.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_menu"}),this.envs&&this.envs.pasteSpecialType&&this.envs.pasteSpecialType!==c.SMARTSPLIT&&p.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_menu_indirect"}))}},{key:"registerDocumentClick",value:function(){var e=this,t=this.container;this.documentClick=function(n){if(!1!==n.isTrusted){var a=n.target;a===t||t.contains&&t.contains(a)||e.close()}},m(document,"click",this.documentClick,!0)}},{key:"registerDocumentOnmousewheel",value:function(){var e=this.container;this.documentOnmousewheel=function(t){var n=t.target;if(this.calTableMovePrevent())return t.preventDefault(),v.event?t.cancelBubble=!0:t.stopPropagation(),void(t.stopPropagation&&t.stopPropagation());n===e||e.contains(n)||n.classList.contains("filter-span")||this.resetPosition()}.bind(this),m(document,T,this.documentOnmousewheel,!0)}},{key:"handleClickMenu",value:function(){this.togglePanelShowHide()}},{key:"togglePanelShowHide",value:function(){var e=this.childComponents[R].rootEl,t=this.childComponents[w].rootEl;if("none"===e.style.display){var n=g(v).height()-g(t).height()-g(t).offset().top+g(document).scrollTop(),a=g(v).width()-g(t).width()-g(t).offset().left+g(document).scrollLeft(),r=g(e).width(),i=g(e).height()+11;n<i&&(e.style.top="-"+i+"px",e.style.position="absolute"),a<r&&(e.style.left="-"+r+"px",e.style.position="absolute")}else t.style.position="static";e.style.display="block"===e.style.display?"none":"block"}},{key:"setPanelHide",value:function(){this.childComponents[R].rootEl.style.display="none"}},{key:"close",value:function(){try{var e=this.wrap;if(!e)return;e.removeChild(this.container)}catch(t){}this.unRegisterListener(),"function"===typeof this.closeCb&&this.closeCb()}}]),e}();t.default=x},1320:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}n(1321);var o=function(){function e(t,n){(0,a.default)(this,e),this.props=t,this.rootEl=n,this.render(),this.registerListener()}return(0,r.default)(e,[{key:"componentWillReceiveProps",value:function(e){this.props=e,this.render()}},{key:"getTemplate",value:function(){return'\n          <div class="postpaste-parent" style="top: 297px; left: 508px; width: 32px; height: 26px;">\n              <div id="post-paste-menu" class="postpaste-container tx-toolbar-menu-button tx-inline-block" aria-label="\u7c98\u8d34\u683c\u5f0f" title="\u7c98\u8d34\u683c\u5f0f" role="button" tabindex="0" aria-expanded="false" style="user-select: none;" aria-haspopup="true">\n                  <div class="tx-toolbar-menu-button-outer-box tx-inline-block">\n                      <div class="tx-toolbar-menu-button-inner-box tx-inline-block">\n                          <div class="tx-toolbar-menu-button-caption tx-inline-block">\n                              <div class="docs-icon tx-inline-block ">\n                                  <div class="docs-icon-img-container tx-docs-icon-img docs-icon-paste" aria-hidden="true"> </div>\n                              </div>\n                          </div>\n                          <div class="tx-toolbar-menu-button-dropdown postpaste-arrow tx-inline-block"> </div>\n                      </div>\n                  </div>\n              </div>\n          </div>\n    '}},{key:"render",value:function(){this.rootEl.innerHTML=this.getTemplate()}},{key:"registerListener",value:function(){var e=this.props.handleClick,t=void 0===e?function(){}:e;this.rootEl.addEventListener("click",t)}},{key:"close",value:function(){}}]),e}();t.default=o},1321:function(e,t,n){var a=n(1322);"string"===typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,r);a.locals&&(e.exports=a.locals)},1322:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,".postpaste-parent .postpaste-container {\n  margin: 0;\n  min-width: 0px;\n  width: 36px;\n  height: 28px;\n  border-radius: 2px;\n  border: solid 1px #e0e2e4;\n  background-color: #f5f5f5;\n}\n.postpaste-parent .postpaste-container:hover {\n  border-color: #e0e2e4;\n  background-color: #e5e5e5;\n}\n.postpaste-parent .postpaste-container:active {\n  border-color: #e0e2e4;\n  background-color: #e0e2e4;\n}\n.postpaste-parent .postpaste-container:disabled {\n  border-color: #e0e2e4;\n}\n.postpaste-parent .postpaste-container .tx-toolbar-button-inner-box,\n.postpaste-parent .postpaste-container .tx-toolbar-menu-button-inner-box {\n  height: 25px;\n  min-width: 25px;\n  padding: 0;\n  text-align: center;\n}\n.postpaste-parent .postpaste-container .docs-icon-paste {\n  left: 0px;\n  top: 0px;\n}\n.postpaste-parent .postpaste-container .tx-inline-block {\n  position: relative;\n  display: -moz-inline-box;\n  display: inline-block;\n}\n.postpaste-parent .postpaste-container .docs-icon {\n  direction: ltr;\n  text-align: left;\n  height: 21px;\n  overflow: hidden;\n  vertical-align: middle;\n  width: 19px;\n  margin-left: 6px;\n  margin-top: 6px;\n}\n.postpaste-parent .postpaste-container .docs-icon .docs-icon-img-container {\n  height: 4167px;\n  position: absolute;\n  width: 42px;\n}\n.tx-toolbar-menu-button-dropdown {\n  width: 0;\n  height: 0;\n  border-left: 3.5px solid transparent;\n  border-right: 3.5px solid transparent;\n  border-top: 4px solid #9ea1a4;\n  float: right;\n  margin: 12px 4px 0 0px;\n  padding: 0;\n  opacity: 0.8;\n  vertical-align: middle;\n  width: 0px;\n  height: 0px;\n}\n.tx-docs-icon-img:before {\n  content: '';\n  background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAkCAMAAACt+qpmAAAAM1BMVEUAAAA1OkF/g4Y1OkF/g4Z/g4Y1OkF/g4Z/g4Y1OkF/g4Z/g4Z/g4Z/g4Y1OkFOU1lGS1GlJZlaAAAADXRSTlMA5vBJEJ7n4nhKORgDp25XTwAAAHFJREFUOMvl0rsKgDAQRNHEGN8b/f+vdVmYgGEdC7HyFgvhFGNhQCkWLabgpWbqYim4z1i37FiY1YOtOlhnsa0vOwhvjvff9wmuLcqlg6HsDYZap5oZysJw3AhKZigTQ3Gxt1xEP0L8zy7OA0H0Ap0ons+WEWpjEPWBAAAAAElFTkSuQmCC);\n  background-size: 14px 18px;\n  position: absolute;\n  width: 14px;\n  height: 18px;\n}\n@media only screen and (-Webkit-min-device-pixel-ratio: 1.5), only screen and (-moz-min-device-pixel-ratio: 1.5), only screen and (-o-min-device-pixel-ratio: 1.5), only screen and (min-device-pixel-ratio: 1.5) {\n  .tx-docs-icon-img:before {\n    background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAkCAMAAACt+qpmAAAAM1BMVEUAAAA1OkF/g4Y1OkF/g4Z/g4Y1OkF/g4Z/g4Y1OkF/g4Z/g4Z/g4Z/g4Y1OkFOU1lGS1GlJZlaAAAADXRSTlMA5vBJEJ7n4nhKORgDp25XTwAAAHFJREFUOMvl0rsKgDAQRNHEGN8b/f+vdVmYgGEdC7HyFgvhFGNhQCkWLabgpWbqYim4z1i37FiY1YOtOlhnsa0vOwhvjvff9wmuLcqlg6HsDYZap5oZysJw3AhKZigTQ3Gxt1xEP0L8zy7OA0H0Ap0ons+WEWpjEPWBAAAAAElFTkSuQmCC);\n  }\n}\n",""])},1323:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1));n(1324);var i=n(240);function o(e){return e&&e.__esModule?e:{default:e}}var l=o(n(7)).default.window,s=function(){function e(t,n){(0,a.default)(this,e),this.props=t,this.rootEl=n,this.render(),this.registerListener()}return(0,r.default)(e,[{key:"componentWillReceiveProps",value:function(e){this.props=e,this.render()}},{key:"getTemplate",value:function(){arguments.length>0&&void 0!==arguments[0]&&arguments[0];var e=this.props,t=(e.fromCache,e.itemsOptions),n='\n    <div class="tx-menuitem postpaste-menu-item tx-menuitem-disabled" role="menuitem" aria-disabled="true" style="user-select: none;" data-id="'+i.SMARTSPLIT+'">\n        <div class="tx-menuitem-content" style="user-select: none;" data-id="'+i.SMARTSPLIT+'" aria-disabled="true">\u667a\u80fd\u5206\u5217</div>\n    </div>';return'\n<div class="tx-menu tx-menu-vertical" role="menu" aria-haspopup="true" style="'+(l.CoreSheet.configurations&&l.CoreSheet.configurations.aiAutoColumnEnable?"height: 160px":"height: 128px")+'" >\n  <div class="tx-menuitem postpaste-menu-item" role="menuitem" aria-disabled="false" style="user-select: none;" data-id="'+i.KEEPDEFAULT+'">\n    <div class="tx-menuitem-content" style="user-select: none;" data-id="'+i.KEEPDEFAULT+'">\u4fdd\u7559\u6e90\u683c\u5f0f</div>\n  </div>\n  <div class="tx-menuitem postpaste-menu-item" role="menuitem" aria-disabled="false" style="user-select: none;" data-id="'+i.MERGESTYLES+'">\n    <div class="tx-menuitem-content" style="user-select: none;" data-id="'+i.MERGESTYLES+'">\u5408\u5e76\u683c\u5f0f</div>\n  </div>\n  <div class="tx-menuitem postpaste-menu-item role="menuitem"  aria-hidden="true" data-id="'+i.ONLYVALUES+'">\n    <div class="tx-menuitem-content" style="user-select: none;" data-id="'+i.ONLYVALUES+'">\u4ec5\u7c98\u8d34\u503c</div>\n  </div>\n  <div class="tx-menuseparator" style="user-select: none;"  role="separator" id=":1o"></div>\n  <div class="tx-menuitem postpaste-menu-item '+(t.disableTranspose&&"tx-menuitem-disabled")+'" role="menuitem" aria-disabled="'+(t.disableTranspose&&"true")+'" style="user-select: none;" data-id="'+i.TRANSPOSE+'">\n    <div class="tx-menuitem-content" style="user-select: none;" data-id="'+i.TRANSPOSE+'" aria-disabled="'+(t.disableTranspose&&"true")+'">\u8f6c\u7f6e\u884c\u5217</div>\n  </div>'+(l.CoreSheet.configurations&&l.CoreSheet.configurations.aiAutoColumnEnable?n:"")+"</div>"}},{key:"render",value:function(){this.rootEl.innerHTML=this.getTemplate(this.props.data)}},{key:"setMenuStatus",value:function(e,t){var n=$(this.rootEl).find('.tx-menuitem[data-id="'+e+'"]');t&&n.hasClass("tx-menuitem-disabled")&&n.removeClass("tx-menuitem-disabled"),n.attr("aria-disabled",(!t).toString()),n.find('.tx-menuitem-content[data-id="'+e+'"]').attr("aria-disabled",(!t).toString())}},{key:"setSmartSplitEnable",value:function(){this.setMenuStatus(i.SMARTSPLIT,!0)}},{key:"registerListener",value:function(){var e=this.props.handleClickItem,t=void 0===e?function(){}:e;this.rootEl.addEventListener("click",function(e){var n=e.target,a=n.getAttribute("data-id");"true"!==n.getAttribute("aria-disabled")&&t(a)})}},{key:"close",value:function(){}}]),e}();t.default=s},1324:function(e,t,n){var a=n(1325);"string"===typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,r);a.locals&&(e.exports=a.locals)},1325:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,'[data-id="paste-special-panel"] {\n  margin-top: 8px;\n}\n.tx-menu {\n  z-index: 1003;\n}\n.tx-menu {\n  width: 140px;\n  height: 160px;\n  background-color: #ffffff;\n}\n.tx-menu .tx-menuitem {\n  position: relative;\n  color: #333;\n  cursor: pointer;\n  list-style: none;\n  margin: 0;\n  padding: 9px 24px 9px 24px;\n  white-space: nowrap;\n  font-family: PingFangSC-Regular, "Microsoft YaHei", "SimHei", "SimSun", sans-serif;\n  font-size: 14px;\n  height: 14px;\n  line-height: 14px;\n  font-weight: normal;\n  font-stretch: normal;\n  color: #333333;\n  padding-right: 26px;\n  padding-left: 15px;\n}\n.tx-menu .tx-menuitem:hover {\n  background-color: #f5f5f5;\n}\n.tx-menu .tx-menuitem:active {\n  background-color: #e6e6e6;\n}\n.tx-menu .tx-menuitem.tx-menuitem-disabled {\n  color: #bbbbbb;\n  cursor: default;\n}\n.tx-menu .tx-menuitem.tx-menuitem-disabled:hover {\n  background-color: #ffffff;\n}\n.tx-menu .tx-menuitem.tx-menuitem-disabled:active {\n  background-color: #ffffff;\n}\n',""])},1326:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=s(n(14)),r=s(n(1327)),i=n(240),o=n(203),l=s(n(694));function s(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){var t=e.pasteData,n=e.type,s=e.active,u=e.hotInstance,c=e.__mergeBefore,d=e.cacheDoneActionsLength,f=e.smartSplitObj,p=e.envs;if(u.behavior.undoredoStack.undoStack.length===d){var h=u.spreadsheet.getActiveSheetId();u.behavior.apply({type:"undo",sheetId:h,requestId:-1}).then(function(){!function(e){var t=e.pasteData,n=e.type,s=e.active,u=e.hotInstance,c=e.smartSplitObj,d=e.envs,f=u.view,p=void 0;p=d&&d.triggeredBySP&&d.originPasteData||t;var h={xRange:s.xRange,yRange:s.yRange};f.canvas.excel.selectAreaCell(h,void 0,!0);var v=n===i.TRANSPOSE?t:p,g=(0,a.default)({},v);g.rowDataUpdate=v.rowDataUpdate;var m=(0,r.default)({pasteData:g,type:n,smartSplitObj:c}),y=l.default.bind({pasteData:(0,o.clone)(m)});u.plugins.copyPaste.doPaste({pasteData:m,selectAreaCellRange:h,cb:y,envs:{triggeredBySP:!0,pasteSpecialType:n,originPasteData:p}}),u.plugins.copyPaste.copyPasteCache.cancelCopy()}({pasteData:t,type:n,active:s,hotInstance:u,__mergeBefore:c,smartSplitObj:f,envs:p})})}else console.warn("not invalid doneActon length")}},1327:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(1328),i=n(1330),o=n(1331),l=n(406),s=(a=l)&&a.__esModule?a:{default:a},u=n(240);t.default=function(e){var t=e.pasteData,n=e.type,a=e.smartSplitObj;switch(n){case u.TRANSPOSE:return(0,r.transposeUserAction)(t);case u.MERGESTYLES:return(0,i.mergeStylesAction)(t);case u.ONLYVALUES:return(0,o.onlyValuesAction)(t);case u.SMARTSPLIT:return(0,s.default)(a);case u.KEEPDEFAULT:default:return t}}},1328:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transposeUserAction=void 0;var a=n(1329),r=n(68),i=n(203);t.transposeUserAction=function(e){var t=(0,i.clone)(e),n=t.merge,o=t.rowDataUpdate;return t.fromType=r.FromType.OUTER,t.merge=(0,a.transposeMerges)(n),t.rowDataUpdate=function(e){var t=e.map(function(e){return e.values});return(0,a.transpose)(t).map(function(e){return{values:e}})}(o),t}},1329:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.transpose=function(e){return Array.isArray(e)&&e.length>0?e[0].map(function(t,n){return e.map(function(e){return e[n]})}):e};t.transposeMerges=function(e){return e?a(e).map(function(e,t){return e.map(function(e,t){return e?{w:e.h,h:e.w}:e})}):e}},1330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mergeStylesAction=void 0;var a=o(n(14)),r=n(18),i=o(r);function o(e){return e&&e.__esModule?e:{default:e}}t.mergeStylesAction=function(e){return(0,a.default)(e,{merge:null,cellMask:r.CELL_DATA_SLOT_COMPOSE.ALL-(1<<i.default.SLOT_RICH_TEXT_STYLE_RUN),formatMask:0})}},1331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.onlyValuesAction=void 0;var a=s(n(14)),r=n(68),i=n(1332),o=n(18),l=s(o);function s(e){return e&&e.__esModule?e:{default:e}}t.onlyValuesAction=function(e){var t=e.merge;return(0,a.default)(e,{cellMask:o.CELL_DATA_SLOT_COMPOSE.ALL-(1<<l.default.SLOT_FORMULA)-(1<<l.default.SLOT_RICH_TEXT_STYLE_RUN),formatMask:0,merge:t?(0,i.transformToIgnoreMerge)(t):t,fromType:r.FromType.ONLYVALUE})}},1332:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.transformToIgnoreMerge=function(e){return e.map(function(e){return e.map(function(){return!1})})}},1333:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.tipsDialogShowIsInIE=void 0;var a,r=n(7),i=(a=r)&&a.__esModule?a:{default:a},o=n(71);var l=i.default.window,s=l.ActiveXObject||"ActiveXObject"in l;t.tipsDialogShowIsInIE=function(){s&&localStorage&&null==localStorage.getItem("ctrl_C_key_copyTip")&&(localStorage.setItem("ctrl_C_key_copyTip","true"),(0,o.hideToast)(),(0,o.showToast)("\u7531\u4e8eIE\u6d4f\u89c8\u5668\u9650\u5236\uff0c\u53ea\u80fd\u590d\u5236\u7eaf\u6587\u5b57\uff0c\u4e0d\u652f\u6301\u590d\u5236\u683c\u5f0f\u3002\u5efa\u8bae\u4f7f\u7528Chrome\u6216QQ\u6d4f\u89c8\u5668\u3002",void 0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,o.hideToast)()}}))}},1334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getCopyPasteToast=void 0;var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46));t.getCopyPasteToast=function(e,t){if(t)switch(e){case"copy":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u5e76\u7528",a.createElement("strong",null,"Cmd+V"),"\u7c98\u8d34\u3002");case"import":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u5e76\u7528",a.createElement("strong",null,"Cmd+V"),"\u7c98\u8d34\uff0c\u6216",a.createElement("strong",null,"\u5bfc\u5165\u8868\u683c"),"\u3002");case"save":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u7528",a.createElement("strong",null,"Cmd+V"),"\u7c98\u8d34\uff0c\u6216\u5c06\u539f\u56fe\u4fdd\u5b58\u5230\u7535\u8111\u540e\u70b9\u51fb\u201c",a.createElement("strong",null,"\u63d2\u5165\u56fe\u7247"),"\u201d\u3002")}else switch(e){case"copy":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u5e76\u7528",a.createElement("strong",null,"Ctrl+V"),"\u7c98\u8d34\u3002");case"import":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u5e76\u7528",a.createElement("strong",null,"Ctrl+V"),"\u7c98\u8d34\uff0c\u6216",a.createElement("strong",null,"\u5bfc\u5165\u8868\u683c"),"\u3002");case"save":return a.createElement("p",null,"\u56fe\u7247\u7c98\u8d34\u4e0d\u6210\u529f\u3002\u8bd5\u8bd5",a.createElement("strong",null,"\u5355\u72ec\u590d\u5236\u539f\u56fe"),"\u7528",a.createElement("strong",null,"Ctrl+V"),"\u7c98\u8d34\uff0c\u6216\u5c06\u539f\u56fe\u4fdd\u5b58\u5230\u7535\u8111\u540e\u70b9\u51fb\u201c",a.createElement("strong",null,"\u63d2\u5165\u56fe\u7247"),"\u201d\u3002")}}},1335:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.automaticIdentifyLink=void 0;var a=f(n(1336)),r=n(68),i=f(n(54)),o=f(n(78)),l=f(n(62)),s=n(1337),u=n(57),c=n(48),d=f(n(52));function f(e){return e&&e.__esModule?e:{default:e}}t.automaticIdentifyLink=function(e){var t=a.default.parse(e);return t instanceof Array?{rowDataUpdate:t.map(function(e){return{values:e.map(function(e){var t=void 0;t=e&&""!==e&&(0,s.validUrl)(e)?e:null;var n=null,a=(0,u.parseValueWithStyle)(e,null,{parseMode:u.PARSE_MODE.CURRENT_STYLE_FIRST});(a=(0,u.twelveNumberToText)(a)).numberFormat.pattern!==c.FORMAT_DEFAULT&&(n=new d.default({numberFormat:a.numberFormat}));var r=Number(a.valueType),f=""===a.value&&r==l.default.STRING?null:new o.default({type:r,value:a.value});return new i.default({effectiveValue:f,editValue:e,hyperlink:t,userEnteredFormat:n})})}}),merge:t.map(function(e){return e.map(function(){return!1})}),isSingle:!1,isMerge:!1,fromType:r.FromType.OUTER,fromApp:r.fromAppType.unknown,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!1}:null}},1337:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.validUrl=function(e){return/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})).?)(?::\d{2,5})?(?:[\/?#]\S*)?$/i.test(e)}},1338:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.parseCopyImgs=function(e){var t=[];if(!e||!e.clipboardData||!e.clipboardData.items)return null;for(var n=e.clipboardData.items,a=0;a<n.length;++a){var r=n[a];if("image/png"===r.type||"image/jpeg"===r.type){var i=r.getAsFile();i&&t.push(i)}}return t}},1339:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertParsedTableData2PasteData=t.convertParsedTableData2PasteDataTemp=void 0;var a,r=n(1340),i=(a=r)&&a.__esModule?a:{default:a};var o=t.convertParsedTableData2PasteDataTemp=function(e){var t={};t.changes=e&&e.data?e.data:[[]],t.styles=e&&e.styles?e.styles:null,t.link=e&&e.template?e.template:null,t.rowsHeight=e&&e.size&&e.size.rowHeights?e.size.rowHeights:null,t.colsWidth=e&&e.size&&e.size.colWidths?e.size.colWidths:null;var n=e&&e.selectType?e.selectType:null;t.hiddenRows=e&&e.hiddenRowCol&&e.hiddenRowCol.hiddenRows&&e.hiddenRowCol.hiddenRows.length>0?e.hiddenRowCol.hiddenRows:[],t.hiddenCols=e&&e.hiddenRowCol&&e.hiddenRowCol.hiddenCols&&e.hiddenRowCol.hiddenCols.length>0?e.hiddenRowCol.hiddenCols:[],t.link&&(t.link=t.link.map(function(e){return e.map(function(e){var t=(e||{link:!1}).link;return t?{linkurl:t.url,linkvalue:t.value,minType:"link"}:void 0})}));var a=e&&e.mergeCells?e.mergeCells:[];t.formula=e&&e.formula?e.formula:[[]],t.mClasses=null,t.isMaintaining=!0;var r=e?e.data[0].length-1:0,i=e?e.data.length-1:0;t.from={xRange:[0,r],yRange:[0,i],xDiff:r,yDiff:i,selectAll:"all"===n,selectRow:"row"===n,selectCol:"col"===n};var o=a.reduce(function(e,t){var n=t.row,a=t.col,r=t.rowspan,i=t.colspan;return e[n+"-"+a]={merge:!0,w:i,h:r},e},{}),l=a.reduce(function(e,t){for(var n=t.row,a=t.col,r=t.rowspan,i=t.colspan,o=n;o<=n+r-1;o++)for(var l=a;l<=a+i-1;l++)e[o+"-"+l]={merged:!0,parentIndexX:a,parentIndexY:n};return e},{});return t.styles=t.styles.map(function(e,n){return e.map(function(e,a){var r=l[n+"-"+a];if(r){var i=r.parentIndexX,o=r.parentIndexY;t.styles&&t.styles[o]&&t.styles[o][i]&&t.styles[o][i].border&&(e||(e={}),e.border=t.styles[o][i].border)}return e})}),t.merge=t.changes.map(function(e,t){return e.map(function(e,n){var a=o[t+"-"+n];if(a){var r=a.w,i=a.h;if(r&&i)return{w:r,h:i}}return!1})}),t};t.convertParsedTableData2PasteData=function(e){var t=o(e);return(0,i.default)(t)}},1340:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=b(n(312)),r=b(n(228)),i=b(n(62)),o=b(n(78)),l=b(n(54)),s=b(n(52)),u=b(n(121)),c=b(n(182)),d=b(n(225)),f=b(n(108)),p=b(n(185)),h=n(68),v=b(n(95)),g=b(n(156)),m=n(48),y=n(57),T=b(n(109)),C=n(33),S=b(n(224));function b(e){return e&&e.__esModule?e:{default:e}}function w(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.fontFamily:case"microsoft yahei":case"\u5fae\u8f6f\u96c5\u9ed1":return null;default:return e}}function R(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.fontSize:return null;default:return e}}function x(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.color:return null;default:return e}}function E(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.backgroundColor:return null;default:return e}}function I(e,t,n){var r=void 0,i=t&&!(0,a.default)(Number(t));switch(r=!!(n&&n.pattern!==m.FORMAT_DEFAULT||i),e){case"left":return r?c.default.LEFT:null;case"center":return c.default.CENTER;case"right":return i&&null===n?null:c.default.RIGHT;default:return null}}function _(e){switch(e){case"middle":return null;case"top":return d.default.TOP;case"bottom":return d.default.BOTTOM;default:return null}}function A(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.underline:return null;case"underline":return p.default.SINGLE_LINE;default:return null}}function D(e){switch(e){case C.DEFAULT_CELL_FORMAT_LITERAL.wrapStrategy:return null;case"normal":return f.default.WRAP;default:return null}}function k(e){if(!e)return null;var t=e.colors,n=e.styles;if(t&&!t.every(function(e){return null===e})||n&&!n.every(function(e){return null===e})){var a=null===t[0]||null===n[0]?null:new S.default({style:n[0],color:t[0]}),r=null===t[1]||null===n[1]?null:new S.default({style:n[1],color:t[1]}),i=null===t[2]||null===n[2]?null:new S.default({style:n[2],color:t[2]}),o=null===t[3]||null===n[3]?null:new S.default({style:n[3],color:t[3]});return new g.default({top:a,right:r,bottom:i,left:o})}return null}t.default=function(e){var t=e.changes,n=e.link,a=(e.formula,e.styles),c=t.map(function(e,t){return{values:e.map(function(e,r){var c=a&&a[t]&&a&&a[t][r];"string"===typeof e&&(e=(e=e.replace(/\ufeff/g,"")).replace(/\s+$/,""));var d=null;if(n&&n[t]&&n[t][r]){var f=n[t][r];f&&(d=f.linkurl)}var p,h=null,g=null,C=null,S=null,b=void 0;if(c){var M=c.format_data,O=c.cellcolor,L=c.border,N=c.h_align,F=c.v_align,P=c.textwrap,B=c.fontfamily,U=c.fontsize,V=c.fontcolor,H=c.bold,j=c.italic,Y=c.underline,q=c.strikeline;g=M&&"General"!==M?new u.default({pattern:M}):null;var G={color:x(V),fontFamily:w(B),fontSize:R(parseInt(U)),bold:"bold"===H||null,italic:"italic"===j||null,strikethrough:"strikeline"===q||null,underline:A(Y)};S=null===G.color&&null===G.fontFamily&&null===G.fontSize&&null===G.bold&&null===G.italic&&null===G.strikethrough&&null===G.underline?null:new v.default(G),b={numberFormat:g,backgroundColor:E(O),horizontalAlign:I(N,e,g),verticalAlign:_(F),wrapStrategy:D(P),borders:k(L),textFormat:S},h=new s.default(b),C=(p=c.textFormatRuns)&&p.length?p.map(function(e){var t=e.format;if(null===t)return new T.default({startIndex:e.startIndex});var n=t.fontfamily,a=t.fontsize,r=t.fontcolor,i=t.bold,o=t.italic,l=t.underline,s=t.strikeline;return new T.default({startIndex:e.startIndex,format:new v.default({color:r,fontFamily:n,fontSize:a?parseInt(a):null,bold:"bold"===i,italic:"italic"===o,strikethrough:"strikeline"===s,underline:A(l)})})}):null}var z=(0,y.parseValueWithStyle)(e,g,{parseMode:y.PARSE_MODE.CURRENT_STYLE_FIRST});z=(0,y.twelveNumberToText)(z),(!g||g&&g.pattern===m.FORMAT_DEFAULT)&&z.numberFormat.pattern!==m.FORMAT_DEFAULT&&h&&h.setNumberFormat(z.numberFormat);var X=Number(z.valueType),W=""===z.value&&X==i.default.STRING?null:new o.default({type:X,value:z.value});return W||d||h&&0!==h.setSlots||C?new l.default({effectiveValue:W,hyperlink:d,userEnteredFormat:h&&0!==h.setSlots?h:null,textFormatRuns:C}):null})}}),d={isSingle:!1,isMerge:!1,merge:e.merge,rowDataUpdate:c,formula:e.formula,fromType:h.FromType.OUTER,fromApp:h.fromAppType.unknown,select:{selectAll:e.from.selectAll,selectCol:e.from.selectCol,selectRow:e.from.selectRow},containTable:!1};return e.rowsHeight&&(d.rowsDimensionProperties=e.rowsHeight.map(function(t,n){return new r.default({pixelSize:t,hiddenByUser:e.hiddenRows&&e.hiddenRows[n]})})),e.colsWidth&&(d.colsDimensionProperties=e.colsWidth.map(function(t,n){return new r.default({pixelSize:t,hiddenByUser:e.hiddenCols&&e.hiddenCols[n]})})),d}},1341:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.parseHTMLIsSingleImg=function(e){var t=(new DOMParser).parseFromString(e,"text/html");return 1===t.body.children.length&&"img"===t.body.children[0].tagName.toLocaleLowerCase()}},1414:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=w(n(9)),r=w(n(154)),i=w(n(0)),o=w(n(1)),l=w(n(14)),s=w(n(7)),u=n(709),c=n(22),d=w(n(314)),f=w(n(13)),p=n(441),h=n(137),v=w(n(17)),g=w(n(1415)),m=w(n(1421)),y=n(249),T=w(n(12)),C=n(71),S=n(99),b=w(n(8));function w(e){return e&&e.__esModule?e:{default:e}}var R=s.default.window,x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};b.default.tdwReport((0,l.default)({opername:"doc_form",module:"excel",action:e},t))},E=function(e){b.default.monitor(e)},I=null,_=function(){function e(t){(0,i.default)(this,e),this.app=t,this.initRelation(),this.initToolbarEntry(),this.checkFormSyncExceptions(!0),this.afterHandleCallbacks=[],this.syncComplute=!1}return(0,o.default)(e,[{key:"initRelation",value:function(){var e=this;this.relateMap=(0,r.default)(null);var t=s.default.clientVars.relative||[],n=this.app.spreadsheet.getSheets().map(function(e){return e.getSheetId()});this.globalId=t.domain_id+"$"+t.pad_id,t.forEach(function(t){t&&t.sub_id&&t.doc_url&&n.indexOf(t.sub_id)>-1&&(e.relateMap[t.sub_id]={formUrl:t.doc_url})}),this.getRelatedNumber()&&b.default.tdwReport({opername:"doc_core",module:"visit",action:"detail_page",ver6:1})}},{key:"initToolbarEntry",value:function(){var e=this;R.addEventListener("load",function(){e.updateToolbar()},!1),this.updateToolbar()}},{key:"handle",value:function(e,t,n){switch(e){case"new_to_form":this.handleNewToForm();break;case"convert_to_form":this.handleConvertToForm();break;case"check_form":this.handleCheckForm(t);break;case"cancel_form":this.handleCancelForm(t,!!n);break;case"cancel_form_sheetbar":this.handleCancelForm(t,!!n,!0);break;case"share_form":this.handleShareForm(t);break;case"result_form":this.handleResultForm(t);break;case"change_header":this.updateToolbar()}n&&this.afterHandleCallbacks.push(n)}},{key:"checkReleaseCell",value:function(e,t,n){var a=n||this.app.spreadsheet.activeSheet,r=a.data.columnMetadata,i=a.data.rowMetadata,o=r&&r[t],l=i&&i[e],s=o&&o.formData,u=l&&l.formData;if(s&&u){if("question"===u.formDataId)return 1;if(u.formDataId.indexOf("record")>=0)return 2}return 0}},{key:"checkReleaseRange",value:function(e,t,n,a){for(var r=e.startColIndex,i=e.startRowIndex,o=e.endColIndex,l=e.endRowIndex,s=0,u=i;u<=l;u++)for(var c=r;c<=o;c++){var d=n&&n[c],f=t&&t[u],p=d&&d.formData,h=f&&f.formData;if(p&&h){if("question"===h.formDataId?s=1:h.formDataId.indexOf("record")>=0&&(s=2),s===a||s&&3===a)return 3===a?3:s;if(s&&4===a)return 4}}return s}},{key:"isRelated",value:function(e){return e in this.relateMap}},{key:"isLoading",value:function(){return this.needShowLoading}},{key:"getRelatedSheetId",value:function(){return(0,a.default)(this.relateMap)[0]}},{key:"getRelatedNumber",value:function(){return(0,a.default)(this.relateMap).length}},{key:"updateFromSheetHeaderSync",value:function(e,t){var n=this.isRelated(e),a=t===d.default.FORM;a&&!n?(this.updateRelateMap(e,{}),this.updateUI()):!a&&n&&(this.updateRelateMap(e,null),this.updateUI())}},{key:"updateFromSyncMutations",value:function(e,t){for(var n=!1,a=0;a<e.length&&!n;a++){var r=e[a];if(!Array.isArray(r))break;for(var i=0;i<r.length;i++){var o=(0,h.createMutationFromSerialize)(r[i]);if(o&&o.workbookRangeId&&o.id===v.default.DELETE_SHEET_RANGE_MUTATION&&["<author>","<time>"].indexOf(o.workbookRangeId)>-1){n=!0;break}}}n&&(this.updateRelateMap(t,null),this.updateUI())}},{key:"checkFormSyncExceptions",value:function(e){var t=this,n=s.default.event.sheetsBar;this.stopCheckSync(),(0,u.checkSyncExceptions)(this.globalId).then(function(e){if(t.needShowLoading=e&&e.loading,e&&0===e.retcode&&e.loading){t.checkTimeFlag=T.default.wait(5e3).run(function(){t.checkFormSyncExceptions()});var a=t.app.spreadsheet.getActiveSheetId();t.isRelated(a)&&n.trigger("showRelateLoading",a)}else n.trigger("switchSheetEnd")}).catch(function(e){n.trigger("switchSheetEnd")})}},{key:"continueCheck",value:function(){}},{key:"stopCheckSync",value:function(){T.default.erase(this.checkTimeFlag)}},{key:"isOpenDialog",value:function(){return!!I}},{key:"updateSelectedData",value:function(){I&&I.onSheetUpdate(this.getSheetTitle())}},{key:"hideSelectQuestionDailog",value:function(){I&&I.hide()}},{key:"getRelation",value:function(e){return this.relateMap[e]||null}},{key:"getToolbarEntryElement",value:function(){var e=this.toolbarEntryElement;return e||(e=document.querySelector("#toolbar-form-dropdown-group"),this.toolbarEntryElement=e),e}},{key:"showToolbarEntry",value:function(){var e=this.getToolbarEntryElement();e&&(e.style.display="")}},{key:"hideToolbarEntry",value:function(){var e=this.getToolbarEntryElement();e&&(e.style.display="none")}},{key:"createNewSheet",value:function(){var e="",t=this.getTitle();return s.default.event.sheetsBar.trigger("addSheet",!1,function(t){e=t},t,d.default.FORM),e}},{key:"switchToRelatedSheet",value:function(e){s.default.event.sheetsBar.trigger("switchSheet",e||this.getRelatedSheetId(),this.getCurrentSheetId())}},{key:"getSheetTitle",value:function(){return s.default.clientVars.isUserChangeTitle?s.default.clientVars.padTitle:""}},{key:"getTitle",value:function(){var e=this.getSheetTitle()||"\u65e0\u6807\u9898\u6536\u96c6\u8868";return e.length>32?e.substr(0,32):e}},{key:"getCurrentSheet",value:function(){var e=this.app.spreadsheet.getActiveSheetId();return this.app.spreadsheet.getSheetBySheetId(e)}},{key:"getCurrentSheetId",value:function(){var e=this.getCurrentSheet();return e&&e.getSheetId()||""}},{key:"createSuccess",value:function(e,t,n){t&&t.url?(this.updateRelateMap(e,t),this.updateUI(),this.gotoFormEditPage(t.url,!0),this.handleDone(),x("expo_formbar",{ver5:n?1:2}),c.isMobile?E(33647158):E(33647157)):this.createFail(e,t)}},{key:"createFail",value:function(e,t){var n=t&&(t.msg||t.errmsg);this.showToolToast(n?"\u521b\u5efa\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff1a"+n+"\u3002":"\u7f51\u7edc\u5f02\u5e38\uff0c\u521b\u5efa\u5931\u8d25\u3002"),s.default.event.sheetsBar.trigger("deleteSheet",e)}},{key:"handleDone",value:function(){for(;this.afterHandleCallbacks.length;){var e=this.afterHandleCallbacks.shift();e&&e()}}},{key:"resetSheetType",value:function(e){var t=this.app.spreadsheet.getSheetBySheetId(e);if(t){t.getProperties().setSheetType(d.default.GRID);var n=this.app.spreadsheet.getSheets(),a=(0,p.getSheetsForCommit)(n);this.app.behavior.apply({type:"local",requestId:f.default.SET_SHEETS_REQUEST,sheetId:e,opt:{sheetId:e,behaviors:a,oSubId:!1,withKeyData:!1},canUndoRedo:!1})}}},{key:"updateUI",value:function(){this.updateToolbar(),this.updateSheetbar()}},{key:"updateSheetbar",value:function(){s.default.event.sheetsBar.trigger("bindStatusChange")}},{key:"updateToolbar",value:function(){var e=this.getRelatedNumber();s.default.clientVars.isCreator&&e?this.showToolbarEntry():this.hideToolbarEntry()}},{key:"updateRelateMap",value:function(e,t){t?this.relateMap[e]={formUrl:t.url}:delete this.relateMap[e]}},{key:"getFormUrl",value:function(e,t){return this.getRelation(e).formUrl+(t||"")}},{key:"gotoFormEditPage",value:function(e,t){var n=this,a=function(e){var t=s.default.window.mqq;if(c.isWxMiniProgram&&s.default.window.wx)s.default.window.wx.miniProgram.redirectTo({url:"/pages/detail/detail?url="+encodeURIComponent(e)});else{if(!c.isPad||!c.isTencentDocsApp)return t&&t.ui&&t.ui.openUrl?(t.ui.openUrl({url:e,target:0,style:3}),!0):!!R.open(e);(0,y.tencentDocOpenUrl)(e)}}(e.includes("?")?"https:"+e:"https:"+e+"?form=sheet#/edit");if(t)if(a)this.switchToRelatedSheet();else{var r=(0,m.default)(e);(0,C.showToast)(r,void 0,{isNeedBtn:!0,isNeedClose:!0});var i=document.querySelector("#relate-form-url");i&&i.addEventListener("click",function(){n.switchToRelatedSheet(),(0,C.hideToast)()})}}},{key:"loadSheetSlient",value:function(e){var t=this.app.spreadsheet.getSheetBySheetId(e);t&&(t.isLoaded||this.app.handleData.setSheetData(t,{onSuccess:function(){}}))}},{key:"handleNewToForm",value:function(){var e=this;if(!(this.getRelatedNumber()>0)){var t=this.createNewSheet(),n=this.getSheetTitle();this.loadSheetSlient(t),(0,u.createForm)(t,n).then(function(n){e.afterCreateForm(t,n,!0)}).catch(function(n){e.createFail(t,n)}),x("clk_toolbar_create")}}},{key:"getQuestionLineNumber",value:function(){var e=this.app.spreadsheet.getActiveSheetId(),t=this.app.spreadsheet.getSheetBySheetId(e),n=t&&t.data,i=n&&n.rowData,o=1;if(!i)return o;for(var l=!1,s=(0,r.default)(null),u=0;u<i.length;u++){if(l||30===u)break;var c=i[u],d=c&&c.values;if(d){s[u]=0;for(var f=0;f<d.length&&!l;f++){var p=d[f];p&&(p.getEditValue()&&s[u]++,s[u]>=5&&(l=!0,o=u))}}}if(!l){var h=[];(0,a.default)(s).forEach(function(e){return h.push(s[e])});var v=Math.max.apply(Math,h);for(var g in s)if(s[g]===v){o=+g;break}}return o+1}},{key:"handleConvertToForm",value:function(){var e=this;if(!(this.getRelatedNumber()>0)){var t=this.getSheetTitle(),n=this.getQuestionLineNumber();I=(0,g.default)(this.app,n,t,function(n){e.afterQuestionListSelected(t,n)},function(){I=null}),x("clk_sheetcon_create")}}},{key:"afterQuestionListSelected",value:function(e,t){var n=this,a=this.createNewSheet();this.loadSheetSlient(a),(0,u.createForm)(a,e,t).then(function(e){n.afterCreateForm(a,e,!1)}).catch(function(e){n.createFail(a,e)}),x("clk_sheet_create")}},{key:"afterCreateForm",value:function(e,t,n){this.createSuccess(e,t,n)}},{key:"handleCheckForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_check");this.gotoFormEditPage(n),x("clk_formbar_view")}}},{key:"handleCancelForm",value:function(e,t,n){var a=this,r=e||this.getCurrentSheetId();if(this.isRelated(r)){var i=function(){return(0,u.cancelRelateForm)(r).then(function(e){a.cancelSuccess(r,e,n)}).catch(function(e){a.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")})};if(t)i();else{S.dialog.confirm("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868","\u786e\u5b9a\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5417\uff1f\u53d6\u6d88\u5173\u8054\u540e\uff0c\u6536\u96c6\u7684\u7ed3\u679c\u5c06\u4e0d\u518d\u81ea\u52a8\u66f4\u65b0\u5230\u5f53\u524d\u8868\u683c\u3002",function(){i(),x(n?"clk_sheet_cancel":"clk_formbar_cancel")},function(){})}}}},{key:"cancelSuccess",value:function(e,t,n){t&&0===t.retcode?(this.updateRelateMap(e,null),this.updateUI(),this.resetSheetType(e),this.handleDone(),n||this.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u6210\u529f\u3002")):this.showToolToast("\u53d6\u6d88\u5173\u8054\u6536\u96c6\u8868\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u91cd\u8bd5\u3002")}},{key:"showToolToast",value:function(e){(0,C.showToast)(e,{},{supportMobile:!0,toolToastCloseTime:3e3})}},{key:"handleShareForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"?openfrom=sheet_share");this.gotoFormEditPage(n),x("clk_formbar_share")}}},{key:"handleResultForm",value:function(e){var t=e||this.getCurrentSheetId();if(this.isRelated(t)){var n=this.getFormUrl(t,"#/result");this.gotoFormEditPage(n),x("clk_formbar_result")}}}]),e}();t.default=_},1415:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=v(n(3)),r=v(n(0)),i=v(n(1)),o=v(n(4)),l=v(n(5)),s=n(46),u=v(s),c=v(n(123)),d=v(n(1416)),f=v(n(1417)),p=n(709),h=v(n(1418));function v(e){return e&&e.__esModule?e:{default:e}}n(1419);var g=document.createElement("div");g.id="rmapui-question-dialog-container",document.body.appendChild(g),g.style.display="none";var m=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.checkboxGroupRef=null,n.state={formTitle:e.formTitle,maxLineNumber:200,lineNumber:e.lineNumber||1},n}return(0,l.default)(t,e),(0,i.default)(t,[{key:"hide",value:function(){g.style.display="none",c.default.unmountComponentAtNode(g),this.props.onHide&&this.props.onHide()}},{key:"getCheckBoxGroupData",value:function(e){var t=this;return e.map(function(e,n){return{checked:!0,text:e,value:"q-"+t.state.lineNumber+"-"+n}})}},{key:"getCurrentSheet",value:function(){var e=this.props.app,t=e.spreadsheet.getActiveSheetId();return e.spreadsheet.getSheetBySheetId(t)}},{key:"getCurrentSheetData",value:function(){var e=this.getCurrentSheet(),t=e&&e.data;return t&&t.rowData}},{key:"getQuestionList",value:function(e){e-=1;var t=this.getCurrentSheetData(),n=(t&&t[e]&&t[e].values||[]).map(function(e){return e&&e.getEditValue()}).filter(function(e){return!!e});return n.length>p.questionNumberMax&&(n=n.slice(0,p.questionNumberMax)),n.map(function(e){return e&&e.length>p.questionTitleMaxLength?e.substr(0,p.questionTitleMaxLength):e})}},{key:"onSheetUpdate",value:function(e){this.setState({formTitle:e})}},{key:"onLineNumberChange",value:function(e){this.setState({lineNumber:e})}},{key:"eventClickClose",value:function(){this.hide()}},{key:"eventClickConfirm",value:function(){var e=[];this.checkboxGroupRef&&(e=(this.checkboxGroupRef.getValue()||[]).map(function(e){return e&&e.text}));this.props.onSelect&&this.props.onSelect(e),this.hide()}},{key:"componentWillMount",value:function(){var e=this.getCurrentSheet(),t=e&&e.getRowCount();t&&this.setState({maxLineNumber:t})}},{key:"render",value:function(){var e=this,t=this.getQuestionList(this.state.lineNumber),n=this.getCheckBoxGroupData(t);return u.default.createElement("div",{className:"rmapui-box",style:{display:"block"}},u.default.createElement(h.default,{handle:".rmapui-drag-area"},u.default.createElement("div",{className:"pad-ui-dialog common-web-popup-boxshadow rmapui-box-wrap"},u.default.createElement("div",{className:"rmapui-drag-area"}),u.default.createElement("div",{className:"pad-ui-dialog-close custom-dataformat-dialog-close",onClick:this.eventClickClose.bind(this)}),u.default.createElement("div",{className:"pad-ui-dialog-header cdd-header rmapui-header"},u.default.createElement("span",{className:"pad-ui-dialog-title"},"\u57fa\u4e8e\u5de5\u4f5c\u8868\u5185\u5bb9\u521b\u5efa\u6536\u96c6\u8868")),u.default.createElement("div",{className:"pad-ui-dialog-content cdd-body"},u.default.createElement("h3",{className:"rmapui-title",title:this.state.formTitle},this.state.formTitle),u.default.createElement("div",{className:"rmapui-row"},u.default.createElement("span",{className:"rmapui-row-text-left"},"\u57fa\u4e8e\u7b2c"),u.default.createElement(d.default,{minNumber:1,maxNumber:this.state.maxLineNumber,defaultNumber:this.props.lineNumber,onNumberChange:this.onLineNumberChange.bind(this)}),u.default.createElement("span",{className:"rmapui-row-text-right"},"\u884c\u5185\u5bb9\u521b\u5efa\u6536\u96c6\u95ee\u9898")),u.default.createElement("div",{className:"rmapui-qlist"},n.length?u.default.createElement(f.default,{list:n,itemCls:"rmapui-li",ref:function(t){return e.checkboxGroupRef=t}}):u.default.createElement("div",{className:"rmapui-qlist-empty"}))),u.default.createElement("div",{className:"cdd-footer rmapui-footer"},u.default.createElement("div",{onClick:this.eventClickClose.bind(this),className:"pad-ui-btn pad-ui-btn-normal pad-ui-btn-white rmapui-cancel"},"\u53d6\u6d88"),u.default.createElement("div",{onClick:this.eventClickConfirm.bind(this),className:"pad-ui-btn pad-ui-btn-normal pad-ui-btn-blue rmapui-confirm"},"\u786e\u5b9a")))))}}]),t}(s.Component);t.default=function(e,t,n,a,r){return g.style.display="block",c.default.render(u.default.createElement(m,{app:e,lineNumber:t,formTitle:n,onSelect:a,onHide:r}),g)}},1416:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(3)),r=c(n(0)),i=c(n(1)),o=c(n(4)),l=c(n(5)),s=n(46),u=c(s);function c(e){return e&&e.__esModule?e:{default:e}}var d=function(e){function t(e){(0,r.default)(this,t);var n=(0,o.default)(this,(t.__proto__||(0,a.default)(t)).call(this,e));return n.state={value:e.defaultNumber||1},n}return(0,l.default)(t,e),(0,i.default)(t,[{key:"callParent",value:function(e){this.props.onNumberChange&&this.props.onNumberChange(e)}},{key:"collectValue",value:function(e){return e<=0?1:Math.round(e)}},{key:"setValue",value:function(e){e=+e,e=this.collectValue(e);var t=this.props,n=t.minNumber,a=t.maxNumber;"number"===typeof n&&e<n&&(e=n),"number"===typeof a&&e>a&&(e=a),+this.state.value!==e&&(this.setState({value:String(e)}),this.callParent(e))}},{key:"eventClickChange",value:function(e){var t=+this.state.value;e?t++:t--,this.setValue(t)}},{key:"eventInputChange",value:function(e){var t=e.target.value;(t=t.replace(/[^\d]/g,""))?this.setValue(+t):this.setState({value:""})}},{key:"eventInputBlur",value:function(e){e.target.value||this.setValue(this.props.defaultNumber||1)}},{key:"render",value:function(){var e=this,t=this.state.value;return u.default.createElement("div",{className:"ac-input-number-wrapper"},u.default.createElement("div",{className:"ac-input-number"},u.default.createElement("div",{className:"ac-input-number-handler-wrap"},u.default.createElement("span",{onClick:function(){return e.eventClickChange(!1)},className:"ac-input-number-handler ac-input-number-handler-up"}),u.default.createElement("span",{onClick:function(){return e.eventClickChange(!0)},className:"ac-input-number-handler ac-input-number-handler-down"})),u.default.createElement("div",{className:"ac-input-number-input-wrap"},u.default.createElement("input",{type:"text",className:"ac-input-number-input",autoComplete:"off",value:t,onChange:this.eventInputChange.bind(this),onBlur:this.eventInputBlur.bind(this)}))))}}]),t}(s.Component);t.default=d},1417:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(154)),r=d(n(3)),i=d(n(0)),o=d(n(1)),l=d(n(4)),s=d(n(5)),u=n(46),c=d(u);function d(e){return e&&e.__esModule?e:{default:e}}var f=function(e){function t(e){return(0,i.default)(this,t),(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e))}return(0,s.default)(t,e),(0,o.default)(t,[{key:"callParent",value:function(){this.props.onChange&&this.props.onChange(this.refCheckbox&&this.refCheckbox.checked)}},{key:"getValue",value:function(){var e=this.props,t=e.value;return{text:e.text,value:t,checked:this.refCheckbox&&this.refCheckbox.checked}}},{key:"eventChange",value:function(){this.callParent()}},{key:"eventClickText",value:function(){this.refCheckbox&&(this.refCheckbox.checked=!this.refCheckbox.checked)}},{key:"render",value:function(){var e=this,t=this.props,n=t.value,a=t.text;return c.default.createElement("div",{className:"ac-checkBox"},c.default.createElement("div",{className:"ac-checkBox-container"},c.default.createElement("input",{type:"checkbox",value:n,id:"cb-"+n,defaultChecked:!!this.props.checked,ref:function(t){return e.refCheckbox=t},onChange:this.eventChange.bind(this)}),c.default.createElement("label",{htmlFor:"cb-"+n}),c.default.createElement("span",{className:"ac-checkBox-content",title:a,style:{cursor:"pointer"},onClick:this.eventClickText.bind(this)},a)))}}]),t}(u.Component),p=function(e){function t(e){(0,i.default)(this,t);var n=(0,l.default)(this,(t.__proto__||(0,r.default)(t)).call(this,e));return n.refMap=(0,a.default)(null),n}return(0,s.default)(t,e),(0,o.default)(t,[{key:"getValue",value:function(){var e=this,t=[];return this.props.list.forEach(function(n){var a=e.refMap[n&&n.value];a&&t.push(a.getValue())}),(t||[]).filter(function(e){return e&&e.checked})}},{key:"componentWillUnmount",value:function(){this.refMap=(0,a.default)(null)}},{key:"render",value:function(){var e=this,t=this.props.list;return c.default.createElement("ul",null,(t||[]).map(function(t,n){return c.default.createElement("li",{key:t.value,className:e.props.itemCls},c.default.createElement(f,{text:t.text,value:t.value,checked:t.checked,ref:function(n){return e.refMap[t.value]=n}}))}))}}]),t}(u.Component);t.default=p},1419:function(e,t,n){var a=n(1420);"string"===typeof a&&(a=[[e.i,a,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};n(37)(a,r);a.locals&&(e.exports=a.locals)},1420:function(e,t,n){(e.exports=n(36)(!1)).push([e.i,"#rmapui-question-dialog-container {\n  position: fixed;\n  width: 388px;\n  height: 454px;\n  margin-left: -194px;\n  margin-top: -227px;\n  left: 50%;\n  top: 50%;\n  z-index: 999;\n  display: none;\n}\n#rmapui-question-dialog-container .rmapui-box {\n  width: 100%;\n  height: 100%;\n}\n#rmapui-question-dialog-container .rmapui-box-wrap {\n  width: 100%;\n  height: 100%;\n  left: 0;\n  top: 0;\n}\n#rmapui-question-dialog-container .rmapui-drag-area {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  height: 70px;\n  cursor: move;\n}\n#rmapui-question-dialog-container .rmapui-header {\n  padding-bottom: 36px;\n}\n#rmapui-question-dialog-container .rmapui-title {\n  text-align: center;\n  font-size: 24px;\n  opacity: 0.88;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  padding: 2px 0;\n  margin-top: 5px;\n}\n#rmapui-question-dialog-container .rmapui-row {\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  padding-top: 2px;\n}\n#rmapui-question-dialog-container .rmapui-row-text-left {\n  margin-right: 5px;\n  position: relative;\n  right: 2px;\n}\n#rmapui-question-dialog-container .rmapui-row-text-right {\n  margin-left: 5px;\n  position: relative;\n  left: 3px;\n}\n#rmapui-question-dialog-container .rmapui-row .ac-input-number-input-wrap {\n  width: 50px;\n}\n#rmapui-question-dialog-container .rmapui-qlist {\n  box-sizing: border-box;\n  padding: 10px 19px;\n  border: 1px solid rgba(0, 0, 0, 0.1);\n  height: 178px;\n  overflow-y: auto;\n  margin: 0 1px;\n  margin-top: 14px;\n}\n#rmapui-question-dialog-container .rmapui-qlist .rmapui-li {\n  position: relative;\n  top: -4px;\n}\n#rmapui-question-dialog-container .rmapui-qlist .rmapui-li .ac-checkBox {\n  margin: 0 0 6px;\n}\n#rmapui-question-dialog-container .rmapui-qlist .ac-checkBox-content {\n  display: inline-block;\n  max-width: 260px;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  -webkit-user-select: none;\n     -moz-user-select: none;\n      -ms-user-select: none;\n          user-select: none;\n}\n#rmapui-question-dialog-container .rmapui-qlist-empty {\n  text-align: center;\n}\n#rmapui-question-dialog-container .rmapui-footer {\n  text-align: right;\n  padding-top: 36px;\n}\n#rmapui-question-dialog-container .rmapui-footer .rmapui-cancel {\n  margin-right: 3px;\n}\n#rmapui-question-dialog-container .rmapui-confirm {\n  margin-left: 13px;\n}\n",""])},1421:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return a.createElement("span",null,"\u6536\u96c6\u8868\u5df2\u521b\u5efa\u3002",a.createElement("a",{id:"relate-form-url",href:e,style:{color:"#0086ff"},target:"_blank"},"\u7f16\u8f91\u6536\u96c6\u8868"))};var a=function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t.default=e,t}(n(46))},1426:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=d(n(226)),r=d(n(14)),i=d(n(0)),o=d(n(1)),l=n(112),s=d(n(315)),u=d(n(7)),c=d(n(11));function d(e){return e&&e.__esModule?e:{default:e}}var f=function(){function e(t){(0,i.default)(this,e),this.app=t}return(0,o.default)(e,[{key:"addRule",value:function(e){var t=e.ranges;if(e.booleanCondition){var n=u.default.window.clientVars.tinyid||null,a=this.uiRule2RequestRule(n,e);a&&(0,l.addConditionFormat)({rule:(0,r.default)({ruleRanges:t},a)})}}},{key:"deleteRule",value:function(e){(0,l.deleteConditionFormat)({ruleIndex:e})}},{key:"updateRule",value:function(e,t){var n=t.ranges;if(t.booleanCondition){var a=this.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleByRuleIndex(e);if(a){var i=a.uid,o=this.uiRule2RequestRule(i,t);o&&(0,l.updateConditionFormat)({ruleIndex:e,rule:(0,r.default)({ruleRanges:n},o)})}}}},{key:"getRuleList",value:function(){return this.app.spreadsheet.activeSheet.getConditionalFormatRule().getConditionalFormatRuleAll()}},{key:"getRuleListCount",value:function(){return this.getRuleList().length}},{key:"getRuleListWithCurrentSelection",value:function(){var e=this.app.view.getSelection().rangeSelections[0];return this.getRuleListAtRange(e)}},{key:"getRuleListAtRange",value:function(e){return this.getRuleList().filter(function(t){return t.rule.ruleRanges.some(function(t){return t.isCross(e)})})}},{key:"getRuleListCountWithCurrentSelection",value:function(){return this.getRuleListWithCurrentSelection().length}},{key:"getRuleListAtPosition",value:function(e,t){var n=this.app.spreadsheet.getActiveSheetId(),a=new c.default(n,e,e,t,t);return this.getRuleListAtRange(a)}},{key:"whatCellFormatsDependOnConditionalFormat",value:function(e,t){var n={bgColor:!1},a=this.app.spreadsheet.activeSheet.getCellDataAtPosition(e,t),r=a&&a.getConditionalFormatResult();return r&&r.getBackgroundColor()&&(n.bgColor=!0),n}},{key:"isSelectedRangeConditionalFormatBGColorEffect",value:function(){var e=this;return this.app.view.getSelection().rangeSelections[0].some(function(t,n){return e.whatCellFormatsDependOnConditionalFormat(t,n).bgColor})}},{key:"uiRule2RequestRule",value:function(e,t){var n=t.booleanCondition,r=t.ranges;if(n){var i=n.condition,o=n.format;return-1===(0,a.default)(s.default).indexOf(i.conditionType)?null:{ruleRanges:r,booleanConditionalFormat:{condition:{conditionType:i.conditionType,userInputOne:i.inputOne,userInputTwo:i.inputTwo},format:{bgColor:o.bgColor}},gradientConditionalFormat:null,userId:e}}return null}},{key:"formulaStringToFormulaModel",value:function(){}}]),e}();t.default=f},1427:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1)),i=n(112);function o(e){return e&&e.__esModule?e:{default:e}}var l=500,s=function(){function e(t){var n=this;(0,a.default)(this,e),this.mode="none",this.exitClickTime=0,this.hasInit=!1,this.handleClick=function(){if(n.status){var e=n.getSelection(),t=(new Date).getTime();return"single"===n.mode?(i.formatPainter.apply(),void n.exit()):"infinite"===n.mode&&t-n.exitClickTime<l&&e==n.lastSelect?(n.exit(),void(n.lastSelect="")):void("infinite"===n.mode&&(i.formatPainter.apply(),n.exitClickTime=t,n.lastSelect=e))}},this.app=t,this.editDom=document.querySelector("#padeditor")}return(0,r.default)(e,[{key:"init",value:function(){var e=this;this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.event.eventInput.listen("inputShow",this.exit.bind(this)),this.app.event.default.listen("key-event",function(t){switch(t){case"escape":e.exit()}})}},{key:"enter",value:function(e){this.hasInit||(this.hasInit=!0,this.init()),this.mode=e;var t=this.app.view.getSelection().rangeSelections;if(t.length>1)return alert("\u683c\u5f0f\u5237\u4e0d\u652f\u6301\u591a\u9009\u533a22");this.editDom.classList.add("format-now"),this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.doCopy(),i.formatPainter.setCache(t[0],this.app),this.editDom.addEventListener("click",this.handleClick),this.app.event.default.trigger("enter-format-painter",this.mode),this.status=!0}},{key:"exit",value:function(){this.status&&(this.status=!1,this.mode="none",this.app&&this.app.view&&this.app.view.canvas&&this.app.view.canvas.excel.closeCopy(),i.formatPainter.clear(),this.editDom.classList.remove("format-now"),this.editDom.removeEventListener("click",this.handleClick),this.app.event.default.trigger("exit-format-painter"))}},{key:"getSelection",value:function(){var e=this.app.view.canvas.excel.selectData.active;return e.xRange.join("")+"-"+e.yRange.join("")}},{key:"getMode",value:function(){return this.mode}}]),e}();t.default=s},1428:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(0)),r=l(n(1)),i=l(n(1429)),o=n(711);function l(e){return e&&e.__esModule?e:{default:e}}var s=function(){function e(t){(0,a.default)(this,e),this.app=t}return(0,r.default)(e,[{key:"isSupportSmartSplit",value:function(){return(0,o.isSupportSmartSplit)(this.app)}},{key:"showSplitGuideDialog",value:function(){(0,o.showSplitGuideDialog)(this.app)}},{key:"doManualSmartSplit",value:function(){(0,i.default)(this.app)}}]),e}();t.default=s},1429:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(16)),r=p(n(14)),i=p(n(41)),o=p(n(89)),l=p(n(81)),s=p(n(311)),u=n(690),c=n(711),d=p(n(1432)),f=n(406);function p(e){return e&&e.__esModule?e:{default:e}}var h=p(n(7)).default.window,v=h.$;t.default=function(e){var t=e.view.getSelection().rangeSelections[0];if(t.startColIndex===t.endColIndex){var n=(0,c.getSmartSplitRange)(e,t);!function(e,t,n,r){var p=!1,g=!0,m=void 0,y=void 0;l.default.util.timer.wait(2e3).run(function(){g&&(m=(0,c.showWaitingDialog)(e,function(){p=!0,"function"===typeof y?y():(0,c.enterActiveStateAndSelectCell)(e)}))});var T=function(){if(!p){g=!1;var e=(0,d.default)(t),a=(0,i.default)(e,3),o=(a[0],a[1]),l=a[2];o<1||l<1?m?y=function(){r()}:r():n(t,e),m&&(m.close(),m=null)}};!function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:function(){},i=function(e,t){for(var n=e.view.canvas.excel.tableData.data,a=t.startRowIndex,r=t.endRowIndex,i=t.startColIndex,o=t.endColIndex,l=[],s=a;s<=r;s++){for(var u=[],c=i;c<=o;c++){var d=n[s],f=d&&d[i],p=f&&f.text;p=p||"",u.push(p)}l.push(u)}return l}(e,t),o=!1;v.ajax({url:"//docs.qq.com/cgi-bin/online_docs/ai_autocolumn",type:"POST",timeout:8e3,xhrFields:{withCredentials:!0},data:{type:"textanalysis.autocolumn",data:(0,a.default)({function:"right_click_split",docID:h.location.pathname.replace(/^.*\/([^\/]+)$/,"$1"),rowLen:t.endRowIndex-t.startRowIndex+1,colLen:t.endColIndex-t.startColIndex+1,table:i}),xsrf:v.getXsrf()},success:function(e){var t={},a={},i=[];if(t=(0,u.safeStringToObj)(e,t),a=(0,u.safeStringToObj)(t.ssodata,a),i=(0,u.safeStringToObj)(a.result,i),0!==t.cgicode||0!==t.retcode||!a||0!==a.code)return o=!0,void r();Array.isArray(i)&&i.length>0&&(o=!0,n(i))},complete:function(){o||r()}})}(e,t,function(a){if(!p){g=!1;var r=a[0],u=r.startRow,d=r.endRow,h=r.startCol,v=r.endCol,y=[u,d,h,v].every(function(e){return"number"===typeof e});if(y){var C=t.startRowIndex,S=t.startColIndex,b=new o.default.Range.GridRange(t.sheetId,C+u,C+d,S+h,S+v);if(function(e,t){for(var n=t.startRowIndex,a=t.endRowIndex,r=t.startColIndex,i=t.endColIndex,o=n;o<=a;o++)for(var l=r;l<=i;l++)if(s.default.cell.getCellDataDVAtPosition(e,o,l))return!0;return!1}(e,b))return(0,c.showSplitFailDialog)(e),void l.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"split_fail"});var w=(0,f.genChanges)(a,["startRow","endRow","startCol","endCol"]),R=(0,i.default)(w,3),x=(R[0],R[1]),E=R[2];x<1||E<1?T():n(b,w),m&&(m.close(),m=null)}else T()}},T)}(e,n,function(t,a){var u=(0,i.default)(a,4),c=(u[0],u[1]),d=u[2];if(u[3],c>0&&d>0){var p=(0,f.changesToPasteData)(a),h=function(e,t,n){for(var a=[],r=0;r<t.length;r++){var i=t[r];if(i.amount>0){var l=i.index,s=i.index+i.amount-1,u=i.type,c=new o.default.Range.DimensionRange(n,l,s,u);a.push(c)}}return a}(0,function(e,t,n,a){var r=e.spreadsheet.activeSheet,i=r.getRowCount()-1,l=r.getColCount()-1,u=r.getBasicFilter(),c=u&&u.getHiddenRows()||[],d=t.startRowIndex,f=t.endRowIndex,p=t.startColIndex,h=t.endColIndex,v=d,g=p,m=0,y=0,T=[];if(n<1||a<1)return T;for(var C=0;C<n;C++){for(var S=d+C,b=!1,w=0;w<h-p+1;w++){var R=p+w;if(-1===c.indexOf(S)){if(S>i||R>l){v=S,m=n-C,b=!0;break}var x=s.default.cell.isRangeCellBlank(e,S,R);if(S<=f&&R<=h&&(x=!0),!x){v=S,m=n-C,b=!0;break}}}if(b)break}for(var E=a-1,I=0;I<E;I++){for(var _=p+1+I,A=!1,D=0;D<n;D++){var k=d+D;if(!(m>0&&k>=v)){if(k>i||_>l){g=_,y=E-I,A=!0;break}var M=s.default.cell.isRangeCellBlank(e,k,_);if(!M){g=_,y=E-I,A=!0;break}}}if(A)break}return m>0&&T.push({type:o.default.Dimension.DIMENSION_TYPE.ROWS,index:v,amount:m}),y>0&&T.push({type:o.default.Dimension.DIMENSION_TYPE.COLUMNS,index:g,amount:y}),T}(e,t,c,d),n.sheetId);h.length>0&&(p=(0,r.default)({infoDimension:{insertDimensionRanges:h}},p));var v={xRange:[t.startColIndex,t.endColIndex],yRange:[t.startRowIndex,t.endRowIndex]};e.plugins.copyPaste.doPaste({pasteData:p,selectAreaCellRange:v,cb:function(){},envs:{clearRangeContent:t}}),l.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"split_success"})}},function(){(0,c.showSplitFailDialog)(e),l.default.report.tdwReport({opername:"doc_excel_editor",module:"excel_manual_split",action:"split_fail"})})}}},1432:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(7),i=(a=r)&&a.__esModule?a:{default:a};var o=["[,\uff0c\u3001]","[;\uff1b]","[|]","[/]","[ \\t\\s]+","\\s*\\.\\s+|\\s+\\.\\s*"];t.default=function(e){for(var t=function(e){for(var t=i.default.window.SpreadsheetApp.view.canvas.excel.tableData.data,n=e.startRowIndex,a=e.endRowIndex,r=e.startColIndex,o=(e.endColIndex,""),l=n;l<=a;l++)o+=t[l][r].text||"",o+=l===a?"":"\n";return o=(o=o.replace(/\ufeff/g,"")).replace(/^\n+(.*)?\n+$/,"$1")}(e).split(/\r?\n/),n=t.length,a=[],r=0,l=0;l<o.length;l++){for(var s=0;s<n;s++){var u=t[s].trim().replace(/\ueffe/,"");if(""!==u){var c=new RegExp(o[l]),d=u.split(c);if(d.length<2){a=[],r=0;break}if(0!==r&&(0===r||r!==d.length)){a=[],r=0;break}r=d.length,a.push(d.map(function(e){return e.trim()}))}}if(r>0&&a.length>0)break}return[a,a.length,r,[]]}},1600:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=p(n(0)),r=p(n(1)),i=p(n(9)),o=p(n(7)),l=p(n(60)),s=(p(n(183)),n(313)),u=n(98),c=n(44),d=p(n(247)),f=p(n(8));function p(e){return e&&e.__esModule?e:{default:e}}var h='"SLOT"',v=((0,d.default)(function(){!function(){var e=o.default.window.SpreadsheetApp;e&&e.view.canvas.pluginsApi.subscript.reRender()}()},200),function(e,t,n){var a=e.results,r=null;if((0,i.default)(a).forEach(function(e){-1!==e.indexOf("dv")&&(r=e)}),null===r)return null;var o=a[r];if(o){var l=o&&o.value;return l=!0===l||"TRUE"===l}return o}),g=!0,m=function(){function e(t,n){var r=this;(0,a.default)(this,e),this.customTypeResultChange=function(e){var t=e.customType;e.datas,e.options;return/^dv$/.test(t),null},this.customTypeFormulaModelChange=function(e){e.customType,e.datas,e.options;return null},this.batchSendResult=function(){for(;r.resultList.length>=1e3||0!=r.resultList.length;){var e=Math.min(1e3,r.resultList.length);r.controllerApi.onBatchUpdateCellDataDataValidationResult(r.resultList.slice(0,e)),r.resultList=r.resultList.slice(e,r.resultList.length)}},this.batchSendDV=function(){for(;r.dvList.length>=1e3||0!=r.dvList.length;){var e=Math.min(1e3,r.dvList.length);r.controllerApi.onBatchUpdateDataValidation(r.dvList.slice(0,e)),r.dvList=r.dvList.slice(e,r.dvList.length)}},this.generateFormula=function(e,t,n){if(null===e)return null;var a=(0,s.transformDV2Formula)(e);return null===a?null:a=(0,u.replaceAll)(a,"$SLOT",(0,c.toCellId)(t,n))},this.addToFMap=function(e){var t=e.formula,n=e.row,a=e.col,i=e.sheetId,o=l.default.string2FormulaModel(t,n,a,i);r.formulaGraph.addCustomFormulaNodeAndGenerateDependency({formulaModel:o,row:n,col:a,sheetId:i,customType:"dv"}),g&&(g=!1,f.default.tdwReport({opername:"doc_edit",module:"excel",action:"data_validation_open"}))},this.addUnCommits=function(e){r.uncommits.push(e)},this.addDVNode=function(e,t,n,a){var i=r.generateFormula(e,t,n);if(null===i)return null;var o={row:t,col:n,formula:i,sheetId:a};r.addToFMap(o),r.addUserValueToFMap(e,t,n,a)},this.addUserValueToFMap=function(e,t,n,a){var i=e&&e.argTokens;if(null==i||i&&0==i.length)return null;if(0===i.filter(function(e){return(0,c.isFormula)(e.userEnteredValue)}).length)return null;var o="";i.map(function(e,t){var n=e.userEnteredValue;return n=(0,c.isFormula)(n)?(0,u.moveEqualChar)(n):h,o+=0==t?"="+n:"&"+n,null});var s=l.default.string2FormulaModel(o,t,n,a);r.formulaGraph.addCustomFormulaNodeAndGenerateDependency({formulaModel:s,row:t,col:n,sheetId:a,customType:"dvuser"})},this.addDVToFMap=function(e,t){(0,u.iterateGridRange)(t,function(t,n,a){r.addDVNode(e,t,n,a)})},this.deleteDVToFMap=function(e){var t=r;(0,u.iterateGridRange)(e,function(e,n,a){t.formulaGraph.removeCustomFormulaNode({row:e,col:n,sheetId:a,customType:"dv"})})},this.updateDirtyRange=function(e,t){var n=r;if(!e)return null;(0,u.iterateGridRange)(e,function(e,a,r){var i=n.formulaGraph.getItemsAccordingToCustomTypeAndPosition([{customTypes:["dv"],row:e,col:a,sheetId:r}]),o=i&&v(i[0],"dv",r);return null===o?n.clearDataValidationResult(e,a,r,t):n.setDataValidationResult(o,e,a,r,t)})},this.setDataValidationResult=function(e,t,n,a,i){r.controllerApi.onUpdateCellDataDataValidationResult(a,t,n,e,i)},this.clearDataValidationResult=function(e,t,n,a){r.controllerApi.onUpdateCellDataDataValidationResult(n,e,t,null,a)},this.getDataValidation=function(e,t,n){var a=r.controllerApi.getCellData(e,t,n),i=a&&a.getUserEnteredFormat(),o=i&&i.getDataValidation();return o||null},this.controllerApi=n,this.formulaGraph=n.formulaGraph,this.parent=t,this.uncommits=[],this.subscribe(),this.resultList=[],this.dvList=[]}return(0,r.default)(e,[{key:"subscribe",value:function(){o.default.event.formula.listen("customTypeFormulaModelChange",this.customTypeFormulaModelChange),o.default.event.formula.listen("customTypeResultChange",this.customTypeResultChange)}}]),e}(),y=function(){function e(t){(0,a.default)(this,e),this.formulaHandler=new m(this,t)}return(0,r.default)(e,[{key:"add",value:function(e,t){return null}},{key:"delete",value:function(e){return null}},{key:"clearDirtyRange",value:function(e){this.formulaHandler.updateDirtyRange(e)}},{key:"updateDirtyRange",value:function(e){return null}}]),e}();t.default=y},1601:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=y(n(0)),r=y(n(1)),i=y(n(9)),o=y(n(7)),l=y(n(60)),s=y(n(11)),u=y(n(247)),c=n(1602),d=y(n(96)),f=n(750),p=y(n(384)),h=y(n(383)),v=y(n(278)),g=y(n(382)),m=n(440);function y(e){return e&&e.__esModule?e:{default:e}}(0,u.default)(function(){!function(){var e=o.default.window.SpreadsheetApp;e&&e.view.canvas.pluginsApi.subscript.reRender()}()},200);var T=function(e){return"cond"+(e=E(e))},C=function(e,t){return"cond"+(e=E(e))+"value"+t},S=function(e,t){return"cond"+(e=E(e))+"range"+t},b=function(e){var t=e.match(/cond\w{20}/gi);return t?t[0].replace("cond",""):null},w=function(e){var t=e.match(/cond\w{20}/gi),n=e.match(/range\d+/gi);return t&&n?{ruleId:t[0].replace("cond",""),rangeIndex:parseInt(n[0].replace("range",""))}:null},R=function(e){return/cond\w{20}$/gi.test(e)},x=function(e){return/cond\w{20}range\d+$/gi.test(e)},E=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return(e+="").replace(/\-/gi,"")},I=function(e){if(null===e)return null;var t=e.booleanConditionalFormat;e.gradientConditionalFormat;if(null===t)return null;var n=t.condition;return void 0===n?null:n},_=function(e){var t=I(e);if(null===t)return null;var n=t.values,a=void 0===n?[]:n;return 0===a.length?null:a},A=function(e,t,n,a){var r=I(e);if(null===r)return null;var i=(0,c.transformConditionFromula)(r,{sheetId:t,userValueRelativeRow:n,userValueRelativeCol:a});if(null===i)return null;var o=l.default.string2FormulaModel(i,0,0,t);return o||null},D=function(e,t){return e.filter(function(e){return e.rule.ruleRanges.some(function(e){return e.isCross(e)})})},k=function(e){var t=function(e){if(e){var t=e.booleanConditionalFormat;return e.gradientConditionalFormat,null===t?null:t}return null}(e);return t?t.format:null},M=function(e,t,n){var a=e.results,r=null;if((0,i.default)(a).forEach(function(e){-1!==e.indexOf(T(t))&&(r=e)}),null===r)return null;var o=a[r];if(o){var l=o&&o.value;return l=!0===l||"TRUE"===l}return!1},O=function(e,t,n,a){var r=t.ruleRanges,i=t&&t.booleanConditionalFormat,o=i&&i.condition,l=o&&o.values;if(null===l||null===t||null===o||null==i||null===o)return null;var s=n.toString(0,0);r=r.map(function(t,n){return n===e?(0,m.absoluteHex2Range)(s,a):t.clone()});var u=l.map(function(e,t){return new p.default({type:e.type,userEnteredValue:e.userEnteredValue})});return new d.default({ruleRanges:r,booleanConditionalFormat:new g.default({condition:new h.default({type:o.type,values:u}),format:i.format.clone()}),uid:t.uid})},L=function(){function e(t,n){var r=this;(0,a.default)(this,e),this.customTypeFormulaModelChange=function(e){var t=e.customType,n=e.datas,a=(e.options,n[0].sheetId);if(x(t)){var i=w(t);if(null===i)return null;var o=i.ruleId,l=i.rangeIndex,s=r.getConditionFormatById(o,n[0].sheetId),u=s&&s.index,c=n[0].formulaModel,d=s&&s.rule,f=O(l,d,c,a);r.controllerApi.onUpdateConditionalFormat(a,u,f,d.ruleRanges)}},this.customTypeResultChange=function(e){var t=e.customType,n=e.datas,a=e.options,i=b(t);if(null===i)return null;if(R(t)){if(!r.getConditionFormatById(i,n[0].sheetId))return null;n.map(function(e,t){var i=e.row,o=e.col,l=e.sheetId,s=t===n.length-1;r.updateRowCol(i,o,l,a,s)}),r.batchSend()}},this.addCondToFMap=function(e,t){var n=I(t),a=t.ruleRanges[0],i=A(t,a.sheetId,a.startRowIndex,a.startColIndex),o=r.getConditionFormatByIndex(e,a.sheetId).id;if(null===i||null===n||null===t||!o)return null;t.ruleRanges.map(function(e){(0,f.iterateGridRange)(e,function(e,t,n){var a=T(o);r.formulaGraph.addCustomFormulaNodeAndGenerateDependency({formulaModel:i,row:e,col:t,sheetId:n,customType:a,handleByPositionCenter:!0})})})},this.addRuleRangeToFmap=function(e,t,n){var a=n.ruleRanges[0],i=a.sheetId;n.ruleRanges.map(function(e,n){var o="="+(0,m.range2AbsoluteHex)(e),s=l.default.string2FormulaModel(o,0,0,i);r.formulaGraph.addCustomFormulaNodeAndGenerateDependency({formulaModel:s,row:a.startRowIndex,col:a.startColIndex,sheetId:a.sheetId,customType:S(t,n),handleByPositionCenter:!0})})},this.addCondUserFormulaToFmap=function(e,t,n){var a=n.ruleRanges[0],i=_(n);if(null===i)return null;i.map(function(e,n){if(e.type===v.default.FORMULA_TOKEN&&e.formula){var i=e.formula;r.formulaGraph.addCustomFormulaNodeAndGenerateDependency({formulaModel:i,row:a.startRowIndex,col:a.startColIndex,sheetId:a.sheetId,customType:C(t,n),handleByPositionCenter:!0})}})},this.deleteCondFromFMap=function(e,t){var n=r.getRuleIdFromCache(e);if(!n)return null;r.formulaGraph.removeCustomFormulaNodeByType(T(n))},this.setFormat=function(e,t,n,a,i){i||(i={mutationQueueIdRelatedSheetId:a}),r.cacheList.push({sheetId:a,row:t,col:n,conditionalFormatResult:k(e.rule),options:i})},this.clearFormat=function(e,t,n,a){a||(a={mutationQueueIdRelatedSheetId:n}),r.cacheList.push({sheetId:n,row:e,col:t,conditionalFormatResult:null,options:a})},this.batchSend=function(){for(;r.cacheList.length>=1e3||0!=r.cacheList.length;){var e=Math.min(1e3,r.cacheList.length);r.controllerApi.onBatchUpdateCellDataConditionalFormatResult(r.cacheList.slice(0,e)),r.cacheList=r.cacheList.slice(e,r.cacheList.length)}},this.updateRowCol=function(e,t,n,a,i){var o=r,l=r.getConditionalFormatRuleAll(n),u=D(l,new s.default(n,e,e,t,t));o.retriveDataAndCalc(u,e,t,n,a)},this.clearDirtyRange=function(e){if(!e||0===e.length)return null;e.map(function(e){(0,f.iterateGridRange)(e,function(e,t,n){r.clearFormat(e,t,n)})})},this.updateDirtyRange=function(e,t){var n=r;if(!e||0===e.length)return null;var a=e[0].sheetId,i=r.getConditionalFormatRuleAll(a);e.map(function(e){(0,f.iterateGridRange)(e,function(e,a,r){var o=D(i,new s.default(r,e,e,a,a));n.retriveDataAndCalc(o,e,a,r,t)})}),r.batchSend()},this.getConditionFormatByIndex=function(e,t){return r.getConditionalFormatRuleAll(t).filter(function(t){if(t.index===e)return t})[0]},this.getConditionFormatById=function(e,t){return r.getConditionalFormatRuleAll(t).filter(function(t){if(E(t.id)===e)return t})[0]},this.retriveDataAndCalc=function(e,t,n,a,i,o){var l=e.map(function(e){return{id:E(e.id),index:e.index}}).reverse(),s=r.getSmallEffectiveRuleResult(l,t,n,a);null===s?r.clearFormat(t,n,a,i):r.setFormat(e[s],t,n,a,i)},this.getSmallEffectiveRuleResult=function(e,t,n,a){if(0===e.length)return null;var i=e.pop();if(!i)return null;var o=E(i.id),l=T(o),s=r.formulaGraph.getItemsAccordingToCustomTypeAndPosition([{customTypes:[l],row:t,col:n,sheetId:a}]);return s&&M(s[0],o,a)?i.index:r.getSmallEffectiveRuleResult(e,t,n,a)},this.getSheetId=function(e){return e&&0!==e.length?e[0].sheetId:null},this.getRuleIdFromCache=function(e){var t=r.cache[e];return t||""},this.cacheRule=function(e){var t=r.getSheetId(e);if(null===t)return null;var n=r.getConditionalFormatRuleAll(t);n&&(r.cache=n.map(function(e){return E(e.id)}))},this.parent=t,this.controllerApi=n,this.formulaGraph=n.formulaGraph,this.getConditionalFormatRuleAll=n.getConditionalFormatRuleAll,this.cache=[],this.cacheList=[],this.subscribe()}return(0,r.default)(e,[{key:"subscribe",value:function(){o.default.event.formula.listen("customTypeFormulaModelChange",this.customTypeFormulaModelChange),o.default.event.formula.listen("customTypeResultChange",this.customTypeResultChange)}}]),e}(),N=function(){function e(t){(0,a.default)(this,e),this.formulaHandler=new L(this,t)}return(0,r.default)(e,[{key:"add",value:function(e,t){return null}},{key:"update",value:function(e,t,n){return null}},{key:"delete",value:function(e,t){return null}},{key:"clearDirtyRange",value:function(e){this.formulaHandler.updateDirtyRange(e)}},{key:"updateDirtyRange",value:function(e){return null}}]),e}();t.default=N},1602:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.transformConditionFromula=void 0;var a=i(n(315)),r=i(n(278));n(750);function i(e){return e&&e.__esModule?e:{default:e}}var o=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(!e)return null;if(!e[n])return null;var a=e[n];switch(a.type){case r.default.FORMULA_TOKEN:if(null!=a.formula){var i=t.userValueRelativeRow,o=t.userValueRelativeCol;return a.formula.toString(i,o)}case r.default.VALUE_TOKEN:case r.default.DATE_TOKEN:case r.default.UNPARSED_TOKEN:return a.userEnteredValue}return null};t.transformConditionFromula=function(e,t){if(null===e)return null;var n=e.type,r=void 0===n?null:n,i=e.values,l=void 0===i?null:i;return null===r?null:function(e){return null===e?null:e>=a.default.NUMBER_GREATER&&e<=a.default.NUMBER_NOT_BETWEEN}(r)?function(e,t,n){var r=null,i=o(t,n),l=o(t,n,1);switch(e){case a.default.NUMBER_GREATER:r="AND(OR(A1>"+i+',A1>ABS("'+i+'")), ISNUMBER(A1))';break;case a.default.NUMBER_GREATER_THAN_EQ:r="AND(OR(A1>="+i+',A1>=ABS("'+i+'")), ISNUMBER(A1))';break;case a.default.NUMBER_LESS:r="AND(OR(A1<"+i+',A1<ABS("'+i+'")), ISNUMBER(A1))';break;case a.default.NUMBER_LESS_THAN_EQ:r="AND(OR(A1<="+i+',A1<=ABS("'+i+'")), ISNUMBER(A1))';break;case a.default.NUMBER_EQ:r="OR(A1="+i+',A1=ABS("'+i+'"))';break;case a.default.NUMBER_NOT_EQ:r="OR(A1<>"+i+',A1<>ABS("'+i+'"))';break;case a.default.NUMBER_BETWEEN:r="AND(AND(OR(A1>="+i+',A1>=ABS("'+i+'")),OR(A1<='+l+',A1<=ABS("'+l+'"))),ISNUMBER(A1))';break;case a.default.NUMBER_NOT_BETWEEN:r="AND(NOT(AND(OR(A1>="+i+',A1>=ABS("'+i+'")),OR(A1<='+l+',A1<=ABS("'+l+'")))),ISNUMBER(A1))'}return"="+r}(r,l,t):function(e){return null===e?null:e<=a.default.TEXT_IS_URL&&e>=a.default.TEXT_CONTAINS||e===a.default.NOT_BLANK||e===a.default.BLANK}(r)?function(e,t,n){var r=null,i=o(t,n);switch(e){case a.default.TEXT_CONTAINS:r="NOT(ISERROR(FIND("+i+",A1)))";break;case a.default.TEXT_NOT_CONTAINS:r="ISERROR(FIND("+i+",A1))";break;case a.default.TEXT_STARTS_WITH:r="RIGHT((A1),LEN("+i+"))=("+i+")";break;case a.default.TEXT_ENDS_WITH:r="LEFT((A1),LEN("+i+"))=("+i+")";break;case a.default.TEXT_EQ:r="AND(NOT(ISERROR(FIND("+i+",A1))),LEN(A1)=LEN("+i+"))";break;case a.default.BLANK:r="LEN(TRIM(A1))=0";break;case a.default.NOT_BLANK:r="LEN(TRIM(A1))>0";break;case a.default.TEXT_IS_EMAIL:case a.default.TEXT_IS_URL:}return"="+r}(r,l,t):function(e){return null===e?null:e>=a.default.DATE_DURING&&e<=a.default.DATE_IS_VALID}(r)?function(e,t,n){var r=null,i=o(t,n),l=o(t,n,1);switch(e){case a.default.DATE_DURING:case a.default.DATE_BETWEEN:r="AND(IF(A1>="+i+",1,0),IF(A1<="+l+",1,0))";break;case a.default.DATE_NOT_BETWEEN:r="OR(IF(A1<"+i+",1,0),IF(A1>"+l+",1,0))";break;case a.default.DATE_EQ:r="IF(A1="+i+",TRUE,FALSE)";break;case a.default.DATE_BEFORE:r="IF(A1<"+i+",TRUE,FALSE)";break;case a.default.DATE_ON_OR_BEFORE:r="IF(A1<="+i+",TRUE,FALSE)";break;case a.default.DATE_AFTER:r="IF(A1>"+i+",TRUE,FALSE)";break;case a.default.DATE_ON_OR_AFTER:r="IF(A1>="+i+",TRUE,FALSE)";break;case a.default.DATE_IS_VALID:r="IF(ISDATE(A1),TRUE,FALSE)"}return"="+r}(r,l,t):function(e,t,n){var r=null;switch(e){case a.default.BLANK:r="LEN(TRIM(A1))=0";break;case a.default.NOT_BLANK:r="LEN(TRIM(A1))>0";break;case a.default.ERROR:r="IFERROR(E13, TRUE)=TRUE";break;case a.default.NOT_ERROR:r="IFERROR(E13, TRUE)<>TRUE";break;case a.default.ONE_OF_LIST:case a.default.ONE_OF_RANGE:case a.default.CUSTOM_FORMULA:case a.default.BOOLEAN:return""}return"="+r}(r)}},1632:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=l(n(114)),r=l(n(0)),i=l(n(1)),o=l(n(47));function l(e){return e&&e.__esModule?e:{default:e}}var s=function(e,t,n,a){return new(n||(n=o.default))(function(r,i){function o(e){try{s(a.next(e))}catch(t){i(t)}}function l(e){try{s(a.throw(e))}catch(t){i(t)}}function s(e){e.done?r(e.value):new n(function(t){t(e.value)}).then(o,l)}s((a=a.apply(e,t||[])).next())})},u=function(){function e(t){(0,r.default)(this,e),this.app=t,this.init(),this.sort=null}return(0,i.default)(e,[{key:"init",value:function(){}},{key:"initSort",value:function(){return s(this,void 0,void 0,a.default.mark(function e(){var t,r,i;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e("bundle_sort").then(n.t.bind(null,1662,7));case 2:return t=e.sent,r=t.default,i=t.InsertDimensionRequest,console.log(i),this.sort=new r(this.app),e.abrupt("return",this.sort);case 8:case"end":return e.stop()}},e,this)}))}},{key:"getSort",value:function(){return s(this,void 0,void 0,a.default.mark(function e(){return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==this.sort){e.next=4;break}return e.next=3,this.initSort();case 3:return e.abrupt("return",e.sent);case 4:return e.abrupt("return",this.sort);case 5:case"end":return e.stop()}},e,this)}))}},{key:"getSmartSelection",value:function(){return s(this,void 0,void 0,a.default.mark(function e(){var t;return a.default.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.smartSelection){e.next=4;break}return e.abrupt("return",this.smartSelection);case 4:return e.next=6,n.e("bundle_smart_selection").then(n.t.bind(null,1654,7));case 6:return t=e.sent,this.smartSelection=t.default,e.abrupt("return",this.smartSelection);case 9:case"end":return e.stop()}},e,this)}))}}]),e}();t.default=u},1633:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(14));t.genenerateInfoDimensionHandleCutDimension=l,t.handleCutDimension=function(e){var t=e.currentSelect,n=e.pasteData,r=e.cutDataSheetId,i=e.activeSheetId,o=e.dimensionType,s=e.cacheState,u=e.isSingle,c=s.from,d=l({currentSelect:t,cutDataSheetId:r,activeSheetId:i,dimensionType:o,cacheStateFrom:c,isSingle:u}),f=d.infoDimension,p=d.range,h=(0,a.default)({},n);return h.infoDimension=f,{pasteData:h,range:p}},t.genenerateInfoDimensionHandleCopyDimension=s,t.handleCopyDimension=function(e){var t=e.currentSelect,n=e.pasteData,r=e.activeSheetId,i=e.dimensionType,o=e.cacheState.from,l=s({currentSelect:t,activeSheetId:r,dimensionType:i,cacheStateFrom:o}),u=l.infoDimension,c=l.range,d=(0,a.default)({},n);return d.infoDimension=u,{pasteData:d,range:c}};var r=o(n(35)),i=o(n(15));function o(e){return e&&e.__esModule?e:{default:e}}function l(e){var t=e.currentSelect,n=e.cutDataSheetId,a=e.activeSheetId,o=e.dimensionType,l=e.cacheStateFrom,s=e.isSingle,u=(o==i.default.ROWS?t.yRange:t.xRange)[0],c=[],d=o==i.default.ROWS?l.yRange:l.xRange,f=d[0],p=d[1],h=p-f+1,v=p-f+u;s||(n==a&&u>p&&(u-=h,v-=h),c=[new r.default(n,d[0],d[1],o)]);var g={deleteDimensionRanges:c,insertDimensionRanges:[new r.default(a,u,v,o)]},m=o==i.default.ROWS?l.xRange:l.yRange;return{infoDimension:g,range:{xRange:o==i.default.ROWS?m:[u,v],yRange:o==i.default.ROWS?[u,v]:m}}}function s(e){var t=e.currentSelect,n=e.activeSheetId,a=e.dimensionType,o=e.cacheStateFrom,l=(a==i.default.ROWS?t.yRange:t.xRange)[0],s=a==i.default.ROWS?o.yRange:o.xRange,u=s[0],c=s[1]-u+l,d={insertDimensionRanges:[new r.default(n,l,c,a)]},f=a==i.default.ROWS?o.xRange:o.yRange;return{infoDimension:d,range:{xRange:a==i.default.ROWS?f:[l,c],yRange:a==i.default.ROWS?[l,c]:f}}}},239:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.doSmartSplitMobile=t.showToastSPMobile=t.setCacheResult=t.getCacheResult=t.doSmartSplit=t.needCheckSmartSplit=t.getResultSP=t.hideToastSP=t.showToastSP=void 0;var a=v(n(24)),r=v(n(41)),i=v(n(9)),o=v(n(16)),l=v(n(406)),s=v(n(12)),u=v(n(7)),c=n(71),d=v(n(8)),f=n(690),p=v(n(40)),h=n(82);function v(e){return e&&e.__esModule?e:{default:e}}var g=u.default.window,m=g.$,y=null;function T(e,t,n,a){e.addEventListener?e.addEventListener(t,n,a):e.attachEvent&&e.attachEvent("on"+t,function(){n(g.event)})}function C(e,t,n,a){e.removeEventListener?e.removeEventListener(t,n,a):e.detachEvent&&e.detachEvent("on"+t,function(){n(g.event)})}function S(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};function t(){b(),C(document,"tap",n,!1),C(document,"click",n,!1),C(document,"input",t,!1)}function n(e){e.target.classList.contains("table-input-content")||t()}s.default.wait(0).run(function(){g.scrollTo(0,0)}),b(),(0,c.showToast)("\u4f60\u53ef\u80fd\u5e0c\u671b\u5bf9\u6570\u636e\u8fdb\u884c\u81ea\u52a8\u6574\u7406\u3002",void 0,{isNeedBtn:!0,btnText:"\u8bd5\u8bd5\u667a\u80fd\u5206\u5217",supportMobile:!0,btnCallBack:function(){t(),e(),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}}),T(document,"tap",n,!1),T(document,"click",n,!1),s.default.wait(0).run(function(){T(document,"input",t,!1)}),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"trigger_toast"})}function b(){"\u8bd5\u8bd5\u667a\u80fd\u5206\u5217"===m("#toolToastBtn").text().trim()&&(0,c.hideToast)()}function w(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};y=null,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){};m.ajax({url:"//docs.qq.com/cgi-bin/online_docs/ai_autocolumn",type:"POST",xhrFields:{withCredentials:!0},data:{type:"textanalysis.autocolumn",data:(0,o.default)({text:e,docID:g.location.pathname.replace(/^.*\/([^\/]+)$/,"$1")}),xsrf:m.getXsrf()},success:function(e){var n={},a={},r=[];n=(0,f.safeStringToObj)(e,n),a=(0,f.safeStringToObj)(n.ssodata,a),r=(0,f.safeStringToObj)(a.result,r),0===n.cgicode&&0===n.retcode&&a&&0===a.code&&Array.isArray(r)&&r.length>0&&t(r)}}),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"total_trigger"})}(e,function(e){y=e,t(e)})}function R(e,t){e=e||y;var n=(0,l.default)(e);t.plugins.copyPaste.doPaste({pasteData:n,cb:function(){}}),g.isMobile&&s.default.wait(0).run(function(){g.scrollTo(0,0)})}t.showToastSP=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){};arguments[1],n();var t={isNeedBtn:!0,toolToastCloseTime:5e3,btnText:"\u8bd5\u8bd5\u667a\u80fd\u5206\u5217",btnCallBack:function(){n(),e(),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"clk_toast"})}};function n(){b(),p.default.view.remove(h.EVENT_NAME.SELECTION_CHANGE,n)}(0,c.showToast)("\u4f60\u53ef\u80fd\u5e0c\u671b\u5bf9\u6570\u636e\u8fdb\u884c\u81ea\u52a8\u6574\u7406\u3002    ".replace(/ /g,"\xa0"),{top:"182px"},t),p.default.view.listen(h.EVENT_NAME.SELECTION_CHANGE,n)},t.hideToastSP=b,t.getResultSP=w,t.needCheckSmartSplit=function(e,t){if(!g.CoreSheet.configurations||!g.CoreSheet.configurations.aiAutoColumnEnable)return!1;if(!e)return!1;var n=e.spreadsheet.activeSheet,o=n.getRowCount()||0,l=n.getColCount()||0;if("number"!==typeof o||"number"!==typeof l||o<1||l<1)return!1;if(o>500)return!1;var s=n.images;if(s&&(0,i.default)(s).length>0)return!1;var u=n.data.rowData,c=function(e){for(var n=(0,r.default)(e,4),a=n[0],i=n[1],o=n[2],l=n[3],s=a;s<=i;s++)if(u[s])for(var c=u[s].values,d=o;d<=l;d++){var f=c[d];if(t){if(f)return!1}else if(f&&f.effectiveValue&&f.effectiveValue.value&&""!==f.effectiveValue.value.toString())return!1}return!0},d=function(e,t,n){return void 0===t?[0,e-1]:void 0===n?[t,t>e-1?-1:e-1]:t>e-1?[t,-1]:[t,n>e-1?e-1:n]},f=[].concat((0,a.default)(d(o,0,25)),(0,a.default)(d(l,0,8))),p=[].concat((0,a.default)(d(o,0,25)),(0,a.default)(d(l,9,16))),h=[].concat((0,a.default)(d(o,26,50)),(0,a.default)(d(l,0,16))),v=[].concat((0,a.default)(d(o,0,50)),(0,a.default)(d(l,17))),m=[].concat((0,a.default)(d(o,51)),(0,a.default)(d(l,0)));return!!(c(f)&&c(p)&&c(h)&&c(v)&&c(m))},t.doSmartSplit=R,t.getCacheResult=function(){return y},t.setCacheResult=function(e){y=e},t.showToastSPMobile=S,t.doSmartSplitMobile=function(e,t,n){w(e,function(e){S(function(){var n=t.spreadsheet.getActiveSheetId();t.behavior.applyUndo(n,function(){R(e,t)},function(){})}),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"active_trigger"}),n&&d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"new_sheet_trigger"})})}},240:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.KEEPDEFAULT="keepDefault",t.MERGESTYLES="mergeStyles",t.ONLYVALUES="onlyValues",t.TRANSPOSE="transpose",t.SMARTSPLIT="smartSplit"},288:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.convertShapeData2EmbeddedObjectProperties=function(e,t){var n=e.id,a=e.size,r=a.width,i=a.height,o=e.offset,l=o.x,s=o.y,u=e.url,c=e.clipInfo,d=0,f=0,p=e.anchor;if(p){var h=p.col,v=p.row;d=h,f=v}else d=0,f=0;return{type:"IMAGE",id:n,url:u,width:r,height:i,sheetId:t,x:d,y:f,offsetX:l,offsetY:s,zIndex:0,clipInfo:c}},t.convertShapeData2IAddImage=function(e,t){var n=e.id,a=e.size,r=a.width,i=a.height,o=e.url,l=e.clipInfo,s=0,u=0,c=e.anchor;if(c){var d=c.col,f=c.row;s=d,u=f}else s=0,u=0;return{id:n,sheetId:t,url:o,width:r,height:i,x:s,y:u,clipInfo:l}},t.convertEmbeddedImage2IAddImage=function(e){var t=e.id,n=e.position.overlayPosition,a=n.offsetXpixels,r=n.offsetYpixels,i=n.widthPixels,o=n.heightPixels,l=e.sheetId,s=e.url,u=e.clipInfo;return{id:t,sheetId:l,url:s,width:i,height:o,x:a,y:r,clipInfo:u}},t.convertEmbeddedImage2ShapeData=function(e){var t=e.id,n=e.position.overlayPosition,a=n.offsetXpixels,r=n.offsetYpixels,i=n.widthPixels,o=n.heightPixels,l=e.url,s=e.clipInfo,u=s.clipBottom,c=s.clipLeft,d=s.clipRight,f=s.clipTop;return{id:t,url:l,offset:{x:a,y:r},size:{width:i,height:o},clipInfo:{clipBottom:u,clipLeft:c,clipRight:d,clipTop:f}}}},289:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=c(n(0)),r=c(n(1)),i=c(n(47)),o=c(n(7)),l=n(22),s=c(n(12)),u=n(124);function c(e){return e&&e.__esModule?e:{default:e}}var d=new(function(){function e(){(0,a.default)(this,e),this.serverCopyData={plain:"",timeStamp:0},this.visibilityState=document.visibilityState||"visible"}return(0,r.default)(e,[{key:"init",value:function(){this.getCopyDataFromServer(),document.addEventListener("visibilitychange",this.onVisibilitychange.bind(this))}},{key:"copyToSystem",value:function(e){var t=document.createElement("textarea");t.readOnly=!0,t.style.zIndex="0",t.style.opacity="0",t.style.top="-9999px",t.style.left="-9999px",t.style.position="fixed",document.body.appendChild(t),t.value=e;var n=document.createRange();n.selectNode(t),window.getSelection().addRange(n),t.select(),document.execCommand("SelectAll"),document.execCommand("copy"),document.body.removeChild(t)}},{key:"isCopyOutEnv",value:function(){return(l.isMobile||l.isPad)&&this.isSupportExecCommand()&&(l.isWxBrowser||l.isWxMiniProgram)}},{key:"isCopyInEnv",value:function(){return l.isWxMiniProgram}},{key:"isCopyDataAvailable",value:function(){return!!this.serverCopyData.plain}},{key:"getServerCopyData",value:function(){return this.serverCopyData}},{key:"isSupportExecCommand",value:function(){return document.queryCommandSupported&&document.queryCommandSupported("copy")&&document.queryCommandSupported("SelectAll")}},{key:"getCopyDataFromServer",value:function(){var e=this;new i.default(function(e,t){o.default.window.$.ajax({url:"//docs.qq.com/sdc/datadown",type:"POST",xhrFields:{withCredentials:!0},data:{key:"weixin_copypaste_hack_key",xsrf:(0,u.getXsrf)()},success:function(t){e(t)},error:function(e){t(e)}})}).then(function(t){var n=t.retcode,a=t.result;0===n&&a&&"string"===typeof a.data?e.saveServerData(a.data):e.saveServerData("")}).catch(function(t){e.saveServerData("")})}},{key:"onVisibilitychange",value:function(){var e=this,t=document.visibilityState;"hidden"===this.visibilityState&&"visible"===t&&(s.default.wait(1500).run(function(){e.getCopyDataFromServer()}),s.default.wait(3500).run(function(){e.getCopyDataFromServer()})),this.visibilityState=t}},{key:"saveServerData",value:function(e){var t="",n=0,a=/^(wxcp):\d{13}:/;if(e&&a.test(e)){var r=e.match(a),i=r&&r[0];t=i&&e.split(i)[1]||"",n=+(i&&i.substr(5,13)||0)}this.serverCopyData={plain:t,timeStamp:n}}}]),e}());t.default=d},313:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.idCardRule=t.listRule=t.textLengthRule=t.dateRule=t.floatRule=t.intRule=t.numberRule=t.textContainsRule=t.transformDV2Formula=void 0;var a,r=n(157),i=(a=r)&&a.__esModule?a:{default:a},o=n(57),l=n(98),s=n(44);t.transformDV2Formula=function(e){switch(e.ruleType){case i.default.NUMBER_FLOAT_AND_INT:return c(e);case i.default.CUSTOM_MUST_FLOAT:return f(e);case i.default.NUMBER_INT:return d(e);case i.default.LIST:return g(e);case i.default.DATE:return p(e);case i.default.TEXT_LENGTH:return h(e);case i.default.CUSTOM_TEXT_CONTAINS:return u(e);case i.default.CUSTOM_ID_CARD:return m(e);default:return null}};var u=t.textContainsRule=function(e){var t=e.operator,n=e.argTokens;if((0,l.checkTextConatiansOperatorFailed)(t)||null==n)return null;var a="",r=(0,l.wrapValue)(n[0].userEnteredValue,e);switch(t){case"contains":a="NOT(ISERROR(FIND("+r+",$SLOT)))";break;case"notContains":a="ISERROR(FIND("+r+",$SLOT))";break;case"equal":a="AND(NOT(ISERROR(FIND("+r+",$SLOT))),LEN($SLOT)=LEN("+r+"))"}return a},c=t.numberRule=function(e,t){var n=e.operator,a=e.argTokens;if((0,l.checkDVOperatorFailed)(n)||null==a)return null;var r="",i=t||"$SLOT",o=(0,l.wrapValue)((0,l.getRealValue)(a[0].userEnteredValue),e),s=(0,l.wrapValue)((0,l.getRealValue)(a[1]&&a[1].userEnteredValue),e)||null;switch(n){case"between":r="AND("+i+">="+o+","+i+"<="+s+")";break;case"notBetween":r="NOT(AND("+i+">="+o+","+i+"<="+s+"))";break;case"equal":r=i+"="+o;break;case"notEqual":r=i+"<>"+o;break;case"lessThan":r=i+"<"+o;break;case"lessThanOrEqual":r=i+"<="+o;break;case"greaterThan":r=o+"<"+i;break;case"greaterThanOrEqual":r=i+">="+o}return r},d=t.intRule=function(e){return"AND("+c(e)+",MOD($SLOT,1)=0)"},f=t.floatRule=function(e){return"AND("+c(e)+",MOD($SLOT,1)<>0)"},p=t.dateRule=function(e){var t=e.operator,n=e.argTokens;if((0,l.checkDVOperatorFailed)(t)||null==n)return null;var a="",r="$SLOT",i=(0,l.wrapValue)((0,l.getRealValue)(n[0].userEnteredValue),e),o=(0,l.wrapValue)((0,l.getRealValue)(n[1]&&n[1].userEnteredValue),e)||null;switch(t){case"between":a="AND(IF($SLOT>="+i+",1,0),IF("+r+"<="+o+",1,0))";break;case"notBetween":a="OR(IF($SLOT<"+i+",1,0),IF("+r+">"+o+",1,0))";break;case"equal":a="IF($SLOT="+i+',"TRUE","FALSE")';break;case"notEqual":a="IF($SLOT<>"+i+',"TRUE","FALSE")';break;case"lessThan":a="IF($SLOT<"+i+',"TRUE","FALSE")';break;case"lessThanOrEqual":a="IF($SLOT<="+i+',"TRUE","FALSE")';break;case"greaterThan":a="IF($SLOT>"+i+',"TRUE","FALSE")';break;case"greaterThanOrEqual":a="IF($SLOT>="+i+',"TRUE","FALSE")'}return a},h=t.textLengthRule=function(e){return c(e,"LEN($SLOT)")},v={},g=t.listRule=function(e){var t=e.argTokens;if(null==t)return null;var n=void 0;if((0,s.isFormula)(t[0].userEnteredValue))return n=t[0].userEnteredValue,"IF(COUNTIF("+(0,l.moveEqualChar)(n)+", $SLOT)>0,TRUE,FALSE)";var a=t[0].userEnteredValue;return v[a]?n=v[a]:(n=(0,l.autoSplit)(t[0].userEnteredValue).map(function(e){var t=(0,o.parseValueWithStyle)(e).value;return(0,o.isNumeric)(t)?"EXACT($SLOT,"+t+')+EXACT($SLOT,"'+e+'")':'EXACT($SLOT,"'+e+'")'}).join("+"),v[a]=n),"0+"+n+">0"},m=t.idCardRule=function(e){return"ISNUMBER(ID($SLOT,0))"}},405:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=A(n(25)),r=A(n(63)),i=A(n(0)),o=A(n(1)),l=A(n(14));t.imageRelativeToAbsolute=D;var s=n(1308),u=n(689),c=n(203),d=A(n(11)),f=n(112),p=A(n(35)),h=A(n(15)),v=n(51),g=A(n(54)),m=n(288),y=n(239),T=n(1309),C=A(n(52)),S=A(n(185)),b=n(33),w=n(68),R=A(n(60)),x=n(444),E=n(407),I=n(18),_=A(I);function A(e){return e&&e.__esModule?e:{default:e}}function D(e){var t=e.xIndex,n=e.yIndex;return e.shapeDatas.map(function(e){return(0,l.default)({},e,{anchor:{col:e.anchor?e.anchor.col+t:t,row:e.anchor?e.anchor.row+n:n}})})}var k=function(){function e(t){var n=t.spreadsheetApp,a=t.config;(0,i.default)(this,e),this.config=a,this.cacheData={isSingle:!1,isMerge:!1,merge:[[]],rowDataUpdate:[{values:[]}],fromType:w.FromType.COPY_CACHE,fromApp:w.fromAppType.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0},this.cacheState={copyHTMLType:w.CopyHTMLType.table,sheetId:"string",pasteType:w.CopyType.copy,valid:!1,select:{selectAll:!1,selectRow:!1,selectCol:!1},copyRangeIsChange:!1,from:{xRange:[0,0],yRange:[0,0]},clipboardCopyData:{html:"",plain:"",timeStamp:""}},this.spreadsheetApp=n}return(0,o.default)(e,[{key:"onCopy",value:function(e){var t=this,n=e.from,a=e.copyType,i=e.hotInstance,o=e.previewActiveSheetId;this.cacheData={isSingle:!1,isMerge:!1,merge:[[]],rowDataUpdate:[{values:[]}],fromType:w.FromType.COPY_CACHE,fromApp:w.fromAppType.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0};var l=o||i.spreadsheet.getActiveSheetId(),s=o&&i.preview.previewsheet.getSheetBySheetId(o),c=s||i.spreadsheet.activeSheet,f=c.data.rowData,g=c.data.rowMetadata,m=c.data.columnMetadata,y=n.xRange[0],C=n.yRange[0],S=n.xRange[1],b=n.yRange[1],R=void 0,x=void 0,I=void 0,_=void 0,A=void 0;this.cacheState.sheetId=l;var D=this,k=(0,v.convertXYRangeToSheetIdXYRange)(n,l),M=(0,v.convertSheetIdXYRange2GridRange)(k);(0,E.rangeIsMergeCell)(M,c.getCellDataAtPosition(M.startRowIndex,M.startColIndex))||M.isSingle()?(this.cacheData.isSingle=!0,(0,E.rangeIsMergeCell)(M,c.getCellDataAtPosition(M.startRowIndex,M.startColIndex))?this.cacheData.isMerge=!0:this.cacheData.isMerge=!1):(this.cacheData.isSingle=!1,this.cacheData.isMerge=!1),this.cacheData.rowDataUpdate=[],this.cacheData.merge=[],this.cacheData.formula=[];var O=[],L=[];this.cacheData.rowsDimensionProperties=O,this.cacheData.colsDimensionProperties=L;var N=c.getColCount(),F=c.getRowCount();S>N&&(S=N),b>F&&(b=F);var P=c.getBasicFilter(),B=P?P.filterHideRowMap:new r.default;for(x=C;x<=b;x++)if(!B.get(x))for(I={values:[]},_=[],A=[],[],this.cacheData.rowDataUpdate.push(I),this.cacheData.merge.push(_),this.cacheData.formula.push(A),R=y;R<=S;R++){var U=R,V=x,H=f[x]?f[V].values[U]:null,j=H?H.mergeReference:null;if(x%(b-C+1)==0&&L.push(m[U]),R%(S-y+1)==0&&O.push(g[V]),j){var Y=(j=j.clone()).startColIndex,q=j.startRowIndex,G=(0,u.calMergeCellXYUnitPosition)({mergeReference:j,filterHideRowMap:B,copyRange:M}),z=G.xUnit,X=G.yUnit,W=G.x,$=G.y;W===R&&$===x&&(z>1||X>1)?(j=new d.default("sheetid",$,$+X-1,W,W+z-1),H=f[V]?f[V].values[U]:null):j=null,U=Y,V=q}else j=null;_.push(!!j&&{w:j.getColCount(),h:j.getRowCount()}),H&&H.clone&&(H=H.clone()),I.values.push(H)}this.cacheState.valid=!0;var K=i.view?i.view.canvas.excel.selectData.select:{selectAll:!1,selectRow:!1,selectCol:!1},Q=K.selectAll,Z=K.selectRow,J=K.selectCol;this.cacheState={copyHTMLType:w.CopyHTMLType.table,from:n,pasteType:a,sheetId:l,valid:!0,select:{selectAll:Q,selectRow:Z,selectCol:J},copyRangeIsChange:!!o,clipboardCopyData:{html:"",plain:"",timeStamp:""}},this.cacheState.key&&this.cacheState.sheetId&&(c.positionCenter.remove(this.cacheState.key),this.cacheState.key=null),a===w.CopyType.cut&&(this.cacheState.key=c.positionCenter.add({config:{ignoreSetCell:!0},selfData:{xRange:new p.default(l,y,S,h.default.ROWS),yRange:new p.default(l,C,b,h.default.COLUMNS)},calc:function(e,a,r){var i=n.xRange[1]-n.xRange[0],o=n.yRange[1]-n.yRange[0];i===e.xDiff&&o===e.yDiff||(D.cacheState.valid=!1),console.warn("cut operation fail because of positionCenter: ",a),c.positionCenter.remove(t.cacheState.key)}})),this.cacheState.copyRangeListenKey&&this.cacheState.sheetId&&(c.positionCenter.remove(this.cacheState.copyRangeListenKey),this.cacheState.copyRangeListenKey=null),a===w.CopyType.copy&&(this.cacheState.copyRangeListenKey=c.positionCenter.add({config:{ignoreSetCell:!1},selfData:{xRange:new p.default(l,y,S,h.default.ROWS),yRange:new p.default(l,C,b,h.default.COLUMNS)},calc:function(e,n,a){D.cacheState.copyRangeIsChange=!0,c.positionCenter.remove(t.cacheState.copyRangeListenKey)}}));var ee=(0,T.getCopyValue)({spreadsheetApp:this.spreadsheetApp,copyType:a,range:n,previewActiveSheetId:o,select:{selectAll:Q,selectRow:Z,selectCol:J}});return this.cacheState.clipboardCopyData=ee,ee}},{key:"onPaste",value:function(e){var t=e.to,n=e.hotInstance,i=e.pasteData,o=(e.config,e.cb),T=(e.undoCb,e.envs),A=this.cacheState,k=n.spreadsheet.activeSheet,M=this.spreadsheetApp.spreadsheet.activeSheet.data,O=M.rowMetadata,L=M.columnMetadata,N=n.spreadsheet.getActiveSheetId(),F=!i||i.fromType===w.FromType.COPY_CACHE||i.fromType===w.FromType.TRANSPOSE;if(!(i=i||(this.cacheState.valid?this.cacheData:void 0))||!i.rowDataUpdate)return console.error("invalid pasteData"),!1;for(var P=k.getBasicFilter(),B=F&&A.pasteType===w.CopyType.cut,U=A.from,V=B?[U.xRange[0],U.yRange[0],U.xRange[1],U.yRange[1]]:[],H=(0,v.convertXYRangeToSheetIdXYRange)(U,N),j=(0,v.convertSheetIdXYRange2GridRange)(H),Y=(0,v.convertXYRangeToSheetIdXYRange)(t,N),q=(0,v.convertSheetIdXYRange2GridRange)(Y),G=i.containTable,z=i.merge,X=void 0,W=void 0,$=t.xRange[0],K=t.yRange[0],Q=t.xRange[1],Z=t.yRange[1],J=void 0,ee=void 0,te=void 0,ne=void 0,ae=void 0,re=void 0,ie=void 0,oe=i.rowDataUpdate[0].values.length,le=i.rowDataUpdate.length,se=Q-$+1,ue=1,ce=P?P.filterHideRowMap:new r.default,de=K;de<Z;de++)ce.get(de)||ue++;var fe=void 0,pe=void 0,he=void 0,ve={style:[]},ge=[],me=[],ye=[],Te=void 0,Ce=!1,Se=!1;i.isSingle&&(q.isSingle()||(0,E.rangeIsMergeCell)(q,k.getCellDataAtPosition(q.startRowIndex,q.startColIndex)))&&(Ce=Se=!i.isMerge||!!(0,E.rangeIsMergeCell)(q,k.getCellDataAtPosition(q.startRowIndex,q.startColIndex)));var be=i.infoDimension;if(Ce||be&&be.insertDimensionRanges&&be.insertDimensionRanges.length>0?(re=1,ie=1,Ce=!0):(re=oe<se?se/oe>>0:1,ie=le<ue?ue/le>>0:1,F||(re=1,ie=1)),this.config&&this.config.tile||1===se&&1===ue)fe=oe*re,pe=le*ie;else if(se<=oe||ue<=le){fe=$+oe-1>=k.getColCount()?oe*re:se,pe=K+le-1>=k.getRowCount()?le*ie:ue}else fe=se,pe=ue;if(!1===G&&1===fe&&1===pe&&(Ce=!0),!this.config.isFormatPainter&&!Ce&&(0,E.rangeIsMergeCell)(q,k.getCellDataAtPosition(q.startRowIndex,q.startColIndex))){var we=j.clone().move(K-j.startRowIndex,$-j.startColIndex);if(!we.contain(q)&&q.isCross(we)&&!q.equals(we))return(0,s.showDialogMergeCellAndRangeNotMatchV2)(),!1}q.endRowIndex=q.startRowIndex+pe-1,q.endColIndex=q.startColIndex+fe-1;var Re=[],xe=[],Ee=-1,Ie=-1,_e=-1,Ae=-1;if(be){var De=be.insertDimensionRanges;De&&De.map(function(e){var t=e.dimension;t===h.default.ROWS?(Ee=e.startIndex,Ie=e.endIndex):t===h.default.COLUMNS&&(_e=e.startIndex,Ae=e.endIndex)})}for(te=0;te<pe;te++)if(ee=K+te,!(Ee>-1&&ee>=Ee&&ee<=Ie))for(ne=0;ne<fe;ne++)if(J=$+ne,!(_e>-1&&J>=_e&&J<=Ae))if((0,E.cellIsMergedCell)(k.getCellDataAtPosition(ee,J),ee,J)){var ke=k.getCellDataAtPosition(ee,J);if(ke){var Me=ke.getMergeReference();if(Me&&!q.contain(Me))return console.error("invalid paste"),(0,s.showDialogIntersectWithPasteMerge)(),!1}}else if(this.config.isFormatPainter&&(0,E.cellIsMergeCell)(k.getCellDataAtPosition(ee,J),ee,J)){var Oe=k.getCellDataAtPosition(ee,J);if(Oe){var Le=Oe.getMergeReference();if(Le&&!q.contain(Le))return console.error("invalid paste"),(0,s.showDialogMergeCellAndRangeNotMatchV2)(),!1}}else if(i.merge&&i.merge[te]&&i.merge[te][ne]){var Ne=i.merge&&i.merge[te][ne];if(Ne){var Fe=ee+Ne.h-1,Pe=J+Ne.w-1;Fe>q.endRowIndex&&(pe=Fe-K+1),Pe>q.endColIndex&&(fe=Pe-$+1)}}if(F&&A.pasteType===w.CopyType.cut&&A.sheetId){var Be,Ue=A.from.xRange[0],Ve=A.from.xRange[1],He=A.from.yRange[0],je=A.from.yRange[1],Ye=A.sheetId;if(Be=(0,v.divideGridRangesByFilter)([new d.default(Ye,He,je,Ue,Ve)],k.getBasicFilter()),he={cutGridRanges:Be,cutUnmergeOptions:[],cutRowsDimensionRanges:[],cutColumnsDimensionRanges:[]},i.merge)for(te=0;te<le;te++)for(W=He+te,ne=0;ne<oe;ne++)X=Ue+ne,"object"===("undefined"===typeof(ae=i.merge[te][ne])?"undefined":(0,a.default)(ae))&&he.cutUnmergeOptions.push({startRowIndex:W,endRowIndex:W+ae.h-1,startColIndex:X,endColIndex:X+ae.w-1,sheetId:Ye});this.cacheState.select.selectCol&&(he.cutColumnsDimensionRanges=[new p.default(Ye,Ue,Ue+oe-1,h.default.COLUMNS)]),this.cacheState.select.selectRow&&(he.cutRowsDimensionRanges=[new p.default(Ye,He,He+le-1,h.default.ROWS)])}else he={cutGridRanges:[],cutUnmergeOptions:[],cutRowsDimensionRanges:[],cutColumnsDimensionRanges:[]};Te=i.images&&i.images.length>0?i.images:[];var qe=[].concat(he.cutGridRanges,he.cutColumnsDimensionRanges,he.cutRowsDimensionRanges);for(te=0;te<pe;te++)for(W=te%le,ee=K+te,ye.push({values:[]}),ne=0;ne<fe;ne++){X=ne%oe,J=$+ne;var Ge=le,ze=oe,Xe=i.formula,We=null;if(Xe&&!B){var $e=Xe[te%Ge]?Xe[te%Ge][ne%ze]:null;$e&&(We=(0,x.getFormulaWithRelativeFormula)($e,ee,J))}var Ke=void 0;if(this.isCopyFromSingleCell(z)&&(0,E.rangeIsMergeCell)(q,k.getCellDataAtPosition(q.startRowIndex,q.startColIndex))&&!this.config.isFormatPainter&&!B){var Qe=i.rowDataUpdate[W].values[X],Ze=Qe&&Qe.getEditValue(),Je=Qe&&Qe.getEffectiveValue();Ke=new g.default({editValue:Ze,effectiveValue:Je})}else{var et=i.rowDataUpdate[W].values[X],tt=i.rowDataUpdate[W].values[X];if(et){var nt=et.getEditValue(),at=et.getEffectiveValue(),rt=at&&at.value||"";"string"===typeof rt&&(0,u.isFormula)(rt)&&(nt=(0,u.fixRightBracket)(nt||""),rt=(0,u.fixRightBracket)(rt),et.setProperties({editValue:nt,effectiveValue:(0,l.default)(at,{value:rt})}));var it=et.getHyperlink(),ot=et.getUserEnteredFormat();if(it){var lt=!1,st=!1;if(tt){var ut=et.getUserEnteredFormat();ut&&(ut.getColor()&&(lt=!0),ut.getUnderline()&&(st=!0))}ot||(ot=new C.default),!lt&&ot.setTextFormat({color:b.HYPERLINK_COLOR}),!st&&ot.setTextFormat({underline:S.default.SINGLE_LINE}),et.setUserEnteredFormat(ot)}}if(B&&et&&et.getFormula()){var ct=et.getFormula();if(ct){var dt=ct.clone();dt.updateAfterCutAndPaste({cutRanges:qe,oldRow:V[1]+te,oldCol:V[0]+ne,newRow:ee,newCol:J}),et.setFormula(dt)}}We&&(et=et||new g.default).setFormula(R.default.string2FormulaModel(We,ee,J,N)),Ke=et}if(ye[te].values.push(Ke),ne%fe==0&&i.rowsDimensionProperties){var ft=i.rowsDimensionProperties[W],pt=O&&O[ee],ht=pt&&pt.pixelSize;i.fromApp===w.fromAppType.tencent||null===ht||void 0===ht||0===ht?Re.push(ft):(ft&&(ft.pixelSize=ht),Re.push(ft))}if(te%pe==0&&i.colsDimensionProperties){var vt=i.colsDimensionProperties[X],gt=L&&L[J],mt=gt&&gt.pixelSize;i.fromApp===w.fromAppType.tencent||null===mt||void 0===mt||0===mt?xe.push(vt):(vt&&(vt.pixelSize=mt),xe.push(vt))}if(!Se&&i.merge){if(ae=(0,E.cellIsMergeCell)(k.getCellDataAtPosition(ee,J),ee,J),!be&&ae){var yt=k.getCellDataAtPosition(ee,J);yt&&function(){var e=yt.getMergeReference();e&&(A.sheetId===N&&he.cutUnmergeOptions.reduce(function(t,n){return t||n.startRowIndex===e.startRowIndex&&n.startColIndex===e.startColIndex&&n.endRowIndex===e.endRowIndex&&n.endColIndex===e.endColIndex},!1)||ge.push(e))}()}"object"===("undefined"===typeof(ae=i.merge[W][X])?"undefined":(0,a.default)(ae))&&me.push({startRowIndex:ee,endRowIndex:ee+ae.h-1,startColIndex:J,endColIndex:J+ae.w-1,sheetId:N})}}var Tt=!(1!==fe||!(0,y.needCheckSmartSplit)(n)),Ct=!1;Tt&&(Ct=(0,y.needCheckSmartSplit)(n,!0));var St=!1,bt=!1;if(F&&A.select)St=A.select.selectAll||A.select.selectRow,bt=A.select.selectAll||A.select.selectCol;else if(i.fromApp===w.fromAppType.tencent)St=i.select.selectAll||i.select.selectRow,bt=i.select.selectAll||i.select.selectCol;else{var wt=1==oe&&1==le;St=!wt,bt=!wt}var Rt=i.infoDimension,xt=(0,v.convertGridRangeToSheetIdXYRange)(q),Et=xt.rowsRange,It=xt.columnsRange,_t=[];if(Rt){var At=Rt.insertDimensionRanges;At&&At.map(function(e){var t=e.dimension;t===h.default.ROWS?_t.push(Et):t===h.default.COLUMNS&&_t.push(It)})}else Re.length>0&&St&&_t.push(Et),xe.length>0&&bt&&_t.push(It);for(var Dt=0,kt=[],Mt=0,Ot=K,Lt=K-1;Mt<pe;Mt++)if(Lt++,ce.get(Lt)){if(Mt--,Dt++,Lt-Ot<1){Ot=Lt+1;continue}var Nt=new d.default(N,Ot,Lt-1,$,$+fe-1);kt.push(Nt),Ot=Lt+1}else if(Mt===pe-1){var Ft=new d.default(N,Ot,Lt,$,$+fe-1);kt.push(Ft)}else console.log(2);var Pt=new d.default(A.sheetId,U.yRange[0],U.yRange[1],U.xRange[0],U.xRange[1]),Bt=i,Ut=Bt.cellMask,Vt=void 0===Ut?I.CELL_DATA_SLOT_COMPOSE.ALL:Ut,Ht=Bt.formatMask;A.pasteType===w.CopyType.copy&&"undefined"!==typeof Vt&&(Vt-=1<<_.default.SLOT_MENTION);var jt=(0,l.default)({cellMask:Vt,formatMask:Ht,sheetId:N,pasteRanges:kt,unmergeInfos:ge,mergeInfos:me,cutData:he,copyRange:Pt,toGridRange:q,infoDimension:(0,l.default)(Rt||{},{sheet:k,pasteRange:q,pasteDimensionPropsRanges:_t,rowsDimensionProperties:Re,columnsDimensionProperties:xe}),pasteEmbeddedObjects:D({xIndex:q.startColIndex,yIndex:q.startRowIndex,shapeDatas:Te}).map(function(e){return(0,m.convertShapeData2EmbeddedObjectProperties)(e,N)}),isFormatPainter:!!this.config.isFormatPainter},T&&T.clearRangeContent?{clearRangeContent:T.clearRangeContent}:{}),Yt=O.filter(function(e){return e&&e.hiddenByUser}),qt=L.filter(function(e){return e&&e.hiddenByUser});i.fromType!==w.FromType.COPY_CACHE||N!==A.sheetId||A.pasteType!==w.CopyType.copy||A.copyRangeIsChange||P||this.config.isFormatPainter||0!==Yt.length||0!==qt.length||Pt.isCross(kt[0])&&Rt&&Rt.insertDimensionRanges?(0,f.applyPasteData)((0,l.default)({gridData:{startRow:K,startColumn:$,rowData:ye,rowMetadata:[],columnMetadata:[]}},jt)):(0,f.insideSheetCopyPaste)((0,l.default)({copyPasteMutationsOptions:{copyRange:Pt}},jt)),F&&(this.cacheState.pasteType=w.CopyType.copy,this.cacheState.hasDonePaste=!0);var Gt={xRange:[$,$+fe-1],yRange:[K,K+pe-1+Dt]},zt={selectAll:!1,selectRow:!1,selectCol:!1};return F&&(0===q.startColIndex&&q.endColIndex===k.properties.getGridProperties().columnCount-1&&(zt.selectRow=!0),0===q.startRowIndex&&q.endRowIndex===k.properties.getGridProperties().rowCount-1&&(zt.selectCol=!0)),n.view&&n.view.canvas.excel.selectAreaCell(Gt,void 0,!0,zt),B&&F&&(n.plugins.copyPaste.copyPasteCache.cacheState.valid=!1),o&&o.bind({pasteData:(0,c.clone)(i),stateBefore:(0,c.clone)(ve)})({hotInstance:n,active:(0,l.default)({},t),fromCache:F,pasteType:B?w.CopyType.cut:w.CopyType.copy,toCheckSmartSplit:Tt,isNewSheet:Ct,envs:T}),!0}},{key:"cancelCopy",value:function(){var e=this.spreadsheetApp.spreadsheet.getSheetBySheetId(this.cacheState.sheetId);e&&(this.cacheState.key&&(e.positionCenter.remove(this.cacheState.key),this.cacheState.key=null),this.cacheState.copyRangeListenKey&&(e.positionCenter.remove(this.cacheState.copyRangeListenKey),this.cacheState.copyRangeListenKey=null))}},{key:"getCacheData",value:function(){return this.cacheData}},{key:"getCacheState",value:function(){return this.cacheState}},{key:"setStateCopyData",value:function(e){this.cacheState.clipboardCopyData=e}},{key:"setCacheDataType",value:function(e){this.cacheState.pasteType=e}},{key:"setCacheData",value:function(e){this.cacheData=e}},{key:"setValid",value:function(e){this.cacheState.valid=e}},{key:"isCopyFromSingleCell",value:function(e){return!!e&&!(e.length>1||e[0]&&e[0].length>1)}}]),e}();t.default=k},406:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.changesToPasteData=t.genChanges=void 0;var a=h(n(41)),r=h(n(14)),i=h(n(25)),o=h(n(24)),l=h(n(9)),s=h(n(54)),u=h(n(62)),c=n(68),d=h(n(52)),f=h(n(108)),p=h(n(78));function h(e){return e&&e.__esModule?e:{default:e}}function v(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=[],a=[],r=[],i=0,s=e.length,u=0;u<s;u++){var c=e[u],d=(0,l.default)(c);y.apply(void 0,[d,"prefix","suffix","num"].concat((0,o.default)(t))),d.sort(function(e,t){return e-t}),d.length<1||(a[u]=d,i=Math.max(c[d[0]].length,i))}if(i<1)return[n,n.length,i,r];for(var f=0;f<s;f++){var p=a[f],h=p.length;if(p||!(h<1)){var v=e[f],m=v.prefix,T=v.suffix;m&&""!==m.trim()&&(n.push([m].concat((0,o.default)(g(i-1,"")))),r.push(n.length-1));for(var C=g(i-v[p[0]].length,""),S=0;S<h;S++)n.push([].concat((0,o.default)(v[p[S]]),(0,o.default)(C)));T&&""!==T.trim()&&(n.push([T].concat((0,o.default)(g(i-1,"")))),r.push(n.length-1)),a[f+1]&&a[f+1].length>0&&(n.push([].concat((0,o.default)(g(i,"")))),n.push([].concat((0,o.default)(g(i,"")))))}}return[n,n.length,i,r]}function g(e,t){var n=[];t&&"object"===("undefined"===typeof t?"undefined":(0,i.default)(t))&&(t=(0,r.default)({},t));for(var a=0;a<e;a++)n.push(t);return n}function m(e,t,n){for(var a=[],r=0;r<e;r++)a.push(g(t,n));return a}function y(e){for(var t=arguments.length,n=Array(t>1?t-1:0),a=1;a<t;a++)n[a-1]=arguments[a];for(var r=0;r<n.length;r++){var i=e.indexOf(n[r]);-1!==i&&e.splice(i,1)}}function T(e){var t=(0,a.default)(e,4),n=t[0],r=t[1],i=t[2],o=t[3],l=n.map(function(e,t){var n=-1!==o.indexOf(t);return{values:e.map(function(e){var t={wrapStrategy:n?f.default.OVERFLOW_CELL:null},a=new d.default(t),r=new p.default({type:u.default.STRING,value:e});return new s.default({userEnteredFormat:a,effectiveValue:r})})}});return{isSingle:!1,isMerge:!1,merge:m(r,i,!1),formula:m(r,i,null),fromType:1,images:[],rowDataUpdate:l,fromApp:c.fromAppType.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0}}t.genChanges=v,t.changesToPasteData=T,t.default=function(e){return T(v(e))}},407:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.cellIsMergeCell=function(e,t,n){if(!e)return!1;var a=e.mergeReference;return!!a&&(a.startRowIndex===t&&a.startColIndex===n)},t.cellIsMergedCell=function(e,t,n){if(!e)return!1;var a=e.mergeReference;return!!a&&(a.startRowIndex!==t||a.startColIndex!==n)},t.rangeIsMergeCell=function(e,t){if(!t)return!1;var n=t.getMergeReference();return!!n&&n.equals(e)},t.rangeCoverMergeCell=function(e,t){for(var n=e.startRowIndex,a=e.startColIndex,r=e.endRowIndex,i=e.endColIndex,o=n;o<=r;o++)for(var l=a;l<=i;l++){var s=t.getCellDataAtPosition(o,l);if(s){var u=s.getMergeReference();if(u)return u.isCross(e)}}return!0}},408:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.CANPASTETYPE=void 0;var a=U(n(16)),r=U(n(47)),i=U(n(0)),o=U(n(1)),l=U(n(692)),s=U(n(1312)),u=n(409),c=n(694),d=U(c),f=U(n(54)),p=U(n(78)),h=U(n(62)),v=n(68),g=n(693),m=U(g),y=U(n(405)),T=U(n(18)),C=n(112),S=n(288),b=n(1333),w=(n(239),U(n(7))),R=n(22),x=U(n(289)),E=n(51),I=n(1334),_=U(n(12)),A=n(71),D=n(99),k=U(n(8)),M=n(26),O=n(1335),L=n(1338),N=n(143),F=n(407),P=n(1339),B=n(1341);function U(e){return e&&e.__esModule?e:{default:e}}var V,H=w.default.window,j=s.default.getSingleton();!function(e){e.TEXT="text/plain",e.HTML="text/html",e.IMAGE="image/png"}(V||(V={}));var Y=t.CANPASTETYPE=void 0;!function(e){e[e.NONE=1]="NONE",e[e.CACHE=2]="CACHE",e[e.CLIPBOARD=3]="CLIPBOARD"}(Y||(t.CANPASTETYPE=Y={}));var q=0|1<<T.default.SLOT_EFFIECTIVE_VALUE|1<<T.default.SLOT_HYPERLINK|1<<T.default.SLOT_USER_ENTERED_FORMAT_DELTA|1<<T.default.SLOT_FORMULA|1<<T.default.SLOT_RICH_TEXT_STYLE_RUN;function G(e,t,n){e.addEventListener?e.addEventListener(t,n,!1):e.attachEvent&&e.attachEvent("on"+t,function(){n(H.event)})}var z=function(){function e(t){(0,i.default)(this,e),this.textarea=void 0,this.enablePlugin(),this.copyPasteShape=new m.default(t,C.addImage),this.hotInstance=t,this.copyPasteCache=new y.default({spreadsheetApp:t,config:{setSlots:q,tile:!0}}),x.default.isCopyInEnv()&&x.default.init()}return(0,o.default)(e,[{key:"closePasteSpecial",value:function(){(0,c.closePasteSpecial)()}},{key:"enablePlugin",value:function(){this.textarea=l.default.getSingleton(),this.registerEvents();var e=this,t=navigator.userAgent,n=t.match(/Mac\sOS\sX/i),a=t.match(/iPad/i);G(document.body,"keyup",function(t){if(a&&e.textarea.isActive())return e.hotInstance.view.canvas.excel.input.focus(),_.default.wait(1e3).run(function(){document.activeElement&&document.activeElement.blur()});(n?t.metaKey:t.ctrlKey)||!e.textarea.isActive()||e.hotInstance.view.canvas.excel.input.focus()})}},{key:"registerEvents",value:function(){var e=this;G(this.textarea.element,"paste",function(t){return e.onPaste(t)}),G(this.textarea.element,"cut",function(t){return e.onCut(t)}),G(this.textarea.element,"copy",function(t){return e.onCopy(t)})}},{key:"getCacheData",value:function(){return this.copyPasteCache.getCacheData()}},{key:"onCopy",value:function(e){e.preventDefault()}},{key:"onCut",value:function(e){e.preventDefault()}},{key:"urltoFile",value:function(e,t,n){return n=n||(e.match(/^data:([^;]+);/)||"")[1],fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:n})})}},{key:"onPaste",value:function(e){k.default.run(M.CONFIG.COPY_PASTE);new Date;e&&e.preventDefault&&e.preventDefault();var t="";e&&"undefined"!==typeof e.clipboardData?t=e.clipboardData.getData("text/plain"):"undefined"===typeof ClipboardEvent&&"undefined"!==typeof H.clipboardData&&(t=H.clipboardData.getData("Text"));var n,a=e.clipboardData&&e.clipboardData.getData("text/html"),r=e.clipboardData&&e.clipboardData.getData("text/json");console.log("---text/json---"),console.log(r),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")&&(""===(n=t.split("\n"))[n.length-1]&&n.pop(),t=n.join("\n")),n=t.split("\n");for(var i=0;i<n.length-1;i++){var o=n[i].length;13===n[i].slice(o-1).charCodeAt()&&(n[i]=n[i].slice(0,o-1))}t=n.join("\n");try{(0,u.getCopyHTMLType)()===v.CopyHTMLType.shapes&&k.default.tdwReport({module:"excel_picture",opername:"doc_excel_editor",action:"picture_menu_ctrl_v"})}catch(l){}this.doClipboardPaste({html:a,plain:t},e)}},{key:"onPastePCClient",value:function(){var e="",t="",n=[],a=external.getClipboardData,r=external.getClipboardType();if(r.indexOf(V.TEXT)>-1){if(e=a(V.TEXT),-1!==navigator.userAgent.indexOf("Safari")&&-1===navigator.userAgent.indexOf("Chrome")){var i=e.lastIndexOf("\n");i>-1&&""===e.slice(i+1)&&(e=e.slice(0,i))}e=e.replace(/\r\n/g,"\n")}if(r.indexOf(V.HTML)>-1&&(t=a(V.HTML)),r.indexOf(V.IMAGE)>-1){var o=a(V.IMAGE);if(o){var l=o.type,s={type:l,getAsFile:function(){return new File([o],"fromOutImage"+l.replace(/[^\/]+\/([^\/]+)/,"$1"),{type:l,lastModified:Date.now()})}};n.push(s)}}var u={clipboardData:{items:n,getData:function(e){switch(e){case V.TEXT:return a(V.TEXT);case V.HTML:return a(V.HTML);case V.IMAGE:return a(V.IMAGE);default:return}}}};this.doClipboardPaste({html:t,plain:e},u)}},{key:"getPasteType",value:function(){var e=this.copyPasteCache.getCacheState(),t=e.valid,n=(0,u.getCopyHTMLType)(),a=!1;if(R.isPCClient&&"function"===typeof external.getClipboardType){var r=external.getClipboardType();if(r&&r.length>0&&(a=!0),!a)return e.valid=!1,Y.NONE;if(t){var i=e.clipboardCopyData.html;return-1===r.indexOf(V.HTML)?Y.CLIPBOARD:i===external.getClipboardData(V.HTML)?Y.CACHE:Y.CLIPBOARD}return Y.CLIPBOARD}return n===v.CopyHTMLType.table&&t||n===v.CopyHTMLType.shapes||n===v.CopyHTMLType.input?Y.CACHE:Y.NONE}},{key:"doClipboardPaste",value:function(e,t){var n=this,a=+new Date;if(e){var i=new Date,o=e.plain,l=e.html;console.log("pasteHtmlString: "+l);var s=this;s.mObjects=null;var c=(0,u.getCopyHTMLType)(),d=l&&(l.length>3e3||!(0,B.parseHTMLIsSingleImg)(l))?[]:s.parseCopyImgs(t),f=!(0,u.isClipboardCopyFormTencentDoc)(l,o,d),p=H.ActiveXObject||"ActiveXObject"in H;console.log(f+";"+p),f&&p&&localStorage&&null==localStorage.getItem("ctrl_V_key_pasteTip")&&(localStorage.setItem("ctrl_V_key_pasteTip","true"),(0,A.hideToast)(),(0,A.showToast)("\u7531\u4e8eIE\u6d4f\u89c8\u5668\u9650\u5236\uff0c\u53ea\u80fd\u7c98\u8d34\u7eaf\u6587\u5b57\uff0c\u4e0d\u652f\u6301\u7c98\u8d34\u683c\u5f0f\u3002\u5efa\u8bae\u4f7f\u7528Chrome\u6216QQ\u6d4f\u89c8\u5668\u3002",void 0,{isNeedBtn:!0,btnText:"\u6211\u77e5\u9053\u4e86",btnTextAfter:"",btnCallBack:function(){(0,A.hideToast)()}})),this.value=o;var h=void 0,g=void 0,m=f&&!l&&d&&d.length>0,y=this.copyPasteShape,T=function(){try{if(f){var e=!1,a=!1;if(!e&&t&&t.clipboardData&&t.clipboardData.getData("text/json")){e=!0;var r=t.clipboardData.getData("text/json");r=JSON.parse(r),y.onParse(r,"json")}if(!e&&d&&d.length>=1&&(e=!0,y.onParse(d,"files")),!e&&l&&l.length>0){var i=j.parseHTML(l);if(i&&i.table&&i.table.data.length>0){e=!0;var p=(0,P.convertParsedTableData2PasteData)(i.table);p.images=i.images,p.containTable=i.containTable,i.fromApp&&(p.fromApp=function(e){switch(e){case"excel":return v.fromAppType.excel;case"tencent":return v.fromAppType.tencent;default:return v.fromAppType.unknown}}(i.fromApp));0,a=n.doPaste({pasteData:p,pasteHtmlString:l}),n.textarea.setValue(" ")}}if(!e&&o){e=!0;0,s.automaticIdentifyLink.call(s,o)}return e||console.log("\u65e0\u6cd5\u5904\u7406\u7684\u5916\u90e8\u7c98\u8d34\u5185\u5bb9"),n.copyPasteCache.cancelCopy(),C(),e&&a}if(c){if(n.isImageTextPaste(c,l))n.doImageTextPaste({type:c,pasteHtmlString:l});else if(c===v.CopyHTMLType.table)n.doPaste();else if(c===v.CopyHTMLType.shapes){r=(0,u.getCopyPlainCache)().json;r=JSON.parse(r),y.onParse(r,"json")}}else if(!o)return!1;return C(),!0}catch(m){return console.log(m),g&&h&&g.removeChild(h),!1}};return e.isApi?T():new r.default(function(e,t){for(var n=H.$(".active-area"),a=0;a<n.length;a++)if("none"!==n[a].style.display){g=n[a];break}var r=new Date;(l&&l.length>15e3||r.getTime()-i.getTime()>20||m)&&g&&((h=document.createElement("loadingView")).setAttribute("width",g.style.width),h.setAttribute("height",g.style.height),h.style.backgroundColor="#E2E2E2",h.style.width=g.style.width,h.style.height=g.style.height,h.style.borderColor="#E2E2E2",h.style.background='url("/static/img/spinner16.gif") center left no-repeat',h.style.display="flex",h.style.marginLeft="5px",h.style.content="",g.appendChild(h)),_.default.wait(100).run(function(){e()})}).then(T).then(function(){k.default.speed.runReport(f?M.SPEED_REPORT_POINTS.TIME_PASTE_FROM_OUTER:M.SPEED_REPORT_POINTS.TIME_PASTE_FROM_INNTER,a,+new Date)})}function C(){g&&h&&(m?_.default.wait(1e3).run(function(){g.removeChild(h)}):g.removeChild(h))}this.doPaste()}},{key:"isImageTextPaste",value:function(e,t){var n=!1;if(t&&t.length>0){var a=void 0;e===v.CopyHTMLType.table&&(a=t.match(/cutShapeIDs[\S]+cutShapeIDs/)),void 0!==a&&null!==a&&(n=!0)}return n}},{key:"doImageTextPaste",value:function(e){var t=e.type,n=e.pasteHtmlString,a=e.pasteData,r=e.selectAreaCellRange,i=this.hotInstance,o=void 0;if(t===v.CopyHTMLType.table&&n&&n.length>0&&(o=n.match(/cutShapeIDs[\S]+cutShapeIDs/)),void 0!==o&&null!==o&&n&&n.length>0)if(this.copyPasteCache.getCacheState().pasteType==v.CopyType.cut){var l=this.copyPasteCache.getCacheState().sheetId,s=o[0];(s=s.replace(/cutShapeIDs/g,"")).split("|").forEach(function(e){l&&(0,C.deleteImage)({id:e,sheetId:l})}),i.view.canvas.excel.closePickShape()}else this.copyPasteCache.cancelCopy();if(n&&n.length>0){var u=j.parseHTML(n);a=a||this.copyPasteCache.getCacheData(),u&&u.table&&u.table.data.length>0&&(a.images=u.images,a.containTable=!0,this.doPaste({pasteData:a,pasteHtmlString:n,selectAreaCellRange:r}),this.textarea.setValue(" "))}}},{key:"doPaste",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{pasteHtmlString:""},t=e.pasteData,n=e.cb,a=e.selectAreaCellRange,r=e.envs,i=e.pasteHtmlString,o=this.copyPasteShape,l=n||!R.isMobile&&d.default,s=!1;try{s=this.handlerDoPaste({pasteData:t,cb:l,undoCb:c.closePasteSpecial,selectAreaCellRange:a,envs:r})}catch(u){console.error(u)}return console.log("doPasteSuccess = "+s),s&&(t&&t.images&&t.images.length>0&&t.images.forEach(function(e){o.pasteShapeByHTML(e)}),i&&i.length>0&&this.showPlaceHolderImgTipsV2(t&&t.images||[],i)),this.copyPasteCache.cancelCopy(),s}},{key:"showPlaceHolderImgTipsV2",value:function(e,t){var n="",a=(/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor),navigator.userAgent.match(/Mac\sOS\sX/i)),r=e.filter(function(e){return!(!e.url||e.url!==g.retinaPlaceHolderUrl&&e.url!==g.placeHolderUrl)});if(0!==r.length?n=-1!=t.indexOf("urn:schemas-microsoft-com:office:office")?-1!=t.indexOf("urn:schemas-microsoft-com:office:excel")?r&&r.length<=5?(0,I.getCopyPasteToast)("copy",a):(0,I.getCopyPasteToast)("import",a):(0,I.getCopyPasteToast)("copy",a):(0,I.getCopyPasteToast)("save",a):-1!=t.indexOf("<img")&&-1!=t.indexOf('src="blob:')&&(n=(0,I.getCopyPasteToast)("save",a)),n){(0,A.showToast)(n,{top:"182px","z-index":501,"max-width":800},{toastType:"typeNotice",isNeedClose:!0,isNeedReflush:!0}),$(".view_announcement").off("click").on("click",function(){H.onlineDocDialog.createDialog(H.res.afterUpdateTip.content_afterupdate,null,function(){(0,A.hideToast)()})})}}},{key:"doCopy",value:function(e){var t=e.copyType,n=e.previewActiveSheetId,a=+new Date;(0,N.getQuery)("inToastPreview")&&k.default.tdwReport({opername:"doc_preview",module:"pc_qqview",action:"cli_copy"});var r=this.hotInstance,i=r.view.canvas.excel.selectData.select;k.default.jank.log({moduleValue:"copy",actionValue:"analysis",detail:[{x:i.xRange[0],y:i.yRange[0],w:i.xRange[1]-i.xRange[0]+1,h:i.yRange[1]-i.yRange[0]+1}]}),(0,b.tipsDialogShowIsInIE)();var o=r.spreadsheet.activeSheet,l=n||o.getSheetId(),s={xRange:[i.xRange[0],i.xRange[1]],yRange:[i.yRange[0],i.yRange[1]]},c=(0,E.convertXYRangeToSheetIdXYRange)(s,l),d=(0,E.convertSheetIdXYRange2GridRange)(c),f=r.view.canvas.excel.selectData.select,p=f.selectCol,h=f.selectRow;if((p||h)&&t==v.CopyType.cut&&!(0,F.rangeCoverMergeCell)(d,o))return D.dialog.alert("\u8b66\u544a","\u65e0\u6cd5\u5bf9\u5408\u5e76\u5355\u5143\u683c\u6267\u884c\u6b64\u64cd\u4f5c\u3002",function(){}),{html:"",plain:"",timeStamp:"0"};r.view.canvas.excel.doCopy(),R.isMac&&this.textarea.select();var g=this.copyPasteCache.onCopy({from:s,copyType:t,hotInstance:this.hotInstance,previewActiveSheetId:n});try{(0,u.clipboardCopy)({copyContent:g,type:v.CopyHTMLType.table})}catch(m){console.error(m)}return R.isMac&&(this.textarea.deselect(),this.hotInstance.view.canvas.excel.focusInput()),console.log("2222instance.view.canvas.excel.doCopy();"),r.view.canvas.excel.doCopy(),k.default.speed.runReport(M.SPEED_REPORT_POINTS.TIME_COPY,a,+new Date),g}},{key:"handlerDoPaste",value:function(e){var t=e.pasteData,n=e.cb,r=e.undoCb,i=e.selectAreaCellRange,o=e.envs,l=i||this.hotInstance.view.canvas.excel.selectData.select,s={xRange:[l.xRange[0],l.xRange[1]],yRange:[l.yRange[0],l.yRange[1]]},u=this.hotInstance.view.getSelection().rangeSelections[0];if("undefined"===typeof u.startRowIndex||"undefined"===typeof u.startColIndex||"undefined"===typeof u.endRowIndex||"undefined"===typeof u.endColIndex)return D.dialog.info("\u8b66\u544a","\u65e0\u6cd5\u6267\u884c\u6b64\u64cd\u4f5c\u3002\u8bf7\u9009\u4e2d\u533a\u57df\u91cd\u8bd5"),!1;try{H.log&&H.log.info("pasteSelectRagne",(0,a.default)(i),(0,a.default)(this.hotInstance.view.canvas.excel.selectData.select),(0,a.default)(this.hotInstance.view.getSelection().rangeSelections[0]))}catch(d){}var c=this.copyPasteCache.onPaste({to:s,hotInstance:this.hotInstance,pasteData:t,cb:n,undoCb:r,envs:o});return this.hotInstance.view.canvas.excel.closeCopy(),c}},{key:"doShapesCopy",value:function(e){var t=this.hotInstance,n=this.copyPasteShape.getCopyContent();if(R.isMac&&this.textarea.select(),(0,u.clipboardCopy)({copyContent:n,type:v.CopyHTMLType.shapes}),e===v.CopyType.cut){var a=t.view.canvas.excel.selectData.pickShape,r=t.spreadsheet.activeSheet.getImage(a);(0,C.deleteImage)((0,S.convertEmbeddedImage2IAddImage)(r)),t.view.canvas.excel.closePickShape()}R.isMac&&this.textarea.deselect(),this.copyPasteCache.cancelCopy(),t.view.canvas.excel.closeCopy()}},{key:"parseCopyImgs",value:function(e){return(0,L.parseCopyImgs)(e)}},{key:"automaticIdentifyLink",value:function(e){var t=(0,O.automaticIdentifyLink)(e);t&&this.doPaste({pasteData:t})}},{key:"syncMobileClipboard",value:function(e){(0,u.syncMobileClipboard)(e)}},{key:"doCopyToClipboard",value:function(e){(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&(0,u.clipboardCopy)({copyContent:e,type:e.type||v.CopyHTMLType.table}),this.copyPasteCache.setCacheData({isSingle:!0,isMerge:!1,merge:[[]],rowDataUpdate:[{values:[new f.default({effectiveValue:new p.default({type:h.default.STRING,value:e.plain})})]}],fromType:v.FromType.COPY_CACHE,fromApp:v.fromAppType.tencent,select:{selectAll:!1,selectCol:!1,selectRow:!1},containTable:!0}),this.copyPasteCache.setValid(!0),this.copyPasteCache.setStateCopyData(e)}}]),e}();t.default=z},409:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.hasMobileClipboardContent=t.syncMobileClipboard=t.getCopyPlainCache=t.getCopyHTMLType=t.isClipboardCopyFormTencentDoc=t.clipboardCopy=void 0;var a=u(n(9)),r=u(n(1318)),i=n(68),o=u(n(289)),l=u(n(12)),s=n(22);function u(e){return e&&e.__esModule?e:{default:e}}var c={html:null,plain:null,json:null,timeStamp:0},d=void 0,f=function(){return c},p=function(){return d},h=function(e,t,n,a){(c={html:e,plain:t,json:n}).timeStamp=Date.now(),function(e){d=e}(a)},v={html:"",plain:"",timeStamp:0},g=function(e){var t=window.mqq;t&&"0"!==t.clientVersion&&!s.isQQMiniProgram?t.invoke("docx","readSystemClipboard",{},function(t,n){if(n){var r=n.html,i=void 0===r?"":r,o=n.plain,l=void 0===o?"":o;console.log((0,a.default)(n)),console.log("data.html: "+n.html),console.log("data.plain: "+n.plain),i===v.html&&l===v.plain||(v.html=i,v.plain=l,v.timeStamp=Date.now())}e&&e(v)}):e&&e(v)};try{g(),window.mqq.addEventListener("qbrowserVisibilityChange",function(e){e.hidden||g()})}catch(m){}t.clipboardCopy=function(e){var t=e.copyContent,n=e.type,a=t.html,i=t.plain,s=t.json,u=void 0===s?"":s;if(o.default.isCopyOutEnv())return o.default.copyToSystem(i),void h(a,i,u,n);try{r.default.copy({"text/plain":i,"text/html":a,"text/json":u}).catch(function(e){console.error(e)}).then(function(){window.mqq&&"0"!==window.mqq.clientVersion&&l.default.wait(0).run(function(){a&&a.length>492426&&console.warn("\u5b89\u5353\u624bQ\u53ef\u80fd\u5199\u5165\u5bcc\u6587\u672c\u526a\u8d34\u677f\u5931\u8d25"),window.mqq.invoke("docx","writeSystemClipboard",{plain:i,html:a})}),h(a,i,u,n)})}catch(m){console.log(m)}},t.isClipboardCopyFormTencentDoc=function(e,t,n){return!(n&&n.length>0)&&(!e&&!t||!(!e&&!n&&t&&p()===i.CopyHTMLType.input&&t===f().plain)&&(c.html&&e&&-1!==e.indexOf(c.html)||c.plain&&c.plain.length>0&&t===c.plain&&void 0!==c.html))},t.getCopyHTMLType=p,t.getCopyPlainCache=f,t.syncMobileClipboard=g,t.hasMobileClipboardContent=function(){return!(!v.html&&!v.plain||!v.timeStamp)}},444:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=function(e){for(var t="";e>=0;)t=String.fromCharCode(e%26+97)+t,e=Math.floor(e/26)-1;return t.toUpperCase()},r=function(e){var t,n,a="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=0;for(t=0,n=(e=e.replace(/\$/g,"")).length-1;t<e.length;t+=1,n-=1)r+=Math.pow(a.length,n)*(a.indexOf(e[t])+1);return r&&--r,r};t.getFormulaWithRelativeFormula=function(e,t,n){return"string"===typeof e&&"="===e[0]?e.replace(/(R\[?-?[0-9]+\]?C\[?-?[0-9]+\]?)/g,function(e){var r=e.indexOf("C"),i=void 0,o=void 0,l=!("["===e[1]&&"]"===e[r-1])||!1,s=!("["===e[r+1]&&"]"===e[e.length-1])||!1;if(l)i="$"+(parseInt(e.substring(1,r))+1).toString();else{if(i=e.substring(2,r-1),(i=parseInt(i)+t+1)<=0)return"#REF!";i=i.toString()}if(s)o=e.substring(r+1),o="$"+a(parseInt(o));else{if(o=e.substring(r+2,e.length-1),(o=parseInt(o)+n)<0)return"#REF!";o=a(o)}return i&&o?o+i:"#REF!"}):""},t.getRelativeFormulaWithFormula=function(e,t,n){return"string"===typeof e&&"="===e[0]?e.replace(/(\$?[A-Za-z]+\$?[0-9]+)/g,function(e){var a=function(e){var t=(e="string"===typeof e?e:String(e)).match(/\d+$/),n=e.replace(/\d+$/,"");return{row:parseInt(t&&t[0]||"",10)-1,col:r(n)}}(e.toUpperCase());if(a.row<0||a.col<0)return e;var i=function(e){var t=e.match(/\d+$/);return{alpha:e.replace(/\d+$/,""),num:parseInt(t&&t[0]||"",10)}}(e).alpha,o="$"===i[0]||!1;return("$"===i[i.length-1]?"R"+a.row.toString():"R["+(a.row-t).toString()+"]")+(o?"C"+a.col.toString():"C["+(a.col-n).toString()+"]")}):""}},449:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a={CSS:{Sequence:function(){var e=/\\((([\dA-F]{2}|[\dA-F]{1,5})\s)|([\dA-F]{6}|[\dA-F]{4}))/gim;return e.unescape=function(e){var t=window,n=t.String.fromCharCode,a=t.parseInt;return e.replace(this,function(e){return n(a(e.slice(2),16))})},e}()}},r=function(e){var t=0;return e=e.split('"').map(function(e){return++t%2===0?e:e.replace(/([\\\)\|\(#;,\.\[\]\$\xa5])/g,"\\$1").replace(/(\\\xa5)/g,"\\$1")}).join("\\0022")};t.unEscapeCssSequence=function(e){return function(e){return e.replace(/(\\.)/g,function(e){return e.slice(1)}).replace(/(\\[\$\-+\/\(\):!\^&'~{}<>= ])/g,function(e){return e.slice(1)})}(a.CSS.Sequence.unescape(e))},t.escapeCssSequence=function(e){return"'"+r(e)+"'"}},655:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.document2XlsxVali=t.xlsx2DocumentVali=void 0;var a=s(n(183)),r=n(313),i=n(448),o=n(98),l=s(n(157));function s(e){return e&&e.__esModule?e:{default:e}}var u=function(e,t){var n=e;if(t===l.default.LIST&&e&&e.length>0)return'"'===e[0]?e.substr(1,e.length-2):"="+e;if("date"===t){var a=parseInt(e);a=a>=60?a-1:a,n=(0,o.formatDateNumToObj)(a+"")}return n},c=function(e,t){var n=e;if("date"===t){var a=(0,o.formatObjToDateNum)(e);return(a=a>=60?a+1:a)+""}return"list"===t&&e&&e.length>0&&"="!==e[0]&&(n='"'+e+'"'),(0,o.moveEqualChar)(n)};t.xlsx2DocumentVali=function(e,t,n,i,l,s,c,d){var f={ruleType:s,inputMessage:t,isStrict:!0,showDropDown:!!n,operator:e,argTokens:[]};i&&(i=u(i,s),f.argTokens&&f.argTokens.push({userEnteredValue:i})),l&&(l=u(l,s),f.argTokens&&f.argTokens.push({userEnteredValue:l}));var p=(0,r.transformDV2Formula)(f);return null!=p&&(p=(0,o.replaceCellIdBySlot)(p,c,d)),"custom"===s&&f.argTokens&&(f.argTokens[0]={userEnteredValue:p}),new a.default(f)},t.document2XlsxVali=function(e,t,n){if(!e)return null;var a=e.ruleType,s=e.operator,u=e.inputMessage||"",d={allowBlank:!0,error:(0,i.getDataValidationErrorMessage)(e)||"",errorStyle:"stop",errorTitle:"\u9519\u8bef",imeMode:"noControl",operator:s,prompt:u,promptTitle:u?"\u63d0\u793a":"",showDropDown:e.showDropDown||!1,showErrorMessage:!0,showInputMessage:!0,type:a};if(a==l.default.CUSTOM_ID_CARD)return null;if(e.ruleType!==l.default.CUSTOM_MUST_FLOAT&&e.ruleType!==l.default.NUMBER_FLOAT_AND_INT||(d.type="decimal"),!(0,o.isExcelType)(e))return d.type="custom",d.formula1="="+(0,o.replaceSlotByCellId)((0,r.transformDV2Formula)(e),t,n),d.operator=null,d;var f=e.argTokens,p=f&&f[0]&&f[0].userEnteredValue||null,h=f&&f[1]&&f[1].userEnteredValue||null;if(p){var v=c(p,a).replace(/\uff0c/g,",");d.formula1=v.length>256?v.substring(0,255)+v.charAt(v.length-1):v}if(h){var g=c(h,a).replace(/\uff0c/g,",");d.formula2=g.length>256?g.substring(0,255)+g.charAt(g.length-1):g}return d}},68:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=t.PCCLIENTPASTETYPE=void 0;!function(e){e.TEXT="text/plain",e.HTML="text/html",e.IMAGE="image/png"}(a||(t.PCCLIENTPASTETYPE=a={}));var r=t.fromAppType=void 0;!function(e){e[e.tencent=0]="tencent",e[e.excel=1]="excel",e[e.unknown=2]="unknown"}(r||(t.fromAppType=r={}));var i=t.FromType=void 0;!function(e){e[e.COPY_CACHE=0]="COPY_CACHE",e[e.OUTER=1]="OUTER",e[e.TRANSPOSE=2]="TRANSPOSE",e[e.ONLYVALUE=3]="ONLYVALUE"}(i||(t.FromType=i={}));var o=t.CopyType=void 0;!function(e){e[e.copy=0]="copy",e[e.cut=1]="cut"}(o||(t.CopyType=o={}));var l=t.CopyHTMLType=void 0;!function(e){e[e.table=1]="table",e[e.shapes=2]="shapes",e[e.input=3]="input"}(l||(t.CopyHTMLType=l={}))},689:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fixRightBracket=t.isFormula=t.getEffictiveDataRange=t.calMergeCellXYUnitPosition=t.clone=void 0;var a,r=n(16),i=(a=r)&&a.__esModule?a:{default:a},o=n(44);Object.defineProperty(t,"isFormula",{enumerable:!0,get:function(){return o.isFormula}}),Object.defineProperty(t,"fixRightBracket",{enumerable:!0,get:function(){return o.fixRightBracket}});t.clone=function(e){return JSON.parse((0,i.default)(e))},t.calMergeCellXYUnitPosition=function(e){for(var t=e.mergeReference,n=e.filterHideRowMap,a=e.copyRange,r=(e.hideRowMap,e.hideColMap,a.endRowIndex),i=a.endColIndex,o=!1,l=t.getColCount(),s=t.startColIndex,u=s+l-1,c=s,d=s;d<=u;d++){if(d>i)return{xUnit:-1,yUnit:-1,x:-1,y:-1};o||(c=d,o=!0)}for(var f=!1,p=t.getRowCount(),h=t.startRowIndex,v=h+p-1,g=h,m=h;m<=v;m++){if(m>r)return{xUnit:-1,yUnit:-1,x:-1,y:-1};n&&n.get(m)?p-=1:f||(g=m,f=!0)}return{xUnit:l,yUnit:p,x:c,y:g}},t.getEffictiveDataRange=function(e,t,n,a,r){for(var i=n,o=t,l=n;l<=r&&l<e.length;l++)for(var s=t;s<=a&&e[l]&&e[l].values;s++)e[l].values[s]&&(i<l&&(i=l),o<s&&(o=s));return{maxY:i,maxX:o}}},690:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(25),i=(a=r)&&a.__esModule?a:{default:a};t.safeStringToObj=function(e,t){var n=t;if("string"===typeof e)try{n=JSON.parse(e)}catch(a){}else"object"===("undefined"===typeof e?"undefined":(0,i.default)(e))&&(n=e);return n}},692:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(0)),r=i(n(1));function i(e){return e&&e.__esModule?e:{default:e}}var o=function(){function e(){(0,a.default)(this,e),this.element=void 0,this.isAppended=!1,this.refCounter=0}return(0,r.default)(e,null,[{key:"getSingleton",value:function(){return l.append(),l}}]),(0,r.default)(e,[{key:"append",value:function(){this.hasBeenDestroyed()&&this.create(),this.refCounter++,!this.isAppended&&document.body&&document.body&&(this.isAppended=!0,document.body.appendChild(this.element))}},{key:"create",value:function(){var e;this.element=document.createElement("textarea"),this.element.id="CopyPasteDiv",(e=this.element.style).position="fixed",e.top="-10000px",e.left="-10000px",this.element.className="copyPaste",this.element.tabIndex=-1,this.element.autocomplete="off",this.element.wrap="hard",this.element.value=" "}},{key:"deselect",value:function(){this.element===document.activeElement&&document.activeElement.blur()}},{key:"destroy",value:function(){this.refCounter--,this.refCounter=this.refCounter<0?0:this.refCounter,this.hasBeenDestroyed()&&this.element&&this.element.parentNode&&(this.element.parentNode.removeChild(this.element),this.element=null,this.isAppended=!1)}},{key:"getValue",value:function(){return this.element.value}},{key:"hasBeenDestroyed",value:function(){return this.refCounter<1}},{key:"isActive",value:function(){return this.element===document.activeElement}},{key:"select",value:function(){this.element.focus(),this.element.select()}},{key:"setValue",value:function(e){this.element.value=e}}]),e}(),l=new o;t.default=o},693:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomString=t.retinaPlaceHolderUrl=t.placeHolderUrl=void 0;var a=u(n(16)),r=u(n(14)),i=u(n(0)),o=u(n(1)),l=n(288),s=n(691);function u(e){return e&&e.__esModule?e:{default:e}}t.placeHolderUrl="https://pub.idqqimg.com/pc/misc/files/20180727/b6ffe3bcf0d74c5f90f591e69a26291d.png",t.retinaPlaceHolderUrl="https://pub.idqqimg.com/pc/misc/files/20180727/c7de8a354e6f4ef99a1a8672e9b24593.png",t.randomString=function(e){e="undefined"!=typeof e?e:4;var t="";for(var n=0;n<e;n++)t+=Math.floor(65536*(1+Math.random())).toString(16).substring(1);return t};var c=function(){function e(t,n){(0,i.default)(this,e),this.hot=t,this.addImageFunc=n}return(0,o.default)(e,[{key:"addShape",value:function(e,t){var n=this.hot,a=n.spreadsheet.getActiveSheetId();if(!e.anchor){var r=n.view&&n.view.canvas.excel;r?r.selectData.active.xIndex<0?e.anchor={row:0,col:0}:e.anchor={row:r.selectData.active.yIndex,col:r.selectData.active.xIndex}:e.anchor={row:0,col:0},e.offset={x:0,y:0}}e.size||(e.size={width:-1,height:-1}),t||e.placeHolder||this.addImageFunc((0,l.convertShapeData2IAddImage)(e,a)),e.isFromHTML&&e.isLocal}},{key:"getCopyContent",value:function(){var e=this.hot.view.canvas.excel.selectData.pickShape;return this.getPickShapeCopyContent(e)}},{key:"getPickShapeCopyContent",value:function(e){var t=this.hot.spreadsheet.activeSheet.getImages();if(e&&t){var n=t,i=this.findShapeById(n,e);if(i){var o=(0,r.default)({},(0,l.convertEmbeddedImage2ShapeData)(i)),s=i.position.overlayPosition.widthPixels.toFixed(),u=i.position.overlayPosition.heightPixels.toFixed(),c=i.clipInfo.clipTop.toFixed(),d=i.clipInfo.clipLeft.toFixed(),f=i.clipInfo.clipRight.toFixed(),p=i.clipInfo.clipBottom.toFixed();return{html:'<img src="'+i.url+'" style="width: '+s+"px; height: "+u+'px;" data-clip="'+c+"px "+f+"px "+p+"px "+d+'px"/>',plain:"",json:(0,a.default)([o])}}}return{html:"",plain:"",json:""}}},{key:"onParse",value:function(e,t){var n=this;return"json"===t||"files"===t?e.map(function(e){if("json"===t){var r=void 0;return e=(0,a.default)(e),(r=JSON.parse(e)).anchor=void 0,r.offset={x:0,y:0},r.id=(0,s.getRandomAttachmentId)(),n.newShape(r),r}return(0,s.handleImage)(e,"parse").then(function(e){var t={url:e.url,id:e.id,size:{width:e.width,height:e.height},offset:{x:0,y:0},clipInfo:e.clipInfo};return n.addShape(t),t}),null}):"html"===t?null:(console.error("unkonw format to paste"),null)}},{key:"newShape",value:function(e){this.addShape(e)}},{key:"findShapeById",value:function(e,t){return e[t]}},{key:"pasteShapeByHTML",value:function(e){this.addShape(e,!0),e.isLocal}}]),e}();t.default=c},694:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initPasteSpecial=t.closePasteSpecial=void 0;var a=f(n(41)),r=f(n(1319)),i=f(n(695)),o=n(239),l=n(240),s=n(68),u=f(n(7)),c=f(n(12)),d=f(n(8));function f(e){return e&&e.__esModule?e:{default:e}}u.default.window;var p=null,h=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.hotInstance,n=e.active,u=e.fromCache,f=e.pasteType,h=e.doPasteCb,g=e.toCheckSmartSplit,m=e.envs,y=e.isNewSheet;(function(e){var t=e.hotInstance,n=e.active,o=e.fromCache,l=e.pasteType,u=(e.doPasteCb,e.smartSplitObj,e.closeCb),d=e.envs,f=t.view.canvas.excel.selectData.select,h=f.xRange,v=f.yRange,g=(0,i.default)(t,!0);if(!g)return;var m=(0,a.default)(g,2),y=m[0],T=m[1];if(l===s.CopyType.cut)return;var C=this.stateBefore,S=this.__mergeBefore,b=this.pasteData;p&&p.close();p=new r.default({styleCssText:"\n          position: fixed;\n          left:"+T+"px;\n          top:"+y+"px;\n              z-index: 104;\n        ",stateBefore:C,pasteData:b,active:n,hotInstance:t,fromCache:o,__mergeBefore:S,closeCb:u,envs:d,itemsOptions:{disableTranspose:h[0]===h[1]&&v[0]===v[1]}}),c.default.wait(50).run(function(){p&&p.resetPosition()})}).bind(this,{hotInstance:t,active:n,fromCache:u,pasteType:f,doPasteCb:h,closeCb:v,envs:m})();var T=t&&t.plugins.copyPaste.value||"";m&&m.triggeredBySP&&(0,o.getCacheResult)()?p&&m.pasteSpecialType!==l.SMARTSPLIT&&p.enableSmartSplitObj((0,o.getCacheResult)(),function(){}):m&&m.triggeredBySP||!0!==g||""===T.trim()?(0,o.setCacheResult)(null):((0,o.getResultSP)(T,function(e){p&&p.enableSmartSplitObj(e,function(){(0,o.hideToastSP)()}),(0,o.showToastSP)(function(){p&&p.triggerSmartSplit(),y&&d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"new_sheet_trigger"})},p)}),d.default.tdwReport({opername:"doc_excel_editor",module:"excel_paste_split",action:"active_trigger"}))};function v(){}t.default=h;t.closePasteSpecial=function(){p&&p.close(),p=null},t.initPasteSpecial=h},695:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r=n(16),i=(a=r)&&a.__esModule?a:{default:a};var o=void 0;t.default=function(e,t){var n=e.view.canvas,a=n.excel.cells,r=$(n.excel.container).offset();if(r){var l=r.top,s=r.left;if(!0===t)try{o=JSON.parse((0,i.default)(n.excel.selectData.select))}catch(b){}var u=o||n.excel.selectData.select,c=u.xRange,d=u.yRange,f=a.getRealPosition(c[0],d[0]),p=a.getRealPosition(c[1],d[1]),h=[f.posX[0],p.posX[1]],v=[f.posY[0],p.posY[1]],g=void 0,m=void 0,y=$(window).height(),T=$(window).width();if(T&&y){var C=v[1]+l+210+54<y,S=h[1]+s+140+35<T;return C&&S?(g=h[1]+4,m=v[1]):C?(g=h[0]-38-4,m=v[1]):S?(g=h[1]+4,m=v[0]):(g=h[0]-38-4,m=v[0]),g+=s,m+=l,g=Math.max(g,s+50),[m=Math.max(m,l+21),g,g+38>=T-35||m+30>=y-54]}}}},709:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.questionTitleMaxLength=t.questionNumberMax=void 0;var a=l(n(47)),r=l(n(16));t.createForm=function(e,t,n){var o={sheet_id:{doc_id:i.default.clientVars.globalPadId,sub_id:e},form_text:"",form_title:t||""},l=d(n||[]);return o.form_text=(0,r.default)(l),new a.default(function(e,t){s.ajax({url:"//docs.qq.com/form/collect/from_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:(0,r.default)(o),xsrf:s.getXsrf()},success:function(t){e(t)},error:function(e){t(e)}})})},t.cancelRelateForm=function(e){var t={bind:!1,sheet_id:{doc_id:i.default.clientVars.globalPadId}};return new a.default(function(e,n){s.ajax({url:"//docs.qq.com/form/collect/bind_sheet",type:"POST",xhrFields:{withCredentials:!0},data:{data:(0,r.default)(t),xsrf:s.getXsrf()},success:function(t){e(t)},error:function(e){n(e)}})})},t.checkSyncExceptions=function(e){return new a.default(function(t,n){s.ajax({url:"//docs.qq.com/form/collect/get_loading",type:"POST",xhrFields:{withCredentials:!0},data:{global_id:e,xsrf:s.getXsrf()},success:function(e){t("string"===typeof e?JSON.parse(e):e)},error:function(e){n(e)}})})};var i=l(n(7)),o=n(22);function l(e){return e&&e.__esModule?e:{default:e}}var s=i.default.window.$,u=t.questionNumberMax=25,c=t.questionTitleMaxLength=100,d=function(e){e.length>u&&(e=e.slice(0,u));var t=Date.now(),n=!e.length,a=i.default.clientVars.isUserChangeTitle?i.default.clientVars.padTitle:"",r={formName:"\u65e0\u6807\u9898\u6536\u96c6\u8868",updateTime:t,title:a,subtitle:"",author:i.default.clientVars.userName,themeClass:"default",padId:i.default.clientVars.padId,isDirty:!1,rightBarClicked:!1,globalPadId:i.default.clientVars.globalPadId},l=void 0;return l=n?function(e){return[{id:"blank-1",section:0,title:"\u672a\u547d\u540d\u7684\u95ee\u9898",subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u59d3\u540d\u201d",isDirty:!1,createTime:e,updateTime:e,type:"SIMPLE",qdata:{placeholder:"\u8bf7\u586b\u5199"},validate:[{type:12,rules:{max:100,open:!1},message:"\u8f93\u5165\u5185\u5bb9\u9700\u4e0d\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}},{id:"blank-2",section:0,title:"\u672a\u547d\u540d\u7684\u95ee\u9898",subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u6027\u522b\u201d",isDirty:!1,createTime:e,updateTime:e,type:"RADIO",qdata:{options:[{id:111,title:"\u9009\u9879 1"},{id:222,title:"\u9009\u9879 2"}]},validate:null,toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1}}]}(t):e.map(function(e,n){return function(e,t,n){return{id:"blank-"+e,section:0,title:t.length>c?t.substr(0,c):t,subtitle:"",placeholder:"\u8f93\u5165\u95ee\u9898\uff0c\u4f8b\u5982\u201c\u4f60\u7684\u59d3\u540d\u201d",isDirty:!0,createTime:n,updateTime:n,type:"SIMPLE",qdata:{placeholder:"\u8bf7\u586b\u5199"},validate:[{type:12,rules:{max:100,open:!1},message:"\u8f93\u5165\u5185\u5bb9\u4e0d\u8d85\u8fc7100\u4e2a\u5b57\u7b26\u3002"}],toggle:{required:!1,randomOption:!1,showValidate:!1,showSubtitle:!1},questionDescripe:{simpleFirstIndex:0,simpleSecondIndex:0,simpleUserInputContent:"",simpleUserInputContentSupply:"",simpleUserInputErrorMessage:""}}}(n,e,t)}),o.isMobile&&n||(r.questions=l,r.sections=[{sid:0,title:"",qlist:l.map(function(e){return e&&e.id})}]),r}},710:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=T(n(0)),r=T(n(1)),i=T(n(7)),o=T(n(60)),l=T(n(43)),s=T(n(183)),u=n(313),c=n(98),d=n(44),f=T(n(29)),p=T(n(18)),h=T(n(39)),v=T(n(32)),g=T(n(247)),m=T(n(773)),y=T(n(8));function T(e){return e&&e.__esModule?e:{default:e}}new m.default(50,10),(0,g.default)(function(){!function(){var e=i.default.window.SpreadsheetApp;e&&e.view.canvas.pluginsApi.subscript.reRender()}()},200);var C=!0,S=function(){function e(t){var n=this;(0,a.default)(this,e),this.init=function(){},this.keyframeHandler=function(e){e.sType;var t=e.sheetId,a=n.getSheetById(t);if(a){var r=a.data.rowData,i=new m.default(1e3,50),o=new m.default(200,10),l=0;r.forEach(function(e,a){e&&e.values.forEach(function(e,r){if(e){l++;var s=e.getUserEnteredFormat(),u=s&&s.getDataValidation();u&&(l<200?o.setTask(function(){n.addDVNode(u,a,r,t)}):i.setTask(function(){n.addDVNode(u,a,r,t)}))}})})}},this.generateFormula=function(e,t,n){if(null===e)return null;var a=(0,u.transformDV2Formula)(e);return null===a?null:a=(0,c.replaceAll)(a,"$SLOT",(0,d.toCellId)(t,n))},this.addToFMap=function(e){var t=e.formula,a=e.row,r=e.col,i=e.sheetId,l=o.default.string2FormulaModel(t,a,r,i);n.noNeedUpdate(e)||(n.parent.calcController.addCustomFormulaNodeAndGenerateDependency({formulaModel:l,row:a,col:r,sheetId:i,customType:"dv"}),C&&(C=!1,y.default.tdwReport({opername:"doc_edit",module:"excel",action:"data_validation_open"})))},this.addUnCommits=function(e){n.uncommits.push(e)},this.addDVNode=function(e,t,a,r){var i=n.generateFormula(e,t,a);if(null===i)return null;var o={row:t,col:a,formula:i,sheetId:r};n.addToFMap(o)},this.customHandler=function(e){var t=n.customCellDataDeltaCreator(e);if(t)return new l.default({gridRange:e.gridRange,cellDataDelta:t})},this.customInvertMutationCreator=function(e){var t=e.row,a=e.col,r=e.sheetId,i=n.getCellData(t,a,r),o=i&&i.getUserEnteredFormat();o&&o.getDataValidation(),new f.default;console.warn("\u9006\u5411mutation")},this.getSheetById=function(e){return e=e||n.currentSheetId,n.spreadsheet.getSheetBySheetId(e)},this.getDataValidation=function(e){var t=e&&e.getUserEnteredFormat(),n=t&&t.getDataValidation();return n||null},this.getCellData=function(e,t,a){var r=n.getSheetById(a);return r?r.getCellDataAtPosition(e,t):null},this.cellDataHasValue=function(e){var t=n,a=e,r=!0;return(0,c.iterateGridRange)(a,function(e,n,a){var i=t.getCellData(e,n,a),o=i&&i.getEffectiveValue(),l=o&&o.value;null!==l&&""!==l&&void 0!==l||(r=!1)}),r},this.parent=t,this.uncommits=[],this.spreadsheet=this.parent.spreadsheet,this.init()}return(0,r.default)(e,[{key:"initInterVal",value:function(){var e=this,t=void 0;t=setInterval(function(){for(var n=5;0!=e.uncommits.length&&n--;){var a=e.uncommits.shift();a&&e.addToFMap(a)}0==e.uncommits.length&&t&&clearInterval(t)},300)}},{key:"noNeedUpdate",value:function(e){var t=e.formula,n=e.row,a=e.col,r=e.sheetId,i=(0,d.getGraphNodeIdByRowCol)(n,a,r,{customType:"dv"});if(this.parent.calcController.formulaGraph.hasNode(i)){var o=this.parent.calcController.formulaGraph.getItem(i);if(!(0,d.isFormulaNode)(o))return!1;if(t===o.formulaModel.toString(n,a))return!0}return!1}},{key:"customCellDataDeltaCreator",value:function(e){var t=this,n=e.effectiveValue,a=e.gridRange,r=e.formula,i=void 0===r?null:r,o=this,l=new f.default;if(i){var s=null,u=new h.default;if((0,c.iterateGridRange)(a,function(e,n,a){var r=o.getCellData(e,n,a),l=o.getDataValidation(r);l&&(s=t.updateRowColChangeDataValidation(l,i,e,n))}),null==s)return;u.setSlot(v.default.DATA_VALIDATION,s),l.setSlot(p.default.SLOT_USER_ENTERED_FORMAT_DELTA,u)}else{var d=n&&n.value;if(!this.cellDataHasValue(a))return;d=!0===d||"TRUE"===d,l.setSlot(p.default.SLOT_IS_DATA_VALID,d)}return l}},{key:"getSelectionFromTwoFormula",value:function(e,t,n,a){var r=t.toString(n,a),i=this.generateFormula(e,n,a),o=e&&e.argTokens&&e.argTokens[0],l=o&&o.userEnteredValue;if(null===l||null==r||null==i||l&&"="!==l[0])return null;l=(0,c.moveEqualChar)(l);var s=i.indexOf(l),u=s+l.length,d=i.substring(0,s),f=i.substring(u,i.length);return r.replace(d,"").replace(f,"")}},{key:"updateRowColChangeDataValidation",value:function(e,t,n,a){if(null==t||"list"!=e.ruleType)return null;var r=this.getSelectionFromTwoFormula(e,t,n,a);if(!r)return null;var i=new s.default(e);return i.argTokens=[{userEnteredValue:"="+r}],i}},{key:"currentSheetId",get:function(){return this.spreadsheet.getActiveSheetId()}}]),e}();t.default=S},711:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enterActiveStateAndSelectCell=t.showSplitFailDialog=t.showSplitGuideDialog=t.showWaitingDialog=t.getSmartSplitRange=t.isSupportSmartSplit=void 0;var a=l(n(89)),r=l(n(311)),i=l(n(198)),o=l(n(7));function l(e){return e&&e.__esModule?e:{default:e}}function s(e){var t=e.view.canvas.excel;t.inputCenter.board.hide(),t.inputCenter.board.blur()}function u(e){var t=e.view.canvas.excel;t.inputCenter.board.focus(),t.enterActiveState();var n=e.view.getSelection().rangeSelections[0];t.selectCell(n.startColIndex,n.startRowIndex)}function c(e){s(e);var t="manual-split-tip-image";o.default.window.devicePixelRatio>1&&(t="manual-split-tip-image-2"),i.default.dialog.Custom_Dialog('<div style=\'text-align: left;\'>\u8bf7\u9009\u62e9\u5e26\u6709\u59d3\u540d\u3001\u7535\u8bdd\u3001\u5730\u5740\u3001\u8eab\u4efd\u8bc1\u53f7\u7801\u3001\u7a7a\u683c\u7b49\u6587\u672c\u533a\u57df\u518d\u8fdb\u884c\u667a\u80fd\u5206\u5217\uff0c\u53ef\u7528\u4e8e\u6574\u7406\u63a5\u9f99\u4fe1\u606f\u3001\u62a5\u540d\u7edf\u8ba1\u3001\u56e2\u8d2d\u8ba2\u5355\u6c47\u603b\u7b49\u3002</div>\n        <div style="position: relative; top: 24px;"><div class="'+t+'"></div></div>',{title:"\u63d0\u793a",custom_class:"smart-split-guide",buttons:[{caption:"\u6211\u77e5\u9053\u4e86",callback:function(t,n){n&&(n.preventDefault(),n.stopPropagation()),o.default.window.focus(),u(e)}}]})}t.isSupportSmartSplit=function(e){e.spreadsheet.activeSheet;var t=e.view.getSelection().rangeSelections[0],n=t.startRowIndex,a=t.endRowIndex,i=t.startColIndex,o=t.endColIndex;if(i!==o)return!1;for(var l=!0,s=!0,u=n;u<=a;u++)if(l&&!r.default.cell.isSingleCellBlank(e,u,o)&&(l=!1),s&&!r.default.cell.getCellDataDVAtPosition(e,u,o)&&(s=!1),!l&&!s)return!0;return!1},t.getSmartSplitRange=function(e,t){for(var n=t.startRowIndex,i=t.endRowIndex,o=t.startColIndex,l=t.endColIndex,s=n,u=i,c=n;c<=i;c++)if(!r.default.cell.isSingleCellBlank(e,c,o)){s=c;break}for(var d=i;d>=s;d--)if(!r.default.cell.isSingleCellBlank(e,d,o)){u=d;break}return new a.default.Range.GridRange(t.sheetId,s,u,o,l)},t.showWaitingDialog=function(e,t){return s(e),i.default.dialog.dialog.waiting("\u6b63\u5728\u667a\u80fd\u5206\u5217...",function(e,n){n&&(n.preventDefault(),n.stopPropagation()),o.default.window.focus(),t()})},t.showSplitGuideDialog=c,t.showSplitFailDialog=function(e){c(e)},t.enterActiveStateAndSelectCell=u},750:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.replaceAll=t.iterateGridRange=t.wrapValue=t.getRealValue=t.moveEqualChar=void 0;var a=n(44),r=n(57),i=t.moveEqualChar=function(e){return e?e.length>=1&&"="===e[0]?e.substr(1,e.length):e:""};t.getRealValue=function(e){if(e){var t=(0,r.parseValueWithStyle)(e);return null==t?e:t.value}return e},t.wrapValue=function(e){var t=void 0,n=(0,a.isFormula)(e);if("string"===typeof e)if('""'===e)t=e;else{if(n)return i(e);t='"'+e+'"'}else{if("number"===typeof e||"boolean"===typeof e)return t=""+e;t='""'}return t},t.iterateGridRange=function(e,t){for(var n=e,a=e.sheetId,r=n.startRowIndex;r<=n.endRowIndex;r++)for(var i=n.startColIndex;i<=n.endColIndex;i++)t(r,i,a)},t.replaceAll=function(e,t,n){return e?e.split(t).join(n):""}},757:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default={_astNodes:void 0,_element:void 0,_instance:void 0,_funcNode:void 0,setAstNodes:function(e){this._astNodes=e},setFuncNode:function(e){this._funcNode=e},setElement:function(e){this._element=e},setInstance:function(e){this._instance=e}}},761:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a,r,i=n(48),o=n(68),l=n(289),s=(a=l)&&a.__esModule?a:{default:a},u=n(408),c=n(409),d=n(1633),f=n(239),p=n(98);!function(e){!function(e){e.isGeneralCell=i.isGeneralCell,e.getCellNumberFormatType=i.getCellNumberFormatType,e.getNumberFormatNameByType=i.getNumberFormatNameByType}(e.numberFormat||(e.numberFormat={}));!function(e){e.CopyType=o.CopyType,e.CopyHTMLType=o.CopyHTMLType,e.wxCopyPasteHacker=s.default,e.CANPASTETYPE=u.CANPASTETYPE,e.getCopyPlainCache=c.getCopyPlainCache,e.hasMobileClipboardContent=c.hasMobileClipboardContent,e.syncMobileClipboard=c.syncMobileClipboard,e.handleCutDimension=d.handleCutDimension,e.handleCopyDimension=d.handleCopyDimension}(e.copyPaste||(e.copyPaste={}));!function(e){e.needCheckSmartSplit=f.needCheckSmartSplit,e.doSmartSplitMobile=f.doSmartSplitMobile}(e.smartSplit||(e.smartSplit={}));!function(e){e.getUIDVAtPosition=p.getUIDVAtPosition}(e.dataValidation||(e.dataValidation={}))}(r||(r={}));var h=window.T_SHEET||{};window.T_SHEET=h,h.Feature=r,t.default=r},773:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(n(0)),r=o(n(1)),i=o(n(12));function o(e){return e&&e.__esModule?e:{default:e}}var l=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10;(0,a.default)(this,e),this.INTERVAL_TIME=t,this.TASK_NUM=n,this.task=[],this.interVal=null,this.finished=!1,this.running=!1,this.init()}return(0,r.default)(e,[{key:"init",value:function(){var e=this;this.interVal=function(){e.runTask(),e.finished||e.startInterVal()}}},{key:"setTask",value:function(e){this.finished=!1,this.task.push(e),this.startInterVal()}},{key:"startInterVal",value:function(){var e=this;this.running||(this.running=!0,i.default.wait(this.INTERVAL_TIME).run(function(){e.interVal()}))}},{key:"runTask",value:function(){for(var e=0;e<this.TASK_NUM;e++){if(0==this.task.length){this.finished=!0;break}var t=this.task.shift();t&&t()}this.running=!1}}]),e}();t.default=l},98:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.checkArgTokenIncludeSelection=t.isSelection=t.isActiveCellContainDV=t.iterateGridRange=t.getDVFromCellData=t.wrapValue=t.getRealValue=t.checkTextConatiansOperatorFailed=t.checkDVOperatorFailed=t.selectionToGridRange=t.autoSplit=t.moveEqualChar=t.isFromulaError=t.isLegalFormula=t.replaceCellIdBySlot=t.replaceSlotByCellId=t.isImportSupportType=t.isExcelType=t.replaceAll=void 0;var a=v(n(204)),r=v(n(84));t.getDropDownValues=function(e,t){try{var n=w(e,t);if(null==n||null==n.argTokens||null==n.argTokens[0].userEnteredValue||"list"!==n.ruleType)return console.warn("\u6570\u636e\u9a8c\u8bc1\uff1a\u7c7b\u578b\u4e0d\u4e3alist\u6216\u8005\u7528\u6237\u8f93\u5165\u4e3a\u7a7a\uff0c\u4e0d\u80fd\u83b7\u53d6\u4e0b\u62c9\u5217\u8868\u4fe1\u606f"),null;var i=n.argTokens[0].userEnteredValue,o=C(n);if("range-list"===o){var l=R(i),s=S(l);return null===s?[]:(s=s.filter(function(e){return e}),(0,r.default)(new a.default(s)))}return"item-list"===o&&null!=i?T(i):null}catch(u){console.warn("\u6570\u636e\u9a8c\u8bc1\u83b7\u53d6\u4e0b\u62c9\u5217\u8868\u9519\u8bef\uff0c",u)}},t.getListTypeFromUserEnterValue=C,t.getRangeEffectiveValue=S,t.checkDVUIoptions=function(e){if(!e.validType)return console.warn("\u6570\u636e\u9a8c\u8bc1\uff1a\u9a8c\u8bc1\u6761\u4ef6\u4e0d\u5141\u8bb8\u4e3a\u7a7a\n",e),null;if(e.validType!=l.VALID_TYPE.AVAILABLE&&null==e.argTokens)return console.warn("\u6570\u636e\u9a8c\u8bc1\uff1a"+e.validType+" \u7c7b\u578b\u7528\u6237\u8f93\u5165\u4e0d\u5141\u8bb8\u4e3a\u7a7a\n",e),null;return!0},t.getDataValidationConfig=function(e){return{ruleType:x({validType:e.validType,dataType:e.dataType}),inputMessage:e.inputMessage||null,isStrict:e.isStrict||!1,showDropDown:e.showDropDown||!1,operator:e.operator,argTokens:e.argTokens||null}},t.getUIDVAtPosition=b,t.getCellDataDVAtPosition=w,t.UITypeToRuleType=x,t.ruleTypeToUIType=E,t.formatObjToDateNum=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"date",a=(0,u.default)(e).format(t);"date"==n&&(a+=" 00:00:00");return(0,c.datetime2Numeric)(a)},t.formatDateNumToObj=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD";return(0,p.format)(t,new f.Decimal(e).toNumber())[0]};var i=v(n(11)),o=v(n(7)),l=n(310),s=v(n(157)),u=v(n(6)),c=n(57),d=n(44),f=n(309),p=n(48),h=n(125);function v(e){return e&&e.__esModule?e:{default:e}}var g=t.replaceAll=function(e,t,n){return e?e.split(t).join(n):""},m=(t.isExcelType=function(e){switch(e.ruleType){case s.default.LIST:case s.default.NUMBER_INT:case s.default.NUMBER_FLOAT_AND_INT:case s.default.CUSTOM_MUST_FLOAT:case s.default.TEXT_LENGTH:case s.default.DATE:return!0}return!1},t.isImportSupportType=function(e){switch(e){case s.default.LIST:case s.default.NUMBER_INT:case s.default.TEXT_LENGTH:case s.default.DATE:case s.default.NUMBER_FLOAT_AND_INT:return!0}return!1},t.replaceSlotByCellId=function(e,t,n){return g(e,"$SLOT",(0,d.toCellId)(t,n))},t.replaceCellIdBySlot=function(e,t,n){return g(e,(0,d.toCellId)(t,n),"$SLOT")},t.isLegalFormula=function(e){var t=o.default.window.SpreadsheetApp;if(t){var n=t.spreadsheet.activeSheet.getSheetId();return!t.calcController.getResultBySingleFormula(e,n).isError}return null},t.isFromulaError=function(e){return e&&e.length>1?"#"===e[1]||"#"===e[0]:null}),y=t.moveEqualChar=function(e){return e?e.length>=1&&"="===e[0]?e.substr(1,e.length):e:""},T=t.autoSplit=function(e){var t=void 0;return t=(t=(t=e.split(",")).map(function(e){return e.trim()})).filter(function(e){return e}),(0,r.default)(new a.default(t))};function C(e){var t=e&&e.argTokens&&e.argTokens[0].userEnteredValue;return t&&"list"===e.ruleType?0!=t.length&&"="===t[0]?"range-list":0!=t.length?"item-list":null:null}function S(e){if(null==e)return null;var t=e,n=o.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDatasAtRange(t.startRowIndex,t.endRowIndex,t.startColIndex,t.endColIndex),a=[];return n&&n.map(function(e){return e.map(function(e){if(null!=e)return a.push((0,h.getMergedValue)(e))})}),a}function b(e,t){var n=w(e,t);if(null==n)return null;var a=E(n.ruleType),r=null;return null!=a&&null!=n&&(r={validType:a.validType,dataType:a.dataType,inputMessage:n.inputMessage,isStrict:n.isStrict,showDropDown:n.showDropDown,operator:n.operator,argTokens:n.argTokens}),r}function w(e,t){var n=o.default.window.SpreadsheetApp.spreadsheet.activeSheet.getCellDataAtPosition(e,t),a=n&&n.getUserEnteredFormat();return a&&a.getDataValidation()}var R=t.selectionToGridRange=function(e,t){if(!e)return null;var n=o.default.window.SpreadsheetApp;if(!t&&n&&(t=n.spreadsheet.getActiveSheetId()),!t)return null;var a=(e=y(e)).split(":");if(0===e.length||function(e){for(var t=0;t<e.length;t++){var n=e[t];if(m(n))return!0}return!1}(a))return null;var r=(0,d.getRowColFromCellId)(a[0]),l=void 0;if(1===a.length)l=r;else{if(2!==a.length)return null;try{l=(0,d.getRowColFromCellId)(a[1])}catch(s){return console.log(s),null}}return new i.default(t,r.row,l.row,r.col,l.col)};function x(e){var t=e.validType,n=e.dataType;switch(t){case l.VALID_TYPE.LIST:return s.default.LIST;case l.VALID_TYPE.NUMBER:switch(n){case l.DATA_TYPE.FLOAT:return s.default.CUSTOM_MUST_FLOAT;case l.DATA_TYPE.INT:return s.default.NUMBER_INT;case l.DATA_TYPE.NONE:return s.default.NUMBER_FLOAT_AND_INT}break;case l.VALID_TYPE.TEXT:switch(n){case l.DATA_TYPE.CONTENT:return s.default.CUSTOM_TEXT_CONTAINS;case l.DATA_TYPE.LENGTH:default:return s.default.TEXT_LENGTH}case l.VALID_TYPE.DATE:return s.default.DATE;case l.VALID_TYPE.AVAILABLE:switch(n){case l.DATA_TYPE.ID_CARD:return s.default.CUSTOM_ID_CARD}}return console.warn("\u6570\u636e\u9a8c\u8bc1\uff1a\u4f20\u5165\u6570\u636e\u4e0d\u7b26\u5408\u89c4\u5219"),s.default.CUSTOM}function E(e){switch(e){case s.default.LIST:return{validType:l.VALID_TYPE.LIST,dataType:l.DATA_TYPE.NONE};case s.default.NUMBER_INT:return{validType:l.VALID_TYPE.NUMBER,dataType:l.DATA_TYPE.INT};case s.default.NUMBER_FLOAT_AND_INT:return{validType:l.VALID_TYPE.NUMBER,dataType:l.DATA_TYPE.NONE};case s.default.CUSTOM_MUST_FLOAT:return{validType:l.VALID_TYPE.NUMBER,dataType:l.DATA_TYPE.FLOAT};case s.default.TEXT_LENGTH:return{validType:l.VALID_TYPE.TEXT,dataType:l.DATA_TYPE.LENGTH};case s.default.DATE:return{validType:l.VALID_TYPE.DATE,dataType:l.DATA_TYPE.NONE};case s.default.CUSTOM_NUM_PHONE:return{validType:l.VALID_TYPE.AVAILABLE,dataType:l.DATA_TYPE.PHONE};case s.default.CUSTOM_ID_CARD:return{validType:l.VALID_TYPE.AVAILABLE,dataType:l.DATA_TYPE.ID_CARD};case s.default.CUSTOM_TEXT_CONTAINS:return{validType:l.VALID_TYPE.TEXT,dataType:l.DATA_TYPE.CONTENT};case s.default.CUSTOM_TEXT_MAIL:return{validType:l.VALID_TYPE.AVAILABLE,dataType:l.DATA_TYPE.MAIL};case s.default.CUSTOM_TEXT_URL:return{validType:l.VALID_TYPE.AVAILABLE,dataType:l.DATA_TYPE.URL};case s.default.CUSTOM_TEXT_GENDER:return{validType:l.VALID_TYPE.AVAILABLE,dataType:l.DATA_TYPE.GENDER}}return null}t.checkDVOperatorFailed=function(e){return-1===["between","notBetween","equal","notEqual","lessThan","lessThanOrEqual","greaterThan","greaterThanOrEqual"].indexOf(e)},t.checkTextConatiansOperatorFailed=function(e){return-1===["contains","notContains","equal"].indexOf(e)};t.getRealValue=function(e){if(e){var t=(0,c.parseValueWithStyle)(e);return null==t?e:t.value}return e},t.wrapValue=function(e,t){var n=void 0,a=(0,d.isFormula)(e);if("string"===typeof e)if('""'===e)n=e;else{if(a)return y(e);n='"'+e+'"'}else{if("number"===typeof e||"boolean"===typeof e)return n=""+e;n='""'}return n},t.getDVFromCellData=function(e){var t=e&&e.getUserEnteredFormat(),n=t&&t.getDataValidation();return n||null},t.iterateGridRange=function(e,t){for(var n=e,a=e.sheetId,r=n.startRowIndex;r<=n.endRowIndex;r++)for(var i=n.startColIndex;i<=n.endColIndex;i++)t(r,i,a)},t.isActiveCellContainDV=function(){var e=o.default.window.SpreadsheetApp.view.getSelection().activeCell;return!!b(e.rowIndex,e.colIndex)};var I=t.isSelection=function(e){return e&&e.match(/[a-zA-Z]+\d+/gi)};t.checkArgTokenIncludeSelection=function(e){var t=!1;return e.argTokens&&e.argTokens.map(function(e){var n=e.userEnteredValue;I(n)&&(t=!0)}),t}}}]);
//# sourceMappingURL=chunk-feature-pc-bf52a7d7ed.js.map